import{j as e}from"./vendor-state-DdX3IZQk.js";import{r as a}from"./vendor-react-Da1CiaFS.js";import{P as p}from"./PortalLayout-DT2Y-TXC.js";import{ag as S,ab as T}from"./index-CAHqSsrb.js";import"./vendor-ui-eP5rASc6.js";import"./vendor-charts-DQXNY-Mg.js";function J(){const[t,b]=a.useState(null),[k,E]=a.useState(!0),[x,g]=a.useState(""),[f,d]=a.useState(""),[n,m]=a.useState(!1),[r,o]=a.useState({}),[y,w]=a.useState(!1),[F,u]=a.useState(!1),[l,c]=a.useState({current_password:"",new_password:""}),[j,h]=a.useState(""),[N,i]=a.useState(""),[v,P]=a.useState(!1);a.useEffect(()=>{L()},[]);const L=async()=>{try{const s=await S.getProfile();b(s.data),o({first_name:s.data.first_name||"",last_name:s.data.last_name||"",phone:s.data.phone||"",title:s.data.title||""})}catch(s){g("Failed to load profile"),console.error(s)}finally{E(!1)}},A=async()=>{w(!0),g(""),d("");try{const s=await S.updateProfile(r);b(s.data),m(!1),d("Profile updated successfully"),setTimeout(()=>d(""),3e3)}catch(s){g("Failed to update profile"),console.error(s)}finally{w(!1)}},D=()=>{m(!1),t&&o({first_name:t.first_name||"",last_name:t.last_name||"",phone:t.phone||"",title:t.title||""})},I=async s=>{var _,C;if(s.preventDefault(),i(""),l.new_password!==j){i("Passwords do not match");return}if(l.new_password.length<8){i("Password must be at least 8 characters");return}P(!0);try{await T.changePassword(l),u(!1),c({current_password:"",new_password:""}),h(""),d("Password changed successfully"),setTimeout(()=>d(""),3e3)}catch(q){i(((C=(_=q.response)==null?void 0:_.data)==null?void 0:C.error)||"Failed to change password")}finally{P(!1)}};return k?e.jsx(p,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})})}):t?e.jsx(p,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Profile"}),!n&&e.jsx("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-sm",children:"Edit Profile"})]}),x&&e.jsx("div",{className:"bg-red-900/50 text-red-200 p-4 rounded-lg",children:x}),f&&e.jsx("div",{className:"bg-green-900/50 text-green-200 p-4 rounded-lg",children:f}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Account Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Email"}),e.jsx("p",{className:"text-white bg-gray-700 px-4 py-2 rounded-lg",children:t.email}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Organization"}),e.jsx("p",{className:"text-white bg-gray-700 px-4 py-2 rounded-lg",children:t.customer_name||"Not set"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"First Name"}),n?e.jsx("input",{type:"text",value:r.first_name||"",onChange:s=>o({...r,first_name:s.target.value}),className:"w-full bg-gray-700 text-white px-4 py-2 rounded-lg border-0 focus:ring-2 focus:ring-blue-500",placeholder:"Enter first name"}):e.jsx("p",{className:"text-white bg-gray-700 px-4 py-2 rounded-lg",children:t.first_name||e.jsx("span",{className:"text-gray-500",children:"Not set"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Last Name"}),n?e.jsx("input",{type:"text",value:r.last_name||"",onChange:s=>o({...r,last_name:s.target.value}),className:"w-full bg-gray-700 text-white px-4 py-2 rounded-lg border-0 focus:ring-2 focus:ring-blue-500",placeholder:"Enter last name"}):e.jsx("p",{className:"text-white bg-gray-700 px-4 py-2 rounded-lg",children:t.last_name||e.jsx("span",{className:"text-gray-500",children:"Not set"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Phone"}),n?e.jsx("input",{type:"tel",value:r.phone||"",onChange:s=>o({...r,phone:s.target.value}),className:"w-full bg-gray-700 text-white px-4 py-2 rounded-lg border-0 focus:ring-2 focus:ring-blue-500",placeholder:"Enter phone number"}):e.jsx("p",{className:"text-white bg-gray-700 px-4 py-2 rounded-lg",children:t.phone||e.jsx("span",{className:"text-gray-500",children:"Not set"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Title"}),n?e.jsx("input",{type:"text",value:r.title||"",onChange:s=>o({...r,title:s.target.value}),className:"w-full bg-gray-700 text-white px-4 py-2 rounded-lg border-0 focus:ring-2 focus:ring-blue-500",placeholder:"Enter job title"}):e.jsx("p",{className:"text-white bg-gray-700 px-4 py-2 rounded-lg",children:t.title||e.jsx("span",{className:"text-gray-500",children:"Not set"})})]})]}),n&&e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-700",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm",children:"Cancel"}),e.jsx("button",{onClick:A,disabled:y,className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-sm disabled:opacity-50",children:y?"Saving...":"Save Changes"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Account Activity"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Last Login"}),e.jsx("p",{className:"text-white",children:t.last_login?new Date(t.last_login).toLocaleString():"Never"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Account Created"}),e.jsx("p",{className:"text-white",children:new Date(t.created_at).toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Security"}),F?e.jsxs("form",{onSubmit:I,className:"space-y-4 max-w-md",children:[N&&e.jsx("div",{className:"bg-red-900/50 text-red-200 p-3 rounded-lg text-sm",children:N}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Current Password"}),e.jsx("input",{type:"password",value:l.current_password,onChange:s=>c({...l,current_password:s.target.value}),className:"w-full bg-gray-700 text-white px-4 py-2 rounded-lg border-0 focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"New Password"}),e.jsx("input",{type:"password",value:l.new_password,onChange:s=>c({...l,new_password:s.target.value}),className:"w-full bg-gray-700 text-white px-4 py-2 rounded-lg border-0 focus:ring-2 focus:ring-blue-500",required:!0,minLength:8}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 8 characters"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:j,onChange:s=>h(s.target.value),className:"w-full bg-gray-700 text-white px-4 py-2 rounded-lg border-0 focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{u(!1),c({current_password:"",new_password:""}),h(""),i("")},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:v,className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-sm disabled:opacity-50",children:v?"Changing...":"Change Password"})]})]}):e.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm",children:"Change Password"})]})]})}):e.jsx(p,{children:e.jsx("div",{className:"bg-red-900/50 text-red-200 p-4 rounded-lg",children:x||"Failed to load profile"})})}export{J as default};
