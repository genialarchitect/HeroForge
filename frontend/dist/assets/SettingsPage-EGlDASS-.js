import{j as e}from"./vendor-state-BeiY7NuG.js";import{r as c}from"./vendor-react-B7quoyFx.js";import{d as ne,C as _,L as R,I as D,B as f,a as G,b as z,t as te,s as ee,f as He,n as K,e as Ie,g as ze,u as Ve,h as re,m as le,i as xe,j as se,k as W,c as Ge}from"./index-DtIvpSYf.js";import{B as r,U as pe,S as B,a7 as ve,am as ge,k as ae,a as de,q,g as Be,s as Ee,u as Fe,an as Ye,ao as We,ap as Qe,P as X,aq as Xe,m as Q,T as Ne,af as O,X as oe,F as Ze,ak as me,ar as es,as as ss,at as Te,au as he,w as J,av as ts,aw as je,A as as,ax as Y,M as ce,N as _e,d as be,J as fe,H as rs,R as ls,j as ns,ay as cs,x as ye,az as ke,D as is,K as ie,f as Re,y as Le,a5 as Me,aA as Se,aB as ds,aC as Ce}from"./vendor-ui-fHX2jwMk.js";import"./vendor-charts-CRKwdVC8.js";const os=()=>{var a;const[d,I]=c.useState(null),[F,h]=c.useState(!0),[v,N]=c.useState(!1),[b,C]=c.useState(!1),[m,w]=c.useState(""),[o,y]=c.useState(!1),[k,E]=c.useState(""),[u,P]=c.useState(""),[p,g]=c.useState("");c.useEffect(()=>{A()},[]);const A=async()=>{h(!0);try{const t=await ne.me();I(t.data),w(t.data.email||"")}catch(t){r.error("Failed to load profile"),console.error(t)}finally{h(!1)}},l=async t=>{var i,s;if(t.preventDefault(),!m.trim()){r.error("Email is required");return}N(!0);try{const x=await ne.updateProfile({email:m.trim()});I(x.data),r.success("Profile updated successfully")}catch(x){r.error(((s=(i=x.response)==null?void 0:i.data)==null?void 0:s.error)||"Failed to update profile")}finally{N(!1)}},S=async t=>{var i,s;if(t.preventDefault(),!k||!u){r.error("All password fields are required");return}if(u.length<6){r.error("New password must be at least 6 characters");return}if(u!==p){r.error("Passwords do not match");return}C(!0);try{await ne.changePassword({current_password:k,new_password:u}),r.success("Password changed successfully"),y(!1),E(""),P(""),g("")}catch(x){r.error(((s=(i=x.response)==null?void 0:i.data)==null?void 0:s.error)||"Failed to change password")}finally{C(!1)}},n=t=>t?new Date(t).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"N/A";return F?e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(pe,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Profile Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(pe,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Username"}),e.jsx("p",{className:"text-white font-medium",children:d==null?void 0:d.username})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(B,{className:"h-5 w-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Roles"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:((a=d==null?void 0:d.roles)==null?void 0:a.map(t=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-primary/20 text-primary rounded capitalize",children:t},t)))||e.jsx("span",{className:"text-slate-400",children:"No roles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(ve,{className:"h-5 w-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Member Since"}),e.jsx("p",{className:"text-white",children:n(d==null?void 0:d.created_at)})]})]})]}),e.jsx("form",{onSubmit:l,className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-2",children:[e.jsx(ge,{className:"h-4 w-4"}),"Email Address"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(D,{type:"email",value:m,onChange:t=>w(t.target.value),placeholder:"your@email.com",className:"flex-1"}),e.jsxs(f,{type:"submit",variant:"primary",loading:v,disabled:v||m===(d==null?void 0:d.email),children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Save"]})]})]})})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(de,{className:"h-6 w-6 text-yellow-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Security"})]}),!o&&e.jsx(f,{variant:"secondary",onClick:()=>y(!0),children:"Change Password"})]}),o?e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsx(D,{label:"Current Password",type:"password",value:k,onChange:t=>E(t.target.value),placeholder:"Enter current password"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(D,{label:"New Password",type:"password",value:u,onChange:t=>P(t.target.value),placeholder:"Enter new password"}),e.jsx(D,{label:"Confirm New Password",type:"password",value:p,onChange:t=>g(t.target.value),placeholder:"Confirm new password"})]}),u&&p&&u!==p&&e.jsx("p",{className:"text-sm text-red-400",children:"Passwords do not match"}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:()=>{y(!1),E(""),P(""),g("")},children:"Cancel"}),e.jsx(f,{type:"submit",variant:"primary",loading:b,disabled:b||!k||!u||u!==p,children:"Update Password"})]})]}):e.jsx("p",{className:"text-slate-400",children:"Keep your account secure by using a strong, unique password."})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(B,{className:"h-6 w-6 text-green-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Account Status"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${(d==null?void 0:d.is_active)!==!1?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-white",children:(d==null?void 0:d.is_active)!==!1?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Your account is in good standing."})]})]})},ms=[{id:"admin",name:"Admin",description:"Full system access"},{id:"user",name:"User",description:"Standard user access"},{id:"auditor",name:"Auditor",description:"Read-only access to all scans"},{id:"viewer",name:"Viewer",description:"Limited view access"}],xs=()=>{const[d,I]=c.useState([]),[F,h]=c.useState([]),[v,N]=c.useState(!0),[b,C]=c.useState(!1),[m,w]=c.useState(new Set),[o,y]=c.useState(!1),[k,E]=c.useState(!0);c.useEffect(()=>{u()},[]);const u=async()=>{var i;N(!0);try{const s=await G.getUsers();I(s.data),E(!0)}catch(s){((i=s.response)==null?void 0:i.status)===403?E(!1):r.error("Failed to load users"),console.error(s)}finally{N(!1)}},P=async()=>{C(!0);try{const i=await G.getAuditLogs(50);h(i.data)}catch(i){r.error("Failed to load audit logs"),console.error(i)}finally{C(!1)}},p=i=>{const s=new Set(m);s.has(i)?s.delete(i):s.add(i),w(s)},g=async i=>{var s,x;try{await G.updateUser(i.id,{is_active:!i.is_active}),r.success(`User ${i.is_active?"deactivated":"activated"}`),u()}catch(j){r.error(((x=(s=j.response)==null?void 0:s.data)==null?void 0:x.error)||"Failed to update user")}},A=async i=>{var s,x;if(confirm(`Are you sure you want to delete user "${i.username}"? This cannot be undone.`))try{await G.deleteUser(i.id),r.success("User deleted"),u()}catch(j){r.error(((x=(s=j.response)==null?void 0:s.data)==null?void 0:x.error)||"Failed to delete user")}},l=async(i,s)=>{var x,j;try{await G.assignRole(i,s),r.success("Role assigned"),u()}catch(M){r.error(((j=(x=M.response)==null?void 0:x.data)==null?void 0:j.error)||"Failed to assign role")}},S=async(i,s)=>{var x,j;try{await G.removeRole(i,s),r.success("Role removed"),u()}catch(M){r.error(((j=(x=M.response)==null?void 0:x.data)==null?void 0:j.error)||"Failed to remove role")}},n=async i=>{var s,x;try{await G.unlockUser(i.id),r.success(`Account "${i.username}" unlocked`),u()}catch(j){r.error(((x=(s=j.response)==null?void 0:s.data)==null?void 0:x.error)||"Failed to unlock account")}},a=i=>new Date(i).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),t=i=>{switch(i){case"admin":return"bg-red-500/20 text-red-400 border-red-500/30";case"user":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"auditor":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"viewer":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return v?e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):k?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Be,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"User Management"})]}),e.jsxs(z,{variant:"status",type:"completed",children:[d.length," users"]})]}),e.jsx("div",{className:"space-y-3",children:d.map(i=>{const s=m.has(i.id),x=i.roles||[];return e.jsxs("div",{className:"bg-dark-bg rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>p(i.id),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"text-slate-400",children:s?e.jsx(Ee,{className:"h-4 w-4"}):e.jsx(Fe,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${i.is_active!==!1?"bg-green-400":"bg-red-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:i.username}),e.jsx("p",{className:"text-sm text-slate-400",children:i.email})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex gap-1",children:x.map(j=>e.jsx("span",{className:`px-2 py-0.5 text-xs rounded border capitalize ${t(j)}`,children:j},j))}),i.is_locked&&e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded border bg-red-500/20 text-red-400 border-red-500/30 flex items-center gap-1",children:[e.jsx(de,{className:"h-3 w-3"}),"Locked"]}),e.jsx("span",{className:"text-xs text-slate-500",children:i.created_at?a(i.created_at):"N/A"})]})]}),s&&e.jsxs("div",{className:"border-t border-dark-border p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"Manage Roles"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:ms.map(j=>{const M=x.includes(j.id);return e.jsxs("button",{onClick:$=>{$.stopPropagation(),M?S(i.id,j.id):l(i.id,j.id)},className:`p-3 rounded-lg border text-left transition-colors ${M?"bg-primary/20 border-primary/50 text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-primary/30"}`,children:[e.jsx("p",{className:"font-medium text-sm capitalize",children:j.name}),e.jsx("p",{className:"text-xs opacity-75",children:j.description})]},j.id)})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-dark-border",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{variant:i.is_active!==!1?"secondary":"primary",size:"sm",onClick:j=>{j.stopPropagation(),g(i)},children:i.is_active!==!1?e.jsxs(e.Fragment,{children:[e.jsx(Ye,{className:"h-4 w-4 mr-1"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"h-4 w-4 mr-1"}),"Activate"]})}),i.is_locked&&e.jsxs(f,{variant:"primary",size:"sm",onClick:j=>{j.stopPropagation(),n(i)},children:[e.jsx(Qe,{className:"h-4 w-4 mr-1"}),"Unlock Account"]})]}),e.jsxs(f,{variant:"secondary",size:"sm",onClick:j=>{j.stopPropagation(),A(i)},className:"text-red-400 hover:text-red-300 hover:bg-red-500/10",children:[e.jsx(X,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})]},i.id)})})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Xe,{className:"h-6 w-6 text-purple-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Audit Logs"})]}),e.jsx(f,{variant:"secondary",onClick:()=>{y(!o),!o&&F.length===0&&P()},children:o?"Hide Logs":"Show Logs"})]}),o&&e.jsx(e.Fragment,{children:b?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(R,{})}):F.length===0?e.jsx("p",{className:"text-slate-400 text-center py-8",children:"No audit logs found"}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:F.map(i=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-dark-bg rounded-lg text-sm",children:[e.jsx(Q,{className:"h-4 w-4 text-slate-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium text-white",children:i.action}),i.target_type&&e.jsxs("span",{className:"text-slate-400",children:["on ",i.target_type]}),i.target_id&&e.jsx("span",{className:"text-xs text-slate-500 font-mono truncate max-w-32",children:i.target_id})]}),i.details&&e.jsx("p",{className:"text-xs text-slate-500 mt-1 truncate",children:i.details})]}),e.jsx("span",{className:"text-xs text-slate-500 whitespace-nowrap",children:a(i.created_at)})]},i.id))})}),!o&&e.jsx("p",{className:"text-slate-400",children:"View a log of administrative actions performed in the system."})]})]}):e.jsx(_,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(q,{className:"h-12 w-12 text-yellow-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-slate-400",children:"You don't have permission to access the administration panel."}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Contact an administrator if you need elevated access."})]})})},ue=["#ef4444","#f97316","#eab308","#22c55e","#14b8a6","#3b82f6","#8b5cf6","#ec4899","#6366f1","#64748b"],hs=()=>{const[d,I]=c.useState([]),[F,h]=c.useState(!0),[v,N]=c.useState(!1),[b,C]=c.useState(null),[m,w]=c.useState({name:"",description:"",targets:"",color:ue[0]});c.useEffect(()=>{o()},[]);const o=async()=>{h(!0);try{const p=await te.getAll();I(p.data)}catch(p){r.error("Failed to load target groups"),console.error(p)}finally{h(!1)}},y=()=>{w({name:"",description:"",targets:"",color:ue[0]}),C(null),N(!1)},k=p=>{const g=JSON.parse(p.targets||"[]");w({name:p.name,description:p.description||"",targets:g.join(`
`),color:p.color}),C(p.id),N(!0)},E=async p=>{var A,l;p.preventDefault();const g=m.targets.split(`
`).map(S=>S.trim()).filter(S=>S.length>0);if(!m.name.trim()){r.error("Name is required");return}if(g.length===0){r.error("At least one target is required");return}try{b?(await te.update(b,{name:m.name,description:m.description||void 0,targets:g,color:m.color}),r.success("Target group updated")):(await te.create({name:m.name,description:m.description||void 0,targets:g,color:m.color}),r.success("Target group created")),y(),o()}catch(S){r.error(((l=(A=S.response)==null?void 0:A.data)==null?void 0:l.error)||"Failed to save target group")}},u=async(p,g)=>{var A,l;if(confirm(`Delete target group "${g}"?`))try{await te.delete(p),r.success("Target group deleted"),o()}catch(S){r.error(((l=(A=S.response)==null?void 0:A.data)==null?void 0:l.error)||"Failed to delete")}},P=p=>{try{return JSON.parse(p||"[]")}catch{return[]}};return F?e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Target Groups"})]}),!v&&e.jsxs(f,{variant:"primary",onClick:()=>N(!0),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"New Group"]})]})}),v&&e.jsx(_,{children:e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:b?"Edit Target Group":"Create Target Group"}),e.jsx("button",{type:"button",onClick:y,className:"text-slate-400 hover:text-white",children:e.jsx(oe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:m.name,onChange:p=>w({...m,name:p.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Production Servers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Color"}),e.jsx("div",{className:"flex gap-2",children:ue.map(p=>e.jsx("button",{type:"button",onClick:()=>w({...m,color:p}),className:`w-8 h-8 rounded-full border-2 transition-all ${m.color===p?"border-white scale-110":"border-transparent"}`,style:{backgroundColor:p}},p))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:m.description,onChange:p=>w({...m,description:p.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Targets (one per line)"}),e.jsx("textarea",{value:m.targets,onChange:p=>w({...m,targets:p.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:5,placeholder:`192.168.1.0/24
10.0.0.1
example.com`})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:y,children:"Cancel"}),e.jsxs(f,{type:"submit",variant:"primary",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),b?"Update":"Create"]})]})]})}),d.length===0&&!v?e.jsx(_,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ze,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No target groups yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create groups to organize your scan targets"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(p=>{const g=P(p.targets);return e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:p.color}}),e.jsx("h4",{className:"font-medium text-white",children:p.name})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>k(p),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>u(p.id,p.name),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",children:e.jsx(X,{className:"h-4 w-4"})})]})]}),p.description&&e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:p.description}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:[g.length," target",g.length!==1?"s":""]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[g.slice(0,5).map((A,l)=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-300 font-mono",children:A},l)),g.length>5&&e.jsxs("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-500",children:["+",g.length-5," more"]})]})]})]},p.id)})})]})},Ae={name:"",description:"",schedule_type:"daily",schedule_value:"02:00",targets:"",port_range_start:1,port_range_end:1e3,threads:100,enable_os_detection:!0,enable_service_detection:!0,enable_vuln_scan:!0,enable_enumeration:!1},Pe=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],us=()=>{const[d,I]=c.useState([]),[F,h]=c.useState([]),[v,N]=c.useState(!0),[b,C]=c.useState(!1),[m,w]=c.useState(null),[o,y]=c.useState(Ae),[k,E]=c.useState(0),[u,P]=c.useState(1);c.useEffect(()=>{p()},[]);const p=async()=>{N(!0);try{const[s,x]=await Promise.all([ee.getAll(),te.getAll()]);I(s.data),h(x.data)}catch(s){r.error("Failed to load scheduled scans"),console.error(s)}finally{N(!1)}},g=()=>{y(Ae),w(null),C(!1),E(0),P(1)},A=s=>{const x=JSON.parse(s.config);if(y({name:s.name,description:s.description||"",schedule_type:s.schedule_type,schedule_value:s.schedule_value,targets:x.targets.join(`
`),port_range_start:x.port_range[0],port_range_end:x.port_range[1],threads:x.threads,enable_os_detection:x.enable_os_detection,enable_service_detection:x.enable_service_detection,enable_vuln_scan:x.enable_vuln_scan,enable_enumeration:x.enable_enumeration}),s.schedule_type==="weekly"){const j=s.schedule_value.split(" ");j.length>=2&&E(parseInt(j[1])||0)}else if(s.schedule_type==="monthly"){const j=s.schedule_value.split(" ");j.length>=2&&P(parseInt(j[1])||1)}w(s.id),C(!0)},l=()=>{const s=o.schedule_value.includes(":")?o.schedule_value:"02:00";switch(o.schedule_type){case"daily":return s;case"weekly":return`${s} ${k}`;case"monthly":return`${s} ${u}`;default:return s}},S=async s=>{var $,Z;s.preventDefault();const x=o.targets.split(`
`).map(H=>H.trim()).filter(H=>H.length>0);if(!o.name.trim()){r.error("Name is required");return}if(x.length===0){r.error("At least one target is required");return}const j={targets:x,port_range:[o.port_range_start,o.port_range_end],threads:o.threads,enable_os_detection:o.enable_os_detection,enable_service_detection:o.enable_service_detection,enable_vuln_scan:o.enable_vuln_scan,enable_enumeration:o.enable_enumeration},M=l();try{m?(await ee.update(m,{name:o.name,description:o.description||void 0,config:j,schedule_type:o.schedule_type,schedule_value:M}),r.success("Scheduled scan updated")):(await ee.create({name:o.name,description:o.description||void 0,config:j,schedule_type:o.schedule_type,schedule_value:M}),r.success("Scheduled scan created")),g(),p()}catch(H){r.error(((Z=($=H.response)==null?void 0:$.data)==null?void 0:Z.error)||"Failed to save scheduled scan")}},n=async s=>{var x,j;try{await ee.update(s.id,{is_active:!s.is_active}),r.success(`Scheduled scan ${s.is_active?"paused":"activated"}`),p()}catch(M){r.error(((j=(x=M.response)==null?void 0:x.data)==null?void 0:j.error)||"Failed to update")}},a=async(s,x)=>{var j,M;if(confirm(`Delete scheduled scan "${x}"?`))try{await ee.delete(s),r.success("Scheduled scan deleted"),p()}catch($){r.error(((M=(j=$.response)==null?void 0:j.data)==null?void 0:M.error)||"Failed to delete")}},t=s=>{const x=JSON.parse(s.targets||"[]");y(j=>({...j,targets:x.join(`
`)}))},i=s=>{const x=s.schedule_value.split(" "),j=x[0];switch(s.schedule_type){case"daily":return`Daily at ${j}`;case"weekly":return`Every ${Pe[parseInt(x[1])||0]} at ${j}`;case"monthly":return`Monthly on day ${x[1]||1} at ${j}`;default:return s.schedule_value}};return v?e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scheduled Scans"})]}),!b&&e.jsxs(f,{variant:"primary",onClick:()=>C(!0),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"New Schedule"]})]})}),b&&e.jsx(_,{children:e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:m?"Edit Scheduled Scan":"Create Scheduled Scan"}),e.jsx("button",{type:"button",onClick:g,className:"text-slate-400 hover:text-white",children:e.jsx(oe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:o.name,onChange:s=>y({...o,name:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Daily Network Scan"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:o.description,onChange:s=>y({...o,description:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4"})," Schedule"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Frequency"}),e.jsxs("select",{value:o.schedule_type,onChange:s=>y({...o,schedule_type:s.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),o.schedule_type==="weekly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Week"}),e.jsx("select",{value:k,onChange:s=>E(parseInt(s.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Pe.map((s,x)=>e.jsx("option",{value:x,children:s},s))})]}),o.schedule_type==="monthly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Month"}),e.jsx("select",{value:u,onChange:s=>P(parseInt(s.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Array.from({length:28},(s,x)=>x+1).map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Time (UTC)"}),e.jsx("input",{type:"time",value:o.schedule_value.split(" ")[0],onChange:s=>y({...o,schedule_value:s.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Targets (one per line)"}),F.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Use group:"}),F.slice(0,3).map(s=>e.jsx("button",{type:"button",onClick:()=>t(s),className:"px-2 py-0.5 text-xs rounded border border-dark-border text-slate-400 hover:text-white hover:border-primary",style:{borderLeftColor:s.color,borderLeftWidth:3},children:s.name},s.id))]})]}),e.jsx("textarea",{value:o.targets,onChange:s=>y({...o,targets:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:4,placeholder:`192.168.1.0/24
10.0.0.1`})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port Start"}),e.jsx("input",{type:"number",value:o.port_range_start,onChange:s=>y({...o,port_range_start:parseInt(s.target.value)||1}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port End"}),e.jsx("input",{type:"number",value:o.port_range_end,onChange:s=>y({...o,port_range_end:parseInt(s.target.value)||1e3}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Threads"}),e.jsx("input",{type:"number",value:o.threads,onChange:s=>y({...o,threads:parseInt(s.target.value)||100}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:1e3})]})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:[{key:"enable_os_detection",label:"OS Detection"},{key:"enable_service_detection",label:"Service Detection"},{key:"enable_vuln_scan",label:"Vulnerability Scan"},{key:"enable_enumeration",label:"Enumeration"}].map(({key:s,label:x})=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o[s],onChange:j=>y({...o,[s]:j.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-slate-300",children:x})]},s))}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:g,children:"Cancel"}),e.jsxs(f,{type:"submit",variant:"primary",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),m?"Update":"Create"]})]})]})}),d.length===0&&!b?e.jsx(_,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Q,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scheduled scans"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create automated recurring scans"})]})}):e.jsx("div",{className:"space-y-3",children:d.map(s=>{const x=JSON.parse(s.config);return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.is_active?"bg-green-500/20":"bg-slate-500/20"}`,children:e.jsx(Q,{className:`h-5 w-5 ${s.is_active?"text-green-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-white",children:s.name}),e.jsx(z,{variant:"status",type:s.is_active?"completed":"pending",children:s.is_active?"Active":"Paused"})]}),e.jsx("p",{className:"text-sm text-slate-400",children:i(s)}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[x.targets.length," target",x.targets.length!==1?"s":""," | Ports ",x.port_range[0],"-",x.port_range[1]," |",s.run_count," runs",s.last_run_at&&e.jsxs(e.Fragment,{children:[" | Last run ",He(new Date(s.last_run_at))," ago"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>n(s),className:`p-2 rounded transition-colors ${s.is_active?"text-yellow-400 hover:bg-yellow-500/20":"text-green-400 hover:bg-green-500/20"}`,title:s.is_active?"Pause":"Activate",children:s.is_active?e.jsx(es,{className:"h-4 w-4"}):e.jsx(ss,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>A(s),className:"p-2 text-slate-400 hover:text-primary transition-colors",children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>a(s.id,s.name),className:"p-2 text-slate-400 hover:text-red-400 transition-colors",children:e.jsx(X,{className:"h-4 w-4"})})]})]})},s.id)})})]})},ps=()=>{const[d,I]=c.useState(null),[F,h]=c.useState(!0),[v,N]=c.useState(!1),[b,C]=c.useState(!1),[m,w]=c.useState(!1),[o,y]=c.useState(!1),[k,E]=c.useState(null),[u,P]=c.useState({email_on_scan_complete:!1,email_on_critical_vuln:!0,email_address:"",slack_webhook_url:"",teams_webhook_url:""});c.useEffect(()=>{p(),g()},[]);const p=async()=>{var a;h(!0);try{const t=await K.getSettings();I(t.data),P({email_on_scan_complete:t.data.email_on_scan_complete,email_on_critical_vuln:t.data.email_on_critical_vuln,email_address:t.data.email_address||"",slack_webhook_url:t.data.slack_webhook_url||"",teams_webhook_url:t.data.teams_webhook_url||""})}catch(t){((a=t.response)==null?void 0:a.status)!==404&&(r.error("Failed to load notification settings"),console.error(t))}finally{h(!1)}},g=async()=>{try{const a=await K.checkSmtpStatus();E(a.data.configured)}catch(a){console.error("Failed to check SMTP status:",a),E(!1)}},A=async a=>{var t,i;if(a.preventDefault(),(u.email_on_scan_complete||u.email_on_critical_vuln)&&!u.email_address){r.error("Email address is required when notifications are enabled");return}N(!0);try{const s=await K.updateSettings(u);I(s.data),r.success("Notification settings saved")}catch(s){r.error(((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.error)||"Failed to save settings")}finally{N(!1)}},l=async()=>{var a,t;if(!u.slack_webhook_url){r.error("Please enter a Slack webhook URL first");return}C(!0);try{u.slack_webhook_url!==(d==null?void 0:d.slack_webhook_url)&&await K.updateSettings({slack_webhook_url:u.slack_webhook_url});const i=await K.testSlack();r.success(i.data.message)}catch(i){r.error(((t=(a=i.response)==null?void 0:a.data)==null?void 0:t.error)||"Failed to send test message")}finally{C(!1)}},S=async()=>{var a,t;if(!u.teams_webhook_url){r.error("Please enter a Teams webhook URL first");return}w(!0);try{u.teams_webhook_url!==(d==null?void 0:d.teams_webhook_url)&&await K.updateSettings({teams_webhook_url:u.teams_webhook_url});const i=await K.testTeams();r.success(i.data.message)}catch(i){r.error(((t=(a=i.response)==null?void 0:a.data)==null?void 0:t.error)||"Failed to send test message")}finally{w(!1)}},n=async()=>{var a,t;if(!u.email_address){r.error("Please enter an email address first");return}if(!k){r.error("SMTP is not configured on the server. Contact your administrator.");return}y(!0);try{u.email_address!==(d==null?void 0:d.email_address)&&await K.updateSettings({email_address:u.email_address});const i=await K.testEmail();r.success(i.data.message)}catch(i){r.error(((t=(a=i.response)==null?void 0:a.data)==null?void 0:t.error)||"Failed to send test email")}finally{y(!1)}};return F?e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Te,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Notification Settings"})]}),e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Notification Email Address"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"email",value:u.email_address,onChange:a=>P({...u,email_address:a.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"your@email.com"})]}),e.jsx(f,{type:"button",variant:"secondary",onClick:n,disabled:!u.email_address||o||!k,title:k?"Send test email":"SMTP not configured on server",children:o?e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-2",children:"Sending..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Email address where notifications will be sent"}),k!==null&&e.jsx("span",{className:`text-xs flex items-center gap-1 ${k?"text-green-400":"text-amber-400"}`,children:k?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-3 w-3"}),"SMTP configured"]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-3 w-3"}),"SMTP not configured"]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Email Notifications"}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:u.email_on_scan_complete,onChange:a=>P({...u,email_on_scan_complete:a.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"font-medium text-white",children:"Scan Completion"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Receive an email when any of your scans complete, including a summary of findings"})]})]}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:u.email_on_critical_vuln,onChange:a=>P({...u,email_on_critical_vuln:a.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"font-medium text-white",children:"Critical Vulnerabilities"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Get immediate alerts when critical or high severity vulnerabilities are discovered"})]})]})]}),k===!1?e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(q,{className:"h-5 w-5 text-amber-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-200",children:"SMTP is not configured on this server. Email notifications are disabled."}),e.jsx("p",{className:"text-xs text-amber-300/70 mt-1",children:"Contact your administrator to configure SMTP settings (SMTP_HOST, SMTP_USER, etc.)"})]})]})}):e.jsx("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ge,{className:"h-5 w-5 text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-200",children:k?"Email notifications are ready. Use the Test button to verify delivery.":"Checking SMTP configuration..."}),e.jsx("p",{className:"text-xs text-blue-300/70 mt-1",children:"Contact your administrator if you're not receiving emails."})]})]})}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-dark-border",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(ts,{className:"h-4 w-4"}),"Webhook Integrations"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Slack Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:u.slack_webhook_url,onChange:a=>P({...u,slack_webhook_url:a.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://hooks.slack.com/services/YOUR/WEBHOOK/URL"}),e.jsx(f,{type:"button",variant:"secondary",onClick:l,disabled:!u.slack_webhook_url||b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Send scan notifications to a Slack channel. Create a webhook at"," ",e.jsx("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Slack Incoming Webhooks"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Microsoft Teams Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:u.teams_webhook_url,onChange:a=>P({...u,teams_webhook_url:a.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://outlook.office.com/webhook/YOUR/WEBHOOK/URL"}),e.jsx(f,{type:"button",variant:"secondary",onClick:S,disabled:!u.teams_webhook_url||m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Send scan notifications to a Teams channel. Create a webhook in your Teams channel connectors."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(f,{type:"submit",variant:"primary",disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Save Settings"]})})})]})]}),d&&e.jsxs(_,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"Current Status"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Scan Complete Emails:"}),e.jsx("span",{className:`ml-2 ${d.email_on_scan_complete?"text-green-400":"text-slate-400"}`,children:d.email_on_scan_complete?"Enabled":"Disabled"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Critical Vuln Alerts:"}),e.jsx("span",{className:`ml-2 ${d.email_on_critical_vuln?"text-green-400":"text-slate-400"}`,children:d.email_on_critical_vuln?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-slate-500",children:"Last Updated:"}),e.jsx("span",{className:"ml-2 text-slate-300",children:new Date(d.updated_at).toLocaleString()})]})]})]})]})},gs=()=>{const[d,I]=c.useState([]),[F,h]=c.useState(!0),[v,N]=c.useState(""),[b,C]=c.useState(""),[m,w]=c.useState(!1),[o,y]=c.useState(null),[k,E]=c.useState(new Set);c.useEffect(()=>{u()},[]);const u=async()=>{h(!0);try{const S=(await Ie.getAll()).data.filter(n=>n.status==="completed");I(S)}catch(l){r.error("Failed to load scans"),console.error(l)}finally{h(!1)}},P=async()=>{var l,S;if(!v||!b){r.error("Please select two scans to compare");return}if(v===b){r.error("Please select two different scans");return}w(!0);try{const n=await ze.compare(v,b);y(n.data),r.success("Comparison completed")}catch(n){r.error(((S=(l=n.response)==null?void 0:l.data)==null?void 0:S.error)||"Failed to compare scans"),console.error(n)}finally{w(!1)}},p=l=>{const S=new Set(k);S.has(l)?S.delete(l):S.add(l),E(S)},g=l=>{switch(l){case"NewService":return e.jsx(O,{className:"h-3 w-3 text-green-400"});case"ServiceRemoved":return e.jsx(Y,{className:"h-3 w-3 text-red-400"});case"ServiceChanged":case"VersionChanged":return e.jsx(ce,{className:"h-3 w-3 text-yellow-400"});default:return null}},A=l=>{switch(l){case"NewService":return"New Service";case"ServiceRemoved":return"Service Removed";case"ServiceChanged":return"Service Changed";case"VersionChanged":return"Version Changed";default:return l}};return F?e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(je,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Compare Scans"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"Select two completed scans to compare their results and identify changes in hosts, ports, services, and vulnerabilities."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Baseline Scan (Older)"}),e.jsxs("select",{value:v,onChange:l=>N(l.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a scan..."}),d.map(l=>e.jsxs("option",{value:l.id,children:[l.name," - ",new Date(l.created_at).toLocaleString()]},l.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Comparison Scan (Newer)"}),e.jsxs("select",{value:b,onChange:l=>C(l.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a scan..."}),d.map(l=>e.jsxs("option",{value:l.id,children:[l.name," - ",new Date(l.created_at).toLocaleString()]},l.id))]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(f,{variant:"primary",onClick:P,loading:m,disabled:!v||!b||v===b,children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Compare Scans"]})})]}),o&&e.jsxs(e.Fragment,{children:[e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(as,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Comparison Summary"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(O,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"New Hosts"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:o.diff.summary.total_new_hosts})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Y,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Removed"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:o.diff.summary.total_removed_hosts})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-yellow-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ce,{className:"h-4 w-4 text-yellow-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Changed"})]}),e.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:o.diff.summary.total_hosts_changed})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(_e,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"New Ports"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:o.diff.summary.total_new_ports})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(_e,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Closed"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:o.diff.summary.total_closed_ports})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(q,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"New Vulns"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:o.diff.summary.total_new_vulnerabilities})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(J,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Resolved"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:o.diff.summary.total_resolved_vulnerabilities})]})]})]}),o.diff.new_hosts.length>0&&e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(O,{className:"h-5 w-5 text-green-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["New Hosts (",o.diff.new_hosts.length,")"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.diff.new_hosts.map(l=>e.jsx("span",{className:"px-3 py-1.5 bg-green-500/20 border border-green-500/30 rounded-lg text-green-400 font-mono text-sm",children:l},l))})]}),o.diff.removed_hosts.length>0&&e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Y,{className:"h-5 w-5 text-red-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Removed Hosts (",o.diff.removed_hosts.length,")"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.diff.removed_hosts.map(l=>e.jsx("span",{className:"px-3 py-1.5 bg-red-500/20 border border-red-500/30 rounded-lg text-red-400 font-mono text-sm",children:l},l))})]}),o.diff.host_changes.length>0&&e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(be,{className:"h-5 w-5 text-yellow-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Host Changes (",o.diff.host_changes.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:o.diff.host_changes.map(l=>{const S=k.has(l.ip);return l.new_ports.length>0||l.closed_ports.length>0||l.new_vulnerabilities.length>0||l.resolved_vulnerabilities.length>0||l.service_changes.length>0||l.os_change!==null?e.jsxs("div",{className:"bg-dark-bg rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("button",{onClick:()=>p(l.ip),className:"w-full flex items-center justify-between p-4 hover:bg-dark-hover transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[S?e.jsx(Ee,{className:"h-4 w-4 text-slate-400"}):e.jsx(Fe,{className:"h-4 w-4 text-slate-400"}),e.jsx(be,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"font-mono text-white",children:l.ip}),l.hostname&&e.jsxs("span",{className:"text-sm text-slate-400",children:["(",l.hostname,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l.new_ports.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-green-500/20 border border-green-500/30 rounded text-xs text-green-400",children:["+",l.new_ports.length," ports"]}),l.closed_ports.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 border border-red-500/30 rounded text-xs text-red-400",children:["-",l.closed_ports.length," ports"]}),l.new_vulnerabilities.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 border border-red-500/30 rounded text-xs text-red-400",children:["+",l.new_vulnerabilities.length," vulns"]}),l.resolved_vulnerabilities.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-green-500/20 border border-green-500/30 rounded text-xs text-green-400",children:["-",l.resolved_vulnerabilities.length," vulns"]})]})]}),S&&e.jsxs("div",{className:"border-t border-dark-border p-4 space-y-4",children:[l.os_change&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-2",children:"Operating System Change"}),e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-3 w-3 text-red-400"}),e.jsxs("span",{className:"text-sm text-red-400",children:[l.os_change.old_os," (",l.os_change.old_confidence,"% confidence)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-3 w-3 text-green-400"}),e.jsxs("span",{className:"text-sm text-green-400",children:[l.os_change.new_os," (",l.os_change.new_confidence,"% confidence)"]})]})]})]}),l.new_ports.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-green-400"}),"New Open Ports (",l.new_ports.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:l.new_ports.map(a=>e.jsxs("div",{className:"bg-dark-surface rounded p-2 flex items-center justify-between",children:[e.jsxs("span",{className:"font-mono text-sm text-green-400",children:[a.port,"/",a.protocol]}),a.service&&e.jsxs("span",{className:"text-xs text-slate-400",children:[a.service.name,a.service.version&&` ${a.service.version}`]})]},a.port))})]}),l.closed_ports.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-red-400"}),"Closed Ports (",l.closed_ports.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:l.closed_ports.map(a=>e.jsxs("div",{className:"bg-dark-surface rounded p-2 flex items-center justify-between",children:[e.jsxs("span",{className:"font-mono text-sm text-red-400",children:[a.port,"/",a.protocol]}),a.service&&e.jsxs("span",{className:"text-xs text-slate-400",children:[a.service.name,a.service.version&&` ${a.service.version}`]})]},a.port))})]}),l.service_changes.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-yellow-400"}),"Service Changes (",l.service_changes.length,")"]}),e.jsx("div",{className:"space-y-2",children:l.service_changes.map((a,t)=>e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-mono text-sm text-white",children:[a.port,"/",a.protocol]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g(a.change_type),e.jsx("span",{className:"text-xs text-yellow-400",children:A(a.change_type)})]})]}),a.old_service&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Y,{className:"h-3 w-3 text-red-400"}),e.jsxs("span",{className:"text-red-400",children:[a.old_service,a.old_version&&` ${a.old_version}`]})]}),a.new_service&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(O,{className:"h-3 w-3 text-green-400"}),e.jsxs("span",{className:"text-green-400",children:[a.new_service,a.new_version&&` ${a.new_version}`]})]})]},t))})]}),l.new_vulnerabilities.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-red-400"}),"New Vulnerabilities (",l.new_vulnerabilities.length,")"]}),e.jsx("div",{className:"space-y-2",children:l.new_vulnerabilities.map((a,t)=>e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-white",children:a.cve_id||a.title}),e.jsx(z,{variant:"severity",type:a.severity.toLowerCase(),children:a.severity})]}),e.jsx("p",{className:"text-xs text-slate-400",children:a.description}),a.affected_service&&e.jsxs("span",{className:"text-xs text-slate-500",children:["Service: ",a.affected_service]})]},t))})]}),l.resolved_vulnerabilities.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4 text-green-400"}),"Resolved Vulnerabilities (",l.resolved_vulnerabilities.length,")"]}),e.jsx("div",{className:"space-y-2",children:l.resolved_vulnerabilities.map((a,t)=>e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1 opacity-75",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-green-400 line-through",children:a.cve_id||a.title}),e.jsx(z,{variant:"severity",type:a.severity.toLowerCase(),children:a.severity})]}),e.jsx("p",{className:"text-xs text-slate-500",children:a.description})]},t))})]})]})]},l.ip):null})})]}),o.diff.new_hosts.length===0&&o.diff.removed_hosts.length===0&&o.diff.host_changes.length===0&&e.jsx(_,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(J,{className:"h-12 w-12 text-green-400 mx-auto mb-4"}),e.jsx("p",{className:"text-lg text-white font-medium mb-2",children:"No Changes Detected"}),e.jsx("p",{className:"text-sm text-slate-400",children:"The selected scans have identical results"})]})})]}),!o&&d.length===0&&e.jsx(_,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(B,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No completed scans available"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Complete at least two scans to use the comparison feature"})]})})]})},js=()=>{const[d,I]=c.useState([]),[F,h]=c.useState(!0),[v,N]=c.useState(!1),[b,C]=c.useState(null),[m,w]=c.useState({name:"",description:""}),[o,y]=c.useState(new Set),{addScan:k}=Ve();c.useEffect(()=>{E()},[]);const E=async()=>{h(!0);try{const n=await re.getAll();I(n.data)}catch(n){r.error("Failed to load templates"),console.error(n)}finally{h(!1)}},u=()=>{w({name:"",description:""}),C(null),N(!1)},P=n=>{w({name:n.name,description:n.description||""}),C(n.id),N(!0)},p=async n=>{var a,t;if(n.preventDefault(),!m.name.trim()){r.error("Name is required");return}if(!b){r.error('Cannot create templates from this form. Use "Save as Template" in the scan form.');return}try{await re.update(b,{name:m.name,description:m.description||void 0}),r.success("Template updated"),u(),E()}catch(i){r.error(((t=(a=i.response)==null?void 0:a.data)==null?void 0:t.error)||"Failed to update template")}},g=async(n,a)=>{var t,i;if(confirm(`Delete template "${a}"?`))try{await re.delete(n),r.success("Template deleted"),E()}catch(s){r.error(((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.error)||"Failed to delete")}},A=async(n,a)=>{var i,s;const t=prompt(`Enter name for new scan (based on "${a}"):`,`${a} - ${new Date().toLocaleDateString()}`);if(t){y(new Set([...o,n]));try{const x=await re.createScan(n,t);k(x.data),r.success("Scan started from template!")}catch(x){r.error(((s=(i=x.response)==null?void 0:i.data)==null?void 0:s.error)||"Failed to create scan")}finally{y(x=>{const j=new Set(x);return j.delete(n),j})}}},l=n=>{try{return JSON.parse(n)}catch{return null}},S=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return F?e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scan Templates"})]}),e.jsx("div",{className:"text-sm text-slate-400",children:"Save scan configurations for quick reuse"})]})}),v&&e.jsx(_,{children:e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Edit Template"}),e.jsx("button",{type:"button",onClick:u,className:"text-slate-400 hover:text-white",children:e.jsx(oe,{className:"h-5 w-5"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:m.name,onChange:n=>w({...m,name:n.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Production Network Template"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("textarea",{value:m.description,onChange:n=>w({...m,description:n.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",rows:3,placeholder:"Optional description"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:u,children:"Cancel"}),e.jsxs(f,{type:"submit",variant:"primary",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Update"]})]})]})}),d.length===0&&!v?e.jsx(_,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(fe,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scan templates yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:'Save scan configurations using "Save as Template" when creating a scan'})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:d.map(n=>{const a=l(n.config),t=o.has(n.id);return e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white text-lg",children:n.name}),n.description&&e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:n.description})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>P(n),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit template",children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>g(n.id,n.name),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete template",children:e.jsx(X,{className:"h-4 w-4"})})]})]}),a&&e.jsxs("div",{className:"space-y-2 border-t border-dark-border pt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:[a.targets.length," target",a.targets.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Ports: ",a.port_range[0],"-",a.port_range[1]]})]}),a.scan_type&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-slate-400 capitalize",children:a.scan_type.replace("_"," ")})]}),a.enable_enumeration&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Enumeration: ",a.enum_depth||"light"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[a.enable_os_detection&&e.jsx(z,{variant:"status",type:"completed",children:"OS Detection"}),a.enable_service_detection&&e.jsx(z,{variant:"status",type:"completed",children:"Services"}),a.enable_vuln_scan&&e.jsx(z,{variant:"status",type:"running",children:"Vuln Scan"}),a.enable_enumeration&&e.jsx(z,{variant:"status",type:"pending",children:"Enumeration"})]})]}),e.jsxs("div",{className:"flex items-center justify-between border-t border-dark-border pt-4",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:["Created ",S(n.created_at)]}),e.jsxs(f,{variant:"primary",size:"sm",onClick:()=>A(n.id,n.name),loading:t,disabled:t,children:[e.jsx(cs,{className:"h-4 w-4 mr-1.5"}),"Create Scan"]})]})]})},n.id)})})]})},bs=()=>{const[d,I]=c.useState(!1),[F,h]=c.useState(!0),[v,N]=c.useState("idle"),[b,C]=c.useState(""),[m,w]=c.useState(""),[o,y]=c.useState([]),[k,E]=c.useState(""),[u,P]=c.useState(!1),[p,g]=c.useState(!1),[A,l]=c.useState(""),[S,n]=c.useState(""),[a,t]=c.useState(!1),[i,s]=c.useState(!1),[x,j]=c.useState(""),[M,$]=c.useState(""),[Z,H]=c.useState(!1);c.useEffect(()=>{Ue()},[]);const Ue=async()=>{h(!0);try{const T=await ne.me();I(T.data.mfa_enabled||!1)}catch(T){console.error("Failed to check MFA status:",T)}finally{h(!1)}},De=async()=>{var T,U;try{const L=await le.setup();C(L.data.secret),w(L.data.qr_code_url),y(L.data.recovery_codes),N("scan-qr")}catch(L){r.error(((U=(T=L.response)==null?void 0:T.data)==null?void 0:U.error)||"Failed to initialize MFA setup")}},$e=async T=>{var U,L;if(T.preventDefault(),!k||k.length!==6){r.error("Please enter a valid 6-digit code");return}P(!0);try{await le.verifySetup({totp_code:k}),r.success("MFA enabled successfully!"),N("show-recovery"),I(!0)}catch(V){r.error(((L=(U=V.response)==null?void 0:U.data)==null?void 0:L.error)||"Invalid verification code")}finally{P(!1)}},Oe=()=>{N("idle"),C(""),w(""),y([]),E("")},Je=async T=>{var U,L;if(T.preventDefault(),!A||!S){r.error("Password and TOTP code are required");return}t(!0);try{await le.disable({password:A,totp_code:S}),r.success("MFA disabled successfully"),I(!1),g(!1),l(""),n("")}catch(V){r.error(((L=(U=V.response)==null?void 0:U.data)==null?void 0:L.error)||"Failed to disable MFA")}finally{t(!1)}},Ke=async T=>{var U,L;if(T.preventDefault(),!x||!M){r.error("Password and TOTP code are required");return}H(!0);try{const V=await le.regenerateRecoveryCodes({password:x,totp_code:M});y(V.data.recovery_codes),r.success("Recovery codes regenerated successfully"),s(!1),j(""),$(""),N("show-recovery")}catch(V){r.error(((L=(U=V.response)==null?void 0:U.data)==null?void 0:L.error)||"Failed to regenerate recovery codes")}finally{H(!1)}},we=T=>{navigator.clipboard.writeText(T),r.success("Copied to clipboard")},qe=()=>{const T=new Blob([o.join(`
`)],{type:"text/plain"}),U=URL.createObjectURL(T),L=document.createElement("a");L.href=U,L.download="heroforge-recovery-codes.txt",document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(U),r.success("Recovery codes downloaded")};return F?e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):v!=="idle"?e.jsx("div",{className:"space-y-6",children:e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Enable Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{className:v==="scan-qr"?"text-primary":"",children:"1. Scan QR"}),e.jsx("span",{children:""}),e.jsx("span",{className:v==="verify-code"?"text-primary":"",children:"2. Verify"}),e.jsx("span",{children:""}),e.jsx("span",{className:v==="show-recovery"?"text-primary":"",children:"3. Save Codes"})]})]}),v==="scan-qr"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 1: Scan QR Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Use an authenticator app like Google Authenticator, Authy, or 1Password to scan this QR code:"}),m&&e.jsx("div",{className:"bg-white p-4 rounded-lg mb-4",children:e.jsx("img",{src:m,alt:"MFA QR Code",className:"w-64 h-64"})}),e.jsxs("div",{className:"mt-4 w-full max-w-md",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Or enter this secret manually:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{type:"text",value:b,readOnly:!0,className:"font-mono text-sm flex-1"}),e.jsx(f,{variant:"secondary",onClick:()=>we(b),children:e.jsx(ye,{className:"h-4 w-4"})})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(f,{variant:"primary",onClick:()=>N("verify-code"),children:"Next: Verify Code"})})]}),v==="verify-code"&&e.jsxs("form",{onSubmit:$e,className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(ke,{className:"h-12 w-12 text-primary mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 2: Verify Your Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Enter the 6-digit code from your authenticator app to confirm setup:"}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsx(D,{type:"text",value:k,onChange:T=>E(T.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center text-2xl tracking-widest font-mono",maxLength:6,autoFocus:!0})})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:()=>N("scan-qr"),children:"Back"}),e.jsx(f,{type:"submit",variant:"primary",loading:u,disabled:u||k.length!==6,children:"Verify & Enable MFA"})]})]}),v==="show-recovery"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(q,{className:"h-6 w-6 text-yellow-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-yellow-400 mb-2",children:"Save Your Recovery Codes"}),e.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Store these recovery codes in a safe place. Each code can be used once to access your account if you lose your authenticator device."}),e.jsx("div",{className:"grid grid-cols-2 gap-2 bg-dark-bg rounded-lg p-4 font-mono text-sm mb-4",children:o.map((T,U)=>e.jsxs("div",{className:"text-white",children:[U+1,". ",T]},U))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"secondary",onClick:()=>we(o.join(`
`)),children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Copy Codes"]}),e.jsxs(f,{variant:"secondary",onClick:qe,children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"Download Codes"]})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(f,{variant:"primary",onClick:Oe,children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Finish Setup"]})})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(B,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-start justify-between mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[d?e.jsx(J,{className:"h-6 w-6 text-green-400 flex-shrink-0"}):e.jsx(q,{className:"h-6 w-6 text-yellow-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white mb-1",children:d?"MFA Enabled":"MFA Disabled"}),e.jsx("p",{className:"text-sm text-slate-400",children:d?"Your account is protected with two-factor authentication.":"Enable MFA to add an extra layer of security to your account."})]})]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${d?"bg-green-400":"bg-yellow-400"}`})]}),d?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ie,{className:"h-5 w-5 text-primary"}),e.jsx("h5",{className:"font-medium text-white",children:"Recovery Codes"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Generate new recovery codes if you've lost the originals or used them."}),e.jsx(f,{variant:"secondary",size:"sm",onClick:()=>s(!0),children:"Regenerate Codes"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(de,{className:"h-5 w-5 text-red-400"}),e.jsx("h5",{className:"font-medium text-white",children:"Disable MFA"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Turn off two-factor authentication for your account."}),e.jsx(f,{variant:"danger",size:"sm",onClick:()=>g(!0),children:"Disable MFA"})]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h5",{className:"text-white font-medium mb-2",children:"Why enable MFA?"}),e.jsxs("ul",{className:"text-sm text-slate-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Adds an extra layer of security beyond your password"}),e.jsx("li",{children:"Prevents unauthorized access even if your password is compromised"}),e.jsx("li",{children:"Uses time-based codes from your smartphone"}),e.jsx("li",{children:"Industry standard for securing sensitive accounts"})]})]}),e.jsxs(f,{variant:"primary",onClick:De,children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Enable Two-Factor Authentication"]})]})]}),p&&e.jsx(_,{children:e.jsxs("form",{onSubmit:Je,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Disable Two-Factor Authentication"}),e.jsxs("button",{type:"button",onClick:()=>{g(!1),l(""),n("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"Disabling MFA will make your account less secure. You'll need to provide your password and a TOTP code to confirm."})}),e.jsx(D,{label:"Password",type:"password",value:A,onChange:T=>l(T.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(D,{label:"TOTP Code",type:"text",value:S,onChange:T=>n(T.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:()=>{g(!1),l(""),n("")},children:"Cancel"}),e.jsx(f,{type:"submit",variant:"danger",loading:a,disabled:a||!A||S.length!==6,children:"Disable MFA"})]})]})}),i&&e.jsx(_,{children:e.jsxs("form",{onSubmit:Ke,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Regenerate Recovery Codes"}),e.jsxs("button",{type:"button",onClick:()=>{s(!1),j(""),$("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"This will invalidate all existing recovery codes. Make sure to save the new codes in a safe place."})}),e.jsx(D,{label:"Password",type:"password",value:x,onChange:T=>j(T.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(D,{label:"TOTP Code",type:"text",value:M,onChange:T=>$(T.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:()=>{s(!1),j(""),$("")},children:"Cancel"}),e.jsx(f,{type:"submit",variant:"primary",loading:Z,disabled:Z||!x||M.length!==6,children:"Generate New Codes"})]})]})})]})},fs=()=>{const[d,I]=c.useState([]),[F,h]=c.useState(!0),[v,N]=c.useState(!1),[b,C]=c.useState(""),[m,w]=c.useState(!1),[o,y]=c.useState(null);c.useEffect(()=>{k()},[]);const k=async()=>{h(!0);try{const g=await xe.getAll();I(g.data)}catch(g){r.error("Failed to load API keys"),console.error(g)}finally{h(!1)}},E=async()=>{var g,A;if(!b.trim()){r.error("Please enter a name for the API key");return}w(!0);try{const l=await xe.create({name:b.trim()});y(l.data),C(""),await k(),r.success("API key created successfully")}catch(l){r.error(((A=(g=l.response)==null?void 0:g.data)==null?void 0:A.error)||"Failed to create API key")}finally{w(!1)}},u=async(g,A)=>{var l,S;if(confirm(`Are you sure you want to revoke the API key "${A}"? This action cannot be undone.`))try{await xe.delete(g),await k(),r.success("API key revoked successfully")}catch(n){r.error(((S=(l=n.response)==null?void 0:l.data)==null?void 0:S.error)||"Failed to revoke API key")}},P=g=>{navigator.clipboard.writeText(g),r.success("API key copied to clipboard")},p=()=>{y(null),N(!1)};return F?e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Keys"})]}),e.jsxs(f,{variant:"primary",onClick:()=>N(!0),className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4"}),"Create API Key"]})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"API keys allow programmatic access to HeroForge. Keep your keys secure and never share them publicly."}),d.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ie,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No API keys yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Create your first API key to get started"})]}):e.jsx("div",{className:"space-y-3",children:d.map(g=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary/30 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-medium text-white",children:g.name}),e.jsxs("code",{className:"px-2 py-1 bg-dark-surface rounded text-xs text-slate-400 font-mono",children:[g.prefix,"..."]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ve,{className:"h-3 w-3"}),"Created ",new Date(g.created_at).toLocaleDateString()]}),g.last_used_at&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"h-3 w-3"}),"Last used ",new Date(g.last_used_at).toLocaleDateString()]}),!g.last_used_at&&e.jsx("span",{className:"text-amber-500",children:"Never used"})]})]}),e.jsxs(f,{variant:"danger",size:"sm",onClick:()=>u(g.id,g.name),className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"Revoke"]})]},g.id))})]}),v&&!o&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Create API Key"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Key Name"}),e.jsx("input",{type:"text",value:b,onChange:g=>C(g.target.value),placeholder:"e.g., Production Server, CI/CD Pipeline",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",autoFocus:!0}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Give your API key a descriptive name to remember where it's used"})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4",children:[e.jsx(f,{variant:"secondary",onClick:()=>{N(!1),C("")},children:"Cancel"}),e.jsx(f,{variant:"primary",onClick:E,disabled:m||!b.trim(),children:m?e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-2",children:"Creating..."})]}):"Create Key"})]})]})]})}),o&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-2xl w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(J,{className:"h-6 w-6 text-green-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Key Created Successfully"})]}),e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-amber-200 font-medium mb-2",children:"Important: Save your API key now!"}),e.jsx("p",{className:"text-xs text-amber-300/70",children:"This is the only time you'll see the full key. If you lose it, you'll need to create a new one."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"API Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("code",{className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-3 text-white font-mono text-sm break-all",children:o.key}),e.jsxs(f,{variant:"secondary",onClick:()=>P(o.key),className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),"Copy"]})]})]}),e.jsxs("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-200 mb-2",children:"Using your API key"}),e.jsx("p",{className:"text-xs text-blue-300/70 mb-3",children:"Include your API key in the X-API-Key header:"}),e.jsxs("code",{className:"block bg-dark-bg border border-dark-border rounded px-3 py-2 text-xs text-slate-300 font-mono",children:['curl -H "X-API-Key: ',o.key,'" https://heroforge.example.com/api/scans']})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(f,{variant:"primary",onClick:p,children:"Done"})})]})]})})]})},ys=()=>{const[d,I]=c.useState(!0),[F,h]=c.useState(!1),[v,N]=c.useState(!1),[b,C]=c.useState(!1),[m,w]=c.useState({jira_url:"",username:"",api_token:"",project_key:"",issue_type:"Task",default_assignee:"",enabled:!0}),[o,y]=c.useState([]),[k,E]=c.useState([]),[u,P]=c.useState(!1);c.useEffect(()=>{p()},[]);const p=async()=>{var n;I(!0);try{const a=await se.getSettings();w(a.data),C(!0)}catch(a){((n=a.response)==null?void 0:n.status)===404?C(!1):console.error("Failed to load JIRA settings:",a)}finally{I(!1)}},g=async()=>{var n,a;if(!m.jira_url||!m.username||!m.api_token||!m.project_key){r.error("Please fill in all required fields");return}h(!0);try{await se.updateSettings(m),r.success("JIRA settings saved successfully"),C(!0)}catch(t){console.error("Failed to save JIRA settings:",t),r.error(((a=(n=t.response)==null?void 0:n.data)==null?void 0:a.error)||"Failed to save JIRA settings")}finally{h(!1)}},A=async()=>{var n,a;if(!b){r.error("Please save your settings first");return}N(!0);try{await se.testConnection(),r.success("JIRA connection successful!")}catch(t){console.error("JIRA connection failed:",t),r.error(((a=(n=t.response)==null?void 0:n.data)==null?void 0:a.error)||"JIRA connection failed")}finally{N(!1)}},l=async()=>{var n,a;if(!b){r.error("Please save your settings first");return}P(!0);try{const t=await se.listProjects();y(t.data),r.success(`Loaded ${t.data.length} projects`)}catch(t){console.error("Failed to load projects:",t),r.error(((a=(n=t.response)==null?void 0:n.data)==null?void 0:a.error)||"Failed to load projects")}finally{P(!1)}},S=async()=>{var n,a;if(!b||!m.project_key){r.error("Please save your settings and select a project first");return}P(!0);try{const t=await se.listIssueTypes();E(t.data),r.success(`Loaded ${t.data.length} issue types`)}catch(t){console.error("Failed to load issue types:",t),r.error(((a=(n=t.response)==null?void 0:n.data)==null?void 0:a.error)||"Failed to load issue types")}finally{P(!1)}};return d?e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Re,{className:"h-6 w-6 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"JIRA Integration"})]}),e.jsxs("div",{className:"space-y-4",children:[!b&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(q,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"JIRA Integration Not Configured"}),e.jsx("p",{children:"Configure your JIRA instance to automatically create tickets from vulnerabilities."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["JIRA URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{type:"url",placeholder:"https://your-domain.atlassian.net",value:m.jira_url,onChange:n=>w({...m,jira_url:n.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your JIRA instance URL (e.g., https://company.atlassian.net)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Username/Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{type:"text",placeholder:"user@example.com",value:m.username,onChange:n=>w({...m,username:n.target.value})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["API Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{type:"password",placeholder:"Your JIRA API token",value:m.api_token,onChange:n=>w({...m,api_token:n.target.value})}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Generate an API token at"," ",e.jsxs("a",{href:"https://id.atlassian.com/manage-profile/security/api-tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 inline-flex items-center gap-1",children:["Atlassian Account Settings ",e.jsx(Le,{className:"h-3 w-3"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Key ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:o.length>0?e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:m.project_key,onChange:n=>w({...m,project_key:n.target.value}),children:[e.jsx("option",{value:"",children:"Select a project"}),o.map(n=>e.jsxs("option",{value:n.key,children:[n.name," (",n.key,")"]},n.key))]}):e.jsx(D,{type:"text",placeholder:"PROJECT",value:m.project_key,onChange:n=>w({...m,project_key:n.target.value})})}),e.jsx(f,{onClick:l,disabled:!b||u,variant:"secondary",children:u?"Loading...":"Load Projects"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Issue Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:k.length>0?e.jsx("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:m.issue_type,onChange:n=>w({...m,issue_type:n.target.value}),children:k.map(n=>e.jsx("option",{value:n.name,children:n.name},n.id))}):e.jsx(D,{type:"text",placeholder:"Task",value:m.issue_type,onChange:n=>w({...m,issue_type:n.target.value})})}),e.jsx(f,{onClick:S,disabled:!b||!m.project_key||u,variant:"secondary",children:u?"Loading...":"Load Types"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Assignee (optional)"}),e.jsx(D,{type:"text",placeholder:"username",value:m.default_assignee||"",onChange:n=>w({...m,default_assignee:n.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Leave empty for unassigned or enter a JIRA username"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"jira-enabled",checked:m.enabled,onChange:n=>w({...m,enabled:n.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"jira-enabled",className:"text-sm font-medium text-gray-700",children:"Enable JIRA integration"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(f,{onClick:g,disabled:F,children:F?"Saving...":"Save Settings"}),e.jsx(f,{onClick:A,disabled:!b||v,variant:"secondary",children:v?"Testing...":"Test Connection"})]}),b&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(J,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("p",{className:"font-medium",children:"JIRA Integration Configured"}),e.jsx("p",{children:"You can now create JIRA tickets from vulnerabilities."})]})]})]})]}),e.jsxs(_,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"How to Use JIRA Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Configure your JIRA instance settings above and test the connection."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Navigate to any vulnerability in your scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"3"})}),e.jsx("p",{children:'Click the "Create JIRA Ticket" button to automatically create an issue with vulnerability details.'})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"The vulnerability will be linked to the JIRA ticket, and you can track it in your JIRA project."})]})]})]})]})},vs=()=>{const[d,I]=c.useState([]),[F,h]=c.useState(!0),[v,N]=c.useState(!1),[b,C]=c.useState(null),[m,w]=c.useState(null),[o,y]=c.useState([]),[k,E]=c.useState(!1),[u,P]=c.useState(""),[p,g]=c.useState(!1);c.useEffect(()=>{A(),n()},[]);const A=async()=>{h(!0);try{const t=await W.getSettings();I(t.data)}catch(t){r.error("Failed to load SIEM settings"),console.error(t)}finally{h(!1)}},l=async t=>{var i,s;w(t);try{const x=await W.testConnection(t);x.data.success?r.success("Connection test successful!"):r.error(`Connection test failed: ${x.data.message}`)}catch(x){r.error(((s=(i=x.response)==null?void 0:i.data)==null?void 0:s.error)||"Connection test failed")}finally{w(null)}},S=async t=>{var i,s;if(confirm("Are you sure you want to delete this SIEM integration?"))try{await W.deleteSettings(t),r.success("SIEM integration deleted"),A()}catch(x){r.error(((s=(i=x.response)==null?void 0:i.data)==null?void 0:s.error)||"Failed to delete SIEM integration")}},n=async()=>{E(!0);try{const t=await Ie.getAll();y(t.data.filter(i=>i.status==="completed"))}catch(t){console.error("Failed to load scans:",t)}finally{E(!1)}},a=async()=>{var i,s;if(!u){r.error("Please select a scan to export");return}if(d.filter(x=>x.enabled).length===0){r.error("No enabled SIEM integrations found. Please enable at least one integration.");return}g(!0);try{const x=await W.exportScan(u);x.data.success?(r.success(`Scan exported to ${x.data.exported_to} SIEM integration(s). ${x.data.events_count} events sent.`),x.data.errors&&x.data.errors.length>0&&x.data.errors.forEach(j=>r.warning(j))):r.error("Export failed. Check SIEM configuration.")}catch(x){r.error(((s=(i=x.response)==null?void 0:i.data)==null?void 0:s.error)||"Failed to export scan to SIEM")}finally{g(!1)}};return F?e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"SIEM Integrations"})]}),e.jsxs(f,{variant:"primary",onClick:()=>N(!0),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Add Integration"]})]}),d.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(be,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"No SIEM integrations configured"}),e.jsxs(f,{variant:"primary",onClick:()=>N(!0),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Add Your First Integration"]})]}):e.jsx("div",{className:"space-y-4",children:d.map(t=>e.jsx("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-primary/20 text-primary rounded-md text-sm font-medium uppercase",children:t.siem_type}),t.enabled?e.jsxs("span",{className:"flex items-center gap-1 text-green-400 text-sm",children:[e.jsx(J,{className:"h-4 w-4"}),"Enabled"]}):e.jsxs("span",{className:"flex items-center gap-1 text-slate-500 text-sm",children:[e.jsx(Se,{className:"h-4 w-4"}),"Disabled"]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Endpoint:"}),e.jsx("span",{className:"text-white font-mono",children:t.endpoint_url})]}),t.protocol&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Protocol:"}),e.jsx("span",{className:"text-white uppercase",children:t.protocol})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.export_on_scan_complete,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export on scan complete"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.export_on_critical_vuln,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export critical vulnerabilities"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{variant:"outline",size:"sm",onClick:()=>l(t.id),disabled:m===t.id,children:m===t.id?e.jsx(R,{}):e.jsx(ds,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>C(t),children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>S(t.id),children:e.jsx(X,{className:"h-4 w-4 text-red-400"})})]})]})},t.id))})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Manual Export"})]}),e.jsx(f,{variant:"outline",size:"sm",onClick:n,disabled:k,children:k?e.jsx(R,{}):e.jsx(ce,{className:"h-4 w-4"})})]}),d.filter(t=>t.enabled).length===0?e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(Se,{className:"h-5 w-5 text-amber-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-200",children:[e.jsx("p",{className:"font-medium mb-1",children:"No Enabled Integrations"}),e.jsx("p",{children:"Enable at least one SIEM integration above before exporting scan results."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Manually export scan results to all enabled SIEM integrations."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:u,onChange:t=>P(t.target.value),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",disabled:k||p,children:[e.jsx("option",{value:"",children:"Select a completed scan..."}),o.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",new Date(t.created_at).toLocaleDateString()," ",new Date(t.created_at).toLocaleTimeString()]},t.id))]}),e.jsx(f,{variant:"primary",onClick:a,disabled:!u||p||k,children:p?e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-2",children:"Exporting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Export to SIEM"]})})]}),o.length===0&&!k&&e.jsx("p",{className:"text-sm text-slate-500",children:"No completed scans available for export."}),e.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["Export will send data to: ",d.filter(t=>t.enabled).map(t=>t.siem_type.toUpperCase()).join(", ")]})]})]}),e.jsxs(_,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"About SIEM Integration"}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-400",children:[e.jsx("p",{children:"SIEM (Security Information and Event Management) integration allows HeroForge to automatically export scan results and vulnerability findings to your security monitoring platform."}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Syslog:"})," RFC 5424 compliant syslog over TCP/UDP"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Splunk:"})," Splunk HTTP Event Collector (HEC)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Elasticsearch:"})," Direct indexing via Bulk API"]})]})]})]}),(v||b)&&e.jsx(Ns,{settings:b,onClose:()=>{N(!1),C(null)},onSave:()=>{N(!1),C(null),A()}})]})},Ns=({settings:d,onClose:I,onSave:F})=>{const[h,v]=c.useState({siem_type:(d==null?void 0:d.siem_type)||"syslog",endpoint_url:(d==null?void 0:d.endpoint_url)||"",api_key:(d==null?void 0:d.api_key)||"",protocol:(d==null?void 0:d.protocol)||"tcp",enabled:(d==null?void 0:d.enabled)??!0,export_on_scan_complete:(d==null?void 0:d.export_on_scan_complete)??!1,export_on_critical_vuln:(d==null?void 0:d.export_on_critical_vuln)??!0}),[N,b]=c.useState(!1),C=async m=>{var w,o;if(m.preventDefault(),!h.endpoint_url){r.error("Endpoint URL is required");return}if(h.siem_type==="splunk"&&!h.api_key){r.error("API key is required for Splunk HEC");return}b(!0);try{if(d){const y={endpoint_url:h.endpoint_url,enabled:h.enabled,export_on_scan_complete:h.export_on_scan_complete,export_on_critical_vuln:h.export_on_critical_vuln};h.api_key&&(y.api_key=h.api_key),h.siem_type==="syslog"&&(y.protocol=h.protocol),await W.updateSettings(d.id,y),r.success("SIEM integration updated")}else{const y={siem_type:h.siem_type,endpoint_url:h.endpoint_url,enabled:h.enabled,export_on_scan_complete:h.export_on_scan_complete,export_on_critical_vuln:h.export_on_critical_vuln};h.api_key&&(y.api_key=h.api_key),h.siem_type==="syslog"&&(y.protocol=h.protocol),await W.createSettings(y),r.success("SIEM integration created")}F()}catch(y){r.error(((o=(w=y.response)==null?void 0:w.data)==null?void 0:o.error)||"Failed to save SIEM integration")}finally{b(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white",children:[d?"Edit":"Add"," SIEM Integration"]}),e.jsx("button",{onClick:I,className:"text-slate-400 hover:text-white",children:e.jsx(oe,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:C,className:"p-6 space-y-6",children:[!d&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"SIEM Type"}),e.jsxs("select",{value:h.siem_type,onChange:m=>v({...h,siem_type:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"syslog",children:"Syslog (RFC 5424)"}),e.jsx("option",{value:"splunk",children:"Splunk HEC"}),e.jsx("option",{value:"elasticsearch",children:"Elasticsearch"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Endpoint URL"}),e.jsx("input",{type:"text",value:h.endpoint_url,onChange:m=>v({...h,endpoint_url:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:h.siem_type==="syslog"?"192.168.1.100:514":h.siem_type==="splunk"?"https://splunk.example.com:8088":"https://elasticsearch.example.com:9200"})]}),h.siem_type==="syslog"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Protocol"}),e.jsxs("select",{value:h.protocol,onChange:m=>v({...h,protocol:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"})]})]}),(h.siem_type==="splunk"||h.siem_type==="elasticsearch")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:[h.siem_type==="splunk"?"HEC Token":"API Key"," ",h.siem_type==="splunk"&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"password",value:h.api_key,onChange:m=>v({...h,api_key:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:d?"(leave blank to keep current)":""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h.enabled,onChange:m=>v({...h,enabled:m.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Enable this integration"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h.export_on_scan_complete,onChange:m=>v({...h,export_on_scan_complete:m.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export when scans complete"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h.export_on_critical_vuln,onChange:m=>v({...h,export_on_critical_vuln:m.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export critical vulnerabilities immediately"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(f,{type:"button",variant:"outline",onClick:I,children:"Cancel"}),e.jsx(f,{type:"submit",variant:"primary",disabled:N,children:N?e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs("span",{children:[d?"Update":"Create"," Integration"]})})]})]})]})})},As=()=>{const[d,I]=c.useState("profile"),F=[{name:"Account",tabs:[{id:"profile",label:"Profile",icon:e.jsx(pe,{className:"h-4 w-4"}),component:e.jsx(os,{})},{id:"security",label:"Security",icon:e.jsx(de,{className:"h-4 w-4"}),component:e.jsx(bs,{})},{id:"api-keys",label:"API Keys",icon:e.jsx(ie,{className:"h-4 w-4"}),component:e.jsx(fs,{})}]},{name:"Administration",tabs:[{id:"administration",label:"Users",icon:e.jsx(B,{className:"h-4 w-4"}),component:e.jsx(xs,{})}]},{name:"Scanning",tabs:[{id:"target-groups",label:"Target Groups",icon:e.jsx(Ne,{className:"h-4 w-4"}),component:e.jsx(hs,{})},{id:"scheduled-scans",label:"Scheduled Scans",icon:e.jsx(Q,{className:"h-4 w-4"}),component:e.jsx(us,{})},{id:"templates",label:"Templates",icon:e.jsx(fe,{className:"h-4 w-4"}),component:e.jsx(js,{})},{id:"compare-scans",label:"Compare",icon:e.jsx(je,{className:"h-4 w-4"}),component:e.jsx(gs,{})}]},{name:"Integrations",tabs:[{id:"notifications",label:"Notifications",icon:e.jsx(Te,{className:"h-4 w-4"}),component:e.jsx(ps,{})},{id:"jira-integration",label:"JIRA",icon:e.jsx(Le,{className:"h-4 w-4"}),component:e.jsx(ys,{})},{id:"siem-integration",label:"SIEM",icon:e.jsx(Me,{className:"h-4 w-4"}),component:e.jsx(vs,{})}]}],v=F.flatMap(N=>N.tabs).find(N=>N.id===d);return e.jsx(Ge,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Re,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Settings"})]}),e.jsx("p",{className:"text-slate-400",children:"Manage your account, scanning configuration, and integrations"})]}),e.jsx("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:e.jsx("div",{className:"flex flex-wrap gap-6",children:F.map(N=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:N.name}),e.jsx("div",{className:"flex gap-1",children:N.tabs.map(b=>e.jsxs("button",{onClick:()=>I(b.id),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${d===b.id?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[b.icon,b.label]},b.id))})]},N.name))})}),e.jsx("div",{children:v==null?void 0:v.component})]})})};export{As as default};
