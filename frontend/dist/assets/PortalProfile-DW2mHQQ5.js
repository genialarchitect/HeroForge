import{j as e}from"./vendor-state-BXNPjUwt.js";import{r as a}from"./vendor-react-5KxtEOLM.js";import{P as p}from"./PortalLayout-Bj17qdPQ.js";import{az as C,au as T}from"./index-t7VPhhr8.js";import"./vendor-ui-DGSzT-Xm.js";import"./vendor-utils-DfRopTPV.js";function J(){const[t,u]=a.useState(null),[S,E]=a.useState(!0),[x,b]=a.useState(""),[k,i]=a.useState(""),[l,g]=a.useState(!1),[s,o]=a.useState({}),[f,w]=a.useState(!1),[F,h]=a.useState(!1),[d,c]=a.useState({current_password:"",new_password:""}),[j,m]=a.useState(""),[y,n]=a.useState(""),[v,N]=a.useState(!1);a.useEffect(()=>{L()},[]);const L=async()=>{try{const r=await C.getProfile();u(r.data),o({first_name:r.data.first_name||"",last_name:r.data.last_name||"",phone:r.data.phone||"",title:r.data.title||""})}catch(r){b("Failed to load profile"),console.error(r)}finally{E(!1)}},A=async()=>{w(!0),b(""),i("");try{const r=await C.updateProfile(s);u(r.data),g(!1),i("Profile updated successfully"),setTimeout(()=>i(""),3e3)}catch(r){b("Failed to update profile"),console.error(r)}finally{w(!1)}},D=()=>{g(!1),t&&o({first_name:t.first_name||"",last_name:t.last_name||"",phone:t.phone||"",title:t.title||""})},I=async r=>{var P,_;if(r.preventDefault(),n(""),d.new_password!==j){n("Passwords do not match");return}if(d.new_password.length<8){n("Password must be at least 8 characters");return}N(!0);try{await T.changePassword(d),h(!1),c({current_password:"",new_password:""}),m(""),i("Password changed successfully"),setTimeout(()=>i(""),3e3)}catch(q){n(((_=(P=q.response)==null?void 0:P.data)==null?void 0:_.error)||"Failed to change password")}finally{N(!1)}};return S?e.jsx(p,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin"})})}):t?e.jsx(p,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Profile"}),!l&&e.jsx("button",{onClick:()=>g(!0),className:"px-4 py-2 bg-primary hover:bg-primary-dark text-white rounded-lg text-sm transition-colors",children:"Edit Profile"})]}),x&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300 p-4 rounded-lg",children:x}),k&&e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 text-green-700 dark:text-green-300 p-4 rounded-lg",children:k}),e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4",children:"Account Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Email"}),e.jsx("p",{className:"text-slate-900 dark:text-white bg-light-hover dark:bg-dark-hover px-4 py-2 rounded-lg",children:t.email}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"Email cannot be changed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Organization"}),e.jsx("p",{className:"text-slate-900 dark:text-white bg-light-hover dark:bg-dark-hover px-4 py-2 rounded-lg",children:t.customer_name||"Not set"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-1",children:"First Name"}),l?e.jsx("input",{type:"text",value:s.first_name||"",onChange:r=>o({...s,first_name:r.target.value}),className:"w-full bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white px-4 py-2 rounded-lg border border-light-border dark:border-dark-border focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"Enter first name"}):e.jsx("p",{className:"text-slate-900 dark:text-white bg-light-hover dark:bg-dark-hover px-4 py-2 rounded-lg",children:t.first_name||e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Not set"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Last Name"}),l?e.jsx("input",{type:"text",value:s.last_name||"",onChange:r=>o({...s,last_name:r.target.value}),className:"w-full bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white px-4 py-2 rounded-lg border border-light-border dark:border-dark-border focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"Enter last name"}):e.jsx("p",{className:"text-slate-900 dark:text-white bg-light-hover dark:bg-dark-hover px-4 py-2 rounded-lg",children:t.last_name||e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Not set"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Phone"}),l?e.jsx("input",{type:"tel",value:s.phone||"",onChange:r=>o({...s,phone:r.target.value}),className:"w-full bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white px-4 py-2 rounded-lg border border-light-border dark:border-dark-border focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"Enter phone number"}):e.jsx("p",{className:"text-slate-900 dark:text-white bg-light-hover dark:bg-dark-hover px-4 py-2 rounded-lg",children:t.phone||e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Not set"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Title"}),l?e.jsx("input",{type:"text",value:s.title||"",onChange:r=>o({...s,title:r.target.value}),className:"w-full bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white px-4 py-2 rounded-lg border border-light-border dark:border-dark-border focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"Enter job title"}):e.jsx("p",{className:"text-slate-900 dark:text-white bg-light-hover dark:bg-dark-hover px-4 py-2 rounded-lg",children:t.title||e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Not set"})})]})]}),l&&e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-light-border dark:border-dark-border",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 bg-light-hover dark:bg-dark-hover text-slate-900 dark:text-white rounded-lg text-sm transition-colors",children:"Cancel"}),e.jsx("button",{onClick:A,disabled:f,className:"px-4 py-2 bg-primary hover:bg-primary-dark text-white rounded-lg text-sm disabled:opacity-50 transition-colors",children:f?"Saving...":"Save Changes"})]})]}),e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4",children:"Account Activity"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Last Login"}),e.jsx("p",{className:"text-slate-900 dark:text-white",children:t.last_login?new Date(t.last_login).toLocaleString():"Never"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Account Created"}),e.jsx("p",{className:"text-slate-900 dark:text-white",children:new Date(t.created_at).toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4",children:"Security"}),F?e.jsxs("form",{onSubmit:I,className:"space-y-4 max-w-md",children:[y&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300 p-3 rounded-lg text-sm",children:y}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Current Password"}),e.jsx("input",{type:"password",value:d.current_password,onChange:r=>c({...d,current_password:r.target.value}),className:"w-full bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white px-4 py-2 rounded-lg border border-light-border dark:border-dark-border focus:ring-2 focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-1",children:"New Password"}),e.jsx("input",{type:"password",value:d.new_password,onChange:r=>c({...d,new_password:r.target.value}),className:"w-full bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white px-4 py-2 rounded-lg border border-light-border dark:border-dark-border focus:ring-2 focus:ring-primary focus:border-primary",required:!0,minLength:8}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"Minimum 8 characters"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:j,onChange:r=>m(r.target.value),className:"w-full bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white px-4 py-2 rounded-lg border border-light-border dark:border-dark-border focus:ring-2 focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{h(!1),c({current_password:"",new_password:""}),m(""),n("")},className:"px-4 py-2 bg-light-hover dark:bg-dark-hover text-slate-900 dark:text-white rounded-lg text-sm transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:v,className:"px-4 py-2 bg-primary hover:bg-primary-dark text-white rounded-lg text-sm disabled:opacity-50 transition-colors",children:v?"Changing...":"Change Password"})]})]}):e.jsx("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-light-hover dark:bg-dark-hover text-slate-900 dark:text-white rounded-lg text-sm hover:bg-primary/10 transition-colors",children:"Change Password"})]})]})}):e.jsx(p,{children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300 p-4 rounded-lg",children:x||"Failed to load profile"})})}export{J as default};
