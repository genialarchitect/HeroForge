import{b as Q,u,d as y,j as e}from"./vendor-state-DdX3IZQk.js";import{r as S}from"./vendor-react-Da1CiaFS.js";import{B as j,a2 as b,ah as B,g as O,O as P,b7 as C,bM as G,K as H,T as z,aX as T,G as v,o as q,aw as f,bd as w,ae as I,av as k,a$ as F,a_ as U,al as W}from"./vendor-ui-eP5rASc6.js";import{a4 as i,d as X,B as a}from"./index-CAHqSsrb.js";import"./vendor-charts-DQXNY-Mg.js";const x={listCampaigns:()=>i.get("/phishing/campaigns"),getCampaign:t=>i.get(`/phishing/campaigns/${t}`),getCampaignStats:t=>i.get(`/phishing/campaigns/${t}/stats`),launchCampaign:t=>i.post(`/phishing/campaigns/${t}/launch`),pauseCampaign:t=>i.post(`/phishing/campaigns/${t}/pause`),completeCampaign:t=>i.post(`/phishing/campaigns/${t}/complete`),deleteCampaign:t=>i.delete(`/phishing/campaigns/${t}`),listTemplates:()=>i.get("/phishing/templates"),listLandingPages:()=>i.get("/phishing/landing-pages"),listSmtpProfiles:()=>i.get("/phishing/smtp-profiles"),testSmtpProfile:(t,l)=>i.post(`/phishing/smtp-profiles/${t}/test`,{to_email:l})},J=({status:t})=>{const l={draft:"bg-gray-500/20 text-gray-400 border-gray-500/30",scheduled:"bg-blue-500/20 text-blue-400 border-blue-500/30",running:"bg-green-500/20 text-green-400 border-green-500/30",paused:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",completed:"bg-purple-500/20 text-purple-400 border-purple-500/30",cancelled:"bg-red-500/20 text-red-400 border-red-500/30"};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded border capitalize ${l[t]||l.draft}`,children:t})},N=({label:t,value:l,icon:d,color:m,percentage:o})=>e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:t}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:l}),o!==void 0&&e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[o.toFixed(1),"%"]})]}),e.jsx("div",{className:`p-3 rounded-lg ${m}`,children:d})]})}),V=({campaign:t,onSelect:l,onAction:d})=>{const m=t.emails_sent>0?t.emails_opened/t.emails_sent*100:0,o=t.emails_sent>0?t.links_clicked/t.emails_sent*100:0;return e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4 hover:border-primary/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:l,children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:t.name}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Created ",new Date(t.created_at).toLocaleDateString()]})]}),e.jsx(J,{status:t.status})]}),e.jsx("div",{className:"space-y-2 mb-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400 mb-1",children:[e.jsxs("span",{children:["Sent: ",t.emails_sent,"/",t.total_targets]}),e.jsxs("span",{children:[t.total_targets>0?(t.emails_sent/t.total_targets*100).toFixed(0):0,"%"]})]}),e.jsx("div",{className:"h-1.5 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all",style:{width:`${t.total_targets>0?t.emails_sent/t.total_targets*100:0}%`}})})]})}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center text-sm mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Opened"}),e.jsx("p",{className:"font-semibold text-green-400",children:t.emails_opened}),e.jsxs("p",{className:"text-xs text-slate-500",children:[m.toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Clicked"}),e.jsx("p",{className:"font-semibold text-yellow-400",children:t.links_clicked}),e.jsxs("p",{className:"text-xs text-slate-500",children:[o.toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Submitted"}),e.jsx("p",{className:"font-semibold text-red-400",children:t.credentials_captured})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Reported"}),e.jsx("p",{className:"font-semibold text-purple-400",children:t.reported_phish})]})]}),e.jsxs("div",{className:"flex gap-2",children:[t.status==="draft"&&e.jsxs(a,{size:"sm",onClick:()=>d("launch"),children:[e.jsx(F,{className:"h-4 w-4 mr-1"}),"Launch"]}),t.status==="running"&&e.jsxs(a,{size:"sm",variant:"outline",onClick:()=>d("pause"),children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"Pause"]}),t.status==="paused"&&e.jsxs(a,{size:"sm",onClick:()=>d("resume"),children:[e.jsx(F,{className:"h-4 w-4 mr-1"}),"Resume"]}),(t.status==="running"||t.status==="paused")&&e.jsxs(a,{size:"sm",variant:"outline",onClick:()=>d("complete"),children:[e.jsx(W,{className:"h-4 w-4 mr-1"}),"Complete"]}),e.jsx(a,{size:"sm",variant:"ghost",onClick:l,children:e.jsx(C,{className:"h-4 w-4"})}),e.jsx(a,{size:"sm",variant:"ghost",className:"text-red-400",onClick:()=>d("delete"),children:e.jsx(k,{className:"h-4 w-4"})})]})]})},le=()=>{const t=Q(),[l,d]=S.useState("campaigns"),[m,o]=S.useState(null),{data:n,isLoading:L}=u({queryKey:["phishing-campaigns"],queryFn:()=>x.listCampaigns().then(s=>s.data)}),{data:h,isLoading:M}=u({queryKey:["phishing-templates"],queryFn:()=>x.listTemplates().then(s=>s.data),enabled:l==="templates"}),{data:p,isLoading:$}=u({queryKey:["phishing-landing-pages"],queryFn:()=>x.listLandingPages().then(s=>s.data),enabled:l==="pages"}),{data:g,isLoading:K}=u({queryKey:["phishing-smtp-profiles"],queryFn:()=>x.listSmtpProfiles().then(s=>s.data),enabled:l==="smtp"}),{data:Y}=u({queryKey:["phishing-campaign-stats",m],queryFn:()=>x.getCampaignStats(m).then(s=>s.data),enabled:!!m}),_=y({mutationFn:s=>x.launchCampaign(s),onSuccess:()=>{j.success("Campaign launched successfully"),t.invalidateQueries({queryKey:["phishing-campaigns"]})},onError:()=>j.error("Failed to launch campaign")}),E=y({mutationFn:s=>x.pauseCampaign(s),onSuccess:()=>{j.success("Campaign paused"),t.invalidateQueries({queryKey:["phishing-campaigns"]})}}),R=y({mutationFn:s=>x.completeCampaign(s),onSuccess:()=>{j.success("Campaign completed"),t.invalidateQueries({queryKey:["phishing-campaigns"]})}}),A=y({mutationFn:s=>x.deleteCampaign(s),onSuccess:()=>{j.success("Campaign deleted"),t.invalidateQueries({queryKey:["phishing-campaigns"]})}}),D=(s,c)=>{switch(c){case"launch":_.mutate(s.id);break;case"pause":E.mutate(s.id);break;case"resume":_.mutate(s.id);break;case"complete":R.mutate(s.id);break;case"delete":confirm("Are you sure you want to delete this campaign?")&&A.mutate(s.id);break}},r=n==null?void 0:n.reduce((s,c)=>({targets:s.targets+c.total_targets,sent:s.sent+c.emails_sent,opened:s.opened+c.emails_opened,clicked:s.clicked+c.links_clicked,credentials:s.credentials+c.credentials_captured}),{targets:0,sent:0,opened:0,clicked:0,credentials:0});return e.jsx(X,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Phishing Campaign Manager"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Create and manage security awareness phishing simulations"})]}),e.jsxs(a,{children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"New Campaign"]})]}),e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(B,{className:"h-5 w-5 text-yellow-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-400",children:"Authorization Required"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Phishing simulations must be conducted with proper authorization. Only use for security awareness training or authorized penetration testing engagements."})]})]}),r&&e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsx(N,{label:"Total Targets",value:r.targets,icon:e.jsx(O,{className:"h-5 w-5 text-blue-400"}),color:"bg-blue-500/10"}),e.jsx(N,{label:"Emails Sent",value:r.sent,icon:e.jsx(P,{className:"h-5 w-5 text-green-400"}),color:"bg-green-500/10"}),e.jsx(N,{label:"Emails Opened",value:r.opened,icon:e.jsx(C,{className:"h-5 w-5 text-cyan-400"}),color:"bg-cyan-500/10",percentage:r.sent>0?r.opened/r.sent*100:0}),e.jsx(N,{label:"Links Clicked",value:r.clicked,icon:e.jsx(G,{className:"h-5 w-5 text-yellow-400"}),color:"bg-yellow-500/10",percentage:r.sent>0?r.clicked/r.sent*100:0}),e.jsx(N,{label:"Credentials Captured",value:r.credentials,icon:e.jsx(H,{className:"h-5 w-5 text-red-400"}),color:"bg-red-500/10",percentage:r.sent>0?r.credentials/r.sent*100:0})]}),e.jsx("div",{className:"flex gap-2 border-b border-light-border dark:border-dark-border pb-2",children:[{id:"campaigns",label:"Campaigns",icon:e.jsx(z,{className:"h-4 w-4"})},{id:"templates",label:"Email Templates",icon:e.jsx(T,{className:"h-4 w-4"})},{id:"pages",label:"Landing Pages",icon:e.jsx(v,{className:"h-4 w-4"})},{id:"smtp",label:"SMTP Profiles",icon:e.jsx(q,{className:"h-4 w-4"})}].map(s=>e.jsxs("button",{onClick:()=>d(s.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${l===s.id?"bg-primary text-white":"text-slate-600 dark:text-slate-400 hover:bg-light-hover dark:hover:bg-dark-hover"}`,children:[s.icon,s.label]},s.id))}),l==="campaigns"&&e.jsx("div",{className:"space-y-4",children:L?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(f,{className:"h-8 w-8 animate-spin text-primary"})}):(n==null?void 0:n.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(z,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No campaigns yet"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Create your first phishing campaign to get started"}),e.jsxs(a,{children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Create Campaign"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n==null?void 0:n.map(s=>e.jsx(V,{campaign:s,onSelect:()=>o(s.id),onAction:c=>D(s,c)},s.id))})}),l==="templates"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(a,{children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"New Template"]})}),M?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(f,{className:"h-8 w-8 animate-spin text-primary"})}):(h==null?void 0:h.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(T,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No email templates"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Create email templates to use in your campaigns"})]}):e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-light-bg dark:bg-dark-bg",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Name"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Subject"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"From"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Created"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-light-border dark:divide-dark-border",children:h==null?void 0:h.map(s=>e.jsxs("tr",{className:"hover:bg-light-hover dark:hover:bg-dark-hover",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-900 dark:text-white font-medium",children:s.name}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:s.subject}),e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:[s.from_name," <",s.from_email,">"]}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-500 dark:text-slate-400",children:new Date(s.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{size:"sm",variant:"ghost",children:e.jsx(w,{className:"h-4 w-4"})}),e.jsx(a,{size:"sm",variant:"ghost",children:e.jsx(I,{className:"h-4 w-4"})}),e.jsx(a,{size:"sm",variant:"ghost",className:"text-red-400",children:e.jsx(k,{className:"h-4 w-4"})})]})})]},s.id))})]})})]}),l==="pages"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(a,{variant:"outline",children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),"Clone Website"]}),e.jsxs(a,{children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"New Landing Page"]})]}),$?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(f,{className:"h-8 w-8 animate-spin text-primary"})}):(p==null?void 0:p.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(v,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No landing pages"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Create landing pages for credential harvesting"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p==null?void 0:p.map(s=>e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900 dark:text-white",children:s.name}),s.cloned_from&&e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Cloned from: ",s.cloned_from]})]}),s.capture_credentials&&e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded bg-red-500/20 text-red-400 border border-red-500/30",children:"Credential Capture"})]}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:["Created ",new Date(s.created_at).toLocaleDateString()]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{size:"sm",variant:"ghost",children:e.jsx(C,{className:"h-4 w-4"})}),e.jsx(a,{size:"sm",variant:"ghost",children:e.jsx(w,{className:"h-4 w-4"})}),e.jsx(a,{size:"sm",variant:"ghost",className:"text-red-400",children:e.jsx(k,{className:"h-4 w-4"})})]})]},s.id))})]}),l==="smtp"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(a,{children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"New SMTP Profile"]})}),K?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(f,{className:"h-8 w-8 animate-spin text-primary"})}):(g==null?void 0:g.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(q,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No SMTP profiles"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Configure SMTP servers for sending phishing emails"})]}):e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-light-bg dark:bg-dark-bg",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Name"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Host"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Port"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"From Address"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-light-border dark:divide-dark-border",children:g==null?void 0:g.map(s=>e.jsxs("tr",{className:"hover:bg-light-hover dark:hover:bg-dark-hover",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-900 dark:text-white font-medium",children:s.name}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:s.host}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:s.port}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:s.from_address}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(a,{size:"sm",variant:"outline",children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),"Test"]}),e.jsx(a,{size:"sm",variant:"ghost",children:e.jsx(w,{className:"h-4 w-4"})}),e.jsx(a,{size:"sm",variant:"ghost",className:"text-red-400",children:e.jsx(k,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})]})})};export{le as default};
