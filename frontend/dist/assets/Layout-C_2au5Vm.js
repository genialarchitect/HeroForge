import{c as R,j as e,u as ue}from"./vendor-state-BjT_zREg.js";import{a1 as L,a2 as be,a3 as ge,a4 as T,B as pe,P as X,a5 as ee}from"./index-CJ_zz9jP.js";import{r as b,u as fe,L as k,j as S}from"./vendor-react-5KxtEOLM.js";import{l as A,bV as te,bW as ae,an as se,m as B,f as O,d as ve,s as re,bX as ye,bY as ne,bZ as oe,S as N,U as le,b_ as we,aL as je,G as P,y as ke,w as M,ag as C,z as W,Z as z,bc as Ne,bg as E,O as U,bP as Se,b$ as Ce,ai as Oe,c0 as Ae,c1 as Ie,aA as Me,bp as ze,c2 as Ee,c3 as $e,K as Re,as as Le,b7 as ie,R as q,W as Te,bA as G,Y as H,c4 as De,c5 as Fe,c6 as _e,a5 as Be,c7 as Pe,bk as We,c8 as Ue,H as qe,h as ce,aj as Ge,aP as Z,aZ as He,n as Ze,aM as K,ad as Q,c9 as V,ca as Ke,cb as Qe,cc as Ve,bL as Je,aw as Ye,F as de,a2 as Xe,aO as et,aQ as tt,e as J,bU as at,o as st,av as rt,t as he,x as nt,$ as me,ah as ot,L as lt,a$ as it,cd as Y,au as ct,aB as dt,X as ht}from"./vendor-ui-CfSMq23b.js";import{M as mt}from"./vendor-markdown-BGP8SuZQ.js";const D=R()(L(a=>({sidebarCollapsed:!1,sidebarOpen:!1,expandedSections:["featured","recon"],toggleSidebar:()=>a(s=>({sidebarCollapsed:!s.sidebarCollapsed})),setSidebarCollapsed:s=>a({sidebarCollapsed:s}),setSidebarOpen:s=>a({sidebarOpen:s}),toggleSection:s=>a(t=>({expandedSections:t.expandedSections.includes(s)?t.expandedSections.filter(r=>r!==s):[...t.expandedSections,s]})),setExpandedSections:s=>a({expandedSections:s})}),{name:"heroforge-ui-storage",partialize:a=>({sidebarCollapsed:a.sidebarCollapsed,expandedSections:a.expandedSections})}));function xt(a){const[s,t]=b.useState(()=>typeof window<"u"?window.matchMedia(a).matches:!1);return b.useEffect(()=>{if(typeof window>"u")return;const r=window.matchMedia(a),n=o=>t(o.matches);return t(r.matches),r.addEventListener("change",n),()=>r.removeEventListener("change",n)},[a]),s}function F(){return xt("(max-width: 1023px)")}const $=[{value:"light",label:"Light",icon:e.jsx(te,{className:"h-4 w-4"})},{value:"dark",label:"Dark",icon:e.jsx(ae,{className:"h-4 w-4"})},{value:"system",label:"System",icon:e.jsx(se,{className:"h-4 w-4"})}],ut=({className:a=""})=>{const{theme:s,setTheme:t,resolvedTheme:r}=be(),[n,o]=b.useState(!1),h=b.useRef(null),c=$.find(i=>i.value===s)||$[2];b.useEffect(()=>{const i=u=>{h.current&&!h.current.contains(u.target)&&o(!1)};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]),b.useEffect(()=>{const i=u=>{u.key==="Escape"&&o(!1)};if(n)return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[n]);const d=i=>{t(i),o(!1)},m=()=>s==="system"?r==="dark"?e.jsx(ae,{className:"h-4 w-4"}):e.jsx(te,{className:"h-4 w-4"}):c.icon;return e.jsxs("div",{className:`relative ${a}`,ref:h,children:[e.jsxs("button",{type:"button",onClick:()=>o(!n),className:`flex items-center gap-2 px-3 py-2 text-sm rounded-lg transition-colors
          text-slate-400 hover:text-slate-100 dark:text-slate-400 dark:hover:text-slate-100
          hover:bg-slate-700 dark:hover:bg-dark-hover
          bg-transparent`,"aria-haspopup":"listbox","aria-expanded":n,"aria-label":"Select theme",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[m(),e.jsx("span",{className:"hidden sm:inline",children:c.label})]}),e.jsx(A,{className:`h-3 w-3 transition-transform ${n?"rotate-180":""}`})]}),n&&e.jsx("div",{className:`absolute right-0 mt-2 w-36 rounded-lg shadow-lg z-50
            bg-white dark:bg-dark-surface
            border border-slate-200 dark:border-dark-border
            animate-fade-in`,role:"listbox","aria-label":"Theme options",children:e.jsx("div",{className:"py-1",children:$.map(i=>e.jsxs("button",{type:"button",role:"option","aria-selected":s===i.value,onClick:()=>d(i.value),className:`w-full flex items-center gap-3 px-4 py-2 text-sm transition-colors
                  ${s===i.value?"bg-primary/10 text-primary dark:text-primary-light":"text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-dark-hover"}`,children:[i.icon,e.jsx("span",{children:i.label}),s===i.value&&e.jsx("span",{className:"ml-auto text-primary dark:text-primary-light",children:e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},i.value))})})]})},bt=R()(L((a,s)=>({currentOrg:null,currentOrgId:null,organizations:[],isLoading:!1,setCurrentOrg:t=>{a({currentOrg:t,currentOrgId:(t==null?void 0:t.id)??null})},setCurrentOrgId:t=>{const n=s().organizations.find(o=>o.id===t)??null;a({currentOrgId:t,currentOrg:n})},setOrganizations:t=>{a({organizations:t});const r=s().currentOrg;!r&&t.length>0&&a({currentOrg:t[0],currentOrgId:t[0].id}),r&&!t.find(n=>n.id===r.id)&&(t.length>0?a({currentOrg:t[0],currentOrgId:t[0].id}):a({currentOrg:null,currentOrgId:null}))},setLoading:t=>a({isLoading:t}),clearOrgState:()=>{a({currentOrg:null,currentOrgId:null,organizations:[],isLoading:!1})},isOrgOwner:()=>{var t;return((t=s().currentOrg)==null?void 0:t.role)==="owner"},isOrgAdmin:()=>{var r;const t=(r=s().currentOrg)==null?void 0:r.role;return t==="owner"||t==="admin"},isOrgMember:()=>{var t;return((t=s().currentOrg)==null?void 0:t.role)==="member"},getCurrentOrgRole:()=>{var t;return((t=s().currentOrg)==null?void 0:t.role)??null},getOrgById:t=>s().organizations.find(r=>r.id===t),hasMultipleOrgs:()=>s().organizations.length>1}),{name:"org-storage",partialize:a=>({currentOrgId:a.currentOrgId})})),gt=()=>{const[a,s]=b.useState(!1),t=b.useRef(null),r=fe(),{currentOrg:n,organizations:o,setCurrentOrg:h,setOrganizations:c}=bt(),{isLoading:d}=ue({queryKey:["organizations"],queryFn:async()=>{const l=await ge.list();return c(l.data),l.data},staleTime:300*1e3});b.useEffect(()=>{const l=y=>{t.current&&!t.current.contains(y.target)&&s(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]);const m=l=>{h(l),s(!1)},i=()=>{s(!1),r("/organization/new")},u=()=>{s(!1),n&&r(`/organization/${n.id}`)},p=l=>{switch(l){case"owner":return"bg-amber-500/20 text-amber-400 border-amber-500/30";case"admin":return"bg-cyan-500/20 text-cyan-400 border-cyan-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return!d&&o.length===0?e.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover transition-colors",children:[e.jsx(B,{className:"h-4 w-4"}),"Create Organization"]}):e.jsxs("div",{className:"relative",ref:t,children:[e.jsxs("button",{onClick:()=>s(!a),disabled:d,className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover transition-colors border border-light-border dark:border-dark-border",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{className:"max-w-[120px] truncate",children:d?"Loading...":(n==null?void 0:n.name)||"Select Organization"}),e.jsx(A,{className:`h-3 w-3 transition-transform ${a?"rotate-180":""}`})]}),a&&e.jsxs("div",{className:"absolute left-0 mt-1 w-64 bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg shadow-lg z-50 overflow-hidden",children:[e.jsx("div",{className:"max-h-64 overflow-y-auto py-1",children:o.map(l=>e.jsxs("button",{onClick:()=>m(l),className:`w-full flex items-center justify-between px-3 py-2 text-sm transition-colors ${(n==null?void 0:n.id)===l.id?"bg-primary/10 text-primary":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(O,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:l.name})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded border ${p(l.role)}`,children:l.role}),(n==null?void 0:n.id)===l.id&&e.jsx(ve,{className:"h-4 w-4 text-primary"})]})]},l.id))}),e.jsx("div",{className:"border-t border-light-border dark:border-dark-border"}),e.jsxs("div",{className:"py-1",children:[n&&e.jsxs("button",{onClick:u,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover transition-colors",children:[e.jsx(re,{className:"h-4 w-4"}),"Manage Organization"]}),e.jsxs("button",{onClick:i,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover transition-colors",children:[e.jsx(B,{className:"h-4 w-4"}),"Create Organization"]})]})]})]})},pt=()=>{const{user:a,logout:s}=T(),{sidebarCollapsed:t,toggleSidebar:r,setSidebarOpen:n}=D(),o=F(),h=()=>{o?n(!0):r()};return e.jsx("header",{className:"bg-light-surface dark:bg-dark-surface border-b border-light-border dark:border-dark-border shadow-sm sticky top-0 z-30",children:e.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-14",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[a&&e.jsx("button",{onClick:h,className:"p-2 rounded-lg hover:bg-light-hover dark:hover:bg-dark-hover transition-colors","aria-label":o?"Open menu":t?"Expand sidebar":"Collapse sidebar",children:o?e.jsx(ye,{className:"h-5 w-5 text-slate-600 dark:text-slate-400"}):t?e.jsx(ne,{className:"h-5 w-5 text-slate-600 dark:text-slate-400"}):e.jsx(oe,{className:"h-5 w-5 text-slate-600 dark:text-slate-400"})}),(!a||o)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex items-center justify-center w-9 h-9 bg-primary rounded-lg",children:e.jsx(N,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"HeroForge"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 hidden sm:block",children:"Network Triage Dashboard"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden sm:block",children:e.jsx(gt,{})}),e.jsxs("div",{className:"hidden md:flex items-center space-x-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(le,{className:"h-4 w-4 text-slate-500 dark:text-slate-400"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:a.username})]}),a.roles&&a.roles.length>0&&e.jsx("div",{className:"flex gap-1",children:a.roles.slice(0,2).map(c=>e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 text-xs font-medium rounded border bg-slate-500/20 text-slate-700 dark:text-slate-300 border-slate-500/30 capitalize",children:c},c))})]})]}),e.jsx(ut,{}),a&&e.jsxs(pe,{variant:"ghost",size:"sm",onClick:s,className:"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline ml-2",children:"Logout"})]})]})]})})})},ft=()=>e.jsx("footer",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Â© 2026 Genial Architect Cybersecurity Research Associates. All rights reserved."})]}),e.jsxs("nav",{className:"flex items-center gap-6 text-sm",children:[e.jsx(k,{to:"/legal/terms",className:"text-gray-500 dark:text-gray-400 hover:text-primary transition-colors",children:"Terms"}),e.jsx(k,{to:"/legal/privacy",className:"text-gray-500 dark:text-gray-400 hover:text-primary transition-colors",children:"Privacy"}),e.jsx(k,{to:"/legal/acceptable-use",className:"text-gray-500 dark:text-gray-400 hover:text-primary transition-colors",children:"Acceptable Use"}),e.jsx(k,{to:"/legal/cookies",className:"text-gray-500 dark:text-gray-400 hover:text-primary transition-colors",children:"Cookies"})]})]})})}),vt={identify:[],assess:[],exploit:["red_team"],detect:["blue_team"],respond:["blue_team","green_team"],govern:["white_team"],collaborate:["purple_team","red_team","blue_team"]},_={blue:{active:"bg-blue-500/10 text-blue-600 dark:text-blue-400",hover:"hover:bg-blue-500/5 hover:text-blue-600 dark:hover:text-blue-400",border:"border-l-blue-500",dot:"bg-blue-500",bg:"bg-blue-500/5"},cyan:{active:"bg-cyan-500/10 text-cyan-600 dark:text-cyan-400",hover:"hover:bg-cyan-500/5 hover:text-cyan-600 dark:hover:text-cyan-400",border:"border-l-cyan-500",dot:"bg-cyan-500",bg:"bg-cyan-500/5"},rose:{active:"bg-rose-500/10 text-rose-600 dark:text-rose-400",hover:"hover:bg-rose-500/5 hover:text-rose-600 dark:hover:text-rose-400",border:"border-l-rose-500",dot:"bg-rose-500",bg:"bg-rose-500/5"},amber:{active:"bg-amber-500/10 text-amber-600 dark:text-amber-400",hover:"hover:bg-amber-500/5 hover:text-amber-600 dark:hover:text-amber-400",border:"border-l-amber-500",dot:"bg-amber-500",bg:"bg-amber-500/5"},orange:{active:"bg-orange-500/10 text-orange-600 dark:text-orange-400",hover:"hover:bg-orange-500/5 hover:text-orange-600 dark:hover:text-orange-400",border:"border-l-orange-500",dot:"bg-orange-500",bg:"bg-orange-500/5"},slate:{active:"bg-slate-500/10 text-slate-700 dark:text-slate-300",hover:"hover:bg-slate-500/5 hover:text-slate-700 dark:hover:text-slate-300",border:"border-l-slate-400",dot:"bg-slate-400",bg:"bg-slate-500/5"},purple:{active:"bg-purple-500/10 text-purple-600 dark:text-purple-400",hover:"hover:bg-purple-500/5 hover:text-purple-600 dark:hover:text-purple-400",border:"border-l-purple-500",dot:"bg-purple-500",bg:"bg-purple-500/5"},default:{active:"bg-primary/10 text-primary",hover:"hover:bg-light-hover dark:hover:bg-dark-hover hover:text-slate-900 dark:hover:text-white",border:"border-l-primary",dot:"bg-primary",bg:"bg-primary/5"}},I=({item:a,collapsed:s,categoryColor:t="default"})=>{const r=S(),n=r.pathname===a.to||a.to!=="/dashboard"&&r.pathname.startsWith(a.to)||a.to.includes("?")&&r.pathname+r.search===a.to,o=_[t],h=a.icon,c=e.jsxs(k,{to:a.to,className:`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors text-sm ${n?`${o.active} font-medium`:`text-slate-600 dark:text-slate-400 ${o.hover}`}`,children:[e.jsx(h,{className:"h-4 w-4 flex-shrink-0"}),!s&&e.jsx("span",{className:"truncate",children:a.label})]});return s?e.jsx(ee,{content:a.label,position:"right",children:c}):c},yt=({subsection:a,categoryColor:s,expanded:t,onToggle:r})=>{const n=_[s],o=S(),h=a.items.some(c=>o.pathname===c.to||o.pathname.startsWith(c.to));return e.jsxs("div",{className:"mt-1",children:[e.jsxs("button",{onClick:r,className:`w-full flex items-center gap-2 px-2 py-1.5 rounded-md transition-colors text-xs ${h?`${n.active} font-medium`:`text-slate-500 dark:text-slate-400 ${n.hover}`}`,children:[e.jsx("span",{className:"flex-1 text-left truncate",children:a.label}),t?e.jsx(A,{className:"h-3 w-3 flex-shrink-0"}):e.jsx(me,{className:"h-3 w-3 flex-shrink-0"})]}),t&&e.jsx("div",{className:"ml-2 pl-2 border-l border-slate-200 dark:border-slate-700 mt-1 space-y-0.5",children:a.items.map(c=>e.jsx(I,{item:c,collapsed:!1,categoryColor:s},c.to))})]})},wt=({section:a,collapsed:s,expandedSections:t,onToggleSection:r})=>{var i,u,p;const n=_[a.categoryColor],o=S(),h=a.icon,c=[...a.items||[],...((i=a.subsections)==null?void 0:i.flatMap(l=>l.items))||[]].some(l=>o.pathname===l.to||o.pathname.startsWith(l.to)),d=t.includes(a.id),m=e.jsxs("button",{onClick:()=>r(a.id),className:`w-full flex items-center gap-2 px-3 py-2 rounded-lg transition-colors text-sm ${c?`${n.active} font-medium`:`text-slate-600 dark:text-slate-400 ${n.hover}`}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full flex-shrink-0 ${n.dot}`}),!s&&e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"flex-1 text-left truncate",children:a.label}),d?e.jsx(A,{className:"h-3 w-3 flex-shrink-0"}):e.jsx(me,{className:"h-3 w-3 flex-shrink-0"})]})]});return e.jsxs("div",{className:"mb-1",children:[s?e.jsx(ee,{content:a.label,position:"right",children:m}):m,d&&!s&&e.jsxs("div",{className:`ml-3 pl-3 border-l-2 ${n.border} mt-1 space-y-0.5`,children:[(u=a.items)==null?void 0:u.map(l=>e.jsx(I,{item:l,collapsed:!1,categoryColor:a.categoryColor},l.to)),(p=a.subsections)==null?void 0:p.map(l=>e.jsx(yt,{subsection:l,categoryColor:a.categoryColor,expanded:t.includes(`${a.id}-${l.id}`),onToggle:()=>r(`${a.id}-${l.id}`)},l.id))]})]})},jt=({collapsed:a})=>{const s=[{to:"/dashboard?tab=topology",icon:C,label:"Network Topology"},{to:"/attack-paths",icon:ie,label:"Attack Paths"},{to:"/ai-security",icon:rt,label:"AI Security"},{to:"/llm-testing",icon:he,label:"LLM Testing"},{to:"/ai-reports",icon:de,label:"AI Reports"},{to:"/ml-models",icon:nt,label:"ML Models"}];return e.jsxs("div",{className:`mb-4 rounded-lg bg-gradient-to-br from-purple-500/10 via-cyan-500/10 to-blue-500/10 border border-purple-500/20 ${a?"p-2":"p-3"}`,children:[!a&&e.jsxs("div",{className:"flex items-center gap-2 mb-2 px-1",children:[e.jsx(st,{className:"h-4 w-4 text-yellow-500"}),e.jsx("span",{className:"text-xs font-semibold text-slate-700 dark:text-slate-300 uppercase tracking-wide",children:"AI & Visualization"})]}),e.jsx("div",{className:"space-y-0.5",children:s.map(t=>e.jsx(I,{item:t,collapsed:a,categoryColor:"purple"},t.to))})]})},kt=()=>{const{user:a}=T(),s=S(),t=F(),{sidebarCollapsed:r,sidebarOpen:n,expandedSections:o,toggleSidebar:h,setSidebarOpen:c,toggleSection:d}=D(),m=X(x=>{var f;return((f=x.user)==null?void 0:f.roles)??[]}),i=m.includes("admin"),u=x=>x.some(f=>m.includes(f));if(b.useEffect(()=>{t&&c(!1)},[s.pathname,t,c]),!a)return null;const p=[{id:"identify",label:"Identify",icon:W,categoryColor:"blue",items:[{to:"/dashboard",icon:je,label:"Scans Dashboard"},{to:"/discovery",icon:P,label:"Asset Discovery"},{to:"/assets",icon:ke,label:"Asset Inventory"},{to:"/attack-surface",icon:M,label:"Attack Surface"},{to:"/dns-tools",icon:C,label:"DNS Tools"}]},{id:"assess",label:"Assess",icon:Ie,categoryColor:"cyan",subsections:[{id:"scanning",label:"Scanning",items:[{to:"/nuclei",icon:z,label:"Nuclei Scanner"},{to:"/webapp-scan",icon:W,label:"Web App Scan"},{to:"/compare",icon:Ne,label:"Scan Compare"}]},{id:"appsec",label:"Application Security",items:[{to:"/yellow-team",icon:E,label:"DevSecOps Dashboard"},{to:"/sast",icon:U,label:"SAST Scanner"},{to:"/sca",icon:Se,label:"SCA (Dependencies)"},{to:"/cicd-integration",icon:Ce,label:"CI/CD Integration"},{to:"/iac-security",icon:E,label:"IaC Security"},{to:"/container-security",icon:Oe,label:"Container Security"},{to:"/api-security",icon:Ae,label:"API Security"}]}]},{id:"exploit",label:"Exploit",icon:G,categoryColor:"rose",requiredRoles:["red_team"],subsections:[{id:"research",label:"Research",items:[{to:"/exploit-database",icon:Me,label:"Exploit Database"},{to:"/poc-repository",icon:U,label:"PoC Repository"},{to:"/research-workspaces",icon:ze,label:"Research Workspaces"},{to:"/binary-analysis",icon:Ee,label:"Binary Analysis"},{to:"/malware-analysis",icon:$e,label:"Malware Analysis"}]},{id:"execution",label:"Execution",items:[{to:"/exploitation",icon:M,label:"Exploitation"},{to:"/fuzzing",icon:z,label:"Fuzzing"},{to:"/cracking",icon:Re,label:"Password Cracking"},{to:"/privesc",icon:Le,label:"Privilege Escalation"},{to:"/bloodhound",icon:ie,label:"BloodHound AD"}]},{id:"operations",label:"Operations",items:[{to:"/phishing",icon:M,label:"Phishing Campaigns"},{to:"/c2",icon:q,label:"C2 Management"},{to:"/wireless",icon:Te,label:"Wireless Attacks"},{to:"/attack-simulation",icon:G,label:"Attack Simulation"}]}]},{id:"detect",label:"Detect",icon:qe,categoryColor:"amber",requiredRoles:["blue_team"],subsections:[{id:"monitoring",label:"Monitoring",items:[{to:"/siem",icon:H,label:"SIEM"},{to:"/ueba",icon:De,label:"UEBA"},{to:"/traffic-analysis",icon:C,label:"Traffic Analysis"},{to:"/netflow-analysis",icon:H,label:"NetFlow Analysis"},{to:"/dns-analytics",icon:P,label:"DNS Analytics"}]},{id:"hunting",label:"Threat Hunting",items:[{to:"/detection-engineering",icon:Fe,label:"Detection Engineering"},{to:"/threat-hunting",icon:_e,label:"Threat Hunting"},{to:"/threat-intel",icon:Be,label:"Threat Intel"},{to:"/yara",icon:Pe,label:"YARA Rules"},{to:"/sigma-rules",icon:E,label:"Sigma Rules"}]},{id:"specialized",label:"Specialized",items:[{to:"/ot-ics-security",icon:We,label:"OT/ICS Security"},{to:"/iot-security",icon:Ue,label:"IoT Security"},{to:"/agents",icon:q,label:"Scan Agents"}]}]},{id:"respond",label:"Respond",icon:z,categoryColor:"orange",requiredRoles:["blue_team","green_team"],subsections:[{id:"incident",label:"Incident Management",items:[{to:"/incident-response",icon:ce,label:"Incident Response"},{to:"/forensics",icon:Ge,label:"Forensics"}]},{id:"automation",label:"Automation",items:[{to:"/green-team",icon:Z,label:"SOAR Dashboard"},{to:"/soar-playbooks",icon:He,label:"Playbooks"},{to:"/workflows",icon:Z,label:"Workflows"},{to:"/remediation",icon:Ze,label:"Remediation"}]}]},{id:"govern",label:"Govern",icon:V,categoryColor:"slate",requiredRoles:["white_team"],subsections:[{id:"compliance",label:"Compliance",items:[{to:"/white-team",icon:K,label:"GRC Dashboard"},{to:"/compliance",icon:K,label:"Compliance"},{to:"/client-compliance",icon:Q,label:"Client Checklists"},{to:"/legal/documents",icon:V,label:"Legal Documents"},{to:"/evidence",icon:Ke,label:"Evidence"},{to:"/manual-assessments",icon:Q,label:"Assessments"}]},{id:"authorization",label:"Authorization",items:[{to:"/ato-map",icon:Qe,label:"ATO Map"},{to:"/cato-network-map",icon:C,label:"cATO Network Map"},{to:"/methodology",icon:Ve,label:"Methodology"}]},{id:"reporting",label:"Reporting",items:[{to:"/finding-templates",icon:Je,label:"Finding Templates"},{to:"/executive-dashboard",icon:Ye,label:"Executive Dashboard"},{to:"/reports",icon:de,label:"Reports"}]},{id:"acas",label:"ACAS / RMF",items:[{to:"/scap",icon:N,label:"SCAP Scanner"},{to:"/emass",icon:O,label:"eMASS Integration"},{to:"/windows-audit",icon:se,label:"Windows Audit"},{to:"/audit-files",icon:Xe,label:"Audit Files"}]}]},{id:"collaborate",label:"Collaborate",icon:J,categoryColor:"purple",requiredRoles:["purple_team","red_team","blue_team"],items:[{to:"/purple-team",icon:et,label:"Purple Team Dashboard"},{to:"/orange-team",icon:tt,label:"Security Awareness"}]}],l=[{to:"/crm",icon:O,label:"CRM Dashboard"},{to:"/admin",icon:J,label:"Admin"},{to:"/settings",icon:re,label:"Settings"},{to:"/plugins",icon:at,label:"Plugins"}],y=p.filter(x=>{if(i)return!0;const f=x.requiredRoles||vt[x.id];return!f||f.length===0?!0:u(f)}),w=l.filter(x=>x.to==="/admin"?i:x.to==="/crm"?i||u(["white_team"]):!0),g=r?"w-16":"w-64";return e.jsxs(e.Fragment,{children:[t&&n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 transition-opacity",onClick:()=>c(!1)}),e.jsxs("aside",{className:`
          fixed top-0 left-0 h-full z-50
          bg-light-surface dark:bg-dark-surface
          border-r border-light-border dark:border-dark-border
          transition-all duration-300 ease-in-out
          flex flex-col
          ${t?`w-64 ${n?"translate-x-0":"-translate-x-full"}`:g}
        `,role:"navigation","aria-label":"Main navigation",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-light-border dark:border-dark-border",children:[!r&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-primary rounded-lg",children:e.jsx(N,{className:"h-5 w-5 text-white"})}),e.jsx("span",{className:"font-bold text-slate-900 dark:text-white",children:"HeroForge"})]}),r&&e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-primary rounded-lg mx-auto",children:e.jsx(N,{className:"h-5 w-5 text-white"})}),!t&&e.jsx("button",{onClick:h,className:`p-1.5 rounded-lg hover:bg-light-hover dark:hover:bg-dark-hover transition-colors ${r?"mx-auto mt-2":""}`,"aria-label":r?"Expand sidebar":"Collapse sidebar",children:r?e.jsx(ne,{className:"h-4 w-4 text-slate-600 dark:text-slate-400"}):e.jsx(oe,{className:"h-4 w-4 text-slate-600 dark:text-slate-400"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3",children:[e.jsx(jt,{collapsed:r}),e.jsx("div",{className:"space-y-1",children:y.map(x=>e.jsx(wt,{section:x,collapsed:r,expandedSections:o,onToggleSection:d},x.id))}),e.jsx("div",{className:"my-4 border-t border-light-border dark:border-dark-border"}),!r&&w.length>0&&e.jsx("div",{className:"mb-2 px-3",children:e.jsx("span",{className:"text-xs font-semibold text-slate-500 dark:text-slate-500 uppercase tracking-wide",children:"Quick Access"})}),e.jsx("div",{className:"space-y-0.5",children:w.map(x=>e.jsx(I,{item:x,collapsed:r,categoryColor:"default"},x.to))})]})]})]})},xe=R()(L((a,s)=>({isOpen:!1,isMinimized:!1,isLoading:!1,messages:[],conversationId:null,error:null,setOpen:t=>a({isOpen:t}),setMinimized:t=>a({isMinimized:t}),toggle:()=>{const t=s();t.isOpen&&!t.isMinimized?a({isMinimized:!0}):a({isOpen:!0,isMinimized:!1})},addMessage:t=>a(r=>({messages:[...r.messages,t],error:null})),appendToLastMessage:t=>a(r=>{const n=[...r.messages],o=n.length-1;return o>=0&&n[o].role==="assistant"&&(n[o]={...n[o],content:n[o].content+t}),{messages:n}}),finalizeLastMessage:()=>a(t=>{const r=[...t.messages],n=r.length-1;return n>=0&&r[n].isStreaming&&(r[n]={...r[n],isStreaming:!1}),{messages:r}}),setLoading:t=>a({isLoading:t}),setError:t=>a({error:t}),clearMessages:()=>a({messages:[],conversationId:null,error:null}),setConversationId:t=>a({conversationId:t}),startNewConversation:()=>a({messages:[],conversationId:null,error:null,isLoading:!1})}),{name:"heroforge-chat",partialize:a=>({messages:a.messages.slice(-50),conversationId:a.conversationId})})),j="/api",Nt={sendMessage:async(a,s,t,r,n,o,h)=>{var d;const c=localStorage.getItem("token");if(!c){h("Not authenticated");return}try{const m=await fetch(`${j}/chat`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({message:a,conversation_id:s,page_context:t})});if(!m.ok){const y=await m.json().catch(()=>({}));throw new Error(y.message||`Chat request failed: ${m.status}`)}const i=(d=m.body)==null?void 0:d.getReader(),u=new TextDecoder;if(!i)throw new Error("Response body is not readable");let p="",l=!1;for(;!l;){const y=await i.read();if(l=y.done,l)break;const w=y.value;p+=u.decode(w,{stream:!0});const g=p.split(`
`);p=g.pop()||"";for(const x of g)if(x.startsWith("data: ")){const f=x.slice(6).trim();if(!f)continue;try{const v=JSON.parse(f);if(v.type==="content"&&v.content)r(v.content),v.conversation_id&&n(v.conversation_id);else if(v.type==="done"){v.conversation_id&&n(v.conversation_id),o(v.tokens_used||0);return}else if(v.type==="error"&&v.error){h(v.error);return}}catch{console.debug("Non-JSON SSE data:",f)}}}o(0)}catch(m){h(m instanceof Error?m.message:"Failed to send message")}},getConversations:async()=>{const a=localStorage.getItem("token"),s=await fetch(`${j}/chat/conversations`,{headers:{Authorization:`Bearer ${a}`}});if(!s.ok)throw new Error("Failed to fetch conversations");return(await s.json()).conversations},getMessages:async a=>{const s=localStorage.getItem("token"),t=await fetch(`${j}/chat/conversations/${a}/messages`,{headers:{Authorization:`Bearer ${s}`}});if(!t.ok)throw new Error("Failed to fetch messages");return(await t.json()).messages},deleteConversation:async a=>{const s=localStorage.getItem("token");if(!(await fetch(`${j}/chat/conversations/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok)throw new Error("Failed to delete conversation")},createConversation:async()=>{const a=localStorage.getItem("token"),s=await fetch(`${j}/chat/conversations`,{method:"POST",headers:{Authorization:`Bearer ${a}`}});if(!s.ok)throw new Error("Failed to create conversation");return(await s.json()).id}},St=({message:a})=>{const s=a.role==="user";return e.jsxs("div",{className:`flex gap-3 ${s?"flex-row-reverse":""}`,children:[e.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${s?"bg-cyan-600":"bg-gradient-to-br from-purple-600 to-indigo-600"}`,children:s?e.jsx(le,{className:"w-4 h-4 text-white"}):e.jsx(ot,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:`flex-1 max-w-[80%] ${s?"text-right":"text-left"}`,children:[e.jsx("div",{className:`inline-block p-3 rounded-lg ${s?"bg-cyan-600 text-white rounded-tr-sm":"bg-gray-700 text-gray-100 rounded-tl-sm"}`,children:s?e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:a.content}):e.jsxs("div",{className:"text-sm prose prose-sm prose-invert max-w-none",children:[e.jsx(mt,{components:{a:({href:t,children:r})=>e.jsx("a",{href:t,className:"text-cyan-400 hover:text-cyan-300 underline",onClick:n=>{t!=null&&t.startsWith("/")&&(n.preventDefault(),window.location.href=t)},children:r}),code:({className:t,children:r})=>!t?e.jsx("code",{className:"bg-gray-800 px-1 py-0.5 rounded text-cyan-300 text-xs",children:r}):e.jsx("code",{className:"block bg-gray-800 p-2 rounded text-xs overflow-x-auto",children:r}),ul:({children:t})=>e.jsx("ul",{className:"list-disc list-inside space-y-1 my-2",children:t}),ol:({children:t})=>e.jsx("ol",{className:"list-decimal list-inside space-y-1 my-2",children:t}),p:({children:t})=>e.jsx("p",{className:"mb-2 last:mb-0",children:t})},children:a.content}),a.isStreaming&&e.jsx("span",{className:"inline-block w-2 h-4 bg-cyan-400 animate-pulse ml-1"})]})}),e.jsx("div",{className:`text-xs text-gray-500 mt-1 ${s?"text-right":"text-left"}`,children:new Date(a.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},Ct=({onSend:a,isLoading:s,disabled:t})=>{const[r,n]=b.useState(""),o=b.useRef(null);b.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=`${Math.min(o.current.scrollHeight,120)}px`)},[r]);const h=d=>{d.preventDefault(),r.trim()&&!s&&!t&&(a(r.trim()),n(""),o.current&&(o.current.style.height="auto"))},c=d=>{d.key==="Enter"&&!d.shiftKey&&(d.preventDefault(),h(d))};return e.jsxs("form",{onSubmit:h,className:"flex items-end gap-2",children:[e.jsx("div",{className:"flex-1 relative",children:e.jsx("textarea",{ref:o,value:r,onChange:d=>n(d.target.value),onKeyDown:c,placeholder:"Ask anything about your security data...",disabled:s||t,className:`w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg
                     text-white placeholder-gray-400 resize-none
                     focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent
                     disabled:opacity-50 disabled:cursor-not-allowed
                     text-sm min-h-[40px] max-h-[120px]`,rows:1})}),e.jsx("button",{type:"submit",disabled:!r.trim()||s||t,className:`flex-shrink-0 p-2 bg-cyan-600 hover:bg-cyan-700
                   disabled:bg-gray-600 disabled:cursor-not-allowed
                   rounded-lg transition-colors`,children:s?e.jsx(lt,{className:"w-5 h-5 text-white animate-spin"}):e.jsx(it,{className:"w-5 h-5 text-white"})})]})},Ot=()=>{const a=S(),s=b.useRef(null),{messages:t,conversationId:r,isLoading:n,error:o,addMessage:h,appendToLastMessage:c,finalizeLastMessage:d,setLoading:m,setError:i,setConversationId:u}=xe();b.useEffect(()=>{var l;(l=s.current)==null||l.scrollIntoView({behavior:"smooth"})},[t]);const p=async l=>{const y={id:crypto.randomUUID(),role:"user",content:l,timestamp:new Date().toISOString()};h(y);const w={id:crypto.randomUUID(),role:"assistant",content:"",timestamp:new Date().toISOString(),isStreaming:!0};h(w),m(!0),i(null);try{await Nt.sendMessage(l,r,a.pathname,g=>{c(g)},g=>{u(g)},()=>{d(),m(!1)},g=>{i(g),d(),m(!1)})}catch(g){i(g instanceof Error?g.message:"Failed to send message"),m(!1)}};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-purple-600 to-indigo-600 flex items-center justify-center mb-4",children:e.jsx(he,{className:"w-6 h-6 text-white"})}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Zeus"}),e.jsx("p",{className:"text-sm text-gray-400 max-w-xs",children:"I have access to your security data and can help you understand vulnerabilities, plan scans, and navigate the platform."}),e.jsxs("div",{className:"mt-4 space-y-2 text-xs text-gray-500",children:[e.jsx("p",{children:"Try asking:"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:'"What are my most critical vulnerabilities?"'}),e.jsx("li",{children:'"How do I start a new scan?"'}),e.jsx("li",{children:'"Explain CVE-2024-1234 to me"'})]})]})]}):e.jsx(e.Fragment,{children:t.map(l=>e.jsx(St,{message:l},l.id))}),e.jsx("div",{ref:s})]}),o&&e.jsxs("div",{className:"mx-4 mb-2 p-2 bg-red-900/50 border border-red-700 rounded-lg flex items-center gap-2 text-sm text-red-300",children:[e.jsx(ce,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:o})]}),e.jsx("div",{className:"p-4 border-t border-gray-700",children:e.jsx(Ct,{onSend:p,isLoading:n})})]})},At=()=>{const{isOpen:a,isMinimized:s,messages:t,setOpen:r,setMinimized:n,startNewConversation:o}=xe();if(!X(i=>i.isAuthenticated))return null;const c=()=>{r(!1),n(!1)},d=()=>{n(!0)},m=()=>{o()};return!a||s?e.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:e.jsxs("button",{onClick:()=>{r(!0),n(!1)},className:`group relative w-14 h-14 bg-gradient-to-br from-purple-600 to-indigo-600
                     hover:from-purple-500 hover:to-indigo-500
                     text-white rounded-full shadow-lg
                     flex items-center justify-center transition-all duration-200
                     hover:scale-105 hover:shadow-xl`,"aria-label":"Open Zeus AI Assistant",children:[e.jsx(Y,{className:"w-6 h-6"}),t.length>0&&e.jsx("span",{className:`absolute -top-1 -right-1 w-5 h-5 bg-cyan-500 rounded-full
                           text-xs font-medium flex items-center justify-center`,children:t.length>99?"99+":t.length}),e.jsx("span",{className:`absolute bottom-full right-0 mb-2 px-2 py-1 bg-gray-800 text-white
                         text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity
                         whitespace-nowrap pointer-events-none`,children:"Zeus"})]})}):e.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:e.jsxs("div",{className:`w-96 h-[500px] bg-gray-800 border border-gray-700
                      rounded-lg shadow-2xl flex flex-col overflow-hidden
                      animate-in slide-in-from-bottom-4 duration-200`,children:[e.jsxs("div",{className:`flex items-center justify-between px-4 py-3
                        bg-gradient-to-r from-purple-600 to-indigo-600`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-white"}),e.jsx("span",{className:"font-medium text-white",children:"Zeus"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:m,className:`p-1.5 text-white/80 hover:text-white hover:bg-white/10 rounded
                         transition-colors`,title:"New conversation",children:e.jsx(ct,{className:"w-4 h-4"})}),e.jsx("button",{onClick:d,className:`p-1.5 text-white/80 hover:text-white hover:bg-white/10 rounded
                         transition-colors`,title:"Minimize",children:e.jsx(dt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:c,className:`p-1.5 text-white/80 hover:text-white hover:bg-white/10 rounded
                         transition-colors`,title:"Close",children:e.jsx(ht,{className:"w-4 h-4"})})]})]}),e.jsx(Ot,{})]})})},Rt=({children:a})=>{const{user:s}=T(),{sidebarCollapsed:t}=D(),r=F(),n=s&&!r?t?"lg:ml-16":"lg:ml-64":"";return e.jsxs("div",{className:"min-h-screen bg-light-bg dark:bg-dark-bg transition-colors",children:[s&&e.jsx(kt,{}),e.jsxs("div",{className:`flex flex-col min-h-screen transition-all duration-300 ${n}`,children:[e.jsx(pt,{}),e.jsx("main",{className:"flex-1 px-4 sm:px-6 lg:px-8 py-6 w-full max-w-7xl mx-auto",children:a}),e.jsx(ft,{})]}),e.jsx(At,{})]})};export{Rt as L,bt as u};
