import{b as P,u as k,d as C,j as e}from"./vendor-state-DdX3IZQk.js";import{r as d}from"./vendor-react-Da1CiaFS.js";import{G as g,i as L,ap as p,ao as T,ac as F,B as u,o as $,N as q,S as K,I as W,D as B,aa as M,F as Q,bI as R,af as H,aW as O,Y as z,ad as S,ae as G}from"./vendor-ui-8vKhRMah.js";import{d as U,B as b,a4 as h}from"./index-JFxRAnm7.js";import"./vendor-charts-CBc6LDbn.js";const j={startDiscovery:a=>h.post("/discovery",a),listScans:()=>h.get("/discovery/scans"),getScan:a=>h.get(`/discovery/scans/${a}`),deleteScan:a=>h.delete(`/discovery/scans/${a}`),cancelScan:a=>h.post(`/discovery/scans/${a}/cancel`)},D=a=>{switch(a.toLowerCase()){case"completed":return e.jsx(G,{className:"w-4 h-4 text-green-400"});case"failed":return e.jsx(S,{className:"w-4 h-4 text-red-400"});case"running":return e.jsx(p,{className:"w-4 h-4 text-cyan-400 animate-spin"});case"cancelled":return e.jsx(S,{className:"w-4 h-4 text-yellow-400"});default:return e.jsx(z,{className:"w-4 h-4 text-slate-400"})}},X=a=>({CertificateTransparency:"bg-purple-500/20 text-purple-400 border-purple-500/30",DnsEnumeration:"bg-blue-500/20 text-blue-400 border-blue-500/30",Shodan:"bg-orange-500/20 text-orange-400 border-orange-500/30",Censys:"bg-green-500/20 text-green-400 border-green-500/30",Whois:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30"})[a]||"bg-slate-500/20 text-slate-400 border-slate-500/30";function Y({onSuccess:a}){const[c,s]=d.useState(""),[i,x]=d.useState(!0),[t,l]=d.useState(!0),[o,n]=d.useState(!0),[m,_]=d.useState(!1),[v,I]=d.useState(""),[y,A]=d.useState(!1),N=C({mutationFn:j.startDiscovery,onSuccess:()=>{u.success("Discovery scan started"),s(""),a()},onError:r=>{var f,w;u.error(((w=(f=r.response)==null?void 0:f.data)==null?void 0:w.error)||"Failed to start discovery")}}),E=r=>{if(r.preventDefault(),!c){u.error("Please enter a domain");return}N.mutate({domain:c,include_ct_logs:i,include_dns:t,include_whois:o,include_shodan:m,shodan_api_key:m?v:void 0,active_enum:y})};return e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5 text-cyan-400"}),"Start Asset Discovery"]}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Target Domain"}),e.jsx("input",{type:"text",value:c,onChange:r=>s(r.target.value),placeholder:"example.com",className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-slate-700/50 rounded-lg px-3 py-2",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:r=>x(r.target.checked),className:"rounded bg-slate-700 border-slate-600 text-cyan-500"}),e.jsx("span",{className:"text-sm text-slate-300",children:"CT Logs"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-slate-700/50 rounded-lg px-3 py-2",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:r=>l(r.target.checked),className:"rounded bg-slate-700 border-slate-600 text-cyan-500"}),e.jsx("span",{className:"text-sm text-slate-300",children:"DNS Enum"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-slate-700/50 rounded-lg px-3 py-2",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:r=>n(r.target.checked),className:"rounded bg-slate-700 border-slate-600 text-cyan-500"}),e.jsx("span",{className:"text-sm text-slate-300",children:"WHOIS"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-slate-700/50 rounded-lg px-3 py-2",children:[e.jsx("input",{type:"checkbox",checked:m,onChange:r=>_(r.target.checked),className:"rounded bg-slate-700 border-slate-600 text-cyan-500"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Shodan"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-slate-700/50 rounded-lg px-3 py-2",children:[e.jsx("input",{type:"checkbox",checked:y,onChange:r=>A(r.target.checked),className:"rounded bg-slate-700 border-slate-600 text-cyan-500"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Active Enum"})]})]}),m&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Shodan API Key"}),e.jsx("input",{type:"password",value:v,onChange:r=>I(r.target.value),placeholder:"Enter your Shodan API key",className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs(b,{type:"submit",disabled:N.isPending||!c,children:[N.isPending?e.jsx(p,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(O,{className:"w-4 h-4 mr-2"}),"Start Discovery"]})]})]})}function J({scanId:a,onClose:c}){var x;const{data:s,isLoading:i}=k({queryKey:["discovery-scan",a],queryFn:async()=>(await j.getScan(a)).data,refetchInterval:t=>{const l=t.state.data;return(l==null?void 0:l.status)==="running"?3e3:!1}});return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(p,{className:"w-8 h-8 text-cyan-400 animate-spin"})}):s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[D(s.status),s.domain]}),e.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:["Started ",new Date(s.started_at).toLocaleString(),s.completed_at&&` | Completed ${new Date(s.completed_at).toLocaleString()}`]})]}),e.jsx(b,{variant:"secondary",size:"sm",onClick:c,children:"Back to List"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm",children:[e.jsx($,{className:"w-4 h-4"}),"Total Assets"]}),e.jsx("div",{className:"text-2xl font-bold text-white mt-1",children:s.statistics.total_assets})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm",children:[e.jsx(q,{className:"w-4 h-4"}),"Unique IPs"]}),e.jsx("div",{className:"text-2xl font-bold text-white mt-1",children:s.statistics.unique_ips})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm",children:[e.jsx(K,{className:"w-4 h-4"}),"From CT Logs"]}),e.jsx("div",{className:"text-2xl font-bold text-white mt-1",children:s.statistics.subdomains_from_ct})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm",children:[e.jsx(W,{className:"w-4 h-4"}),"Technologies"]}),e.jsx("div",{className:"text-2xl font-bold text-white mt-1",children:s.statistics.technologies_identified})]})]}),s.whois&&e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700 p-4",children:[e.jsxs("h4",{className:"text-lg font-semibold text-white mb-3 flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-cyan-400"}),"WHOIS Information"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Registrar"}),e.jsx("p",{className:"text-white",children:s.whois.registrar||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Created"}),e.jsx("p",{className:"text-white",children:s.whois.creation_date||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Expires"}),e.jsx("p",{className:"text-white",children:s.whois.expiration_date||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Nameservers"}),e.jsx("p",{className:"text-white",children:((x=s.whois.nameservers)==null?void 0:x.join(", "))||"N/A"})]})]})]}),s.errors.length>0&&e.jsxs("div",{className:"bg-red-900/20 rounded-lg border border-red-800/50 p-4",children:[e.jsxs("h4",{className:"text-lg font-semibold text-red-400 mb-2 flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5"}),"Errors (",s.errors.length,")"]}),e.jsx("ul",{className:"text-sm text-red-300 space-y-1",children:s.errors.map((t,l)=>e.jsx("li",{children:t},l))})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700",children:[e.jsx("div",{className:"p-4 border-b border-slate-700",children:e.jsxs("h4",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5 text-cyan-400"}),"Discovered Assets (",s.assets.length,")"]})}),e.jsx("div",{className:"divide-y divide-slate-700 max-h-96 overflow-y-auto",children:s.assets.map(t=>e.jsx("div",{className:"p-4 hover:bg-slate-700/50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"w-4 h-4 text-cyan-400"}),e.jsx("span",{className:"text-white font-medium",children:t.hostname}),t.country&&e.jsxs("span",{className:"text-xs text-slate-400 flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"}),t.city?`${t.city}, ${t.country}`:t.country]})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:t.sources.map((l,o)=>e.jsx("span",{className:`px-2 py-0.5 rounded text-xs border ${X(l)}`,children:l},o))}),t.ip_addresses.length>0&&e.jsxs("div",{className:"text-xs text-slate-400 mt-2",children:["IPs: ",t.ip_addresses.join(", ")]}),t.ports.length>0&&e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Ports: ",t.ports.map(l=>`${l.port}/${l.protocol}`).join(", ")]})]}),e.jsx("a",{href:`https://${t.hostname}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 hover:bg-slate-600 rounded-lg",children:e.jsx(H,{className:"w-4 h-4 text-slate-400"})})]})},t.id))})]})]}):e.jsx("div",{className:"text-slate-400",children:"Scan not found"})}function ae(){const a=P(),[c,s]=d.useState(null),{data:i,isLoading:x,refetch:t}=k({queryKey:["discovery-scans"],queryFn:async()=>(await j.listScans()).data,refetchInterval:1e4}),l=C({mutationFn:j.deleteScan,onSuccess:()=>{u.success("Scan deleted"),a.invalidateQueries({queryKey:["discovery-scans"]})},onError:()=>u.error("Failed to delete scan")}),o=(i==null?void 0:i.scans)||[];return e.jsxs(U,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[e.jsx(g,{className:"w-7 h-7 text-cyan-400"}),"Asset Discovery"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:"Discover assets using Certificate Transparency logs, DNS enumeration, WHOIS, and Shodan"})]}),c?e.jsx(J,{scanId:c,onClose:()=>s(null)}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(Y,{onSuccess:()=>{a.invalidateQueries({queryKey:["discovery-scans"]})}})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5 text-cyan-400"}),"Discovery Scans"]}),e.jsx(b,{variant:"secondary",size:"sm",onClick:()=>t(),children:e.jsx(p,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"divide-y divide-slate-700",children:x?e.jsx("div",{className:"p-8 text-center",children:e.jsx(p,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto"})}):o.length===0?e.jsxs("div",{className:"p-8 text-center text-slate-400",children:[e.jsx(g,{className:"w-12 h-12 mx-auto mb-3 text-slate-600"}),e.jsx("p",{children:"No discovery scans yet"}),e.jsx("p",{className:"text-sm mt-1",children:"Start a discovery scan to find assets"})]}):o.map(n=>e.jsx("div",{className:"p-4 hover:bg-slate-700/50 transition-colors cursor-pointer",onClick:()=>s(n.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[D(n.status),e.jsx("span",{className:"text-white font-medium",children:n.domain}),e.jsxs("span",{className:"text-xs px-2 py-0.5 rounded bg-cyan-500/20 text-cyan-400",children:[n.assets_count," assets"]})]}),e.jsx("div",{className:"text-sm text-slate-400 mt-1",children:new Date(n.created_at).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:m=>{m.stopPropagation(),confirm("Delete this scan?")&&l.mutate(n.id)},className:"p-2 hover:bg-slate-600 rounded-lg",children:e.jsx(T,{className:"w-4 h-4 text-slate-400 hover:text-red-400"})}),e.jsx(F,{className:"w-5 h-5 text-slate-400"})]})]})},n.id))})]})})]})]})}export{ae as default};
