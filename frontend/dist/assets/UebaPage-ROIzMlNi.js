import{j as e,u as w,b as z,d as f}from"./vendor-state-DdX3IZQk.js";import{r as N}from"./vendor-react-Da1CiaFS.js";import{ae as ce,s as Ne,j as D,aB as P,A as K,G as M,a6 as L,aP as q,S as ve,B as p,l as fe,P as E,E as de,aO as T,aF as oe,n as we,bv as re,ar as le,J as ie,ac as _e,v as ne,Z as ke,bi as xe,ao as Ce,cl as Se,N as Ae,bo as De}from"./vendor-ui-DSYmGUHq.js";import{d as Fe,an as h,b as u}from"./index-DZQk2Cot.js";import"./vendor-charts-Ci07V6_i.js";const b={low:{bg:"bg-green-500/20",text:"text-green-400",border:"border-green-500"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500"},high:{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500"},critical:{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500"}},R={new:{bg:"bg-blue-500/20",text:"text-blue-400"},acknowledged:{bg:"bg-yellow-500/20",text:"text-yellow-400"},investigating:{bg:"bg-orange-500/20",text:"text-orange-400"},confirmed:{bg:"bg-red-500/20",text:"text-red-400"},false_positive:{bg:"bg-gray-500/20",text:"text-gray-400"},resolved:{bg:"bg-green-500/20",text:"text-green-400"},suppressed:{bg:"bg-gray-600/20",text:"text-gray-500"}},V={user:e.jsx(D,{className:"w-4 h-4"}),host:e.jsx(ne,{className:"w-4 h-4"}),service_account:e.jsx(xe,{className:"w-4 h-4"}),application:e.jsx(ke,{className:"w-4 h-4"}),device:e.jsx(ne,{className:"w-4 h-4"}),ip_address:e.jsx(M,{className:"w-4 h-4"})},S=({isOpen:a,onClose:x,title:r,children:t,size:l="lg"})=>{if(!a)return null;const o={md:"max-w-md",lg:"max-w-2xl",xl:"max-w-4xl"};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:x}),e.jsxs("div",{className:`relative bg-gray-800 border border-gray-700 rounded-lg shadow-xl w-full ${o[l]} max-h-[90vh] overflow-y-auto`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:r}),e.jsx("button",{onClick:x,className:"p-1 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-white",children:e.jsx(Ce,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4",children:t})]})]})},qe=()=>{const{data:a,isLoading:x}=w({queryKey:["ueba","dashboard"],queryFn:async()=>(await h.getDashboard()).data});return x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(q,{className:"w-8 h-8 animate-spin text-cyan-500"})}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-cyan-500/20 rounded-lg",children:e.jsx(D,{className:"w-5 h-5 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Total Entities"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:a.total_entities})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-500/20 rounded-lg",children:e.jsx(P,{className:"w-5 h-5 text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"High Risk Entities"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:a.high_risk_entities})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/20 rounded-lg",children:e.jsx(ve,{className:"w-5 h-5 text-red-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Critical Risk"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:a.critical_risk_entities})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx(K,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"New Anomalies"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:a.new_anomalies})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Risk Distribution"}),e.jsx("div",{className:"space-y-3",children:Object.entries(a.risk_distribution).map(([r,t])=>{const l=Object.values(a.risk_distribution).reduce((n,v)=>n+v,0),o=l>0?t/l*100:0,i=b[r]||b.low;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:`capitalize ${i.text}`,children:r}),e.jsx("span",{className:"text-gray-400",children:t})]}),e.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${i.bg} transition-all`,style:{width:`${o}%`}})})]},r)})})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Anomalies by Type"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:a.anomalies_by_type.length>0?a.anomalies_by_type.map(r=>e.jsxs("div",{className:"flex justify-between items-center py-1",children:[e.jsx("span",{className:"text-gray-300 text-sm capitalize",children:r.anomaly_type.replace(/_/g," ")}),e.jsx("span",{className:"text-cyan-400 font-medium",children:r.count})]},r.anomaly_type)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No anomalies detected"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Top Risk Entities"}),e.jsx("div",{className:"space-y-2",children:a.top_risk_entities.length>0?a.top_risk_entities.slice(0,5).map(r=>{const t=b[r.risk_level]||b.low;return e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-700 last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded ${t.bg}`,children:V[r.entity_type]||e.jsx(D,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm font-medium",children:r.display_name||r.entity_id}),e.jsx("p",{className:"text-gray-500 text-xs capitalize",children:r.entity_type})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:`px-2 py-1 text-xs rounded ${t.bg} ${t.text}`,children:["Score: ",r.risk_score]})})]},r.entity_id)}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No high-risk entities"})})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Recent Anomalies"}),e.jsx("div",{className:"space-y-2",children:a.recent_anomalies.length>0?a.recent_anomalies.slice(0,5).map(r=>{const t=R[r.status]||R.new;return e.jsxs("div",{className:"py-2 border-b border-gray-700 last:border-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-white text-sm font-medium",children:r.title}),e.jsx("span",{className:`px-2 py-1 text-xs rounded ${t.bg} ${t.text}`,children:r.status})]}),e.jsxs("p",{className:"text-gray-500 text-xs mt-1 capitalize",children:[r.anomaly_type.replace(/_/g," ")," • ",new Date(r.detected_at).toLocaleString()]})]},r.id)}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No recent anomalies"})})]})]})]}):e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(ce,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No UEBA data available. Start by adding entities."})]})},Ee=()=>{const a=z(),[x,r]=N.useState(""),[t,l]=N.useState(""),[o,i]=N.useState(""),[n,v]=N.useState(!1),[_,C]=N.useState(null),{data:y,isLoading:F}=w({queryKey:["ueba","entities",{search:x,entityTypeFilter:t,riskLevelFilter:o}],queryFn:async()=>(await h.listEntities({search:x||void 0,entity_type:t||void 0,risk_level:o||void 0,limit:50})).data}),g=f({mutationFn:c=>h.createEntity(c),onSuccess:()=>{a.invalidateQueries({queryKey:["ueba","entities"]}),p.success("Entity created successfully"),v(!1)},onError:()=>p.error("Failed to create entity")}),m=f({mutationFn:c=>h.deleteEntity(c),onSuccess:()=>{a.invalidateQueries({queryKey:["ueba","entities"]}),p.success("Entity deleted successfully")},onError:()=>p.error("Failed to delete entity")}),k=(y==null?void 0:y.entities)||[];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search entities...",value:x,onChange:c=>r(c.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs("select",{value:t,onChange:c=>l(c.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"host",children:"Host"}),e.jsx("option",{value:"service_account",children:"Service Account"}),e.jsx("option",{value:"application",children:"Application"})]}),e.jsxs("select",{value:o,onChange:c=>i(c.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Risk Levels"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]}),e.jsxs(u,{onClick:()=>v(!0),children:[e.jsx(E,{className:"w-4 h-4 mr-2"})," Add Entity"]})]}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Department"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Risk Score"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Last Activity"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:F?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(q,{className:"w-6 h-6 animate-spin mx-auto"})})}):k.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-400",children:"No entities found"})}):k.map(c=>{const A=b[c.risk_level]||b.low;return e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[V[c.entity_type]||e.jsx(D,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:c.display_name||c.entity_id}),e.jsx("p",{className:"text-gray-500 text-sm",children:c.entity_id})]})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-300 capitalize",children:c.entity_type.replace(/_/g," ")}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:c.department||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`px-2 py-1 text-xs rounded ${A.bg} ${A.text}`,children:[c.risk_score," (",c.risk_level,")"]})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded ${c.is_active?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:c.is_active?"Active":"Inactive"}),c.is_privileged&&e.jsx("span",{className:"ml-2 px-2 py-1 text-xs rounded bg-purple-500/20 text-purple-400",children:"Privileged"})]}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:c.last_activity_at?new Date(c.last_activity_at).toLocaleString():"Never"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>C(c),className:"p-1 rounded hover:bg-gray-700 text-gray-400 hover:text-white",title:"View details",children:e.jsx(de,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>m.mutate(c.id),className:"p-1 rounded hover:bg-gray-700 text-gray-400 hover:text-red-400",title:"Delete",children:e.jsx(T,{className:"w-4 h-4"})})]})})]},c.id)})})]})}),e.jsx(S,{isOpen:n,onClose:()=>v(!1),title:"Add Entity",children:e.jsx(Re,{onSubmit:c=>g.mutate(c),onCancel:()=>v(!1),loading:g.isPending})}),_&&e.jsx(S,{isOpen:!0,onClose:()=>C(null),title:"Entity Details",size:"xl",children:e.jsx(Te,{entity:_,onClose:()=>C(null)})})]})},Re=({onSubmit:a,onCancel:x,loading:r})=>{const[t,l]=N.useState({entity_type:"user",entity_id:"",display_name:"",department:"",role:"",location:"",is_privileged:!1,is_service_account:!1}),o=i=>{i.preventDefault(),a(t)};return e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Entity Type *"}),e.jsxs("select",{required:!0,value:t.entity_type,onChange:i=>l({...t,entity_type:i.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"host",children:"Host"}),e.jsx("option",{value:"service_account",children:"Service Account"}),e.jsx("option",{value:"application",children:"Application"}),e.jsx("option",{value:"device",children:"Device"}),e.jsx("option",{value:"ip_address",children:"IP Address"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Entity ID *"}),e.jsx("input",{type:"text",required:!0,value:t.entity_id,onChange:i=>l({...t,entity_id:i.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"e.g., john.doe@example.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Display Name"}),e.jsx("input",{type:"text",value:t.display_name||"",onChange:i=>l({...t,display_name:i.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"e.g., John Doe"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Department"}),e.jsx("input",{type:"text",value:t.department||"",onChange:i=>l({...t,department:i.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"e.g., Engineering"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Role"}),e.jsx("input",{type:"text",value:t.role||"",onChange:i=>l({...t,role:i.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"e.g., Developer"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Location"}),e.jsx("input",{type:"text",value:t.location||"",onChange:i=>l({...t,location:i.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"e.g., New York"})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.is_privileged,onChange:i=>l({...t,is_privileged:i.target.checked}),className:"rounded border-gray-700 bg-gray-900 text-cyan-500"}),e.jsx("span",{className:"text-gray-300",children:"Privileged Account"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.is_service_account,onChange:i=>l({...t,is_service_account:i.target.checked}),className:"rounded border-gray-700 bg-gray-900 text-cyan-500"}),e.jsx("span",{className:"text-gray-300",children:"Service Account"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx(u,{variant:"secondary",onClick:x,children:"Cancel"}),e.jsx(u,{type:"submit",loading:r,children:"Create Entity"})]})]})},Te=({entity:a})=>{const{data:x}=w({queryKey:["ueba","entity",a.id,"baselines"],queryFn:async()=>(await h.getEntityBaselines(a.id)).data}),{data:r}=w({queryKey:["ueba","entity",a.id,"riskFactors"],queryFn:async()=>(await h.getEntityRiskFactors(a.id)).data}),t=b[a.risk_level]||b.low;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${t.bg}`,children:V[a.entity_type]||e.jsx(D,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:a.display_name||a.entity_id}),e.jsx("p",{className:"text-gray-400 capitalize",children:a.entity_type.replace(/_/g," ")})]})]}),e.jsxs("div",{className:`px-4 py-2 rounded-lg ${t.bg} ${t.text} font-bold`,children:["Risk Score: ",a.risk_score]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Department"}),e.jsx("p",{className:"text-white",children:a.department||"N/A"})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Role"}),e.jsx("p",{className:"text-white",children:a.role||"N/A"})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Location"}),e.jsx("p",{className:"text-white",children:a.location||"N/A"})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Status"}),e.jsx("p",{className:a.is_active?"text-green-400":"text-gray-400",children:a.is_active?"Active":"Inactive"})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"First Seen"}),e.jsx("p",{className:"text-white",children:a.first_seen_at?new Date(a.first_seen_at).toLocaleDateString():"N/A"})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Last Activity"}),e.jsx("p",{className:"text-white",children:a.last_activity_at?new Date(a.last_activity_at).toLocaleString():"Never"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-3",children:"Risk Factors"}),e.jsx("div",{className:"bg-gray-900 rounded-lg p-4",children:r!=null&&r.risk_factors&&r.risk_factors.length>0?e.jsx("div",{className:"space-y-2",children:r.risk_factors.map(l=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-800 last:border-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white capitalize",children:l.factor_type.replace(/_/g," ")}),e.jsx("p",{className:"text-gray-500 text-sm",children:l.description})]}),e.jsxs("span",{className:"text-orange-400 font-medium",children:["+",l.contribution]})]},l.id))}):e.jsx("p",{className:"text-gray-500",children:"No risk factors contributing to score"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-3",children:"Behavioral Baselines"}),e.jsx("div",{className:"bg-gray-900 rounded-lg p-4",children:x&&x.length>0?e.jsx("div",{className:"space-y-2",children:x.slice(0,5).map(l=>{var o,i;return e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-800 last:border-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:l.metric_name}),e.jsx("p",{className:"text-gray-500 text-sm capitalize",children:l.metric_category.replace(/_/g," ")})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-cyan-400",children:["Mean: ",((o=l.mean_value)==null?void 0:o.toFixed(2))||"N/A"]}),e.jsxs("p",{className:"text-gray-500 text-sm",children:["±",((i=l.std_deviation)==null?void 0:i.toFixed(2))||0]})]})]},l.id)})}):e.jsx("p",{className:"text-gray-500",children:"No baselines established yet. Baselines are calculated after sufficient activity data."})})]})]})},Pe=()=>{var F,g;const a=z(),[x,r]=N.useState(""),[t,l]=N.useState(""),[o,i]=N.useState(null),{data:n,isLoading:v}=w({queryKey:["ueba","anomalies",{statusFilter:x,typeFilter:t}],queryFn:async()=>(await h.listAnomalies({status:x||void 0,anomaly_type:t||void 0,limit:50})).data}),_=f({mutationFn:m=>h.acknowledgeAnomaly(m),onSuccess:()=>{a.invalidateQueries({queryKey:["ueba","anomalies"]}),p.success("Anomaly acknowledged")},onError:()=>p.error("Failed to acknowledge anomaly")}),C=f({mutationFn:({id:m,data:k})=>h.resolveAnomaly(m,k),onSuccess:()=>{a.invalidateQueries({queryKey:["ueba","anomalies"]}),p.success("Anomaly resolved")},onError:()=>p.error("Failed to resolve anomaly")}),y=(n==null?void 0:n.anomalies)||[];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:x,onChange:m=>r(m.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"acknowledged",children:"Acknowledged"}),e.jsx("option",{value:"investigating",children:"Investigating"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"false_positive",children:"False Positive"})]}),e.jsxs("select",{value:t,onChange:m=>l(m.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"impossible_travel",children:"Impossible Travel"}),e.jsx("option",{value:"off_hours_activity",children:"Off-Hours Activity"}),e.jsx("option",{value:"excessive_failed_logins",children:"Excessive Failed Logins"}),e.jsx("option",{value:"baseline_deviation",children:"Baseline Deviation"}),e.jsx("option",{value:"unusual_data_access",children:"Unusual Data Access"}),e.jsx("option",{value:"lateral_movement",children:"Lateral Movement"})]})]}),e.jsx("div",{className:"space-y-3",children:v?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(q,{className:"w-6 h-6 animate-spin text-cyan-500"})}):y.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(P,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No anomalies found"})]}):y.map(m=>{const k=R[m.status]||R.new,c=b[m.severity.toLowerCase()]||b.medium;return e.jsx("div",{className:`bg-gray-800 border border-gray-700 rounded-lg p-4 hover:border-gray-600 cursor-pointer transition-colors ${c.border} border-l-4`,onClick:()=>i(m),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(P,{className:`w-4 h-4 ${c.text}`}),e.jsx("h4",{className:"text-white font-medium",children:m.title}),e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${k.bg} ${k.text}`,children:m.status.replace(/_/g," ")})]}),e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:m.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsx("span",{className:"capitalize",children:m.anomaly_type.replace(/_/g," ")}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Detected: ",new Date(m.detected_at).toLocaleString()]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Impact: +",m.risk_score_impact," risk"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[m.status==="new"&&e.jsxs(u,{size:"sm",variant:"secondary",onClick:A=>{A.stopPropagation(),_.mutate(m.id)},children:[e.jsx(oe,{className:"w-4 h-4 mr-1"})," Ack"]}),m.status!=="resolved"&&m.status!=="false_positive"&&e.jsx(u,{size:"sm",onClick:A=>{A.stopPropagation(),C.mutate({id:m.id,data:{}})},children:"Resolve"})]})]})},m.id)})}),o&&e.jsx(S,{isOpen:!0,onClose:()=>i(null),title:"Anomaly Details",size:"xl",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${((F=b[o.severity.toLowerCase()])==null?void 0:F.bg)||"bg-orange-500/20"}`,children:e.jsx(P,{className:"w-8 h-8 text-orange-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:o.title}),e.jsx("p",{className:"text-gray-400 mt-1",children:o.description})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Type"}),e.jsx("p",{className:"text-white capitalize",children:o.anomaly_type.replace(/_/g," ")})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Severity"}),e.jsx("p",{className:`capitalize ${((g=b[o.severity.toLowerCase()])==null?void 0:g.text)||"text-white"}`,children:o.severity})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Risk Impact"}),e.jsxs("p",{className:"text-orange-400",children:["+",o.risk_score_impact]})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Confidence"}),e.jsx("p",{className:"text-white",children:o.confidence?`${(o.confidence*100).toFixed(0)}%`:"N/A"})]})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4",children:[e.jsx("h4",{className:"text-white font-medium mb-2",children:"Evidence"}),e.jsx("pre",{className:"text-gray-400 text-sm whitespace-pre-wrap overflow-auto max-h-48",children:o.evidence})]}),o.mitre_techniques&&e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4",children:[e.jsx("h4",{className:"text-white font-medium mb-2",children:"MITRE ATT&CK Techniques"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:JSON.parse(o.mitre_techniques).map(m=>e.jsx("span",{className:"px-2 py-1 bg-purple-500/20 text-purple-400 text-sm rounded",children:m},m))})]})]})})]})},$e=()=>{const[a,x]=N.useState(""),[r,t]=N.useState(!1),{data:l,isLoading:o}=w({queryKey:["ueba","activities",{entityFilter:a,anomalousOnly:r}],queryFn:async()=>(await h.listActivities({entity_id:a||void 0,is_anomalous:r||void 0,limit:50})).data}),i=(l==null?void 0:l.activities)||[];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:n=>t(n.target.checked),className:"rounded border-gray-700 bg-gray-900 text-cyan-500"}),e.jsx("span",{className:"text-gray-300",children:"Anomalous Only"})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Activity"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Source"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Destination"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Risk"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Timestamp"})]})}),e.jsx("tbody",{children:o?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(q,{className:"w-6 h-6 animate-spin mx-auto"})})}):i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-400",children:"No activities found"})}):i.map(n=>e.jsxs("tr",{className:`border-b border-gray-700 hover:bg-gray-700/50 ${n.is_anomalous?"bg-orange-500/5":""}`,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:`w-4 h-4 ${n.is_anomalous?"text-orange-400":"text-gray-400"}`}),e.jsx("span",{className:"text-white capitalize",children:n.activity_type.replace(/_/g," ")}),n.is_anomalous&&e.jsx("span",{className:"px-2 py-0.5 text-xs rounded bg-orange-500/20 text-orange-400",children:"Anomalous"})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:n.source_ip&&e.jsxs("div",{children:[e.jsx("p",{children:n.source_ip}),n.source_country&&e.jsx("p",{className:"text-gray-500 text-xs",children:n.source_country})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:n.destination||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`text-${n.risk_contribution>5?"orange":n.risk_contribution>0?"yellow":"gray"}-400`,children:["+",n.risk_contribution]})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(n.timestamp).toLocaleString()})]},n.id))})]})})]})},Le=()=>{const{data:a,isLoading:x}=w({queryKey:["ueba","sessions"],queryFn:async()=>(await h.listSessions({limit:50})).data}),r=(a==null?void 0:a.sessions)||[];return e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Session"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Source"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Auth"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Security"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Started"})]})}),e.jsx("tbody",{children:x?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(q,{className:"w-6 h-6 animate-spin mx-auto"})})}):r.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-400",children:"No sessions found"})}):r.map(t=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("span",{className:"text-white capitalize",children:t.session_type}),t.session_id&&e.jsxs("p",{className:"text-gray-500 text-xs",children:[t.session_id.slice(0,20),"..."]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white",children:t.source_ip}),t.source_country&&e.jsxs("p",{className:"text-gray-500 text-xs",children:[t.source_city,", ",t.source_country]})]})]})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded ${t.auth_status==="success"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:t.auth_status}),t.mfa_used&&e.jsx("span",{className:"ml-2 px-2 py-1 text-xs rounded bg-blue-500/20 text-blue-400",children:"MFA"})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-1",children:[t.is_vpn&&e.jsx("span",{className:"px-2 py-0.5 text-xs rounded bg-purple-500/20 text-purple-400",children:"VPN"}),t.is_tor&&e.jsx("span",{className:"px-2 py-0.5 text-xs rounded bg-red-500/20 text-red-400",children:"TOR"}),t.is_proxy&&e.jsx("span",{className:"px-2 py-0.5 text-xs rounded bg-yellow-500/20 text-yellow-400",children:"Proxy"}),!t.is_vpn&&!t.is_tor&&!t.is_proxy&&e.jsx("span",{className:"text-gray-500",children:"-"})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(t.started_at).toLocaleString()})]},t.id))})]})})})},ze=()=>{const a=z(),[x,r]=N.useState(!1),{data:t,isLoading:l}=w({queryKey:["ueba","peer-groups"],queryFn:async()=>(await h.listPeerGroups()).data}),o=f({mutationFn:n=>h.createPeerGroup(n),onSuccess:()=>{a.invalidateQueries({queryKey:["ueba","peer-groups"]}),p.success("Peer group created successfully"),r(!1)},onError:()=>p.error("Failed to create peer group")}),i=(t==null?void 0:t.peer_groups)||[];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(u,{onClick:()=>r(!0),children:[e.jsx(E,{className:"w-4 h-4 mr-2"})," Create Peer Group"]})}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:l?e.jsx("div",{className:"col-span-2 flex justify-center py-8",children:e.jsx(q,{className:"w-6 h-6 animate-spin text-cyan-500"})}):i.length===0?e.jsxs("div",{className:"col-span-2 text-center py-8 text-gray-400",children:[e.jsx(D,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No peer groups defined"})]}):i.map(n=>e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:n.name}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:n.description||"No description"})]}),e.jsxs("span",{className:"px-2 py-1 bg-cyan-500/20 text-cyan-400 text-sm rounded",children:[n.member_count," members"]})]}),n.is_auto_generated&&e.jsx("span",{className:"mt-2 inline-block px-2 py-0.5 text-xs rounded bg-gray-700 text-gray-400",children:"Auto-generated"})]},n.id))}),e.jsx(S,{isOpen:x,onClose:()=>r(!1),title:"Create Peer Group",children:e.jsxs("form",{onSubmit:n=>{n.preventDefault();const v=n.target,_=new FormData(v);o.mutate({name:_.get("name"),description:_.get("description")||void 0,criteria:{department:_.get("department")||void 0,role:_.get("role")||void 0,entity_type:_.get("entity_type")||void 0}})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{name:"name",type:"text",required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"e.g., Engineering Team"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",rows:2,placeholder:"Optional description"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Department"}),e.jsx("input",{name:"department",type:"text",className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"e.g., Engineering"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Role"}),e.jsx("input",{name:"role",type:"text",className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"e.g., Developer"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Entity Type"}),e.jsxs("select",{name:"entity_type",className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"Any"}),e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"host",children:"Host"}),e.jsx("option",{value:"service_account",children:"Service Account"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx(u,{variant:"secondary",onClick:()=>r(!1),children:"Cancel"}),e.jsx(u,{type:"submit",loading:o.isPending,children:"Create"})]})]})})]})},Ke=()=>{var ee,se,te,ae;const a=z(),[x,r]=N.useState("detections"),[t,l]=N.useState(!1),[o,i]=N.useState(!1),[n,v]=N.useState(!1),[_,C]=N.useState(!1),[y,F]=N.useState(null),{data:g,isLoading:m}=w({queryKey:["ueba","advanced","stats"],queryFn:async()=>(await h.getAdvancedStats()).data}),{data:k,isLoading:c}=w({queryKey:["ueba","advanced","detections"],queryFn:async()=>(await h.listAdvancedDetections({limit:50})).data}),{data:A}=w({queryKey:["ueba","advanced","business-hours"],queryFn:async()=>(await h.listBusinessHours()).data}),{data:me}=w({queryKey:["ueba","advanced","sensitive-resources"],queryFn:async()=>(await h.listSensitiveResources()).data}),{data:pe}=w({queryKey:["ueba","advanced","known-vpns"],queryFn:async()=>(await h.listKnownVpns()).data}),{data:he}=w({queryKey:["ueba","advanced","detection-rules"],queryFn:async()=>(await h.listDetectionRules()).data}),$=f({mutationFn:async s=>h.runAdvancedDetection({detection_type:s,time_window_hours:24}),onSuccess:s=>{const j=s.data;p.success(`Detection complete: ${j.detections_created} detections found from ${j.entities_analyzed} entities`),a.invalidateQueries({queryKey:["ueba","advanced"]})},onError:()=>p.error("Failed to run detection")}),H=f({mutationFn:s=>h.createBusinessHours(s),onSuccess:()=>{a.invalidateQueries({queryKey:["ueba","advanced","business-hours"]}),p.success("Business hours created"),l(!1)},onError:()=>p.error("Failed to create business hours")}),I=f({mutationFn:s=>h.createSensitiveResource(s),onSuccess:()=>{a.invalidateQueries({queryKey:["ueba","advanced","sensitive-resources"]}),p.success("Sensitive resource created"),i(!1)},onError:()=>p.error("Failed to create sensitive resource")}),Q=f({mutationFn:s=>h.createKnownVpn(s),onSuccess:()=>{a.invalidateQueries({queryKey:["ueba","advanced","known-vpns"]}),p.success("Known VPN created"),v(!1)},onError:()=>p.error("Failed to create known VPN")}),U=f({mutationFn:s=>h.createDetectionRule(s),onSuccess:()=>{a.invalidateQueries({queryKey:["ueba","advanced","detection-rules"]}),p.success("Detection rule created"),C(!1)},onError:()=>p.error("Failed to create detection rule")}),ge=f({mutationFn:s=>h.deleteBusinessHours(s),onSuccess:()=>{a.invalidateQueries({queryKey:["ueba","advanced","business-hours"]}),p.success("Business hours deleted")},onError:()=>p.error("Failed to delete business hours")}),ue=f({mutationFn:s=>h.deleteSensitiveResource(s),onSuccess:()=>{a.invalidateQueries({queryKey:["ueba","advanced","sensitive-resources"]}),p.success("Sensitive resource deleted")},onError:()=>p.error("Failed to delete sensitive resource")}),ye=f({mutationFn:s=>h.deleteKnownVpn(s),onSuccess:()=>{a.invalidateQueries({queryKey:["ueba","advanced","known-vpns"]}),p.success("Known VPN deleted")},onError:()=>p.error("Failed to delete known VPN")}),je=f({mutationFn:s=>h.deleteDetectionRule(s),onSuccess:()=>{a.invalidateQueries({queryKey:["ueba","advanced","detection-rules"]}),p.success("Detection rule deleted")},onError:()=>p.error("Failed to delete detection rule")}),G=(k==null?void 0:k.detections)||[],J=A||[],Y=me||[],Z=pe||[],B=he||[],X=[{id:"impossible_travel",label:"Impossible Travel",icon:e.jsx(Se,{className:"w-4 h-4"}),description:"Detect logins from geographically distant locations in short time"},{id:"unusual_data_access",label:"Unusual Data Access",icon:e.jsx(ie,{className:"w-4 h-4"}),description:"Detect access to sensitive data outside normal patterns"},{id:"off_hours_activity",label:"Off-Hours Activity",icon:e.jsx(le,{className:"w-4 h-4"}),description:"Detect activity outside business hours"},{id:"service_account_abuse",label:"Service Account Abuse",icon:e.jsx(xe,{className:"w-4 h-4"}),description:"Detect misuse of service accounts"},{id:"lateral_movement",label:"Lateral Movement",icon:e.jsx(Ae,{className:"w-4 h-4"}),description:"Detect host-to-host movement patterns"},{id:"data_exfiltration",label:"Data Exfiltration",icon:e.jsx(De,{className:"w-4 h-4"}),description:"Detect large data transfers to external destinations"}],W={public:{bg:"bg-gray-500/20",text:"text-gray-400"},internal:{bg:"bg-blue-500/20",text:"text-blue-400"},confidential:{bg:"bg-yellow-500/20",text:"text-yellow-400"},restricted:{bg:"bg-orange-500/20",text:"text-orange-400"},top_secret:{bg:"bg-red-500/20",text:"text-red-400"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(L,{className:"w-5 h-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Total Detections"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:(g==null?void 0:g.total_detections)||0})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-cyan-500/20 rounded-lg",children:e.jsx(K,{className:"w-5 h-5 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"New (24h)"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:(g==null?void 0:g.new_detections_24h)||0})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/20 rounded-lg",children:e.jsx(we,{className:"w-5 h-5 text-red-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Confirmed"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:(g==null?void 0:g.confirmed_detections)||0})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(oe,{className:"w-5 h-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"False Positives"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:(g==null?void 0:g.false_positives)||0})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:e.jsx(re,{className:"w-5 h-5 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Active Rules"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:B.filter(s=>s.enabled).length})]})]})})]}),e.jsxs("div",{className:"flex gap-4 border-b border-gray-700 pb-2",children:[e.jsx("button",{onClick:()=>r("detections"),className:`px-3 py-1 rounded-t-lg ${x==="detections"?"bg-gray-700 text-white":"text-gray-400 hover:text-white"}`,children:"Detections"}),e.jsx("button",{onClick:()=>r("config"),className:`px-3 py-1 rounded-t-lg ${x==="config"?"bg-gray-700 text-white":"text-gray-400 hover:text-white"}`,children:"Configuration"}),e.jsx("button",{onClick:()=>r("data"),className:`px-3 py-1 rounded-t-lg ${x==="data"?"bg-gray-700 text-white":"text-gray-400 hover:text-white"}`,children:"Run Detection"})]}),x==="detections"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Detections by Type"}),e.jsx("div",{className:"space-y-2",children:(ee=g==null?void 0:g.detections_by_type)!=null&&ee.length?g.detections_by_type.map(s=>e.jsxs("div",{className:"flex justify-between items-center py-1",children:[e.jsx("span",{className:"text-gray-300 text-sm capitalize",children:s.detection_type.replace(/_/g," ")}),e.jsx("span",{className:"text-cyan-400 font-medium",children:s.count})]},s.detection_type)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No detections yet"})})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Detections by Severity"}),e.jsx("div",{className:"space-y-2",children:(se=g==null?void 0:g.detections_by_severity)!=null&&se.length?g.detections_by_severity.map(s=>{const j=b[s.severity.toLowerCase()]||b.medium;return e.jsxs("div",{className:"flex justify-between items-center py-1",children:[e.jsx("span",{className:`text-sm capitalize ${j.text}`,children:s.severity}),e.jsx("span",{className:"text-white font-medium",children:s.count})]},s.severity)}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No detections yet"})})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsx("h3",{className:"text-lg font-medium text-white",children:"Recent Advanced Detections"})}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Detection"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Confidence"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Detected"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:c?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(q,{className:"w-6 h-6 animate-spin mx-auto"})})}):G.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-400",children:"No advanced detections found. Run detection algorithms to find threats."})}):G.map(s=>{const j=b[s.severity.toLowerCase()]||b.medium,d=R[s.status]||R.new;return e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("p",{className:"text-white font-medium",children:s.title}),e.jsx("p",{className:"text-gray-500 text-xs",children:s.entity_id})]}),e.jsx("td",{className:"px-4 py-3 text-gray-300 capitalize text-sm",children:s.detection_type.replace(/_/g," ")}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded ${j.bg} ${j.text}`,children:s.severity})}),e.jsxs("td",{className:"px-4 py-3 text-gray-300",children:[(s.confidence*100).toFixed(0),"%"]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded ${d.bg} ${d.text}`,children:s.status})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(s.detected_at).toLocaleString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>F(s),className:"p-1 rounded hover:bg-gray-700 text-gray-400 hover:text-white",children:e.jsx(de,{className:"w-4 h-4"})})})]},s.id)})})]})]})]}),x==="config"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5 text-cyan-400"}),"Business Hours"]}),e.jsxs(u,{size:"sm",onClick:()=>l(!0),children:[e.jsx(E,{className:"w-4 h-4 mr-1"})," Add"]})]}),e.jsx("div",{className:"space-y-2",children:J.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"No business hours configured. Off-hours detection uses 9 AM - 5 PM weekdays by default."}):J.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-700 last:border-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.name}),e.jsxs("p",{className:"text-gray-500 text-xs",children:["Timezone: ",s.timezone]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.is_default&&e.jsx("span",{className:"px-2 py-1 text-xs rounded bg-cyan-500/20 text-cyan-400",children:"Default"}),e.jsx("button",{onClick:()=>ge.mutate(s.id),className:"p-1 rounded hover:bg-gray-700 text-gray-400 hover:text-red-400",children:e.jsx(T,{className:"w-4 h-4"})})]})]},s.id))})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[e.jsx(ie,{className:"w-5 h-5 text-orange-400"}),"Sensitive Resources"]}),e.jsxs(u,{size:"sm",onClick:()=>i(!0),children:[e.jsx(E,{className:"w-4 h-4 mr-1"})," Add"]})]}),e.jsx("div",{className:"space-y-2",children:Y.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"No sensitive resources defined. Add resources to enable unusual data access detection."}):Y.map(s=>{const j=W[s.sensitivity_level]||W.internal;return e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-700 last:border-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.name}),e.jsxs("p",{className:"text-gray-500 text-xs",children:["Pattern: ",s.resource_pattern]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded ${j.bg} ${j.text} capitalize`,children:s.sensitivity_level.replace(/_/g," ")}),e.jsx("button",{onClick:()=>ue.mutate(s.id),className:"p-1 rounded hover:bg-gray-700 text-gray-400 hover:text-red-400",children:e.jsx(T,{className:"w-4 h-4"})})]})]},s.id)})})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-purple-400"}),"Known VPNs / Proxies"]}),e.jsxs(u,{size:"sm",onClick:()=>v(!0),children:[e.jsx(E,{className:"w-4 h-4 mr-1"})," Add"]})]}),e.jsx("div",{className:"space-y-2",children:Z.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"No known VPNs configured. Add corporate VPNs to reduce false positives in impossible travel detection."}):Z.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-700 last:border-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.name}),e.jsx("p",{className:"text-gray-500 text-xs",children:s.provider||"Unknown provider"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.is_corporate&&e.jsx("span",{className:"px-2 py-1 text-xs rounded bg-blue-500/20 text-blue-400",children:"Corporate"}),s.is_trusted&&e.jsx("span",{className:"px-2 py-1 text-xs rounded bg-green-500/20 text-green-400",children:"Trusted"}),e.jsx("button",{onClick:()=>ye.mutate(s.id),className:"p-1 rounded hover:bg-gray-700 text-gray-400 hover:text-red-400",children:e.jsx(T,{className:"w-4 h-4"})})]})]},s.id))})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5 text-yellow-400"}),"Detection Rules"]}),e.jsxs(u,{size:"sm",onClick:()=>C(!0),children:[e.jsx(E,{className:"w-4 h-4 mr-1"})," Add"]})]}),e.jsx("div",{className:"space-y-2",children:B.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"No custom detection rules. Default detection algorithms are always active."}):B.map(s=>{const j=b[s.severity.toLowerCase()]||b.medium;return e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-700 last:border-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.name}),e.jsx("p",{className:"text-gray-500 text-xs capitalize",children:s.detection_type.replace(/_/g," ")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded ${j.bg} ${j.text}`,children:s.severity}),e.jsx("span",{className:`px-2 py-1 text-xs rounded ${s.enabled?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:s.enabled?"Enabled":"Disabled"}),e.jsx("button",{onClick:()=>je.mutate(s.id),className:"p-1 rounded hover:bg-gray-700 text-gray-400 hover:text-red-400",children:e.jsx(T,{className:"w-4 h-4"})})]})]},s.id)})})]})]}),x==="data"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Run Advanced Detection Algorithms"}),e.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"Execute behavioral detection algorithms against collected activity data. Each algorithm analyzes the last 24 hours of data."}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:X.map(s=>e.jsx("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-cyan-500/20 rounded-lg",children:s.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-white font-medium",children:s.label}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:s.description})]}),e.jsxs(u,{size:"sm",onClick:()=>$.mutate(s.id),loading:$.isPending,children:[e.jsx(_e,{className:"w-4 h-4 mr-1"})," Run"]})]})},s.id))})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(u,{size:"lg",onClick:async()=>{for(const s of X)await $.mutateAsync(s.id)},loading:$.isPending,children:[e.jsx(L,{className:"w-5 h-5 mr-2"})," Run All Detection Algorithms"]})})]}),y&&e.jsx(S,{isOpen:!0,onClose:()=>F(null),title:"Detection Details",size:"xl",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${((te=b[y.severity.toLowerCase()])==null?void 0:te.bg)||"bg-orange-500/20"}`,children:e.jsx(L,{className:"w-8 h-8 text-orange-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:y.title}),e.jsx("p",{className:"text-gray-400 mt-1",children:y.description})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Type"}),e.jsx("p",{className:"text-white capitalize",children:y.detection_type.replace(/_/g," ")})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Severity"}),e.jsx("p",{className:`capitalize ${((ae=b[y.severity.toLowerCase()])==null?void 0:ae.text)||"text-white"}`,children:y.severity})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Confidence"}),e.jsxs("p",{className:"text-white",children:[(y.confidence*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Risk Score"}),e.jsxs("p",{className:"text-orange-400",children:["+",y.risk_score]})]})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4",children:[e.jsx("h4",{className:"text-white font-medium mb-2",children:"Evidence"}),e.jsx("pre",{className:"text-gray-400 text-sm whitespace-pre-wrap overflow-auto max-h-48",children:y.evidence})]}),y.geolocation_data&&e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4",children:[e.jsx("h4",{className:"text-white font-medium mb-2",children:"Geolocation Data"}),e.jsx("pre",{className:"text-gray-400 text-sm whitespace-pre-wrap overflow-auto max-h-32",children:y.geolocation_data})]}),y.mitre_techniques&&e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4",children:[e.jsx("h4",{className:"text-white font-medium mb-2",children:"MITRE ATT&CK Techniques"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:JSON.parse(y.mitre_techniques).map(s=>e.jsx("span",{className:"px-2 py-1 bg-purple-500/20 text-purple-400 text-sm rounded",children:s},s))})]})]})}),e.jsx(S,{isOpen:t,onClose:()=>l(!1),title:"Add Business Hours",children:e.jsxs("form",{onSubmit:s=>{s.preventDefault();const j=s.target,d=new FormData(j);H.mutate({name:d.get("name"),timezone:d.get("timezone"),monday_start:d.get("monday_start")||void 0,monday_end:d.get("monday_end")||void 0,tuesday_start:d.get("tuesday_start")||void 0,tuesday_end:d.get("tuesday_end")||void 0,wednesday_start:d.get("wednesday_start")||void 0,wednesday_end:d.get("wednesday_end")||void 0,thursday_start:d.get("thursday_start")||void 0,thursday_end:d.get("thursday_end")||void 0,friday_start:d.get("friday_start")||void 0,friday_end:d.get("friday_end")||void 0,is_default:d.get("is_default")==="on"})},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{name:"name",type:"text",required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Timezone *"}),e.jsxs("select",{name:"timezone",required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"America/New_York",children:"America/New_York"}),e.jsx("option",{value:"America/Los_Angeles",children:"America/Los_Angeles"}),e.jsx("option",{value:"America/Chicago",children:"America/Chicago"}),e.jsx("option",{value:"Europe/London",children:"Europe/London"}),e.jsx("option",{value:"Europe/Berlin",children:"Europe/Berlin"}),e.jsx("option",{value:"Asia/Tokyo",children:"Asia/Tokyo"}),e.jsx("option",{value:"UTC",children:"UTC"})]})]})]}),e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Business hours (24h format, e.g., 09:00)"}),["monday","tuesday","wednesday","thursday","friday"].map(s=>e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center",children:[e.jsx("span",{className:"text-gray-300 capitalize",children:s}),e.jsx("input",{name:`${s}_start`,type:"text",placeholder:"09:00",className:"px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white"}),e.jsx("input",{name:`${s}_end`,type:"text",placeholder:"17:00",className:"px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white"})]},s)),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"is_default",className:"rounded border-gray-700 bg-gray-900 text-cyan-500"}),e.jsx("span",{className:"text-gray-300",children:"Set as default"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx(u,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(u,{type:"submit",loading:H.isPending,children:"Create"})]})]})}),e.jsx(S,{isOpen:o,onClose:()=>i(!1),title:"Add Sensitive Resource",children:e.jsxs("form",{onSubmit:s=>{s.preventDefault();const j=s.target,d=new FormData(j);I.mutate({name:d.get("name"),resource_type:d.get("resource_type"),resource_pattern:d.get("resource_pattern"),sensitivity_level:d.get("sensitivity_level"),alert_on_access:d.get("alert_on_access")==="on"})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{name:"name",type:"text",required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"e.g., Customer PII Database"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Resource Type *"}),e.jsxs("select",{name:"resource_type",required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"database",children:"Database"}),e.jsx("option",{value:"file_share",children:"File Share"}),e.jsx("option",{value:"application",children:"Application"}),e.jsx("option",{value:"api",children:"API"}),e.jsx("option",{value:"bucket",children:"Cloud Bucket"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Sensitivity Level *"}),e.jsxs("select",{name:"sensitivity_level",required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"public",children:"Public"}),e.jsx("option",{value:"internal",children:"Internal"}),e.jsx("option",{value:"confidential",children:"Confidential"}),e.jsx("option",{value:"restricted",children:"Restricted"}),e.jsx("option",{value:"top_secret",children:"Top Secret"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Resource Pattern *"}),e.jsx("input",{name:"resource_pattern",type:"text",required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"e.g., prod-customer-db or /data/confidential/*"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"alert_on_access",className:"rounded border-gray-700 bg-gray-900 text-cyan-500"}),e.jsx("span",{className:"text-gray-300",children:"Alert on any access"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx(u,{variant:"secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsx(u,{type:"submit",loading:I.isPending,children:"Create"})]})]})}),e.jsx(S,{isOpen:n,onClose:()=>v(!1),title:"Add Known VPN",children:e.jsxs("form",{onSubmit:s=>{s.preventDefault();const j=s.target,d=new FormData(j),be=d.get("ip_ranges");Q.mutate({name:d.get("name"),provider:d.get("provider")||void 0,ip_ranges:be.split(`
`).map(O=>O.trim()).filter(O=>O),is_corporate:d.get("is_corporate")==="on",is_trusted:d.get("is_trusted")==="on"})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{name:"name",type:"text",required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"e.g., Corporate VPN"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Provider"}),e.jsx("input",{name:"provider",type:"text",className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"e.g., Cisco, Palo Alto"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"IP Ranges (one per line) *"}),e.jsx("textarea",{name:"ip_ranges",required:!0,rows:3,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white font-mono text-sm",placeholder:`10.0.0.0/8
192.168.1.0/24`})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"is_corporate",className:"rounded border-gray-700 bg-gray-900 text-cyan-500"}),e.jsx("span",{className:"text-gray-300",children:"Corporate VPN"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"is_trusted",className:"rounded border-gray-700 bg-gray-900 text-cyan-500"}),e.jsx("span",{className:"text-gray-300",children:"Trusted (reduce false positives)"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx(u,{variant:"secondary",onClick:()=>v(!1),children:"Cancel"}),e.jsx(u,{type:"submit",loading:Q.isPending,children:"Create"})]})]})}),e.jsx(S,{isOpen:_,onClose:()=>C(!1),title:"Add Detection Rule",children:e.jsxs("form",{onSubmit:s=>{s.preventDefault();const j=s.target,d=new FormData(j);U.mutate({name:d.get("name"),description:d.get("description")||void 0,detection_type:d.get("detection_type"),severity:d.get("severity"),enabled:d.get("enabled")==="on",conditions:{},thresholds:{},actions:["alert"],cooldown_minutes:parseInt(d.get("cooldown_minutes"))||60})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{name:"name",type:"text",required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",rows:2,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Detection Type *"}),e.jsxs("select",{name:"detection_type",required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"impossible_travel",children:"Impossible Travel"}),e.jsx("option",{value:"unusual_data_access",children:"Unusual Data Access"}),e.jsx("option",{value:"off_hours_activity",children:"Off-Hours Activity"}),e.jsx("option",{value:"service_account_abuse",children:"Service Account Abuse"}),e.jsx("option",{value:"lateral_movement",children:"Lateral Movement"}),e.jsx("option",{value:"data_exfiltration",children:"Data Exfiltration"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Severity *"}),e.jsxs("select",{name:"severity",required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Cooldown (minutes)"}),e.jsx("input",{name:"cooldown_minutes",type:"number",defaultValue:60,min:1,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"enabled",defaultChecked:!0,className:"rounded border-gray-700 bg-gray-900 text-cyan-500"}),e.jsx("span",{className:"text-gray-300",children:"Enable rule"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx(u,{variant:"secondary",onClick:()=>C(!1),children:"Cancel"}),e.jsx(u,{type:"submit",loading:U.isPending,children:"Create"})]})]})})]})};function Ie(){const[a,x]=N.useState("dashboard"),r=[{id:"dashboard",label:"Dashboard",icon:e.jsx(Ne,{className:"w-4 h-4"})},{id:"entities",label:"Entities",icon:e.jsx(D,{className:"w-4 h-4"})},{id:"anomalies",label:"Anomalies",icon:e.jsx(P,{className:"w-4 h-4"})},{id:"activities",label:"Activities",icon:e.jsx(K,{className:"w-4 h-4"})},{id:"sessions",label:"Sessions",icon:e.jsx(M,{className:"w-4 h-4"})},{id:"peer-groups",label:"Peer Groups",icon:e.jsx(D,{className:"w-4 h-4"})},{id:"advanced",label:"Advanced Detection",icon:e.jsx(L,{className:"w-4 h-4"})}];return e.jsx(Fe,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(ce,{className:"w-7 h-7 text-cyan-500"}),"User Entity Behavior Analytics"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Monitor user and entity behavior, detect anomalies, and assess risk"})]})}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:r.map(t=>e.jsxs("button",{onClick:()=>x(t.id),className:`flex items-center gap-2 px-4 py-2 -mb-px transition-colors ${a===t.id?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:[t.icon,t.label]},t.id))})}),e.jsxs("div",{children:[a==="dashboard"&&e.jsx(qe,{}),a==="entities"&&e.jsx(Ee,{}),a==="anomalies"&&e.jsx(Pe,{}),a==="activities"&&e.jsx($e,{}),a==="sessions"&&e.jsx(Le,{}),a==="peer-groups"&&e.jsx(ze,{}),a==="advanced"&&e.jsx(Ke,{})]})]})})}export{Ie as default};
