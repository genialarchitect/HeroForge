import{b as ke,u as T,d as w,j as e}from"./vendor-state-BjT_zREg.js";import{r as f,R as ee}from"./vendor-react-5KxtEOLM.js";import{B as c,m as $,O as je,e as ye,a_ as I,aN as Q,cl as Ne,K as ve,v as re,M as le,G as W,x as de,a9 as B,ba as Z,I as ie,ab as H,aY as ne,aX as we,g as _e,X as R,b1 as Ce,N as oe,F as Se}from"./vendor-ui-CaTPr3iI.js";import{L as Pe}from"./Layout-DF6EApG0.js";import{M as p,B as o}from"./index-BgPDfr41.js";import{u as Te,E as Me}from"./useRequireEngagement-BVGhnOgO.js";import"./vendor-markdown-BGP8SuZQ.js";import"./vendor-utils-DfRopTPV.js";const g={listCampaigns:()=>p.get("/phishing/campaigns"),getCampaign:s=>p.get(`/phishing/campaigns/${s}`),createCampaign:s=>p.post("/phishing/campaigns",s),updateCampaign:(s,n)=>p.put(`/phishing/campaigns/${s}`,n),getCampaignStats:s=>p.get(`/phishing/campaigns/${s}/stats`),launchCampaign:s=>p.post(`/phishing/campaigns/${s}/launch`),pauseCampaign:s=>p.post(`/phishing/campaigns/${s}/pause`),completeCampaign:s=>p.post(`/phishing/campaigns/${s}/complete`),deleteCampaign:s=>p.delete(`/phishing/campaigns/${s}`),listTemplates:()=>p.get("/phishing/templates"),getTemplate:s=>p.get(`/phishing/templates/${s}`),createTemplate:s=>p.post("/phishing/templates",s),updateTemplate:(s,n)=>p.put(`/phishing/templates/${s}`,n),deleteTemplate:s=>p.delete(`/phishing/templates/${s}`),listLandingPages:()=>p.get("/phishing/landing-pages"),getLandingPage:s=>p.get(`/phishing/landing-pages/${s}`),createLandingPage:s=>p.post("/phishing/landing-pages",s),updateLandingPage:(s,n)=>p.put(`/phishing/landing-pages/${s}`,n),deleteLandingPage:s=>p.delete(`/phishing/landing-pages/${s}`),cloneWebsite:s=>p.post("/phishing/landing-pages/clone",s),listSmtpProfiles:()=>p.get("/phishing/smtp-profiles"),getSmtpProfile:s=>p.get(`/phishing/smtp-profiles/${s}`),createSmtpProfile:s=>p.post("/phishing/smtp-profiles",s),updateSmtpProfile:(s,n)=>p.put(`/phishing/smtp-profiles/${s}`,n),deleteSmtpProfile:s=>p.delete(`/phishing/smtp-profiles/${s}`),testSmtpProfile:(s,n)=>p.post(`/phishing/smtp-profiles/${s}/test`,{to_email:n})},Fe=({status:s})=>{const n={draft:"bg-gray-500/20 text-gray-400 border-gray-500/30",scheduled:"bg-blue-500/20 text-blue-400 border-blue-500/30",running:"bg-green-500/20 text-green-400 border-green-500/30",paused:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",completed:"bg-purple-500/20 text-purple-400 border-purple-500/30",cancelled:"bg-red-500/20 text-red-400 border-red-500/30"};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded border capitalize ${n[s]||n.draft}`,children:s})},A=({label:s,value:n,icon:d,color:x,percentage:t})=>e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:s}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:n}),t!==void 0&&e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[t.toFixed(1),"%"]})]}),e.jsx("div",{className:`p-3 rounded-lg ${x}`,children:d})]})}),Le=({campaign:s,onSelect:n,onAction:d})=>{const x=s.emails_sent>0?s.emails_opened/s.emails_sent*100:0,t=s.emails_sent>0?s.links_clicked/s.emails_sent*100:0;return e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4 hover:border-primary/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:n,children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:s.name}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Created ",new Date(s.created_at).toLocaleDateString()]})]}),e.jsx(Fe,{status:s.status})]}),e.jsx("div",{className:"space-y-2 mb-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400 mb-1",children:[e.jsxs("span",{children:["Sent: ",s.emails_sent,"/",s.total_targets]}),e.jsxs("span",{children:[s.total_targets>0?(s.emails_sent/s.total_targets*100).toFixed(0):0,"%"]})]}),e.jsx("div",{className:"h-1.5 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all",style:{width:`${s.total_targets>0?s.emails_sent/s.total_targets*100:0}%`}})})]})}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center text-sm mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Opened"}),e.jsx("p",{className:"font-semibold text-green-400",children:s.emails_opened}),e.jsxs("p",{className:"text-xs text-slate-500",children:[x.toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Clicked"}),e.jsx("p",{className:"font-semibold text-yellow-400",children:s.links_clicked}),e.jsxs("p",{className:"text-xs text-slate-500",children:[t.toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Submitted"}),e.jsx("p",{className:"font-semibold text-red-400",children:s.credentials_captured})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Reported"}),e.jsx("p",{className:"font-semibold text-purple-400",children:s.reported_phish})]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.status==="draft"&&e.jsxs(o,{size:"sm",onClick:()=>d("launch"),children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"Launch"]}),s.status==="running"&&e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>d("pause"),children:[e.jsx(we,{className:"h-4 w-4 mr-1"}),"Pause"]}),s.status==="paused"&&e.jsxs(o,{size:"sm",onClick:()=>d("resume"),children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"Resume"]}),(s.status==="running"||s.status==="paused")&&e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>d("complete"),children:[e.jsx(_e,{className:"h-4 w-4 mr-1"}),"Complete"]}),e.jsx(o,{size:"sm",variant:"ghost",onClick:n,children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx(o,{size:"sm",variant:"ghost",className:"text-red-400",onClick:()=>d("delete"),children:e.jsx(H,{className:"h-4 w-4"})})]})]})},Ee=({isOpen:s,onClose:n,editId:d,onSuccess:x})=>{const[t,i]=f.useState({name:"",host:"",port:587,username:"",password:"",use_tls:!1,use_starttls:!0,from_address:"",ignore_cert_errors:!1}),[b,y]=f.useState(""),[u,h]=f.useState(!1),{data:k}=T({queryKey:["smtp-profile",d],queryFn:()=>g.getSmtpProfile(d).then(m=>m.data),enabled:!!d&&s});ee.useEffect(()=>{k?i({name:k.name,host:k.host,port:k.port,username:k.username||"",password:"",use_tls:k.use_tls||!1,use_starttls:!0,from_address:k.from_address,ignore_cert_errors:!1}):d||i({name:"",host:"",port:587,username:"",password:"",use_tls:!1,use_starttls:!0,from_address:"",ignore_cert_errors:!1})},[k,d,s]);const N=w({mutationFn:m=>g.createSmtpProfile(m),onSuccess:()=>{c.success("SMTP profile created"),x(),n()},onError:()=>c.error("Failed to create SMTP profile")}),C=w({mutationFn:m=>g.updateSmtpProfile(d,m),onSuccess:()=>{c.success("SMTP profile updated"),x(),n()},onError:()=>c.error("Failed to update SMTP profile")}),r=m=>{if(m.preventDefault(),!t.name||!t.host||!t.from_address){c.error("Please fill in all required fields");return}d?C.mutate(t):N.mutate(t)},S=async()=>{if(!d||!b){c.error("Save the profile first and enter a test email");return}h(!0);try{await g.testSmtpProfile(d,b),c.success("Test email sent successfully")}catch{c.error("Failed to send test email")}finally{h(!1)}};return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-light-border dark:border-dark-border",children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:[d?"Edit":"New"," SMTP Profile"]}),e.jsx("button",{onClick:n,className:"p-1 hover:bg-light-hover dark:hover:bg-dark-hover rounded",children:e.jsx(R,{className:"h-5 w-5 text-slate-500"})})]}),e.jsxs("form",{onSubmit:r,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Profile Name *"}),e.jsx("input",{type:"text",value:t.name,onChange:m=>i({...t,name:m.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"e.g., Corporate SMTP"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"SMTP Host *"}),e.jsx("input",{type:"text",value:t.host,onChange:m=>i({...t,host:m.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"smtp.example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Port *"}),e.jsx("input",{type:"number",value:t.port,onChange:m=>i({...t,port:parseInt(m.target.value)||587}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"From Address *"}),e.jsx("input",{type:"email",value:t.from_address,onChange:m=>i({...t,from_address:m.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"noreply@example.com"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Username"}),e.jsx("input",{type:"text",value:t.username,onChange:m=>i({...t,username:m.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Password"}),e.jsx("input",{type:"password",value:t.password,onChange:m=>i({...t,password:m.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:d?"(unchanged)":""})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.use_tls,onChange:m=>i({...t,use_tls:m.target.checked}),className:"w-4 h-4 text-primary bg-light-bg dark:bg-dark-bg border-light-border dark:border-dark-border rounded focus:ring-primary"}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Use TLS"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.use_starttls,onChange:m=>i({...t,use_starttls:m.target.checked}),className:"w-4 h-4 text-primary bg-light-bg dark:bg-dark-bg border-light-border dark:border-dark-border rounded focus:ring-primary"}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Use STARTTLS"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.ignore_cert_errors,onChange:m=>i({...t,ignore_cert_errors:m.target.checked}),className:"w-4 h-4 text-primary bg-light-bg dark:bg-dark-bg border-light-border dark:border-dark-border rounded focus:ring-primary"}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Ignore Cert Errors"})]})]}),d&&e.jsxs("div",{className:"border-t border-light-border dark:border-dark-border pt-4 mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Test Email"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"email",value:b,onChange:m=>y(m.target.value),className:"flex-1 px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"test@example.com"}),e.jsxs(o,{type:"button",variant:"outline",onClick:S,disabled:u,children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),u?"Sending...":"Test"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-light-border dark:border-dark-border",children:[e.jsx(o,{type:"button",variant:"outline",onClick:n,children:"Cancel"}),e.jsxs(o,{type:"submit",disabled:N.isPending||C.isPending,children:[d?"Update":"Create"," Profile"]})]})]})]})}):null},qe=({isOpen:s,onClose:n,editId:d,onSuccess:x})=>{const[t,i]=f.useState({name:"",subject:"",html_body:"",text_body:"",from_name:"",from_email:"",envelope_sender:""}),[b,y]=f.useState("html"),{data:u}=T({queryKey:["email-template",d],queryFn:()=>g.getTemplate(d).then(r=>r.data),enabled:!!d&&s});ee.useEffect(()=>{u?i({name:u.name,subject:u.subject,html_body:u.html_body||"",text_body:u.text_body||"",from_name:u.from_name,from_email:u.from_email,envelope_sender:""}):d||i({name:"",subject:"",html_body:"",text_body:"",from_name:"",from_email:"",envelope_sender:""})},[u,d,s]);const h=w({mutationFn:r=>g.createTemplate(r),onSuccess:()=>{c.success("Email template created"),x(),n()},onError:()=>c.error("Failed to create email template")}),k=w({mutationFn:r=>g.updateTemplate(d,r),onSuccess:()=>{c.success("Email template updated"),x(),n()},onError:()=>c.error("Failed to update email template")}),N=r=>{if(r.preventDefault(),!t.name||!t.subject||!t.html_body||!t.from_name||!t.from_email){c.error("Please fill in all required fields");return}d?k.mutate(t):h.mutate(t)},C=r=>{const S=document.getElementById("html-body");if(S){const m=S.selectionStart,E=S.selectionEnd,_=t.html_body,l=_.substring(0,m)+`{{.${r}}}`+_.substring(E);i({...t,html_body:l})}};return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-light-border dark:border-dark-border",children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:[d?"Edit":"New"," Email Template"]}),e.jsx("button",{onClick:n,className:"p-1 hover:bg-light-hover dark:hover:bg-dark-hover rounded",children:e.jsx(R,{className:"h-5 w-5 text-slate-500"})})]}),e.jsxs("form",{onSubmit:N,className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Template Name *"}),e.jsx("input",{type:"text",value:t.name,onChange:r=>i({...t,name:r.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Password Reset Template"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Subject Line *"}),e.jsx("input",{type:"text",value:t.subject,onChange:r=>i({...t,subject:r.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Action Required: Reset Your Password"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"From Name *"}),e.jsx("input",{type:"text",value:t.from_name,onChange:r=>i({...t,from_name:r.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"IT Support"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"From Email *"}),e.jsx("input",{type:"email",value:t.from_email,onChange:r=>i({...t,from_email:r.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"support@company.com"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400 self-center",children:"Insert Variable:"}),["FirstName","LastName","Email","Position","URL","TrackingURL"].map(r=>e.jsx("button",{type:"button",onClick:()=>C(r),className:"px-2 py-1 text-xs font-mono bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded text-slate-600 dark:text-slate-300 hover:bg-light-hover dark:hover:bg-dark-hover",children:`{{.${r}}}`},r))]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex gap-2 mb-2",children:[{id:"html",label:"HTML",icon:e.jsx(oe,{className:"h-4 w-4"})},{id:"text",label:"Text",icon:e.jsx(Se,{className:"h-4 w-4"})},{id:"preview",label:"Preview",icon:e.jsx(Q,{className:"h-4 w-4"})}].map(r=>e.jsxs("button",{type:"button",onClick:()=>y(r.id),className:`flex items-center gap-1 px-3 py-1.5 text-sm font-medium rounded ${b===r.id?"bg-primary text-white":"text-slate-600 dark:text-slate-400 hover:bg-light-hover dark:hover:bg-dark-hover"}`,children:[r.icon,r.label]},r.id))}),b==="html"&&e.jsx("textarea",{id:"html-body",value:t.html_body,onChange:r=>i({...t,html_body:r.target.value}),className:"w-full h-64 px-3 py-2 font-mono text-sm bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"<html><body>Your email content here...</body></html>"}),b==="text"&&e.jsx("textarea",{value:t.text_body,onChange:r=>i({...t,text_body:r.target.value}),className:"w-full h-64 px-3 py-2 font-mono text-sm bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Plain text version of your email..."}),b==="preview"&&e.jsx("div",{className:"w-full h-64 bg-white dark:bg-slate-800 border border-light-border dark:border-dark-border rounded-lg overflow-auto",children:e.jsx("iframe",{srcDoc:t.html_body,className:"w-full h-full border-0",title:"Email Preview",sandbox:"allow-same-origin"})})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-light-border dark:border-dark-border",children:[e.jsx(o,{type:"button",variant:"outline",onClick:n,children:"Cancel"}),e.jsxs(o,{type:"submit",disabled:h.isPending||k.isPending,children:[d?"Update":"Create"," Template"]})]})]})]})}):null},De=({isOpen:s,onClose:n,editId:d,onSuccess:x})=>{const[t,i]=f.useState({name:"",html_content:"",capture_credentials:!0,capture_fields:["username","password"],redirect_url:"",redirect_delay:3}),[b,y]=f.useState("html"),{data:u}=T({queryKey:["landing-page",d],queryFn:()=>g.getLandingPage(d).then(r=>r.data),enabled:!!d&&s});ee.useEffect(()=>{u?i({name:u.name,html_content:u.html_content||"",capture_credentials:u.capture_credentials,capture_fields:u.capture_fields||["username","password"],redirect_url:"",redirect_delay:3}):d||i({name:"",html_content:"",capture_credentials:!0,capture_fields:["username","password"],redirect_url:"",redirect_delay:3})},[u,d,s]);const h=w({mutationFn:r=>g.createLandingPage(r),onSuccess:()=>{c.success("Landing page created"),x(),n()},onError:()=>c.error("Failed to create landing page")}),k=w({mutationFn:r=>g.updateLandingPage(d,r),onSuccess:()=>{c.success("Landing page updated"),x(),n()},onError:()=>c.error("Failed to update landing page")}),N=r=>{if(r.preventDefault(),!t.name||!t.html_content){c.error("Please fill in all required fields");return}d?k.mutate(t):h.mutate(t)},C=r=>{const S=t.capture_fields.includes(r)?t.capture_fields.filter(m=>m!==r):[...t.capture_fields,r];i({...t,capture_fields:S})};return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-light-border dark:border-dark-border",children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:[d?"Edit":"New"," Landing Page"]}),e.jsx("button",{onClick:n,className:"p-1 hover:bg-light-hover dark:hover:bg-dark-hover rounded",children:e.jsx(R,{className:"h-5 w-5 text-slate-500"})})]}),e.jsxs("form",{onSubmit:N,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Page Name *"}),e.jsx("input",{type:"text",value:t.name,onChange:r=>i({...t,name:r.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Office 365 Login"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Redirect URL"}),e.jsx("input",{type:"url",value:t.redirect_url,onChange:r=>i({...t,redirect_url:r.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"https://real-site.com/login"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Redirect Delay (seconds)"}),e.jsx("input",{type:"number",value:t.redirect_delay,onChange:r=>i({...t,redirect_delay:parseInt(r.target.value)||3}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",min:"0",max:"30"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.capture_credentials,onChange:r=>i({...t,capture_credentials:r.target.checked}),className:"w-4 h-4 text-primary bg-light-bg dark:bg-dark-bg border-light-border dark:border-dark-border rounded focus:ring-primary"}),e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Capture Credentials"})]}),t.capture_credentials&&e.jsxs("div",{className:"ml-6 flex flex-wrap gap-3",children:[e.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Capture fields:"}),["username","password","email","otp","credit_card"].map(r=>e.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.capture_fields.includes(r),onChange:()=>C(r),className:"w-3 h-3 text-primary rounded focus:ring-primary"}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400 capitalize",children:r})]},r))]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex gap-2 mb-2",children:[{id:"html",label:"HTML Editor",icon:e.jsx(oe,{className:"h-4 w-4"})},{id:"preview",label:"Preview",icon:e.jsx(Q,{className:"h-4 w-4"})}].map(r=>e.jsxs("button",{type:"button",onClick:()=>y(r.id),className:`flex items-center gap-1 px-3 py-1.5 text-sm font-medium rounded ${b===r.id?"bg-primary text-white":"text-slate-600 dark:text-slate-400 hover:bg-light-hover dark:hover:bg-dark-hover"}`,children:[r.icon,r.label]},r.id))}),b==="html"&&e.jsx("textarea",{value:t.html_content,onChange:r=>i({...t,html_content:r.target.value}),className:"w-full h-80 px-3 py-2 font-mono text-sm bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"<html><body><form>...</form></body></html>"}),b==="preview"&&e.jsx("div",{className:"w-full h-80 bg-white dark:bg-slate-800 border border-light-border dark:border-dark-border rounded-lg overflow-auto",children:e.jsx("iframe",{srcDoc:t.html_content,className:"w-full h-full border-0",title:"Landing Page Preview",sandbox:"allow-same-origin allow-forms"})})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-light-border dark:border-dark-border",children:[e.jsx(o,{type:"button",variant:"outline",onClick:n,children:"Cancel"}),e.jsxs(o,{type:"submit",disabled:h.isPending||k.isPending,children:[d?"Update":"Create"," Landing Page"]})]})]})]})}):null},ze=({isOpen:s,onClose:n,onSuccess:d})=>{const[x,t]=f.useState({url:"",name:"",capture_credentials:!0,capture_fields:["username","password"],redirect_url:""}),[i,b]=f.useState(!1),y=h=>{const k=x.capture_fields.includes(h)?x.capture_fields.filter(N=>N!==h):[...x.capture_fields,h];t({...x,capture_fields:k})},u=async h=>{if(h.preventDefault(),!x.url||!x.name){c.error("Please enter a URL and name");return}b(!0);try{await g.cloneWebsite(x),c.success("Website cloned successfully"),d(),n()}catch{c.error("Failed to clone website")}finally{b(!1)}};return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-light-border dark:border-dark-border",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:"Clone Website"}),e.jsx("button",{onClick:n,className:"p-1 hover:bg-light-hover dark:hover:bg-dark-hover rounded",children:e.jsx(R,{className:"h-5 w-5 text-slate-500"})})]}),e.jsxs("form",{onSubmit:u,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Website URL *"}),e.jsx("input",{type:"url",value:x.url,onChange:h=>t({...x,url:h.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"https://login.example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Landing Page Name *"}),e.jsx("input",{type:"text",value:x.name,onChange:h=>t({...x,name:h.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Example Corp Login"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Redirect URL (after capture)"}),e.jsx("input",{type:"url",value:x.redirect_url,onChange:h=>t({...x,redirect_url:h.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"https://real-site.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x.capture_credentials,onChange:h=>t({...x,capture_credentials:h.target.checked}),className:"w-4 h-4 text-primary rounded focus:ring-primary"}),e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Capture Credentials"})]}),x.capture_credentials&&e.jsx("div",{className:"ml-6 flex flex-wrap gap-3",children:["username","password","email","otp"].map(h=>e.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x.capture_fields.includes(h),onChange:()=>y(h),className:"w-3 h-3 text-primary rounded focus:ring-primary"}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400 capitalize",children:h})]},h))})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-light-border dark:border-dark-border",children:[e.jsx(o,{type:"button",variant:"outline",onClick:n,children:"Cancel"}),e.jsxs(o,{type:"submit",disabled:i,children:[e.jsx(W,{className:"h-4 w-4 mr-1"}),i?"Cloning...":"Clone Website"]})]})]})]})}):null},Ke=({isOpen:s,onClose:n,editId:d,onSuccess:x})=>{const[t,i]=f.useState({name:"",description:"",email_template_id:"",landing_page_id:"",smtp_profile_id:"",tracking_domain:"",awareness_training:!1,training_url:"",targets:[]}),[b,y]=f.useState(""),[u,h]=f.useState(!1),{data:k}=T({queryKey:["phishing-templates"],queryFn:()=>g.listTemplates().then(l=>l.data),enabled:s}),{data:N}=T({queryKey:["phishing-landing-pages"],queryFn:()=>g.listLandingPages().then(l=>l.data),enabled:s}),{data:C}=T({queryKey:["phishing-smtp-profiles"],queryFn:()=>g.listSmtpProfiles().then(l=>l.data),enabled:s}),r=w({mutationFn:l=>g.createCampaign(l),onSuccess:()=>{c.success("Campaign created"),x(),n()},onError:()=>c.error("Failed to create campaign")}),S=l=>{if(l.preventDefault(),!t.name||!t.email_template_id||!t.smtp_profile_id){c.error("Please fill in all required fields");return}if(t.targets.length===0){c.error("Please add at least one target");return}r.mutate(t)},m=()=>{if(!b.trim())return;const l=b.split(",").map(M=>M.trim()),j={email:l[0],first_name:l[1]||void 0,last_name:l[2]||void 0,position:l[3]||void 0,department:l[4]||void 0};j.email&&j.email.includes("@")?(i({...t,targets:[...t.targets,j]}),y("")):c.error("Invalid email address")},E=()=>{const l=b.split(`
`).filter(M=>M.trim()),j=[];for(const M of l){const P=M.split(",").map(U=>U.trim());P[0]&&P[0].includes("@")&&j.push({email:P[0],first_name:P[1]||void 0,last_name:P[2]||void 0,position:P[3]||void 0,department:P[4]||void 0})}j.length>0&&(i({...t,targets:[...t.targets,...j]}),y(""),c.success(`Added ${j.length} targets`))},_=l=>{i({...t,targets:t.targets.filter((j,M)=>M!==l)})};return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-light-border dark:border-dark-border",children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:[d?"Edit":"New"," Campaign"]}),e.jsx("button",{onClick:n,className:"p-1 hover:bg-light-hover dark:hover:bg-dark-hover rounded",children:e.jsx(R,{className:"h-5 w-5 text-slate-500"})})]}),e.jsxs("form",{onSubmit:S,className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Campaign Name *"}),e.jsx("input",{type:"text",value:t.name,onChange:l=>i({...t,name:l.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Q1 Security Awareness"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:t.description,onChange:l=>i({...t,description:l.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Monthly phishing simulation"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Email Template *"}),e.jsxs("select",{value:t.email_template_id,onChange:l=>i({...t,email_template_id:l.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Select template..."}),k==null?void 0:k.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Landing Page"}),e.jsxs("select",{value:t.landing_page_id,onChange:l=>i({...t,landing_page_id:l.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"None (tracking only)"}),N==null?void 0:N.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"SMTP Profile *"}),e.jsxs("select",{value:t.smtp_profile_id,onChange:l=>i({...t,smtp_profile_id:l.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Select SMTP profile..."}),C==null?void 0:C.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.awareness_training,onChange:l=>i({...t,awareness_training:l.target.checked}),className:"w-4 h-4 text-primary rounded focus:ring-primary"}),e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Enable Awareness Training"})]}),t.awareness_training&&e.jsx("div",{className:"ml-6",children:e.jsx("input",{type:"url",value:t.training_url,onChange:l=>i({...t,training_url:l.target.value}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"https://training.example.com/phishing-awareness"})})]}),e.jsxs("div",{className:"border-t border-light-border dark:border-dark-border pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:["Targets (",t.targets.length,")"]}),e.jsx("button",{type:"button",onClick:()=>h(!u),className:"text-sm text-primary hover:underline",children:u?"Single Entry":"Bulk Import"})]}),u?e.jsxs("div",{className:"space-y-2",children:[e.jsx("textarea",{value:b,onChange:l=>y(l.target.value),className:"w-full h-32 px-3 py-2 font-mono text-sm bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:`email,first_name,last_name,position,department
john@example.com,John,Doe,Engineer,IT
jane@example.com,Jane,Smith,Manager,HR`}),e.jsxs(o,{type:"button",size:"sm",onClick:E,children:[e.jsx(Ce,{className:"h-4 w-4 mr-1"}),"Import Targets"]})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:b,onChange:l=>y(l.target.value),onKeyDown:l=>l.key==="Enter"&&(l.preventDefault(),m()),className:"flex-1 px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"email@example.com,First,Last,Position,Department"}),e.jsx(o,{type:"button",size:"sm",onClick:m,children:e.jsx($,{className:"h-4 w-4"})})]}),t.targets.length>0&&e.jsx("div",{className:"mt-3 max-h-40 overflow-y-auto border border-light-border dark:border-dark-border rounded-lg",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-light-bg dark:bg-dark-bg sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-2 py-1 text-slate-500",children:"Email"}),e.jsx("th",{className:"text-left px-2 py-1 text-slate-500",children:"Name"}),e.jsx("th",{className:"text-left px-2 py-1 text-slate-500",children:"Position"}),e.jsx("th",{className:"w-8"})]})}),e.jsx("tbody",{children:t.targets.map((l,j)=>e.jsxs("tr",{className:"border-t border-light-border dark:border-dark-border",children:[e.jsx("td",{className:"px-2 py-1 text-slate-900 dark:text-white",children:l.email}),e.jsx("td",{className:"px-2 py-1 text-slate-600 dark:text-slate-300",children:[l.first_name,l.last_name].filter(Boolean).join(" ")||"-"}),e.jsx("td",{className:"px-2 py-1 text-slate-600 dark:text-slate-300",children:l.position||"-"}),e.jsx("td",{className:"px-2 py-1",children:e.jsx("button",{type:"button",onClick:()=>_(j),className:"text-red-400 hover:text-red-500",children:e.jsx(R,{className:"h-4 w-4"})})})]},j))})]})})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-light-border dark:border-dark-border",children:[e.jsx(o,{type:"button",variant:"outline",onClick:n,children:"Cancel"}),e.jsxs(o,{type:"submit",disabled:r.isPending,children:[d?"Update":"Create"," Campaign"]})]})]})]})}):null},Ge=()=>{const s=ke(),{hasEngagement:n}=Te(),[d,x]=f.useState("campaigns"),[t,i]=f.useState(null),[b,y]=f.useState(!1),[u,h]=f.useState(!1),[k,N]=f.useState(!1),[C,r]=f.useState(!1),[S,m]=f.useState(!1),[E,_]=f.useState(),[l,j]=f.useState(null),[M,P]=f.useState(null),[U,Y]=f.useState(null),{data:L,isLoading:ce}=T({queryKey:["phishing-campaigns"],queryFn:()=>g.listCampaigns().then(a=>a.data)}),{data:q,isLoading:me}=T({queryKey:["phishing-templates"],queryFn:()=>g.listTemplates().then(a=>a.data),enabled:d==="templates"}),{data:D,isLoading:xe}=T({queryKey:["phishing-landing-pages"],queryFn:()=>g.listLandingPages().then(a=>a.data),enabled:d==="pages"}),{data:z,isLoading:he}=T({queryKey:["phishing-smtp-profiles"],queryFn:()=>g.listSmtpProfiles().then(a=>a.data),enabled:d==="smtp"}),{data:$e}=T({queryKey:["phishing-campaign-stats",t],queryFn:()=>g.getCampaignStats(t).then(a=>a.data),enabled:!!t}),te=w({mutationFn:a=>g.launchCampaign(a),onSuccess:()=>{c.success("Campaign launched successfully"),s.invalidateQueries({queryKey:["phishing-campaigns"]})},onError:()=>c.error("Failed to launch campaign")}),ge=w({mutationFn:a=>g.pauseCampaign(a),onSuccess:()=>{c.success("Campaign paused"),s.invalidateQueries({queryKey:["phishing-campaigns"]})}}),ue=w({mutationFn:a=>g.completeCampaign(a),onSuccess:()=>{c.success("Campaign completed"),s.invalidateQueries({queryKey:["phishing-campaigns"]})}}),pe=w({mutationFn:a=>g.deleteCampaign(a),onSuccess:()=>{c.success("Campaign deleted"),s.invalidateQueries({queryKey:["phishing-campaigns"]})}}),G=w({mutationFn:a=>g.deleteTemplate(a),onSuccess:()=>{c.success("Template deleted"),s.invalidateQueries({queryKey:["phishing-templates"]}),j(null)},onError:()=>c.error("Failed to delete template")}),J=w({mutationFn:a=>g.deleteLandingPage(a),onSuccess:()=>{c.success("Landing page deleted"),s.invalidateQueries({queryKey:["phishing-landing-pages"]}),P(null)},onError:()=>c.error("Failed to delete landing page")}),V=w({mutationFn:a=>g.deleteSmtpProfile(a),onSuccess:()=>{c.success("SMTP profile deleted"),s.invalidateQueries({queryKey:["phishing-smtp-profiles"]}),Y(null)},onError:()=>c.error("Failed to delete SMTP profile")}),se=a=>{_(a),y(!0)},ae=a=>{_(a),h(!0)},X=a=>{_(a),N(!0)},O=a=>{_(a),m(!0)},be=async a=>{try{const K=(await g.getTemplate(a)).data;await g.createTemplate({name:`${K.name} (Copy)`,subject:K.subject,html_body:K.html_body||"",text_body:K.text_body,from_name:K.from_name,from_email:K.from_email}),c.success("Template copied successfully"),s.invalidateQueries({queryKey:["phishing-templates"]})}catch{c.error("Failed to copy template")}},fe=(a,F)=>{switch(F){case"launch":te.mutate(a.id);break;case"pause":ge.mutate(a.id);break;case"resume":te.mutate(a.id);break;case"complete":ue.mutate(a.id);break;case"delete":confirm("Are you sure you want to delete this campaign?")&&pe.mutate(a.id);break}},v=L==null?void 0:L.reduce((a,F)=>({targets:a.targets+F.total_targets,sent:a.sent+F.emails_sent,opened:a.opened+F.emails_opened,clicked:a.clicked+F.links_clicked,credentials:a.credentials+F.credentials_captured}),{targets:0,sent:0,opened:0,clicked:0,credentials:0});return e.jsx(Pe,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Phishing Campaign Manager"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Create and manage security awareness phishing simulations"})]}),e.jsxs(o,{disabled:!n,onClick:()=>se(),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"New Campaign"]})]}),e.jsx(Me,{toolName:"Phishing Campaign Manager"}),e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(je,{className:"h-5 w-5 text-yellow-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-400",children:"Authorization Required"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Phishing simulations must be conducted with proper authorization. Only use for security awareness training or authorized penetration testing engagements."})]})]}),v&&e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsx(A,{label:"Total Targets",value:v.targets,icon:e.jsx(ye,{className:"h-5 w-5 text-blue-400"}),color:"bg-blue-500/10"}),e.jsx(A,{label:"Emails Sent",value:v.sent,icon:e.jsx(I,{className:"h-5 w-5 text-green-400"}),color:"bg-green-500/10"}),e.jsx(A,{label:"Emails Opened",value:v.opened,icon:e.jsx(Q,{className:"h-5 w-5 text-cyan-400"}),color:"bg-cyan-500/10",percentage:v.sent>0?v.opened/v.sent*100:0}),e.jsx(A,{label:"Links Clicked",value:v.clicked,icon:e.jsx(Ne,{className:"h-5 w-5 text-yellow-400"}),color:"bg-yellow-500/10",percentage:v.sent>0?v.clicked/v.sent*100:0}),e.jsx(A,{label:"Credentials Captured",value:v.credentials,icon:e.jsx(ve,{className:"h-5 w-5 text-red-400"}),color:"bg-red-500/10",percentage:v.sent>0?v.credentials/v.sent*100:0})]}),e.jsx("div",{className:"flex gap-2 border-b border-light-border dark:border-dark-border pb-2",children:[{id:"campaigns",label:"Campaigns",icon:e.jsx(re,{className:"h-4 w-4"})},{id:"templates",label:"Email Templates",icon:e.jsx(le,{className:"h-4 w-4"})},{id:"pages",label:"Landing Pages",icon:e.jsx(W,{className:"h-4 w-4"})},{id:"smtp",label:"SMTP Profiles",icon:e.jsx(de,{className:"h-4 w-4"})}].map(a=>e.jsxs("button",{onClick:()=>x(a.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${d===a.id?"bg-primary text-white":"text-slate-600 dark:text-slate-400 hover:bg-light-hover dark:hover:bg-dark-hover"}`,children:[a.icon,a.label]},a.id))}),d==="campaigns"&&e.jsx("div",{className:"space-y-4",children:ce?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(B,{className:"h-8 w-8 animate-spin text-primary"})}):(L==null?void 0:L.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(re,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No campaigns yet"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Create your first phishing campaign to get started"}),e.jsxs(o,{onClick:()=>se(),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Create Campaign"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:L==null?void 0:L.map(a=>e.jsx(Le,{campaign:a,onSelect:()=>i(a.id),onAction:F=>fe(a,F)},a.id))})}),d==="templates"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(o,{onClick:()=>ae(),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"New Template"]})}),me?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(B,{className:"h-8 w-8 animate-spin text-primary"})}):(q==null?void 0:q.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(le,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No email templates"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Create email templates to use in your campaigns"})]}):e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-light-bg dark:bg-dark-bg",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Name"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Subject"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"From"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Created"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-light-border dark:divide-dark-border",children:q==null?void 0:q.map(a=>e.jsxs("tr",{className:"hover:bg-light-hover dark:hover:bg-dark-hover",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-900 dark:text-white font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.name,a.is_system&&e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded bg-cyan-500/20 text-cyan-400 border border-cyan-500/30",children:"System"})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:a.subject}),e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:[a.from_name," <",a.from_email,">"]}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-500 dark:text-slate-400",children:new Date(a.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[!a.is_system&&e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>ae(a.id),title:"Edit",children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>be(a.id),title:"Copy to create your own",children:a.is_system?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"text-xs",children:"Use"})]}):e.jsx(ie,{className:"h-4 w-4"})}),!a.is_system&&e.jsx(o,{size:"sm",variant:"ghost",className:"text-red-400",onClick:()=>j(a.id),title:"Delete",children:e.jsx(H,{className:"h-4 w-4"})})]})})]},a.id))})]})})]}),d==="pages"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(o,{variant:"outline",onClick:()=>r(!0),children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Clone Website"]}),e.jsxs(o,{onClick:()=>X(),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"New Landing Page"]})]}),xe?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(B,{className:"h-8 w-8 animate-spin text-primary"})}):(D==null?void 0:D.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(W,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No landing pages"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Create landing pages for credential harvesting"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:D==null?void 0:D.map(a=>e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900 dark:text-white",children:a.name}),a.cloned_from&&e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Cloned from: ",a.cloned_from]})]}),a.capture_credentials&&e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded bg-red-500/20 text-red-400 border border-red-500/30",children:"Credential Capture"})]}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:["Created ",new Date(a.created_at).toLocaleDateString()]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>X(a.id),children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>X(a.id),children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsx(o,{size:"sm",variant:"ghost",className:"text-red-400",onClick:()=>P(a.id),children:e.jsx(H,{className:"h-4 w-4"})})]})]},a.id))})]}),d==="smtp"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(o,{onClick:()=>O(),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"New SMTP Profile"]})}),he?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(B,{className:"h-8 w-8 animate-spin text-primary"})}):(z==null?void 0:z.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(de,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No SMTP profiles"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Configure SMTP servers for sending phishing emails"})]}):e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-light-bg dark:bg-dark-bg",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Name"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Host"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Port"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"From Address"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-light-border dark:divide-dark-border",children:z==null?void 0:z.map(a=>e.jsxs("tr",{className:"hover:bg-light-hover dark:hover:bg-dark-hover",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-900 dark:text-white font-medium",children:a.name}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:a.host}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:a.port}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:a.from_address}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>O(a.id),children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),"Test"]}),e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>O(a.id),children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsx(o,{size:"sm",variant:"ghost",className:"text-red-400",onClick:()=>Y(a.id),children:e.jsx(H,{className:"h-4 w-4"})})]})})]},a.id))})]})})]}),e.jsx(Ke,{isOpen:b,onClose:()=>{y(!1),_(void 0)},editId:E,onSuccess:()=>s.invalidateQueries({queryKey:["phishing-campaigns"]})}),e.jsx(qe,{isOpen:u,onClose:()=>{h(!1),_(void 0)},editId:E,onSuccess:()=>s.invalidateQueries({queryKey:["phishing-templates"]})}),e.jsx(De,{isOpen:k,onClose:()=>{N(!1),_(void 0)},editId:E,onSuccess:()=>s.invalidateQueries({queryKey:["phishing-landing-pages"]})}),e.jsx(ze,{isOpen:C,onClose:()=>r(!1),onSuccess:()=>s.invalidateQueries({queryKey:["phishing-landing-pages"]})}),e.jsx(Ee,{isOpen:S,onClose:()=>{m(!1),_(void 0)},editId:E,onSuccess:()=>s.invalidateQueries({queryKey:["phishing-smtp-profiles"]})}),l&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-6 max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-2",children:"Delete Template"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-4",children:"Are you sure you want to delete this email template? This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{variant:"outline",onClick:()=>j(null),children:"Cancel"}),e.jsx(o,{className:"bg-red-600 hover:bg-red-700",onClick:()=>G.mutate(l),disabled:G.isPending,children:G.isPending?"Deleting...":"Delete"})]})]})}),M&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-6 max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-2",children:"Delete Landing Page"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-4",children:"Are you sure you want to delete this landing page? This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{variant:"outline",onClick:()=>P(null),children:"Cancel"}),e.jsx(o,{className:"bg-red-600 hover:bg-red-700",onClick:()=>J.mutate(M),disabled:J.isPending,children:J.isPending?"Deleting...":"Delete"})]})]})}),U&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-6 max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-2",children:"Delete SMTP Profile"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-4",children:"Are you sure you want to delete this SMTP profile? This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{variant:"outline",onClick:()=>Y(null),children:"Cancel"}),e.jsx(o,{className:"bg-red-600 hover:bg-red-700",onClick:()=>V.mutate(U),disabled:V.isPending,children:V.isPending?"Deleting...":"Delete"})]})]})})]})})};export{Ge as default};
