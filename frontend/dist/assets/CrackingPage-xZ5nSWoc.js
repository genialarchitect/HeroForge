import{b as z,u as S,d as q,j as e}from"./vendor-state-DdX3IZQk.js";import{r as i}from"./vendor-react-Da1CiaFS.js";import{K as F,aR as W,P as I,bj as O,F as B,aH as E,c0 as A,L as J,ae as G,bo as P,aQ as Z,j as V,B as l,aD as X,aG as D,at as Y,Z as ee,aN as se,aB as te}from"./vendor-ui-DU7fCopR.js";import{d as ae,a9 as x}from"./index-CtaBzPa9.js";import"./vendor-charts-BthoN68t.js";const Q=[{mode:1e3,name:"NTLM",example:"32 hex characters"},{mode:0,name:"MD5",example:"32 hex characters"},{mode:100,name:"SHA-1",example:"40 hex characters"},{mode:1400,name:"SHA-256",example:"64 hex characters"},{mode:3200,name:"bcrypt",example:"$2a$..."},{mode:13100,name:"Kerberos 5 TGS",example:"$krb5tgs$..."},{mode:18200,name:"Kerberos 5 AS-REP",example:"$krb5asrep$..."},{mode:5600,name:"NetNTLMv2",example:"user::domain:..."},{mode:3e3,name:"LM",example:"16 hex characters"},{mode:1800,name:"sha512crypt",example:"$6$..."}];function xe(){const c=z(),[f,o]=i.useState(!1),[u,v]=i.useState(null),[w,a]=i.useState(!1),{data:k=[],isLoading:b,refetch:h}=S({queryKey:["cracking-jobs"],queryFn:async()=>(await x.listJobs()).data,refetchInterval:5e3}),{data:r}=S({queryKey:["cracking-stats"],queryFn:async()=>(await x.getStats()).data}),{data:j=[]}=S({queryKey:["cracking-wordlists"],queryFn:async()=>(await x.listWordlists()).data}),{data:p=[]}=S({queryKey:["cracking-rules"],queryFn:async()=>(await x.listRules()).data}),{data:M=[]}=S({queryKey:["cracking-hash-types"],queryFn:async()=>(await x.listHashTypes()).data}),g=q({mutationFn:s=>x.createJob(s),onSuccess:()=>{c.invalidateQueries({queryKey:["cracking-jobs"]}),c.invalidateQueries({queryKey:["cracking-stats"]}),l.success("Cracking job created"),o(!1)},onError:s=>{l.error(`Failed to create job: ${s.message}`)}}),R=q({mutationFn:s=>x.startJob(s),onSuccess:()=>{c.invalidateQueries({queryKey:["cracking-jobs"]}),l.success("Job started")},onError:s=>{l.error(`Failed to start job: ${s.message}`)}}),N=q({mutationFn:s=>x.stopJob(s),onSuccess:()=>{c.invalidateQueries({queryKey:["cracking-jobs"]}),l.success("Job stopped")},onError:s=>{l.error(`Failed to stop job: ${s.message}`)}}),L=q({mutationFn:s=>x.deleteJob(s),onSuccess:()=>{c.invalidateQueries({queryKey:["cracking-jobs"]}),c.invalidateQueries({queryKey:["cracking-stats"]}),l.success("Job deleted")},onError:s=>{l.error(`Failed to delete job: ${s.message}`)}}),T=s=>{switch(s){case"pending":return e.jsx(Y,{className:"w-4 h-4 text-gray-400"});case"running":return e.jsx(J,{className:"w-4 h-4 text-cyan-400 animate-spin"});case"completed":return e.jsx(E,{className:"w-4 h-4 text-green-400"});case"failed":return e.jsx(D,{className:"w-4 h-4 text-red-400"});case"stopped":return e.jsx(P,{className:"w-4 h-4 text-yellow-400"});default:return e.jsx(X,{className:"w-4 h-4 text-gray-400"})}},H=s=>{switch(s){case"pending":return"bg-gray-500/20 text-gray-300";case"running":return"bg-cyan-500/20 text-cyan-300";case"completed":return"bg-green-500/20 text-green-300";case"failed":return"bg-red-500/20 text-red-300";case"stopped":return"bg-yellow-500/20 text-yellow-300";default:return"bg-gray-500/20 text-gray-300"}},_=s=>{if(!s)return"N/A";const d=["B","KB","MB","GB"];let C=0,$=s;for(;$>=1024&&C<d.length-1;)$/=1024,C++;return`${$.toFixed(1)} ${d[C]}`};return e.jsx(ae,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(F,{className:"w-8 h-8 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Password Cracking"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Crack password hashes using Hashcat or John the Ripper"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>h(),className:"p-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",title:"Refresh",children:e.jsx(W,{className:"w-5 h-5 text-gray-300"})}),e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center space-x-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-500 rounded-lg transition-colors",children:[e.jsx(I,{className:"w-5 h-5"}),e.jsx("span",{children:"New Job"})]})]})]}),r&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Total Jobs"}),e.jsx(O,{className:"w-5 h-5 text-gray-500"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:r.total_jobs}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[r.running_jobs," running"]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Total Hashes"}),e.jsx(B,{className:"w-5 h-5 text-gray-500"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:r.total_hashes.toLocaleString()})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Cracked"}),e.jsx(E,{className:"w-5 h-5 text-green-500"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-400 mt-2",children:r.total_cracked.toLocaleString()}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[r.success_rate.toFixed(1),"% success rate"]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Resources"}),e.jsx(A,{className:"w-5 h-5 text-gray-500"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:r.total_wordlists}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[r.total_rules," rule files"]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Cracking Jobs"})}),e.jsx("div",{className:"overflow-x-auto",children:b?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx(J,{className:"w-6 h-6 text-cyan-400 animate-spin"})}):k.length===0?e.jsxs("div",{className:"text-center p-8 text-gray-400",children:[e.jsx(F,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No cracking jobs yet"}),e.jsx("p",{className:"text-sm mt-1",children:"Create a new job to start cracking hashes"})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-400 text-sm border-b border-gray-700",children:[e.jsx("th",{className:"px-4 py-3",children:"Name"}),e.jsx("th",{className:"px-4 py-3",children:"Hash Type"}),e.jsx("th",{className:"px-4 py-3",children:"Cracker"}),e.jsx("th",{className:"px-4 py-3",children:"Status"}),e.jsx("th",{className:"px-4 py-3",children:"Progress"}),e.jsx("th",{className:"px-4 py-3",children:"Created"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{children:k.map(s=>e.jsxs("tr",{className:"border-b border-gray-700/50 hover:bg-gray-700/30 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.hashes_count," hashes"]})]})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("span",{className:"text-gray-300",children:s.hash_type_name}),e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",s.hash_type,")"]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.cracker_type==="hashcat"?"bg-purple-500/20 text-purple-300":"bg-orange-500/20 text-orange-300"}`,children:s.cracker_type})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`inline-flex items-center space-x-1 px-2 py-1 text-xs rounded-full ${H(s.status)}`,children:[T(s.status),e.jsx("span",{className:"ml-1 capitalize",children:s.status})]})}),e.jsx("td",{className:"px-4 py-3",children:s.status==="running"&&s.progress?e.jsxs("div",{className:"w-32",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsxs("span",{className:"text-gray-400",children:[s.progress.cracked,"/",s.progress.total_hashes]}),e.jsx("span",{className:"text-cyan-400",children:s.progress.speed})]}),e.jsx("div",{className:"h-1.5 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-cyan-500 transition-all",style:{width:`${s.progress.progress_percent||0}%`}})})]}):s.status==="completed"?e.jsxs("span",{className:"text-green-400",children:[s.cracked_count," cracked"]}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(s.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[s.status==="pending"&&e.jsx("button",{onClick:()=>R.mutate(s.id),className:"p-1.5 text-green-400 hover:bg-green-500/20 rounded transition-colors",title:"Start job",children:e.jsx(G,{className:"w-4 h-4"})}),s.status==="running"&&e.jsx("button",{onClick:()=>N.mutate(s.id),className:"p-1.5 text-yellow-400 hover:bg-yellow-500/20 rounded transition-colors",title:"Stop job",children:e.jsx(P,{className:"w-4 h-4"})}),(s.status==="completed"||s.cracked_count>0)&&e.jsx("button",{onClick:()=>{v(s),a(!0)},className:"p-1.5 text-cyan-400 hover:bg-cyan-500/20 rounded transition-colors",title:"View results",children:e.jsx(B,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{confirm("Delete this job?")&&L.mutate(s.id)},className:"p-1.5 text-red-400 hover:bg-red-500/20 rounded transition-colors",title:"Delete job",children:e.jsx(Z,{className:"w-4 h-4"})})]})})]},s.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center",children:[e.jsx(A,{className:"w-5 h-5 mr-2 text-cyan-400"}),"Wordlists"]}),e.jsxs("span",{className:"text-sm text-gray-400",children:[j.length," available"]})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:j.length===0?e.jsx("div",{className:"p-4 text-center text-gray-400 text-sm",children:"No wordlists available"}):e.jsx("div",{className:"divide-y divide-gray-700/50",children:j.map(s=>{var d;return e.jsx("div",{className:"p-3 hover:bg-gray-700/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm font-medium",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[((d=s.line_count)==null?void 0:d.toLocaleString())||"?"," words"," â€¢ ",_(s.size_bytes)]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.is_builtin&&e.jsx("span",{className:"text-xs text-gray-500 bg-gray-700 px-2 py-0.5 rounded",children:"Built-in"}),s.category&&e.jsx("span",{className:"text-xs text-cyan-400 bg-cyan-500/20 px-2 py-0.5 rounded",children:s.category})]})]})},s.id)})})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center",children:[e.jsx(V,{className:"w-5 h-5 mr-2 text-cyan-400"}),"Rule Files"]}),e.jsxs("span",{className:"text-sm text-gray-400",children:[p.length," available"]})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:p.length===0?e.jsx("div",{className:"p-4 text-center text-gray-400 text-sm",children:"No rule files available"}):e.jsx("div",{className:"divide-y divide-gray-700/50",children:p.map(s=>{var d;return e.jsx("div",{className:"p-3 hover:bg-gray-700/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm font-medium",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[((d=s.rule_count)==null?void 0:d.toLocaleString())||"?"," rules"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${s.cracker_type==="hashcat"?"text-purple-300 bg-purple-500/20":"text-orange-300 bg-orange-500/20"}`,children:s.cracker_type}),s.is_builtin&&e.jsx("span",{className:"text-xs text-gray-500 bg-gray-700 px-2 py-0.5 rounded",children:"Built-in"})]})]})},s.id)})})})]})]}),f&&e.jsx(re,{hashTypes:M,wordlists:j,rules:p,onClose:()=>o(!1),onSubmit:s=>g.mutate(s),isSubmitting:g.isPending}),w&&u&&e.jsx(ne,{job:u,onClose:()=>{a(!1),v(null)}})]})})}function re({hashTypes:c,wordlists:f,rules:o,onClose:u,onSubmit:v,isSubmitting:w}){const[a,k]=i.useState(""),[b,h]=i.useState(1e3),[r,j]=i.useState("hashcat"),[p,M]=i.useState(""),[g,R]=i.useState([]),[N,L]=i.useState([]),[T,H]=i.useState(!1),[_,s]=i.useState(null),[d,C]=i.useState(!1),$=async()=>{const t=p.split(`
`).filter(n=>n.trim());if(t.length===0){l.error("Enter at least one hash to detect type");return}C(!0);try{const n=await x.detectHashType({hashes:t.slice(0,5)});s(n.data),n.data.hash_type?(h(n.data.hash_type),l.success(`Detected: ${n.data.hash_type_name}`)):l.warning("Could not auto-detect hash type")}catch{l.error("Failed to detect hash type")}finally{C(!1)}},U=t=>{t.preventDefault();const n=p.split(`
`).map(m=>m.trim()).filter(m=>m).map(m=>{const y=m.split(":");return y.length>=2?{hash:y[y.length-1],username:y[0]}:{hash:m}});if(n.length===0){l.error("Enter at least one hash");return}v({name:a||`Cracking Job ${new Date().toLocaleDateString()}`,hash_type:b,cracker_type:r,hashes:n,wordlist_ids:g.length>0?g:void 0,rule_ids:N.length>0?N:void 0,auto_start:T})},K=o.filter(t=>t.cracker_type===r);return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 w-full max-w-2xl max-h-[90vh] overflow-y-auto m-4",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center",children:[e.jsx(F,{className:"w-5 h-5 mr-2 text-cyan-400"}),"Create Cracking Job"]}),e.jsx("button",{onClick:u,className:"text-gray-400 hover:text-white",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:U,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Job Name"}),e.jsx("input",{type:"text",value:a,onChange:t=>k(t.target.value),placeholder:"My Cracking Job",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-500 focus:border-cyan-500 focus:ring-1 focus:ring-cyan-500 outline-none"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Hashes (one per line)"}),e.jsxs("button",{type:"button",onClick:$,disabled:d,className:"text-xs text-cyan-400 hover:text-cyan-300 flex items-center space-x-1",children:[d?e.jsx(J,{className:"w-3 h-3 animate-spin"}):e.jsx(ee,{className:"w-3 h-3"}),e.jsx("span",{children:"Auto-detect type"})]})]}),e.jsx("textarea",{value:p,onChange:t=>M(t.target.value),placeholder:`user:hash
hash
username:hash`,rows:6,className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-500 focus:border-cyan-500 focus:ring-1 focus:ring-cyan-500 outline-none font-mono text-sm"}),_&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Detected: ",e.jsx("span",{className:"text-cyan-400",children:_.hash_type_name||"Unknown"})," ","(",_.confidence," confidence)"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Hash Type"}),e.jsxs("select",{value:b,onChange:t=>h(Number(t.target.value)),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-cyan-500 focus:ring-1 focus:ring-cyan-500 outline-none",children:[Q.map(t=>e.jsxs("option",{value:t.mode,children:[t.name," (",t.mode,")"]},t.mode)),c.filter(t=>!Q.some(n=>n.mode===t.mode)).map(t=>e.jsxs("option",{value:t.mode,children:[t.name," (",t.mode,")"]},t.mode))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Cracker"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>j("hashcat"),className:`flex-1 py-2 px-3 rounded-lg border text-sm transition-colors ${r==="hashcat"?"bg-purple-600 border-purple-500 text-white":"bg-gray-700 border-gray-600 text-gray-300 hover:bg-gray-600"}`,children:"Hashcat"}),e.jsx("button",{type:"button",onClick:()=>j("john"),className:`flex-1 py-2 px-3 rounded-lg border text-sm transition-colors ${r==="john"?"bg-orange-600 border-orange-500 text-white":"bg-gray-700 border-gray-600 text-gray-300 hover:bg-gray-600"}`,children:"John"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Wordlists"}),e.jsxs("div",{className:"max-h-32 overflow-y-auto bg-gray-700 border border-gray-600 rounded-lg p-2 space-y-1",children:[f.map(t=>{var n;return e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer p-1 hover:bg-gray-600 rounded",children:[e.jsx("input",{type:"checkbox",checked:g.includes(t.id),onChange:m=>{m.target.checked?R([...g,t.id]):R(g.filter(y=>y!==t.id))},className:"rounded border-gray-500 bg-gray-600 text-cyan-500 focus:ring-cyan-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:t.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",((n=t.line_count)==null?void 0:n.toLocaleString())||"?"," words)"]})]},t.id)}),f.length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:"No wordlists available"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-400 mb-1",children:["Rules (",r,")"]}),e.jsxs("div",{className:"max-h-24 overflow-y-auto bg-gray-700 border border-gray-600 rounded-lg p-2 space-y-1",children:[K.map(t=>{var n;return e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer p-1 hover:bg-gray-600 rounded",children:[e.jsx("input",{type:"checkbox",checked:N.includes(t.id),onChange:m=>{m.target.checked?L([...N,t.id]):L(N.filter(y=>y!==t.id))},className:"rounded border-gray-500 bg-gray-600 text-cyan-500 focus:ring-cyan-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:t.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",((n=t.rule_count)==null?void 0:n.toLocaleString())||"?"," rules)"]})]},t.id)}),K.length===0&&e.jsxs("p",{className:"text-sm text-gray-500 text-center py-2",children:["No rules for ",r]})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:T,onChange:t=>H(t.target.checked),className:"rounded border-gray-500 bg-gray-600 text-cyan-500 focus:ring-cyan-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Start job immediately after creation"})]})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:u,className:"px-4 py-2 text-gray-300 hover:text-white transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:w,className:"flex items-center space-x-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-500 rounded-lg transition-colors disabled:opacity-50",children:[w?e.jsx(J,{className:"w-4 h-4 animate-spin"}):e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{children:"Create Job"})]})]})]})]})})}function ne({job:c,onClose:f}){const{data:o=[],isLoading:u}=S({queryKey:["cracking-results",c.id],queryFn:async()=>(await x.getJobResults(c.id)).data}),v=a=>{navigator.clipboard.writeText(a),l.success("Copied to clipboard")},w=()=>{const a=o.map(r=>`${r.username||""}:${r.plaintext}`).join(`
`),k=new Blob([a],{type:"text/plain"}),b=URL.createObjectURL(k),h=document.createElement("a");h.href=b,h.download=`${c.name.replace(/\s+/g,"_")}_cracked.txt`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(b),l.success("Exported cracked credentials")};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 w-full max-w-3xl max-h-[80vh] overflow-hidden m-4 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-white",children:[c.name," - Results"]}),e.jsxs("p",{className:"text-sm text-gray-400",children:[o.length," cracked out of ",c.hashes_count," (",c.hash_type_name,")"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[o.length>0&&e.jsx("button",{onClick:w,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",title:"Export results",children:e.jsx(se,{className:"w-5 h-5"})}),e.jsx("button",{onClick:f,className:"text-gray-400 hover:text-white",children:e.jsx(D,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:u?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx(J,{className:"w-6 h-6 text-cyan-400 animate-spin"})}):o.length===0?e.jsxs("div",{className:"text-center p-8 text-gray-400",children:[e.jsx(F,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No credentials cracked yet"})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"sticky top-0 bg-gray-800",children:e.jsxs("tr",{className:"text-left text-gray-400 text-sm border-b border-gray-700",children:[e.jsx("th",{className:"px-4 py-3",children:"Username"}),e.jsx("th",{className:"px-4 py-3",children:"Password"}),e.jsx("th",{className:"px-4 py-3",children:"Hash"}),e.jsx("th",{className:"px-4 py-3",children:"Cracked At"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{children:o.map(a=>e.jsxs("tr",{className:"border-b border-gray-700/50 hover:bg-gray-700/30",children:[e.jsx("td",{className:"px-4 py-3 text-white font-mono text-sm",children:a.username||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-green-400 font-mono text-sm bg-green-500/10 px-2 py-1 rounded",children:a.plaintext})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 font-mono text-xs max-w-xs truncate",title:a.hash,children:a.hash.length>32?`${a.hash.substring(0,32)}...`:a.hash}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(a.cracked_at).toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{onClick:()=>v(`${a.username||""}:${a.plaintext}`),className:"p-1.5 text-gray-400 hover:text-cyan-400 hover:bg-cyan-500/20 rounded transition-colors",title:"Copy username:password",children:e.jsx(te,{className:"w-4 h-4"})})})]},a.id))})]})})]})})}export{xe as default};
