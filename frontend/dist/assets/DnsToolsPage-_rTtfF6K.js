import{j as e}from"./vendor-state-DdX3IZQk.js";import{r as o}from"./vendor-react-Da1CiaFS.js";import{G as j,$ as F,m as T,B as g,d as y,al as b,s as k,S as M,an as $,aj as L,a6 as z,b8 as O,ax as I}from"./vendor-ui-BHPtL6kl.js";import{C as p,I as _,z as X,b as S,L as C,G as D,B as v,d as B,g as V}from"./index-B8rNv6iC.js";import"./vendor-charts-DdTkGt7c.js";const P=({onSuccess:s})=>{const[t,l]=o.useState(""),[c,m]=o.useState(!0),[h,i]=o.useState(30),[n,a]=o.useState(!1),d=async x=>{var N,w;if(x.preventDefault(),!t.trim()){g.error("Please enter a domain name");return}if(!/^(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]$/i.test(t.trim())){g.error("Please enter a valid domain name (e.g., example.com)");return}a(!0);try{const f=await D.performRecon({domain:t.trim(),includeSubdomains:c,timeoutSecs:h});g.success(`DNS reconnaissance completed for ${t}`),s&&s(f.data)}catch(f){const r=((w=(N=f.response)==null?void 0:N.data)==null?void 0:w.error)||"Failed to perform DNS reconnaissance";g.error(r)}finally{a(!1)}};return e.jsx(p,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(j,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"DNS Reconnaissance"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enumerate DNS records, discover subdomains, and check security configuration"})]})]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"domain",className:"block text-sm font-medium text-gray-700 mb-1",children:"Domain Name *"}),e.jsx(_,{id:"domain",type:"text",placeholder:"example.com",value:t,onChange:x=>l(x.target.value),disabled:n,className:"font-mono"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter the domain name to investigate (without http:// or www)"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(F,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"What this scan includes:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"DNS record enumeration (A, AAAA, MX, NS, TXT, CNAME, SOA, etc.)"}),e.jsx("li",{children:"Subdomain discovery using built-in wordlist"}),e.jsx("li",{children:"Zone transfer vulnerability check (AXFR)"}),e.jsx("li",{children:"DNSSEC configuration check"}),e.jsx("li",{children:"Reverse DNS lookups"})]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(X,{id:"includeSubdomains",checked:c,onChange:x=>m(x),disabled:n,label:"Enumerate subdomains"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"timeout",className:"block text-sm font-medium text-gray-700 mb-1",children:"Timeout (seconds)"}),e.jsx(_,{id:"timeout",type:"number",min:10,max:300,value:h,onChange:x=>i(parseInt(x.target.value)||30),disabled:n}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Maximum time to wait for each DNS query (10-300 seconds)"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-200",children:[e.jsx(S,{type:"submit",disabled:n||!t.trim(),className:"flex items-center gap-2",children:n?e.jsxs(e.Fragment,{children:[e.jsx(C,{size:"sm"}),e.jsx("span",{children:"Scanning..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-4 h-4"}),e.jsx("span",{children:"Start DNS Reconnaissance"})]})}),n&&e.jsx("span",{className:"text-sm text-gray-500",children:"This may take a few minutes depending on the domain..."})]})]})]})})},Z=({result:s,onClose:t})=>{const[l,c]=o.useState({overview:!0,records:!0,subdomains:!0,security:!0}),m=a=>{c(d=>({...d,[a]:!d[a]}))},h=["A","AAAA","MX","NS","TXT","CNAME","SOA","SRV","CAA"],i=Object.keys(s.records).sort((a,d)=>{const x=h.indexOf(a),u=h.indexOf(d);return x===-1&&u===-1?a.localeCompare(d):x===-1?1:u===-1?-1:x-u}),n=H(s);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s.domain}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Scanned on ",new Date(s.scan_timestamp).toLocaleString()]})]})]}),t&&e.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"})]}),e.jsx(p,{children:e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{onClick:()=>m("overview"),className:"flex items-center justify-between w-full text-left",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Overview"}),l.overview?e.jsx(y,{className:"w-5 h-5 text-gray-400"}):e.jsx(b,{className:"w-5 h-5 text-gray-400"})]}),l.overview&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"DNS Records"})]}),e.jsx("p",{className:"mt-2 text-2xl font-bold text-gray-900",children:Object.values(s.records).reduce((a,d)=>a+d.length,0)}),e.jsxs("p",{className:"text-xs text-gray-500",children:[Object.keys(s.records).length," types"]})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Subdomains"})]}),e.jsx("p",{className:"mt-2 text-2xl font-bold text-gray-900",children:s.subdomains_found.length}),e.jsx("p",{className:"text-xs text-gray-500",children:"discovered"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Nameservers"})]}),e.jsx("p",{className:"mt-2 text-2xl font-bold text-gray-900",children:s.nameservers.length}),e.jsx("p",{className:"text-xs text-gray-500",children:"configured"})]}),e.jsxs("div",{className:`rounded-lg p-4 ${n>=80?"bg-green-50":n>=50?"bg-yellow-50":"bg-red-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:`w-5 h-5 ${n>=80?"text-green-600":n>=50?"text-yellow-600":"text-red-600"}`}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Security Score"})]}),e.jsxs("p",{className:"mt-2 text-2xl font-bold text-gray-900",children:[n,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:n>=80?"Good":n>=50?"Fair":"Poor"})]})]})]})}),e.jsx(p,{children:e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{onClick:()=>m("security"),className:"flex items-center justify-between w-full text-left",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Security Analysis"}),l.security?e.jsx(y,{className:"w-5 h-5 text-gray-400"}):e.jsx(b,{className:"w-5 h-5 text-gray-400"})]}),l.security&&e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx(E,{label:"DNSSEC",enabled:s.dnssec_enabled,description:s.dnssec_enabled?"Domain signing is enabled, providing authenticity and integrity":"Domain signing is not enabled - consider enabling DNSSEC for better security"}),e.jsx(E,{label:"Zone Transfer (AXFR)",enabled:!s.zone_transfer_vulnerable,description:s.zone_transfer_vulnerable?"Zone transfer is allowed - this is a security risk that exposes all DNS records":"Zone transfer is properly restricted",error:s.zone_transfer_error})]})]})}),e.jsx(p,{children:e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{onClick:()=>m("records"),className:"flex items-center justify-between w-full text-left",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"DNS Records"}),l.records?e.jsx(y,{className:"w-5 h-5 text-gray-400"}):e.jsx(b,{className:"w-5 h-5 text-gray-400"})]}),l.records&&e.jsx("div",{className:"mt-4 space-y-4",children:i.map(a=>e.jsx(G,{recordType:a,records:s.records[a],reverseDns:s.reverse_dns},a))})]})}),s.subdomains_found.length>0&&e.jsx(p,{children:e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{onClick:()=>m("subdomains"),className:"flex items-center justify-between w-full text-left",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Discovered Subdomains (",s.subdomains_found.length,")"]}),l.subdomains?e.jsx(y,{className:"w-5 h-5 text-gray-400"}):e.jsx(b,{className:"w-5 h-5 text-gray-400"})]}),l.subdomains&&e.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:s.subdomains_found.map(a=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded border border-gray-200",children:[e.jsx(k,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-mono text-gray-700 truncate",children:a})]},a))})]})})]})},E=({label:s,enabled:t,description:l,error:c})=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[t?e.jsx($,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}):e.jsx(L,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s}),e.jsx(v,{variant:t?"success":"warning",children:t?"Enabled":"Disabled"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:l}),c&&e.jsx("p",{className:"mt-1 text-xs text-gray-500 font-mono bg-gray-100 p-2 rounded",children:c})]})]}),G=({recordType:s,records:t,reverseDns:l})=>{const[c,m]=o.useState(s==="A"||s==="AAAA"),h=i=>{switch(i){case"A":case"AAAA":return"primary";case"MX":return"success";case"NS":return"warning";default:return"primary"}};return e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsxs("button",{onClick:()=>m(!c),className:"flex items-center justify-between w-full p-3 text-left hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{variant:h(s),children:s}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t.length," ",t.length===1?"record":"records"]})]}),c?e.jsx(y,{className:"w-4 h-4 text-gray-400"}):e.jsx(b,{className:"w-4 h-4 text-gray-400"})]}),c&&e.jsx("div",{className:"border-t border-gray-200",children:t.map((i,n)=>e.jsx("div",{className:"p-3 border-b border-gray-100 last:border-b-0 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("code",{className:"text-sm text-gray-900 break-all",children:i.value}),l[i.value]&&e.jsxs("div",{className:"mt-1 flex items-center gap-2 text-xs text-gray-500",children:[e.jsx("span",{className:"font-medium",children:"Reverse DNS:"}),e.jsx("code",{className:"text-gray-700",children:l[i.value]})]})]}),i.ttl&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 flex-shrink-0",children:[e.jsx(z,{className:"w-3 h-3"}),e.jsx("span",{children:q(i.ttl)})]})]})},n))})]})};function H(s){let t=100;return s.dnssec_enabled||(t-=30),s.zone_transfer_vulnerable&&(t-=50),s.nameservers.length===0&&(t-=20),Math.max(0,t)}function q(s){return s<60?`${s}s`:s<3600?`${Math.floor(s/60)}m`:s<86400?`${Math.floor(s/3600)}h`:`${Math.floor(s/86400)}d`}const Y=()=>{const[s,t]=o.useState(null),[l,c]=o.useState([]),[m,h]=o.useState(!0),[i,n]=o.useState("new"),[a,d]=o.useState(null),[x,u]=o.useState(!1);o.useEffect(()=>{N()},[]);const N=async()=>{h(!0);try{const r=await D.listResults();c(r.data)}catch(r){console.error("Failed to load recent DNS scans:",r)}finally{h(!1)}},w=r=>{t(r),n("result"),N()},f=async r=>{try{const R=await D.getResult(r);t(R.data),n("result")}catch{g.error("Failed to load DNS recon result")}},A=async()=>{if(a){u(!0);try{await D.deleteResult(a.id),g.success(`DNS recon for "${a.domain}" deleted`),N(),(s==null?void 0:s.id)===a.id&&(t(null),n("new")),d(null)}catch{g.error("Failed to delete DNS recon result")}finally{u(!1)}}};return e.jsx(B,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[e.jsx(j,{className:"h-8 w-8 text-primary"}),"DNS Reconnaissance Tools"]}),e.jsx("p",{className:"mt-2 text-slate-400",children:"Enumerate DNS records, discover subdomains, and check security configuration"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{variant:i==="new"?"primary":"secondary",onClick:()=>n("new"),children:"New Scan"}),e.jsxs(S,{variant:i==="history"?"primary":"secondary",onClick:()=>n("history"),children:["History (",l.length,")"]})]})]}),i==="new"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(P,{onSuccess:w})}),e.jsx("div",{children:e.jsx(p,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Recent Scans"}),m?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(C,{})}):l.length===0?e.jsx("p",{className:"text-sm text-slate-400 text-center py-8",children:"No recent scans"}):e.jsx("div",{className:"space-y-3",children:l.slice(0,5).map(r=>e.jsxs("div",{className:"p-3 bg-dark-bg rounded-lg border border-dark-border hover:bg-dark-hover transition-colors cursor-pointer",onClick:()=>f(r.id),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(j,{className:"w-4 h-4 text-primary flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium text-white truncate",children:r.domain})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[e.jsx(z,{className:"w-3 h-3"}),new Date(r.scan_timestamp).toLocaleDateString()]}),r.zone_transfer_vulnerable&&e.jsx(v,{type:"failed",className:"mt-1",children:"Zone Transfer Vulnerable"})]},r.id))})]})})})]}),i==="result"&&s&&e.jsx("div",{children:e.jsx(Z,{result:s.result,onClose:()=>n("new")})}),i==="history"&&e.jsx(p,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"DNS Reconnaissance History"}),m?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(C,{})}):l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(j,{className:"w-12 h-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No DNS reconnaissance scans yet"}),e.jsx(S,{variant:"primary",onClick:()=>n("new"),className:"mt-4",children:"Start First Scan"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-dark-border",children:[e.jsx("thead",{className:"bg-dark-bg",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Domain"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Scan Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Subdomains"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Security"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-dark-surface divide-y divide-dark-border",children:l.map(r=>e.jsxs("tr",{className:"hover:bg-dark-hover",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium text-white",children:r.domain})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-400",children:new Date(r.scan_timestamp).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:r.subdomains_count}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[r.dnssec_enabled&&e.jsx(v,{type:"completed",children:"DNSSEC"}),r.zone_transfer_vulnerable&&e.jsx(v,{type:"failed",children:"AXFR Vuln"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>f(r.id),className:"text-primary hover:text-primary-light",title:"View results",children:e.jsx(O,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>d(r),className:"text-severity-critical hover:text-severity-critical/80",title:"Delete","aria-label":`Delete DNS recon for ${r.domain}`,children:e.jsx(I,{className:"w-4 h-4"})})]})})]},r.id))})]})})]})}),e.jsx(V,{isOpen:!!a,onClose:()=>d(null),onConfirm:A,title:"Delete DNS Recon Result",message:`Are you sure you want to delete the DNS reconnaissance results for "${a==null?void 0:a.domain}"?`,confirmLabel:"Delete Result",variant:"danger",loading:x})]})})};export{Y as default};
