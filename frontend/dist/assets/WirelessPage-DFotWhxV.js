import{e as se,u as C,f as u,j as e}from"./vendor-state-oFDmcCcB.js";import{r as b}from"./vendor-react-5KxtEOLM.js";import{B as a,z as M,V as te,R as E,Y as T,W as D,F as ae,S as re,K as I,aa as p,_ as le,b4 as de,aZ as ie,w as B,l as ne,$ as ce,Z as O,aT as oe,ar as xe,a as me,cE as he}from"./vendor-ui-7EurIAWU.js";import{L as ue}from"./Layout-B2BPZquP.js";import{u as be,E as pe}from"./useRequireEngagement-Cwc_DHa_.js";import{W as l,B as n}from"./index-MDkiA-RQ.js";import"./vendor-markdown-BwTKtS0m.js";import"./vendor-utils-DfRopTPV.js";const c={getDashboard:()=>l.get("/wireless/dashboard"),listInterfaces:()=>l.get("/wireless/interfaces"),enableMonitor:t=>l.post(`/wireless/interfaces/${t}/monitor`),disableMonitor:t=>l.post(`/wireless/interfaces/${t}/managed`),startScan:t=>l.post("/wireless/scans",t),listScans:()=>l.get("/wireless/scans"),getScan:t=>l.get(`/wireless/scans/${t}`),stopScan:t=>l.delete(`/wireless/scans/${t}`),listNetworks:()=>l.get("/wireless/networks"),getNetwork:t=>l.get(`/wireless/networks/${t}`),sendDeauth:t=>l.post("/wireless/deauth",t),captureHandshake:t=>l.post("/wireless/capture/handshake",t),capturePmkid:t=>l.post("/wireless/capture/pmkid",t),wpsPixieDust:t=>l.post("/wireless/wps/pixie-dust",t),listHandshakes:()=>l.get("/wireless/handshakes"),crackHandshake:(t,i)=>l.post(`/wireless/handshakes/${t}/crack`,{wordlist:i}),listPmkids:()=>l.get("/wireless/pmkids"),listWordlists:()=>l.get("/wireless/wordlists")},H=({encryption:t})=>{const i=()=>{const x=t.toLowerCase();return x.includes("wpa3")?"bg-green-500/20 text-green-400 border-green-500/30":x.includes("wpa2")?"bg-blue-500/20 text-blue-400 border-blue-500/30":x.includes("wpa")?"bg-yellow-500/20 text-yellow-400 border-yellow-500/30":x.includes("wep")||x==="open"?"bg-red-500/20 text-red-400 border-red-500/30":"bg-gray-500/20 text-gray-400 border-gray-500/30"},d=()=>t.toLowerCase()==="open"?e.jsx(xe,{className:"h-3 w-3"}):e.jsx(me,{className:"h-3 w-3"});return e.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 text-xs font-medium rounded border ${i()}`,children:[d(),t]})},ge=({dbm:t})=>{const i=()=>t>=-50?"text-green-400":t>=-60?"text-green-300":t>=-70?"text-yellow-400":t>=-80?"text-orange-400":"text-red-400";return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(he,{className:`h-4 w-4 ${i()}`}),e.jsxs("span",{className:`text-sm ${i()}`,children:[t," dBm"]})]})},je=({status:t})=>{const i=()=>{switch(t.toLowerCase()){case"running":return"bg-green-500/20 text-green-400 border-green-500/30";case"success":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"failed":return"bg-red-500/20 text-red-400 border-red-500/30";case"cancelled":return"bg-gray-500/20 text-gray-400 border-gray-500/30";default:return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30"}};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded border capitalize ${i()}`,children:t})},P=({label:t,value:i,icon:d,color:x})=>e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:t}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:i})]}),e.jsx("div",{className:`p-3 rounded-lg ${x}`,children:d})]})}),ke=({network:t,onCapture:i,onDeauth:d,onPmkid:x,onWps:N,isLoading:f})=>{var q;const[_,g]=b.useState(!1);return e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>g(!_),children:[e.jsx(D,{className:"h-5 w-5 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:t.ssid||"<Hidden SSID>"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono",children:t.bssid})]}),_?e.jsx(ne,{className:"h-4 w-4 text-slate-400"}):e.jsx(ce,{className:"h-4 w-4 text-slate-400"})]}),e.jsx(H,{encryption:t.encryption})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center text-sm mb-4",children:[e.jsxs("div",{className:"bg-light-bg dark:bg-dark-bg rounded p-2",children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Channel"}),e.jsx("p",{className:"font-semibold text-slate-900 dark:text-white",children:t.channel})]}),e.jsxs("div",{className:"bg-light-bg dark:bg-dark-bg rounded p-2",children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Signal"}),e.jsx(ge,{dbm:t.signal_strength})]}),e.jsxs("div",{className:"bg-light-bg dark:bg-dark-bg rounded p-2",children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Clients"}),e.jsx("p",{className:"font-semibold text-cyan-400",children:((q=t.clients)==null?void 0:q.length)||0})]})]}),_&&t.clients&&t.clients.length>0&&e.jsxs("div",{className:"mb-4 bg-light-bg dark:bg-dark-bg rounded p-3",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:"Connected Clients:"}),e.jsx("div",{className:"space-y-1",children:t.clients.map(j=>e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"font-mono text-slate-600 dark:text-slate-300",children:j.mac_address}),e.jsxs("span",{className:"text-slate-400",children:[j.signal_strength," dBm"]})]},j.mac_address))})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(n,{size:"sm",onClick:i,disabled:f,title:"Capture WPA Handshake",children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"Handshake"]}),e.jsxs(n,{size:"sm",variant:"outline",onClick:x,disabled:f,title:"Capture PMKID",children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),"PMKID"]}),e.jsxs(n,{size:"sm",variant:"outline",onClick:d,disabled:f,title:"Send Deauth",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Deauth"]}),t.wps_enabled&&e.jsxs(n,{size:"sm",variant:"outline",onClick:N,disabled:f,title:"WPS Pixie Dust",children:[e.jsx(oe,{className:"h-4 w-4 mr-1"}),"WPS"]})]})]})},Ne=({handshake:t,onCrack:i,isCracking:d})=>e.jsxs("tr",{className:"hover:bg-light-hover dark:hover:bg-dark-hover",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:t.ssid||"<Hidden>"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono",children:t.bssid})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300 font-mono",children:t.client_mac}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex items-center gap-1",children:t.is_complete?e.jsxs("span",{className:"text-green-400 text-sm",children:["Complete (",t.eapol_messages,"/4)"]}):e.jsxs("span",{className:"text-yellow-400 text-sm",children:["Partial (",t.eapol_messages,"/4)"]})})}),e.jsx("td",{className:"px-4 py-3",children:t.cracked?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-sm text-green-400 font-mono",children:t.password})]}):e.jsx("span",{className:"text-slate-400 text-sm",children:"Not cracked"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-500 dark:text-slate-400",children:new Date(t.captured_at).toLocaleString()}),e.jsx("td",{className:"px-4 py-3",children:!t.cracked&&t.is_complete&&e.jsxs(n,{size:"sm",onClick:i,disabled:d,children:[d?e.jsx(p,{className:"h-4 w-4 animate-spin"}):e.jsx(O,{className:"h-4 w-4 mr-1"}),"Crack"]})})]}),Ie=()=>{const t=se(),{hasEngagement:i}=be(),[d,x]=b.useState("dashboard"),[N,f]=b.useState(""),[_,g]=b.useState(!1),[q,j]=b.useState(!1),[k,V]=b.useState(null),[Z,K]=b.useState(null),[w,$]=b.useState({interface:"",duration_secs:60,channels:[]}),{data:o,isLoading:fe}=C({queryKey:["wireless-dashboard"],queryFn:()=>c.getDashboard().then(s=>s.data)}),{data:m,isLoading:Y}=C({queryKey:["wireless-interfaces"],queryFn:()=>c.listInterfaces().then(s=>s.data)}),{data:h,isLoading:G}=C({queryKey:["wireless-networks"],queryFn:()=>c.listNetworks().then(s=>s.data)}),{data:y,isLoading:J}=C({queryKey:["wireless-scans"],queryFn:()=>c.listScans().then(s=>s.data)}),{data:v,isLoading:U}=C({queryKey:["wireless-handshakes"],queryFn:()=>c.listHandshakes().then(s=>s.data),enabled:d==="handshakes"}),{data:we}=C({queryKey:["wireless-wordlists"],queryFn:()=>c.listWordlists().then(s=>s.data),enabled:d==="handshakes"}),z=u({mutationFn:s=>c.enableMonitor(s),onSuccess:()=>{a.success("Monitor mode enabled"),t.invalidateQueries({queryKey:["wireless-interfaces"]})},onError:()=>a.error("Failed to enable monitor mode")}),A=u({mutationFn:s=>c.disableMonitor(s),onSuccess:()=>{a.success("Monitor mode disabled"),t.invalidateQueries({queryKey:["wireless-interfaces"]})},onError:()=>a.error("Failed to disable monitor mode")}),W=u({mutationFn:s=>c.startScan(s),onSuccess:()=>{a.success("Wireless scan started"),t.invalidateQueries({queryKey:["wireless-scans"]}),t.invalidateQueries({queryKey:["wireless-dashboard"]}),g(!1)},onError:()=>a.error("Failed to start scan")}),X=u({mutationFn:s=>c.stopScan(s),onSuccess:()=>{a.success("Scan stopped"),t.invalidateQueries({queryKey:["wireless-scans"]})}}),L=u({mutationFn:s=>c.sendDeauth(s),onSuccess:()=>{a.success("Deauth packets sent")},onError:()=>a.error("Deauth failed")}),F=u({mutationFn:s=>c.captureHandshake(s),onSuccess:()=>{a.success("Handshake captured!"),t.invalidateQueries({queryKey:["wireless-handshakes"]}),t.invalidateQueries({queryKey:["wireless-dashboard"]}),j(!1)},onError:()=>a.error("Handshake capture failed")}),Q=u({mutationFn:s=>c.capturePmkid(s),onSuccess:s=>{s.data?(a.success("PMKID captured!"),t.invalidateQueries({queryKey:["wireless-dashboard"]})):a.warning("No PMKID captured")},onError:()=>a.error("PMKID capture failed")}),R=u({mutationFn:s=>c.wpsPixieDust(s),onSuccess:s=>{var r;(r=s.data)!=null&&r.success?a.success(`WPS cracked! PIN: ${s.data.pin}, PSK: ${s.data.psk}`):a.warning("WPS attack unsuccessful")},onError:()=>a.error("WPS attack failed")}),ee=u({mutationFn:({id:s,wordlist:r})=>(K(s),c.crackHandshake(s,r)),onSuccess:s=>{var r;(r=s.data)!=null&&r.password?a.success(`Password cracked: ${s.data.password}`):a.warning("Password not found in wordlist"),t.invalidateQueries({queryKey:["wireless-handshakes"]}),K(null)},onError:()=>{a.error("Cracking failed"),K(null)}}),S=()=>(m==null?void 0:m.filter(s=>s.mode==="monitor"))||[];return e.jsx(ue,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Wireless Security Assessment"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"WiFi network discovery, handshake capture, and password cracking"})]}),e.jsxs(n,{onClick:()=>g(!0),disabled:!i,children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Start Scan"]})]}),e.jsx(pe,{toolName:"Wireless Security Assessment",className:"mb-6"}),e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(te,{className:"h-5 w-5 text-yellow-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-400",children:"Authorization Required"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Wireless security assessment requires proper authorization. Only test networks you own or have explicit permission to assess. Deauthentication attacks can disrupt network services."})]})]}),o&&e.jsxs("div",{className:"grid grid-cols-6 gap-4",children:[e.jsx(P,{label:"Total Scans",value:o.total_scans,icon:e.jsx(E,{className:"h-5 w-5 text-blue-400"}),color:"bg-blue-500/10"}),e.jsx(P,{label:"Active Scans",value:o.active_scans,icon:e.jsx(T,{className:"h-5 w-5 text-green-400"}),color:"bg-green-500/10"}),e.jsx(P,{label:"Networks",value:o.networks_discovered,icon:e.jsx(D,{className:"h-5 w-5 text-cyan-400"}),color:"bg-cyan-500/10"}),e.jsx(P,{label:"Handshakes",value:o.handshakes_captured,icon:e.jsx(ae,{className:"h-5 w-5 text-purple-400"}),color:"bg-purple-500/10"}),e.jsx(P,{label:"PMKIDs",value:o.pmkids_captured,icon:e.jsx(re,{className:"h-5 w-5 text-orange-400"}),color:"bg-orange-500/10"}),e.jsx(P,{label:"Cracked",value:o.passwords_cracked,icon:e.jsx(I,{className:"h-5 w-5 text-red-400"}),color:"bg-red-500/10"})]}),e.jsx("div",{className:"flex gap-2 border-b border-light-border dark:border-dark-border pb-2",children:[{id:"dashboard",label:"Overview",icon:e.jsx(T,{className:"h-4 w-4"})},{id:"interfaces",label:"Interfaces",icon:e.jsx(E,{className:"h-4 w-4"})},{id:"networks",label:"Networks",icon:e.jsx(D,{className:"h-4 w-4"})},{id:"scans",label:"Scans",icon:e.jsx(M,{className:"h-4 w-4"})},{id:"handshakes",label:"Captures",icon:e.jsx(I,{className:"h-4 w-4"})}].map(s=>e.jsxs("button",{onClick:()=>x(s.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${d===s.id?"bg-primary text-white":"text-slate-600 dark:text-slate-400 hover:bg-light-hover dark:hover:bg-dark-hover"}`,children:[s.icon,s.label]},s.id))}),d==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[o&&Object.keys(o.networks_by_encryption).length>0&&e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white mb-4",children:"Networks by Encryption"}),e.jsx("div",{className:"flex gap-4",children:Object.entries(o.networks_by_encryption).map(([s,r])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{encryption:s}),e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:r})]},s))})]}),o&&o.top_vulnerable_networks.length>0&&e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-light-border dark:border-dark-border",children:e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:"Vulnerable Networks"})}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-light-bg dark:bg-dark-bg",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"SSID"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"BSSID"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Encryption"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Vulnerability"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Severity"})]})}),e.jsx("tbody",{className:"divide-y divide-light-border dark:divide-dark-border",children:o.top_vulnerable_networks.map(s=>e.jsxs("tr",{className:"hover:bg-light-hover dark:hover:bg-dark-hover",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-slate-900 dark:text-white",children:s.ssid||"<Hidden>"}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300 font-mono",children:s.bssid}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(H,{encryption:s.encryption})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:s.vulnerability}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded border ${s.severity==="critical"?"bg-red-500/20 text-red-400 border-red-500/30":s.severity==="high"?"bg-orange-500/20 text-orange-400 border-orange-500/30":"bg-yellow-500/20 text-yellow-400 border-yellow-500/30"}`,children:s.severity})})]},s.bssid))})]})]})]}),d==="interfaces"&&e.jsx("div",{className:"space-y-4",children:Y?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(p,{className:"h-8 w-8 animate-spin text-primary"})}):(m==null?void 0:m.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No wireless interfaces found"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Ensure a wireless adapter with monitor mode support is connected"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m==null?void 0:m.map(s=>e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(E,{className:`h-5 w-5 ${s.mode==="monitor"?"text-green-400":"text-slate-400"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:s.driver})]})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${s.mode==="monitor"?"bg-green-500/20 text-green-400":"bg-slate-500/20 text-slate-400"}`,children:s.mode})]}),s.chipset&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-3",children:s.chipset}),e.jsx("div",{className:"flex gap-2",children:s.mode==="monitor"?e.jsxs(n,{size:"sm",variant:"outline",onClick:()=>A.mutate(s.name),disabled:A.isPending,children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),"Disable Monitor"]}):e.jsxs(n,{size:"sm",onClick:()=>z.mutate(s.name),disabled:!s.monitor_capable||z.isPending,children:[e.jsx(D,{className:"h-4 w-4 mr-1"}),"Enable Monitor"]})}),!s.monitor_capable&&e.jsx("p",{className:"text-xs text-red-400 mt-2",children:"This interface does not support monitor mode"})]},s.name))})}),d==="networks"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[(h==null?void 0:h.length)||0," networks discovered"]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>t.invalidateQueries({queryKey:["wireless-networks"]}),children:[e.jsx(p,{className:"h-4 w-4 mr-1"}),"Refresh"]})]}),G?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(p,{className:"h-8 w-8 animate-spin text-primary"})}):(h==null?void 0:h.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(D,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No networks discovered"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Start a wireless scan to discover nearby networks"}),e.jsxs(n,{onClick:()=>g(!0),children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Start Scan"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:h==null?void 0:h.map(s=>e.jsx(ke,{network:s,onCapture:()=>{V(s),j(!0)},onDeauth:()=>{const r=S()[0];r?L.mutate({interface:r.name,bssid:s.bssid,count:5}):a.error("Enable monitor mode on an interface first")},onPmkid:()=>{const r=S()[0];r?Q.mutate({interface:r.name,bssid:s.bssid,channel:s.channel}):a.error("Enable monitor mode on an interface first")},onWps:()=>{const r=S()[0];r?R.mutate({interface:r.name,bssid:s.bssid}):a.error("Enable monitor mode on an interface first")},isLoading:L.isPending||Q.isPending||R.isPending},s.bssid))})]}),d==="scans"&&e.jsx("div",{className:"space-y-4",children:J?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(p,{className:"h-8 w-8 animate-spin text-primary"})}):(y==null?void 0:y.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(M,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No scans yet"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Start a wireless scan to discover nearby networks"}),e.jsxs(n,{onClick:()=>g(!0),children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Start Scan"]})]}):e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-light-bg dark:bg-dark-bg",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Interface"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Status"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Networks"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Clients"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Handshakes"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Started"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-light-border dark:divide-dark-border",children:y==null?void 0:y.map(s=>e.jsxs("tr",{className:"hover:bg-light-hover dark:hover:bg-dark-hover",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-slate-900 dark:text-white",children:s.interface}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(je,{status:s.status})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:s.networks_found}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:s.clients_found}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:s.handshakes_captured}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-500 dark:text-slate-400",children:new Date(s.started_at).toLocaleString()}),e.jsx("td",{className:"px-4 py-3",children:s.status==="running"&&e.jsx(n,{size:"sm",variant:"ghost",className:"text-red-400",onClick:()=>X.mutate(s.id),children:e.jsx(de,{className:"h-4 w-4"})})})]},s.id))})]})})}),d==="handshakes"&&e.jsx("div",{className:"space-y-4",children:U?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(p,{className:"h-8 w-8 animate-spin text-primary"})}):(v==null?void 0:v.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(I,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No handshakes captured"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Capture WPA handshakes from target networks to crack passwords"})]}):e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-light-bg dark:bg-dark-bg",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Network"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Client"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Status"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Password"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Captured"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-light-border dark:divide-dark-border",children:v==null?void 0:v.map(s=>e.jsx(Ne,{handshake:s,onCrack:()=>ee.mutate({id:s.id}),isCracking:Z===s.id},s.id))})]})})}),_&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4",children:"Start Wireless Scan"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Interface"}),e.jsxs("select",{value:w.interface,onChange:s=>$({...w,interface:s.target.value}),className:"w-full px-3 py-2 rounded-lg border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Select interface..."}),S().map(s=>e.jsxs("option",{value:s.name,children:[s.name," (monitor mode)"]},s.name))]}),S().length===0&&e.jsx("p",{className:"text-xs text-yellow-400 mt-1",children:"Enable monitor mode on an interface first"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Duration (seconds)"}),e.jsx("input",{type:"number",value:w.duration_secs,onChange:s=>$({...w,duration_secs:parseInt(s.target.value)}),className:"w-full px-3 py-2 rounded-lg border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white",min:"10",max:"3600"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx(n,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsxs(n,{onClick:()=>W.mutate(w),disabled:!w.interface||W.isPending,children:[W.isPending?e.jsx(p,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Start Scan"]})]})]})}),q&&k&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4",children:"Capture WPA Handshake"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-light-bg dark:bg-dark-bg rounded p-3",children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Target Network:"}),e.jsx("p",{className:"font-semibold text-slate-900 dark:text-white",children:k.ssid||"<Hidden SSID>"}),e.jsx("p",{className:"text-xs text-slate-400 font-mono",children:k.bssid})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Interface"}),e.jsxs("select",{value:N,onChange:s=>f(s.target.value),className:"w-full px-3 py-2 rounded-lg border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Select interface..."}),S().map(s=>e.jsx("option",{value:s.name,children:s.name},s.name))]})]}),e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:[e.jsx("p",{children:"This will:"}),e.jsxs("ul",{className:"list-disc list-inside mt-1",children:[e.jsxs("li",{children:["Lock to channel ",k.channel]}),e.jsx("li",{children:"Send deauth packets to force reconnection"}),e.jsx("li",{children:"Capture the 4-way handshake"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx(n,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsxs(n,{onClick:()=>{N&&k&&F.mutate({interface:N,bssid:k.bssid,channel:k.channel,timeout_secs:120})},disabled:!N||F.isPending,children:[F.isPending?e.jsx(p,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(B,{className:"h-4 w-4 mr-2"}),"Start Capture"]})]})]})})]})})};export{Ie as default};
