import{b as Q,u as N,d as w,j as e}from"./vendor-state-BjT_zREg.js";import{r as b}from"./vendor-react-5KxtEOLM.js";import{bA as F,m as $,aZ as H,b2 as Z,a7 as Y,aa as v,ap as S,J as ee,B as y,ac as se,F as A,p as D,aK as K,M as te,bu as ae,b0 as re,G as le,y as ie,X as ne,w as oe}from"./vendor-ui-CfSMq23b.js";import{L as ce}from"./Layout-C_2au5Vm.js";import{N as c}from"./index-CJ_zz9jP.js";import"./vendor-markdown-BGP8SuZQ.js";import"./vendor-utils-DfRopTPV.js";const p={listIocs:s=>c.get("/hunting/iocs",{params:s}).then(a=>a.data),getIocStats:()=>c.get("/hunting/iocs/stats").then(s=>s.data),createIoc:s=>c.post("/hunting/iocs",s).then(a=>a.data),updateIoc:(s,a)=>c.put(`/hunting/iocs/${s}`,a).then(o=>o.data),deleteIoc:s=>c.delete(`/hunting/iocs/${s}`),importIocs:(s,a)=>c.post("/hunting/iocs/import",{format:s,data:a}).then(o=>o.data),exportIocs:(s,a)=>c.get(`/hunting/iocs/export/${s}`,{params:a,responseType:"blob"}),matchIocs:s=>c.post("/hunting/iocs/match",{data:s}).then(a=>a.data),listPlaybooks:s=>c.get("/hunting/playbooks",{params:s}).then(a=>a.data.playbooks),createPlaybook:s=>c.post("/hunting/playbooks",s).then(a=>a.data),getPlaybook:s=>c.get(`/hunting/playbooks/${s}`).then(a=>a.data),updatePlaybook:(s,a)=>c.put(`/hunting/playbooks/${s}`,a).then(o=>o.data),listSessions:s=>c.get("/hunting/sessions",{params:s}).then(a=>a.data),createSession:s=>c.post("/hunting/sessions",s).then(a=>a.data),getSession:s=>c.get(`/hunting/sessions/${s}`).then(a=>a.data),updateSession:(s,a)=>c.put(`/hunting/sessions/${s}`,a).then(o=>o.data),addSessionNote:(s,a)=>c.post(`/hunting/sessions/${s}/notes`,{note:a}).then(o=>o.data),getSessionFindings:s=>c.get(`/hunting/sessions/${s}/findings`).then(a=>a.data),addSessionFinding:(s,a)=>c.post(`/hunting/sessions/${s}/findings`,a).then(o=>o.data),getMitreCoverage:()=>c.get("/hunting/mitre/coverage").then(s=>s.data),getMitreMatrix:()=>c.get("/hunting/mitre/matrix").then(s=>s.data),listRetrospectives:()=>c.get("/hunting/retrospective").then(s=>s.data),createRetrospective:s=>c.post("/hunting/retrospective",s).then(a=>a.data),getRetrospective:s=>c.get(`/hunting/retrospective/${s}`).then(a=>a.data)},O={critical:{bg:"bg-red-500/20",text:"text-red-400"},high:{bg:"bg-orange-500/20",text:"text-orange-400"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400"},low:{bg:"bg-blue-500/20",text:"text-blue-400"},informational:{bg:"bg-gray-500/20",text:"text-gray-400"}},R={active:{bg:"bg-green-500/20",text:"text-green-400"},expired:{bg:"bg-gray-500/20",text:"text-gray-400"},false_positive:{bg:"bg-red-500/20",text:"text-red-400"},paused:{bg:"bg-yellow-500/20",text:"text-yellow-400"},completed:{bg:"bg-cyan-500/20",text:"text-cyan-400"},cancelled:{bg:"bg-gray-500/20",text:"text-gray-400"},pending:{bg:"bg-orange-500/20",text:"text-orange-400"},running:{bg:"bg-purple-500/20",text:"text-purple-400"}},de={ip:e.jsx(ie,{className:"w-4 h-4"}),domain:e.jsx(le,{className:"w-4 h-4"}),hash:e.jsx(re,{className:"w-4 h-4"}),url:e.jsx(ae,{className:"w-4 h-4"}),email:e.jsx(te,{className:"w-4 h-4"}),registry:e.jsx(S,{className:"w-4 h-4"})};function U({severity:s}){const a=O[s.toLowerCase()]||O.medium;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${a.bg} ${a.text}`,children:s.charAt(0).toUpperCase()+s.slice(1)})}function T({status:s}){const a=R[s.toLowerCase()]||R.active;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${a.bg} ${a.text}`,children:s.replace(/_/g," ").replace(/\b\w/g,o=>o.toUpperCase())})}const q=({isOpen:s,onClose:a,title:o,children:l,size:i="md"})=>{if(!s)return null;const x={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:a}),e.jsxs("div",{className:`relative bg-gray-800 border border-gray-700 rounded-lg shadow-xl w-full ${x[i]} max-h-[90vh] overflow-y-auto mx-4`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 sticky top-0 bg-gray-800 z-10",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:o}),e.jsx("button",{onClick:a,className:"p-1 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-white",children:e.jsx(ne,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4",children:l})]})]})},xe=({onSubmit:s,onCancel:a,isLoading:o})=>{const[l,i]=b.useState({ioc_type:"ip",value:"",severity:"medium",source:"",tags:""}),x=d=>{d.preventDefault(),s({...l,tags:l.tags?l.tags.split(",").map(h=>h.trim()):[]})};return e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"IOC Type *"}),e.jsxs("select",{value:l.ioc_type,onChange:d=>i({...l,ioc_type:d.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"ip",children:"IP Address"}),e.jsx("option",{value:"domain",children:"Domain"}),e.jsx("option",{value:"hash",children:"File Hash"}),e.jsx("option",{value:"url",children:"URL"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"registry",children:"Registry Key"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Severity"}),e.jsxs("select",{value:l.severity,onChange:d=>i({...l,severity:d.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Value *"}),e.jsx("input",{type:"text",required:!0,value:l.value,onChange:d=>i({...l,value:d.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white font-mono focus:ring-2 focus:ring-cyan-500",placeholder:l.ioc_type==="ip"?"192.168.1.1":l.ioc_type==="domain"?"malicious.example.com":l.ioc_type==="hash"?"abc123def456...":l.ioc_type==="url"?"https://malicious.example.com/payload":l.ioc_type==="email"?"attacker@malicious.com":"HKLM\\Software\\Malicious"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Source"}),e.jsx("input",{type:"text",value:l.source,onChange:d=>i({...l,source:d.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Threat intel feed, incident, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Tags"}),e.jsx("input",{type:"text",value:l.tags,onChange:d=>i({...l,tags:d.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"apt29, ransomware, c2 (comma-separated)"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:a,disabled:o,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors disabled:opacity-50",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:o,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors disabled:opacity-50 flex items-center gap-2",children:[o&&e.jsx(v,{className:"w-4 h-4 animate-spin"}),"Add IOC"]})]})]})},me=({playbooks:s,onSubmit:a,onCancel:o,isLoading:l})=>{const[i,x]=b.useState({name:"",description:"",playbook_id:"",hypothesis:"",data_sources:""}),d=n=>{n.preventDefault(),a({...i,playbook_id:i.playbook_id||void 0,data_sources:i.data_sources?i.data_sources.split(",").map(m=>m.trim()):[]})},h=n=>{if(x({...i,playbook_id:n}),n){const m=s.find(r=>r.id===n);if(m){const r=new Set;m.steps.forEach(g=>{g.queries.forEach(f=>r.add(f.platform))}),x(g=>({...g,playbook_id:n,hypothesis:m.description,data_sources:Array.from(r).join(", ")}))}}};return e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Hunt Name *"}),e.jsx("input",{type:"text",required:!0,value:i.name,onChange:n=>x({...i,name:n.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Hunt session name..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Based on Playbook"}),e.jsxs("select",{value:i.playbook_id,onChange:n=>h(n.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"",children:"No playbook (custom hunt)"}),s.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Hypothesis *"}),e.jsx("textarea",{required:!0,value:i.hypothesis,onChange:n=>x({...i,hypothesis:n.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",rows:3,placeholder:"What are you looking for? What behavior suggests compromise?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:i.description,onChange:n=>x({...i,description:n.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",rows:2,placeholder:"Additional context for this hunt..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Data Sources"}),e.jsx("input",{type:"text",value:i.data_sources,onChange:n=>x({...i,data_sources:n.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"EDR, SIEM, DNS logs (comma-separated)"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:o,disabled:l,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors disabled:opacity-50",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors disabled:opacity-50 flex items-center gap-2",children:[l&&e.jsx(v,{className:"w-4 h-4 animate-spin"}),"Start Hunt"]})]})]})},ge=({session:s,onClose:a})=>{const o=Q(),[l,i]=b.useState(""),[x,d]=b.useState("details"),{data:h}=N({queryKey:["session-findings",s.id],queryFn:()=>p.getSessionFindings(s.id)}),n=w({mutationFn:r=>p.addSessionNote(s.id,r),onSuccess:()=>{o.invalidateQueries({queryKey:["hunting-sessions"]}),i(""),y.success("Note added")},onError:()=>y.error("Failed to add note")}),m=w({mutationFn:r=>p.updateSession(s.id,{status:r}),onSuccess:()=>{o.invalidateQueries({queryKey:["hunting-sessions"]}),y.success("Session updated")},onError:()=>y.error("Failed to update session")});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(T,{status:s.status}),s.playbook_name&&e.jsxs("span",{className:"text-xs text-gray-500",children:["from: ",s.playbook_name]})]}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:s.name}),s.description&&e.jsx("p",{className:"text-gray-400 mt-1",children:s.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.status==="active"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>m.mutate("paused"),className:"px-3 py-1.5 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg text-sm",children:"Pause"}),e.jsx("button",{onClick:()=>m.mutate("completed"),className:"px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm",children:"Complete"})]}),s.status==="paused"&&e.jsx("button",{onClick:()=>m.mutate("active"),className:"px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg text-sm",children:"Resume"})]})]}),e.jsxs("div",{className:"p-4 bg-gray-900 rounded-lg border-l-4 border-cyan-500",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Hypothesis"}),e.jsx("p",{className:"text-gray-300",children:s.hypothesis})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:["details","findings","notes"].map(r=>e.jsxs("button",{onClick:()=>d(r),className:`px-3 py-2 border-b-2 transition-colors text-sm ${x===r?"border-cyan-500 text-cyan-500":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[r.charAt(0).toUpperCase()+r.slice(1),r==="findings"&&e.jsxs("span",{className:"ml-1 text-gray-500",children:["(",s.findings_count,")"]}),r==="notes"&&e.jsxs("span",{className:"ml-1 text-gray-500",children:["(",s.notes.length,")"]})]},r))})}),e.jsxs("div",{className:"min-h-[200px]",children:[x==="details"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Started"}),e.jsx("p",{className:"text-white",children:new Date(s.start_time).toLocaleString()})]}),s.end_time&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Ended"}),e.jsx("p",{className:"text-white",children:new Date(s.end_time).toLocaleString()})]})]}),s.data_sources.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Data Sources"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.data_sources.map((r,g)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs",children:r},g))})]})]}),x==="findings"&&e.jsx("div",{className:"space-y-2",children:h&&h.length>0?h.map(r=>e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{severity:r.severity}),e.jsx("span",{className:"text-xs text-gray-500",children:r.finding_type})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(r.created_at).toLocaleString()})]}),e.jsx("h4",{className:"text-white font-medium",children:r.title}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:r.description}),r.iocs_found.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:r.iocs_found.map((g,f)=>e.jsx("span",{className:"px-2 py-0.5 bg-red-500/20 text-red-400 rounded text-xs font-mono",children:g},f))})]},r.id)):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(oe,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No findings yet"})]})}),x==="notes"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:r=>i(r.target.value),className:"flex-1 px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"Add a note..."}),e.jsx("button",{onClick:()=>{l.trim()&&n.mutate(l)},disabled:!l.trim()||n.isPending,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:"Add"})]}),e.jsx("div",{className:"space-y-2",children:s.notes.length>0?s.notes.map((r,g)=>e.jsx("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-3",children:e.jsx("p",{className:"text-gray-300",children:r})},g)):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(A,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No notes yet"})]})})]})]})]})};function ve(){var E,L;const s=Q(),[a,o]=b.useState("iocs"),[l,i]=b.useState(!1),[x,d]=b.useState(!1),[h,n]=b.useState(null),[m,r]=b.useState(""),[g,f]=b.useState(""),{data:j}=N({queryKey:["ioc-stats"],queryFn:()=>p.getIocStats(),enabled:a==="iocs"}),{data:k,isLoading:B}=N({queryKey:["iocs",m,g],queryFn:()=>{const t={};return m&&(t.ioc_type=m),g&&(t.status=g),p.listIocs(t)},enabled:a==="iocs"}),{data:C,isLoading:z}=N({queryKey:["hunting-playbooks"],queryFn:()=>p.listPlaybooks(),enabled:a==="playbooks"||a==="sessions"}),{data:_,isLoading:G}=N({queryKey:["hunting-sessions"],queryFn:()=>p.listSessions(),enabled:a==="sessions"}),{data:I,isLoading:V}=N({queryKey:["mitre-coverage"],queryFn:()=>p.getMitreCoverage(),enabled:a==="mitre"}),M=w({mutationFn:p.createIoc,onSuccess:()=>{s.invalidateQueries({queryKey:["iocs"]}),s.invalidateQueries({queryKey:["ioc-stats"]}),i(!1),y.success("IOC added")},onError:()=>y.error("Failed to add IOC")}),P=w({mutationFn:p.createSession,onSuccess:()=>{s.invalidateQueries({queryKey:["hunting-sessions"]}),d(!1),y.success("Hunt session started")},onError:()=>y.error("Failed to start session")}),W=w({mutationFn:p.deleteIoc,onSuccess:()=>{s.invalidateQueries({queryKey:["iocs"]}),s.invalidateQueries({queryKey:["ioc-stats"]}),y.success("IOC deleted")},onError:()=>y.error("Failed to delete IOC")}),J=[{id:"iocs",label:"IOCs",icon:e.jsx(S,{className:"w-4 h-4"})},{id:"playbooks",label:"Playbooks",icon:e.jsx(A,{className:"w-4 h-4"})},{id:"sessions",label:"Hunt Sessions",icon:e.jsx(F,{className:"w-4 h-4"})},{id:"mitre",label:"MITRE Coverage",icon:e.jsx(K,{className:"w-4 h-4"})},{id:"retrospective",label:"Retrospective",icon:e.jsx(D,{className:"w-4 h-4"})}];return e.jsx(ce,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(F,{className:"w-8 h-8 text-purple-500"}),"Threat Hunting"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Proactively hunt for threats and manage IOCs"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:[e.jsx($,{className:"w-4 h-4"}),"Add IOC"]}),e.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(H,{className:"w-4 h-4"}),"Start Hunt"]})]})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:J.map(t=>e.jsxs("button",{onClick:()=>o(t.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${a===t.id?"border-cyan-500 text-cyan-500":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[t.icon,t.label]},t.id))})}),e.jsxs("div",{children:[a==="iocs"&&e.jsxs("div",{className:"space-y-4",children:[j&&e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:j.total}),e.jsx("p",{className:"text-xs text-gray-400",children:"Total IOCs"})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:j.active}),e.jsx("p",{className:"text-xs text-gray-400",children:"Active"})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:j.added_today}),e.jsx("p",{className:"text-xs text-gray-400",children:"Added Today"})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-400",children:j.expired_today}),e.jsx("p",{className:"text-xs text-gray-400",children:"Expired Today"})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:((E=j.by_type)==null?void 0:E.ip)||0}),e.jsx("p",{className:"text-xs text-gray-400",children:"IPs"})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:((L=j.by_type)==null?void 0:L.domain)||0}),e.jsx("p",{className:"text-xs text-gray-400",children:"Domains"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:m,onChange:t=>r(t.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"ip",children:"IP Address"}),e.jsx("option",{value:"domain",children:"Domain"}),e.jsx("option",{value:"hash",children:"File Hash"}),e.jsx("option",{value:"url",children:"URL"}),e.jsx("option",{value:"email",children:"Email"})]}),e.jsxs("select",{value:g,onChange:t=>f(t.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"expired",children:"Expired"}),e.jsx("option",{value:"false_positive",children:"False Positive"})]}),e.jsx("div",{className:"flex-1"}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm",children:[e.jsx(Z,{className:"w-4 h-4"}),"Import"]}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm",children:[e.jsx(Y,{className:"w-4 h-4"}),"Export"]})]}),B?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(v,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):k&&k.length>0?e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Type"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Value"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Severity"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Source"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Added"}),e.jsx("th",{className:"text-right p-4 text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:k.map(t=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[de[t.ioc_type]||e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{className:"text-gray-400 text-sm",children:t.ioc_type.toUpperCase()})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-white font-mono text-sm truncate max-w-xs",children:t.value}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(t.value),y.success("Copied to clipboard")},className:"p-1 hover:bg-gray-600 rounded text-gray-400 hover:text-white",children:e.jsx(ee,{className:"w-3 h-3"})})]})}),e.jsx("td",{className:"p-4",children:e.jsx(U,{severity:t.severity})}),e.jsx("td",{className:"p-4",children:e.jsx(T,{status:t.status})}),e.jsx("td",{className:"p-4 text-gray-400 text-sm",children:t.source||"-"}),e.jsx("td",{className:"p-4 text-gray-500 text-sm",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("button",{onClick:()=>W.mutate(t.id),className:"p-2 hover:bg-red-500/20 rounded-lg text-gray-400 hover:text-red-400",children:e.jsx(se,{className:"w-4 h-4"})})})]},t.id))})]})}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(S,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No IOCs"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Add indicators of compromise to track threats"}),e.jsxs("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx($,{className:"w-4 h-4 inline mr-2"}),"Add IOC"]})]})]}),a==="playbooks"&&e.jsx("div",{className:"space-y-4",children:z?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(v,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):C&&C.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:C.map(t=>e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-400 rounded text-xs",children:t.category}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${t.difficulty==="Beginner"?"bg-green-500/20 text-green-400":t.difficulty==="Intermediate"?"bg-yellow-500/20 text-yellow-400":t.difficulty==="Advanced"?"bg-orange-500/20 text-orange-400":"bg-red-500/20 text-red-400"}`,children:t.difficulty}),t.is_builtin&&e.jsx("span",{className:"px-2 py-0.5 bg-cyan-500/20 text-cyan-400 rounded text-xs",children:"Built-in"})]}),e.jsx("h3",{className:"text-lg font-medium text-white",children:t.name})]})}),t.description&&e.jsx("p",{className:"text-sm text-gray-400 mb-3 line-clamp-2",children:t.description}),e.jsxs("div",{className:"p-3 bg-gray-900 rounded-lg mb-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Estimated Duration"}),e.jsx("p",{className:"text-gray-300 text-sm",children:t.estimated_duration})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[t.tags.slice(0,4).map((u,X)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs",children:u},X)),t.tags.length>4&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",t.tags.length-4," more"]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[e.jsxs("span",{children:[t.steps.length," steps"]}),t.mitre_techniques.length>0&&e.jsxs("span",{children:[t.mitre_techniques.length," techniques"]}),t.mitre_tactics.length>0&&e.jsxs("span",{children:[t.mitre_tactics.length," tactics"]})]})]},t.id))}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(A,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Playbooks"}),e.jsx("p",{className:"text-gray-400",children:"Create hunting playbooks to standardize your hunts"})]})}),a==="sessions"&&e.jsx("div",{className:"space-y-4",children:G?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(v,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):_&&_.length>0?e.jsx("div",{className:"space-y-3",children:_.map(t=>e.jsx("div",{onClick:()=>n(t),className:"bg-gray-800 border border-gray-700 rounded-lg p-4 hover:border-gray-600 cursor-pointer transition-colors",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(T,{status:t.status}),t.playbook_name&&e.jsxs("span",{className:"text-xs text-gray-500",children:["from: ",t.playbook_name]})]}),e.jsx("h3",{className:"text-lg font-medium text-white",children:t.name}),t.description&&e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:t.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(D,{className:"w-3 h-3"}),new Date(t.start_time).toLocaleString()]}),e.jsxs("span",{children:[t.findings_count," findings"]})]})]})})},t.id))}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(F,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Hunt Sessions"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Start a new threat hunting session"}),e.jsxs("button",{onClick:()=>d(!0),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(H,{className:"w-4 h-4 inline mr-2"}),"Start Hunt"]})]})}),a==="mitre"&&e.jsx("div",{className:"space-y-4",children:V?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(v,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):I&&I.length>0?e.jsx("div",{className:"space-y-4",children:I.map(t=>e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:t.tactic_name}),e.jsxs("span",{className:"text-sm text-gray-400",children:[t.techniques.filter(u=>u.playbook_count>0).length," / ",t.techniques.length," covered"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:t.techniques.map(u=>e.jsxs("div",{className:`p-2 rounded-lg text-sm ${u.playbook_count>0?"bg-green-500/20 border border-green-500/30":"bg-gray-900 border border-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:u.playbook_count>0?"text-green-400":"text-gray-400",children:u.id}),u.playbook_count>0&&e.jsx("span",{className:"text-xs text-green-400",children:u.playbook_count})]}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:u.name})]},u.id))})]},t.tactic))}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(K,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Coverage Data"}),e.jsx("p",{className:"text-gray-400",children:"Create playbooks with MITRE mappings to see coverage"})]})}),a==="retrospective"&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(D,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"Retrospective Search"}),e.jsx("p",{className:"text-gray-400",children:"Search historical data for newly discovered IOCs"})]})]}),e.jsx(q,{isOpen:l,onClose:()=>i(!1),title:"Add Indicator of Compromise",children:e.jsx(xe,{onSubmit:t=>M.mutate(t),onCancel:()=>i(!1),isLoading:M.isPending})}),e.jsx(q,{isOpen:x,onClose:()=>d(!1),title:"Start Hunt Session",children:e.jsx(me,{playbooks:C||[],onSubmit:t=>P.mutate(t),onCancel:()=>d(!1),isLoading:P.isPending})}),e.jsx(q,{isOpen:!!h,onClose:()=>n(null),title:"Hunt Session Details",size:"lg",children:h&&e.jsx(ge,{session:h,onClose:()=>n(null)})})]})})}export{ve as default};
