import{j as e,u as v,e as _,f}from"./vendor-state-oFDmcCcB.js";import{r as p}from"./vendor-react-5KxtEOLM.js";import{S as V,aw as G,ap as D,y as P,F as k,e as R,bV as H,cK as q,b7 as X,aH as $,cL as F,Z as K,aa as w,b0 as Z,G as Y,Y as O,w as J,B as j,m as I,aO as E,ac as A,b2 as W,z as Q,bm as B,a0 as ee,g as z,i as se,p as te,X as S,aZ as ae,l as re,$ as le,a7 as ie}from"./vendor-ui-7EurIAWU.js";import{L as ne}from"./Layout-B2BPZquP.js";import{ai as y}from"./index-MDkiA-RQ.js";import"./vendor-markdown-BwTKtS0m.js";import"./vendor-utils-DfRopTPV.js";function Pe(){const[s,m]=p.useState("dashboard"),t=[{id:"dashboard",label:"Dashboard",icon:G},{id:"misp",label:"MISP",icon:D},{id:"taxii",label:"TAXII",icon:P},{id:"stix",label:"STIX Objects",icon:k},{id:"actors",label:"Threat Actors",icon:R},{id:"campaigns",label:"Campaigns",icon:H},{id:"diamond",label:"Diamond Model",icon:q},{id:"killchain",label:"Kill Chain",icon:X},{id:"requirements",label:"Intel Reqs",icon:$},{id:"briefings",label:"Briefings",icon:F},{id:"correlate",label:"IOC Correlation",icon:K}];return e.jsx(ne,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(V,{className:"h-7 w-7 text-cyan-400"}),"Threat Intelligence"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage MISP, TAXII feeds, STIX objects, and threat actor intelligence"})]})}),e.jsx("div",{className:"flex space-x-1 mb-6 bg-gray-800 rounded-lg p-1 w-fit",children:t.map(a=>e.jsxs("button",{onClick:()=>m(a.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${s===a.id?"bg-cyan-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:[e.jsx(a.icon,{className:"h-4 w-4"}),a.label]},a.id))}),s==="dashboard"&&e.jsx(ce,{}),s==="misp"&&e.jsx(de,{}),s==="taxii"&&e.jsx(me,{}),s==="stix"&&e.jsx(ue,{}),s==="actors"&&e.jsx(je,{}),s==="campaigns"&&e.jsx(Ne,{}),s==="diamond"&&e.jsx(we,{}),s==="killchain"&&e.jsx(Se,{}),s==="requirements"&&e.jsx(Ce,{}),s==="briefings"&&e.jsx(Ie,{}),s==="correlate"&&e.jsx(be,{})]})})}function ce(){var a,i,x,c,o,n,l,d,h;const{data:s,isLoading:m}=v({queryKey:["threat-intel-stats"],queryFn:()=>y.getStats()});if(m)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(w,{className:"h-8 w-8 text-cyan-400 animate-spin"})});const t=[{label:"MISP Servers",value:((a=s==null?void 0:s.data)==null?void 0:a.misp_servers)||0,icon:D,color:"cyan"},{label:"MISP Events",value:((i=s==null?void 0:s.data)==null?void 0:i.misp_events)||0,icon:k,color:"blue"},{label:"MISP Attributes",value:((x=s==null?void 0:s.data)==null?void 0:x.misp_attributes)||0,icon:Z,color:"purple"},{label:"TAXII Servers",value:((c=s==null?void 0:s.data)==null?void 0:c.taxii_servers)||0,icon:P,color:"green"},{label:"TAXII Collections",value:((o=s==null?void 0:s.data)==null?void 0:o.taxii_collections)||0,icon:Y,color:"yellow"},{label:"STIX Bundles",value:((n=s==null?void 0:s.data)==null?void 0:n.stix_bundles)||0,icon:k,color:"orange"},{label:"STIX Objects",value:((l=s==null?void 0:s.data)==null?void 0:l.stix_objects)||0,icon:O,color:"red"},{label:"Threat Actors",value:((d=s==null?void 0:s.data)==null?void 0:d.threat_actors)||0,icon:R,color:"pink"},{label:"Campaigns",value:((h=s==null?void 0:s.data)==null?void 0:h.campaigns)||0,icon:J,color:"indigo"}];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:t.map(r=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(r.icon,{className:`h-5 w-5 text-${r.color}-400`}),e.jsx("span",{className:"text-2xl font-bold text-white",children:r.value})]}),e.jsx("p",{className:"text-sm text-gray-400",children:r.label})]},r.label))})}function de(){var C,b;const s=_(),[m,t]=p.useState(!1),[a,i]=p.useState(null),[x,c]=p.useState(null),{data:o,isLoading:n}=v({queryKey:["misp-servers"],queryFn:()=>y.listMispServers()}),{data:l,isLoading:d}=v({queryKey:["misp-events"],queryFn:()=>y.listMispEvents({limit:50})}),h=f({mutationFn:u=>y.addMispServer(u),onSuccess:()=>{s.invalidateQueries({queryKey:["misp-servers"]}),t(!1),j.success("MISP server added successfully")},onError:()=>j.error("Failed to add MISP server")}),r=f({mutationFn:u=>y.deleteMispServer(u),onSuccess:()=>{s.invalidateQueries({queryKey:["misp-servers"]}),j.success("MISP server deleted")},onError:()=>j.error("Failed to delete MISP server")}),g=f({mutationFn:u=>y.testMispServer(u),onSuccess:u=>{u.data.success?j.success("Connection successful"):j.error(u.data.message||"Connection failed")},onError:()=>j.error("Connection test failed")}),N=f({mutationFn:u=>y.syncMispServer(u),onSuccess:u=>{s.invalidateQueries({queryKey:["misp-servers"]}),s.invalidateQueries({queryKey:["misp-events"]}),u.data.success?j.success(`Synced ${u.data.events_synced||0} events`):j.error(u.data.message||"Sync failed")},onError:()=>j.error("Sync failed")});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5 text-cyan-400"}),"MISP Servers"]}),e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg text-sm",children:[e.jsx(I,{className:"h-4 w-4"}),"Add Server"]})]}),e.jsx("div",{className:"p-4",children:n?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(C=o==null?void 0:o.data)!=null&&C.length?e.jsx("div",{className:"space-y-3",children:o.data.map(u=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${u.enabled?"bg-green-400":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:u.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:u.url})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("p",{className:"text-gray-400",children:["Events: ",u.events_synced]}),u.last_sync_at&&e.jsxs("p",{className:"text-gray-500 text-xs",children:["Last sync: ",new Date(u.last_sync_at).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>g.mutate(u.id),className:"p-1.5 text-gray-400 hover:text-cyan-400",title:"Test Connection",children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>N.mutate(u.id),className:"p-1.5 text-gray-400 hover:text-green-400",title:"Sync Events",children:e.jsx(w,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>i(u),className:"p-1.5 text-gray-400 hover:text-blue-400",title:"View Details",children:e.jsx(E,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>r.mutate(u.id),className:"p-1.5 text-gray-400 hover:text-red-400",title:"Delete",children:e.jsx(A,{className:"h-4 w-4"})})]})]})]},u.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No MISP servers configured"})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5 text-cyan-400"}),"Recent MISP Events"]})}),e.jsx("div",{className:"overflow-x-auto",children:d?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(b=l==null?void 0:l.data)!=null&&b.length?e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-400 text-sm border-b border-gray-700",children:[e.jsx("th",{className:"p-3",children:"Event"}),e.jsx("th",{className:"p-3",children:"Organization"}),e.jsx("th",{className:"p-3",children:"Threat Level"}),e.jsx("th",{className:"p-3",children:"Attributes"}),e.jsx("th",{className:"p-3",children:"Date"}),e.jsx("th",{className:"p-3",children:"Actions"})]})}),e.jsx("tbody",{children:l.data.map(u=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"p-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium truncate max-w-md",children:u.info}),e.jsx("p",{className:"text-gray-500 text-xs",children:u.misp_uuid})]})}),e.jsx("td",{className:"p-3 text-gray-300",children:u.org_name}),e.jsx("td",{className:"p-3",children:e.jsx(L,{level:u.threat_level})}),e.jsx("td",{className:"p-3 text-gray-300",children:u.attribute_count}),e.jsx("td",{className:"p-3 text-gray-400 text-sm",children:u.date}),e.jsx("td",{className:"p-3",children:e.jsx("button",{onClick:()=>c(u),className:"p-1.5 text-gray-400 hover:text-cyan-400",children:e.jsx(E,{className:"h-4 w-4"})})})]},u.id))})]}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No events synced yet"})})]}),m&&e.jsx(xe,{onClose:()=>t(!1),onSubmit:u=>h.mutate(u),isLoading:h.isPending}),x&&e.jsx(oe,{event:x,onClose:()=>c(null)})]})}function L({level:s}){const m={1:"bg-red-900 text-red-300",2:"bg-orange-900 text-orange-300",3:"bg-yellow-900 text-yellow-300",4:"bg-gray-700 text-gray-300"},t={1:"High",2:"Medium",3:"Low",4:"Undefined"};return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${m[s]||m[4]}`,children:t[s]||"Unknown"})}function xe({onClose:s,onSubmit:m,isLoading:t}){const[a,i]=p.useState(""),[x,c]=p.useState(""),[o,n]=p.useState("");return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-md border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Add MISP Server"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Server Name"}),e.jsx("input",{type:"text",value:a,onChange:l=>i(l.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"My MISP Server"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"URL"}),e.jsx("input",{type:"url",value:x,onChange:l=>c(l.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"https://misp.example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"API Key"}),e.jsx("input",{type:"password",value:o,onChange:l=>n(l.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"MISP API Key"})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-400 hover:text-white",children:"Cancel"}),e.jsx("button",{onClick:()=>m({name:a,url:x,api_key:o}),disabled:t||!a||!x||!o,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:t?"Adding...":"Add Server"})]})]})})}function oe({event:s,onClose:m}){var a;const{data:t}=v({queryKey:["misp-event-attributes",s.id],queryFn:()=>y.getMispEventAttributes(s.id)});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-4xl max-h-[80vh] overflow-hidden border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.info}),e.jsx("p",{className:"text-gray-400 text-sm",children:s.misp_uuid})]}),e.jsx("button",{onClick:m,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Organization"}),e.jsx("p",{className:"text-white",children:s.org_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Date"}),e.jsx("p",{className:"text-white",children:s.date})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Threat Level"}),e.jsx(L,{level:s.threat_level})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Published"}),e.jsx("p",{className:"text-white",children:s.published?"Yes":"No"})]})]}),s.tags.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map((i,x)=>e.jsx("span",{className:"px-2 py-1 bg-gray-700 rounded text-xs text-gray-300",children:i},x))})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-400 text-sm mb-2",children:["Attributes (",s.attribute_count,")"]}),(a=t==null?void 0:t.data)!=null&&a.length?e.jsxs("div",{className:"space-y-2",children:[t.data.slice(0,20).map(i=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-900 rounded",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:i.attr_type}),e.jsx("span",{className:"text-gray-300 font-mono text-sm truncate",children:i.value}),i.to_ids&&e.jsx("span",{className:"px-2 py-0.5 bg-red-900 text-red-300 rounded text-xs",children:"IDS"})]},i.id)),t.data.length>20&&e.jsxs("p",{className:"text-gray-500 text-sm text-center",children:["And ",t.data.length-20," more..."]})]}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Loading attributes..."})]})]})]})})}function me(){var d;const s=_(),[m,t]=p.useState(!1),[a,i]=p.useState(null),{data:x,isLoading:c}=v({queryKey:["taxii-servers"],queryFn:()=>y.listTaxiiServers()}),o=f({mutationFn:h=>y.addTaxiiServer(h),onSuccess:()=>{s.invalidateQueries({queryKey:["taxii-servers"]}),t(!1),j.success("TAXII server added successfully")},onError:()=>j.error("Failed to add TAXII server")}),n=f({mutationFn:h=>y.deleteTaxiiServer(h),onSuccess:()=>{s.invalidateQueries({queryKey:["taxii-servers"]}),j.success("TAXII server deleted")},onError:()=>j.error("Failed to delete TAXII server")}),l=f({mutationFn:h=>y.discoverTaxiiCollections(h),onSuccess:(h,r)=>{s.invalidateQueries({queryKey:["taxii-collections",r]}),h.data.success?j.success(`Discovered ${h.data.collections_found||0} collections`):j.error("Discovery failed")},onError:()=>j.error("Discovery failed")});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-cyan-400"}),"TAXII Servers"]}),e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg text-sm",children:[e.jsx(I,{className:"h-4 w-4"}),"Add Server"]})]}),e.jsx("div",{className:"p-4",children:c?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(d=x==null?void 0:x.data)!=null&&d.length?e.jsx("div",{className:"space-y-3",children:x.data.map(h=>e.jsx(he,{server:h,expanded:a===h.id,onToggle:()=>i(a===h.id?null:h.id),onDiscover:()=>l.mutate(h.id),onDelete:()=>n.mutate(h.id)},h.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No TAXII servers configured"})})]}),m&&e.jsx(ge,{onClose:()=>t(!1),onSubmit:h=>o.mutate(h),isLoading:o.isPending})]})}function he({server:s,expanded:m,onToggle:t,onDiscover:a,onDelete:i}){var n;const x=_(),{data:c}=v({queryKey:["taxii-collections",s.id],queryFn:()=>y.listTaxiiCollections(s.id),enabled:m}),o=f({mutationFn:l=>y.pollTaxiiCollection(s.id,l),onSuccess:l=>{x.invalidateQueries({queryKey:["taxii-collections",s.id]}),l.data.success&&j.success(`Retrieved ${l.data.objects_retrieved||0} objects`)},onError:()=>j.error("Poll failed")});return e.jsxs("div",{className:"bg-gray-900 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 cursor-pointer hover:bg-gray-800",onClick:t,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[m?e.jsx(re,{className:"h-4 w-4 text-gray-400"}):e.jsx(le,{className:"h-4 w-4 text-gray-400"}),e.jsx("div",{className:`w-3 h-3 rounded-full ${s.enabled?"bg-green-400":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:s.url})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-xs text-gray-500 bg-gray-700 px-2 py-1 rounded",children:["TAXII ",s.version]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Objects: ",s.objects_synced]}),e.jsxs("div",{className:"flex items-center gap-2",onClick:l=>l.stopPropagation(),children:[e.jsx("button",{onClick:a,className:"p-1.5 text-gray-400 hover:text-cyan-400",title:"Discover Collections",children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-red-400",title:"Delete",children:e.jsx(A,{className:"h-4 w-4"})})]})]})]}),m&&e.jsxs("div",{className:"border-t border-gray-700 p-3",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Collections"}),(n=c==null?void 0:c.data)!=null&&n.length?e.jsx("div",{className:"space-y-2",children:c.data.map(l=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-800 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm",children:l.title}),e.jsx("p",{className:"text-gray-500 text-xs",children:l.collection_id})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-gray-400 text-xs",children:[l.objects_count," objects"]}),l.can_read&&e.jsx("button",{onClick:()=>o.mutate(l.collection_id),className:"p-1.5 text-gray-400 hover:text-green-400",title:"Poll Collection",children:e.jsx(ie,{className:"h-4 w-4"})})]})]},l.id))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No collections found. Click discover to fetch."})]})]})}function ge({onClose:s,onSubmit:m,isLoading:t}){const[a,i]=p.useState(""),[x,c]=p.useState(""),[o,n]=p.useState(""),[l,d]=p.useState(""),[h,r]=p.useState("2.1");return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-md border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Add TAXII Server"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Server Name"}),e.jsx("input",{type:"text",value:a,onChange:g=>i(g.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"CIRCL TAXII"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"URL"}),e.jsx("input",{type:"url",value:x,onChange:g=>c(g.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"https://limo.anomali.com/api/v1/taxii2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Version"}),e.jsxs("select",{value:h,onChange:g=>r(g.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"2.1",children:"TAXII 2.1"}),e.jsx("option",{value:"2.0",children:"TAXII 2.0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Username (optional)"}),e.jsx("input",{type:"text",value:o,onChange:g=>n(g.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Password (optional)"}),e.jsx("input",{type:"password",value:l,onChange:g=>d(g.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white"})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-400 hover:text-white",children:"Cancel"}),e.jsx("button",{onClick:()=>m({name:a,url:x,username:o||void 0,password:l||void 0,version:h}),disabled:t||!a||!x,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:t?"Adding...":"Add Server"})]})]})})}function ue(){var h;const s=_(),[m,t]=p.useState(!1),[a,i]=p.useState(null),[x,c]=p.useState(""),{data:o,isLoading:n}=v({queryKey:["stix-bundles"],queryFn:()=>y.listStixBundles({limit:50})}),{data:l}=v({queryKey:["stix-objects",x],queryFn:()=>y.listStixObjects({type:x||void 0,limit:100})}),d=["indicator","malware","threat-actor","attack-pattern","campaign","identity","tool","vulnerability"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5 text-cyan-400"}),"STIX Bundles"]}),e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg text-sm",children:[e.jsx(W,{className:"h-4 w-4"}),"Import Bundle"]})]}),e.jsx("div",{className:"p-4",children:n?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(h=o==null?void 0:o.data)!=null&&h.length?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.data.map(r=>e.jsxs("div",{className:"p-4 bg-gray-900 rounded-lg cursor-pointer hover:bg-gray-700",onClick:()=>i(r),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"text-white font-medium",children:r.name}),e.jsx("span",{className:"text-xs text-gray-500",children:r.spec_version})]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Source: ",r.source]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[r.objects_count," objects"]}),e.jsx("p",{className:"text-gray-500 text-xs mt-2",children:new Date(r.created_at).toLocaleDateString()})]},r.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No STIX bundles imported"})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5 text-cyan-400"}),"STIX Objects"]}),e.jsxs("select",{value:x,onChange:r=>c(r.target.value),className:"bg-gray-900 border border-gray-600 rounded-lg px-3 py-1.5 text-white text-sm",children:[e.jsx("option",{value:"",children:"All Types"}),d.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-400 text-sm border-b border-gray-700",children:[e.jsx("th",{className:"p-3",children:"Type"}),e.jsx("th",{className:"p-3",children:"Name"}),e.jsx("th",{className:"p-3",children:"STIX ID"}),e.jsx("th",{className:"p-3",children:"Created"})]})}),e.jsx("tbody",{children:l==null?void 0:l.map(r=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"p-3",children:e.jsx("span",{className:"px-2 py-1 bg-cyan-900 text-cyan-300 rounded text-xs",children:r.stix_type})}),e.jsx("td",{className:"p-3 text-white",children:r.name||"-"}),e.jsx("td",{className:"p-3 text-gray-400 font-mono text-xs truncate max-w-xs",children:r.stix_id}),e.jsx("td",{className:"p-3 text-gray-400 text-sm",children:new Date(r.created).toLocaleDateString()})]},r.id))})]})})]}),m&&e.jsx(pe,{onClose:()=>t(!1),onSuccess:()=>{s.invalidateQueries({queryKey:["stix-bundles"]}),s.invalidateQueries({queryKey:["stix-objects"]})}}),a&&e.jsx(ye,{bundle:a,onClose:()=>i(null)})]})}function pe({onClose:s,onSuccess:m}){const[t,a]=p.useState(""),[i,x]=p.useState(""),c=f({mutationFn:o=>y.importStixBundle(o),onSuccess:o=>{o.data.success?(j.success(`Imported ${o.data.objects_imported||0} objects`),m(),s()):j.error("Import failed")},onError:()=>j.error("Import failed")});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-2xl border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Import STIX Bundle"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Bundle Name"}),e.jsx("input",{type:"text",value:t,onChange:o=>a(o.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"My STIX Bundle"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"STIX 2.1 JSON"}),e.jsx("textarea",{value:i,onChange:o=>x(o.target.value),className:"w-full h-64 bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white font-mono text-sm",placeholder:'{"type": "bundle", "id": "bundle--...", "objects": [...]}'})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-400 hover:text-white",children:"Cancel"}),e.jsx("button",{onClick:()=>c.mutate({name:t,content:i}),disabled:c.isPending||!t||!i,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:c.isPending?"Importing...":"Import"})]})]})})}function ye({bundle:s,onClose:m}){var i,x;const{data:t}=v({queryKey:["stix-bundle-objects",s.id],queryFn:()=>y.getStixBundleObjects(s.id,{limit:100})}),a=(i=t==null?void 0:t.data)==null?void 0:i.reduce((c,o)=>(c[o.stix_type]=(c[o.stix_type]||0)+1,c),{});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-4xl max-h-[80vh] overflow-hidden border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[s.objects_count," objects | STIX ",s.spec_version]})]}),e.jsx("button",{onClick:m,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:[a&&e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"Object Types"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(a).map(([c,o])=>e.jsxs("span",{className:"px-3 py-1 bg-gray-700 rounded-full text-sm text-gray-300",children:[c,": ",o]},c))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"Objects"}),e.jsx("div",{className:"space-y-2",children:(x=t==null?void 0:t.data)==null?void 0:x.slice(0,50).map(c=>e.jsxs("div",{className:"p-3 bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:c.stix_type}),e.jsx("span",{className:"text-gray-500 text-xs",children:c.stix_id})]}),c.name&&e.jsx("p",{className:"text-white",children:c.name}),c.description&&e.jsx("p",{className:"text-gray-400 text-sm mt-1 line-clamp-2",children:c.description})]},c.id))})]})]})]})})}function je(){var h;const[s,m]=p.useState(""),[t,a]=p.useState(null),[i,x]=p.useState({actor_type:"",motivation:"",active_only:!1}),{data:c,isLoading:o}=v({queryKey:["threat-actors",i,s],queryFn:()=>y.listThreatActors({...i,name:s||void 0,limit:50})}),{data:n}=v({queryKey:["threat-actor",t],queryFn:()=>y.getThreatActor(t),enabled:!!t}),l=["espionage","financial","destruction","hacktivism","unknown"],d=["nation-state","crime-syndicate","hacktivist","insider","terrorist"];return e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-1 bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("div",{className:"flex items-center gap-4 mb-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:s,onChange:r=>m(r.target.value),placeholder:"Search threat actors...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg pl-10 pr-3 py-2 text-white"})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:i.actor_type,onChange:r=>x({...i,actor_type:r.target.value}),className:"bg-gray-900 border border-gray-600 rounded-lg px-3 py-1.5 text-white text-sm",children:[e.jsx("option",{value:"",children:"All Types"}),d.map(r=>e.jsx("option",{value:r,children:r},r))]}),e.jsxs("select",{value:i.motivation,onChange:r=>x({...i,motivation:r.target.value}),className:"bg-gray-900 border border-gray-600 rounded-lg px-3 py-1.5 text-white text-sm",children:[e.jsx("option",{value:"",children:"All Motivations"}),l.map(r=>e.jsx("option",{value:r,children:r},r))]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx("input",{type:"checkbox",checked:i.active_only,onChange:r=>x({...i,active_only:r.target.checked}),className:"rounded border-gray-600"}),"Active only"]})]})]}),e.jsx("div",{className:"overflow-y-auto max-h-[600px]",children:o?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(h=c==null?void 0:c.data)!=null&&h.length?e.jsx("div",{className:"divide-y divide-gray-700",children:c.data.map(r=>e.jsxs("div",{className:`p-4 cursor-pointer hover:bg-gray-700/50 ${t===r.id?"bg-gray-700":""}`,onClick:()=>a(r.id),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-white font-medium",children:r.name}),r.active&&e.jsx("span",{className:"px-1.5 py-0.5 bg-green-900 text-green-300 rounded text-xs",children:"Active"})]}),r.aliases.length>0&&e.jsxs("p",{className:"text-gray-500 text-sm",children:["AKA: ",r.aliases.slice(0,3).join(", ")]})]}),e.jsx(M,{level:r.sophistication})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[e.jsx("span",{className:"text-gray-400",children:r.actor_type}),r.country&&e.jsxs("span",{className:"flex items-center gap-1 text-gray-400",children:[e.jsx(B,{className:"h-3 w-3"}),r.country]}),e.jsx("span",{className:"text-gray-400",children:r.motivation})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:r.target_sectors.slice(0,4).map((g,N)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-300",children:g},N))})]},r.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No threat actors found"})})]}),t&&(n==null?void 0:n.data)&&e.jsxs("div",{className:"w-96 bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:n.data.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:n.data.actor_type}),n.data.country&&e.jsxs("span",{className:"flex items-center gap-1 text-gray-400 text-sm",children:[e.jsx(B,{className:"h-3 w-3"}),n.data.country]})]})]}),e.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto max-h-[500px]",children:[n.data.description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Description"}),e.jsx("p",{className:"text-gray-300 text-sm",children:n.data.description})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Motivation"}),e.jsx("p",{className:"text-white",children:n.data.motivation})]}),n.data.aliases.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Aliases"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:n.data.aliases.map((r,g)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-300",children:r},g))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Sophistication"}),e.jsx(M,{level:n.data.sophistication})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Resource Level"}),e.jsx(M,{level:n.data.resource_level})]})]}),n.data.first_seen&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"First Seen"}),e.jsx("p",{className:"text-white text-sm",children:n.data.first_seen})]}),n.data.last_seen&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Last Seen"}),e.jsx("p",{className:"text-white text-sm",children:n.data.last_seen})]})]}),n.data.target_sectors.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Target Sectors"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:n.data.target_sectors.map((r,g)=>e.jsx("span",{className:"px-2 py-0.5 bg-red-900 text-red-300 rounded text-xs",children:r},g))})]}),n.data.ttps.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"TTPs (MITRE ATT&CK)"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:n.data.ttps.slice(0,10).map((r,g)=>e.jsx("span",{className:"px-2 py-0.5 bg-purple-900 text-purple-300 rounded text-xs font-mono",children:r},g))})]}),n.data.tools.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Tools"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:n.data.tools.map((r,g)=>e.jsx("span",{className:"px-2 py-0.5 bg-blue-900 text-blue-300 rounded text-xs",children:r},g))})]}),n.data.malware.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Malware"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:n.data.malware.map((r,g)=>e.jsx("span",{className:"px-2 py-0.5 bg-orange-900 text-orange-300 rounded text-xs",children:r},g))})]}),n.data.external_references.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"References"}),e.jsx("div",{className:"space-y-1",children:n.data.external_references.slice(0,5).map((r,g)=>r.url?e.jsxs("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-cyan-400 text-sm hover:underline",children:[e.jsx(ee,{className:"h-3 w-3"}),r.source]},g):e.jsx("span",{className:"flex items-center gap-2 text-gray-500 text-sm",children:r.source},g))})]})]})]})]})}function M({level:s}){const m=["bg-gray-700 text-gray-300","bg-green-900 text-green-300","bg-yellow-900 text-yellow-300","bg-orange-900 text-orange-300","bg-red-900 text-red-300"],t=["Minimal","Low","Intermediate","Advanced","Expert"],a=Math.min(Math.max(0,s),4);return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${m[a]}`,children:t[a]})}function be(){var C;const[s,m]=p.useState("manual"),[t,a]=p.useState([]),[i,x]=p.useState("ip"),[c,o]=p.useState(""),[n,l]=p.useState(""),d=f({mutationFn:b=>y.correlateIocs(b),onSuccess:()=>{j.success("Correlation complete")},onError:()=>j.error("Correlation failed")}),h=()=>{c&&(a([...t,{ioc_type:i,value:c}]),o(""))},r=b=>{a(t.filter((u,U)=>U!==b))},g=()=>{s==="manual"&&t.length>0?d.mutate({iocs:t}):s==="scan"&&n&&d.mutate({scan_id:n})},N=["ip","domain","hash","url","email"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-cyan-400"}),"IOC Correlation"]}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>m("manual"),className:`px-4 py-2 rounded-lg ${s==="manual"?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Manual IOCs"}),e.jsx("button",{onClick:()=>m("scan"),className:`px-4 py-2 rounded-lg ${s==="scan"?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"From Scan"})]}),s==="manual"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("select",{value:i,onChange:b=>x(b.target.value),className:"bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",children:N.map(b=>e.jsx("option",{value:b,children:b.toUpperCase()},b))}),e.jsx("input",{type:"text",value:c,onChange:b=>o(b.target.value),placeholder:"Enter IOC value...",className:"flex-1 bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",onKeyDown:b=>b.key==="Enter"&&h()}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg",children:e.jsx(I,{className:"h-4 w-4"})})]}),t.length>0&&e.jsx("div",{className:"space-y-2",children:t.map((b,u)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:b.ioc_type}),e.jsx("span",{className:"text-white font-mono text-sm",children:b.value})]}),e.jsx("button",{onClick:()=>r(u),className:"text-gray-400 hover:text-red-400",children:e.jsx(S,{className:"h-4 w-4"})})]},u))})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Scan ID"}),e.jsx("input",{type:"text",value:n,onChange:b=>l(b.target.value),placeholder:"Enter scan ID to correlate IOCs from...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white"})]}),e.jsx("button",{onClick:g,disabled:d.isPending||s==="manual"&&t.length===0||s==="scan"&&!n,className:"mt-6 flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:d.isPending?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"h-4 w-4 animate-spin"}),"Correlating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-4 w-4"}),"Run Correlation"]})})]}),((C=d.data)==null?void 0:C.data)&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4",children:["Results: ",d.data.data.correlations_found," correlations found"]}),d.data.data.correlations.length===0?e.jsx("p",{className:"text-gray-400",children:"No correlations found in threat intelligence sources."}):e.jsx("div",{className:"space-y-3",children:d.data.data.correlations.map((b,u)=>e.jsxs("div",{className:"p-3 bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:b.ioc_type}),e.jsx("span",{className:"text-white font-mono text-sm",children:b.ioc_value})]}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["Confidence: ",(b.confidence*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-gray-400",children:["Source: ",e.jsx("span",{className:"text-white",children:b.source_type})]}),e.jsxs("span",{className:"text-gray-400",children:["Reference: ",e.jsx("span",{className:"text-white",children:b.source_name})]}),b.threat_level&&e.jsx(L,{level:b.threat_level})]})]},u))})]})]})}function Ne(){const s=_(),[m,t]=p.useState(!1),[a,i]=p.useState(null),{data:x,isLoading:c}=v({queryKey:["threat-campaigns"],queryFn:()=>y.listCampaigns()}),o=f({mutationFn:l=>y.deleteCampaign(l),onSuccess:()=>{s.invalidateQueries({queryKey:["threat-campaigns"]}),j.success("Campaign deleted")},onError:()=>j.error("Failed to delete campaign")}),n=l=>({active:"bg-red-900 text-red-300",suspected:"bg-yellow-900 text-yellow-300",historical:"bg-gray-700 text-gray-300",attributed:"bg-blue-900 text-blue-300"})[l]||"bg-gray-700 text-gray-300";return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(w,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Threat Campaigns"}),e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700",children:[e.jsx(I,{className:"h-4 w-4"}),"Add Campaign"]})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Name"}),e.jsx("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Actor"}),e.jsx("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-gray-400 font-medium",children:"First Seen"}),e.jsx("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Last Seen"}),e.jsx("th",{className:"text-right p-4 text-gray-400 font-medium",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700",children:[x==null?void 0:x.map(l=>e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"p-4",children:e.jsx("button",{onClick:()=>i(l),className:"text-cyan-400 hover:text-cyan-300 font-medium",children:l.name})}),e.jsx("td",{className:"p-4 text-gray-300",children:l.threat_actor_id||"-"}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${n(l.status)}`,children:l.status})}),e.jsx("td",{className:"p-4 text-gray-400 text-sm",children:l.first_seen?new Date(l.first_seen).toLocaleDateString():"-"}),e.jsx("td",{className:"p-4 text-gray-400 text-sm",children:l.last_seen?new Date(l.last_seen).toLocaleDateString():"-"}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("button",{onClick:()=>o.mutate(l.id),className:"p-2 text-gray-400 hover:text-red-400",children:e.jsx(A,{className:"h-4 w-4"})})})]},l.id)),(!x||x.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-8 text-center text-gray-400",children:"No campaigns found. Add your first campaign to start tracking threat activity."})})]})]})}),m&&e.jsx(ve,{onClose:()=>t(!1),onSuccess:()=>{s.invalidateQueries({queryKey:["threat-campaigns"]}),t(!1)}}),a&&e.jsx(fe,{campaign:a,onClose:()=>i(null)})]})}function ve({onClose:s,onSuccess:m}){const[t,a]=p.useState(""),[i,x]=p.useState(""),[c,o]=p.useState("suspected"),n=f({mutationFn:()=>y.createCampaign({name:t,description:i,status:c}),onSuccess:()=>{j.success("Campaign created"),m()},onError:()=>j.error("Failed to create campaign")});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-lg border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Add Campaign"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:t,onChange:l=>a(l.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",placeholder:"Campaign name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("textarea",{value:i,onChange:l=>x(l.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white h-24",placeholder:"Campaign description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Status"}),e.jsxs("select",{value:c,onChange:l=>o(l.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"suspected",children:"Suspected"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"historical",children:"Historical"}),e.jsx("option",{value:"attributed",children:"Attributed"})]})]}),e.jsx("button",{onClick:()=>n.mutate(),disabled:!t||n.isPending,className:"w-full bg-cyan-600 text-white py-2 rounded-lg hover:bg-cyan-700 disabled:opacity-50",children:n.isPending?"Creating...":"Create Campaign"})]})]})})}function fe({campaign:s,onClose:m}){var i,x,c,o,n,l;const{data:t,isLoading:a}=v({queryKey:["campaign-detail",s.id],queryFn:()=>y.getCampaign(s.id)});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-3xl border border-gray-700 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.name}),e.jsx("button",{onClick:m,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),a?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("p",{className:"text-white",children:((i=t==null?void 0:t.data)==null?void 0:i.description)||"No description"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Status"}),e.jsx("p",{className:"text-white capitalize",children:(x=t==null?void 0:t.data)==null?void 0:x.status})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Confidence"}),e.jsxs("p",{className:"text-white",children:[((c=t==null?void 0:t.data)==null?void 0:c.confidence)||0,"%"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Threat Actor"}),e.jsx("p",{className:"text-white",children:((o=t==null?void 0:t.data)==null?void 0:o.threat_actor_name)||"Unknown"})]})]}),((n=t==null?void 0:t.data)==null?void 0:n.ttps)&&t.data.ttps.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-2",children:"TTPs"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.data.ttps.map(d=>e.jsx("span",{className:"px-2 py-1 bg-purple-900 text-purple-300 rounded text-sm",children:d},d))})]}),((l=t==null?void 0:t.data)==null?void 0:l.iocs)&&t.data.iocs.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm text-gray-400 mb-2",children:["IOCs (",t.data.iocs.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:t.data.iocs.map((d,h)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:d.ioc_type}),e.jsx("span",{className:"text-white font-mono",children:d.value})]},h))})]})]})]})})}function we(){_();const[s,m]=p.useState(!1),{data:t,isLoading:a}=v({queryKey:["diamond-events"],queryFn:()=>y.listDiamondEvents({limit:50})});return a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(w,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Diamond Model Events"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Analyze intrusions using Adversary, Capability, Infrastructure, and Victim vertices"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700",children:[e.jsx(I,{className:"h-4 w-4"}),"Add Event"]})]}),e.jsxs("div",{className:"grid gap-4",children:[t==null?void 0:t.map(i=>e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:"h-5 w-5 text-cyan-400"}),e.jsxs("span",{className:"text-white font-medium",children:["Event ",i.id.slice(0,8)]}),i.phase&&e.jsx("span",{className:"px-2 py-0.5 bg-purple-900 text-purple-300 rounded text-xs",children:i.phase})]}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["Confidence: ",i.confidence,"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(T,{label:"Adversary",vertex:i.adversary,color:"red"}),e.jsx(T,{label:"Capability",vertex:i.capability,color:"yellow"}),e.jsx(T,{label:"Infrastructure",vertex:i.infrastructure,color:"blue"}),e.jsx(T,{label:"Victim",vertex:i.victim,color:"green"})]}),i.notes&&e.jsx("p",{className:"mt-3 text-sm text-gray-400",children:i.notes})]},i.id)),(!t||t.length===0)&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-8 text-center",children:[e.jsx(q,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No Diamond Model events recorded yet."}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create your first event to start analyzing intrusions."})]})]})]})}function T({label:s,vertex:m,color:t}){const a={red:"border-red-500 bg-red-900/20",yellow:"border-yellow-500 bg-yellow-900/20",blue:"border-blue-500 bg-blue-900/20",green:"border-green-500 bg-green-900/20"};return e.jsxs("div",{className:`p-3 rounded-lg border ${a[t]}`,children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s}),e.jsx("div",{className:"text-white font-medium",children:m.name||"Unknown"}),m.vertex_type&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:m.vertex_type})]})}function Se(){var o,n,l,d,h,r;const[s,m]=p.useState(""),{data:t}=v({queryKey:["threat-campaigns"],queryFn:()=>y.listCampaigns()}),{data:a,isLoading:i}=v({queryKey:["kill-chain",s],queryFn:()=>y.getKillChainAnalysis(s),enabled:!!s}),{data:x}=v({queryKey:["kill-chain-phases"],queryFn:()=>y.getKillChainPhases()}),c={recon:"bg-blue-600",weaponization:"bg-purple-600",delivery:"bg-yellow-600",exploitation:"bg-orange-600",installation:"bg-red-600",c2:"bg-pink-600",actions:"bg-gray-600"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Cyber Kill Chain Analysis"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Visualize attack progression through Lockheed Martin's Cyber Kill Chain"})]}),e.jsxs("select",{value:s,onChange:g=>m(g.target.value),className:"bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"",children:"Select a campaign"}),t==null?void 0:t.map(g=>e.jsx("option",{value:g.id,children:g.name},g.id))]})]}),s?i?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-white font-medium",children:(o=a==null?void 0:a.data)==null?void 0:o.campaign_name}),e.jsxs("div",{className:"text-cyan-400 text-lg font-bold",children:[(l=(n=a==null?void 0:a.data)==null?void 0:n.coverage)==null?void 0:l.toFixed(0),"% Coverage"]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-cyan-500 h-2 rounded-full",style:{width:`${((d=a==null?void 0:a.data)==null?void 0:d.coverage)||0}%`}})})]}),e.jsx("div",{className:"flex gap-1",children:(r=(h=a==null?void 0:a.data)==null?void 0:h.phases)==null?void 0:r.map(g=>e.jsxs("div",{className:`flex-1 rounded-lg p-4 ${c[g.phase]||"bg-gray-600"} bg-opacity-30 border border-gray-700`,children:[e.jsxs("div",{className:"text-xs text-gray-400 mb-1",children:["Phase ",g.order]}),e.jsx("div",{className:"text-white font-medium mb-2",children:g.phase_name}),e.jsx("div",{className:"text-sm",children:g.techniques.length>0?e.jsxs("div",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(z,{className:"h-4 w-4"}),g.techniques.length," detected"]}):e.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx(se,{className:"h-4 w-4"}),"No activity"]})})]},g.phase))})]}):e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-8 text-center",children:[e.jsx(X,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Select a campaign to view its Kill Chain analysis"})]})]})}function Ce(){const s=_(),[m,t]=p.useState(!1),[a,i]=p.useState("all"),{data:x,isLoading:c}=v({queryKey:["intel-requirements",a],queryFn:()=>y.listIntelRequirements(a!=="all"?{status:a}:void 0)}),o=f({mutationFn:d=>y.deleteIntelRequirement(d),onSuccess:()=>{s.invalidateQueries({queryKey:["intel-requirements"]}),j.success("Requirement deleted")}}),n=d=>({critical:"bg-red-900 text-red-300",high:"bg-orange-900 text-orange-300",medium:"bg-yellow-900 text-yellow-300",low:"bg-blue-900 text-blue-300"})[d]||"bg-gray-700 text-gray-300",l=d=>({open:"bg-blue-900 text-blue-300",in_progress:"bg-yellow-900 text-yellow-300",answered:"bg-green-900 text-green-300",closed:"bg-gray-700 text-gray-300"})[d]||"bg-gray-700 text-gray-300";return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(w,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Intelligence Requirements"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Track strategic, operational, and tactical intelligence needs"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:a,onChange:d=>i(d.target.value),className:"bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"answered",children:"Answered"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700",children:[e.jsx(I,{className:"h-4 w-4"}),"Add Requirement"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[x==null?void 0:x.map(d=>e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${n(d.priority)}`,children:d.priority}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${l(d.status)}`,children:d.status.replace("_"," ")}),e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs capitalize",children:d.category})]}),e.jsx("button",{onClick:()=>o.mutate(d.id),className:"p-1 text-gray-400 hover:text-red-400",children:e.jsx(A,{className:"h-4 w-4"})})]}),e.jsx("h3",{className:"text-white font-medium mb-1",children:d.title}),d.description&&e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:d.description}),d.deadline&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[e.jsx(te,{className:"h-4 w-4"}),"Due: ",new Date(d.deadline).toLocaleDateString()]}),d.answer&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-900 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Answer"}),e.jsx("p",{className:"text-white text-sm",children:d.answer})]})]},d.id)),(!x||x.length===0)&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-8 text-center",children:[e.jsx($,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No intelligence requirements found."})]})]}),m&&e.jsx(_e,{onClose:()=>t(!1),onSuccess:()=>{s.invalidateQueries({queryKey:["intel-requirements"]}),t(!1)}})]})}function _e({onClose:s,onSuccess:m}){const[t,a]=p.useState(""),[i,x]=p.useState(""),[c,o]=p.useState("medium"),[n,l]=p.useState("operational"),d=f({mutationFn:()=>y.createIntelRequirement({title:t,description:i,priority:c,category:n}),onSuccess:()=>{j.success("Requirement created"),m()},onError:()=>j.error("Failed to create requirement")});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-lg border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Add Intelligence Requirement"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:t,onChange:h=>a(h.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",placeholder:"What do you need to know?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("textarea",{value:i,onChange:h=>x(h.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white h-24",placeholder:"Additional context..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Priority"}),e.jsxs("select",{value:c,onChange:h=>o(h.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Category"}),e.jsxs("select",{value:n,onChange:h=>l(h.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"strategic",children:"Strategic"}),e.jsx("option",{value:"operational",children:"Operational"}),e.jsx("option",{value:"tactical",children:"Tactical"})]})]})]}),e.jsx("button",{onClick:()=>d.mutate(),disabled:!t||d.isPending,className:"w-full bg-cyan-600 text-white py-2 rounded-lg hover:bg-cyan-700 disabled:opacity-50",children:d.isPending?"Creating...":"Create Requirement"})]})]})})}function Ie(){var o,n,l,d,h,r,g;const s=_(),[m,t]=p.useState(30),{data:a,isLoading:i}=v({queryKey:["latest-briefing"],queryFn:()=>y.getLatestBriefing()}),x=f({mutationFn:()=>y.generateThreatBriefing({period_days:m}),onSuccess:()=>{s.invalidateQueries({queryKey:["latest-briefing"]}),j.success("Briefing generated successfully")},onError:()=>j.error("Failed to generate briefing")}),c=N=>({critical:"text-red-400",high:"text-orange-400",medium:"text-yellow-400",low:"text-green-400"})[N]||"text-gray-400";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Threat Briefings"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Generate executive-level threat intelligence briefings"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:m,onChange:N=>t(Number(N.target.value)),className:"bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:7,children:"Last 7 days"}),e.jsx("option",{value:30,children:"Last 30 days"}),e.jsx("option",{value:90,children:"Last 90 days"})]}),e.jsxs("button",{onClick:()=>x.mutate(),disabled:x.isPending,className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 disabled:opacity-50",children:[x.isPending?e.jsx(w,{className:"h-4 w-4 animate-spin"}):e.jsx(F,{className:"h-4 w-4"}),"Generate Briefing"]})]})]}),i?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):a!=null&&a.data?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:a.data.title}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Period: ",new Date(a.data.period_start).toLocaleDateString()," - ",new Date(a.data.period_end).toLocaleDateString()]})]}),e.jsxs("div",{className:`text-lg font-bold ${c(((o=a.data.risk_assessment)==null?void 0:o.overall_risk)||"medium")}`,children:[(l=(n=a.data.risk_assessment)==null?void 0:n.overall_risk)==null?void 0:l.toUpperCase()," RISK"]})]}),e.jsx("div",{className:"prose prose-invert max-w-none",children:e.jsx("p",{className:"text-gray-300",children:a.data.executive_summary})})]}),a.data.threat_landscape&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Threat Landscape"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[((d=a.data.threat_landscape.trending_ttps)==null?void 0:d.length)>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Trending TTPs"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.data.threat_landscape.trending_ttps.map(N=>e.jsx("span",{className:"px-2 py-1 bg-purple-900 text-purple-300 rounded text-sm",children:N},N))})]}),((h=a.data.threat_landscape.geographic_focus)==null?void 0:h.length)>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Geographic Focus"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.data.threat_landscape.geographic_focus.map(N=>e.jsx("span",{className:"px-2 py-1 bg-blue-900 text-blue-300 rounded text-sm",children:N},N))})]})]})]}),((r=a.data.top_actors)==null?void 0:r.length)>0&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Top Threat Actors"}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.data.top_actors.map(N=>e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white font-medium",children:N.name}),e.jsx("span",{className:`text-sm ${c(N.threat_level)}`,children:N.threat_level})]}),e.jsx("p",{className:"text-sm text-gray-400",children:N.motivation})]},N.id))})]}),((g=a.data.recommendations)==null?void 0:g.length)>0&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Recommendations"}),e.jsx("ul",{className:"space-y-2",children:a.data.recommendations.map((N,C)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(z,{className:"h-5 w-5 text-cyan-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300",children:N})]},C))})]})]}):e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-8 text-center",children:[e.jsx(F,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No briefings generated yet."}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:'Click "Generate Briefing" to create your first threat intelligence briefing.'})]})]})}export{Pe as default};
