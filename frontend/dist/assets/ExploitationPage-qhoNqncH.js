import{j as e,b as Y,d as I,u as H}from"./vendor-state-DdX3IZQk.js";import{R as ce,r as k,j as be,u as ye}from"./vendor-react-Da1CiaFS.js";import{X as W,K as F,w as z,I as O,b4 as re,S as U,v as oe,N as me,o as je,G as Ne,a3 as fe,D as xe,x as he,a as pe,y as ue,B as _,a$ as X,Q as G,ao as J,ah as le,aa as V,s as ee,A as Q,ae as B,aW as ge,b3 as de,a7 as te,ap as ae,Y as ve,al as we,z as ke}from"./vendor-ui-M-o_--rZ.js";import{a3 as R,B as $,d as _e}from"./index-CZ76raZy.js";import"./vendor-charts-PE5xD9Ly.js";const Ce=[{id:"password_spray",name:"Password Spray",description:"Test common passwords against multiple accounts with lockout evasion",category:"credential",icon:e.jsx(F,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium",requirements:["Target IP/hostname","Username list","Password list"]},{id:"kerberoast",name:"Kerberoasting",description:"Extract TGS tickets from Active Directory for offline cracking",category:"credential",icon:e.jsx(U,{className:"h-6 w-6"}),difficulty:"medium",risk:"low",requirements:["Domain credentials","Domain controller access"]},{id:"asrep_roast",name:"AS-REP Roasting",description:"Target accounts without Kerberos pre-authentication",category:"credential",icon:e.jsx(oe,{className:"h-6 w-6"}),difficulty:"medium",risk:"low",requirements:["Domain controller","Username list"]},{id:"smb_relay",name:"SMB Relay",description:"Relay NTLM authentication to other targets",category:"credential",icon:e.jsx(me,{className:"h-6 w-6"}),difficulty:"hard",risk:"high",requirements:["Network position","Target systems"]},{id:"reverse_shell",name:"Reverse Shell",description:"Generate reverse shell payloads in various formats",category:"payload",icon:e.jsx(z,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium",requirements:["LHOST","LPORT"]},{id:"bind_shell",name:"Bind Shell",description:"Generate bind shell payloads that listen for connections",category:"payload",icon:e.jsx(je,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium",requirements:["LPORT"]},{id:"web_shell",name:"Web Shell",description:"Generate web shells for PHP, ASPX, JSP",category:"payload",icon:e.jsx(Ne,{className:"h-6 w-6"}),difficulty:"easy",risk:"high",requirements:["Target web server"]},{id:"meterpreter",name:"Meterpreter",description:"Generate advanced Meterpreter payloads via msfvenom",category:"payload",icon:e.jsx(fe,{className:"h-6 w-6"}),difficulty:"medium",risk:"high",requirements:["msfvenom installed","LHOST","LPORT"]},{id:"credential_dump",name:"Credential Dump",description:"Extract credentials from memory, registry, or files",category:"post-exploit",icon:e.jsx(xe,{className:"h-6 w-6"}),difficulty:"medium",risk:"high",requirements:["Admin/root access","Target system"]},{id:"priv_esc",name:"Privilege Escalation",description:"Check for privilege escalation vectors",category:"post-exploit",icon:e.jsx(he,{className:"h-6 w-6"}),difficulty:"medium",risk:"medium",requirements:["Target system access"]},{id:"persistence",name:"Persistence",description:"Establish persistent access mechanisms",category:"post-exploit",icon:e.jsx(pe,{className:"h-6 w-6"}),difficulty:"hard",risk:"high",requirements:["System access","Admin/root privileges"]},{id:"lateral_movement",name:"Lateral Movement",description:"Move to other systems using Pass-the-Hash, WMI, PsExec",category:"post-exploit",icon:e.jsx(ue,{className:"h-6 w-6"}),difficulty:"hard",risk:"high",requirements:["Credentials/hashes","Network access"]}],Se=({isOpen:v,onClose:C,onSelect:b,msfvenomAvailable:w=!1})=>{const[x,d]=ce.useState("all"),[o,A]=ce.useState("");if(!v)return null;const j=Ce.filter(i=>{const p=x==="all"||i.category===x,c=o===""||i.name.toLowerCase().includes(o.toLowerCase())||i.description.toLowerCase().includes(o.toLowerCase());return p&&c}),t=i=>{switch(i){case"easy":return"bg-green-500/20 text-green-400";case"medium":return"bg-yellow-500/20 text-yellow-400";case"hard":return"bg-red-500/20 text-red-400";default:return"bg-gray-500/20 text-gray-400"}},s=i=>{switch(i){case"low":return"bg-green-500/20 text-green-400";case"medium":return"bg-yellow-500/20 text-yellow-400";case"high":return"bg-red-500/20 text-red-400";default:return"bg-gray-500/20 text-gray-400"}},h=i=>{switch(i){case"credential":return"text-blue-400";case"payload":return"text-green-400";case"post-exploit":return"text-red-400"}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Select Attack Type"}),e.jsx("button",{onClick:C,className:"text-gray-400 hover:text-white p-2 rounded-lg hover:bg-dark-bg transition-colors",children:e.jsx(W,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search attacks...",value:o,onChange:i=>A(i.target.value),className:"flex-1 px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${x==="all"?"bg-primary text-white":"bg-dark-bg text-gray-400 hover:text-white"}`,children:"All"}),e.jsxs("button",{onClick:()=>d("credential"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${x==="credential"?"bg-blue-500/20 text-blue-400 border border-blue-500/50":"bg-dark-bg text-gray-400 hover:text-white"}`,children:[e.jsx(F,{className:"h-4 w-4"}),"Credentials"]}),e.jsxs("button",{onClick:()=>d("payload"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${x==="payload"?"bg-green-500/20 text-green-400 border border-green-500/50":"bg-dark-bg text-gray-400 hover:text-white"}`,children:[e.jsx(z,{className:"h-4 w-4"}),"Payloads"]}),e.jsxs("button",{onClick:()=>d("post-exploit"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${x==="post-exploit"?"bg-red-500/20 text-red-400 border border-red-500/50":"bg-dark-bg text-gray-400 hover:text-white"}`,children:[e.jsx(O,{className:"h-4 w-4"}),"Post-Exploit"]})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map(i=>{const p=i.id==="meterpreter"&&!w;return e.jsxs("button",{onClick:()=>!p&&b(i),disabled:p,className:`p-4 rounded-lg border text-left transition-all ${p?"bg-dark-bg/50 border-dark-border opacity-50 cursor-not-allowed":"bg-dark-bg border-dark-border hover:border-primary hover:shadow-lg hover:shadow-primary/10"}`,children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-dark-surface ${h(i.category)}`,children:i.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-white font-medium truncate",children:i.name}),p&&e.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-400 px-2 py-0.5 rounded",children:"msfvenom required"})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1 line-clamp-2",children:i.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${t(i.difficulty)}`,children:i.difficulty}),e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded ${s(i.risk)}`,children:[i.risk," risk"]})]})]})]}),i.requirements&&i.requirements.length>0&&e.jsx("div",{className:"mt-3 pt-3 border-t border-dark-border",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Requires: ",i.requirements.join(", ")]})})]},i.id)})}),j.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(re,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No attacks match your search"})]})]}),e.jsx("div",{className:"p-4 border-t border-dark-border bg-dark-bg/50",children:e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Select an attack type to configure and execute. All actions are logged for audit purposes."})})]})})},Pe=[{value:"smb",label:"SMB (445)",description:"Windows file sharing"},{value:"ldap",label:"LDAP (389/636)",description:"Active Directory"},{value:"rdp",label:"RDP (3389)",description:"Remote Desktop"},{value:"ssh",label:"SSH (22)",description:"Secure Shell"},{value:"http_basic",label:"HTTP Basic",description:"Basic authentication"},{value:"http_ntlm",label:"HTTP NTLM",description:"NTLM over HTTP"},{value:"kerberos",label:"Kerberos (88)",description:"Kerberos auth"},{value:"winrm",label:"WinRM (5985/5986)",description:"Windows Remote Management"}],Te=["Password1!","Welcome1!","Summer2024!","Winter2024!","Spring2024!","Fall2024!","Company123!","Qwerty123!","Password123","Welcome123","Admin123!","User123!"],Ae=({isOpen:v,onClose:C,onSuccess:b,onCampaignCreated:w})=>{const x=Y(),[d,o]=k.useState(1),[A,j]=k.useState(!1),[t,s]=k.useState({name:"",targets:[""],usernames:[""],passwords:[""],protocol:"smb",domain:"",delay_between_attempts_ms:1e3,delay_between_users_ms:5e3,max_attempts_per_user:3,stop_on_success:!1,threads:5}),h=I({mutationFn:async()=>(await R.createCampaign({name:t.name||`Password Spray - ${new Date().toLocaleString()}`,attack_type:"password_spray",config:{protocol:t.protocol,domain:t.domain||null,usernames:t.usernames.filter(m=>m.trim()),passwords:t.passwords.filter(m=>m.trim()),delay_between_attempts_ms:t.delay_between_attempts_ms,delay_between_users_ms:t.delay_between_users_ms,max_attempts_per_user:t.max_attempts_per_user,stop_on_success:t.stop_on_success,threads:t.threads},targets:t.targets.filter(m=>m.trim())})).data,onSuccess:async l=>{if(A)try{await R.startCampaign(l.id,!0),_.success("Campaign created and started!")}catch{_.success("Campaign created. Start it manually to begin.")}else _.success("Campaign created. Authorize to start.");x.invalidateQueries({queryKey:["exploitation-campaigns"]}),x.invalidateQueries({queryKey:["exploitation-status"]}),b==null||b(),w==null||w(l.id),C()},onError:l=>{var m,N;_.error(((N=(m=l.response)==null?void 0:m.data)==null?void 0:N.error)||"Failed to create campaign")}}),i=()=>s({...t,targets:[...t.targets,""]}),p=l=>{const m=t.targets.filter((N,a)=>a!==l);s({...t,targets:m.length?m:[""]})},c=(l,m)=>{const N=[...t.targets];N[l]=m,s({...t,targets:N})},P=()=>s({...t,usernames:[...t.usernames,""]}),r=l=>{const m=t.usernames.filter((N,a)=>a!==l);s({...t,usernames:m.length?m:[""]})},u=(l,m)=>{const N=[...t.usernames];N[l]=m,s({...t,usernames:N})},L=()=>s({...t,passwords:[...t.passwords,""]}),q=l=>{const m=t.passwords.filter((N,a)=>a!==l);s({...t,passwords:m.length?m:[""]})},g=(l,m)=>{const N=[...t.passwords];N[l]=m,s({...t,passwords:N})},S=()=>{s({...t,passwords:Te})},E=l=>m=>{var T;const N=(T=m.target.files)==null?void 0:T[0];if(!N)return;const a=new FileReader;a.onload=K=>{var ie;const Z=((ie=K.target)==null?void 0:ie.result).split(`
`).map(se=>se.trim()).filter(se=>se);s({...t,[l]:Z})},a.readAsText(N)};if(!v)return null;const n=t.targets.filter(l=>l.trim()).length,y=t.usernames.filter(l=>l.trim()).length,f=t.passwords.filter(l=>l.trim()).length,M=n*y*f,D=Math.ceil(M*t.delay_between_attempts_ms/1e3/60);return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5 text-blue-400"}),"Password Spray Attack"]}),e.jsx("button",{onClick:C,className:"text-gray-400 hover:text-white",children:e.jsx(W,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex items-center gap-4 mt-4",children:[1,2,3].map(l=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${d>=l?"bg-primary text-white":"bg-dark-bg text-gray-400 border border-dark-border"}`,children:l}),l<3&&e.jsx("div",{className:`w-16 h-0.5 mx-2 ${d>l?"bg-primary":"bg-dark-border"}`})]},l))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[d===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Campaign Name (Optional)"}),e.jsx("input",{type:"text",value:t.name,onChange:l=>s({...t,name:l.target.value}),placeholder:"Password Spray - Domain Admin Hunt",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Targets"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:E("targets")}),e.jsx(X,{className:"h-4 w-4 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:i,className:"text-xs text-primary hover:underline",children:[e.jsx(G,{className:"h-4 w-4 inline"})," Add"]})]})]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:t.targets.map((l,m)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:N=>c(m,N.target.value),placeholder:"192.168.1.10 or dc01.domain.local",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),t.targets.length>1&&e.jsx("button",{onClick:()=>p(m),className:"text-red-400 hover:text-red-300 px-2",children:e.jsx(J,{className:"h-4 w-4"})})]},m))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Protocol"}),e.jsx("select",{value:t.protocol,onChange:l=>s({...t,protocol:l.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:Pe.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Domain (Optional)"}),e.jsx("input",{type:"text",value:t.domain,onChange:l=>s({...t,domain:l.target.value}),placeholder:"CORP or corp.local",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]})]}),d===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Usernames"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:E("usernames")}),e.jsx(X,{className:"h-4 w-4 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:P,className:"text-xs text-primary hover:underline",children:[e.jsx(G,{className:"h-4 w-4 inline"})," Add"]})]})]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:t.usernames.map((l,m)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:N=>u(m,N.target.value),placeholder:"administrator",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),t.usernames.length>1&&e.jsx("button",{onClick:()=>r(m),className:"text-red-400 hover:text-red-300 px-2",children:e.jsx(J,{className:"h-4 w-4"})})]},m))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Passwords"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:S,className:"text-xs text-yellow-400 hover:underline",children:"Load Common"}),e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:E("passwords")}),e.jsx(X,{className:"h-4 w-4 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:L,className:"text-xs text-primary hover:underline",children:[e.jsx(G,{className:"h-4 w-4 inline"})," Add"]})]})]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:t.passwords.map((l,m)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:N=>g(m,N.target.value),placeholder:"Password123!",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),t.passwords.length>1&&e.jsx("button",{onClick:()=>q(m),className:"text-red-400 hover:text-red-300 px-2",children:e.jsx(J,{className:"h-4 w-4"})})]},m))})]})]}),d===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4 border border-dark-border",children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4 text-yellow-400"}),"Lockout Protection"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Delay Between Attempts (ms)"}),e.jsx("input",{type:"number",value:t.delay_between_attempts_ms,onChange:l=>s({...t,delay_between_attempts_ms:parseInt(l.target.value)||1e3}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Delay Between Users (ms)"}),e.jsx("input",{type:"number",value:t.delay_between_users_ms,onChange:l=>s({...t,delay_between_users_ms:parseInt(l.target.value)||5e3}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Max Attempts Per User"}),e.jsx("input",{type:"number",value:t.max_attempts_per_user,onChange:l=>s({...t,max_attempts_per_user:parseInt(l.target.value)||3}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Threads"}),e.jsx("input",{type:"number",value:t.threads,onChange:l=>s({...t,threads:parseInt(l.target.value)||5}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"stop-on-success",checked:t.stop_on_success,onChange:l=>s({...t,stop_on_success:l.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary"}),e.jsx("label",{htmlFor:"stop-on-success",className:"text-gray-300 text-sm",children:"Stop on first successful authentication"})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-blue-400 font-medium mb-2 flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),"Attack Summary"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Targets:"}),e.jsx("span",{className:"text-white ml-2",children:n})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Usernames:"}),e.jsx("span",{className:"text-white ml-2",children:y})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Passwords:"}),e.jsx("span",{className:"text-white ml-2",children:f})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Total Attempts:"}),e.jsx("span",{className:"text-white ml-2",children:M.toLocaleString()})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-400",children:"Estimated Time:"}),e.jsxs("span",{className:"text-white ml-2",children:["~",D," minutes"]})]})]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",id:"authorized",checked:A,onChange:l=>j(l.target.checked),className:"w-4 h-4 mt-1 rounded border-yellow-500 bg-dark-bg text-yellow-500"}),e.jsxs("label",{htmlFor:"authorized",className:"text-sm",children:[e.jsx("span",{className:"text-yellow-400 font-medium",children:"Authorization Required"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"I am authorized to perform this security test against the specified targets. I understand that unauthorized access attempts are illegal."})]})]})})]})]}),e.jsxs("div",{className:"p-4 border-t border-dark-border flex justify-between",children:[e.jsx($,{variant:"secondary",onClick:()=>d>1?o(d-1):C(),children:d>1?"Back":"Cancel"}),e.jsx($,{variant:"primary",onClick:()=>{d<3?o(d+1):h.mutate()},disabled:d===1&&n===0||d===2&&(y===0||f===0)||d===3&&!A||h.isPending,children:d<3?"Next":h.isPending?"Creating...":"Start Attack"})]})]})})},Re=({isOpen:v,onClose:C,onSuccess:b,onCampaignCreated:w,attackType:x})=>{const d=Y(),[o,A]=k.useState(1),[j,t]=k.useState(!1),[s,h]=k.useState({name:"",domain_controller:"",domain:"",username:"",password:"",ntlm_hash:"",use_hash:!1,target_spns:[""],enumerate_spns:!0,usernames:[""],enumerate_users:!1,output_format:"hashcat",request_rc4:!0}),i=I({mutationFn:async()=>{const n=x==="kerberoast"?{domain_controller:s.domain_controller,domain:s.domain,username:s.username,password:s.use_hash?null:s.password,ntlm_hash:s.use_hash?s.ntlm_hash:null,target_spns:s.enumerate_spns?null:s.target_spns.filter(f=>f.trim()),output_format:s.output_format,request_rc4:s.request_rc4}:{domain_controller:s.domain_controller,domain:s.domain,usernames:s.enumerate_users?[]:s.usernames.filter(f=>f.trim()),enumerate_users:s.enumerate_users,output_format:s.output_format};return(await R.createCampaign({name:s.name||`${x==="kerberoast"?"Kerberoast":"AS-REP Roast"} - ${new Date().toLocaleString()}`,attack_type:x,config:n,targets:[s.domain_controller]})).data},onSuccess:async n=>{if(j)try{await R.startCampaign(n.id,!0),_.success("Kerberos attack started!")}catch{_.success("Campaign created. Start manually to begin.")}else _.success("Campaign created.");d.invalidateQueries({queryKey:["exploitation-campaigns"]}),d.invalidateQueries({queryKey:["exploitation-status"]}),b==null||b(),w==null||w(n.id),C()},onError:n=>{var y,f;_.error(((f=(y=n.response)==null?void 0:y.data)==null?void 0:f.error)||"Failed to create campaign")}}),p=()=>h({...s,target_spns:[...s.target_spns,""]}),c=n=>{const y=s.target_spns.filter((f,M)=>M!==n);h({...s,target_spns:y.length?y:[""]})},P=(n,y)=>{const f=[...s.target_spns];f[n]=y,h({...s,target_spns:f})},r=()=>h({...s,usernames:[...s.usernames,""]}),u=n=>{const y=s.usernames.filter((f,M)=>M!==n);h({...s,usernames:y.length?y:[""]})},L=(n,y)=>{const f=[...s.usernames];f[n]=y,h({...s,usernames:f})},q=n=>y=>{var D;const f=(D=y.target.files)==null?void 0:D[0];if(!f)return;const M=new FileReader;M.onload=l=>{var a;const N=((a=l.target)==null?void 0:a.result).split(`
`).map(T=>T.trim()).filter(T=>T);h({...s,[n]:N})},M.readAsText(f)};if(!v)return null;const g=x==="kerberoast",S=g?"Kerberoasting Attack":"AS-REP Roasting Attack",E=g?e.jsx(U,{className:"h-5 w-5 text-purple-400"}):e.jsx(oe,{className:"h-5 w-5 text-orange-400"});return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[E,S]}),e.jsx("button",{onClick:C,className:"text-gray-400 hover:text-white",children:e.jsx(W,{className:"h-5 w-5"})})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:g?"Extract TGS tickets for service accounts to crack offline. Targets accounts with SPNs set.":"Target accounts without Kerberos pre-authentication to extract AS-REP hashes."}),e.jsx("div",{className:"flex items-center gap-4 mt-4",children:[1,2].map(n=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${o>=n?g?"bg-purple-500 text-white":"bg-orange-500 text-white":"bg-dark-bg text-gray-400 border border-dark-border"}`,children:n}),n<2&&e.jsx("div",{className:`w-16 h-0.5 mx-2 ${o>n?g?"bg-purple-500":"bg-orange-500":"bg-dark-border"}`})]},n))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[o===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Campaign Name (Optional)"}),e.jsx("input",{type:"text",value:s.name,onChange:n=>h({...s,name:n.target.value}),placeholder:`${g?"Kerberoast":"AS-REP Roast"} - SQL Admins`,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Domain Controller"}),e.jsx("input",{type:"text",value:s.domain_controller,onChange:n=>h({...s,domain_controller:n.target.value}),placeholder:"dc01.corp.local or 192.168.1.10",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Domain"}),e.jsx("input",{type:"text",value:s.domain,onChange:n=>h({...s,domain:n.target.value}),placeholder:"corp.local",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]}),g&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4 text-yellow-400"}),"Authentication"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Username"}),e.jsx("input",{type:"text",value:s.username,onChange:n=>h({...s,username:n.target.value}),placeholder:"domain_user",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:!s.use_hash,onChange:()=>h({...s,use_hash:!1}),className:"text-primary"}),"Use Password"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:s.use_hash,onChange:()=>h({...s,use_hash:!0}),className:"text-primary"}),"Use NTLM Hash"]})]}),s.use_hash?e.jsx("input",{type:"text",value:s.ntlm_hash,onChange:n=>h({...s,ntlm_hash:n.target.value}),placeholder:"AABBCCDD11223344:EEFFGGHHII556677",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white font-mono text-sm"}):e.jsx("input",{type:"password",value:s.password,onChange:n=>h({...s,password:n.target.value}),placeholder:"Password",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]}),e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Target SPNs"}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("input",{type:"checkbox",id:"enumerate-spns",checked:s.enumerate_spns,onChange:n=>h({...s,enumerate_spns:n.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary"}),e.jsx("label",{htmlFor:"enumerate-spns",className:"text-gray-300 text-sm",children:"Enumerate all SPNs automatically"})]}),!s.enumerate_spns&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Specify target SPNs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:q("target_spns")}),e.jsx(X,{className:"h-3 w-3 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:p,className:"text-xs text-primary hover:underline",children:[e.jsx(G,{className:"h-3 w-3 inline"})," Add"]})]})]}),s.target_spns.map((n,y)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:n,onChange:f=>P(y,f.target.value),placeholder:"MSSQLSvc/sql01.corp.local:1433",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm font-mono"}),s.target_spns.length>1&&e.jsx("button",{onClick:()=>c(y),className:"text-red-400 px-2",children:e.jsx(J,{className:"h-4 w-4"})})]},y))]})]})]}),!g&&e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Target Users"}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("input",{type:"checkbox",id:"enumerate-users",checked:s.enumerate_users,onChange:n=>h({...s,enumerate_users:n.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary"}),e.jsx("label",{htmlFor:"enumerate-users",className:"text-gray-300 text-sm",children:"Enumerate users without pre-auth automatically"})]}),!s.enumerate_users&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Specify target usernames"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:q("usernames")}),e.jsx(X,{className:"h-3 w-3 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:r,className:"text-xs text-primary hover:underline",children:[e.jsx(G,{className:"h-3 w-3 inline"})," Add"]})]})]}),s.usernames.map((n,y)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:n,onChange:f=>L(y,f.target.value),placeholder:"svc_backup",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),s.usernames.length>1&&e.jsx("button",{onClick:()=>u(y),className:"text-red-400 px-2",children:e.jsx(J,{className:"h-4 w-4"})})]},y))]})]})]}),o===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4 border border-dark-border",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Output Options"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Hash Format"}),e.jsxs("select",{value:s.output_format,onChange:n=>h({...s,output_format:n.target.value}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"hashcat",children:"Hashcat"}),e.jsx("option",{value:"john",children:"John the Ripper"})]})]}),g&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"request-rc4",checked:s.request_rc4,onChange:n=>h({...s,request_rc4:n.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary mr-3"}),e.jsx("label",{htmlFor:"request-rc4",className:"text-gray-300 text-sm",children:"Request RC4 encryption (easier to crack)"})]})]})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${g?"bg-purple-500/10 border-purple-500/30":"bg-orange-500/10 border-orange-500/30"}`,children:[e.jsxs("h4",{className:`font-medium mb-2 flex items-center gap-2 ${g?"text-purple-400":"text-orange-400"}`,children:[e.jsx(le,{className:"h-4 w-4"}),"Attack Summary"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Domain Controller:"}),e.jsx("span",{className:"text-white ml-2",children:s.domain_controller||"Not set"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Domain:"}),e.jsx("span",{className:"text-white ml-2",children:s.domain||"Not set"})]}),g&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Authentication:"}),e.jsxs("span",{className:"text-white ml-2",children:[s.username," (",s.use_hash?"NTLM Hash":"Password",")"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"SPNs:"}),e.jsx("span",{className:"text-white ml-2",children:s.enumerate_spns?"Auto-enumerate":`${s.target_spns.filter(n=>n.trim()).length} specified`})]})]}),!g&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Users:"}),e.jsx("span",{className:"text-white ml-2",children:s.enumerate_users?"Auto-enumerate":`${s.usernames.filter(n=>n.trim()).length} specified`})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Output Format:"}),e.jsx("span",{className:"text-white ml-2 capitalize",children:s.output_format})]})]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",id:"authorized",checked:j,onChange:n=>t(n.target.checked),className:"w-4 h-4 mt-1 rounded border-yellow-500 bg-dark-bg text-yellow-500"}),e.jsxs("label",{htmlFor:"authorized",className:"text-sm",children:[e.jsx("span",{className:"text-yellow-400 font-medium",children:"Authorization Required"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"I am authorized to perform this Active Directory security test. Extracted hashes will be used for authorized security assessment only."})]})]})})]})]}),e.jsxs("div",{className:"p-4 border-t border-dark-border flex justify-between",children:[e.jsx($,{variant:"secondary",onClick:()=>o>1?A(o-1):C(),children:o>1?"Back":"Cancel"}),e.jsx($,{variant:"primary",onClick:()=>{o<2?A(o+1):i.mutate()},disabled:o===1&&(!s.domain_controller||!s.domain)||o===1&&g&&(!s.username||!s.password&&!s.ntlm_hash)||o===2&&!j||i.isPending,children:o<2?"Next":i.isPending?"Creating...":"Start Attack"})]})]})})},qe={credential_dump:{title:"Credential Dump",icon:e.jsx(xe,{className:"h-6 w-6 text-red-400"}),description:"Extract credentials from memory, registry, or files on the target system.",modules:[{value:"dump_sam",label:"SAM Database",description:"Extract local account hashes from SAM"},{value:"dump_lsass",label:"LSASS Memory",description:"Dump credentials from LSASS process"},{value:"browser_creds",label:"Browser Credentials",description:"Extract saved passwords from browsers"},{value:"wifi_passwords",label:"WiFi Passwords",description:"Extract saved WiFi passwords"},{value:"keepass",label:"KeePass Databases",description:"Find and extract KeePass databases"}]},priv_esc:{title:"Privilege Escalation",icon:e.jsx(he,{className:"h-6 w-6 text-yellow-400"}),description:"Check for privilege escalation vectors on the target system.",modules:[{value:"always_install_elevated",label:"AlwaysInstallElevated",description:"Check for AlwaysInstallElevated policy"},{value:"unquoted_paths",label:"Unquoted Service Paths",description:"Find unquoted service paths"},{value:"weak_service_perms",label:"Weak Service Permissions",description:"Check for modifiable services"},{value:"se_impersonate",label:"SeImpersonate",description:"Check for token impersonation privileges"},{value:"sudoers",label:"Sudoers Check",description:"Analyze sudo configuration (Linux)"},{value:"suid_binaries",label:"SUID Binaries",description:"Find SUID/SGID binaries (Linux)"}]},persistence:{title:"Persistence",icon:e.jsx(pe,{className:"h-6 w-6 text-purple-400"}),description:"Establish persistent access mechanisms on the target system.",modules:[{value:"scheduled_task",label:"Scheduled Task",description:"Create a scheduled task for persistence"},{value:"registry_run",label:"Registry Run Key",description:"Add registry run key for startup"},{value:"service",label:"Windows Service",description:"Create a Windows service"},{value:"cron_job",label:"Cron Job",description:"Add cron job for persistence (Linux)"},{value:"ssh_key",label:"SSH Key",description:"Add SSH authorized key (Linux)"}]},lateral_movement:{title:"Lateral Movement",icon:e.jsx(ue,{className:"h-6 w-6 text-blue-400"}),description:"Move to other systems using various techniques.",modules:[{value:"pass_the_hash",label:"Pass-the-Hash",description:"Authenticate using NTLM hash"},{value:"pass_the_ticket",label:"Pass-the-Ticket",description:"Authenticate using Kerberos ticket"},{value:"psexec",label:"PsExec",description:"Execute commands via PsExec"},{value:"wmi_exec",label:"WMI Exec",description:"Execute commands via WMI"},{value:"ssh_pivot",label:"SSH Pivot",description:"Pivot through SSH connections"}]},smb_relay:{title:"SMB Relay",icon:e.jsx(me,{className:"h-6 w-6 text-orange-400"}),description:"Relay NTLM authentication to other targets for credential theft or command execution.",modules:[{value:"ntlm_relay",label:"NTLM Relay",description:"Relay NTLM auth to target SMB"},{value:"ldap_relay",label:"LDAP Relay",description:"Relay to LDAP for account takeover"},{value:"http_relay",label:"HTTP Relay",description:"Relay to HTTP endpoints"}]}},Le=({isOpen:v,onClose:C,onSuccess:b,onCampaignCreated:w,attackType:x})=>{var p;const d=Y(),[o,A]=k.useState(!1),j=qe[x],[t,s]=k.useState({name:"",target:"",module:((p=j.modules[0])==null?void 0:p.value)||"",username:"",password:"",ntlm_hash:"",use_hash:!1,options:{}}),h=I({mutationFn:async()=>(await R.createCampaign({name:t.name||`${j.title} - ${new Date().toLocaleString()}`,attack_type:x,config:{module:t.module,username:t.username||null,password:t.use_hash?null:t.password,ntlm_hash:t.use_hash?t.ntlm_hash:null,options:t.options},targets:[t.target]})).data,onSuccess:async c=>{if(o)try{await R.startCampaign(c.id,!0),_.success(`${j.title} campaign started!`)}catch{_.success("Campaign created. Start manually to begin.")}else _.success("Campaign created.");d.invalidateQueries({queryKey:["exploitation-campaigns"]}),d.invalidateQueries({queryKey:["exploitation-status"]}),b==null||b(),w==null||w(c.id),C()},onError:c=>{var P,r;_.error(((r=(P=c.response)==null?void 0:P.data)==null?void 0:r.error)||"Failed to create campaign")}});if(!v)return null;const i=j.modules.find(c=>c.value===t.module);return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-dark-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[j.icon,e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:j.title}),e.jsx("p",{className:"text-gray-400 text-sm",children:j.description})]})]}),e.jsx("button",{onClick:C,className:"text-gray-400 hover:text-white p-2 rounded-lg hover:bg-dark-bg",children:e.jsx(W,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Campaign Name (optional)"}),e.jsx("input",{type:"text",value:t.name,onChange:c=>s({...t,name:c.target.value}),placeholder:`${j.title} - ${new Date().toLocaleDateString()}`,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Target ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:t.target,onChange:c=>s({...t,target:c.target.value}),placeholder:"192.168.1.100 or hostname",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Module"}),e.jsx("select",{value:t.module,onChange:c=>s({...t,module:c.target.value}),className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-primary",children:j.modules.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))}),i&&e.jsxs("p",{className:"mt-2 text-sm text-gray-400 flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),i.description]})]}),(x==="lateral_movement"||x==="smb_relay")&&e.jsxs("div",{className:"space-y-4 p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h4",{className:"text-white font-medium flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"Credentials"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Username"}),e.jsx("input",{type:"text",value:t.username,onChange:c=>s({...t,username:c.target.value}),placeholder:"DOMAIN\\\\username or username@domain",className:"w-full px-4 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:!t.use_hash,onChange:()=>s({...t,use_hash:!1}),className:"text-primary"}),e.jsx("span",{className:"text-gray-300",children:"Password"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:t.use_hash,onChange:()=>s({...t,use_hash:!0}),className:"text-primary"}),e.jsx("span",{className:"text-gray-300",children:"NTLM Hash"})]})]}),t.use_hash?e.jsx("input",{type:"text",value:t.ntlm_hash,onChange:c=>s({...t,ntlm_hash:c.target.value}),placeholder:"aad3b435b51404eeaad3b435b51404ee:hash",className:"w-full px-4 py-2 bg-dark-surface border border-dark-border rounded-lg text-white font-mono"}):e.jsx("input",{type:"password",value:t.password,onChange:c=>s({...t,password:c.target.value}),placeholder:"Password",className:"w-full px-4 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:[e.jsx(V,{className:"h-5 w-5 text-red-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400 font-medium",children:"Authorization Required"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"This action may modify system configuration, access sensitive data, or execute commands on target systems. Ensure you have explicit written authorization before proceeding."})]})]}),e.jsxs("label",{className:"flex items-start gap-3 p-4 bg-dark-bg border border-dark-border rounded-lg cursor-pointer hover:border-primary transition-colors",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:c=>A(c.target.checked),className:"mt-1 h-4 w-4 text-primary rounded border-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"I am authorized to perform this test"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"I confirm that I have written authorization from the system owner to perform post-exploitation activities on the specified target(s). I understand that unauthorized access is illegal."})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-dark-border flex justify-end gap-3",children:[e.jsx($,{variant:"secondary",onClick:C,children:"Cancel"}),e.jsx($,{variant:"primary",onClick:()=>h.mutate(),disabled:!t.target||!o||h.isPending,children:h.isPending?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[j.icon,e.jsx("span",{className:"ml-2",children:"Create & Start Campaign"})]})})]})]})})};function Me({campaignId:v,enabled:C=!0,onProgress:b,onComplete:w,onError:x}){const d=k.useRef(null),[o,A]=k.useState(!1),[j,t]=k.useState([]),[s,h]=k.useState(null),i=k.useRef(0),p=3,c=k.useCallback(()=>{if(!C||!v)return;const u=localStorage.getItem("token");if(!u){x==null||x("No authentication token");return}d.current&&d.current.close();const q=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/api/ws/exploitation/${v}?token=${u}`;console.log("[ExploitationWS] Connecting to:",q),d.current=new WebSocket(q),d.current.onopen=()=>{console.log("[ExploitationWS] Connected to campaign:",v),A(!0),i.current=0},d.current.onmessage=g=>{try{const S=JSON.parse(g.data);console.log("[ExploitationWS] Received:",S.type,S),h(S),t(E=>[...E,S]),b==null||b(S),(S.type==="campaignCompleted"||S.type==="campaign_completed")&&(w==null||w(S)),S.type==="error"&&(x==null||x(S.message||"Unknown error"))}catch(S){console.error("[ExploitationWS] Failed to parse message:",S)}},d.current.onclose=g=>{console.log("[ExploitationWS] Connection closed:",g.code,g.reason),A(!1),g.code!==1e3&&i.current<p&&(i.current++,console.log(`[ExploitationWS] Reconnecting... attempt ${i.current}`),setTimeout(c,2e3*i.current))},d.current.onerror=g=>{console.error("[ExploitationWS] Error:",g),x==null||x("WebSocket connection error")}},[v,C,b,w,x]),P=k.useCallback(()=>{d.current&&(d.current.close(1e3,"User disconnected"),d.current=null),A(!1)},[]),r=k.useCallback(()=>{t([]),h(null)},[]);return k.useEffect(()=>(C&&v&&c(),()=>{P()}),[v,C,c,P]),{connected:o,progress:j,lastMessage:s,connect:c,disconnect:P,clearProgress:r}}const Oe=()=>{const{tab:v}=be(),C=ye(),b=Y(),[w,x]=k.useState("dashboard"),[d,o]=k.useState(!1),[A,j]=k.useState(!1),[t,s]=k.useState(null),[h,i]=k.useState(null);k.useEffect(()=>{if(!v){x("dashboard");return}switch(v){case"password-spray":s({id:"password_spray",name:"Password Spray",description:"Test common passwords against multiple accounts",category:"credential",icon:e.jsx(F,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium"});break;case"kerberos":s({id:"kerberoast",name:"Kerberoasting",description:"Extract TGS tickets for offline cracking",category:"credential",icon:e.jsx(U,{className:"h-6 w-6"}),difficulty:"medium",risk:"low"});break;case"asrep-roast":s({id:"asrep_roast",name:"AS-REP Roasting",description:"Target accounts without Kerberos pre-authentication",category:"credential",icon:e.jsx(F,{className:"h-6 w-6"}),difficulty:"medium",risk:"low"});break;case"smb-relay":s({id:"smb_relay",name:"SMB Relay",description:"Relay NTLM authentication to other targets",category:"credential",icon:e.jsx(U,{className:"h-6 w-6"}),difficulty:"hard",risk:"high"});break;case"shells":x("shells");break;case"credential-dump":s({id:"credential_dump",name:"Credential Dump",description:"Extract credentials from memory, registry, or files",category:"post-exploit",icon:e.jsx(O,{className:"h-6 w-6"}),difficulty:"medium",risk:"high"});break;case"priv-esc":s({id:"priv_esc",name:"Privilege Escalation",description:"Check for privilege escalation vectors",category:"post-exploit",icon:e.jsx(O,{className:"h-6 w-6"}),difficulty:"medium",risk:"medium"});break;case"persistence":s({id:"persistence",name:"Persistence",description:"Establish persistent access mechanisms",category:"post-exploit",icon:e.jsx(O,{className:"h-6 w-6"}),difficulty:"hard",risk:"high"});break;case"lateral-movement":s({id:"lateral_movement",name:"Lateral Movement",description:"Move to other systems using Pass-the-Hash, WMI, PsExec",category:"post-exploit",icon:e.jsx(O,{className:"h-6 w-6"}),difficulty:"hard",risk:"high"});break;case"post-exploit":x("modules");break;case"campaigns":x("campaigns");break;default:x("dashboard")}},[v]);const[p,c]=k.useState({shell_type:"reverse_shell",platform:"linux",format:"bash",lhost:"",lport:4444,encoding:"none",obfuscation_level:0,staged:!1}),[P,r]=k.useState(null),{data:u}=H({queryKey:["exploitation-status"],queryFn:async()=>(await R.getStatus()).data}),{data:L=[]}=H({queryKey:["exploitation-campaigns"],queryFn:async()=>(await R.listCampaigns()).data}),{data:q=[]}=H({queryKey:["shell-templates"],queryFn:async()=>(await R.listShellTemplates()).data}),{data:g=[]}=H({queryKey:["post-exploit-modules"],queryFn:async()=>(await R.listModules()).data}),S=I({mutationFn:async a=>(await R.generateShell(a)).data,onSuccess:a=>{r(a),_.success("Shell payload generated!"),b.invalidateQueries({queryKey:["exploitation-status"]})},onError:a=>{var T,K;_.error(((K=(T=a.response)==null?void 0:T.data)==null?void 0:K.message)||"Failed to generate shell")}}),E=I({mutationFn:async a=>{await R.deleteCampaign(a)},onSuccess:()=>{_.success("Campaign deleted"),b.invalidateQueries({queryKey:["exploitation-campaigns"]})}}),n=I({mutationFn:async({id:a,authorized:T})=>{await R.startCampaign(a,T)},onSuccess:()=>{_.success("Campaign started"),b.invalidateQueries({queryKey:["exploitation-campaigns"]}),b.invalidateQueries({queryKey:["exploitation-status"]})},onError:a=>{var T,K;_.error(((K=(T=a.response)==null?void 0:T.data)==null?void 0:K.message)||"Failed to start campaign")}}),y=I({mutationFn:async a=>{await R.stopCampaign(a)},onSuccess:()=>{_.success("Campaign stopped"),b.invalidateQueries({queryKey:["exploitation-campaigns"]}),b.invalidateQueries({queryKey:["exploitation-status"]})}}),f=a=>{if(j(!1),["reverse_shell","bind_shell","web_shell","meterpreter"].includes(a.id)){const T={reverse_shell:"reverse_shell",bind_shell:"bind_shell",web_shell:"web_shell",meterpreter:"reverse_shell"},K={reverse_shell:"bash",bind_shell:"bash",web_shell:"php",meterpreter:"meterpreter_exe"};c({...p,shell_type:T[a.id]||"reverse_shell",format:K[a.id]||"bash"}),o(!0);return}s(a)},M=a=>{s(null),b.invalidateQueries({queryKey:["exploitation-campaigns"]}),b.invalidateQueries({queryKey:["exploitation-status"]}),x("campaigns"),C("/exploitation/campaigns"),_.success("Campaign created successfully!")},D=()=>{s(null),C("/exploitation")},l=a=>{navigator.clipboard.writeText(a),_.success("Copied to clipboard!")},m=a=>{switch(a){case"running":return"text-yellow-400";case"completed":return"text-green-400";case"failed":return"text-red-400";case"cancelled":return"text-gray-400";default:return"text-blue-400"}},N=a=>{switch(a){case"running":return e.jsx(Q,{className:"h-4 w-4 animate-pulse"});case"completed":return e.jsx(B,{className:"h-4 w-4"});case"failed":return e.jsx(V,{className:"h-4 w-4"});case"cancelled":return e.jsx(de,{className:"h-4 w-4"});default:return e.jsx(ve,{className:"h-4 w-4"})}};return e.jsx(_e,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(ee,{className:"h-7 w-7 text-red-500"}),"Exploitation Framework"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Password spraying, Kerberos attacks, shell generation, and post-exploitation"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs($,{variant:"secondary",onClick:()=>o(!0),children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Generate Shell"]}),e.jsxs($,{variant:"primary",onClick:()=>j(!0),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"New Campaign"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Active Campaigns"}),e.jsx(Q,{className:"h-5 w-5 text-yellow-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(u==null?void 0:u.active_campaigns)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Total Campaigns"}),e.jsx(ee,{className:"h-5 w-5 text-blue-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(u==null?void 0:u.total_campaigns)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Credentials Found"}),e.jsx(F,{className:"h-5 w-5 text-green-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(u==null?void 0:u.credentials_stored)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Payloads Generated"}),e.jsx(z,{className:"h-5 w-5 text-purple-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(u==null?void 0:u.payloads_generated)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Msfvenom"}),u!=null&&u.msfvenom_available?e.jsx(B,{className:"h-5 w-5 text-green-400"}):e.jsx(V,{className:"h-5 w-5 text-yellow-400"})]}),e.jsx("p",{className:"text-sm font-medium text-white mt-2",children:u!=null&&u.msfvenom_available?"Available":"Not Found"})]})]}),e.jsx("div",{className:"border-b border-dark-border",children:e.jsx("nav",{className:"flex gap-4",children:["dashboard","campaigns","shells","modules"].map(a=>e.jsx("button",{onClick:()=>x(a),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${w===a?"border-primary text-primary":"border-transparent text-gray-400 hover:text-white"}`,children:a.charAt(0).toUpperCase()+a.slice(1)},a))})}),w==="dashboard"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Recent Campaigns"}),L.length===0?e.jsx("p",{className:"text-gray-400 text-sm",children:"No campaigns yet"}):e.jsx("div",{className:"space-y-3",children:L.slice(0,5).map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-bg rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:a.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:a.attack_type})]}),e.jsxs("div",{className:`flex items-center gap-2 ${m(a.status)}`,children:[N(a.status),e.jsx("span",{className:"text-sm capitalize",children:a.status})]})]},a.id))})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>s({id:"password_spray",name:"Password Spray",description:"Test common passwords against multiple accounts",category:"credential",icon:e.jsx(F,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium"}),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(F,{className:"h-6 w-6 text-blue-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Password Spray"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Credential testing"})]}),e.jsxs("button",{onClick:()=>s({id:"kerberoast",name:"Kerberoasting",description:"Extract TGS tickets for offline cracking",category:"credential",icon:e.jsx(U,{className:"h-6 w-6"}),difficulty:"medium",risk:"low"}),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(U,{className:"h-6 w-6 text-purple-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Kerberoast"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Extract TGS tickets"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(z,{className:"h-6 w-6 text-green-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Shell Generator"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Create payloads"})]}),e.jsxs("button",{onClick:()=>x("modules"),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(O,{className:"h-6 w-6 text-red-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Post-Exploit"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Modules & tools"})]})]})]})]}),w==="campaigns"&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg",children:[e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Campaigns"})}),L.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(ee,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No campaigns yet"}),e.jsx($,{variant:"primary",className:"mt-4",onClick:()=>j(!0),children:"Create First Campaign"})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-400 text-sm border-b border-dark-border",children:[e.jsx("th",{className:"p-4",children:"Name"}),e.jsx("th",{className:"p-4",children:"Type"}),e.jsx("th",{className:"p-4",children:"Status"}),e.jsx("th",{className:"p-4",children:"Targets"}),e.jsx("th",{className:"p-4",children:"Results"}),e.jsx("th",{className:"p-4",children:"Created"}),e.jsx("th",{className:"p-4",children:"Actions"})]})}),e.jsx("tbody",{children:L.map(a=>e.jsxs("tr",{className:"border-b border-dark-border hover:bg-dark-bg",children:[e.jsx("td",{className:"p-4 text-white font-medium",children:a.name}),e.jsx("td",{className:"p-4 text-gray-300",children:a.attack_type}),e.jsx("td",{className:"p-4",children:e.jsxs("span",{className:`flex items-center gap-2 ${m(a.status)}`,children:[N(a.status),e.jsx("span",{className:"capitalize",children:a.status})]})}),e.jsx("td",{className:"p-4 text-gray-300",children:a.targets.length}),e.jsxs("td",{className:"p-4",children:[e.jsx("span",{className:"text-green-400",children:a.successful_count}),e.jsxs("span",{className:"text-gray-500",children:[" / ",a.results_count]})]}),e.jsx("td",{className:"p-4 text-gray-400 text-sm",children:new Date(a.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.status==="pending"&&e.jsx("button",{onClick:()=>n.mutate({id:a.id,authorized:!0}),className:"text-green-400 hover:text-green-300 p-2",title:"Start Campaign",children:e.jsx(ge,{className:"h-4 w-4"})}),a.status==="running"&&e.jsx("button",{onClick:()=>y.mutate(a.id),className:"text-yellow-400 hover:text-yellow-300 p-2",title:"Stop Campaign",children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>i(a.id),className:"text-blue-400 hover:text-blue-300 p-2",title:"View Results",children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>E.mutate(a.id),className:"text-red-400 hover:text-red-300 p-2",title:"Delete Campaign",children:e.jsx(J,{className:"h-4 w-4"})})]})})]},a.id))})]})]}),w==="shells"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Shell Templates"}),e.jsx("div",{className:"space-y-3",children:q.map((a,T)=>e.jsx("div",{className:"p-3 bg-dark-bg rounded-lg border border-dark-border hover:border-primary cursor-pointer transition-colors",onClick:()=>{c({...p,format:a.format.toLowerCase(),platform:a.platform.toLowerCase()}),o(!0)},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:a.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:a.description})]}),a.requires_msfvenom&&e.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-400 px-2 py-1 rounded",children:"msfvenom"})]})},T))})]}),P&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Generated Payload"}),e.jsx("button",{onClick:()=>r(null),className:"text-gray-400 hover:text-white",children:e.jsx(W,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Payload"}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-dark-bg p-3 rounded-lg text-green-400 text-sm overflow-x-auto max-h-48",children:P.payload}),e.jsx("button",{onClick:()=>l(P.payload),className:"absolute top-2 right-2 text-gray-400 hover:text-white",children:e.jsx(te,{className:"h-4 w-4"})})]})]}),P.one_liner&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"One-Liner"}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-dark-bg p-3 rounded-lg text-blue-400 text-sm overflow-x-auto",children:P.one_liner}),e.jsx("button",{onClick:()=>l(P.one_liner),className:"absolute top-2 right-2 text-gray-400 hover:text-white",children:e.jsx(te,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Listener Command"}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-dark-bg p-3 rounded-lg text-yellow-400 text-sm",children:P.listener_command}),e.jsx("button",{onClick:()=>l(P.listener_command),className:"absolute top-2 right-2 text-gray-400 hover:text-white",children:e.jsx(te,{className:"h-4 w-4"})})]})]})]})]})]}),w==="modules"&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Post-Exploitation Modules"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map((a,T)=>{const ne={credential_harvesting:"credential_dump",privilege_escalation:"priv_esc",persistence:"persistence",lateral_movement:"lateral_movement"}[a.category]||"credential_dump";return e.jsxs("div",{onClick:()=>s({id:ne,name:a.name,description:a.description,category:"post-exploit",icon:e.jsx(O,{className:"h-6 w-6"}),difficulty:"medium",risk:"high"}),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary cursor-pointer transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:a.name}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:a.description})]})}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-1 rounded",children:a.category}),a.platforms.map(Z=>e.jsx("span",{className:"text-xs bg-gray-500/20 text-gray-400 px-2 py-1 rounded",children:Z},Z))]})]},T)})})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5 text-green-400"}),"Shell Generator"]}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-white",children:e.jsx(W,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Shell Type"}),e.jsxs("select",{value:p.shell_type,onChange:a=>c({...p,shell_type:a.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"reverse_shell",children:"Reverse Shell"}),e.jsx("option",{value:"bind_shell",children:"Bind Shell"}),e.jsx("option",{value:"web_shell",children:"Web Shell"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Platform"}),e.jsxs("select",{value:p.platform,onChange:a=>c({...p,platform:a.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"linux",children:"Linux"}),e.jsx("option",{value:"windows",children:"Windows"}),e.jsx("option",{value:"macos",children:"macOS"}),e.jsx("option",{value:"universal",children:"Universal"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Format"}),e.jsxs("select",{value:p.format,onChange:a=>c({...p,format:a.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"bash",children:"Bash"}),e.jsx("option",{value:"powershell",children:"PowerShell"}),e.jsx("option",{value:"python",children:"Python"}),e.jsx("option",{value:"perl",children:"Perl"}),e.jsx("option",{value:"php",children:"PHP"}),e.jsx("option",{value:"meterpreter_exe",children:"Meterpreter EXE"}),e.jsx("option",{value:"meterpreter_elf",children:"Meterpreter ELF"}),e.jsx("option",{value:"meterpreter_powershell",children:"Meterpreter PowerShell"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"LHOST"}),e.jsx("input",{type:"text",value:p.lhost,onChange:a=>c({...p,lhost:a.target.value}),placeholder:"192.168.1.100",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"LPORT"}),e.jsx("input",{type:"number",value:p.lport,onChange:a=>c({...p,lport:parseInt(a.target.value)||4444}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Encoding"}),e.jsxs("select",{value:p.encoding,onChange:a=>c({...p,encoding:a.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"none",children:"None"}),e.jsx("option",{value:"base64",children:"Base64"}),e.jsx("option",{value:"hex",children:"Hex"}),e.jsx("option",{value:"xor",children:"XOR"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Obfuscation"}),e.jsxs("select",{value:p.obfuscation_level,onChange:a=>c({...p,obfuscation_level:parseInt(a.target.value)}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:0,children:"None"}),e.jsx("option",{value:1,children:"Light"}),e.jsx("option",{value:2,children:"Medium"}),e.jsx("option",{value:3,children:"Heavy"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-dark-border",children:[e.jsx($,{variant:"secondary",onClick:()=>o(!1),children:"Cancel"}),e.jsxs($,{variant:"primary",onClick:()=>{S.mutate(p),o(!1)},disabled:!p.lhost||S.isPending,children:[S.isPending?e.jsx(ae,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(z,{className:"h-4 w-4 mr-2"}),"Generate"]})]})]})]})}),e.jsx(Se,{isOpen:A,onClose:()=>j(!1),onSelect:f,msfvenomAvailable:(u==null?void 0:u.msfvenom_available)??!1}),(t==null?void 0:t.id)==="password_spray"&&e.jsx(Ae,{isOpen:!0,onClose:D,onCampaignCreated:M}),((t==null?void 0:t.id)==="kerberoast"||(t==null?void 0:t.id)==="asrep_roast")&&e.jsx(Re,{isOpen:!0,onClose:D,onCampaignCreated:M,attackType:t.id}),((t==null?void 0:t.id)==="credential_dump"||(t==null?void 0:t.id)==="priv_esc"||(t==null?void 0:t.id)==="persistence"||(t==null?void 0:t.id)==="lateral_movement"||(t==null?void 0:t.id)==="smb_relay")&&e.jsx(Le,{isOpen:!0,onClose:D,onCampaignCreated:M,attackType:t.id}),h&&e.jsx($e,{campaignId:h,onClose:()=>i(null)})]})})},$e=({campaignId:v,onClose:C})=>{const b=Y(),[w,x]=k.useState(!0),{data:d}=H({queryKey:["campaign-detail",v],queryFn:async()=>(await R.getCampaign(v)).data}),o=(d==null?void 0:d.status)==="running",{data:A=[],isLoading:j,refetch:t}=H({queryKey:["campaign-results",v],queryFn:async()=>(await R.getCampaignResults(v)).data,refetchInterval:o?5e3:!1}),{connected:s,progress:h,lastMessage:i}=Me({campaignId:v,enabled:o,onComplete:()=>{t(),b.invalidateQueries({queryKey:["exploitation-campaigns"]}),b.invalidateQueries({queryKey:["exploitation-status"]}),_.success("Campaign completed!")},onError:r=>{_.error(`Campaign error: ${r}`)}}),p=async r=>{try{const u=await R.exportResults(v,r),L=new Blob([u.data],{type:r==="json"?"application/json":"text/csv"}),q=URL.createObjectURL(L),g=document.createElement("a");g.href=q,g.download=`campaign-${v}.${r}`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(q),_.success(`Results exported as ${r.toUpperCase()}`)}catch{_.error("Failed to export results")}},c=r=>{switch(r){case"campaignStarted":case"campaign_started":return e.jsx(ge,{className:"h-4 w-4 text-blue-400"});case"targetStarted":case"target_started":return e.jsx(ee,{className:"h-4 w-4 text-yellow-400"});case"attemptMade":case"attempt_made":return e.jsx(Q,{className:"h-4 w-4 text-gray-400"});case"credentialFound":case"credential_found":return e.jsx(B,{className:"h-4 w-4 text-green-400"});case"hashExtracted":case"hash_extracted":return e.jsx(F,{className:"h-4 w-4 text-purple-400"});case"campaignProgress":case"campaign_progress":return e.jsx(ae,{className:"h-4 w-4 text-blue-400 animate-spin"});case"campaignCompleted":case"campaign_completed":return e.jsx(B,{className:"h-4 w-4 text-green-400"});case"error":return e.jsx(V,{className:"h-4 w-4 text-red-400"});default:return e.jsx(Q,{className:"h-4 w-4 text-gray-400"})}},P=r=>{switch(r.type){case"campaignStarted":case"campaign_started":return`Campaign started with ${r.total_targets} target(s)`;case"targetStarted":case"target_started":return`Scanning target ${r.index}/${r.total}: ${r.target}`;case"attemptMade":case"attempt_made":return r.success?`SUCCESS: ${r.username} @ ${r.target}`:`Attempt: ${r.username} @ ${r.target}`;case"credentialFound":case"credential_found":return`Credential found: ${r.username} @ ${r.target} (${r.credential_type})`;case"hashExtracted":case"hash_extracted":return`Hash extracted: ${r.username} (${r.hash_type})`;case"campaignProgress":case"campaign_progress":return`${r.progress_percent}% - ${r.message}`;case"campaignCompleted":case"campaign_completed":return`Completed: ${r.successful}/${r.total_results} successful (${r.duration_ms}ms)`;case"error":return r.message||"Unknown error";default:return JSON.stringify(r)}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-4xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Campaign Results"}),o&&e.jsxs("span",{className:"flex items-center gap-2 text-sm text-yellow-400 bg-yellow-400/10 px-3 py-1 rounded-full",children:[e.jsx(Q,{className:"h-4 w-4 animate-pulse"}),"Running",s&&e.jsx("span",{className:"text-xs text-green-400",children:"(Live)"})]}),(d==null?void 0:d.status)==="completed"&&e.jsxs("span",{className:"flex items-center gap-2 text-sm text-green-400 bg-green-400/10 px-3 py-1 rounded-full",children:[e.jsx(B,{className:"h-4 w-4"}),"Completed"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs($,{variant:"secondary",onClick:()=>p("json"),children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"JSON"]}),e.jsxs($,{variant:"secondary",onClick:()=>p("csv"),children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"CSV"]}),e.jsx("button",{onClick:C,className:"text-gray-400 hover:text-white",children:e.jsx(W,{className:"h-6 w-6"})})]})]}),o&&(i==null?void 0:i.progress_percent)!==void 0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[i.progress_percent,"%"]})]}),e.jsx("div",{className:"h-2 bg-dark-bg rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-300",style:{width:`${i.progress_percent}%`}})})]})]}),e.jsxs("div",{className:"flex-1 overflow-hidden flex",children:[o&&w&&h.length>0&&e.jsxs("div",{className:"w-80 border-r border-dark-border overflow-y-auto p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-400",children:"Live Progress"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[h.length," events"]})]}),e.jsx("div",{className:"space-y-2",children:h.slice(-50).reverse().map((r,u)=>e.jsxs("div",{className:`p-2 rounded text-xs flex items-start gap-2 ${r.success===!0?"bg-green-500/10 border border-green-500/30":r.type==="error"?"bg-red-500/10 border border-red-500/30":"bg-dark-bg"}`,children:[c(r.type),e.jsx("span",{className:"text-gray-300 break-all",children:P(r)})]},u))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:j?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ae,{className:"h-8 w-8 text-primary animate-spin"})}):A.length===0&&!o?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(re,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No results yet"})]}):A.length===0&&o?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Q,{className:"h-12 w-12 text-yellow-400 mx-auto mb-4 animate-pulse"}),e.jsx("p",{className:"text-gray-400",children:"Waiting for results..."}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Results will appear as they are found"})]}):e.jsx("div",{className:"space-y-4",children:A.map(r=>{var u,L,q,g,S,E;return e.jsxs("div",{className:`p-4 rounded-lg border ${(u=r.result_type)!=null&&u.includes("success")||(L=r.result_type)!=null&&L.includes("found")||(q=r.result_type)!=null&&q.includes("extracted")?"bg-green-500/10 border-green-500/30":"bg-dark-bg border-dark-border"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[(g=r.result_type)!=null&&g.includes("success")||(S=r.result_type)!=null&&S.includes("found")||(E=r.result_type)!=null&&E.includes("extracted")?e.jsx(B,{className:"h-5 w-5 text-green-400"}):e.jsx(V,{className:"h-5 w-5 text-gray-400"}),e.jsx("span",{className:"text-white font-medium",children:r.target})]}),e.jsx("span",{className:"text-sm text-gray-400",children:new Date(r.created_at).toLocaleString()})]}),r.result_type&&e.jsx("span",{className:"inline-block text-xs bg-primary/20 text-primary px-2 py-1 rounded mb-2",children:r.result_type.replace(/_/g," ")}),r.severity&&e.jsx("span",{className:`inline-block text-xs px-2 py-1 rounded mb-2 ml-2 ${r.severity==="critical"?"bg-red-500/20 text-red-400":r.severity==="high"?"bg-orange-500/20 text-orange-400":"bg-gray-500/20 text-gray-400"}`,children:r.severity}),r.data&&e.jsx("pre",{className:"mt-2 p-3 bg-dark-bg rounded text-sm text-gray-300 overflow-x-auto",children:typeof r.data=="string"?r.data:JSON.stringify(r.data,null,2)})]},r.id)})})})]})]})})};export{Oe as default};
