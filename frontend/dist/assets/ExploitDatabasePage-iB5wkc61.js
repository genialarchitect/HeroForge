import{j as e,e as E,u as v,f as j}from"./vendor-state-oFDmcCcB.js";import{r as u}from"./vendor-react-5KxtEOLM.js";import{ap as W,z as C,c8 as B,O as S,bR as T,o as k,aX as V,B as g,aa as b,g as $,p as U,aO as z,a0 as I,J as A,S as H,V as J,a1 as R,m as F,y as X,ac as K,a7 as G,X as Y}from"./vendor-ui-BlFJDRaq.js";import{L as Z}from"./Layout-U2SG3QMf.js";import{W as n}from"./index-DU1ke8Sf.js";import"./vendor-markdown-BwTKtS0m.js";import"./vendor-utils-DfRopTPV.js";const h={searchExploits:s=>n.get("/exploit-research/exploits",{params:s}).then(t=>t.data),getExploit:s=>n.get(`/exploit-research/exploits/${s}`).then(t=>t.data),getExploitsForCve:s=>n.get(`/exploit-research/exploits/cve/${s}`).then(t=>t.data),getCveMapping:s=>n.get(`/exploit-research/cve-mapping/${s}`).then(t=>t.data.mapping),getBatchCveMappings:s=>n.post("/exploit-research/cve-mapping/batch",{cve_ids:s}).then(t=>Object.values(t.data.mappings)),getSyncStatus:()=>n.get("/exploit-research/sync-status").then(s=>s.data.sources),triggerSync:s=>n.post(`/exploit-research/sync/${s}`).then(t=>t.data),listPocs:s=>n.get("/exploit-research/pocs",{params:s}).then(t=>t.data.pocs),createPoc:s=>n.post("/exploit-research/pocs",s).then(t=>t.data),getPoc:s=>n.get(`/exploit-research/pocs/${s}`).then(t=>t.data),updatePoc:(s,t)=>n.put(`/exploit-research/pocs/${s}`,t).then(r=>r.data),deletePoc:s=>n.delete(`/exploit-research/pocs/${s}`),getPocCode:s=>n.get(`/exploit-research/pocs/${s}/code`).then(t=>t.data),addPocTestResult:(s,t)=>n.post(`/exploit-research/pocs/${s}/test`,t).then(r=>r.data),listNotes:s=>n.get("/exploit-research/notes",{params:s}).then(t=>t.data.notes),createNote:s=>n.post("/exploit-research/notes",s).then(t=>t.data),getNote:s=>n.get(`/exploit-research/notes/${s}`).then(t=>t.data),updateNote:(s,t)=>n.put(`/exploit-research/notes/${s}`,t).then(r=>r.data),deleteNote:s=>n.delete(`/exploit-research/notes/${s}`),listWorkspaces:s=>n.get("/exploit-research/workspaces",{params:s}).then(t=>t.data.workspaces),createWorkspace:s=>n.post("/exploit-research/workspaces",s).then(t=>t.data),getWorkspace:s=>n.get(`/exploit-research/workspaces/${s}`).then(t=>t.data),updateWorkspace:(s,t)=>n.put(`/exploit-research/workspaces/${s}`,t).then(r=>r.data),deleteWorkspace:s=>n.delete(`/exploit-research/workspaces/${s}`),exportWorkspace:s=>n.get(`/exploit-research/workspaces/${s}/export`).then(t=>t.data),addExploitToWorkspace:(s,t)=>n.post(`/exploit-research/workspaces/${s}/exploits/${t}`),listFavorites:()=>n.get("/exploit-research/favorites").then(s=>s.data),addFavorite:s=>n.post("/exploit-research/favorites",{exploit_id:s}),removeFavorite:s=>n.delete(`/exploit-research/favorites/${s}`),getSearchHistory:()=>n.get("/exploit-research/history").then(s=>s.data)},ee={exploit_db:{bg:"bg-red-500/20",text:"text-red-400"},metasploit:{bg:"bg-blue-500/20",text:"text-blue-400"},packetstorm:{bg:"bg-purple-500/20",text:"text-purple-400"}},q={draft:{bg:"bg-gray-500/20",text:"text-gray-400"},testing:{bg:"bg-yellow-500/20",text:"text-yellow-400"},verified:{bg:"bg-green-500/20",text:"text-green-400"},broken:{bg:"bg-red-500/20",text:"text-red-400"},active:{bg:"bg-green-500/20",text:"text-green-400"},completed:{bg:"bg-cyan-500/20",text:"text-cyan-400"},archived:{bg:"bg-gray-500/20",text:"text-gray-400"}},M={high:{bg:"bg-green-500/20",text:"text-green-400"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400"},low:{bg:"bg-orange-500/20",text:"text-orange-400"},untested:{bg:"bg-gray-500/20",text:"text-gray-400"}};function _({source:s}){const t=ee[s.toLowerCase()]||{bg:"bg-gray-500/20",text:"text-gray-400"},r=s==="exploit_db"?"Exploit-DB":s==="metasploit"?"Metasploit":s==="packetstorm"?"PacketStorm":s;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.bg} ${t.text}`,children:r})}function O({status:s}){const t=q[s.toLowerCase()]||q.draft;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.bg} ${t.text}`,children:s.charAt(0).toUpperCase()+s.slice(1)})}function se({reliability:s}){const t=M[s.toLowerCase()]||M.untested;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.bg} ${t.text}`,children:s.charAt(0).toUpperCase()+s.slice(1)})}const P=({isOpen:s,onClose:t,title:r,children:a,size:c="md"})=>{if(!s)return null;const p={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:t}),e.jsxs("div",{className:`relative bg-gray-800 border border-gray-700 rounded-lg shadow-xl w-full ${p[c]} max-h-[90vh] overflow-y-auto mx-4`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 sticky top-0 bg-gray-800 z-10",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:r}),e.jsx("button",{onClick:t,className:"p-1 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-white",children:e.jsx(Y,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4",children:a})]})]})},te=()=>{const[s,t]=u.useState(""),[r,a]=u.useState({source:"",platform:"",exploit_type:"",verified_only:!1,has_code:!1}),[c,p]=u.useState(1),[i,o]=u.useState(null),x=E(),{data:m,isLoading:N,refetch:f}=v({queryKey:["exploits",s,r,c],queryFn:()=>h.searchExploits({query:s||void 0,source:r.source||void 0,platform:r.platform||void 0,exploit_type:r.exploit_type||void 0,verified_only:r.verified_only||void 0,has_code:r.has_code||void 0,page:c,per_page:20}),enabled:!0}),{data:d}=v({queryKey:["exploit-sync-status"],queryFn:h.getSyncStatus}),y=j({mutationFn:l=>h.triggerSync(l),onSuccess:(l,w)=>{g.success(`Sync started for ${w}`),x.invalidateQueries({queryKey:["exploit-sync-status"]})},onError:()=>g.error("Failed to start sync")}),D=j({mutationFn:l=>h.addFavorite(l),onSuccess:()=>{g.success("Added to favorites"),x.invalidateQueries({queryKey:["exploit-favorites"]})},onError:()=>g.error("Failed to add favorite")}),Q=l=>{l.preventDefault(),p(1),f()},L=l=>{navigator.clipboard.writeText(l),g.success("Copied to clipboard")};return e.jsxs("div",{className:"space-y-6",children:[d&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h3",{className:"text-sm font-medium text-gray-300",children:"Database Sync Status"})}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:d.map(l=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(_,{source:l.source}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[l.total_exploits," exploits"]}),l.last_sync_at&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Last: ",new Date(l.last_sync_at).toLocaleString()]}),l.sync_in_progress&&e.jsx("p",{className:"text-xs text-cyan-400",children:"Syncing..."})]}),e.jsx("button",{onClick:()=>y.mutate(l.source),disabled:y.isPending||l.sync_in_progress,className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-cyan-400 disabled:opacity-50",title:"Sync now",children:e.jsx(b,{className:`w-4 h-4 ${y.isPending||l.sync_in_progress?"animate-spin":""}`})})]},l.source))})]}),e.jsxs("form",{onSubmit:Q,className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:s,onChange:l=>t(l.target.value),placeholder:"Search exploits by title, CVE, description...",className:"w-full pl-10 pr-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"}),"Search"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("select",{value:r.source,onChange:l=>a({...r,source:l.target.value}),className:"px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Sources"}),e.jsx("option",{value:"exploit_db",children:"Exploit-DB"}),e.jsx("option",{value:"metasploit",children:"Metasploit"}),e.jsx("option",{value:"packetstorm",children:"PacketStorm"})]}),e.jsxs("select",{value:r.platform,onChange:l=>a({...r,platform:l.target.value}),className:"px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Platforms"}),e.jsx("option",{value:"linux",children:"Linux"}),e.jsx("option",{value:"windows",children:"Windows"}),e.jsx("option",{value:"macos",children:"macOS"}),e.jsx("option",{value:"multi",children:"Multi-Platform"}),e.jsx("option",{value:"web",children:"Web Application"}),e.jsx("option",{value:"android",children:"Android"}),e.jsx("option",{value:"ios",children:"iOS"})]}),e.jsxs("select",{value:r.exploit_type,onChange:l=>a({...r,exploit_type:l.target.value}),className:"px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"remote",children:"Remote"}),e.jsx("option",{value:"local",children:"Local"}),e.jsx("option",{value:"webapps",children:"Web Apps"}),e.jsx("option",{value:"dos",children:"DoS"}),e.jsx("option",{value:"shellcode",children:"Shellcode"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:r.verified_only,onChange:l=>a({...r,verified_only:l.target.checked}),className:"rounded border-gray-700 bg-gray-900 text-cyan-600"}),"Verified Only"]}),e.jsxs("label",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:r.has_code,onChange:l=>a({...r,has_code:l.target.checked}),className:"rounded border-gray-700 bg-gray-900 text-cyan-600"}),"Has Code"]})]})]}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:N?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(b,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-gray-400",children:"Searching exploits..."})]}):(m==null?void 0:m.exploits.length)===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(W,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No exploits found"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:e.jsxs("p",{className:"text-sm text-gray-400",children:["Found ",(m==null?void 0:m.total)||0," exploits"]})}),e.jsx("div",{className:"divide-y divide-gray-700",children:m==null?void 0:m.exploits.map(l=>e.jsx("div",{className:"p-4 hover:bg-gray-700/30",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-white font-medium truncate",children:l.title}),l.verified&&e.jsx($,{className:"w-4 h-4 text-green-400 flex-shrink-0"})]}),e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2 mb-2",children:l.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(_,{source:l.source}),e.jsx("span",{className:"text-xs text-gray-500",children:l.platform}),e.jsx("span",{className:"text-xs text-gray-500",children:l.exploit_type}),l.cve_ids.length>0&&e.jsxs("div",{className:"flex gap-1",children:[l.cve_ids.slice(0,3).map(w=>e.jsx("span",{className:"px-2 py-0.5 bg-cyan-500/20 text-cyan-400 rounded text-xs cursor-pointer hover:bg-cyan-500/30",onClick:()=>L(w),children:w},w)),l.cve_ids.length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",l.cve_ids.length-3]})]}),l.publish_date&&e.jsxs("span",{className:"text-xs text-gray-500",children:[e.jsx(U,{className:"w-3 h-3 inline mr-1"}),new Date(l.publish_date).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[e.jsx("button",{onClick:()=>o(l),className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-white",title:"View details",children:e.jsx(z,{className:"w-4 h-4"})}),l.code_url&&e.jsx("a",{href:l.code_url,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-cyan-400",title:"View code",children:e.jsx(I,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>D.mutate(l.id),className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-yellow-400",title:"Add to favorites",children:e.jsx(k,{className:"w-4 h-4"})})]})]})},l.id))}),m&&m.total>20&&e.jsxs("div",{className:"p-4 border-t border-gray-700 flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>p(l=>Math.max(1,l-1)),disabled:c===1,className:"px-3 py-1 rounded-lg bg-gray-700 text-white disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"text-gray-400",children:["Page ",c," of ",Math.ceil(m.total/20)]}),e.jsx("button",{onClick:()=>p(l=>l+1),disabled:c*20>=m.total,className:"px-3 py-1 rounded-lg bg-gray-700 text-white disabled:opacity-50",children:"Next"})]})]})}),e.jsx(P,{isOpen:!!i,onClose:()=>o(null),title:(i==null?void 0:i.title)||"Exploit Details",size:"lg",children:i&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(_,{source:i.source}),i.verified&&e.jsxs("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 rounded text-xs font-medium flex items-center gap-1",children:[e.jsx($,{className:"w-3 h-3"})," Verified"]}),i.reliability&&e.jsx(se,{reliability:i.reliability})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Platform"}),e.jsx("p",{className:"text-white",children:i.platform})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Type"}),e.jsx("p",{className:"text-white",children:i.exploit_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Author"}),e.jsx("p",{className:"text-white",children:i.author||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Published"}),e.jsx("p",{className:"text-white",children:i.publish_date?new Date(i.publish_date).toLocaleDateString():"Unknown"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Description"}),e.jsx("p",{className:"text-white whitespace-pre-wrap",children:i.description})]}),i.cve_ids.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400",children:"CVE IDs"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:i.cve_ids.map(l=>e.jsxs("span",{className:"px-2 py-1 bg-cyan-500/20 text-cyan-400 rounded cursor-pointer hover:bg-cyan-500/30 flex items-center gap-1",onClick:()=>L(l),children:[l,e.jsx(A,{className:"w-3 h-3"})]},l))})]}),i.tags.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:i.tags.map(l=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs",children:l},l))})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-700",children:[i.code_url&&e.jsxs("a",{href:i.code_url,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4"}),"View Code"]}),e.jsxs("button",{onClick:()=>D.mutate(i.id),className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4"}),"Add to Favorites"]})]})]})})]})},ae=()=>{const[s,t]=u.useState(""),[r,a]=u.useState(null),[c,p]=u.useState(!1),i=async o=>{if(o.preventDefault(),!!s.trim()){p(!0);try{const x=await h.getCveMapping(s.trim().toUpperCase());a(x)}catch{g.error("Failed to lookup CVE mapping")}p(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"CVE to Exploit Mapping"}),e.jsxs("form",{onSubmit:i,className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:s,onChange:o=>t(o.target.value),placeholder:"Enter CVE ID (e.g., CVE-2021-44228)",className:"w-full pl-10 pr-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2 disabled:opacity-50",children:[c?e.jsx(b,{className:"w-4 h-4 animate-spin"}):e.jsx(C,{className:"w-4 h-4"}),"Lookup"]})]})]}),r&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{children:e.jsx("h3",{className:"text-xl font-semibold text-white",children:r.cve_id})}),e.jsxs("div",{className:"flex gap-2",children:[r.has_public_exploit&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 text-red-400 rounded text-xs font-medium flex items-center gap-1",children:[e.jsx(J,{className:"w-3 h-3"}),"Public Exploit"]}),r.has_metasploit_module&&e.jsxs("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs font-medium flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"}),"Metasploit"]})]})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Exploits Found"}),e.jsx("p",{className:"text-xl font-semibold text-white",children:r.exploit_count})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Reliability"}),e.jsx("p",{className:"text-xl font-semibold text-white capitalize",children:r.highest_reliability})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Platforms"}),e.jsx("p",{className:"text-sm font-medium text-white",children:r.platforms.join(", ")||"N/A"})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Last Updated"}),e.jsx("p",{className:"text-sm font-medium text-white",children:new Date(r.updated_at).toLocaleDateString()})]})]}),r.exploit_ids.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-2",children:"Exploit IDs"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.exploit_ids.map(o=>e.jsx("span",{className:"px-2 py-1 bg-gray-900 border border-gray-700 rounded text-sm text-gray-300 font-mono",children:o},o))})]})]})]})},re=()=>{const[s,t]=u.useState(!1),[r,a]=u.useState(null),[c,p]=u.useState(null),i=E(),{data:o,isLoading:x}=v({queryKey:["pocs"],queryFn:()=>h.listPocs()}),m=j({mutationFn:h.createPoc,onSuccess:()=>{g.success("PoC created"),t(!1),i.invalidateQueries({queryKey:["pocs"]})},onError:()=>g.error("Failed to create PoC")}),N=j({mutationFn:h.deletePoc,onSuccess:()=>{g.success("PoC deleted"),i.invalidateQueries({queryKey:["pocs"]})},onError:()=>g.error("Failed to delete PoC")}),f=async d=>{try{const y=await h.getPocCode(d.id);p(y),a(d)}catch{g.error("Failed to load PoC code")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Proof of Concept Repository"}),e.jsxs("button",{onClick:()=>t(!0),className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4"}),"New PoC"]})]}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:x?e.jsx("div",{className:"p-8 text-center",children:e.jsx(b,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto"})}):(o==null?void 0:o.length)===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(S,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No PoCs yet. Create your first one!"})]}):e.jsx("div",{className:"divide-y divide-gray-700",children:o==null?void 0:o.map(d=>e.jsx("div",{className:"p-4 hover:bg-gray-700/30",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"text-white font-medium",children:d.title}),e.jsx(O,{status:d.status})]}),d.description&&e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:d.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[e.jsx(R,{className:"w-3 h-3 inline mr-1"}),d.language]}),d.target_info&&e.jsxs("span",{className:"text-xs text-gray-500",children:[e.jsx(X,{className:"w-3 h-3 inline mr-1"}),d.target_info]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["v",d.versions.length,".0"]}),d.cve_id&&e.jsx("span",{className:"px-2 py-0.5 bg-cyan-500/20 text-cyan-400 rounded text-xs",children:d.cve_id})]})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[e.jsx("button",{onClick:()=>f(d),className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-cyan-400",title:"View code",children:e.jsx(S,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>N.mutate(d.id),className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-red-400",title:"Delete",children:e.jsx(K,{className:"w-4 h-4"})})]})]})},d.id))})}),e.jsx(P,{isOpen:s,onClose:()=>t(!1),title:"Create New PoC",size:"lg",children:e.jsx(le,{onSubmit:d=>m.mutate(d),onCancel:()=>t(!1),isLoading:m.isPending})}),e.jsx(P,{isOpen:!!r&&!!c,onClose:()=>{a(null),p(null)},title:(r==null?void 0:r.title)||"PoC Code",size:"xl",children:c&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-400",children:["Language: ",c.language]}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(c.code),g.success("Code copied to clipboard")},className:"px-3 py-1 bg-gray-700 text-white rounded hover:bg-gray-600 flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Copy"]})]}),e.jsx("pre",{className:"bg-gray-900 border border-gray-700 rounded-lg p-4 overflow-x-auto text-sm text-gray-300",children:e.jsx("code",{children:c.code})})]})})]})},le=({onSubmit:s,onCancel:t,isLoading:r})=>{const[a,c]=u.useState({name:"",description:"",cve_ids:"",platform:"linux",language:"python",code:"",tags:""}),p=i=>{i.preventDefault(),s({name:a.name,description:a.description||void 0,cve_ids:a.cve_ids?a.cve_ids.split(",").map(o=>o.trim()):[],platform:a.platform,language:a.language,code:a.code,tags:a.tags?a.tags.split(",").map(o=>o.trim()):[]})};return e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{type:"text",value:a.name,onChange:i=>c({...a,name:i.target.value}),required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"CVE-2021-44228 Log4j RCE PoC"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:a.description,onChange:i=>c({...a,description:i.target.value}),rows:2,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Describe the exploit and usage..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"CVE IDs"}),e.jsx("input",{type:"text",value:a.cve_ids,onChange:i=>c({...a,cve_ids:i.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"CVE-2021-44228, CVE-2021-45046"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Tags"}),e.jsx("input",{type:"text",value:a.tags,onChange:i=>c({...a,tags:i.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"rce, log4j, java"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Platform"}),e.jsxs("select",{value:a.platform,onChange:i=>c({...a,platform:i.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"linux",children:"Linux"}),e.jsx("option",{value:"windows",children:"Windows"}),e.jsx("option",{value:"macos",children:"macOS"}),e.jsx("option",{value:"multi",children:"Multi-Platform"}),e.jsx("option",{value:"web",children:"Web Application"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Language"}),e.jsxs("select",{value:a.language,onChange:i=>c({...a,language:i.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"python",children:"Python"}),e.jsx("option",{value:"ruby",children:"Ruby"}),e.jsx("option",{value:"c",children:"C"}),e.jsx("option",{value:"cpp",children:"C++"}),e.jsx("option",{value:"go",children:"Go"}),e.jsx("option",{value:"rust",children:"Rust"}),e.jsx("option",{value:"javascript",children:"JavaScript"}),e.jsx("option",{value:"bash",children:"Bash"}),e.jsx("option",{value:"powershell",children:"PowerShell"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Code *"}),e.jsx("textarea",{value:a.code,onChange:i=>c({...a,code:i.target.value}),required:!0,rows:10,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white font-mono text-sm focus:ring-2 focus:ring-cyan-500",placeholder:"#!/usr/bin/env python3..."})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:r,className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2 disabled:opacity-50",children:[r?e.jsx(b,{className:"w-4 h-4 animate-spin"}):e.jsx(F,{className:"w-4 h-4"}),"Create PoC"]})]})]})},ie=()=>{const[s,t]=u.useState(!1),r=E(),{data:a,isLoading:c}=v({queryKey:["research-workspaces"],queryFn:()=>h.listWorkspaces()}),p=j({mutationFn:h.createWorkspace,onSuccess:()=>{g.success("Workspace created"),t(!1),r.invalidateQueries({queryKey:["research-workspaces"]})},onError:()=>g.error("Failed to create workspace")}),i=j({mutationFn:h.deleteWorkspace,onSuccess:()=>{g.success("Workspace deleted"),r.invalidateQueries({queryKey:["research-workspaces"]})},onError:()=>g.error("Failed to delete workspace")}),o=async(x,m)=>{try{const N=await h.exportWorkspace(x),f=new Blob([N.markdown],{type:"text/markdown"}),d=URL.createObjectURL(f),y=document.createElement("a");y.href=d,y.download=`${m.replace(/\s+/g,"_")}_research.md`,y.click(),URL.revokeObjectURL(d),g.success("Workspace exported")}catch{g.error("Failed to export workspace")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Research Workspaces"}),e.jsxs("button",{onClick:()=>t(!0),className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4"}),"New Workspace"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c?e.jsx("div",{className:"col-span-full p-8 text-center",children:e.jsx(b,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto"})}):(a==null?void 0:a.length)===0?e.jsxs("div",{className:"col-span-full p-8 text-center bg-gray-800 border border-gray-700 rounded-lg",children:[e.jsx(T,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No workspaces yet. Create one to start researching!"})]}):a==null?void 0:a.map(x=>e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4 hover:border-gray-600",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h4",{className:"text-white font-medium",children:x.title}),e.jsx(O,{status:x.status})]}),x.cve_id&&e.jsx("span",{className:"inline-block px-2 py-0.5 bg-cyan-500/20 text-cyan-400 rounded text-xs mb-2",children:x.cve_id}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mt-2",children:[e.jsxs("span",{children:[x.exploits.length," exploits"]}),e.jsxs("span",{children:[x.pocs.length," PoCs"]}),e.jsxs("span",{children:[x.notes.length," notes"]})]}),e.jsxs("div",{className:"flex items-center gap-1 mt-3 pt-3 border-t border-gray-700",children:[e.jsx("button",{onClick:()=>o(x.id,x.title),className:"flex-1 p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-cyan-400 flex items-center justify-center gap-1",title:"Export",children:e.jsx(G,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>i.mutate(x.id),className:"flex-1 p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-red-400 flex items-center justify-center gap-1",title:"Delete",children:e.jsx(K,{className:"w-4 h-4"})})]})]},x.id))}),e.jsx(P,{isOpen:s,onClose:()=>t(!1),title:"Create Research Workspace",children:e.jsx(ce,{onSubmit:x=>p.mutate(x),onCancel:()=>t(!1),isLoading:p.isPending})})]})},ce=({onSubmit:s,onCancel:t,isLoading:r})=>{const[a,c]=u.useState({name:"",description:"",cve_id:"",visibility:"private",tags:""}),p=i=>{i.preventDefault(),s({name:a.name,description:a.description||void 0,cve_id:a.cve_id||void 0,visibility:a.visibility,tags:a.tags?a.tags.split(",").map(o=>o.trim()):[]})};return e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{type:"text",value:a.name,onChange:i=>c({...a,name:i.target.value}),required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Log4j Research"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:a.description,onChange:i=>c({...a,description:i.target.value}),rows:2,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"CVE ID (optional)"}),e.jsx("input",{type:"text",value:a.cve_id,onChange:i=>c({...a,cve_id:i.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"CVE-2021-44228"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Visibility"}),e.jsxs("select",{value:a.visibility,onChange:i=>c({...a,visibility:i.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"private",children:"Private"}),e.jsx("option",{value:"team",children:"Team"}),e.jsx("option",{value:"public",children:"Public"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Tags"}),e.jsx("input",{type:"text",value:a.tags,onChange:i=>c({...a,tags:i.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"log4j, rce, java"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:r,className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2 disabled:opacity-50",children:[r?e.jsx(b,{className:"w-4 h-4 animate-spin"}):e.jsx(F,{className:"w-4 h-4"}),"Create"]})]})]})},ne=()=>{const s=E(),{data:t,isLoading:r}=v({queryKey:["exploit-favorites"],queryFn:h.listFavorites}),a=j({mutationFn:h.removeFavorite,onSuccess:()=>{g.success("Removed from favorites"),s.invalidateQueries({queryKey:["exploit-favorites"]})},onError:()=>g.error("Failed to remove favorite")});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Favorite Exploits"}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:r?e.jsx("div",{className:"p-8 text-center",children:e.jsx(b,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto"})}):(t==null?void 0:t.length)===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(k,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No favorites yet. Star exploits to save them here!"})]}):e.jsx("div",{className:"divide-y divide-gray-700",children:t==null?void 0:t.map(c=>e.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-gray-700/30",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:c.exploit_title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(_,{source:c.exploit_source}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Added ",new Date(c.added_at).toLocaleDateString()]})]})]}),e.jsx("button",{onClick:()=>a.mutate(c.exploit_id),className:"p-2 rounded-lg hover:bg-gray-700 text-yellow-400 hover:text-gray-400",title:"Remove from favorites",children:e.jsx(k,{className:"w-4 h-4 fill-current"})})]},c.id))})})]})},oe=()=>{const{data:s,isLoading:t}=v({queryKey:["exploit-search-history"],queryFn:h.getSearchHistory});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Search History"}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:t?e.jsx("div",{className:"p-8 text-center",children:e.jsx(b,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto"})}):(s==null?void 0:s.length)===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(V,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No search history yet."})]}):e.jsx("div",{className:"divide-y divide-gray-700",children:s==null?void 0:s.map(r=>e.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-gray-700/30",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:r.query}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[r.results_count," results"]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(r.searched_at).toLocaleString()})]})]}),e.jsx(C,{className:"w-4 h-4 text-gray-500"})]},r.id))})})]})},ye=()=>{const[s,t]=u.useState("search"),r=[{id:"search",label:"Search",icon:C},{id:"cve-mapping",label:"CVE Mapping",icon:B},{id:"pocs",label:"PoC Repository",icon:S},{id:"workspaces",label:"Workspaces",icon:T},{id:"favorites",label:"Favorites",icon:k},{id:"history",label:"History",icon:V}];return e.jsx(Z,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(W,{className:"w-6 h-6 text-cyan-400"}),"Exploit Database"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Search exploits, manage PoCs, and organize your vulnerability research"})]})}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-1",children:r.map(a=>e.jsxs("button",{onClick:()=>t(a.id),className:`px-4 py-3 text-sm font-medium flex items-center gap-2 border-b-2 transition-colors ${s===a.id?"text-cyan-400 border-cyan-400":"text-gray-400 border-transparent hover:text-white hover:border-gray-600"}`,children:[e.jsx(a.icon,{className:"w-4 h-4"}),a.label]},a.id))})}),e.jsxs("div",{className:"mt-6",children:[s==="search"&&e.jsx(te,{}),s==="cve-mapping"&&e.jsx(ae,{}),s==="pocs"&&e.jsx(re,{}),s==="workspaces"&&e.jsx(ie,{}),s==="favorites"&&e.jsx(ne,{}),s==="history"&&e.jsx(oe,{})]})]})})};export{ye as default};
