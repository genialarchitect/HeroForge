import{j as e}from"./vendor-state-BeiY7NuG.js";import{r as m}from"./vendor-react-B7quoyFx.js";import{G as u,aA as E,j as F,B as j,s as f,u as y,d as k,S as T,w as z,q as M,m as R,aE as L,P as O}from"./vendor-ui-fHX2jwMk.js";import{C as g,I as A,o as I,B as v,L as D,p as w,b,c as X}from"./index-DtIvpSYf.js";import"./vendor-charts-CRKwdVC8.js";const $=({onSuccess:s})=>{const[a,n]=m.useState(""),[d,x]=m.useState(!0),[h,i]=m.useState(30),[r,l]=m.useState(!1),o=async c=>{var t,N;if(c.preventDefault(),!a.trim()){j.error("Please enter a domain name");return}if(!/^(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]$/i.test(a.trim())){j.error("Please enter a valid domain name (e.g., example.com)");return}l(!0);try{const S=await w.performRecon({domain:a.trim(),includeSubdomains:d,timeoutSecs:h});j.success(`DNS reconnaissance completed for ${a}`),s&&s(S.data)}catch(S){const _=((N=(t=S.response)==null?void 0:t.data)==null?void 0:N.error)||"Failed to perform DNS reconnaissance";j.error(_)}finally{l(!1)}};return e.jsx(g,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(u,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"DNS Reconnaissance"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enumerate DNS records, discover subdomains, and check security configuration"})]})]}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"domain",className:"block text-sm font-medium text-gray-700 mb-1",children:"Domain Name *"}),e.jsx(A,{id:"domain",type:"text",placeholder:"example.com",value:a,onChange:c=>n(c.target.value),disabled:r,className:"font-mono"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter the domain name to investigate (without http:// or www)"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(E,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"What this scan includes:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"DNS record enumeration (A, AAAA, MX, NS, TXT, CNAME, SOA, etc.)"}),e.jsx("li",{children:"Subdomain discovery using built-in wordlist"}),e.jsx("li",{children:"Zone transfer vulnerability check (AXFR)"}),e.jsx("li",{children:"DNSSEC configuration check"}),e.jsx("li",{children:"Reverse DNS lookups"})]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(I,{id:"includeSubdomains",checked:d,onChange:c=>x(c.target.checked),disabled:r,label:"Enumerate subdomains"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"timeout",className:"block text-sm font-medium text-gray-700 mb-1",children:"Timeout (seconds)"}),e.jsx(A,{id:"timeout",type:"number",min:10,max:300,value:h,onChange:c=>i(parseInt(c.target.value)||30),disabled:r}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Maximum time to wait for each DNS query (10-300 seconds)"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-200",children:[e.jsx(v,{type:"submit",disabled:r||!a.trim(),className:"flex items-center gap-2",children:r?e.jsxs(e.Fragment,{children:[e.jsx(D,{size:"sm"}),e.jsx("span",{children:"Scanning..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4"}),e.jsx("span",{children:"Start DNS Reconnaissance"})]})}),r&&e.jsx("span",{className:"text-sm text-gray-500",children:"This may take a few minutes depending on the domain..."})]})]})]})})},B=({result:s,onClose:a})=>{const[n,d]=m.useState({overview:!0,records:!0,subdomains:!0,security:!0}),x=l=>{d(o=>({...o,[l]:!o[l]}))},h=["A","AAAA","MX","NS","TXT","CNAME","SOA","SRV","CAA"],i=Object.keys(s.records).sort((l,o)=>{const c=h.indexOf(l),p=h.indexOf(o);return c===-1&&p===-1?l.localeCompare(o):c===-1?1:p===-1?-1:c-p}),r=V(s);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s.domain}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Scanned on ",new Date(s.scan_timestamp).toLocaleString()]})]})]}),a&&e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"})]}),e.jsx(g,{children:e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{onClick:()=>x("overview"),className:"flex items-center justify-between w-full text-left",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Overview"}),n.overview?e.jsx(f,{className:"w-5 h-5 text-gray-400"}):e.jsx(y,{className:"w-5 h-5 text-gray-400"})]}),n.overview&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"DNS Records"})]}),e.jsx("p",{className:"mt-2 text-2xl font-bold text-gray-900",children:Object.values(s.records).reduce((l,o)=>l+o.length,0)}),e.jsxs("p",{className:"text-xs text-gray-500",children:[Object.keys(s.records).length," types"]})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Subdomains"})]}),e.jsx("p",{className:"mt-2 text-2xl font-bold text-gray-900",children:s.subdomains_found.length}),e.jsx("p",{className:"text-xs text-gray-500",children:"discovered"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Nameservers"})]}),e.jsx("p",{className:"mt-2 text-2xl font-bold text-gray-900",children:s.nameservers.length}),e.jsx("p",{className:"text-xs text-gray-500",children:"configured"})]}),e.jsxs("div",{className:`rounded-lg p-4 ${r>=80?"bg-green-50":r>=50?"bg-yellow-50":"bg-red-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:`w-5 h-5 ${r>=80?"text-green-600":r>=50?"text-yellow-600":"text-red-600"}`}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Security Score"})]}),e.jsxs("p",{className:"mt-2 text-2xl font-bold text-gray-900",children:[r,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:r>=80?"Good":r>=50?"Fair":"Poor"})]})]})]})}),e.jsx(g,{children:e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{onClick:()=>x("security"),className:"flex items-center justify-between w-full text-left",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Security Analysis"}),n.security?e.jsx(f,{className:"w-5 h-5 text-gray-400"}):e.jsx(y,{className:"w-5 h-5 text-gray-400"})]}),n.security&&e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx(C,{label:"DNSSEC",enabled:s.dnssec_enabled,description:s.dnssec_enabled?"Domain signing is enabled, providing authenticity and integrity":"Domain signing is not enabled - consider enabling DNSSEC for better security"}),e.jsx(C,{label:"Zone Transfer (AXFR)",enabled:!s.zone_transfer_vulnerable,description:s.zone_transfer_vulnerable?"Zone transfer is allowed - this is a security risk that exposes all DNS records":"Zone transfer is properly restricted",error:s.zone_transfer_error})]})]})}),e.jsx(g,{children:e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{onClick:()=>x("records"),className:"flex items-center justify-between w-full text-left",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"DNS Records"}),n.records?e.jsx(f,{className:"w-5 h-5 text-gray-400"}):e.jsx(y,{className:"w-5 h-5 text-gray-400"})]}),n.records&&e.jsx("div",{className:"mt-4 space-y-4",children:i.map(l=>e.jsx(P,{recordType:l,records:s.records[l],reverseDns:s.reverse_dns},l))})]})}),s.subdomains_found.length>0&&e.jsx(g,{children:e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{onClick:()=>x("subdomains"),className:"flex items-center justify-between w-full text-left",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Discovered Subdomains (",s.subdomains_found.length,")"]}),n.subdomains?e.jsx(f,{className:"w-5 h-5 text-gray-400"}):e.jsx(y,{className:"w-5 h-5 text-gray-400"})]}),n.subdomains&&e.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:s.subdomains_found.map(l=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded border border-gray-200",children:[e.jsx(k,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-mono text-gray-700 truncate",children:l})]},l))})]})})]})},C=({label:s,enabled:a,description:n,error:d})=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[a?e.jsx(z,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}):e.jsx(M,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s}),e.jsx(b,{variant:a?"success":"warning",children:a?"Enabled":"Disabled"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:n}),d&&e.jsx("p",{className:"mt-1 text-xs text-gray-500 font-mono bg-gray-100 p-2 rounded",children:d})]})]}),P=({recordType:s,records:a,reverseDns:n})=>{const[d,x]=m.useState(s==="A"||s==="AAAA"),h=i=>{switch(i){case"A":case"AAAA":return"primary";case"MX":return"success";case"NS":return"warning";default:return"primary"}};return e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsxs("button",{onClick:()=>x(!d),className:"flex items-center justify-between w-full p-3 text-left hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{variant:h(s),children:s}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[a.length," ",a.length===1?"record":"records"]})]}),d?e.jsx(f,{className:"w-4 h-4 text-gray-400"}):e.jsx(y,{className:"w-4 h-4 text-gray-400"})]}),d&&e.jsx("div",{className:"border-t border-gray-200",children:a.map((i,r)=>e.jsx("div",{className:"p-3 border-b border-gray-100 last:border-b-0 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("code",{className:"text-sm text-gray-900 break-all",children:i.value}),n[i.value]&&e.jsxs("div",{className:"mt-1 flex items-center gap-2 text-xs text-gray-500",children:[e.jsx("span",{className:"font-medium",children:"Reverse DNS:"}),e.jsx("code",{className:"text-gray-700",children:n[i.value]})]})]}),i.ttl&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 flex-shrink-0",children:[e.jsx(R,{className:"w-3 h-3"}),e.jsx("span",{children:Z(i.ttl)})]})]})},r))})]})};function V(s){let a=100;return s.dnssec_enabled||(a-=30),s.zone_transfer_vulnerable&&(a-=50),s.nameservers.length===0&&(a-=20),Math.max(0,a)}function Z(s){return s<60?`${s}s`:s<3600?`${Math.floor(s/60)}m`:s<86400?`${Math.floor(s/3600)}h`:`${Math.floor(s/86400)}d`}const K=()=>{const[s,a]=m.useState(null),[n,d]=m.useState([]),[x,h]=m.useState(!0),[i,r]=m.useState("new");m.useEffect(()=>{l()},[]);const l=async()=>{h(!0);try{const t=await w.listResults();d(t.data)}catch(t){console.error("Failed to load recent DNS scans:",t)}finally{h(!1)}},o=t=>{a(t),r("result"),l()},c=async t=>{try{const N=await w.getResult(t);a(N.data),r("result")}catch{j.error("Failed to load DNS recon result")}},p=async t=>{if(confirm("Are you sure you want to delete this DNS reconnaissance result?"))try{await w.deleteResult(t),j.success("DNS recon result deleted"),l(),(s==null?void 0:s.id)===t&&(a(null),r("new"))}catch{j.error("Failed to delete DNS recon result")}};return e.jsx(X,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[e.jsx(u,{className:"h-8 w-8 text-primary"}),"DNS Reconnaissance Tools"]}),e.jsx("p",{className:"mt-2 text-slate-400",children:"Enumerate DNS records, discover subdomains, and check security configuration"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{variant:i==="new"?"primary":"secondary",onClick:()=>r("new"),children:"New Scan"}),e.jsxs(v,{variant:i==="history"?"primary":"secondary",onClick:()=>r("history"),children:["History (",n.length,")"]})]})]}),i==="new"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx($,{onSuccess:o})}),e.jsx("div",{children:e.jsx(g,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Recent Scans"}),x?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(D,{})}):n.length===0?e.jsx("p",{className:"text-sm text-slate-400 text-center py-8",children:"No recent scans"}):e.jsx("div",{className:"space-y-3",children:n.slice(0,5).map(t=>e.jsxs("div",{className:"p-3 bg-dark-bg rounded-lg border border-dark-border hover:bg-dark-hover transition-colors cursor-pointer",onClick:()=>c(t.id),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(u,{className:"w-4 h-4 text-primary flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium text-white truncate",children:t.domain})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[e.jsx(R,{className:"w-3 h-3"}),new Date(t.scan_timestamp).toLocaleDateString()]}),t.zone_transfer_vulnerable&&e.jsx(b,{variant:"danger",className:"mt-1",children:"Zone Transfer Vulnerable"})]},t.id))})]})})})]}),i==="result"&&s&&e.jsx("div",{children:e.jsx(B,{result:s.result,onClose:()=>r("new")})}),i==="history"&&e.jsx(g,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"DNS Reconnaissance History"}),x?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(D,{})}):n.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(u,{className:"w-12 h-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No DNS reconnaissance scans yet"}),e.jsx(v,{variant:"primary",onClick:()=>r("new"),className:"mt-4",children:"Start First Scan"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-dark-border",children:[e.jsx("thead",{className:"bg-dark-bg",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Domain"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Scan Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Subdomains"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Security"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-dark-surface divide-y divide-dark-border",children:n.map(t=>e.jsxs("tr",{className:"hover:bg-dark-hover",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium text-white",children:t.domain})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-400",children:new Date(t.scan_timestamp).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:t.subdomains_count}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.dnssec_enabled&&e.jsx(b,{variant:"success",children:"DNSSEC"}),t.zone_transfer_vulnerable&&e.jsx(b,{variant:"danger",children:"AXFR Vuln"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>c(t.id),className:"text-primary hover:text-primary-light",title:"View results",children:e.jsx(L,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>p(t.id),className:"text-severity-critical hover:text-severity-critical/80",title:"Delete",children:e.jsx(O,{className:"w-4 h-4"})})]})})]},t.id))})]})})]})})]})})};export{K as default};
