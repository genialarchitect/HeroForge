import{j as e}from"./vendor-state-BjT_zREg.js";import{r as c,i as J,u as X}from"./vendor-react-5KxtEOLM.js";import{L as Z}from"./Layout-hU69iu7X.js";import{b0 as A,aG as T,m as z,ab as Y,p as O,bK as K,g as Q,t as G,i as W,ad as V,J as q,q as M,l as H,Z as $,F as R,bB as ee,$ as se,X as te,G as ae,x as re,O as le,aa as oe,H as U,_ as ie,B as y,A as ce}from"./vendor-ui-CaTPr3iI.js";import{W as S}from"./index--6GUYD2o.js";import"./vendor-markdown-BGP8SuZQ.js";import"./vendor-utils-DfRopTPV.js";const ne=({templates:t,onSelectTemplate:u})=>{const d=i=>{if(!i)return[];try{return JSON.parse(i)}catch{return[]}};return t.length===0?e.jsxs("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-8 text-center",children:[e.jsx(A,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"No Templates Available"}),e.jsx("p",{className:"text-slate-400",children:"Methodology templates will appear here once configured."})]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:t.map(i=>{const x=d(i.categories);return e.jsxs("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-6 hover:border-primary/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(A,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:i.name}),i.version&&e.jsxs("span",{className:"text-sm text-slate-400",children:["Version ",i.version]})]})]}),i.is_system&&e.jsx("span",{className:"px-2 py-1 text-xs bg-blue-500/20 text-blue-400 rounded",children:"System"})]}),i.description&&e.jsx("p",{className:"text-slate-400 text-sm mb-4",children:i.description}),e.jsxs("div",{className:"flex items-center gap-4 mb-4 text-sm text-slate-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"h-4 w-4"}),i.item_count," items"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[x.length," categories"]})]}),x.length>0&&e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[x.slice(0,5).map((r,p)=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-dark-hover text-slate-300 rounded",children:r},p)),x.length>5&&e.jsxs("span",{className:"px-2 py-0.5 text-xs bg-dark-hover text-slate-400 rounded",children:["+",x.length-5," more"]})]})}),e.jsxs("button",{onClick:()=>u(i),className:"w-full px-4 py-2 bg-primary/10 text-primary rounded-lg hover:bg-primary/20 transition-colors flex items-center justify-center gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),"Create Checklist"]})]},i.id)})})},B=({progress:t,size:u="md",showLabel:d=!1,className:i=""})=>{const x=Math.min(100,Math.max(0,t)),r=()=>{switch(u){case"sm":return"h-1.5";case"lg":return"h-4";default:return"h-2.5"}},p=()=>x>=100?"bg-green-500":x>=75?"bg-cyan-500":x>=50?"bg-yellow-500":x>=25?"bg-orange-500":"bg-red-500";return e.jsxs("div",{className:`w-full ${i}`,children:[d&&e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"Progress"}),e.jsxs("span",{className:"text-xs font-medium text-white",children:[x.toFixed(0),"%"]})]}),e.jsx("div",{className:`w-full bg-dark-hover rounded-full overflow-hidden ${r()}`,children:e.jsx("div",{className:`${r()} ${p()} rounded-full transition-all duration-300`,style:{width:`${x}%`}})})]})},de=({checklists:t,onSelect:u,onDelete:d,onCreateNew:i})=>{const x=o=>{switch(o){case"completed":return e.jsx(Q,{className:"h-4 w-4 text-green-400"});case"archived":return e.jsx(K,{className:"h-4 w-4 text-slate-400"});default:return e.jsx(O,{className:"h-4 w-4 text-yellow-400"})}},r=o=>{switch(o){case"completed":return"bg-green-500/20 text-green-400";case"archived":return"bg-slate-500/20 text-slate-400";default:return"bg-yellow-500/20 text-yellow-400"}},p=o=>new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return t.length===0?e.jsxs("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-8 text-center",children:[e.jsx(T,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"No Checklists Yet"}),e.jsx("p",{className:"text-slate-400 mb-6",children:"Create your first methodology checklist to start tracking your testing progress."}),e.jsxs("button",{onClick:i,className:"inline-flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors",children:[e.jsx(z,{className:"h-4 w-4"}),"Create Checklist"]})]}):e.jsx("div",{className:"space-y-4",children:t.map(o=>e.jsxs("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4 hover:border-primary/50 transition-colors cursor-pointer",onClick:()=>u(o),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(T,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:o.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{children:o.template_name}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[o.total_items," items"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 text-xs rounded ${r(o.status)}`,children:[x(o.status),o.status.replace("_"," ")]}),e.jsx("button",{onClick:h=>{h.stopPropagation(),d(o.id)},className:"p-1.5 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded transition-colors",children:e.jsx(Y,{className:"h-4 w-4"})})]})]}),o.description&&e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:o.description}),e.jsx("div",{className:"mb-3",children:e.jsx(B,{progress:o.progress_percent,size:"md",showLabel:!0})}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("span",{children:["Created: ",p(o.created_at)]}),e.jsxs("span",{children:["Updated: ",p(o.updated_at)]}),o.completed_at&&e.jsxs("span",{className:"text-green-400",children:["Completed: ",p(o.completed_at)]})]})]},o.id))})},xe=({item:t,isUpdating:u,onStatusChange:d,onNotesChange:i,onExploit:x,canExploit:r=!1})=>{const[p,o]=c.useState(!1),[h,j]=c.useState(t.notes||""),[g,f]=c.useState(!1),_={not_started:{icon:q,color:"text-slate-500",bg:"bg-slate-500/20",label:"Not Started"},in_progress:{icon:O,color:"text-yellow-400",bg:"bg-yellow-500/20",label:"In Progress"},pass:{icon:V,color:"text-green-400",bg:"bg-green-500/20",label:"Pass"},fail:{icon:W,color:"text-red-400",bg:"bg-red-500/20",label:"Fail"},na:{icon:G,color:"text-slate-400",bg:"bg-slate-500/20",label:"N/A"}};_[t.status].icon;const k=m=>{if(!m)return[];try{return JSON.parse(m)}catch{return[]}},N=k(t.tools),v=k(t.references),C=()=>{h!==(t.notes||"")&&i(h)};return e.jsxs("div",{className:`p-4 ${u?"opacity-50":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.template_item_code&&e.jsx("span",{className:"px-2 py-0.5 text-xs font-mono bg-primary/10 text-primary rounded",children:t.template_item_code}),e.jsx("h4",{className:"font-medium text-white truncate",children:t.title})]}),t.description&&e.jsx("p",{className:"text-sm text-slate-400 line-clamp-2",children:t.description}),(t.guidance||t.expected_evidence||N.length>0||v.length>0)&&e.jsx("button",{onClick:()=>o(!p),className:"flex items-center gap-1 mt-2 text-xs text-primary hover:text-primary/80 transition-colors",children:p?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"h-3.5 w-3.5"}),"Hide Details"]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-3.5 w-3.5"}),"Show Details"]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[x&&r&&e.jsxs("button",{onClick:()=>x(t),disabled:u,className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-yellow-600/20 hover:bg-yellow-600/30 text-yellow-400 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",title:"Run automated exploit test",children:[e.jsx($,{className:"h-4 w-4"}),"Exploit"]}),e.jsx("button",{onClick:()=>f(!g),className:`p-1.5 rounded transition-colors ${t.notes?"text-primary bg-primary/10":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,title:t.notes?"View/Edit Notes":"Add Notes",children:e.jsx(R,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex items-center gap-1 bg-dark-hover rounded-lg p-1",children:Object.entries(_).map(([m,n])=>{const F=n.icon,E=t.status===m;return e.jsx("button",{onClick:()=>!u&&d(m),disabled:u,className:`p-1.5 rounded transition-colors ${E?`${n.bg} ${n.color}`:"text-slate-500 hover:text-slate-300 hover:bg-dark-surface"}`,title:n.label,children:e.jsx(F,{className:"h-4 w-4"})},m)})})]})]}),p&&e.jsxs("div",{className:"mt-4 space-y-4 pl-4 border-l-2 border-dark-border",children:[t.guidance&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-1",children:[e.jsx(A,{className:"h-4 w-4"}),"Guidance"]}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:t.guidance})]}),t.expected_evidence&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-1",children:[e.jsx(R,{className:"h-4 w-4"}),"Expected Evidence"]}),e.jsx("p",{className:"text-sm text-slate-400",children:t.expected_evidence})]}),N.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-1",children:[e.jsx(ee,{className:"h-4 w-4"}),"Suggested Tools"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:N.map((m,n)=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-dark-hover text-slate-300 rounded",children:m},n))})]}),v.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-1",children:[e.jsx(se,{className:"h-4 w-4"}),"References"]}),e.jsx("div",{className:"space-y-1",children:v.map((m,n)=>e.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"block text-sm text-primary hover:text-primary/80 truncate",children:m},n))})]})]}),g&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Notes"}),e.jsx("textarea",{value:h,onChange:m=>j(m.target.value),onBlur:C,placeholder:"Add notes, findings, or observations...",className:"w-full px-3 py-2 bg-dark-hover border border-dark-border rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-primary resize-none",rows:3})]}),t.tested_at&&e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Tested: ",new Date(t.tested_at).toLocaleString()]})]})},me=({isOpen:t,onClose:u,onSubmit:d,itemCode:i,itemTitle:x,scannerMapping:r,isLoading:p})=>{const[o,h]=c.useState(""),[j,g]=c.useState(""),[f,_]=c.useState(""),[w,k]=c.useState(),[N,v]=c.useState(!0);if(!t)return null;const C=()=>{d({target_url:o||void 0,target_ip:j||void 0,target_domain:f||void 0,target_port:w,safe_mode:N,timeout_secs:120})},m=()=>!(!r||r.requires_url&&!o||r.requires_ip&&!j||!r.requires_url&&!r.requires_ip&&!f);return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80",children:e.jsxs("div",{className:"bg-dark-surface rounded-lg w-full max-w-lg mx-4 border border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/10 rounded-lg",children:e.jsx($,{className:"w-5 h-5 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Exploit Control"}),e.jsxs("p",{className:"text-sm text-slate-400",children:[i,": ",x]})]})]}),e.jsx("button",{onClick:u,className:"p-2 text-slate-400 hover:text-white hover:bg-dark-hover rounded-lg transition-colors",children:e.jsx(te,{className:"w-5 h-5"})})]}),r&&e.jsxs("div",{className:"mx-6 mt-4 bg-dark-hover rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-slate-300",children:r.description}),e.jsxs("div",{className:"flex gap-4 mt-3 text-xs",children:[r.requires_url&&e.jsxs("span",{className:"flex items-center gap-1 text-cyan-400",children:[e.jsx(ae,{className:"w-3 h-3"}),"URL Required"]}),r.requires_ip&&e.jsxs("span",{className:"flex items-center gap-1 text-cyan-400",children:[e.jsx(re,{className:"w-3 h-3"}),"IP Required"]}),!r.is_safe&&e.jsxs("span",{className:"flex items-center gap-1 text-yellow-400",children:[e.jsx(le,{className:"w-3 h-3"}),"Active Test"]}),r.is_safe&&e.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[e.jsx($,{className:"w-3 h-3"}),"Passive/Safe"]})]})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[(r==null?void 0:r.requires_url)&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:["Target URL ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"url",value:o,onChange:n=>h(n.target.value),placeholder:"https://example.com",className:"w-full px-3 py-2 bg-dark-hover border border-dark-border rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-primary"})]}),(r==null?void 0:r.requires_ip)&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:["Target IP Address ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:j,onChange:n=>g(n.target.value),placeholder:"192.168.1.1",className:"w-full px-3 py-2 bg-dark-hover border border-dark-border rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-primary"})]}),!(r!=null&&r.requires_url)&&!(r!=null&&r.requires_ip)&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:["Target Domain ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:f,onChange:n=>_(n.target.value),placeholder:"example.com",className:"w-full px-3 py-2 bg-dark-hover border border-dark-border rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Target Port (optional)"}),e.jsx("input",{type:"number",value:w||"",onChange:n=>k(n.target.value?parseInt(n.target.value):void 0),placeholder:"443",min:1,max:65535,className:"w-full px-3 py-2 bg-dark-hover border border-dark-border rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-primary"})]}),r&&!r.is_safe&&e.jsxs("label",{className:"flex items-center gap-3 p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-lg cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:N,onChange:n=>v(n.target.checked),className:"w-4 h-4 rounded border-yellow-500/50 bg-dark-hover text-yellow-500 focus:ring-yellow-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-yellow-300",children:"Safe Mode"}),e.jsx("p",{className:"text-xs text-yellow-400/70",children:"Run read-only, non-destructive tests only"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 px-6 py-4 border-t border-dark-border",children:[e.jsx("button",{onClick:u,disabled:p,className:"px-4 py-2 text-slate-300 hover:bg-dark-hover rounded-lg transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:C,disabled:p||!m(),className:"flex items-center gap-2 px-4 py-2 bg-yellow-600 hover:bg-yellow-500 disabled:bg-dark-hover disabled:text-slate-500 text-white rounded-lg transition-colors",children:p?e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"w-4 h-4 animate-spin"}),"Running..."]}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-4 h-4"}),"Run Exploit"]})})]})]})})},he=({checklist:t,onUpdate:u})=>{const[d,i]=c.useState("all"),[x,r]=c.useState(new Set([...new Set(t.items.map(a=>a.category))])),[p,o]=c.useState(null),[h,j]=c.useState(!1),[g,f]=c.useState(null),[_,w]=c.useState(null),[k,N]=c.useState(!1),v=c.useMemo(()=>{const a={};for(const s of t.items)a[s.category]||(a[s.category]=[]),a[s.category].push(s);return a},[t.items]),C=c.useMemo(()=>{if(d==="all")return v;const a={};for(const[s,l]of Object.entries(v)){const b=l.filter(I=>I.status===d);b.length>0&&(a[s]=b)}return a},[v,d]),m=c.useMemo(()=>{const a=t.items.length,s={not_started:0,in_progress:0,pass:0,fail:0,na:0};for(const l of t.items)s[l.status]++;return{total:a,...s}},[t.items]),n=async(a,s,l)=>{o(a.id);try{await S.updateItem(t.checklist.id,a.template_item_id,{status:s,notes:l});const b=await S.getChecklist(t.checklist.id);u(b.data),y.success("Item updated")}catch(b){console.error("Failed to update item:",b),y.error("Failed to update item")}finally{o(null)}},F=async a=>{const s=a.template_item_code;if(!s){y.error("No item code available for this test");return}try{const l=await S.getScannerInfo(s);w(l.data),f(a),j(!0)}catch(l){console.error("Failed to get scanner info:",l),y.error("No automated scanner available for this item")}},E=async a=>{var s,l;if(g){N(!0);try{const b=await S.exploitItem(t.checklist.id,g.template_item_id,a);y.success(`${b.data.summary}`);const I=await S.getChecklist(t.checklist.id);u(I.data),j(!1),f(null),w(null)}catch(b){console.error("Exploit test failed:",b);const I=b instanceof Error&&"response"in b?(l=(s=b.response)==null?void 0:s.data)==null?void 0:l.error:"Exploit test failed";y.error(I||"Exploit test failed")}finally{N(!1)}}},L=a=>{r(s=>{const l=new Set(s);return l.has(a)?l.delete(a):l.add(a),l})},D=a=>a.filter(l=>["pass","fail","na"].includes(l.status)).length/a.length*100,P=(a,s)=>a.filter(l=>l.status===s).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:m.total}),e.jsx("div",{className:"text-xs text-slate-400",children:"Total Items"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:m.pass}),e.jsx("div",{className:"text-xs text-slate-400",children:"Passed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:m.fail}),e.jsx("div",{className:"text-xs text-slate-400",children:"Failed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:m.in_progress}),e.jsx("div",{className:"text-xs text-slate-400",children:"In Progress"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-400",children:m.na}),e.jsx("div",{className:"text-xs text-slate-400",children:"N/A"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-500",children:m.not_started}),e.jsx("div",{className:"text-xs text-slate-400",children:"Not Started"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(B,{progress:t.checklist.progress_percent,size:"lg",showLabel:!0})})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(U,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{className:"text-sm text-slate-400 mr-2",children:"Filter:"}),[{value:"all",label:"All",icon:q,color:"text-slate-400"},{value:"not_started",label:"Not Started",icon:q,color:"text-slate-500"},{value:"in_progress",label:"In Progress",icon:O,color:"text-yellow-400"},{value:"pass",label:"Pass",icon:V,color:"text-green-400"},{value:"fail",label:"Fail",icon:W,color:"text-red-400"},{value:"na",label:"N/A",icon:G,color:"text-slate-400"}].map(a=>e.jsxs("button",{onClick:()=>i(a.value),className:`flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm transition-colors ${d===a.value?"bg-primary/20 text-primary":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(a.icon,{className:`h-3.5 w-3.5 ${a.color}`}),a.label]},a.value))]}),e.jsxs("div",{className:"space-y-4",children:[Object.entries(C).map(([a,s])=>e.jsxs("div",{className:"bg-dark-surface rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("button",{onClick:()=>L(a),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-dark-hover transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[x.has(a)?e.jsx(H,{className:"h-5 w-5 text-slate-400"}):e.jsx(ie,{className:"h-5 w-5 text-slate-400"}),e.jsx("span",{className:"font-medium text-white",children:a}),e.jsxs("span",{className:"text-sm text-slate-400",children:["(",s.length," items)"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsxs("span",{className:"text-green-400",children:[P(s,"pass")," pass"]}),e.jsxs("span",{className:"text-red-400",children:[P(s,"fail")," fail"]})]}),e.jsx("div",{className:"w-32",children:e.jsx(B,{progress:D(s),size:"sm"})})]})]}),x.has(a)&&e.jsx("div",{className:"border-t border-dark-border divide-y divide-dark-border",children:s.map(l=>e.jsx(xe,{item:l,isUpdating:p===l.id,onStatusChange:b=>n(l,b),onNotesChange:b=>n(l,l.status,b),onExploit:F,canExploit:!!l.template_item_code},l.id))})]},a)),Object.keys(C).length===0&&e.jsxs("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-8 text-center",children:[e.jsx(U,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"No Items Found"}),e.jsx("p",{className:"text-slate-400",children:"No items match the current filter. Try selecting a different status filter."})]})]}),e.jsx(me,{isOpen:h,onClose:()=>{j(!1),f(null),w(null)},onSubmit:E,itemCode:(g==null?void 0:g.template_item_code)||"",itemTitle:(g==null?void 0:g.title)||"",scannerMapping:_,isLoading:k})]})},ve=()=>{const{checklistId:t}=J(),u=X(),[d,i]=c.useState(t?"checklist-detail":"checklists"),[x,r]=c.useState([]),[p,o]=c.useState([]),[h,j]=c.useState(null),[g,f]=c.useState(!1),[_,w]=c.useState(!1),[k,N]=c.useState(""),[v,C]=c.useState("");c.useEffect(()=>{m(),n()},[]),c.useEffect(()=>{t&&F(t)},[t]);const m=async()=>{try{const s=await S.listTemplates();r(s.data)}catch(s){console.error("Failed to load templates:",s),y.error("Failed to load methodology templates")}},n=async()=>{try{const s=await S.listChecklists();o(s.data)}catch(s){console.error("Failed to load checklists:",s),y.error("Failed to load checklists")}},F=async s=>{f(!0);try{const l=await S.getChecklist(s);j(l.data),i("checklist-detail")}catch(l){console.error("Failed to load checklist:",l),y.error("Failed to load checklist"),u("/methodology")}finally{f(!1)}},E=async()=>{if(!k||!v.trim()){y.error("Please select a template and enter a name");return}f(!0);try{const s=await S.createChecklist({template_id:k,name:v.trim()});y.success("Checklist created successfully"),w(!1),N(""),C(""),await n(),u(`/methodology/${s.data.id}`)}catch(s){console.error("Failed to create checklist:",s),y.error("Failed to create checklist")}finally{f(!1)}},L=async s=>{if(confirm("Are you sure you want to delete this checklist?"))try{await S.deleteChecklist(s),y.success("Checklist deleted"),await n(),(h==null?void 0:h.checklist.id)===s&&(j(null),i("checklists"),u("/methodology"))}catch(l){console.error("Failed to delete checklist:",l),y.error("Failed to delete checklist")}},D=s=>{u(`/methodology/${s.id}`)},P=()=>{j(null),i("checklists"),u("/methodology")},a=s=>{j(s),n()};return e.jsx(Z,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d==="checklist-detail"&&e.jsx("button",{onClick:P,className:"p-2 text-slate-400 hover:text-white hover:bg-dark-hover rounded-lg transition-colors",children:e.jsx(ce,{className:"h-5 w-5"})}),e.jsx(T,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:d==="checklist-detail"&&h?h.checklist.name:"Methodology Checklists"})]}),e.jsx("p",{className:"text-slate-400",children:d==="checklist-detail"?`${h==null?void 0:h.template_name} - ${h==null?void 0:h.checklist.progress_percent.toFixed(0)}% complete`:"Track your penetration testing progress with PTES and OWASP WSTG checklists"})]}),d!=="checklist-detail"&&e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("button",{onClick:()=>w(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors",children:[e.jsx(z,{className:"h-4 w-4"}),"New Checklist"]})})]}),d!=="checklist-detail"&&e.jsx("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>i("checklists"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${d==="checklists"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(T,{className:"h-4 w-4"}),"My Checklists (",p.length,")"]}),e.jsxs("button",{onClick:()=>i("templates"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${d==="templates"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(A,{className:"h-4 w-4"}),"Templates (",x.length,")"]})]})}),d==="templates"&&e.jsx(ne,{templates:x,onSelectTemplate:s=>{N(s.id),w(!0)}}),d==="checklists"&&e.jsx(de,{checklists:p,onSelect:D,onDelete:L,onCreateNew:()=>w(!0)}),d==="checklist-detail"&&h&&e.jsx(he,{checklist:h,onUpdate:a}),g&&d==="checklist-detail"&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),_&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Create New Checklist"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Template"}),e.jsxs("select",{value:k,onChange:s=>N(s.target.value),className:"w-full px-3 py-2 bg-dark-hover border border-dark-border rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Select a template..."}),x.map(s=>e.jsxs("option",{value:s.id,children:[s.name," ",s.version&&`(${s.version})`," - ",s.item_count," items"]},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Checklist Name"}),e.jsx("input",{type:"text",value:v,onChange:s=>C(s.target.value),placeholder:"e.g., Client XYZ Web App Assessment",className:"w-full px-3 py-2 bg-dark-hover border border-dark-border rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-primary"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{w(!1),N(""),C("")},className:"px-4 py-2 text-slate-400 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{onClick:E,disabled:g||!k||!v.trim(),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:g?"Creating...":"Create Checklist"})]})]})})]})})};export{ve as default};
