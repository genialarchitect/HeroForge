import{j as e}from"./vendor-state-DdX3IZQk.js";import{r as i}from"./vendor-react-Da1CiaFS.js";import{d as I,a5 as m}from"./index-lpqdgxD1.js";import{aR as $,A as T,P as B,m as R,N as _,aD as P,cl as Z,Z as H,at as Q,n as J,aH as M,ae as O,bo as W,aQ as Y,aG as ee}from"./vendor-ui-wM19Qo8C.js";import"./vendor-charts-CCbxmwBt.js";const p=t=>{if(t===0)return"0 B";const d=1024,r=["B","KB","MB","GB","TB"],c=Math.floor(Math.log(t)/Math.log(d));return parseFloat((t/Math.pow(d,c)).toFixed(2))+" "+r[c]},n=t=>t>=1e6?(t/1e6).toFixed(2)+"M":t>=1e3?(t/1e3).toFixed(2)+"K":t.toString(),se={netflow_v5:"NetFlow v5",netflow_v9:"NetFlow v9",ipfix:"IPFIX",sflow:"sFlow"},te={port_scan:"Port Scan",network_scan:"Network Scan",ddos_attack:"DDoS Attack",data_exfiltration:"Data Exfiltration",beaconing:"Beaconing",unusual_protocol:"Unusual Protocol",large_transfer:"Large Transfer",suspicious_port:"Suspicious Port",c2_communication:"C2 Communication",lateral_movement:"Lateral Movement",dns_tunneling:"DNS Tunneling"},A={critical:"text-red-400 bg-red-900/30 border-red-600",high:"text-orange-400 bg-orange-900/30 border-orange-600",medium:"text-yellow-400 bg-yellow-900/30 border-yellow-600",low:"text-blue-400 bg-blue-900/30 border-blue-600"},u=({icon:t,label:d,value:r,subValue:c,color:h="text-blue-400"})=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`${h} p-2 bg-gray-700/50 rounded-lg`,children:t}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:d}),e.jsx("p",{className:"text-white text-xl font-semibold",children:r}),c&&e.jsx("p",{className:"text-gray-500 text-xs",children:c})]})]})}),ae=({collector:t,onStart:d,onStop:r,onDelete:c})=>{const h={running:"bg-green-500",stopped:"bg-gray-500",starting:"bg-yellow-500 animate-pulse",error:"bg-red-500"};return e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:t.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:se[t.collector_type]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${h[t.status]}`}),e.jsx("span",{className:"text-gray-400 text-sm capitalize",children:t.status})]})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Listen Address"}),e.jsxs("span",{className:"text-white",children:[t.listen_address,":",t.listen_port]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Flows Received"}),e.jsx("span",{className:"text-white",children:n(t.flows_received)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Bytes Received"}),e.jsx("span",{className:"text-white",children:p(t.bytes_received)})]}),t.error_message&&e.jsx("p",{className:"text-red-400 text-sm",children:t.error_message})]}),e.jsxs("div",{className:"flex gap-2",children:[t.status==="stopped"||t.status==="error"?e.jsxs("button",{onClick:d,className:"flex-1 bg-green-600 hover:bg-green-700 text-white py-2 px-3 rounded text-sm flex items-center justify-center gap-1",children:[e.jsx(O,{className:"w-4 h-4"})," Start"]}):e.jsxs("button",{onClick:r,className:"flex-1 bg-yellow-600 hover:bg-yellow-700 text-white py-2 px-3 rounded text-sm flex items-center justify-center gap-1",children:[e.jsx(W,{className:"w-4 h-4"})," Stop"]}),e.jsx("button",{onClick:c,className:"bg-red-600 hover:bg-red-700 text-white py-2 px-3 rounded text-sm",children:e.jsx(Y,{className:"w-4 h-4"})})]})]})},le=({onClose:t,onCreated:d})=>{const[r,c]=i.useState({name:"",collector_type:"netflow_v9",listen_address:"0.0.0.0",listen_port:2055}),[h,b]=i.useState(!1),j=async x=>{x.preventDefault(),b(!0);try{await m.post("/api/netflow/collectors",r),d(),t()}catch(a){console.error("Failed to create collector:",a)}finally{b(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Create Flow Collector"}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Name"}),e.jsx("input",{type:"text",value:r.name,onChange:x=>c({...r,name:x.target.value}),className:"w-full bg-gray-700 text-white rounded px-3 py-2 border border-gray-600 focus:border-blue-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Collector Type"}),e.jsxs("select",{value:r.collector_type,onChange:x=>c({...r,collector_type:x.target.value}),className:"w-full bg-gray-700 text-white rounded px-3 py-2 border border-gray-600 focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"netflow_v5",children:"NetFlow v5"}),e.jsx("option",{value:"netflow_v9",children:"NetFlow v9"}),e.jsx("option",{value:"ipfix",children:"IPFIX (NetFlow v10)"}),e.jsx("option",{value:"sflow",children:"sFlow v5"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Listen Address"}),e.jsx("input",{type:"text",value:r.listen_address,onChange:x=>c({...r,listen_address:x.target.value}),className:"w-full bg-gray-700 text-white rounded px-3 py-2 border border-gray-600 focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Port"}),e.jsx("input",{type:"number",value:r.listen_port,onChange:x=>c({...r,listen_port:parseInt(x.target.value)}),className:"w-full bg-gray-700 text-white rounded px-3 py-2 border border-gray-600 focus:border-blue-500 focus:outline-none"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-2 rounded",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:h,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded disabled:opacity-50",children:h?"Creating...":"Create"})]})]})]})})},re=({anomaly:t,onAcknowledge:d})=>e.jsxs("div",{className:`bg-gray-800 rounded-lg p-4 border ${A[t.severity]||"border-gray-700"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${A[t.severity]||"text-gray-400 bg-gray-700"}`,children:t.severity.toUpperCase()}),e.jsx("h4",{className:"text-white font-medium mt-1",children:t.title})]}),t.is_acknowledged?e.jsx(M,{className:"w-5 h-5 text-green-500"}):e.jsx("button",{onClick:d,className:"text-gray-400 hover:text-white",children:e.jsx(ee,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:t.description}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-gray-500",children:[e.jsxs("span",{children:["Type: ",te[t.anomaly_type]||t.anomaly_type]}),e.jsxs("span",{children:["Flows: ",n(t.flow_count)]}),e.jsxs("span",{children:["Bytes: ",p(t.total_bytes)]}),t.source_ip&&e.jsxs("span",{children:["Source: ",t.source_ip]}),t.destination_ip&&e.jsxs("span",{children:["Dest: ",t.destination_ip]})]})]}),xe=()=>{const[t,d]=i.useState("dashboard"),[r,c]=i.useState([]),[h,b]=i.useState([]),[j,x]=i.useState([]),[a,L]=i.useState(null),[N,U]=i.useState({sources:[],destinations:[]}),[q,D]=i.useState(!0),[E,C]=i.useState(!1),[o,f]=i.useState({protocol:"",srcIp:"",dstIp:"",suspicious:!1}),[w,X]=i.useState("1h"),k=async()=>{try{const s=await m.get("/api/netflow/dashboard");L(s.data)}catch(s){console.error("Failed to fetch dashboard:",s)}},g=async()=>{try{const s=await m.get("/api/netflow/collectors");c(s.data.collectors||[])}catch(s){console.error("Failed to fetch collectors:",s)}},v=async()=>{try{const s=new URLSearchParams;s.append("limit","100"),o.protocol&&s.append("protocol",o.protocol),o.srcIp&&s.append("src_ip",o.srcIp),o.dstIp&&s.append("dst_ip",o.dstIp),o.suspicious&&s.append("suspicious","true");const l=await m.get(`/api/netflow/flows?${s.toString()}`);b(l.data.flows||[])}catch(s){console.error("Failed to fetch flows:",s)}},S=async()=>{try{const s=await m.get("/api/netflow/anomalies?limit=50");x(s.data.anomalies||[])}catch(s){console.error("Failed to fetch anomalies:",s)}},F=async()=>{try{const[s,l]=await Promise.all([m.get(`/api/netflow/top-talkers?direction=source&period=${w}&limit=10`),m.get(`/api/netflow/top-talkers?direction=destination&period=${w}&limit=10`)]);U({sources:s.data.talkers||[],destinations:l.data.talkers||[]})}catch(s){console.error("Failed to fetch top talkers:",s)}},z=async s=>{try{await m.post(`/api/netflow/collectors/${s}/start`),g()}catch(l){console.error("Failed to start collector:",l)}},G=async s=>{try{await m.post(`/api/netflow/collectors/${s}/stop`),g()}catch(l){console.error("Failed to stop collector:",l)}},K=async s=>{if(confirm("Are you sure you want to delete this collector?"))try{await m.delete(`/api/netflow/collectors/${s}`),g()}catch(l){console.error("Failed to delete collector:",l)}},V=async s=>{try{await m.post(`/api/netflow/anomalies/${s}/acknowledge`,{notes:""}),S(),k()}catch(l){console.error("Failed to acknowledge anomaly:",l)}};return i.useEffect(()=>{(async()=>{D(!0),await Promise.all([k(),g(),v(),S(),F()]),D(!1)})()},[]),i.useEffect(()=>{t==="flows"&&v(),t==="top-talkers"&&F()},[o,w]),q?e.jsx(I,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx($,{className:"w-8 h-8 text-blue-400 animate-spin"})})}):e.jsx(I,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(T,{className:"w-8 h-8 text-blue-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"NetFlow Analysis"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Network traffic flow collection and analysis"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>{k(),g(),v(),S(),F()},className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"})," Refresh"]}),e.jsxs("button",{onClick:()=>C(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"})," Add Collector"]})]})]}),e.jsx("div",{className:"flex gap-1 mb-6 bg-gray-800 rounded-lg p-1 w-fit",children:[{id:"dashboard",label:"Dashboard",icon:R},{id:"collectors",label:"Collectors",icon:_},{id:"flows",label:"Flow Records",icon:T},{id:"anomalies",label:"Anomalies",icon:P},{id:"top-talkers",label:"Top Talkers",icon:Z}].map(s=>e.jsxs("button",{onClick:()=>d(s.id),className:`px-4 py-2 rounded flex items-center gap-2 text-sm ${t===s.id?"bg-blue-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:[e.jsx(s.icon,{className:"w-4 h-4"}),s.label]},s.id))}),t==="dashboard"&&a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsx(u,{icon:e.jsx(T,{className:"w-5 h-5"}),label:"Total Flows",value:n(a.stats.total_flows)}),e.jsx(u,{icon:e.jsx(H,{className:"w-5 h-5"}),label:"Total Bytes",value:p(a.stats.total_bytes),color:"text-green-400"}),e.jsx(u,{icon:e.jsx(R,{className:"w-5 h-5"}),label:"Total Packets",value:n(a.stats.total_packets),color:"text-purple-400"}),e.jsx(u,{icon:e.jsx(_,{className:"w-5 h-5"}),label:"Unique Sources",value:n(a.stats.unique_sources),color:"text-yellow-400"}),e.jsx(u,{icon:e.jsx(_,{className:"w-5 h-5"}),label:"Unique Dests",value:n(a.stats.unique_destinations),color:"text-orange-400"}),e.jsx(u,{icon:e.jsx(Q,{className:"w-5 h-5"}),label:"Bytes/sec",value:p(a.stats.bytes_per_second),subValue:"/sec",color:"text-cyan-400"})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"text-white font-medium mb-4",children:"Protocol Distribution"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"TCP"}),e.jsx("span",{className:"text-white",children:n(a.stats.tcp_flows)})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${a.stats.total_flows>0?a.stats.tcp_flows/a.stats.total_flows*100:0}%`}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"UDP"}),e.jsx("span",{className:"text-white",children:n(a.stats.udp_flows)})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${a.stats.total_flows>0?a.stats.udp_flows/a.stats.total_flows*100:0}%`}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"ICMP"}),e.jsx("span",{className:"text-white",children:n(a.stats.icmp_flows)})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-yellow-500 h-2 rounded-full",style:{width:`${a.stats.total_flows>0?a.stats.icmp_flows/a.stats.total_flows*100:0}%`}})})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"text-white font-medium mb-4",children:"Collectors Status"}),a.collectors.length===0?e.jsx("p",{className:"text-gray-400 text-sm",children:"No collectors configured"}):e.jsx("div",{className:"space-y-2",children:a.collectors.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-700 last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${s.status==="running"?"bg-green-500":"bg-gray-500"}`}),e.jsx("span",{className:"text-white text-sm",children:s.name})]}),e.jsxs("span",{className:"text-gray-400 text-xs",children:[n(s.flows_parsed)," flows"]})]},s.id))})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("h3",{className:"text-white font-medium mb-4 flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4 text-yellow-400"}),"Recent Anomalies"]}),a.recent_anomalies.length===0?e.jsx("p",{className:"text-gray-400 text-sm",children:"No anomalies detected"}):e.jsx("div",{className:"space-y-2",children:a.recent_anomalies.slice(0,5).map(s=>e.jsx("div",{className:"py-2 border-b border-gray-700 last:border-0",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${A[s.severity]||"text-gray-400 bg-gray-700"}`,children:s.severity.toUpperCase()}),e.jsx("span",{className:"text-white text-sm truncate",children:s.title})]})},s.id))})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"text-white font-medium mb-4",children:"Top Sources"}),e.jsxs("div",{className:"space-y-2",children:[(a.top_sources||[]).slice(0,5).map((s,l)=>e.jsxs("div",{className:"flex items-center justify-between py-1",children:[e.jsx("span",{className:"text-gray-300 text-sm font-mono",children:s.ip_address}),e.jsx("span",{className:"text-gray-400 text-sm",children:p(s.total_bytes)})]},l)),(!a.top_sources||a.top_sources.length===0)&&e.jsx("p",{className:"text-gray-400 text-sm",children:"No data available"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"text-white font-medium mb-4",children:"Top Destinations"}),e.jsxs("div",{className:"space-y-2",children:[(a.top_destinations||[]).slice(0,5).map((s,l)=>e.jsxs("div",{className:"flex items-center justify-between py-1",children:[e.jsx("span",{className:"text-gray-300 text-sm font-mono",children:s.ip_address}),e.jsx("span",{className:"text-gray-400 text-sm",children:p(s.total_bytes)})]},l)),(!a.top_destinations||a.top_destinations.length===0)&&e.jsx("p",{className:"text-gray-400 text-sm",children:"No data available"})]})]})]})]}),t==="collectors"&&e.jsx("div",{children:r.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx(_,{className:"w-12 h-12 text-gray-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-white text-lg font-medium mb-2",children:"No Collectors Configured"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Create a flow collector to start receiving NetFlow/IPFIX/sFlow data"}),e.jsxs("button",{onClick:()=>C(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center gap-2 mx-auto",children:[e.jsx(B,{className:"w-4 h-4"})," Create Collector"]})]}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(s=>e.jsx(ae,{collector:s,onStart:()=>z(s.id),onStop:()=>G(s.id),onDelete:()=>K(s.id)},s.id))})}),t==="flows"&&e.jsxs("div",{children:[e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700 mb-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"Protocol"}),e.jsxs("select",{value:o.protocol,onChange:s=>f({...o,protocol:s.target.value}),className:"bg-gray-700 text-white rounded px-3 py-2 border border-gray-600 text-sm",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"6",children:"TCP"}),e.jsx("option",{value:"17",children:"UDP"}),e.jsx("option",{value:"1",children:"ICMP"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"Source IP"}),e.jsx("input",{type:"text",value:o.srcIp,onChange:s=>f({...o,srcIp:s.target.value}),placeholder:"e.g., 192.168.1.1",className:"bg-gray-700 text-white rounded px-3 py-2 border border-gray-600 text-sm w-40"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"Destination IP"}),e.jsx("input",{type:"text",value:o.dstIp,onChange:s=>f({...o,dstIp:s.target.value}),placeholder:"e.g., 10.0.0.1",className:"bg-gray-700 text-white rounded px-3 py-2 border border-gray-600 text-sm w-40"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o.suspicious,onChange:s=>f({...o,suspicious:s.target.checked}),className:"rounded bg-gray-700 border-gray-600"}),e.jsx("span",{className:"text-gray-300 text-sm",children:"Suspicious only"})]}),e.jsxs("button",{onClick:v,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"})," Search"]})]})}),e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left text-gray-300 font-medium px-4 py-3",children:"Source"}),e.jsx("th",{className:"text-left text-gray-300 font-medium px-4 py-3",children:"Destination"}),e.jsx("th",{className:"text-left text-gray-300 font-medium px-4 py-3",children:"Protocol"}),e.jsx("th",{className:"text-right text-gray-300 font-medium px-4 py-3",children:"Packets"}),e.jsx("th",{className:"text-right text-gray-300 font-medium px-4 py-3",children:"Bytes"}),e.jsx("th",{className:"text-left text-gray-300 font-medium px-4 py-3",children:"Application"}),e.jsx("th",{className:"text-left text-gray-300 font-medium px-4 py-3",children:"Time"}),e.jsx("th",{className:"text-center text-gray-300 font-medium px-4 py-3",children:"Status"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700",children:[h.map(s=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("span",{className:"text-white font-mono",children:s.src_ip}),e.jsxs("span",{className:"text-gray-500",children:[":",s.src_port]})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("span",{className:"text-white font-mono",children:s.dst_ip}),e.jsxs("span",{className:"text-gray-500",children:[":",s.dst_port]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${s.protocol===6?"bg-blue-900/50 text-blue-400":s.protocol===17?"bg-green-900/50 text-green-400":"bg-gray-700 text-gray-300"}`,children:s.protocol_name})}),e.jsx("td",{className:"px-4 py-3 text-right text-gray-300",children:n(s.packets)}),e.jsx("td",{className:"px-4 py-3 text-right text-gray-300",children:p(s.bytes)}),e.jsx("td",{className:"px-4 py-3 text-gray-400",children:s.application||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-xs",children:new Date(s.start_time).toLocaleTimeString()}),e.jsx("td",{className:"px-4 py-3 text-center",children:s.is_suspicious&&e.jsx("span",{className:"text-red-400",title:"Suspicious",children:e.jsx(P,{className:"w-4 h-4"})})})]},s.id)),h.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center py-8 text-gray-400",children:"No flow records found"})})]})]})})})]}),t==="anomalies"&&e.jsx("div",{className:"space-y-4",children:j.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx(M,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-white text-lg font-medium mb-2",children:"No Anomalies Detected"}),e.jsx("p",{className:"text-gray-400",children:"All network traffic appears normal"})]}):e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:j.map(s=>e.jsx(re,{anomaly:s,onAcknowledge:()=>V(s.id)},s.id))})}),t==="top-talkers"&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[e.jsx("span",{className:"text-gray-400",children:"Time Range:"}),e.jsx("div",{className:"flex gap-2",children:["1h","6h","24h","7d"].map(s=>e.jsx("button",{onClick:()=>X(s),className:`px-3 py-1 rounded text-sm ${w===s?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:s},s))})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 bg-gray-700/50 border-b border-gray-700",children:e.jsx("h3",{className:"text-white font-medium",children:"Top Sources by Traffic Volume"})}),e.jsxs("div",{className:"divide-y divide-gray-700",children:[N.sources.map((s,l)=>{var y;return e.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-gray-500 w-6",children:[l+1,"."]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-mono",children:s.ip_address}),((y=s.geo_location)==null?void 0:y.country_code)&&e.jsxs("span",{className:"text-gray-400 text-xs ml-2",children:["(",s.geo_location.country_code,")"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-white",children:p(s.total_bytes)}),e.jsxs("p",{className:"text-gray-400 text-xs",children:[n(s.flow_count)," flows"]})]})]},l)}),N.sources.length===0&&e.jsx("div",{className:"px-4 py-8 text-center text-gray-400",children:"No data available"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 bg-gray-700/50 border-b border-gray-700",children:e.jsx("h3",{className:"text-white font-medium",children:"Top Destinations by Traffic Volume"})}),e.jsxs("div",{className:"divide-y divide-gray-700",children:[N.destinations.map((s,l)=>{var y;return e.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-gray-500 w-6",children:[l+1,"."]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-mono",children:s.ip_address}),((y=s.geo_location)==null?void 0:y.country_code)&&e.jsxs("span",{className:"text-gray-400 text-xs ml-2",children:["(",s.geo_location.country_code,")"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-white",children:p(s.total_bytes)}),e.jsxs("p",{className:"text-gray-400 text-xs",children:[n(s.flow_count)," flows"]})]})]},l)}),N.destinations.length===0&&e.jsx("div",{className:"px-4 py-8 text-center text-gray-400",children:"No data available"})]})]})]})]}),E&&e.jsx(le,{onClose:()=>C(!1),onCreated:g})]})})};export{xe as default};
