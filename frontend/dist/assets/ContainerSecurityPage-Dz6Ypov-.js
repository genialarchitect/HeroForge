import{j as e,b as oe,u as E,d as T}from"./vendor-state-DdX3IZQk.js";import{r as d}from"./vendor-react-Da1CiaFS.js";import{t as U,I as O,ah as M,aW as G,aa as k,o as xe,u as H,B as S,ap as D,Y as me,ae as L,ad as re,ao as ge,bv as ye,b as le,ac as B,S as he,b1 as W,af as pe,a$ as ue,J as be,a7 as je,N as Ne,a as ve,Q,aA as fe}from"./vendor-ui-8vKhRMah.js";import{I,y as we,B as A,Z as F,b as N,d as Se}from"./index-JFxRAnm7.js";import"./vendor-charts-CBc6LDbn.js";const _e=[{id:"image",name:"Container Image Scan",description:"Scan Docker/OCI images for vulnerabilities and misconfigurations",requires_registry:!0,requires_k8s:!1},{id:"dockerfile",name:"Dockerfile Analysis",description:"Analyze Dockerfiles for security best practices and potential issues",requires_registry:!1,requires_k8s:!1},{id:"runtime",name:"Container Runtime Scan",description:"Scan running containers for runtime security issues",requires_registry:!1,requires_k8s:!1},{id:"k8s_manifest",name:"K8s Manifest Analysis",description:"Analyze Kubernetes manifests for security configurations",requires_registry:!1,requires_k8s:!0},{id:"k8s_cluster",name:"K8s Cluster Assessment",description:"Comprehensive Kubernetes cluster security assessment",requires_registry:!1,requires_k8s:!0},{id:"comprehensive",name:"Comprehensive Scan",description:"Full container and Kubernetes security assessment",requires_registry:!0,requires_k8s:!0}],ke={image:e.jsx(U,{className:"w-5 h-5"}),dockerfile:e.jsx(H,{className:"w-5 h-5"}),runtime:e.jsx(xe,{className:"w-5 h-5"}),k8s_manifest:e.jsx(O,{className:"w-5 h-5"}),k8s_cluster:e.jsx(O,{className:"w-5 h-5"}),comprehensive:e.jsx(k,{className:"w-5 h-5"})};function Ce({onSubmit:n,isLoading:o,scanTypes:r=_e}){const[x,l]=d.useState(""),[h,_]=d.useState("image"),[p,u]=d.useState(""),[$,b]=d.useState(""),[C,R]=d.useState(""),[a,y]=d.useState(""),[t,c]=d.useState(""),[m,j]=d.useState(""),[q,z]=d.useState(!1),v=r.find(i=>i.id===h),g=i=>{i.preventDefault();const P={name:x||`Container Scan - ${new Date().toLocaleString()}`,scan_type:h,target:p,demo_mode:q};v!=null&&v.requires_registry&&$&&(P.registry_url=$,C&&(P.registry_username=C),a&&(P.registry_password=a)),v!=null&&v.requires_k8s&&(t&&(P.k8s_context=t),m&&(P.k8s_namespace=m)),n(P)},K=()=>{switch(h){case"image":return"e.g., nginx:latest, myregistry.com/myapp:v1.0";case"dockerfile":return"Path to Dockerfile or directory containing Dockerfile";case"runtime":return"Container ID or name";case"k8s_manifest":return"Path to Kubernetes manifest(s) or directory";case"k8s_cluster":return"Kubernetes cluster context name";case"comprehensive":return"Image name or K8s namespace";default:return"Enter target"}};return e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-300 mb-2",children:"Scan Name"}),e.jsx(I,{id:"name",value:x,onChange:i=>l(i.target.value),placeholder:"Optional: Give your scan a name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Scan Type"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:r.map(i=>e.jsxs("button",{type:"button",onClick:()=>_(i.id),className:`p-4 rounded-lg border-2 text-left transition-all ${h===i.id?"border-cyan-500 bg-cyan-500/10":"border-gray-700 bg-gray-800/50 hover:border-gray-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:h===i.id?"text-cyan-400":"text-gray-400",children:ke[i.id]}),e.jsx("span",{className:`font-medium ${h===i.id?"text-cyan-400":"text-gray-200"}`,children:i.name})]}),e.jsx("p",{className:"text-sm text-gray-400",children:i.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[i.requires_registry&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded",children:"Registry"}),i.requires_k8s&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-purple-500/20 text-purple-400 rounded",children:"K8s"})]})]},i.id))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"target",className:"block text-sm font-medium text-gray-300 mb-2",children:"Target"}),e.jsx(I,{id:"target",value:p,onChange:i=>u(i.target.value),placeholder:K(),required:!0})]}),(v==null?void 0:v.requires_registry)&&e.jsxs("div",{className:"space-y-4 p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-300 flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"Container Registry Settings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"registryUrl",className:"block text-xs text-gray-400 mb-1",children:"Registry URL (optional)"}),e.jsx(I,{id:"registryUrl",value:$,onChange:i=>b(i.target.value),placeholder:"e.g., registry.example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"registryUsername",className:"block text-xs text-gray-400 mb-1",children:"Username"}),e.jsx(I,{id:"registryUsername",value:C,onChange:i=>R(i.target.value),placeholder:"Optional"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"registryPassword",className:"block text-xs text-gray-400 mb-1",children:"Password/Token"}),e.jsx(I,{id:"registryPassword",type:"password",value:a,onChange:i=>y(i.target.value),placeholder:"Optional"})]})]})]}),(v==null?void 0:v.requires_k8s)&&e.jsxs("div",{className:"space-y-4 p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-300 flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"Kubernetes Settings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"k8sContext",className:"block text-xs text-gray-400 mb-1",children:"K8s Context (optional)"}),e.jsx(I,{id:"k8sContext",value:t,onChange:i=>c(i.target.value),placeholder:"e.g., minikube, production-cluster"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"k8sNamespace",className:"block text-xs text-gray-400 mb-1",children:"Namespace (optional)"}),e.jsx(I,{id:"k8sNamespace",value:m,onChange:i=>j(i.target.value),placeholder:"e.g., default, production"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-yellow-500/10 rounded-lg border border-yellow-500/30",children:[e.jsx(we,{id:"demoMode",checked:q,onChange:i=>z(i)}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"demoMode",className:"text-sm font-medium text-yellow-400 cursor-pointer",children:"Demo Mode"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Run with simulated data for testing. No actual container scanning will be performed."})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-500/10 rounded-lg border border-blue-500/30",children:[e.jsx(M,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-gray-300",children:[e.jsx("p",{className:"font-medium text-blue-400 mb-1",children:"Scanning Requirements"}),e.jsxs("ul",{className:"list-disc list-inside text-gray-400 space-y-1",children:[e.jsx("li",{children:"Image scans require Trivy or Grype to be installed"}),e.jsx("li",{children:"Runtime scans require Docker daemon access"}),e.jsx("li",{children:"K8s scans require kubectl configured with cluster access"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(A,{type:"submit",disabled:o||!p,children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),o?"Starting Scan...":"Start Scan"]})})]})}const w={critical:{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500"},high:{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500"},low:{bg:"bg-blue-500/20",text:"text-blue-400",border:"border-blue-500"},info:{bg:"bg-gray-500/20",text:"text-gray-400",border:"border-gray-500"}},ne={pending:{bg:"bg-yellow-500/20",text:"text-yellow-400"},running:{bg:"bg-blue-500/20",text:"text-blue-400"},completed:{bg:"bg-green-500/20",text:"text-green-400"},failed:{bg:"bg-red-500/20",text:"text-red-400"}},ie={open:{bg:"bg-red-500/20",text:"text-red-400"},resolved:{bg:"bg-green-500/20",text:"text-green-400"},accepted:{bg:"bg-blue-500/20",text:"text-blue-400"},false_positive:{bg:"bg-gray-500/20",text:"text-gray-400"}};function Fe({scanId:n,onDelete:o}){var X,J,Z,ee,se;const[r,x]=d.useState(null),[l,h]=d.useState(new Set),[_,p]=d.useState(new Set),[u,$]=d.useState("all"),[b,C]=d.useState("all"),R=oe(),{data:a,isLoading:y,refetch:t}=E({queryKey:["containerScan",n],queryFn:()=>F.getScan(n).then(s=>s.data),refetchInterval:s=>{var te,ae;const f=(ae=(te=s.state.data)==null?void 0:te.scan)==null?void 0:ae.status;return f==="running"||f==="pending"?3e3:!1}}),{data:c=[],isLoading:m}=E({queryKey:["containerFindings",n,u,b],queryFn:()=>F.getFindings(n,{severity:u!=="all"?u:void 0,status:b!=="all"?b:void 0}).then(s=>s.data),enabled:((X=a==null?void 0:a.scan)==null?void 0:X.status)==="completed"}),{data:j=[]}=E({queryKey:["containerImages",n],queryFn:()=>F.getImages(n).then(s=>s.data),enabled:((J=a==null?void 0:a.scan)==null?void 0:J.status)==="completed"}),{data:q=[]}=E({queryKey:["containerResources",n],queryFn:()=>F.getResources(n).then(s=>s.data),enabled:((Z=a==null?void 0:a.scan)==null?void 0:Z.status)==="completed"}),z=T({mutationFn:({findingId:s,status:f})=>F.updateFindingStatus(s,{status:f}),onSuccess:()=>{R.invalidateQueries({queryKey:["containerFindings",n]}),R.invalidateQueries({queryKey:["containerScan",n]}),S.success("Finding status updated")},onError:()=>{S.error("Failed to update finding status")}}),v=T({mutationFn:()=>F.deleteScan(n),onSuccess:()=>{S.success("Scan deleted"),o==null||o()},onError:()=>{S.error("Failed to delete scan")}}),g=a==null?void 0:a.scan,K=a==null?void 0:a.summary;if(y)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(D,{className:"w-8 h-8 text-cyan-400 animate-spin"})});if(!g)return e.jsx("div",{className:"text-center p-12 text-gray-400",children:"Scan not found"});const i=s=>{const f=new Set(l);f.has(s)?f.delete(s):f.add(s),h(f)},P=s=>{const f=new Set(_);f.has(s)?f.delete(s):f.add(s),p(f)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:g.name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"w-4 h-4"}),g.scan_type.replace("_"," ")]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(me,{className:"w-4 h-4"}),new Date(g.created_at).toLocaleString()]})]}),e.jsx("p",{className:"text-gray-300 mt-2",children:g.target})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(N,{className:`${(ee=ne[g.status])==null?void 0:ee.bg} ${(se=ne[g.status])==null?void 0:se.text}`,children:[g.status==="running"&&e.jsx(D,{className:"w-3 h-3 mr-1 animate-spin"}),g.status==="completed"&&e.jsx(L,{className:"w-3 h-3 mr-1"}),g.status==="failed"&&e.jsx(re,{className:"w-3 h-3 mr-1"}),g.status]}),e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>t(),children:e.jsx(D,{className:"w-4 h-4"})}),e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>v.mutate(),children:e.jsx(ge,{className:"w-4 h-4 text-red-400"})})]})]}),g.error_message&&e.jsx("div",{className:"mt-4 p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400",children:g.error_message})]}),K&&g.status==="completed"&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:K.total_findings}),e.jsx("div",{className:"text-sm text-gray-400",children:"Total Findings"})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${w.critical.border} ${w.critical.bg}`,children:[e.jsx("div",{className:`text-2xl font-bold ${w.critical.text}`,children:K.critical_count}),e.jsx("div",{className:"text-sm text-gray-400",children:"Critical"})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${w.high.border} ${w.high.bg}`,children:[e.jsx("div",{className:`text-2xl font-bold ${w.high.text}`,children:K.high_count}),e.jsx("div",{className:"text-sm text-gray-400",children:"High"})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${w.medium.border} ${w.medium.bg}`,children:[e.jsx("div",{className:`text-2xl font-bold ${w.medium.text}`,children:K.medium_count}),e.jsx("div",{className:"text-sm text-gray-400",children:"Medium"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:K.images_scanned}),e.jsx("div",{className:"text-sm text-gray-400",children:"Images"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:K.resources_scanned}),e.jsx("div",{className:"text-sm text-gray-400",children:"K8s Resources"})]})]}),(g.status==="running"||g.status==="pending")&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 border border-gray-700 text-center",children:[e.jsx(D,{className:"w-12 h-12 text-cyan-400 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300",children:"Scan in progress..."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"This page will automatically refresh when the scan completes."})]}),j.length>0&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-cyan-400"}),"Scanned Images (",j.length,")"]})}),e.jsx("div",{className:"divide-y divide-gray-700",children:j.map(s=>e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{onClick:()=>i(s.id),className:"w-full flex items-center justify-between text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[l.has(s.id)?e.jsx(le,{className:"w-4 h-4 text-gray-400"}):e.jsx(B,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"font-mono text-cyan-400",children:[s.image_name,":",s.image_tag]})]}),s.registry&&e.jsx("span",{className:"text-sm text-gray-400",children:s.registry})]}),l.has(s.id)&&e.jsxs("div",{className:"mt-3 ml-7 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[s.os&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"OS:"})," ",e.jsx("span",{className:"text-gray-200",children:s.os})]}),s.architecture&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Arch:"})," ",e.jsx("span",{className:"text-gray-200",children:s.architecture})]}),s.layer_count&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Layers:"})," ",e.jsx("span",{className:"text-gray-200",children:s.layer_count})]}),s.size_bytes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Size:"})," ",e.jsxs("span",{className:"text-gray-200",children:[(s.size_bytes/1024/1024).toFixed(1)," MB"]})]})]})]},s.id))})]}),q.length>0&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5 text-purple-400"}),"Kubernetes Resources (",q.length,")"]})}),e.jsx("div",{className:"divide-y divide-gray-700",children:q.map(s=>e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{onClick:()=>P(s.id),className:"w-full flex items-center justify-between text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[_.has(s.id)?e.jsx(le,{className:"w-4 h-4 text-gray-400"}):e.jsx(B,{className:"w-4 h-4 text-gray-400"}),e.jsx(N,{className:"bg-purple-500/20 text-purple-400",children:s.resource_type}),e.jsx("span",{className:"text-gray-200",children:s.name})]}),s.namespace&&e.jsxs("span",{className:"text-sm text-gray-400",children:["ns: ",s.namespace]})]}),_.has(s.id)&&e.jsxs("div",{className:"mt-3 ml-7 text-sm text-gray-400",children:[s.api_version&&e.jsxs("div",{children:["API Version: ",s.api_version]}),s.spec_summary&&e.jsx("div",{className:"mt-1",children:s.spec_summary})]})]},s.id))})]}),g.status==="completed"&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-cyan-400"}),"Security Findings (",c.length,")"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:u,onChange:s=>$(s.target.value),className:"bg-gray-700 border border-gray-600 rounded px-3 py-1 text-sm text-gray-200",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"info",children:"Info"})]}),e.jsxs("select",{value:b,onChange:s=>C(s.target.value),className:"bg-gray-700 border border-gray-600 rounded px-3 py-1 text-sm text-gray-200",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"accepted",children:"Accepted"}),e.jsx("option",{value:"false_positive",children:"False Positive"})]})]})]})}),m?e.jsx("div",{className:"p-8 text-center",children:e.jsx(D,{className:"w-6 h-6 text-gray-400 animate-spin mx-auto"})}):c.length===0?e.jsx("div",{className:"p-8 text-center text-gray-400",children:u!=="all"||b!=="all"?"No findings match the current filters":"No security findings detected"}):e.jsx("div",{className:"divide-y divide-gray-700",children:c.map(s=>e.jsx("div",{className:`p-4 cursor-pointer hover:bg-gray-700/50 transition-colors ${(r==null?void 0:r.id)===s.id?"bg-gray-700/50":""}`,onClick:()=>x(s),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:`mt-0.5 ${w[s.severity].text}`,children:[s.severity==="critical"&&e.jsx(W,{className:"w-5 h-5"}),s.severity==="high"&&e.jsx(k,{className:"w-5 h-5"}),s.severity==="medium"&&e.jsx(k,{className:"w-5 h-5"}),s.severity==="low"&&e.jsx(M,{className:"w-5 h-5"}),s.severity==="info"&&e.jsx(M,{className:"w-5 h-5"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-200",children:s.title}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[e.jsx(N,{className:`${w[s.severity].bg} ${w[s.severity].text}`,children:s.severity}),e.jsx(N,{className:"bg-gray-700 text-gray-300",children:s.finding_type.replace("_"," ")}),s.cve_id&&e.jsx(N,{className:"bg-purple-500/20 text-purple-400",children:s.cve_id}),s.cvss_score&&e.jsxs(N,{className:"bg-gray-700 text-gray-300",children:["CVSS: ",s.cvss_score.toFixed(1)]}),s.package_name&&e.jsxs(N,{className:"bg-blue-500/20 text-blue-400",children:[s.package_name,s.installed_version&&` @ ${s.installed_version}`]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(N,{className:`${ie[s.status].bg} ${ie[s.status].text}`,children:s.status.replace("_"," ")})})]})},s.id))})]}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto border border-gray-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:r.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(N,{className:`${w[r.severity].bg} ${w[r.severity].text}`,children:r.severity}),r.cve_id&&e.jsxs("a",{href:`https://nvd.nist.gov/vuln/detail/${r.cve_id}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-cyan-400 hover:text-cyan-300",children:[r.cve_id,e.jsx(pe,{className:"w-3 h-3"})]})]})]}),e.jsx("button",{onClick:()=>x(null),className:"text-gray-400 hover:text-gray-200",children:e.jsx(re,{className:"w-6 h-6"})})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Description"}),e.jsx("p",{className:"text-gray-200",children:r.description})]}),r.package_name&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Affected Package"}),e.jsxs("p",{className:"text-gray-200",children:[r.package_name,r.installed_version&&` (${r.installed_version})`]})]}),r.fixed_version&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Fixed In"}),e.jsx("p",{className:"text-green-400",children:r.fixed_version})]}),r.file_path&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Location"}),e.jsxs("p",{className:"font-mono text-gray-200",children:[r.file_path,r.line_number&&`:${r.line_number}`]})]}),r.remediation&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Remediation"}),e.jsx("p",{className:"text-gray-200",children:r.remediation})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"Update Status"}),e.jsx("div",{className:"flex items-center gap-2",children:["open","resolved","accepted","false_positive"].map(s=>e.jsx(A,{variant:r.status===s?"primary":"ghost",size:"sm",onClick:()=>{z.mutate({findingId:r.id,status:s}),x({...r,status:s})},children:s.replace("_"," ")},s))})]})]})]})})]})}const V={critical:{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500"},high:{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500"},low:{bg:"bg-blue-500/20",text:"text-blue-400",border:"border-blue-500"},info:{bg:"bg-gray-500/20",text:"text-gray-400",border:"border-gray-500"}},$e=`FROM ubuntu:latest

ENV DATABASE_PASSWORD=secretpassword123
ENV API_KEY=sk-1234567890abcdef

RUN apt-get update && apt-get install -y curl
RUN chmod 777 /app
RUN curl https://example.com/script.sh | bash

USER root

EXPOSE 22 3306

CMD ["./app"]
`;function Re(){const[n,o]=d.useState(""),[r,x]=d.useState("Dockerfile"),[l,h]=d.useState(null),[_,p]=d.useState(null),u=T({mutationFn:()=>F.analyzeDockerfile({content:n,filename:r}).then(t=>t.data),onSuccess:t=>{h(t),t.issues.length===0?S.success("No security issues found!"):S.info(`Found ${t.issues.length} security issue(s)`)},onError:()=>{S.error("Failed to analyze Dockerfile")}}),$=t=>{var m;const c=(m=t.target.files)==null?void 0:m[0];if(c){x(c.name);const j=new FileReader;j.onload=q=>{var z;o((z=q.target)==null?void 0:z.result)},j.readAsText(c)}},b=()=>{o($e),x("Dockerfile.example"),h(null)},C=(t,c)=>{navigator.clipboard.writeText(t),p(c),setTimeout(()=>p(null),2e3)},R=t=>{switch(t){case"critical":return e.jsx(W,{className:"w-5 h-5"});case"high":return e.jsx(k,{className:"w-5 h-5"});case"medium":return e.jsx(k,{className:"w-5 h-5"});case"low":return e.jsx(M,{className:"w-5 h-5"});case"info":return e.jsx(M,{className:"w-5 h-5"})}},a=t=>t>=80?"text-green-400":t>=60?"text-yellow-400":t>=40?"text-orange-400":"text-red-400",y=t=>t>=90?"A":t>=80?"B":t>=70?"C":t>=60?"D":"F";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(H,{className:"w-5 h-5 text-cyan-400"}),"Dockerfile Analyzer"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{variant:"ghost",size:"sm",onClick:b,children:"Load Example"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"Dockerfile,.dockerfile",onChange:$,className:"hidden"}),e.jsxs("span",{className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-gray-700 hover:bg-gray-600 rounded-lg text-gray-200 transition-colors",children:[e.jsx(ue,{className:"w-4 h-4"}),"Upload"]})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Paste your Dockerfile content below:"}),e.jsx("textarea",{value:n,onChange:t=>o(t.target.value),placeholder:`FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

COPY . .

USER node
EXPOSE 3000
CMD ["node", "server.js"]`,className:"w-full h-64 bg-gray-900 border border-gray-700 rounded-lg p-4 font-mono text-sm text-gray-200 placeholder-gray-600 focus:outline-none focus:border-cyan-500 resize-none"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-400",children:r&&`File: ${r}`}),e.jsxs(A,{onClick:()=>u.mutate(),disabled:!n.trim()||u.isPending,children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),u.isPending?"Analyzing...":"Analyze Dockerfile"]})]})]}),l&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Security Score"}),e.jsxs("div",{className:`text-3xl font-bold ${a(l.security_score)}`,children:[l.security_score,"/100"]})]}),e.jsx("div",{className:`text-4xl font-bold ${a(l.security_score)}`,children:y(l.security_score)})]})}),e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Best Practices"}),e.jsxs("div",{className:`text-3xl font-bold ${a(l.best_practices_score)}`,children:[l.best_practices_score,"/100"]})]}),e.jsx("div",{className:`text-4xl font-bold ${a(l.best_practices_score)}`,children:y(l.best_practices_score)})]})}),e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Base Image"}),e.jsx("div",{className:"text-lg font-medium text-gray-200",children:l.base_image||"Unknown"}),l.base_image_tag&&e.jsxs("div",{className:"text-sm text-gray-400",children:["Tag: ",l.base_image_tag]})]}),l.base_image_tag==="latest"?e.jsx(k,{className:"w-8 h-8 text-yellow-400"}):e.jsx(L,{className:"w-8 h-8 text-green-400"})]})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:l.issues.length===0?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-5 h-5 text-green-400"}),"No Security Issues Found"]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-5 h-5 text-yellow-400"}),"Security Issues (",l.issues.length,")"]})})}),l.issues.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(L,{className:"w-12 h-12 text-green-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300",children:"Your Dockerfile follows security best practices!"})]}):e.jsx("div",{className:"divide-y divide-gray-700",children:l.issues.map((t,c)=>e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:V[t.severity].text,children:R(t.severity)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium text-gray-200",children:t.title}),e.jsx(N,{className:`${V[t.severity].bg} ${V[t.severity].text}`,children:t.severity}),t.line_number&&e.jsxs(N,{className:"bg-gray-700 text-gray-300",children:["Line ",t.line_number]})]}),e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:t.description}),t.instruction&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-xs text-gray-500 uppercase",children:"Problematic Code:"}),e.jsxs("div",{className:"mt-1 bg-red-500/10 border border-red-500/30 rounded p-2 font-mono text-sm text-red-300 flex items-center justify-between",children:[e.jsx("code",{className:"truncate",children:t.instruction}),e.jsx("button",{onClick:()=>C(t.instruction||"",c),className:"ml-2 text-gray-400 hover:text-gray-200",children:_===c?e.jsx(be,{className:"w-4 h-4 text-green-400"}):e.jsx(je,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded p-3",children:[e.jsx("span",{className:"text-xs text-green-500 uppercase block mb-1",children:"Remediation:"}),e.jsx("p",{className:"text-sm text-green-300",children:t.remediation})]}),t.references&&t.references.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-xs text-gray-500 uppercase",children:"References:"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:t.references.map((m,j)=>e.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-cyan-400 hover:text-cyan-300",children:m},j))})]})]})]})},c))})]})]})]})}const Y={critical:{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500"},high:{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500"},low:{bg:"bg-blue-500/20",text:"text-blue-400",border:"border-blue-500"},info:{bg:"bg-gray-500/20",text:"text-gray-400",border:"border-gray-500"}},Ae={pod_security:e.jsx(he,{className:"w-4 h-4"}),rbac:e.jsx(ve,{className:"w-4 h-4"}),network_policy:e.jsx(Ne,{className:"w-4 h-4"}),resource_limits:e.jsx(xe,{className:"w-4 h-4"}),misconfiguration:e.jsx(k,{className:"w-4 h-4"})},qe=`apiVersion: apps/v1
kind: Deployment
metadata:
  name: vulnerable-app
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      app: vulnerable-app
  template:
    metadata:
      labels:
        app: vulnerable-app
    spec:
      containers:
      - name: app
        image: myapp:latest
        securityContext:
          privileged: true
          runAsRoot: true
        ports:
        - containerPort: 8080
---
apiVersion: v1
kind: Service
metadata:
  name: vulnerable-app-svc
spec:
  type: LoadBalancer
  selector:
    app: vulnerable-app
  ports:
  - port: 80
    targetPort: 8080
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: app-admin
subjects:
- kind: ServiceAccount
  name: default
  namespace: default
roleRef:
  kind: ClusterRole
  name: cluster-admin
  apiGroup: rbac.authorization.k8s.io
`;function ze(){const[n,o]=d.useState(""),[r,x]=d.useState("manifest.yaml"),[l,h]=d.useState(null),[_,p]=d.useState(!0),u=T({mutationFn:()=>F.analyzeManifest({content:n,filename:r}).then(t=>t.data),onSuccess:t=>{h(t),t.issues.length===0?S.success("No security issues found!"):S.info(`Found ${t.issues.length} security issue(s)`)},onError:()=>{S.error("Failed to analyze manifest")}}),$=t=>{var m;const c=(m=t.target.files)==null?void 0:m[0];if(c){x(c.name);const j=new FileReader;j.onload=q=>{var z;o((z=q.target)==null?void 0:z.result)},j.readAsText(c)}},b=()=>{o(qe),x("vulnerable-deployment.yaml"),h(null)},C=t=>{switch(t){case"critical":return e.jsx(W,{className:"w-5 h-5"});case"high":return e.jsx(k,{className:"w-5 h-5"});case"medium":return e.jsx(k,{className:"w-5 h-5"});case"low":return e.jsx(M,{className:"w-5 h-5"});case"info":return e.jsx(M,{className:"w-5 h-5"})}},R=t=>t>=80?"text-green-400":t>=60?"text-yellow-400":t>=40?"text-orange-400":"text-red-400",a=t=>t>=90?"A":t>=80?"B":t>=70?"C":t>=60?"D":"F",y=(l==null?void 0:l.issues.reduce((t,c)=>{const m=c.finding_type;return t[m]||(t[m]=[]),t[m].push(c),t},{}))||{};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5 text-purple-400"}),"Kubernetes Manifest Analyzer"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{variant:"ghost",size:"sm",onClick:b,children:"Load Example"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:".yaml,.yml,.json",onChange:$,className:"hidden"}),e.jsxs("span",{className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-gray-700 hover:bg-gray-600 rounded-lg text-gray-200 transition-colors",children:[e.jsx(ue,{className:"w-4 h-4"}),"Upload"]})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Paste your Kubernetes manifest (YAML or JSON):"}),e.jsx("textarea",{value:n,onChange:t=>o(t.target.value),placeholder:`apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-app
spec:
  replicas: 3
  ...`,className:"w-full h-64 bg-gray-900 border border-gray-700 rounded-lg p-4 font-mono text-sm text-gray-200 placeholder-gray-600 focus:outline-none focus:border-purple-500 resize-none"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-400",children:r&&`File: ${r}`}),e.jsxs(A,{onClick:()=>u.mutate(),disabled:!n.trim()||u.isPending,className:"bg-purple-600 hover:bg-purple-700",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),u.isPending?"Analyzing...":"Analyze Manifest"]})]})]}),l&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Security Score"}),e.jsxs("div",{className:`text-3xl font-bold ${R(l.security_score)}`,children:[l.security_score,"/100"]})]}),e.jsx("div",{className:`text-4xl font-bold ${R(l.security_score)}`,children:a(l.security_score)})]})}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Resources Analyzed"}),e.jsx("div",{className:"text-3xl font-bold text-white",children:l.resources_analyzed})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Issues Found"}),e.jsx("div",{className:`text-3xl font-bold ${l.issues.length>0?"text-yellow-400":"text-green-400"}`,children:l.issues.length})]})]}),Object.keys(l.by_resource_type).length>0&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Resource Types Analyzed"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(l.by_resource_type).map(([t,c])=>e.jsxs(N,{className:"bg-purple-500/20 text-purple-400 px-3 py-1",children:[t,": ",c]},t))})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:l.issues.length===0?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-5 h-5 text-green-400"}),"No Security Issues Found"]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-5 h-5 text-yellow-400"}),"Security Issues (",l.issues.length,")"]})}),l.issues.length>0&&e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>p(!_),children:_?"Show All":"Group by Type"})]}),l.issues.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(L,{className:"w-12 h-12 text-green-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300",children:"Your Kubernetes manifests follow security best practices!"})]}):_?e.jsx("div",{className:"divide-y divide-gray-700",children:Object.entries(y).map(([t,c])=>e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"text-purple-400",children:Ae[t]||e.jsx(k,{className:"w-4 h-4"})}),e.jsxs("h4",{className:"font-medium text-gray-200 capitalize",children:[t.replace("_"," ")," Issues (",c.length,")"]})]}),e.jsx("div",{className:"space-y-3 ml-6",children:c.map((m,j)=>e.jsx(ce,{issue:m,getSeverityIcon:C},j))})]},t))}):e.jsx("div",{className:"divide-y divide-gray-700",children:l.issues.map((t,c)=>e.jsx("div",{className:"p-4",children:e.jsx(ce,{issue:t,getSeverityIcon:C})},c))})]})]})]})}function ce({issue:n,getSeverityIcon:o}){return e.jsx("div",{className:"bg-gray-900/50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Y[n.severity].text,children:o(n.severity)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("h4",{className:"font-medium text-gray-200",children:n.title}),e.jsx(N,{className:`${Y[n.severity].bg} ${Y[n.severity].text}`,children:n.severity})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-sm",children:[e.jsx(N,{className:"bg-gray-700 text-gray-300",children:n.resource_type}),e.jsx("span",{className:"text-gray-400",children:n.resource_name})]}),e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:n.description}),e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded p-3",children:[e.jsx("span",{className:"text-xs text-green-500 uppercase block mb-1",children:"Remediation:"}),e.jsx("p",{className:"text-sm text-green-300",children:n.remediation})]}),n.references&&n.references.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-xs text-gray-500 uppercase",children:"References:"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:n.references.map((r,x)=>e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-cyan-400 hover:text-cyan-300",children:r},x))})]})]})]})})}const de={pending:{bg:"bg-yellow-500/20",text:"text-yellow-400"},running:{bg:"bg-blue-500/20",text:"text-blue-400"},completed:{bg:"bg-green-500/20",text:"text-green-400"},failed:{bg:"bg-red-500/20",text:"text-red-400"}};function Me(){const[n,o]=d.useState("scans"),[r,x]=d.useState(null),l=oe(),{data:h,isLoading:_}=E({queryKey:["containerScans"],queryFn:()=>F.listScans().then(a=>a.data)}),{data:p}=E({queryKey:["containerScanTypes"],queryFn:()=>F.getScanTypes().then(a=>a.data)}),u=T({mutationFn:a=>F.createScan(a).then(y=>y.data),onSuccess:a=>{l.invalidateQueries({queryKey:["containerScans"]}),S.success("Scan started successfully"),x(a.id),o("scans")},onError:()=>{S.error("Failed to start scan")}}),$=T({mutationFn:a=>F.deleteScan(a),onSuccess:()=>{l.invalidateQueries({queryKey:["containerScans"]}),S.success("Scan deleted"),r&&x(null)},onError:()=>{S.error("Failed to delete scan")}}),b=(h==null?void 0:h.scans)||[],C=[{id:"scans",label:"Scan History",icon:e.jsx(fe,{className:"w-4 h-4"})},{id:"new-scan",label:"New Scan",icon:e.jsx(Q,{className:"w-4 h-4"})},{id:"dockerfile",label:"Dockerfile Analyzer",icon:e.jsx(H,{className:"w-4 h-4"})},{id:"k8s-manifest",label:"K8s Manifest Analyzer",icon:e.jsx(O,{className:"w-4 h-4"})}],R=a=>{const y=p==null?void 0:p.find(t=>t.id===a);return(y==null?void 0:y.name)||a.replace("_"," ")};return e.jsx(Se,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(U,{className:"w-8 h-8 text-cyan-400"}),"Container Security"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Scan Docker images, analyze Dockerfiles, and audit Kubernetes configurations"})]})}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:C.map(a=>e.jsxs("button",{onClick:()=>{o(a.id),a.id!=="scans"&&x(null)},className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${n===a.id?"border-cyan-500 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[a.icon,a.label]},a.id))})}),e.jsxs("div",{children:[n==="scans"&&!r&&e.jsx("div",{className:"space-y-4",children:_?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(D,{className:"w-8 h-8 text-cyan-400 animate-spin"})}):b.length===0?e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-12 text-center",children:[e.jsx(U,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Container Scans Yet"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Start by creating a new container security scan or analyzing a Dockerfile"}),e.jsxs(A,{onClick:()=>o("new-scan"),children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Create New Scan"]})]}):e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white",children:["Container Scans (",b.length,")"]}),e.jsxs(A,{size:"sm",onClick:()=>o("new-scan"),children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"New Scan"]})]}),e.jsx("div",{className:"divide-y divide-gray-700",children:b.map(a=>{var y,t;return e.jsx("div",{className:"p-4 hover:bg-gray-700/50 transition-colors cursor-pointer",onClick:()=>x(a.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-200",children:a.name}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-sm text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"w-4 h-4"}),R(a.scan_type)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(me,{className:"w-4 h-4"}),new Date(a.created_at).toLocaleDateString()]}),e.jsx("span",{className:"text-gray-500 truncate max-w-xs",children:a.target})]})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[a.status==="completed"&&e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[a.critical_count>0&&e.jsxs("span",{className:"text-red-400",children:[a.critical_count," Critical"]}),a.high_count>0&&e.jsxs("span",{className:"text-orange-400",children:[a.high_count," High"]}),e.jsxs("span",{className:"text-gray-400",children:[a.finding_count," Total"]})]}),e.jsxs(N,{className:`${(y=de[a.status])==null?void 0:y.bg} ${(t=de[a.status])==null?void 0:t.text}`,children:[a.status==="running"&&e.jsx(D,{className:"w-3 h-3 mr-1 animate-spin"}),a.status==="completed"&&e.jsx(L,{className:"w-3 h-3 mr-1"}),a.status==="failed"&&e.jsx(k,{className:"w-3 h-3 mr-1"}),a.status]}),e.jsx("button",{onClick:c=>{c.stopPropagation(),$.mutate(a.id)},className:"text-gray-400 hover:text-red-400 transition-colors",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx(B,{className:"w-5 h-5 text-gray-400"})]})]})},a.id)})})]})}),n==="scans"&&r&&e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>x(null),className:"flex items-center gap-2 text-gray-400 hover:text-gray-200 mb-4",children:[e.jsx(B,{className:"w-4 h-4 rotate-180"}),"Back to Scan List"]}),e.jsx(Fe,{scanId:r,onDelete:()=>{x(null),l.invalidateQueries({queryKey:["containerScans"]})}})]}),n==="new-scan"&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-6",children:"Create New Container Scan"}),e.jsx(Ce,{onSubmit:a=>u.mutate(a),isLoading:u.isPending,scanTypes:p})]}),n==="dockerfile"&&e.jsx(Re,{}),n==="k8s-manifest"&&e.jsx(ze,{})]})]})})}export{Me as default};
