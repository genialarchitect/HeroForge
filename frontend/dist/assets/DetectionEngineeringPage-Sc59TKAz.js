import{b as R,u as j,d as N,j as e}from"./vendor-state-DdX3IZQk.js";import{r as y}from"./vendor-react-Da1CiaFS.js";import{z as O,P as S,aR as v,S as C,aH as E,T as V,aD as D,m as $,b9 as k,bn as q,B as u,aq as X,aB as W,ae as Y,aG as J,at as P}from"./vendor-ui-wM19Qo8C.js";import{d as Z,a5 as o}from"./index-lpqdgxD1.js";import"./vendor-charts-CCbxmwBt.js";const h={getDashboard:()=>o.get("/detection-engineering/dashboard").then(t=>t.data),listDetections:t=>o.get("/detection-engineering/detections",{params:t}).then(a=>a.data),createDetection:t=>o.post("/detection-engineering/detections",t).then(a=>a.data),getDetection:t=>o.get(`/detection-engineering/detections/${t}`).then(a=>a.data),updateDetection:(t,a)=>o.put(`/detection-engineering/detections/${t}`,a).then(n=>n.data),deleteDetection:t=>o.delete(`/detection-engineering/detections/${t}`),promoteDetection:(t,a)=>o.post(`/detection-engineering/detections/${t}/promote`,{status:a}).then(n=>n.data),listTests:t=>o.get(`/detection-engineering/detections/${t}/tests`).then(a=>a.data),createTest:(t,a)=>o.post(`/detection-engineering/detections/${t}/tests`,a).then(n=>n.data),runTests:t=>o.post(`/detection-engineering/detections/${t}/tests/run`).then(a=>a.data),listTestRuns:t=>o.get(`/detection-engineering/detections/${t}/test-runs`).then(a=>a.data),listFalsePositives:t=>o.get("/detection-engineering/false-positives",{params:t}).then(a=>a.data),reportFalsePositive:t=>o.post("/detection-engineering/false-positives",t).then(a=>a.data),resolveFalsePositive:(t,a)=>o.put(`/detection-engineering/false-positives/${t}`,a).then(n=>n.data),getCoverage:()=>o.get("/detection-engineering/coverage").then(t=>t.data),getGaps:()=>o.get("/detection-engineering/gaps").then(t=>t.data)},M={critical:{bg:"bg-red-500/20",text:"text-red-400"},high:{bg:"bg-orange-500/20",text:"text-orange-400"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400"},low:{bg:"bg-blue-500/20",text:"text-blue-400"},informational:{bg:"bg-gray-500/20",text:"text-gray-400"}},L={draft:{bg:"bg-gray-500/20",text:"text-gray-400"},testing:{bg:"bg-yellow-500/20",text:"text-yellow-400"},production:{bg:"bg-green-500/20",text:"text-green-400"},deprecated:{bg:"bg-red-500/20",text:"text-red-400"},pending:{bg:"bg-orange-500/20",text:"text-orange-400"},confirmed:{bg:"bg-red-500/20",text:"text-red-400"},rejected:{bg:"bg-gray-500/20",text:"text-gray-400"},tuned:{bg:"bg-cyan-500/20",text:"text-cyan-400"},passed:{bg:"bg-green-500/20",text:"text-green-400"},failed:{bg:"bg-red-500/20",text:"text-red-400"},running:{bg:"bg-cyan-500/20",text:"text-cyan-400"}};function K({severity:t}){const a=M[t.toLowerCase()]||M.medium;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${a.bg} ${a.text}`,children:t.charAt(0).toUpperCase()+t.slice(1)})}function f({status:t}){const a=L[t.toLowerCase()]||L.draft;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${a.bg} ${a.text}`,children:t.charAt(0).toUpperCase()+t.slice(1)})}const A=({isOpen:t,onClose:a,title:n,children:r,size:d="md"})=>{if(!t)return null;const x={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:a}),e.jsxs("div",{className:`relative bg-gray-800 border border-gray-700 rounded-lg shadow-xl w-full ${x[d]} max-h-[90vh] overflow-y-auto mx-4`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 sticky top-0 bg-gray-800 z-10",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:n}),e.jsx("button",{onClick:a,className:"p-1 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-white",children:e.jsx(X,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4",children:r})]})]})},ee=({onSubmit:t,onCancel:a,isLoading:n})=>{const[r,d]=y.useState({name:"",description:"",logic_yaml:`title: Detection Rule
status: experimental
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    Image|endswith: '\\suspicious.exe'
  condition: selection
level: medium`,severity:"medium",mitre_techniques:"",mitre_tactics:""}),x=l=>{l.preventDefault(),t({...r,mitre_techniques:r.mitre_techniques?r.mitre_techniques.split(",").map(m=>m.trim()):[],mitre_tactics:r.mitre_tactics?r.mitre_tactics.split(",").map(m=>m.trim()):[]})};return e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{type:"text",required:!0,value:r.name,onChange:l=>d({...r,name:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Detection rule name..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:r.description,onChange:l=>d({...r,description:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",rows:2,placeholder:"What does this detection rule detect?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Detection Logic (YAML/Sigma) *"}),e.jsx("textarea",{required:!0,value:r.logic_yaml,onChange:l=>d({...r,logic_yaml:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white font-mono text-sm focus:ring-2 focus:ring-cyan-500",rows:12})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Severity"}),e.jsxs("select",{value:r.severity,onChange:l=>d({...r,severity:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"informational",children:"Informational"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"MITRE Techniques"}),e.jsx("input",{type:"text",value:r.mitre_techniques,onChange:l=>d({...r,mitre_techniques:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"T1059, T1055 (comma-separated)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"MITRE Tactics"}),e.jsx("input",{type:"text",value:r.mitre_tactics,onChange:l=>d({...r,mitre_tactics:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"execution, defense_evasion (comma-separated)"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:a,disabled:n,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors disabled:opacity-50",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:n,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors disabled:opacity-50 flex items-center gap-2",children:[n&&e.jsx(v,{className:"w-4 h-4 animate-spin"}),"Create Detection"]})]})]})},te=({detection:t,onClose:a})=>{const n=R(),[r,d]=y.useState("logic"),{data:x}=j({queryKey:["detection-tests",t.id],queryFn:()=>h.listTests(t.id)}),l=N({mutationFn:()=>h.runTests(t.id),onSuccess:()=>{n.invalidateQueries({queryKey:["detection-tests",t.id]}),u.success("Tests started")},onError:()=>u.error("Failed to run tests")}),m=N({mutationFn:i=>h.promoteDetection(t.id,i),onSuccess:()=>{n.invalidateQueries({queryKey:["detections"]}),u.success("Detection status updated")},onError:()=>u.error("Failed to update status")});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(K,{severity:t.severity}),e.jsx(f,{status:t.status}),e.jsxs("span",{className:"text-gray-500 text-sm",children:["v",t.version]})]}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:t.name}),t.description&&e.jsx("p",{className:"text-gray-400 mt-1",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.status==="draft"&&e.jsx("button",{onClick:()=>m.mutate("testing"),className:"px-3 py-1.5 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg text-sm",children:"Move to Testing"}),t.status==="testing"&&e.jsx("button",{onClick:()=>m.mutate("production"),className:"px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm",children:"Deploy to Production"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-900 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Quality Score"}),e.jsxs("p",{className:`text-2xl font-bold ${t.quality_score>=80?"text-green-400":t.quality_score>=60?"text-yellow-400":"text-red-400"}`,children:[t.quality_score,"%"]})]}),e.jsx("div",{className:"flex-1 h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${t.quality_score>=80?"bg-green-500":t.quality_score>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${t.quality_score}%`}})})]}),(t.mitre_techniques.length>0||t.mitre_tactics.length>0)&&e.jsxs("div",{className:"p-4 bg-gray-900 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"MITRE ATT&CK Mapping"}),e.jsxs("div",{className:"space-y-2",children:[t.mitre_tactics.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"text-xs text-gray-500 mr-2",children:"Tactics:"}),t.mitre_tactics.map((i,p)=>e.jsx("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-400 rounded text-xs",children:i},p))]}),t.mitre_techniques.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"text-xs text-gray-500 mr-2",children:"Techniques:"}),t.mitre_techniques.map((i,p)=>e.jsx("span",{className:"px-2 py-0.5 bg-cyan-500/20 text-cyan-400 rounded text-xs",children:i},p))]})]})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:["logic","tests","history"].map(i=>e.jsxs("button",{onClick:()=>d(i),className:`px-3 py-2 border-b-2 transition-colors text-sm ${r===i?"border-cyan-500 text-cyan-500":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[i.charAt(0).toUpperCase()+i.slice(1),i==="tests"&&x&&e.jsxs("span",{className:"ml-1 text-gray-500",children:["(",x.length,")"]})]},i))})}),e.jsxs("div",{className:"min-h-[200px]",children:[r==="logic"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400",children:"Detection Logic"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(t.logic_yaml),u.success("Copied to clipboard")},className:"p-2 hover:bg-gray-700 rounded-lg text-gray-400 hover:text-white",children:e.jsx(W,{className:"w-4 h-4"})})]}),e.jsx("pre",{className:"p-4 bg-gray-900 rounded-lg text-sm text-gray-300 font-mono overflow-x-auto",children:t.logic_yaml})]}),r==="tests"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>l.mutate(),disabled:l.isPending,className:"flex items-center gap-2 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg text-sm",children:[e.jsx(Y,{className:"w-4 h-4"}),"Run Tests"]})}),x&&x.length>0?e.jsx("div",{className:"space-y-2",children:x.map(i=>e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[i.status==="passed"?e.jsx(E,{className:"w-4 h-4 text-green-400"}):i.status==="failed"?e.jsx(J,{className:"w-4 h-4 text-red-400"}):e.jsx(P,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-white font-medium",children:i.test_name}),e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs",children:i.test_type})]}),e.jsx(f,{status:i.status})]}),i.error_message&&e.jsx("p",{className:"text-red-400 text-sm mt-2",children:i.error_message})]},i.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(q,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No tests defined"})]})]}),r==="history"&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(P,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Version history coming soon"})]})]})]})};function ne(){const t=R(),[a,n]=y.useState("dashboard"),[r,d]=y.useState(!1),[x,l]=y.useState(null),[m,i]=y.useState(""),[p,Q]=y.useState(""),{data:c,isLoading:I}=j({queryKey:["detection-dashboard"],queryFn:()=>h.getDashboard(),enabled:a==="dashboard"}),{data:w,isLoading:B}=j({queryKey:["detections",m,p],queryFn:()=>{const s={};return m&&(s.status=m),p&&(s.severity=p),h.listDetections(s)},enabled:a==="detections"}),{data:_,isLoading:z}=j({queryKey:["false-positives"],queryFn:()=>h.listFalsePositives(),enabled:a==="false_positives"}),{data:g,isLoading:G}=j({queryKey:["detection-coverage"],queryFn:()=>h.getCoverage(),enabled:a==="coverage"}),T=N({mutationFn:h.createDetection,onSuccess:()=>{t.invalidateQueries({queryKey:["detections"]}),t.invalidateQueries({queryKey:["detection-dashboard"]}),d(!1),u.success("Detection created")},onError:()=>u.error("Failed to create detection")}),F=N({mutationFn:({id:s,data:b})=>h.resolveFalsePositive(s,b),onSuccess:()=>{t.invalidateQueries({queryKey:["false-positives"]}),u.success("False positive resolved")},onError:()=>u.error("Failed to resolve")}),H=[{id:"dashboard",label:"Dashboard",icon:e.jsx($,{className:"w-4 h-4"})},{id:"detections",label:"Detections",icon:e.jsx(C,{className:"w-4 h-4"})},{id:"testing",label:"Testing",icon:e.jsx(q,{className:"w-4 h-4"})},{id:"coverage",label:"Coverage",icon:e.jsx(k,{className:"w-4 h-4"})},{id:"false_positives",label:"False Positives",icon:e.jsx(D,{className:"w-4 h-4"})}];return e.jsx(Z,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(O,{className:"w-8 h-8 text-cyan-500"}),"Detection Engineering"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Build, test, and manage detection rules"})]}),e.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(S,{className:"w-4 h-4"}),"New Detection"]})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:H.map(s=>e.jsxs("button",{onClick:()=>n(s.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${a===s.id?"border-cyan-500 text-cyan-500":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[s.icon,s.label]},s.id))})}),e.jsxs("div",{children:[a==="dashboard"&&e.jsx("div",{className:"space-y-6",children:I?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(v,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-cyan-500/20 rounded-lg",children:e.jsx(C,{className:"w-6 h-6 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:c.total_detections}),e.jsx("p",{className:"text-xs text-gray-400",children:"Total Detections"})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-green-500/20 rounded-lg",children:e.jsx(E,{className:"w-6 h-6 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:c.production_detections}),e.jsx("p",{className:"text-xs text-gray-400",children:"In Production"})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-purple-500/20 rounded-lg",children:e.jsx(V,{className:"w-6 h-6 text-purple-400"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-white",children:[c.coverage_percentage.toFixed(0),"%"]}),e.jsx("p",{className:"text-xs text-gray-400",children:"ATT&CK Coverage"})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-orange-500/20 rounded-lg",children:e.jsx(D,{className:"w-6 h-6 text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:c.pending_false_positives}),e.jsx("p",{className:"text-xs text-gray-400",children:"Pending FPs"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Quality Metrics"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-gray-400",children:"Test Pass Rate"}),e.jsxs("span",{className:"text-white font-medium",children:[c.test_pass_rate.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500",style:{width:`${c.test_pass_rate}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-gray-400",children:"Avg Quality Score"}),e.jsxs("span",{className:"text-white font-medium",children:[c.avg_quality_score.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${c.avg_quality_score>=80?"bg-green-500":c.avg_quality_score>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${c.avg_quality_score}%`}})})]})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Detection Status"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-gray-400",children:c.draft_detections}),e.jsx("p",{className:"text-sm text-gray-500",children:"Draft"})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-green-400",children:c.production_detections}),e.jsx("p",{className:"text-sm text-gray-500",children:"Production"})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-yellow-400",children:c.total_detections-c.production_detections-c.draft_detections-c.deprecated_detections}),e.jsx("p",{className:"text-sm text-gray-500",children:"Testing"})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-red-400",children:c.deprecated_detections}),e.jsx("p",{className:"text-sm text-gray-500",children:"Deprecated"})]})]})]})]})]}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx($,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Dashboard Data"}),e.jsx("p",{className:"text-gray-400",children:"Start creating detections to see metrics"})]})}),a==="detections"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:m,onChange:s=>i(s.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"testing",children:"Testing"}),e.jsx("option",{value:"production",children:"Production"}),e.jsx("option",{value:"deprecated",children:"Deprecated"})]}),e.jsxs("select",{value:p,onChange:s=>Q(s.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})]}),B?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(v,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):w&&w.length>0?e.jsx("div",{className:"space-y-3",children:w.map(s=>e.jsx("div",{onClick:()=>l(s),className:"bg-gray-800 border border-gray-700 rounded-lg p-4 hover:border-gray-600 cursor-pointer transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(K,{severity:s.severity}),e.jsx(f,{status:s.status}),!s.enabled&&e.jsx("span",{className:"px-2 py-0.5 bg-gray-600 text-gray-400 rounded text-xs",children:"Disabled"})]}),e.jsx("h3",{className:"text-lg font-medium text-white",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[s.mitre_techniques.slice(0,3).map((b,U)=>e.jsx("span",{className:"text-xs text-cyan-400",children:b},U)),s.mitre_techniques.length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",s.mitre_techniques.length-3," more"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-lg font-bold ${s.quality_score>=80?"text-green-400":s.quality_score>=60?"text-yellow-400":"text-red-400"}`,children:[s.quality_score,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Quality"})]})]})},s.id))}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(C,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Detections"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Create your first detection rule"}),e.jsxs("button",{onClick:()=>d(!0),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(S,{className:"w-4 h-4 inline mr-2"}),"Create Detection"]})]})]}),a==="coverage"&&e.jsx("div",{className:"space-y-6",children:G?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(v,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):g?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"MITRE ATT&CK Coverage"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-3xl font-bold ${g.coverage_percentage>=70?"text-green-400":g.coverage_percentage>=40?"text-yellow-400":"text-red-400"}`,children:[g.coverage_percentage.toFixed(1),"%"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[g.covered_techniques," / ",g.total_techniques," techniques"]})]})]}),e.jsx("div",{className:"h-4 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${g.coverage_percentage>=70?"bg-green-500":g.coverage_percentage>=40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${g.coverage_percentage}%`}})})]}),g.gaps&&g.gaps.length>0&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Priority Gaps"}),e.jsx("div",{className:"space-y-2",children:g.gaps.slice(0,10).map((s,b)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-cyan-400 font-mono",children:s.technique_id}),e.jsx("span",{className:"text-white",children:s.technique_name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:s.tactic}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${s.priority==="critical"?"bg-red-500/20 text-red-400":s.priority==="high"?"bg-orange-500/20 text-orange-400":"bg-yellow-500/20 text-yellow-400"}`,children:s.priority})]})]},b))})]})]}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(k,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Coverage Data"}),e.jsx("p",{className:"text-gray-400",children:"Add MITRE mappings to your detections"})]})}),a==="false_positives"&&e.jsx("div",{className:"space-y-4",children:z?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(v,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):_&&_.length>0?e.jsx("div",{className:"space-y-3",children:_.map(s=>e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx(f,{status:s.status})}),e.jsx("h3",{className:"text-lg font-medium text-white",children:s.detection_name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.description}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Reported ",new Date(s.created_at).toLocaleDateString()]})]}),s.status==="pending"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>F.mutate({id:s.id,data:{status:"confirmed"}}),className:"px-3 py-1.5 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm",children:"Confirm"}),e.jsx("button",{onClick:()=>F.mutate({id:s.id,data:{status:"rejected"}}),className:"px-3 py-1.5 bg-gray-600 hover:bg-gray-500 text-white rounded-lg text-sm",children:"Reject"})]})]})},s.id))}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(D,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No False Positives"}),e.jsx("p",{className:"text-gray-400",children:"No reported false positives to review"})]})}),a==="testing"&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(q,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"Detection Testing"}),e.jsx("p",{className:"text-gray-400",children:"Select a detection to view and run its tests"})]})]}),e.jsx(A,{isOpen:r,onClose:()=>d(!1),title:"Create Detection Rule",size:"lg",children:e.jsx(ee,{onSubmit:s=>T.mutate(s),onCancel:()=>d(!1),isLoading:T.isPending})}),e.jsx(A,{isOpen:!!x,onClose:()=>l(null),title:"Detection Details",size:"lg",children:x&&e.jsx(te,{detection:x,onClose:()=>l(null)})})]})})}export{ne as default};
