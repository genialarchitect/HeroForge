import{j as e,b as Z,u as S,d as U}from"./vendor-state-DdX3IZQk.js";import{r as x}from"./vendor-react-Da1CiaFS.js";import{i as Q,aA as de,am as ne,d as ce,G as je,a as fe,H as Ne,D as ke,S as H,B as k,ai as ve,P as W,j as we,L as q,bb as oe,av as T,az as ee,bC as Se,E as te,T as D,ay as z,al as xe,V as I,bS as Ce,ao as _e,aQ as qe,Q as Te,aT as Ae,aJ as le,aI as Fe,ax as Le}from"./vendor-ui-Bpofv04e.js";import{a2 as b,b as y,a3 as X}from"./index-BegQsQB4.js";import"./vendor-charts-DIEgeIZG.js";const me=({technique:s,isSelected:d=!1,onToggleSelect:a,expanded:n=!1,onToggleExpand:o})=>{const g=c=>({reconnaissance:"bg-blue-500/20 text-blue-400 border-blue-500/30","resource-development":"bg-purple-500/20 text-purple-400 border-purple-500/30","initial-access":"bg-red-500/20 text-red-400 border-red-500/30",execution:"bg-orange-500/20 text-orange-400 border-orange-500/30",persistence:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30","privilege-escalation":"bg-pink-500/20 text-pink-400 border-pink-500/30","defense-evasion":"bg-indigo-500/20 text-indigo-400 border-indigo-500/30","credential-access":"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",discovery:"bg-teal-500/20 text-teal-400 border-teal-500/30","lateral-movement":"bg-emerald-500/20 text-emerald-400 border-emerald-500/30",collection:"bg-lime-500/20 text-lime-400 border-lime-500/30","command-and-control":"bg-amber-500/20 text-amber-400 border-amber-500/30",exfiltration:"bg-rose-500/20 text-rose-400 border-rose-500/30",impact:"bg-red-600/20 text-red-500 border-red-600/30"})[c.toLowerCase()]||"bg-gray-500/20 text-gray-400 border-gray-500/30";return e.jsxs("div",{className:`bg-light-surface dark:bg-dark-surface border rounded-lg transition-all ${d?"border-primary ring-2 ring-primary/20":"border-light-border dark:border-dark-border hover:border-primary/50"}`,children:[e.jsx("div",{className:`p-4 ${o?"cursor-pointer":""}`,onClick:o,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[a&&e.jsx("button",{onClick:c=>{c.stopPropagation(),a(s.id)},className:`mt-1 w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${d?"bg-primary border-primary text-white":"border-gray-400 dark:border-gray-600 hover:border-primary"}`,children:d&&e.jsx(Q,{className:"w-3 h-3"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-mono text-gray-500 dark:text-gray-400",children:s.id}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded border ${g(s.tactic)}`,children:s.tactic_name})]}),e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:s.name}),!n&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-2 mt-1",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("a",{href:s.mitre_url,target:"_blank",rel:"noopener noreferrer",onClick:c=>c.stopPropagation(),className:"p-1.5 text-gray-400 hover:text-primary transition-colors",title:"View on MITRE ATT&CK",children:e.jsx(de,{className:"w-4 h-4"})}),o&&e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-gray-200 transition-colors",children:n?e.jsx(ne,{className:"w-4 h-4"}):e.jsx(ce,{className:"w-4 h-4"})})]})]})}),n&&e.jsxs("div",{className:"px-4 pb-4 border-t border-light-border dark:border-dark-border pt-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:s.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[s.platforms.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Platforms"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.platforms.map(c=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded",children:c},c))})]}),s.permissions_required.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(fe,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Permissions Required"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.permissions_required.map(c=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-yellow-500/20 text-yellow-400 rounded",children:c},c))})]}),s.data_sources.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(Ne,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Data Sources"})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.data_sources.slice(0,5).map(c=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-cyan-500/20 text-cyan-400 rounded",children:c},c)),s.data_sources.length>5&&e.jsxs("span",{className:"px-2 py-0.5 text-xs text-gray-400",children:["+",s.data_sources.length-5," more"]})]})]}),s.payloads.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(ke,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Payloads Available"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.payloads.map(c=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-500/20 text-green-400 rounded",children:c},c))})]})]}),s.detection&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Detection Guidance"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 line-clamp-4",children:s.detection})]})]})]})},De=({onScenarioCreated:s,onCancel:d})=>{const a=Z(),[n,o]=x.useState(""),[g,c]=x.useState(""),[u,v]=x.useState("dry_run"),[r,f]=x.useState([]),[j,C]=x.useState(300),[_,E]=x.useState(!1),[A,i]=x.useState(!0),[m,h]=x.useState([]),[w,K]=x.useState(""),[M,p]=x.useState(!1),[R,P]=x.useState("all"),[F,V]=x.useState(""),{data:l,isLoading:L}=S({queryKey:["bas-techniques"],queryFn:async()=>(await b.listTechniques()).data}),{data:O}=S({queryKey:["bas-tactics"],queryFn:async()=>(await b.listTactics()).data}),J=U({mutationFn:async t=>(await b.createScenario(t)).data,onSuccess:t=>{k.success("Scenario created successfully"),a.invalidateQueries({queryKey:["bas-scenarios"]}),s==null||s(t.id)},onError:t=>{k.error(t.message||"Failed to create scenario")}}),ge=(l==null?void 0:l.techniques)||[],ue=(O==null?void 0:O.tactics)||[],se=ge.filter(t=>{if(R!=="all"&&t.tactic!==R)return!1;if(F){const N=F.toLowerCase();return t.name.toLowerCase().includes(N)||t.id.toLowerCase().includes(N)||t.description.toLowerCase().includes(N)}return!0}),he=t=>{f(N=>N.includes(t)?N.filter(ye=>ye!==t):[...N,t])},re=()=>{w&&!m.includes(w)&&(h([...m,w]),K(""))},be=t=>{h(m.filter(N=>N!==t))},pe=()=>{if(!n.trim()){k.error("Please enter a scenario name");return}if(r.length===0){k.error("Please select at least one technique");return}J.mutate({name:n.trim(),description:g.trim(),execution_mode:u,technique_ids:r,targets:[],timeout_secs:j,parallel_execution:_,continue_on_failure:A,tags:m})},ae=t=>{switch(t){case"dry_run":return{label:"Dry Run",description:"Simulate techniques without actual execution. Safe for testing.",color:"text-green-400",icon:e.jsx(ee,{className:"w-4 h-4"})};case"safe":return{label:"Safe Mode",description:"Execute techniques with safety limits. Some artifacts may be created.",color:"text-yellow-400",icon:e.jsx(T,{className:"w-4 h-4"})};case"full":return{label:"Full Execution",description:"Execute techniques fully. Use with caution in controlled environments.",color:"text-red-400",icon:e.jsx(T,{className:"w-4 h-4"})}}};return e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg",children:[e.jsxs("div",{className:"p-4 border-b border-light-border dark:border-dark-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Create Attack Scenario"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Build a simulation scenario by selecting MITRE ATT&CK techniques"})]}),e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Scenario Name *"}),e.jsx("input",{type:"text",value:n,onChange:t=>o(t.target.value),placeholder:"e.g., Initial Access Validation",className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Execution Mode"}),e.jsxs("select",{value:u,onChange:t=>v(t.target.value),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"dry_run",children:"Dry Run (Safe)"}),e.jsx("option",{value:"safe",children:"Safe Mode"}),e.jsx("option",{value:"full",children:"Full Execution"})]}),e.jsx("p",{className:`text-xs mt-1 ${ae(u).color}`,children:ae(u).description})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:g,onChange:t=>c(t.target.value),placeholder:"Describe the purpose of this simulation scenario...",rows:2,className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:m.map(t=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-primary/20 text-primary rounded",children:[t,e.jsx("button",{onClick:()=>be(t),className:"hover:text-red-400",children:e.jsx(ve,{className:"w-3 h-3"})})]},t))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:w,onChange:t=>K(t.target.value),onKeyDown:t=>t.key==="Enter"&&re(),placeholder:"Add a tag...",className:"flex-1 px-3 py-2 text-sm bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"}),e.jsx(y,{variant:"outline",size:"sm",onClick:re,children:e.jsx(W,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>p(!M),className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200",children:[e.jsx(we,{className:"w-4 h-4"}),"Advanced Options",M?e.jsx(ne,{className:"w-4 h-4"}):e.jsx(ce,{className:"w-4 h-4"})]}),M&&e.jsxs("div",{className:"mt-4 p-4 bg-light-bg dark:bg-dark-bg rounded-lg space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Timeout (seconds)"}),e.jsx("input",{type:"number",value:j,onChange:t=>C(parseInt(t.target.value)||300),min:60,max:3600,className:"w-32 px-3 py-2 bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:_,onChange:t=>E(t.target.checked),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Execute techniques in parallel"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:A,onChange:t=>i(t.target.checked),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Continue on failure"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white",children:["Select Techniques (",r.length," selected)"]})}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx("input",{type:"text",value:F,onChange:t=>V(t.target.value),placeholder:"Search techniques...",className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"})}),e.jsxs("select",{value:R,onChange:t=>P(t.target.value),className:"px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Tactics"}),ue.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),L?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(q,{className:"w-8 h-8 text-primary animate-spin"})}):e.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[se.map(t=>e.jsx(me,{technique:t,isSelected:r.includes(t.id),onToggleSelect:he},t.id)),se.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No techniques match your filters"})]})]})]}),e.jsxs("div",{className:"p-4 border-t border-light-border dark:border-dark-border flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[r.length," technique",r.length!==1?"s":""," selected"]}),e.jsxs("div",{className:"flex gap-3",children:[d&&e.jsx(y,{variant:"outline",onClick:d,children:"Cancel"}),e.jsxs(y,{onClick:pe,disabled:J.isPending||r.length===0,children:[J.isPending?e.jsx(q,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Create Scenario"]})]})]})]})},Ee=({simulationId:s,onBack:d})=>{const{data:a,isLoading:n}=S({queryKey:["bas-simulation",s],queryFn:async()=>(await b.getSimulation(s)).data});if(n)return e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(q,{className:"w-8 h-8 text-primary animate-spin"})});if(!a)return e.jsx("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"Simulation not found"});const o=r=>{switch(r.toLowerCase()){case"completed":return e.jsx(ee,{className:"w-5 h-5 text-green-400"});case"failed":return e.jsx(z,{className:"w-5 h-5 text-red-400"});case"running":return e.jsx(I,{className:"w-5 h-5 text-cyan-400 animate-pulse"});default:return e.jsx(xe,{className:"w-5 h-5 text-yellow-400"})}},g=r=>r.error?e.jsx(z,{className:"w-4 h-4 text-red-400"}):r.detection_observed?e.jsx(te,{className:"w-4 h-4 text-green-400"}):r.status==="skipped"?e.jsx(Ce,{className:"w-4 h-4 text-gray-400"}):e.jsx(_e,{className:"w-4 h-4 text-yellow-400"}),c=r=>r>=80?"text-green-400":r>=60?"text-yellow-400":r>=40?"text-orange-400":"text-red-400",u=r=>r>=80?"bg-green-500/20 border-green-500/30":r>=60?"bg-yellow-500/20 border-yellow-500/30":r>=40?"bg-orange-500/20 border-orange-500/30":"bg-red-500/20 border-red-500/30",v=r=>r?r<1e3?`${r}ms`:`${(r/1e3).toFixed(1)}s`:"--";return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(y,{variant:"outline",size:"sm",onClick:d,children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Back"]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[o(a.status),e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Simulation Results"})]}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[a.execution_mode.replace("_"," ").toUpperCase()," mode |"," ","Started: ",new Date(a.started_at).toLocaleString()]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:`p-4 rounded-lg border ${u(a.summary.security_score)}`,children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Security Score"})]}),e.jsxs("div",{className:`text-3xl font-bold ${c(a.summary.security_score)}`,children:[a.summary.security_score,"%"]})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-light-surface dark:bg-dark-surface border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Detection Rate"})]}),e.jsxs("div",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:[(a.summary.detection_rate*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-light-surface dark:bg-dark-surface border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Techniques Tested"})]}),e.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:a.summary.total_techniques})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-light-surface dark:bg-dark-surface border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(T,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Detection Gaps"})]}),e.jsx("div",{className:`text-3xl font-bold ${a.detection_gaps.length>0?"text-red-400":"text-green-400"}`,children:a.detection_gaps.length})]})]}),e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-4",children:"Execution Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx($,{label:"Succeeded",value:a.summary.succeeded,color:"text-green-400"}),e.jsx($,{label:"Detected",value:a.summary.detected,color:"text-cyan-400"}),e.jsx($,{label:"Blocked",value:a.summary.blocked,color:"text-blue-400"}),e.jsx($,{label:"Failed",value:a.summary.failed,color:"text-red-400"}),e.jsx($,{label:"Skipped",value:a.summary.skipped,color:"text-gray-400"})]})]}),a.detection_gaps.length>0&&e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg",children:[e.jsxs("div",{className:"p-4 border-b border-light-border dark:border-dark-border",children:[e.jsxs("h3",{className:"font-medium text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-yellow-400"}),"Detection Gaps (",a.detection_gaps.length,")"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"These techniques were not detected by your security controls"})]}),e.jsx("div",{className:"divide-y divide-light-border dark:divide-dark-border",children:a.detection_gaps.map(r=>e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-mono text-xs text-gray-500 dark:text-gray-400",children:r.technique_id}),e.jsx(Me,{severity:r.severity})]}),e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:r.technique_name}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:r.tactics.map(f=>e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded",children:f},f))}),r.reason&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:r.reason}),r.recommendations.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Recommendations:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600 dark:text-gray-300",children:r.recommendations.map((f,j)=>e.jsx("li",{children:f},j))})]})]}),e.jsx("div",{children:r.acknowledged?e.jsx("span",{className:"text-xs px-2 py-1 bg-green-500/20 text-green-400 rounded",children:"Acknowledged"}):e.jsx("span",{className:"text-xs px-2 py-1 bg-yellow-500/20 text-yellow-400 rounded",children:"Pending Review"})})]})},r.id))})]}),e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg",children:[e.jsx("div",{className:"p-4 border-b border-light-border dark:border-dark-border",children:e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Technique Execution Log"})}),e.jsx("div",{className:"divide-y divide-light-border dark:divide-dark-border",children:a.executions.map(r=>e.jsxs("div",{className:"p-4 flex items-center gap-4",children:[g(r),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-xs text-gray-500 dark:text-gray-400",children:r.technique_id}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${r.detection_observed?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:r.detection_observed?"Detected":"Not Detected"})]}),r.detection_details&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate mt-1",children:r.detection_details}),r.error&&e.jsx("p",{className:"text-sm text-red-400 truncate mt-1",children:r.error})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"text-sm text-gray-400",children:v(r.duration_ms)})})]},r.id))})]}),a.error&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-400 mb-2",children:[e.jsx(z,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Simulation Error"})]}),e.jsx("p",{className:"text-sm text-red-300",children:a.error})]})]})},$=({label:s,value:d,color:a})=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-2xl font-bold ${a}`,children:d}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:s})]}),Me=({severity:s})=>{const a=(n=>n>=5?{label:"Critical",color:"bg-red-500/20 text-red-400"}:n>=4?{label:"High",color:"bg-orange-500/20 text-orange-400"}:n>=3?{label:"Medium",color:"bg-yellow-500/20 text-yellow-400"}:{label:"Low",color:"bg-blue-500/20 text-blue-400"})(s);return e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${a.color}`,children:a.label})},Re=({gaps:s,showFilters:d=!0})=>{const a=Z(),[n,o]=x.useState("all"),[g,c]=x.useState(null),[u,v]=x.useState(""),{data:r,isLoading:f}=S({queryKey:["bas-unacknowledged-gaps"],queryFn:async()=>(await b.getUnacknowledgedGaps()).data,enabled:!s}),j=U({mutationFn:async({gapId:i,notes:m})=>(await b.acknowledgeGap(i,{notes:m})).data,onSuccess:()=>{k.success("Detection gap acknowledged"),a.invalidateQueries({queryKey:["bas-unacknowledged-gaps"]}),a.invalidateQueries({queryKey:["bas-stats"]}),c(null),v("")},onError:i=>{k.error(i.message||"Failed to acknowledge gap")}}),C=s||r||[],_=C.filter(i=>{var h;return n==="all"?!0:(h={critical:[5],high:[4],medium:[3],low:[1,2]}[n])==null?void 0:h.includes(i.severity)}),E=i=>i>=5?{label:"Critical",color:"bg-red-500/20 text-red-400 border-red-500/30",icon:"text-red-400"}:i>=4?{label:"High",color:"bg-orange-500/20 text-orange-400 border-orange-500/30",icon:"text-orange-400"}:i>=3?{label:"Medium",color:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",icon:"text-yellow-400"}:{label:"Low",color:"bg-blue-500/20 text-blue-400 border-blue-500/30",icon:"text-blue-400"},A=i=>`https://attack.mitre.org/techniques/${i.replace(".","/")}/`;return f?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(q,{className:"w-8 h-8 text-primary animate-spin"})}):C.length===0?e.jsxs("div",{className:"text-center py-12 bg-light-surface dark:bg-dark-surface rounded-lg border border-light-border dark:border-dark-border",children:[e.jsx(H,{className:"w-12 h-12 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No Detection Gaps"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"All tested techniques were detected by your security controls."})]}):e.jsxs("div",{children:[d&&e.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[e.jsxs("select",{value:n,onChange:i=>o(i.target.value),className:"px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Showing ",_.length," of ",C.length," gaps"]})]}),e.jsx("div",{className:"space-y-4",children:_.map(i=>{const m=E(i.severity);return e.jsx("div",{className:`bg-light-surface dark:bg-dark-surface border rounded-lg p-4 ${i.acknowledged?"border-green-500/30":"border-light-border dark:border-dark-border"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(T,{className:`w-5 h-5 ${m.icon}`}),e.jsx("span",{className:"font-mono text-sm text-gray-500 dark:text-gray-400",children:i.technique_id}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded border ${m.color}`,children:m.label}),i.acknowledged&&e.jsxs("span",{className:"text-xs px-2 py-0.5 bg-green-500/20 text-green-400 rounded flex items-center gap-1",children:[e.jsx(Q,{className:"w-3 h-3"}),"Acknowledged"]})]}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:i.technique_name}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:i.tactics.map(h=>e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded",children:h},h))}),i.reason&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:i.reason}),i.recommendations.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-light-bg dark:bg-dark-bg rounded-lg",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2 flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Recommendations"]}),e.jsx("ul",{className:"space-y-1",children:i.recommendations.map((h,w)=>e.jsxs("li",{className:"text-sm text-gray-600 dark:text-gray-300 flex items-start gap-2",children:[e.jsx("span",{className:"text-primary mt-1",children:"-"}),h]},w))})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("a",{href:A(i.technique_id),target:"_blank",rel:"noopener noreferrer",className:"p-2 text-gray-400 hover:text-primary transition-colors",title:"View on MITRE ATT&CK",children:e.jsx(de,{className:"w-4 h-4"})}),!i.acknowledged&&e.jsxs(y,{variant:"outline",size:"sm",onClick:()=>c(i),children:[e.jsx(Q,{className:"w-4 h-4 mr-1"}),"Acknowledge"]})]})]})},i.id)})}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface rounded-lg shadow-xl max-w-md w-full mx-4",children:[e.jsx("div",{className:"p-4 border-b border-light-border dark:border-dark-border",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Acknowledge Detection Gap"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2",children:"Acknowledging this gap indicates you have reviewed it and have a plan to address the detection coverage."}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-light-bg dark:bg-dark-bg rounded-lg",children:[e.jsx("span",{className:"font-mono text-sm text-gray-500 dark:text-gray-400",children:g.technique_id}),e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:g.technique_name})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"w-4 h-4"}),"Notes (optional)"]})}),e.jsx("textarea",{value:u,onChange:i=>v(i.target.value),placeholder:"e.g., Tracking in JIRA-1234, remediation planned for Q2",rows:3,className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{className:"p-4 border-t border-light-border dark:border-dark-border flex justify-end gap-3",children:[e.jsx(y,{variant:"outline",onClick:()=>{c(null),v("")},children:"Cancel"}),e.jsxs(y,{onClick:()=>j.mutate({gapId:g.id,notes:u||void 0}),disabled:j.isPending,children:[j.isPending?e.jsx(q,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Acknowledge"]})]})]})})]})},ze=()=>{const s=Z(),[d,a]=x.useState("scenarios"),[n,o]=x.useState(!1),[g,c]=x.useState(null),[u,v]=x.useState("all"),[r,f]=x.useState(""),[j,C]=x.useState(null),{data:_=[],isLoading:E}=S({queryKey:["bas-techniques"],queryFn:async()=>(await b.listTechniques()).data.techniques,enabled:d==="techniques"}),{data:A=[]}=S({queryKey:["bas-tactics"],queryFn:async()=>(await b.listTactics()).data.tactics}),{data:i=[],isLoading:m,refetch:h}=S({queryKey:["bas-scenarios"],queryFn:async()=>(await b.listScenarios()).data.scenarios,enabled:d==="scenarios"}),{data:w=[],isLoading:K,refetch:M}=S({queryKey:["bas-simulations"],queryFn:async()=>(await b.listSimulations()).data.simulations,enabled:d==="simulations"}),{data:p}=S({queryKey:["bas-stats"],queryFn:async()=>(await b.getStats()).data}),R=U({mutationFn:async l=>{await b.deleteScenario(l)},onSuccess:()=>{k.success("Scenario deleted"),s.invalidateQueries({queryKey:["bas-scenarios"]})},onError:l=>{k.error(l.message||"Failed to delete scenario")}}),P=U({mutationFn:async l=>(await b.startSimulation({scenario_id:l})).data,onSuccess:l=>{k.success("Simulation started"),s.invalidateQueries({queryKey:["bas-simulations"]}),a("simulations"),c(l.id)},onError:l=>{k.error(l.message||"Failed to start simulation")}}),F=_.filter(l=>{if(u!=="all"&&l.tactic!==u)return!1;if(r){const L=r.toLowerCase();return l.name.toLowerCase().includes(L)||l.id.toLowerCase().includes(L)||l.description.toLowerCase().includes(L)}return!0}),V=l=>l>=80?"text-green-400":l>=60?"text-yellow-400":l>=40?"text-orange-400":"text-red-400";return g?e.jsxs("div",{className:"min-h-screen bg-light-bg dark:bg-dark-bg",children:[e.jsx(X,{}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsx(Ee,{simulationId:g,onBack:()=>c(null)})})]}):n?e.jsxs("div",{className:"min-h-screen bg-light-bg dark:bg-dark-bg",children:[e.jsx(X,{}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsx(De,{onScenarioCreated:()=>{o(!1),a("scenarios")},onCancel:()=>o(!1)})})]}):e.jsxs("div",{className:"min-h-screen bg-light-bg dark:bg-dark-bg",children:[e.jsx(X,{}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[e.jsx(Te,{className:"w-7 h-7 text-primary"}),"Breach & Attack Simulation"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Test your security controls against MITRE ATT&CK techniques"})]}),e.jsxs(y,{onClick:()=>o(!0),children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"New Scenario"]})]})}),p&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(G,{icon:e.jsx(D,{className:"w-5 h-5"}),label:"Scenarios",value:p.total_scenarios}),e.jsx(G,{icon:e.jsx(I,{className:"w-5 h-5"}),label:"Simulations",value:p.total_simulations}),e.jsx(G,{icon:e.jsx(H,{className:"w-5 h-5"}),label:"Avg Detection Rate",value:`${(p.avg_detection_rate*100).toFixed(0)}%`,valueColor:V(p.avg_detection_rate*100)}),e.jsx(G,{icon:e.jsx(T,{className:"w-5 h-5"}),label:"Unacked Gaps",value:p.unacknowledged_gaps,valueColor:p.unacknowledged_gaps>0?"text-yellow-400":"text-green-400"})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-6 border-b border-light-border dark:border-dark-border",children:[e.jsx(B,{active:d==="scenarios",onClick:()=>a("scenarios"),icon:e.jsx(D,{className:"w-4 h-4"}),label:"Scenarios"}),e.jsx(B,{active:d==="simulations",onClick:()=>a("simulations"),icon:e.jsx(I,{className:"w-4 h-4"}),label:"Simulations"}),e.jsx(B,{active:d==="techniques",onClick:()=>a("techniques"),icon:e.jsx(Ae,{className:"w-4 h-4"}),label:"Techniques"}),e.jsx(B,{active:d==="gaps",onClick:()=>a("gaps"),icon:e.jsx(T,{className:"w-4 h-4"}),label:"Detection Gaps",badge:p==null?void 0:p.unacknowledged_gaps})]}),d==="scenarios"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Attack Scenarios"}),e.jsxs(y,{variant:"outline",size:"sm",onClick:()=>h(),children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),m?e.jsx(Y,{}):i.length===0?e.jsx(ie,{icon:e.jsx(D,{className:"w-12 h-12 text-gray-400"}),title:"No Scenarios Yet",description:"Create your first attack scenario to test your security controls.",action:e.jsxs(y,{onClick:()=>o(!0),children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Create Scenario"]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map(l=>e.jsx($e,{scenario:l,onRun:()=>P.mutate(l.id),onDelete:()=>R.mutate(l.id),isRunning:P.isPending},l.id))})]}),d==="simulations"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Simulation History"}),e.jsxs(y,{variant:"outline",size:"sm",onClick:()=>M(),children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),K?e.jsx(Y,{}):w.length===0?e.jsx(ie,{icon:e.jsx(I,{className:"w-12 h-12 text-gray-400"}),title:"No Simulations Yet",description:"Run a scenario to see simulation results here."}):e.jsx("div",{className:"space-y-4",children:w.map(l=>e.jsx(Ie,{simulation:l,onView:()=>c(l.id)},l.id))})]}),d==="techniques"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx("input",{type:"text",value:r,onChange:l=>f(l.target.value),placeholder:"Search techniques...",className:"w-full px-3 py-2 bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"})}),e.jsxs("select",{value:u,onChange:l=>v(l.target.value),className:"px-3 py-2 bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Tactics"}),A.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 self-center",children:[F.length," techniques"]})]}),E?e.jsx(Y,{}):e.jsx("div",{className:"space-y-3",children:F.map(l=>e.jsx(me,{technique:l,expanded:j===l.id,onToggleExpand:()=>C(j===l.id?null:l.id)},l.id))})]}),d==="gaps"&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Unacknowledged Detection Gaps"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Review and acknowledge gaps in your detection coverage"})]}),e.jsx(Re,{})]})]})]})},B=({active:s,onClick:d,icon:a,label:n,badge:o})=>e.jsxs("button",{onClick:d,className:`pb-3 px-1 border-b-2 transition-colors flex items-center gap-2 ${s?"border-primary text-primary":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[a,e.jsx("span",{children:n}),o!==void 0&&o>0&&e.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-yellow-500/20 text-yellow-400 rounded-full",children:o})]}),G=({icon:s,label:d,value:a,valueColor:n="text-gray-900 dark:text-white"})=>e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[s,e.jsx("span",{className:"text-sm font-medium",children:d})]}),e.jsx("div",{className:`text-2xl font-bold ${n}`,children:a})]}),$e=({scenario:s,onRun:d,onDelete:a,isRunning:n})=>e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(D,{className:"w-5 h-5 text-primary"}),e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white truncate",children:s.name}),s.status==="builtin"&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded",children:"Built-in"})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-2 mb-3",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:[s.technique_count," techniques"]}),e.jsx("span",{className:"capitalize",children:s.execution_mode.replace("_"," ")})]}),s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:s.tags.map(o=>e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded",children:o},o))})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx(y,{variant:"outline",size:"sm",onClick:d,disabled:n,children:n?e.jsx(q,{className:"w-4 h-4 animate-spin"}):e.jsx(oe,{className:"w-4 h-4"})}),s.status!=="builtin"&&e.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-red-400 transition-colors",title:"Delete scenario",children:e.jsx(Fe,{className:"w-4 h-4"})})]})]})}),Ie=({simulation:s,onView:d})=>{const a=o=>{switch(o.toLowerCase()){case"completed":return e.jsx(ee,{className:"w-4 h-4 text-green-400"});case"failed":return e.jsx(z,{className:"w-4 h-4 text-red-400"});case"running":return e.jsx(I,{className:"w-4 h-4 text-cyan-400 animate-pulse"});default:return e.jsx(xe,{className:"w-4 h-4 text-yellow-400"})}},n=o=>o>=80?"text-green-400":o>=60?"text-yellow-400":o>=40?"text-orange-400":"text-red-400";return e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[a(s.status),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["Simulation ",s.id.slice(0,8)]}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 capitalize",children:["(",s.execution_mode.replace("_"," "),")"]})]}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(s.started_at).toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-lg font-bold ${n(s.security_score)}`,children:[s.security_score,"%"]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Score"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[(s.detection_rate*100).toFixed(0),"%"]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Detection"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:s.total_techniques}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Techniques"})]}),e.jsx("button",{onClick:d,className:"p-2 text-gray-400 hover:text-primary transition-colors",title:"View details",children:e.jsx(Le,{className:"w-5 h-5"})})]})]})})},Y=()=>e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(q,{className:"w-8 h-8 text-primary animate-spin"})}),ie=({icon:s,title:d,description:a,action:n})=>e.jsxs("div",{className:"text-center py-12 bg-light-surface dark:bg-dark-surface rounded-lg border border-light-border dark:border-dark-border",children:[e.jsx("div",{className:"mb-4 flex justify-center",children:s}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:d}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:a}),n]});export{ze as default};
