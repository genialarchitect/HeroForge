import{e as C,u as b,j as e,f as k}from"./vendor-state-oFDmcCcB.js";import{r as p}from"./vendor-react-5KxtEOLM.js";import{O as w,aa as R,m as O,g as v,Y as _,F as D,B as u,z as U,I as J,q as X,l as Y,w as Z,aX as L,T as W,aO as ee,ac as se,X as q,aZ as I,a1 as M,cJ as A,b7 as T,J as te,i as F,y as ae,V as le}from"./vendor-ui-7EurIAWU.js";import{L as re}from"./Layout-B2BPZquP.js";import{aj as h}from"./index-MDkiA-RQ.js";import"./vendor-markdown-BwTKtS0m.js";import"./vendor-utils-DfRopTPV.js";const we=()=>{C();const[t,a]=p.useState("list"),[l,s]=p.useState(null),[d,n]=p.useState("code"),[r,j]=p.useState({search:"",status:"all",language:"all"}),[c,o]=p.useState(!1),[i,m]=p.useState(!1),[P,g]=p.useState(!1),{data:S,isLoading:$,refetch:E}=b({queryKey:["pocs"],queryFn:async()=>(await h.listPocs()).data}),{data:B}=b({queryKey:["sandbox-environments"],queryFn:async()=>(await h.listSandboxEnvironments()).data.environments}),y=(S==null?void 0:S.pocs)||[],Q=y.filter(x=>{var V;return!(r.search&&!x.title.toLowerCase().includes(r.search.toLowerCase())&&!((V=x.cve_id)!=null&&V.toLowerCase().includes(r.search.toLowerCase()))||r.status!=="all"&&x.status!==r.status||r.language!=="all"&&x.language!==r.language)}),z=[...new Set(y.map(x=>x.language))],G=x=>{s(x),n("code"),a("detail")},H=()=>{s(null),a("list")};return e.jsx(re,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(w,{className:"h-8 w-8 text-red-500"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"PoC Repository"}),e.jsx("p",{className:"text-gray-400",children:"Manage proof-of-concept exploits with sandbox testing"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>E(),className:"px-3 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:e.jsx(R,{className:"h-4 w-4"})}),e.jsxs("button",{onClick:()=>m(!0),className:"flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{children:"New PoC"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(N,{title:"Total PoCs",value:y.length,icon:e.jsx(w,{className:"h-5 w-5 text-cyan-500"})}),e.jsx(N,{title:"Verified",value:y.filter(x=>x.status==="verified").length,icon:e.jsx(v,{className:"h-5 w-5 text-green-500"})}),e.jsx(N,{title:"Testing",value:y.filter(x=>x.status==="testing").length,icon:e.jsx(_,{className:"h-5 w-5 text-yellow-500"})}),e.jsx(N,{title:"Draft",value:y.filter(x=>x.status==="draft").length,icon:e.jsx(D,{className:"h-5 w-5 text-gray-500"})})]}),t==="list"?e.jsx(ne,{pocs:Q,isLoading:$,filters:r,setFilters:j,showFilters:c,setShowFilters:o,languages:z,onViewPoc:G,onRefetch:E}):l&&e.jsx(ie,{poc:l,detailTab:d,setDetailTab:n,onBack:H,sandboxEnvs:B||[],showSandboxModal:P,setShowSandboxModal:g}),i&&e.jsx(he,{onClose:()=>m(!1),onSuccess:()=>{m(!1),E()}})]})})},N=({title:t,value:a,icon:l})=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:t}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:a})]}),e.jsx("div",{className:"p-3 bg-gray-700/50 rounded-lg",children:l})]})}),ne=({pocs:t,isLoading:a,filters:l,setFilters:s,showFilters:d,setShowFilters:n,languages:r,onViewPoc:j})=>{const c=C(),o=k({mutationFn:i=>h.deletePoc(i),onSuccess:()=>{u.success("PoC deleted successfully"),c.invalidateQueries({queryKey:["pocs"]})},onError:()=>u.error("Failed to delete PoC")});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500"}),e.jsx("input",{type:"text",placeholder:"Search PoCs by title or CVE...",value:l.search,onChange:i=>s(m=>({...m,search:i.target.value})),className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),e.jsxs("button",{onClick:()=>n(!d),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ${d?"bg-red-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{children:"Filters"}),d?e.jsx(X,{className:"h-4 w-4"}):e.jsx(Y,{className:"h-4 w-4"})]})]}),d&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Status"}),e.jsxs("select",{value:l.status,onChange:i=>s(m=>({...m,status:i.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"testing",children:"Testing"}),e.jsx("option",{value:"verified",children:"Verified"}),e.jsx("option",{value:"broken",children:"Broken"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Language"}),e.jsxs("select",{value:l.language,onChange:i=>s(m=>({...m,language:i.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"all",children:"All Languages"}),r.map(i=>e.jsx("option",{value:i,children:i},i))]})]})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:a?e.jsxs("div",{className:"p-8 text-center text-gray-400",children:[e.jsx(R,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),"Loading PoCs..."]}):t.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-400",children:[e.jsx(w,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No PoCs found"}),e.jsx("p",{className:"text-sm mt-1",children:"Create a new PoC to get started"})]}):e.jsx("div",{className:"divide-y divide-gray-700",children:t.map(i=>e.jsx("div",{className:"p-4 hover:bg-gray-700/50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:i.title}),e.jsx(K,{status:i.status}),e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 text-xs rounded",children:i.language})]}),i.description&&e.jsx("p",{className:"text-gray-400 text-sm mt-1 line-clamp-2",children:i.description}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-500",children:[i.cve_id&&e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(Z,{className:"h-3 w-3"}),e.jsx("span",{children:i.cve_id})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(L,{className:"h-3 w-3"}),e.jsxs("span",{children:[i.versions.length," version(s)"]})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(_,{className:"h-3 w-3"}),e.jsxs("span",{children:[i.test_results.length," test(s)"]})]}),i.tags.length>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(W,{className:"h-3 w-3"}),e.jsx("span",{children:i.tags.slice(0,3).join(", ")})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>j(i),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-600 rounded-lg transition-colors",title:"View Details",children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete this PoC?")&&o.mutate(i.id)},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-gray-600 rounded-lg transition-colors",title:"Delete",children:e.jsx(se,{className:"h-4 w-4"})})]})]})},i.id))})})]})},K=({status:t})=>{const a={draft:{color:"bg-gray-600 text-gray-300",icon:e.jsx(D,{className:"h-3 w-3"})},testing:{color:"bg-yellow-600/20 text-yellow-400",icon:e.jsx(_,{className:"h-3 w-3"})},verified:{color:"bg-green-600/20 text-green-400",icon:e.jsx(v,{className:"h-3 w-3"})},broken:{color:"bg-red-600/20 text-red-400",icon:e.jsx(F,{className:"h-3 w-3"})}},{color:l,icon:s}=a[t]||a.draft;return e.jsxs("span",{className:`inline-flex items-center space-x-1 px-2 py-0.5 rounded text-xs ${l}`,children:[s,e.jsx("span",{className:"capitalize",children:t})]})},ie=({poc:t,detailTab:a,setDetailTab:l,onBack:s,sandboxEnvs:d,showSandboxModal:n,setShowSandboxModal:r})=>{const j=C(),{data:c}=b({queryKey:["poc-code",t.id],queryFn:async()=>(await h.getPocCode(t.id)).data}),{data:o}=b({queryKey:["poc-effectiveness",t.id],queryFn:async()=>(await h.getPocEffectiveness(t.id)).data}),{data:i}=b({queryKey:["poc-timeline",t.id],queryFn:async()=>(await h.getPocTimeline(t.id)).data}),{data:m}=b({queryKey:["poc-sandbox-history",t.id],queryFn:async()=>(await h.getSandboxHistory(t.id)).data}),P=[{id:"code",label:"Code",icon:e.jsx(w,{className:"h-4 w-4"})},{id:"tests",label:"Test Results",icon:e.jsx(v,{className:"h-4 w-4"})},{id:"sandbox",label:"Sandbox",icon:e.jsx(M,{className:"h-4 w-4"})},{id:"effectiveness",label:"Effectiveness",icon:e.jsx(A,{className:"h-4 w-4"})},{id:"timeline",label:"Timeline",icon:e.jsx(L,{className:"h-4 w-4"})},{id:"versions",label:"Versions",icon:e.jsx(T,{className:"h-4 w-4"})}];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:s,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(q,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:t.title}),e.jsx(K,{status:t.status})]}),t.cve_id&&e.jsx("span",{className:"text-cyan-400 text-sm",children:t.cve_id})]})]}),e.jsxs("button",{onClick:()=>r(!0),className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:"Run in Sandbox"})]})]}),e.jsx("div",{className:"flex items-center space-x-1 bg-gray-800 rounded-lg p-1 border border-gray-700",children:P.map(g=>e.jsxs("button",{onClick:()=>l(g.id),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ${a===g.id?"bg-red-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:[g.icon,e.jsx("span",{children:g.label})]},g.id))}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[a==="code"&&e.jsx(ce,{code:(c==null?void 0:c.code)||"",language:t.language}),a==="tests"&&e.jsx(de,{testResults:t.test_results}),a==="sandbox"&&e.jsx(oe,{pocId:t.id,history:(m==null?void 0:m.executions)||[],environments:d}),a==="effectiveness"&&e.jsx(xe,{pocId:t.id,score:o==null?void 0:o.score}),a==="timeline"&&e.jsx(me,{events:(i==null?void 0:i.events)||[]}),a==="versions"&&e.jsx(ge,{versions:t.versions})]}),n&&e.jsx(ue,{pocId:t.id,pocTitle:t.title,environments:d,onClose:()=>r(!1),onSuccess:()=>{r(!1),j.invalidateQueries({queryKey:["poc-sandbox-history",t.id]})}})]})},ce=({code:t,language:a})=>{const l=()=>{navigator.clipboard.writeText(t),u.success("Code copied to clipboard")};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-gray-400 text-sm",children:["Language: ",a]}),e.jsxs("button",{onClick:l,className:"flex items-center space-x-2 px-3 py-1 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 transition-colors",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{children:"Copy"})]})]}),e.jsx("pre",{className:"bg-gray-900 rounded-lg p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-gray-300 font-mono whitespace-pre",children:t||"No code available"})})]})},de=({testResults:t})=>{if(t.length===0)return e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(_,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No test results yet"}),e.jsx("p",{className:"text-sm mt-1",children:"Run the PoC in a sandbox to generate test results"})]});const l=(t.filter(s=>s.success).length/t.length*100).toFixed(1);return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"text-sm text-gray-400",children:[t.length," test(s) - ",l,"% success rate"]})}),e.jsx("div",{className:"space-y-3",children:t.map((s,d)=>e.jsxs("div",{className:`p-4 rounded-lg border ${s.success?"bg-green-900/20 border-green-700":"bg-red-900/20 border-red-700"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[s.success?e.jsx(v,{className:"h-5 w-5 text-green-400"}):e.jsx(F,{className:"h-5 w-5 text-red-400"}),e.jsx("span",{className:"font-medium text-white",children:s.success?"Success":"Failed"})]}),e.jsx("span",{className:"text-sm text-gray-400",children:new Date(s.tested_at).toLocaleString()})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Target:"})," ",s.target_info]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Execution Time:"})," ",s.execution_time_ms,"ms"]}),s.output&&e.jsxs("p",{children:[e.jsx("strong",{children:"Output:"})," ",s.output]}),s.error&&e.jsxs("p",{className:"text-red-400",children:[e.jsx("strong",{children:"Error:"})," ",s.error]}),s.notes&&e.jsxs("p",{children:[e.jsx("strong",{children:"Notes:"})," ",s.notes]})]})]},d))})]})},oe=({pocId:t,history:a,environments:l})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"Available Environments"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:l.map(s=>e.jsxs("div",{className:`p-3 rounded-lg border ${s.is_ready?"bg-green-900/20 border-green-700":"bg-gray-700 border-gray-600"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-white text-sm",children:s.name})]}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:s.os})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"Execution History"}),a.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(M,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No sandbox executions yet"})]}):e.jsx("div",{className:"space-y-3",children:a.map((s,d)=>e.jsxs("div",{className:"p-4 bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[s.success_detected?e.jsx(v,{className:"h-5 w-5 text-green-400"}):e.jsx(F,{className:"h-5 w-5 text-red-400"}),e.jsxs("span",{className:"text-white",children:[s.sandbox_type," - ",s.target_os]})]}),e.jsx("span",{className:"text-sm text-gray-400",children:new Date(s.executed_at).toLocaleString()})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:[e.jsxs("p",{children:["Status: ",s.status]}),e.jsxs("p",{children:["Execution Time: ",s.execution_time_ms,"ms"]})]})]},d))})]})]}),xe=({pocId:t,score:a})=>{const l=C(),s=k({mutationFn:()=>h.calculatePocEffectiveness(t,{}),onSuccess:()=>{u.success("Effectiveness score calculated"),l.invalidateQueries({queryKey:["poc-effectiveness",t]})},onError:()=>u.error("Failed to calculate effectiveness")});if(!a)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx(A,{className:"h-12 w-12 mx-auto mb-2 text-gray-500"}),e.jsx("p",{className:"text-gray-400",children:"No effectiveness score available"}),e.jsx("button",{onClick:()=>s.mutate(),disabled:s.isPending,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:s.isPending?"Calculating...":"Calculate Score"})]});const d={Excellent:"text-green-400",Good:"text-cyan-400",Average:"text-yellow-400",Low:"text-orange-400",Unknown:"text-gray-400"}[a.rating]||"text-gray-400";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-5xl font-bold text-white",children:a.total_score}),e.jsx("div",{className:`text-xl ${d}`,children:a.rating})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(f,{title:"Reliability",value:a.reliability_score,max:100}),e.jsx(f,{title:"Impact",value:a.impact_score,max:30}),e.jsx(f,{title:"Maturity",value:a.maturity_score,max:100}),e.jsx(f,{title:"Community",value:a.community_score,max:100})]}),a.recommendations.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-3",children:"Recommendations"}),e.jsx("ul",{className:"space-y-2",children:a.recommendations.map((n,r)=>e.jsxs("li",{className:"flex items-start space-x-2 text-gray-300",children:[e.jsx(le,{className:"h-4 w-4 text-yellow-400 mt-1 flex-shrink-0"}),e.jsx("span",{children:n})]},r))})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:()=>s.mutate(),disabled:s.isPending,className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors disabled:opacity-50",children:s.isPending?"Recalculating...":"Recalculate Score"})})]})},f=({title:t,value:a,max:l})=>{const s=(a/l*100).toFixed(0);return e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:t}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[a,e.jsxs("span",{className:"text-sm text-gray-500",children:["/",l]})]}),e.jsx("div",{className:"w-full bg-gray-600 rounded-full h-1.5 mt-2",children:e.jsx("div",{className:"bg-cyan-500 rounded-full h-1.5",style:{width:`${s}%`}})})]})},me=({events:t})=>t.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(L,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No timeline events yet"})]}):e.jsx("div",{className:"space-y-4",children:t.map((a,l)=>e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0 w-2 h-2 mt-2 rounded-full bg-cyan-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-white",children:a.title}),e.jsx("span",{className:"text-sm text-gray-400",children:new Date(a.created_at).toLocaleString()})]}),a.description&&e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:a.description}),e.jsx("span",{className:"inline-block px-2 py-0.5 bg-gray-700 text-gray-300 text-xs rounded mt-1",children:a.event_type})]})]},a.id))}),ge=({versions:t})=>t.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(T,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No version history"})]}):e.jsx("div",{className:"space-y-3",children:t.map((a,l)=>e.jsxs("div",{className:`p-4 rounded-lg border ${l===0?"bg-cyan-900/20 border-cyan-700":"bg-gray-700 border-gray-600"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"font-medium text-white",children:["v",a.version]}),l===0&&e.jsx("span",{className:"px-2 py-0.5 bg-cyan-600 text-white text-xs rounded",children:"Latest"})]}),e.jsx("span",{className:"text-sm text-gray-400",children:new Date(a.created_at).toLocaleDateString()})]}),a.changelog&&e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:a.changelog})]},l))}),he=({onClose:t,onSuccess:a})=>{const[l,s]=p.useState({title:"",description:"",code:"",language:"python",cve_id:"",tags:"",target_info:""}),d=k({mutationFn:()=>h.createPoc({title:l.title,description:l.description||void 0,code:l.code,language:l.language,cve_id:l.cve_id||void 0,tags:l.tags?l.tags.split(",").map(n=>n.trim()):void 0,target_info:l.target_info||void 0}),onSuccess:()=>{u.success("PoC created successfully"),a()},onError:()=>u.error("Failed to create PoC")});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Create New PoC"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:e.jsx(q,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:l.title,onChange:n=>s(r=>({...r,title:n.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"CVE-2024-1234 RCE Exploit"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Language *"}),e.jsxs("select",{value:l.language,onChange:n=>s(r=>({...r,language:n.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"python",children:"Python"}),e.jsx("option",{value:"ruby",children:"Ruby"}),e.jsx("option",{value:"bash",children:"Bash"}),e.jsx("option",{value:"powershell",children:"PowerShell"}),e.jsx("option",{value:"javascript",children:"JavaScript"}),e.jsx("option",{value:"go",children:"Go"}),e.jsx("option",{value:"rust",children:"Rust"}),e.jsx("option",{value:"c",children:"C"}),e.jsx("option",{value:"cpp",children:"C++"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"CVE ID"}),e.jsx("input",{type:"text",value:l.cve_id,onChange:n=>s(r=>({...r,cve_id:n.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"CVE-2024-1234"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("textarea",{value:l.description,onChange:n=>s(r=>({...r,description:n.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white h-20",placeholder:"Description of the vulnerability and exploit..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Code *"}),e.jsx("textarea",{value:l.code,onChange:n=>s(r=>({...r,code:n.target.value})),className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-green-400 font-mono h-48",placeholder:`#!/usr/bin/env python3
# PoC code here...`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:l.tags,onChange:n=>s(r=>({...r,tags:n.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"rce, web, apache"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Target Info"}),e.jsx("input",{type:"text",value:l.target_info,onChange:n=>s(r=>({...r,target_info:n.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"Apache HTTP Server 2.4.49-2.4.50"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{onClick:()=>d.mutate(),disabled:!l.title||!l.code||d.isPending,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:d.isPending?"Creating...":"Create PoC"})]})]})})},ue=({pocId:t,pocTitle:a,environments:l,onClose:s,onSuccess:d})=>{const[n,r]=p.useState({sandbox_type:"docker",target_os:"ubuntu22",isolated_network:!0,timeout_seconds:300}),j=k({mutationFn:()=>h.executePocInSandbox(t,n),onSuccess:c=>{c.data.success?u.success("Sandbox execution completed"):u.warning(`Execution finished with status: ${c.data.status}`),d()},onError:()=>u.error("Failed to execute in sandbox")});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Run in Sandbox"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(q,{className:"h-5 w-5"})})]}),e.jsxs("p",{className:"text-gray-400 mb-4",children:["Execute ",e.jsx("span",{className:"text-white",children:a})," in an isolated sandbox environment."]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Sandbox Type"}),e.jsxs("select",{value:n.sandbox_type,onChange:c=>r(o=>({...o,sandbox_type:c.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"docker",children:"Docker"}),e.jsx("option",{value:"localvm",children:"Local VM"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Target OS"}),e.jsxs("select",{value:n.target_os,onChange:c=>r(o=>({...o,target_os:c.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"ubuntu22",children:"Ubuntu 22.04"}),e.jsx("option",{value:"ubuntu20",children:"Ubuntu 20.04"}),e.jsx("option",{value:"debian12",children:"Debian 12"}),e.jsx("option",{value:"kali",children:"Kali Linux"}),e.jsx("option",{value:"alpine",children:"Alpine Linux"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Timeout (seconds)"}),e.jsx("input",{type:"number",value:n.timeout_seconds,onChange:c=>r(o=>({...o,timeout_seconds:parseInt(c.target.value)||300})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",min:30,max:3600})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"isolated",checked:n.isolated_network,onChange:c=>r(o=>({...o,isolated_network:c.target.checked})),className:"rounded bg-gray-700 border-gray-600"}),e.jsx("label",{htmlFor:"isolated",className:"text-sm text-gray-300",children:"Isolated network (no internet)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Target Host (optional)"}),e.jsx("input",{type:"text",value:n.target_host||"",onChange:c=>r(o=>({...o,target_host:c.target.value||void 0})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"192.168.1.100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Target Port (optional)"}),e.jsx("input",{type:"number",value:n.target_port||"",onChange:c=>r(o=>({...o,target_port:c.target.value?parseInt(c.target.value):void 0})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"8080"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsxs("button",{onClick:()=>j.mutate(),disabled:j.isPending,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:j.isPending?"Executing...":"Execute"})]})]})]})})};export{we as default};
