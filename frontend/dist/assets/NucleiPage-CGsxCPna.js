import{b as E,u as k,d as q,j as e}from"./vendor-state-BjT_zREg.js";import{r as u}from"./vendor-react-5KxtEOLM.js";import{Z as $,V as P,c0 as A,aa as S,ac as Q,$ as R,B as j,cj as I,a7 as M,s as z,aZ as H,p as Z,i as O,g as D,z as U,T as V}from"./vendor-ui-CfSMq23b.js";import{B as L,N as g}from"./index-CJ_zz9jP.js";import{L as K}from"./Layout-C_2au5Vm.js";import{u as X,E as G}from"./useRequireEngagement-PpLJuw5s.js";import"./vendor-utils-DfRopTPV.js";import"./vendor-markdown-BGP8SuZQ.js";const B=a=>{switch(a.toLowerCase()){case"completed":return e.jsx(D,{className:"w-4 h-4 text-green-400"});case"failed":return e.jsx(O,{className:"w-4 h-4 text-red-400"});case"running":return e.jsx(S,{className:"w-4 h-4 text-cyan-400 animate-spin"});case"cancelled":return e.jsx(I,{className:"w-4 h-4 text-orange-400"});default:return e.jsx(Z,{className:"w-4 h-4 text-yellow-400"})}},F=a=>{switch(a.toLowerCase()){case"critical":return"bg-red-500/20 text-red-400 border-red-500/30";case"high":return"bg-orange-500/20 text-orange-400 border-orange-500/30";case"medium":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"low":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"info":return"bg-gray-500/20 text-gray-400 border-gray-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},f={getStatus:()=>g.get("/nuclei/status"),listScans:()=>g.get("/nuclei/scans"),getScan:a=>g.get(`/nuclei/scans/${a}`),createScan:a=>g.post("/nuclei/scans",a),deleteScan:a=>g.delete(`/nuclei/scans/${a}`),cancelScan:a=>g.post(`/nuclei/scans/${a}/cancel`),listTemplates:a=>g.get("/nuclei/templates",{params:a}),getTemplateStats:()=>g.get("/nuclei/templates/stats"),updateTemplates:()=>g.post("/nuclei/templates/update"),listTags:()=>g.get("/nuclei/templates/tags")};function J({onScanCreated:a,hasEngagement:y}){const[r,h]=u.useState(""),[p,w]=u.useState(""),[t,b]=u.useState([]),[d,o]=u.useState(["critical","high","medium"]),[l,x]=u.useState(150),[c,i]=u.useState(!1),C=E(),N=q({mutationFn:f.createScan,onSuccess:n=>{j.success("Nuclei scan started"),a(n.data.id),C.invalidateQueries({queryKey:["nuclei-scans"]}),h(""),w("")},onError:n=>{var v,T;j.error(((T=(v=n.response)==null?void 0:v.data)==null?void 0:T.error)||"Failed to start scan")}}),s=n=>{n.preventDefault();const v=r.split(`
`).map(T=>T.trim()).filter(T=>T);if(v.length===0){j.error("Please enter at least one target");return}N.mutate({name:p||void 0,targets:v,template_tags:t,severity:d,rate_limit:l})},m=["cve","rce","sqli","xss","lfi","ssrf","misconfig","exposure","auth-bypass"],_=["critical","high","medium","low","info"];return e.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-cyan-400"}),"New Nuclei Scan"]}),e.jsxs("form",{onSubmit:s,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Scan Name (optional)"}),e.jsx("input",{type:"text",value:p,onChange:n=>w(n.target.value),placeholder:"My Nuclei Scan",className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Targets (one per line)"}),e.jsx("textarea",{value:r,onChange:n=>h(n.target.value),placeholder:`https://example.com
192.168.1.1
example.org`,rows:4,className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Severity Filter"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(n=>e.jsx("button",{type:"button",onClick:()=>{o(d.includes(n)?d.filter(v=>v!==n):[...d,n])},className:`px-3 py-1.5 rounded-lg text-sm font-medium border transition-colors ${d.includes(n)?F(n):"bg-slate-700 text-slate-400 border-slate-600 hover:border-slate-500"}`,children:n},n))})]}),e.jsxs("button",{type:"button",onClick:()=>i(!c),className:"text-sm text-cyan-400 hover:text-cyan-300 flex items-center gap-1",children:[e.jsx(z,{className:"w-4 h-4"}),c?"Hide":"Show"," Advanced Options"]}),c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Template Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(n=>e.jsx("button",{type:"button",onClick:()=>{b(t.includes(n)?t.filter(v=>v!==n):[...t,n])},className:`px-2 py-1 rounded text-xs font-medium transition-colors ${t.includes(n)?"bg-cyan-500/20 text-cyan-400 border border-cyan-500/30":"bg-slate-700 text-slate-400 border border-slate-600 hover:border-slate-500"}`,children:n},n))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Rate Limit (req/s)"}),e.jsx("input",{type:"number",value:l,onChange:n=>x(parseInt(n.target.value)||150),min:1,max:1e3,className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500"})]})]}),e.jsx(L,{type:"submit",disabled:N.isPending||!y,className:"w-full",children:N.isPending?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 animate-spin mr-2"}),"Starting Scan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Start Scan"]})})]})]})}function W({scanId:a,onBack:y}){var b,d,o;const{data:r,isLoading:h,refetch:p}=k({queryKey:["nuclei-scan",a],queryFn:()=>f.getScan(a),refetchInterval:l=>{var c;const x=(c=l.state.data)==null?void 0:c.data;return(x==null?void 0:x.status)==="running"?3e3:!1}}),w=q({mutationFn:()=>f.cancelScan(a),onSuccess:()=>{j.success("Scan cancelled"),p()},onError:()=>j.error("Failed to cancel scan")});if(h)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(S,{className:"w-8 h-8 text-cyan-400 animate-spin"})});const t=r==null?void 0:r.data;return t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:y,className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(R,{className:"w-5 h-5 text-slate-400 rotate-180"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:t.name||"Nuclei Scan"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[B(t.status),e.jsx("span",{className:"capitalize",children:t.status}),e.jsx("span",{children:"|"}),e.jsxs("span",{children:[((b=t.targets)==null?void 0:b.length)||0," target(s)"]}),e.jsx("span",{children:"|"}),e.jsxs("span",{children:[t.results_count," result(s)"]})]})]})]}),t.status==="running"&&e.jsxs(L,{variant:"danger",onClick:()=>w.mutate(),disabled:w.isPending,children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Cancel Scan"]})]}),e.jsx("div",{className:"grid grid-cols-5 gap-4",children:[{label:"Critical",count:t.critical_count,color:"bg-red-500"},{label:"High",count:t.high_count,color:"bg-orange-500"},{label:"Medium",count:t.medium_count,color:"bg-yellow-500"},{label:"Low",count:t.low_count,color:"bg-blue-500"},{label:"Info",count:t.info_count,color:"bg-slate-500"}].map(l=>e.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${l.color} mb-2`}),e.jsx("div",{className:"text-2xl font-bold text-white",children:l.count}),e.jsx("div",{className:"text-sm text-slate-400",children:l.label})]},l.label))}),e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700",children:[e.jsx("div",{className:"p-4 border-b border-slate-700",children:e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Findings"})}),e.jsx("div",{className:"divide-y divide-slate-700",children:((d=t.results)==null?void 0:d.length)===0?e.jsx("div",{className:"p-8 text-center text-slate-400",children:t.status==="running"?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(S,{className:"w-8 h-8 animate-spin text-cyan-400"}),e.jsx("span",{children:"Scanning in progress..."})]}):e.jsx("span",{children:"No vulnerabilities found"})}):(o=t.results)==null?void 0:o.map(l=>e.jsx("div",{className:"p-4 hover:bg-slate-700/50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium border ${F(l.severity)}`,children:l.severity}),e.jsx("span",{className:"text-white font-medium",children:l.template_name}),l.cve_id&&e.jsx("span",{className:"text-xs text-cyan-400 font-mono",children:l.cve_id})]}),e.jsx("div",{className:"text-sm text-slate-400 font-mono truncate",children:l.matched_at||l.host}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-slate-500",children:[e.jsx("span",{children:l.template_id}),e.jsx("span",{children:"|"}),e.jsx("span",{children:l.check_type})]})]}),l.curl_command&&e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(l.curl_command),j.success("Curl command copied to clipboard")},className:"p-2 hover:bg-slate-600 rounded-lg transition-colors",title:"Copy curl command",children:e.jsx(M,{className:"w-4 h-4 text-slate-400"})})]})},l.id))})]})]}):null}function Y(){var C,N;const[a,y]=u.useState(""),[r,h]=u.useState([]),[p,w]=u.useState([]),t=E(),{data:b,isLoading:d}=k({queryKey:["nuclei-template-stats"],queryFn:()=>f.getTemplateStats()}),{data:o,isLoading:l}=k({queryKey:["nuclei-templates",a,r,p],queryFn:()=>f.listTemplates({query:a||void 0,tags:r.length>0?r.join(","):void 0,severity:p.length>0?p.join(","):void 0,limit:50})}),x=q({mutationFn:f.updateTemplates,onSuccess:()=>{j.success("Templates updated successfully"),t.invalidateQueries({queryKey:["nuclei-template-stats"]}),t.invalidateQueries({queryKey:["nuclei-templates"]})},onError:s=>{var m,_;j.error(((_=(m=s.response)==null?void 0:m.data)==null?void 0:_.error)||"Failed to update templates")}}),c=b==null?void 0:b.data,i=((C=o==null?void 0:o.data)==null?void 0:C.templates)||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:(c==null?void 0:c.total)||0}),e.jsx("div",{className:"text-sm text-slate-400",children:"Total Templates"})]}),["critical","high","medium","low","info"].map(s=>e.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:(c==null?void 0:c[s])||0}),e.jsx("div",{className:`text-sm capitalize ${F(s).split(" ")[1]}`,children:s})]},s))]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"text",value:a,onChange:s=>y(s.target.value),placeholder:"Search templates...",className:"w-full pl-10 pr-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs(L,{onClick:()=>x.mutate(),disabled:x.isPending,variant:"secondary",children:[x.isPending?e.jsx(S,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(M,{className:"w-4 h-4 mr-2"}),"Update Templates"]})]}),(c==null?void 0:c.tags)&&c.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:c.tags.slice(0,15).map(([s,m])=>e.jsxs("button",{onClick:()=>{h(r.includes(s)?r.filter(_=>_!==s):[...r,s])},className:`px-2 py-1 rounded text-xs font-medium transition-colors flex items-center gap-1 ${r.includes(s)?"bg-cyan-500/20 text-cyan-400 border border-cyan-500/30":"bg-slate-700 text-slate-400 border border-slate-600 hover:border-slate-500"}`,children:[e.jsx(V,{className:"w-3 h-3"}),s,e.jsxs("span",{className:"text-slate-500",children:["(",m,")"]})]},s))}),e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Templates"}),e.jsxs("span",{className:"text-sm text-slate-400",children:[((N=o==null?void 0:o.data)==null?void 0:N.total)||0," templates found"]})]}),e.jsx("div",{className:"divide-y divide-slate-700 max-h-[500px] overflow-y-auto",children:l?e.jsx("div",{className:"p-8 text-center",children:e.jsx(S,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto"})}):i.length===0?e.jsx("div",{className:"p-8 text-center text-slate-400",children:"No templates found"}):i.map(s=>e.jsx("div",{className:"p-4 hover:bg-slate-700/50 transition-colors",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium border ${F(s.severity)}`,children:s.severity}),e.jsx("span",{className:"text-white font-medium",children:s.name}),s.cve_id&&e.jsx("span",{className:"text-xs text-cyan-400 font-mono",children:s.cve_id})]}),e.jsx("div",{className:"text-sm text-slate-500 font-mono",children:s.id}),s.description&&e.jsx("div",{className:"text-sm text-slate-400 mt-1 line-clamp-2",children:s.description}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:s.tags.slice(0,5).map(m=>e.jsx("span",{className:"px-1.5 py-0.5 bg-slate-700 text-slate-400 rounded text-xs",children:m},m))})]})})},s.id))})]})]})}function ie(){var N;const[a,y]=u.useState("scans"),[r,h]=u.useState(null),p=E(),{hasEngagement:w}=X(),{data:t,isLoading:b}=k({queryKey:["nuclei-status"],queryFn:()=>f.getStatus()}),{data:d,isLoading:o,refetch:l}=k({queryKey:["nuclei-scans"],queryFn:()=>f.listScans()}),x=q({mutationFn:f.deleteScan,onSuccess:()=>{j.success("Scan deleted"),p.invalidateQueries({queryKey:["nuclei-scans"]})},onError:()=>j.error("Failed to delete scan")}),c=s=>{l(),h(s)},i=t==null?void 0:t.data,C=((N=d==null?void 0:d.data)==null?void 0:N.scans)||[];return r?e.jsx(K,{children:e.jsx(W,{scanId:r,onBack:()=>h(null)})}):e.jsxs(K,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[e.jsx($,{className:"w-7 h-7 text-cyan-400"}),"Nuclei Scanner"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:"Fast vulnerability scanner using Nuclei templates"})]}),e.jsx(G,{toolName:"Nuclei Scanner",className:"mb-6"}),i&&!i.installed&&e.jsxs("div",{className:"mb-6 bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(P,{className:"w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-yellow-400",children:"Nuclei Not Installed"}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:["Install Nuclei to use this feature:",e.jsx("code",{className:"ml-2 px-2 py-0.5 bg-slate-700 rounded text-xs",children:"go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest"})]})]})]}),i&&i.installed&&!i.templates_available&&e.jsxs("div",{className:"mb-6 bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(P,{className:"w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-yellow-400",children:"Templates Not Found"}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:["Download templates by running:",e.jsx("code",{className:"ml-2 px-2 py-0.5 bg-slate-700 rounded text-xs",children:"nuclei -ut"})]})]})]}),(i==null?void 0:i.installed)&&e.jsxs("div",{className:"mb-6 flex items-center gap-4 text-sm text-slate-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsxs("span",{children:["Nuclei ",i.version]})]}),e.jsxs("div",{children:["Templates: ",i.templates_path]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-6 border-b border-slate-700",children:[e.jsx("button",{onClick:()=>y("scans"),className:`pb-3 px-1 border-b-2 transition-colors ${a==="scans"?"border-cyan-500 text-cyan-400":"border-transparent text-slate-400 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{children:"Scans"})]})}),e.jsx("button",{onClick:()=>y("templates"),className:`pb-3 px-1 border-b-2 transition-colors ${a==="templates"?"border-cyan-500 text-cyan-400":"border-transparent text-slate-400 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{children:"Templates"})]})})]}),a==="scans"?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(J,{onScanCreated:c,hasEngagement:w})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Recent Scans"}),e.jsx(L,{variant:"secondary",size:"sm",onClick:()=>l(),children:e.jsx(S,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"divide-y divide-slate-700",children:o?e.jsx("div",{className:"p-8 text-center",children:e.jsx(S,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto"})}):C.length===0?e.jsx("div",{className:"p-8 text-center text-slate-400",children:"No scans yet. Start your first Nuclei scan!"}):C.map(s=>e.jsx("div",{className:"p-4 hover:bg-slate-700/50 transition-colors cursor-pointer",onClick:()=>h(s.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[B(s.status),e.jsx("span",{className:"text-white font-medium",children:s.name||"Nuclei Scan"}),e.jsxs("span",{className:"text-sm text-slate-500",children:["(",s.targets_count," target",s.targets_count!==1?"s":"",")"]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-slate-500",children:[e.jsx("span",{children:new Date(s.created_at).toLocaleString()}),s.results_count>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"|"}),e.jsxs("span",{className:"flex items-center gap-1",children:[s.critical_count>0&&e.jsxs("span",{className:"text-red-400",children:[s.critical_count,"C"]}),s.high_count>0&&e.jsxs("span",{className:"text-orange-400",children:[s.high_count,"H"]}),s.medium_count>0&&e.jsxs("span",{className:"text-yellow-400",children:[s.medium_count,"M"]}),s.low_count>0&&e.jsxs("span",{className:"text-blue-400",children:[s.low_count,"L"]})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:m=>{m.stopPropagation(),confirm("Delete this scan?")&&x.mutate(s.id)},className:"p-2 hover:bg-slate-600 rounded-lg transition-colors",children:e.jsx(Q,{className:"w-4 h-4 text-slate-400 hover:text-red-400"})}),e.jsx(R,{className:"w-5 h-5 text-slate-400"})]})]})},s.id))})]})})]}):e.jsx(Y,{})]})}export{ie as default};
