import{b as we,u as b,d as T,j as e}from"./vendor-state-DdX3IZQk.js";import{r as c,R as ve}from"./vendor-react-Da1CiaFS.js";import{B as x,x as te,bk as z,O as Y,aC as J,S as P,N as ae,m as Se,aQ as B,L as C,as as Ce,aG as re,P as _e,Z as H,E as W,aP as ne,aj as ke,K as Fe,bi as Ae,M as qe,G as ee,ap as V,a1 as le,aF as Te,aA as se,F as De,y as Le,D as Ke}from"./vendor-ui-Cfxa9o3E.js";import{al as N,am as A,d as Me}from"./index-qlTZWgk-.js";import"./vendor-charts-ed8SE4MW.js";const F=({title:t,value:r,icon:y,color:j})=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:t}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:r})]}),e.jsx("div",{className:`p-3 rounded-lg ${j}`,children:y})]})}),Pe=t=>t?t>=80?"text-red-400":t>=60?"text-orange-400":t>=40?"text-yellow-400":t>=20?"text-blue-400":"text-green-400":"text-gray-400",ie=t=>t?t>=80?"bg-red-500/20 text-red-400":t>=60?"bg-orange-500/20 text-orange-400":t>=40?"bg-yellow-500/20 text-yellow-400":t>=20?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400",ce=t=>{switch(t.toLowerCase()){case"pe":return e.jsx(Ke,{className:"w-5 h-5"});case"elf":return e.jsx(le,{className:"w-5 h-5"});case"script":return e.jsx(Le,{className:"w-5 h-5"});case"pdf":return e.jsx(De,{className:"w-5 h-5"});case"apk":return e.jsx(P,{className:"w-5 h-5"});default:return e.jsx(te,{className:"w-5 h-5"})}},xe=t=>{switch(t.toLowerCase()){case"ip":return e.jsx(ae,{className:"w-4 h-4"});case"domain":return e.jsx(ee,{className:"w-4 h-4"});case"url":return e.jsx(ee,{className:"w-4 h-4"});case"email":return e.jsx(qe,{className:"w-4 h-4"});case"hash":return e.jsx(Ae,{className:"w-4 h-4"});case"bitcoin":return e.jsx(Fe,{className:"w-4 h-4"});default:return e.jsx(Y,{className:"w-4 h-4"})}},G=t=>t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(2)} MB`,O=t=>{const r=new Date(t);return r.toLocaleDateString()+" "+r.toLocaleTimeString()},$e=({sample:t,onSelect:r,onAnalyze:y,onDelete:j})=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50 cursor-pointer transition-colors",onClick:r,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-cyan-500",children:ce(t.file_type)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium truncate max-w-xs",children:t.original_filename}),e.jsxs("p",{className:"text-gray-500 text-xs font-mono",children:[t.sha256.substring(0,16),"..."]})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-gray-700 text-gray-300",children:t.file_type.toUpperCase()})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:G(t.file_size)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${ie(t.threat_score)}`,children:t.threat_score??"-"})}),e.jsx("td",{className:"px-4 py-3",children:t.classification?e.jsx("span",{className:"text-sm text-gray-300",children:t.classification}):e.jsx("span",{className:"text-sm text-gray-500",children:"-"})}),e.jsxs("td",{className:"px-4 py-3",children:[t.is_malicious===!0&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-red-500/20 text-red-400",children:"Malicious"}),t.is_malicious===!1&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-green-500/20 text-green-400",children:"Clean"}),t.is_malicious===void 0&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-gray-500/20 text-gray-400",children:"Unknown"})]}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",onClick:i=>i.stopPropagation(),children:[e.jsx("button",{onClick:y,className:"p-1.5 text-cyan-400 hover:bg-cyan-500/20 rounded transition-colors",title:"Analyze",children:e.jsx(H,{className:"w-4 h-4"})}),e.jsx("button",{onClick:j,className:"p-1.5 text-red-400 hover:bg-red-500/20 rounded transition-colors",title:"Delete",children:e.jsx(ne,{className:"w-4 h-4"})})]})})]}),Re=({isOpen:t,onClose:r,onUpload:y,isUploading:j})=>{const[i,h]=c.useState(null),[m,p]=c.useState(""),[f,g]=c.useState(""),[_,a]=c.useState(!1),d=c.useCallback(l=>{l.preventDefault(),l.stopPropagation(),l.type==="dragenter"||l.type==="dragover"?a(!0):l.type==="dragleave"&&a(!1)},[]),u=c.useCallback(l=>{l.preventDefault(),l.stopPropagation(),a(!1),l.dataTransfer.files&&l.dataTransfer.files[0]&&h(l.dataTransfer.files[0])},[]),w=()=>{if(i){const l=m.split(",").map(v=>v.trim()).filter(v=>v);y(i,l,f)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center",children:[e.jsx(z,{className:"w-5 h-5 mr-2 text-cyan-500"}),"Upload Sample"]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white",children:e.jsx(V,{className:"w-5 h-5"})})]}),e.jsx("div",{className:`border-2 border-dashed rounded-lg p-8 text-center mb-4 transition-colors ${_?"border-cyan-500 bg-cyan-500/10":"border-gray-600 hover:border-gray-500"}`,onDragEnter:d,onDragLeave:d,onDragOver:d,onDrop:u,children:i?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(le,{className:"w-8 h-8 text-cyan-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:i.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:G(i.size)})]}),e.jsx("button",{onClick:()=>h(null),className:"text-gray-400 hover:text-white",children:e.jsx(Te,{className:"w-5 h-5"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-12 h-12 text-gray-500 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-300",children:"Drag and drop a file here, or"}),e.jsxs("label",{className:"mt-2 inline-block",children:[e.jsx("input",{type:"file",className:"hidden",onChange:l=>l.target.files&&h(l.target.files[0])}),e.jsx("span",{className:"px-4 py-2 bg-cyan-600 text-white rounded cursor-pointer hover:bg-cyan-500 transition-colors",children:"Browse Files"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:m,onChange:l=>p(l.target.value),placeholder:"e.g., ransomware, suspicious, campaign-123",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Notes"}),e.jsx("textarea",{value:f,onChange:l=>g(l.target.value),placeholder:"Optional notes about this sample...",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white h-20"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-300 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{onClick:w,disabled:!i||j,className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:j?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Upload & Analyze"]})})]})]})}):null},Ue=({sample:t,isOpen:r,onClose:y,onAnalyze:j})=>{const[i,h]=c.useState("overview"),{data:m}=b({queryKey:["sample-strings",t==null?void 0:t.id],queryFn:()=>t!=null&&t.id?N.getSampleStrings(t.id).then(a=>a.data):Promise.resolve([]),enabled:r&&!!(t!=null&&t.id)&&i==="strings"}),{data:p}=b({queryKey:["sample-imports",t==null?void 0:t.id],queryFn:()=>t!=null&&t.id?N.getSampleImports(t.id).then(a=>a.data):Promise.resolve([]),enabled:r&&!!(t!=null&&t.id)&&i==="imports"}),{data:f}=b({queryKey:["sample-iocs",t==null?void 0:t.id],queryFn:()=>t!=null&&t.id?N.getSampleIocs(t.id).then(a=>a.data):Promise.resolve([]),enabled:r&&!!(t!=null&&t.id)&&i==="iocs"}),{data:g}=b({queryKey:["sample-yara",t==null?void 0:t.id],queryFn:()=>t!=null&&t.id?N.getYaraMatches(t.id).then(a=>a.data):Promise.resolve([]),enabled:r&&!!(t!=null&&t.id)&&i==="yara"});if(!r||!t)return null;const _=a=>{navigator.clipboard.writeText(a),x.success("Copied to clipboard")};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-cyan-500",children:ce(t.file_type)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:t.original_filename}),e.jsxs("p",{className:"text-gray-400 text-sm font-mono",children:[t.sha256.substring(0,32),"..."]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`px-3 py-1 rounded font-bold ${ie(t.threat_score)}`,children:["Threat Score: ",t.threat_score??"N/A"]}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-white",children:e.jsx(V,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"flex border-b border-gray-700",children:["overview","strings","imports","iocs","yara"].map(a=>e.jsx("button",{onClick:()=>h(a),className:`px-4 py-2 text-sm font-medium transition-colors ${i===a?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:a.charAt(0).toUpperCase()+a.slice(1)},a))}),e.jsxs("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:[i==="overview"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"File Info"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"File Type:"}),e.jsx("span",{className:"text-white",children:t.file_type.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"File Size:"}),e.jsx("span",{className:"text-white",children:G(t.file_size)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Entropy:"}),e.jsx("span",{className:`text-white ${t.entropy>7.5?"text-red-400":""}`,children:t.entropy.toFixed(4)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Source:"}),e.jsx("span",{className:"text-white",children:t.source})]})]}),e.jsx("h3",{className:"text-lg font-semibold text-white mt-4",children:"Hashes"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 p-2 rounded",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"MD5:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-white font-mono text-sm",children:t.md5}),e.jsx("button",{onClick:()=>_(t.md5),className:"text-gray-400 hover:text-white",children:e.jsx(se,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 p-2 rounded",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"SHA256:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-white font-mono text-sm truncate max-w-xs",children:t.sha256}),e.jsx("button",{onClick:()=>_(t.sha256),className:"text-gray-400 hover:text-white",children:e.jsx(se,{className:"w-4 h-4"})})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Classification"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Classification:"}),e.jsx("span",{className:"text-white",children:t.classification||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Family:"}),e.jsx("span",{className:"text-white",children:t.family||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),t.is_malicious===!0&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-red-500/20 text-red-400",children:"Malicious"}),t.is_malicious===!1&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-green-500/20 text-green-400",children:"Clean"}),t.is_malicious===void 0&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-gray-500/20 text-gray-400",children:"Unknown"})]})]}),e.jsx("h3",{className:"text-lg font-semibold text-white mt-4",children:"Timeline"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"First Seen:"}),e.jsx("span",{className:"text-white",children:O(t.first_seen)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Last Analyzed:"}),e.jsx("span",{className:"text-white",children:t.last_analyzed?O(t.last_analyzed):"Never"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Analysis Count:"}),e.jsx("span",{className:"text-white",children:t.analysis_count})]})]}),t.tags&&t.tags.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mt-4",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((a,d)=>e.jsx("span",{className:"px-2 py-1 bg-gray-700 rounded text-sm text-gray-300",children:a},d))})]})]})]}),i==="strings"&&e.jsx("div",{className:"space-y-2",children:m&&m.length>0?e.jsx("div",{className:"space-y-1 font-mono text-sm",children:m.slice(0,100).map((a,d)=>e.jsxs("div",{className:"flex items-start space-x-2 p-2 bg-gray-900 rounded",children:[e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-400",children:a.category}),e.jsx("span",{className:"text-white break-all",children:a.value})]},d))}):e.jsx("p",{className:"text-gray-400",children:"No interesting strings found."})}),i==="imports"&&e.jsx("div",{className:"space-y-4",children:p&&p.length>0?p.map((a,d)=>e.jsxs("div",{className:"bg-gray-900 rounded p-3",children:[e.jsx("h4",{className:"text-cyan-400 font-medium mb-2",children:a.library}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.functions.map((u,w)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-300 font-mono",children:u},w))})]},d)):e.jsx("p",{className:"text-gray-400",children:"No imports found."})}),i==="iocs"&&e.jsx("div",{className:"space-y-2",children:f&&f.length>0?f.map((a,d)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 rounded p-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-cyan-500",children:xe(a.ioc_type)}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-mono",children:a.value}),e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-400",children:a.ioc_type})]})]}),e.jsxs("span",{className:"text-gray-400 text-sm",children:[(a.confidence*100).toFixed(0),"% confidence"]})]},d)):e.jsx("p",{className:"text-gray-400",children:"No IOCs extracted."})}),i==="yara"&&e.jsx("div",{className:"space-y-2",children:g&&g.length>0?g.map((a,d)=>{var u;return e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 rounded p-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(P,{className:"w-5 h-5 text-orange-400"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-medium",children:a.rule_name}),e.jsx("div",{className:"flex gap-1 mt-1",children:(u=a.tags)==null?void 0:u.map((w,l)=>e.jsx("span",{className:"px-2 py-0.5 bg-orange-500/20 rounded text-xs text-orange-400",children:w},l))})]})]}),e.jsx("span",{className:"text-gray-400 text-sm",children:O(a.matched_at)})]},d)}):e.jsx("p",{className:"text-gray-400",children:"No YARA matches."})})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 border-t border-gray-700",children:[e.jsxs("button",{onClick:j,className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors flex items-center",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Re-analyze"]}),e.jsx("button",{onClick:y,className:"px-4 py-2 text-gray-300 hover:text-white transition-colors",children:"Close"})]})]})})},ze=({isOpen:t,config:r,onClose:y,onSave:j})=>{const[i,h]=c.useState(""),[m,p]=c.useState("cuckoo"),[f,g]=c.useState(""),[_,a]=c.useState(""),[d,u]=c.useState(300),[w,l]=c.useState(!1),[v,K]=c.useState(!0),[D,$]=c.useState(!1);ve.useEffect(()=>{r?(h(r.name),p(r.sandbox_type),g(r.api_url),a(""),u(r.timeout_seconds),l(r.is_default),K(r.is_active)):(h(""),p("cuckoo"),g(""),a(""),u(300),l(!1),K(!0))},[r]);const M=async o=>{o.preventDefault(),$(!0);try{const q={name:i,sandbox_type:m,api_url:f,api_key:_||void 0,timeout_seconds:d,is_default:w,is_active:v};r?(await A.updateConfig(r.id,q),x.success("Sandbox configuration updated")):(await A.createConfig(q),x.success("Sandbox configuration created")),j()}catch{x.error("Failed to save sandbox configuration")}finally{$(!1)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 w-full max-w-lg",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:r?"Edit Sandbox Configuration":"Add Sandbox Configuration"}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-white",children:e.jsx(V,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:M,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:i,onChange:o=>h(o.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"My Cuckoo Sandbox",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Sandbox Type"}),e.jsxs("select",{value:m,onChange:o=>p(o.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"cuckoo",children:"Cuckoo Sandbox"}),e.jsx("option",{value:"anyrun",children:"Any.Run"}),e.jsx("option",{value:"hybrid_analysis",children:"Hybrid Analysis"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"API URL"}),e.jsx("input",{type:"url",value:f,onChange:o=>g(o.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"https://sandbox.example.com/api",required:!0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[m==="cuckoo"&&"e.g., http://localhost:8090",m==="anyrun"&&"e.g., https://api.any.run",m==="hybrid_analysis"&&"e.g., https://www.hybrid-analysis.com/api/v2"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["API Key ",r&&e.jsx("span",{className:"text-gray-500",children:"(leave empty to keep existing)"})]}),e.jsx("input",{type:"password",value:_,onChange:o=>a(o.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"••••••••••••••••",required:!r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Timeout (seconds)"}),e.jsx("input",{type:"number",value:d,onChange:o=>u(parseInt(o.target.value)||300),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded text-white focus:outline-none focus:border-cyan-500",min:60,max:1800})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:v,onChange:o=>K(o.target.checked),className:"form-checkbox h-4 w-4 text-cyan-500 bg-gray-900 border-gray-700 rounded focus:ring-0"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Active"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:w,onChange:o=>l(o.target.checked),className:"form-checkbox h-4 w-4 text-cyan-500 bg-gray-900 border-gray-700 rounded focus:ring-0"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Default Sandbox"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:y,className:"px-4 py-2 text-gray-300 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:D,className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors flex items-center disabled:opacity-50",children:D?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),r?"Update":"Create"]})})]})]})]})}):null},Ge=()=>{const t=we(),[r,y]=c.useState("samples"),[j,i]=c.useState(!1),[h,m]=c.useState(null),[p,f]=c.useState(""),[g,_]=c.useState(""),{data:a,isLoading:d}=b({queryKey:["malware-stats"],queryFn:()=>N.getStats().then(s=>s.data)}),{data:u,isLoading:w,refetch:l}=b({queryKey:["malware-samples",p,g],queryFn:()=>N.listSamples({search:p||void 0,file_type:g||void 0,limit:100}).then(s=>s.data)}),{data:v,isLoading:K}=b({queryKey:["yara-rules"],queryFn:()=>N.listYaraRules({include_builtin:!0}).then(s=>s.data),enabled:r==="yara"}),{data:D,isLoading:$}=b({queryKey:["malware-iocs"],queryFn:()=>N.listIocs({limit:100}).then(s=>s.data),enabled:r==="iocs"}),{data:M,isLoading:o}=b({queryKey:["malware-queue"],queryFn:()=>N.listQueue().then(s=>s.data),enabled:r==="queue"}),{data:q,isLoading:de,refetch:oe}=b({queryKey:["sandbox-configs"],queryFn:()=>A.listConfigs().then(s=>s.data),enabled:r==="sandbox"}),{data:I,isLoading:me,refetch:he}=b({queryKey:["sandbox-submissions"],queryFn:()=>A.listSubmissions({limit:50}).then(s=>s.data),enabled:r==="sandbox"}),{data:S,isLoading:Ie}=b({queryKey:["sandbox-stats"],queryFn:()=>A.getStats().then(s=>s.data),enabled:r==="sandbox"}),L=S?{total_submissions:S.reduce((s,n)=>s+n.total_submissions,0),pending_submissions:S.reduce((s,n)=>s+n.pending,0),running_submissions:S.reduce((s,n)=>s+n.running,0),completed_submissions:S.reduce((s,n)=>s+n.completed,0),failed_submissions:S.reduce((s,n)=>s+n.failed,0),malicious_count:S.reduce((s,n)=>s+n.malicious,0),suspicious_count:S.reduce((s,n)=>s+n.suspicious,0),clean_count:S.reduce((s,n)=>s+n.clean,0),by_type:S}:void 0,X=T({mutationFn:s=>{const n=new FormData;return n.append("file",s.file),n.append("tags",s.tags.join(",")),n.append("notes",s.notes),N.uploadSample(n)},onSuccess:()=>{x.success("Sample uploaded and queued for analysis"),i(!1),t.invalidateQueries({queryKey:["malware-samples"]}),t.invalidateQueries({queryKey:["malware-stats"]}),t.invalidateQueries({queryKey:["malware-queue"]})},onError:s=>{var n,k;x.error(((k=(n=s.response)==null?void 0:n.data)==null?void 0:k.error)||"Failed to upload sample")}}),Z=T({mutationFn:s=>N.analyzeSample(s),onSuccess:s=>{x.success(`Analysis complete. Threat score: ${s.data.threat_score}`),t.invalidateQueries({queryKey:["malware-samples"]}),t.invalidateQueries({queryKey:["malware-stats"]}),h&&m(null)},onError:()=>{x.error("Failed to analyze sample")}}),ue=T({mutationFn:s=>N.deleteSample(s),onSuccess:()=>{x.success("Sample deleted"),t.invalidateQueries({queryKey:["malware-samples"]}),t.invalidateQueries({queryKey:["malware-stats"]})},onError:()=>{x.error("Failed to delete sample")}}),[ye,R]=c.useState(!1),[pe,U]=c.useState(null),[Ee,ge]=c.useState(!1),[Qe,je]=c.useState(null),E=T({mutationFn:s=>A.testConnection(s),onSuccess:s=>{s.data.success?x.success(`Connection successful: ${s.data.message}`):x.error(`Connection failed: ${s.data.message}`)},onError:()=>{x.error("Failed to test sandbox connection")}});T({mutationFn:s=>A.submitSample(s),onSuccess:()=>{x.success("Sample submitted to sandbox for analysis"),ge(!1),je(null),t.invalidateQueries({queryKey:["sandbox-submissions"]}),t.invalidateQueries({queryKey:["sandbox-stats"]})},onError:s=>{var n,k;x.error(((k=(n=s.response)==null?void 0:n.data)==null?void 0:k.error)||"Failed to submit to sandbox")}});const be=T({mutationFn:s=>A.deleteConfig(s),onSuccess:()=>{x.success("Sandbox configuration deleted"),t.invalidateQueries({queryKey:["sandbox-configs"]})},onError:()=>{x.error("Failed to delete sandbox configuration")}}),Q=T({mutationFn:s=>A.getStatus(s),onSuccess:s=>{x.success(`Status: ${s.data.status}${s.data.message?` - ${s.data.message}`:""}`),t.invalidateQueries({queryKey:["sandbox-submissions"]})},onError:()=>{x.error("Failed to poll submission status")}}),Ne=s=>{switch(s==null?void 0:s.toLowerCase()){case"malicious":return"bg-red-500/20 text-red-400";case"suspicious":return"bg-orange-500/20 text-orange-400";case"clean":return"bg-green-500/20 text-green-400";default:return"bg-gray-500/20 text-gray-400"}},fe=s=>{switch(s.toLowerCase()){case"completed":return"bg-green-500/20 text-green-400";case"running":return"bg-blue-500/20 text-blue-400";case"pending":return"bg-yellow-500/20 text-yellow-400";case"failed":return"bg-red-500/20 text-red-400";case"timeout":return"bg-orange-500/20 text-orange-400";default:return"bg-gray-500/20 text-gray-400"}};return e.jsxs(Me,{children:[e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center",children:[e.jsx(te,{className:"w-7 h-7 mr-2 text-red-500"}),"Malware Analysis"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Upload and analyze malware samples with static analysis and YARA matching"})]}),e.jsxs("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors flex items-center",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Upload Sample"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(F,{title:"Total Samples",value:(a==null?void 0:a.total_samples)??0,icon:e.jsx(Y,{className:"w-6 h-6 text-white"}),color:"bg-cyan-500/20"}),e.jsx(F,{title:"Malicious",value:(a==null?void 0:a.samples_malicious)??0,icon:e.jsx(J,{className:"w-6 h-6 text-white"}),color:"bg-red-500/20"}),e.jsx(F,{title:"YARA Rules",value:(a==null?void 0:a.total_yara_rules)??0,icon:e.jsx(P,{className:"w-6 h-6 text-white"}),color:"bg-orange-500/20"}),e.jsx(F,{title:"IOCs Extracted",value:(a==null?void 0:a.total_iocs)??0,icon:e.jsx(ae,{className:"w-6 h-6 text-white"}),color:"bg-purple-500/20"})]}),e.jsx("div",{className:"flex border-b border-gray-700",children:["samples","yara","iocs","queue","sandbox"].map(s=>e.jsxs("button",{onClick:()=>y(s),className:`px-6 py-3 text-sm font-medium transition-colors ${r===s?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:[s==="samples"&&"Samples",s==="yara"&&"YARA Rules",s==="iocs"&&"IOCs",s==="queue"&&"Analysis Queue",s==="sandbox"&&"Sandbox"]},s))}),r==="samples"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by filename, hash, or notes...",value:p,onChange:s=>f(s.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded pl-10 pr-4 py-2 text-white"})]}),e.jsxs("select",{value:g,onChange:s=>_(s.target.value),className:"bg-gray-800 border border-gray-700 rounded px-4 py-2 text-white",children:[e.jsx("option",{value:"",children:"All File Types"}),e.jsx("option",{value:"pe",children:"PE"}),e.jsx("option",{value:"elf",children:"ELF"}),e.jsx("option",{value:"script",children:"Script"}),e.jsx("option",{value:"pdf",children:"PDF"}),e.jsx("option",{value:"apk",children:"APK"})]}),e.jsx("button",{onClick:()=>l(),className:"px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600 transition-colors",children:e.jsx(B,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Sample"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Size"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Threat"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Classification"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:w?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(C,{className:"w-6 h-6 animate-spin mx-auto"})})}):u&&u.length>0?u.map(s=>e.jsx($e,{sample:s,onSelect:()=>m(s),onAnalyze:()=>Z.mutate(s.id),onDelete:()=>{confirm("Are you sure you want to delete this sample?")&&ue.mutate(s.id)}},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-400",children:"No samples found. Upload a sample to get started."})})})]})})]}),r==="yara"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Rule Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Matches"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Status"})]})}),e.jsx("tbody",{children:K?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(C,{className:"w-6 h-6 animate-spin mx-auto"})})}):v&&v.length>0?v.map(s=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-4 h-4 text-orange-400"}),e.jsx("span",{className:"text-white font-medium",children:s.name})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.category}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.severity==="critical"?"bg-red-500/20 text-red-400":s.severity==="high"?"bg-orange-500/20 text-orange-400":s.severity==="medium"?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400"}`,children:s.severity})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.is_builtin?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400"}`,children:s.is_builtin?"Built-in":"Custom"})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.match_count}),e.jsx("td",{className:"px-4 py-3",children:s.is_enabled?e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-green-500/20 text-green-400",children:"Enabled"}):e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-gray-500/20 text-gray-400",children:"Disabled"})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:"No YARA rules found."})})})]})})}),r==="iocs"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"IOC Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Value"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Sample"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Confidence"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Date"})]})}),e.jsx("tbody",{children:$?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(C,{className:"w-6 h-6 animate-spin mx-auto"})})}):D&&D.length>0?D.map(s=>{var n;return e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[xe(s.ioc_type),e.jsx("span",{className:"text-gray-300",children:s.ioc_type})]})}),e.jsx("td",{className:"px-4 py-3 text-white font-mono text-sm",children:s.value}),e.jsx("td",{className:"px-4 py-3 text-gray-300 text-sm",children:s.sample_filename||((n=s.sample_sha256)==null?void 0:n.substring(0,16))+"..."}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`px-2 py-1 rounded text-xs ${s.confidence>=.8?"bg-green-500/20 text-green-400":s.confidence>=.5?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400"}`,children:[(s.confidence*100).toFixed(0),"%"]})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(s.created_at).toLocaleDateString()})]},s.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-400",children:"No IOCs extracted yet."})})})]})})}),r==="queue"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Sample"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Analysis Types"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Priority"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Attempts"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Created"})]})}),e.jsx("tbody",{children:o?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(C,{className:"w-6 h-6 animate-spin mx-auto"})})}):M&&M.length>0?M.map(s=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.sample_filename}),e.jsxs("p",{className:"text-gray-500 text-xs font-mono",children:[s.sample_sha256.substring(0,16),"..."]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.analysis_types.split(",").map((n,k)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-300",children:n.trim()},k))})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.priority}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.status==="pending"?"bg-yellow-500/20 text-yellow-400":s.status==="running"?"bg-blue-500/20 text-blue-400":s.status==="completed"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:s.status})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.attempts}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(s.created_at).toLocaleDateString()})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:"No items in queue."})})})]})})}),r==="sandbox"&&e.jsxs("div",{className:"space-y-6",children:[L&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx(F,{title:"Total Submissions",value:L.total_submissions,icon:e.jsx(Y,{className:"w-6 h-6 text-white"}),color:"bg-cyan-500/20"}),e.jsx(F,{title:"Pending",value:L.pending_submissions,icon:e.jsx(Ce,{className:"w-6 h-6 text-white"}),color:"bg-yellow-500/20"}),e.jsx(F,{title:"Running",value:L.running_submissions,icon:e.jsx(C,{className:"w-6 h-6 text-white animate-spin"}),color:"bg-blue-500/20"}),e.jsx(F,{title:"Completed",value:L.completed_submissions,icon:e.jsx(re,{className:"w-6 h-6 text-white"}),color:"bg-green-500/20"}),e.jsx(F,{title:"Malicious",value:L.malicious_count,icon:e.jsx(J,{className:"w-6 h-6 text-white"}),color:"bg-red-500/20"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center",children:[e.jsx(P,{className:"w-5 h-5 mr-2 text-cyan-500"}),"Sandbox Configurations"]}),e.jsxs("button",{onClick:()=>{U(null),R(!0)},className:"px-3 py-1.5 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors flex items-center text-sm",children:[e.jsx(_e,{className:"w-4 h-4 mr-1"}),"Add Sandbox"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"API URL"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Timeout"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:de?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:[e.jsx(C,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Loading configurations..."]})}):q&&q.length>0?q.map(s=>e.jsxs("tr",{className:"hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-white font-medium",children:s.name}),s.is_default&&e.jsx("span",{className:"px-2 py-0.5 bg-cyan-500/20 text-cyan-400 rounded text-xs",children:"Default"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 bg-gray-700 rounded text-xs text-gray-300 uppercase",children:s.sandbox_type})}),e.jsx("td",{className:"px-4 py-3 text-gray-300 text-sm font-mono truncate max-w-xs",children:s.api_url}),e.jsxs("td",{className:"px-4 py-3 text-gray-300",children:[s.timeout_seconds,"s"]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.is_active?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:s.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>E.mutate(s.id),className:"p-1.5 text-gray-400 hover:text-cyan-400 transition-colors",title:"Test Connection",disabled:E.isPending,children:E.isPending?e.jsx(C,{className:"w-4 h-4 animate-spin"}):e.jsx(H,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{U(s),R(!0)},className:"p-1.5 text-gray-400 hover:text-white transition-colors",title:"Edit",children:e.jsx(W,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{confirm("Delete this sandbox configuration?")&&be.mutate(s.id)},className:"p-1.5 text-gray-400 hover:text-red-400 transition-colors",title:"Delete",children:e.jsx(ne,{className:"w-4 h-4"})})]})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:"No sandbox configurations. Add one to start analyzing samples in sandboxes."})})})]})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center",children:[e.jsx(ke,{className:"w-5 h-5 mr-2 text-cyan-500"}),"Recent Sandbox Submissions"]}),e.jsx("button",{onClick:()=>he(),className:"p-2 text-gray-400 hover:text-white transition-colors",title:"Refresh",children:e.jsx(B,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Sample"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Sandbox"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Verdict"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Threat Score"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Submitted"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:me?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-400",children:[e.jsx(C,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Loading submissions..."]})}):I&&I.length>0?I.map(s=>{var n;return e.jsxs("tr",{className:"hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium truncate max-w-xs",children:s.sample_filename||"Unknown"}),e.jsxs("p",{className:"text-gray-500 text-xs font-mono",children:[(n=s.sample_sha256)==null?void 0:n.substring(0,16),"..."]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 bg-gray-700 rounded text-xs text-gray-300 uppercase",children:s.sandbox_type})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${fe(s.status)}`,children:s.status})}),e.jsx("td",{className:"px-4 py-3",children:s.verdict?e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Ne(s.verdict)}`,children:s.verdict}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:s.threat_score!==void 0&&s.threat_score!==null?e.jsx("span",{className:`font-bold ${Pe(s.threat_score)}`,children:s.threat_score}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(s.submitted_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[(s.status==="pending"||s.status==="running")&&e.jsx("button",{onClick:()=>Q.mutate(s.id),className:"p-1.5 text-gray-400 hover:text-cyan-400 transition-colors",title:"Poll Status",disabled:Q.isPending,children:e.jsx(B,{className:`w-4 h-4 ${Q.isPending?"animate-spin":""}`})}),s.status==="completed"&&s.report_url&&e.jsx("a",{href:s.report_url,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-gray-400 hover:text-cyan-400 transition-colors",title:"View Report",children:e.jsx(W,{className:"w-4 h-4"})})]})})]},s.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-400",children:"No sandbox submissions. Submit samples to sandboxes from the Samples tab."})})})]})})]})]})]}),e.jsx(Re,{isOpen:j,onClose:()=>i(!1),onUpload:(s,n,k)=>X.mutate({file:s,tags:n,notes:k}),isUploading:X.isPending}),e.jsx(Ue,{sample:h,isOpen:!!h,onClose:()=>m(null),onAnalyze:()=>{h&&Z.mutate(h.id)}}),e.jsx(ze,{isOpen:ye,config:pe,onClose:()=>{R(!1),U(null)},onSave:()=>{oe(),R(!1),U(null)}})]})};export{Ge as default};
