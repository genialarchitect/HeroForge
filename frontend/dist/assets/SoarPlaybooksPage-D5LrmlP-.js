import{j as e}from"./vendor-state-DdX3IZQk.js";import{r as a}from"./vendor-react-Da1CiaFS.js";import{B as i,W as u,aC as h,P as $,aQ as y,d as M,aE as F,ac as B,bt as L,Z as z,aG as _,i as G,ap as H,j as J,as as j,aF as W}from"./vendor-ui-Cfxa9o3E.js";import{d as U}from"./index-C3P2Oms8.js";import"./vendor-charts-ed8SE4MW.js";const n={getPlaybooks:async()=>[{id:"1",name:"Malicious IP Response",description:"Auto-block malicious IPs and create tickets",category:"incident_response",trigger_type:"alert",status:"active",version:3,run_count:145,success_rate:94.5,avg_duration_seconds:45,last_run_at:new Date().toISOString(),created_at:new Date().toISOString()},{id:"2",name:"Phishing Email Analysis",description:"Extract IOCs and block malicious domains",category:"enrichment",trigger_type:"manual",status:"active",version:2,run_count:87,success_rate:98.2,avg_duration_seconds:120,last_run_at:new Date().toISOString(),created_at:new Date().toISOString()},{id:"3",name:"Vulnerability Remediation",description:"Create JIRA tickets for critical vulnerabilities",category:"remediation",trigger_type:"schedule",status:"active",version:1,run_count:52,success_rate:100,avg_duration_seconds:15,last_run_at:new Date().toISOString(),created_at:new Date().toISOString()},{id:"4",name:"User Account Lockout",description:"Lock account and notify security team",category:"containment",trigger_type:"alert",status:"draft",version:1,run_count:0,created_at:new Date().toISOString()}],getActions:async()=>[{id:"1",name:"ip_lookup",display_name:"IP Lookup",description:"Get IP reputation and geolocation",category:"enrichment",action_type:"builtin",risk_level:"low",requires_approval:!1},{id:"2",name:"domain_lookup",display_name:"Domain Lookup",description:"Get domain WHOIS and DNS info",category:"enrichment",action_type:"builtin",risk_level:"low",requires_approval:!1},{id:"3",name:"block_ip",display_name:"Block IP",description:"Block IP at firewall",category:"containment",action_type:"api",risk_level:"high",requires_approval:!0},{id:"4",name:"disable_user",display_name:"Disable User Account",description:"Disable user in Active Directory",category:"containment",action_type:"api",risk_level:"high",requires_approval:!0},{id:"5",name:"send_email",display_name:"Send Email",description:"Send notification email",category:"notification",action_type:"builtin",risk_level:"low",requires_approval:!1},{id:"6",name:"send_slack",display_name:"Send Slack Message",description:"Send message to Slack channel",category:"notification",action_type:"builtin",risk_level:"low",requires_approval:!1},{id:"7",name:"create_ticket",display_name:"Create Ticket",description:"Create ticket in JIRA/ServiceNow",category:"remediation",action_type:"api",risk_level:"low",requires_approval:!1},{id:"8",name:"http_request",display_name:"HTTP Request",description:"Make HTTP API call",category:"utility",action_type:"builtin",risk_level:"medium",requires_approval:!1}],getRuns:async()=>[{id:"1",playbook_id:"1",playbook_name:"Malicious IP Response",trigger_type:"alert",status:"completed",current_step:5,total_steps:5,started_at:new Date().toISOString(),completed_at:new Date().toISOString(),duration_seconds:42,initiated_by:"Alert: Malicious IP Detected"},{id:"2",playbook_id:"2",playbook_name:"Phishing Email Analysis",trigger_type:"manual",status:"running",current_step:3,total_steps:7,started_at:new Date().toISOString(),initiated_by:"admin@example.com"},{id:"3",playbook_id:"1",playbook_name:"Malicious IP Response",trigger_type:"alert",status:"waiting_approval",current_step:4,total_steps:5,started_at:new Date().toISOString(),initiated_by:"Alert: Suspicious Traffic"},{id:"4",playbook_id:"3",playbook_name:"Vulnerability Remediation",trigger_type:"schedule",status:"failed",current_step:2,total_steps:3,started_at:new Date().toISOString(),completed_at:new Date().toISOString(),duration_seconds:8,initiated_by:"Scheduled: Daily 9AM"}],getApprovals:async()=>[{id:"1",run_id:"3",playbook_name:"Malicious IP Response",step_name:"Block IP at Firewall",status:"pending",required_approvals:1,current_approvals:0,created_at:new Date().toISOString()}],getIntegrations:async()=>[{id:"1",name:"Splunk SIEM",integration_type:"siem",vendor:"splunk",status:"connected",last_test_at:new Date().toISOString()},{id:"2",name:"JIRA",integration_type:"ticketing",vendor:"atlassian",status:"connected",last_test_at:new Date().toISOString()},{id:"3",name:"Slack",integration_type:"notification",vendor:"slack",status:"connected",last_test_at:new Date().toISOString()},{id:"4",name:"Palo Alto Firewall",integration_type:"firewall",vendor:"palo_alto",status:"disconnected"}],runPlaybook:async s=>{await new Promise(r=>setTimeout(r,500))},approveStep:async s=>{await new Promise(r=>setTimeout(r,500))},rejectStep:async s=>{await new Promise(r=>setTimeout(r,500))}},Y=()=>{const[s,r]=a.useState("playbooks"),[x,v]=a.useState([]),[N,b]=a.useState([]),[o,w]=a.useState([]),[l,f]=a.useState([]),[S,k]=a.useState([]),[P,p]=a.useState(!0),[m,I]=a.useState(null);a.useEffect(()=>{c()},[]);const c=async()=>{try{p(!0);const[t,d,q,T,E]=await Promise.all([n.getPlaybooks(),n.getActions(),n.getRuns(),n.getApprovals(),n.getIntegrations()]);v(t),b(d),w(q),f(T),k(E)}catch{i.error("Failed to load SOAR data")}finally{p(!1)}},A=async t=>{try{i.info(`Starting ${t.name}...`),await n.runPlaybook(t.id),i.success("Playbook started successfully"),c()}catch{i.error("Failed to start playbook")}},D=async t=>{try{await n.approveStep(t.id),i.success("Step approved"),c()}catch{i.error("Failed to approve step")}},C=async t=>{try{await n.rejectStep(t.id),i.success("Step rejected"),c()}catch{i.error("Failed to reject step")}},R=t=>{switch(t){case"completed":return e.jsx(_,{className:"h-5 w-5 text-green-400"});case"failed":return e.jsx(W,{className:"h-5 w-5 text-red-400"});case"running":return e.jsx(y,{className:"h-5 w-5 text-cyan-400 animate-spin"});case"waiting_approval":return e.jsx(h,{className:"h-5 w-5 text-yellow-400"});case"pending":return e.jsx(j,{className:"h-5 w-5 text-gray-400"});default:return e.jsx(j,{className:"h-5 w-5 text-gray-400"})}},g=t=>{switch(t){case"enrichment":return"bg-blue-600";case"containment":return"bg-red-600";case"remediation":return"bg-green-600";case"notification":return"bg-purple-600";case"incident_response":return"bg-orange-600";case"utility":return"bg-gray-600";default:return"bg-gray-600"}},O=t=>{switch(t){case"high":return"text-red-400";case"medium":return"text-yellow-400";case"low":return"text-green-400";default:return"text-gray-400"}};return e.jsx(U,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{className:"h-8 w-8 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"SOAR Playbooks"}),e.jsx("p",{className:"text-gray-400",children:"Security Orchestration, Automation, and Response"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[l.length>0&&e.jsxs("button",{onClick:()=>r("approvals"),className:"flex items-center gap-2 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-500",children:[e.jsx(h,{className:"h-4 w-4"}),l.length," Pending Approval"]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-500",children:[e.jsx($,{className:"h-4 w-4"}),"Create Playbook"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:x.filter(t=>t.status==="active").length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Active Playbooks"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-cyan-400",children:o.filter(t=>t.status==="running").length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Running"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:o.filter(t=>t.status==="completed").length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Completed Today"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:l.length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Pending Approvals"})]})]}),e.jsx("div",{className:"flex gap-1 mb-6 border-b border-gray-700",children:["playbooks","actions","runs","approvals","integrations"].map(t=>e.jsxs("button",{onClick:()=>r(t),className:`px-4 py-2 font-medium capitalize ${s===t?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:[t,t==="approvals"&&l.length>0&&e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-yellow-600 text-white text-xs rounded-full",children:l.length})]},t))}),P?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(y,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs(e.Fragment,{children:[s==="playbooks"&&e.jsx("div",{className:"grid gap-4",children:x.map(t=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>I(m===t.id?null:t.id),className:"text-gray-400 hover:text-white",children:m===t.id?e.jsx(M,{className:"h-5 w-5"}):e.jsx(F,{className:"h-5 w-5"})}),e.jsx(u,{className:"h-6 w-6 text-cyan-400"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[t.name,e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${t.status==="active"?"bg-green-600":"bg-gray-600"} text-white`,children:t.status})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:t.description})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{className:"text-white",children:[t.run_count," runs"]}),t.success_rate&&e.jsxs("div",{className:"text-green-400",children:[t.success_rate,"% success"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>A(t),className:"p-2 bg-cyan-600 rounded-lg hover:bg-cyan-500",disabled:t.status!=="active",children:e.jsx(B,{className:"h-4 w-4 text-white"})}),e.jsx("button",{className:"p-2 bg-gray-700 rounded-lg hover:bg-gray-600",children:e.jsx(L,{className:"h-4 w-4 text-gray-300"})})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-3",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs text-white ${g(t.category)}`,children:t.category}),e.jsxs("span",{className:"text-gray-400 text-sm flex items-center gap-1",children:[e.jsx(z,{className:"h-3 w-3"}),t.trigger_type]}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["v",t.version]}),t.avg_duration_seconds&&e.jsxs("span",{className:"text-gray-400 text-sm",children:["~",t.avg_duration_seconds,"s avg"]})]})]},t.id))}),s==="actions"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(t=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:t.display_name}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:t.description})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs text-white ${g(t.category)}`,children:t.category}),e.jsxs("span",{className:`text-xs ${O(t.risk_level)}`,children:[t.risk_level," risk"]}),t.requires_approval&&e.jsx("span",{className:"px-2 py-1 bg-yellow-600 text-white text-xs rounded",children:"Requires Approval"})]})]},t.id))}),s==="runs"&&e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Playbook"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Trigger"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Progress"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Initiated By"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Duration"})]})}),e.jsx("tbody",{children:o.map(t=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[R(t.status),e.jsx("span",{className:"text-white capitalize",children:t.status.replace("_"," ")})]})}),e.jsx("td",{className:"px-4 py-3 text-white",children:t.playbook_name}),e.jsx("td",{className:"px-4 py-3 text-gray-300 capitalize",children:t.trigger_type}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-cyan-500 h-2 rounded-full",style:{width:`${t.current_step/t.total_steps*100}%`}})}),e.jsxs("span",{className:"text-gray-400 text-sm",children:[t.current_step,"/",t.total_steps]})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:t.initiated_by}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.duration_seconds?`${t.duration_seconds}s`:"-"})]},t.id))})]})}),s==="approvals"&&e.jsx("div",{className:"space-y-4",children:l.length===0?e.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 text-center",children:[e.jsx(_,{className:"h-12 w-12 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-white text-lg font-medium",children:"No Pending Approvals"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"All playbook steps are up to date"})]}):l.map(t=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:t.playbook_name}),e.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Step: ",t.step_name]}),e.jsxs("p",{className:"text-gray-500 text-xs mt-2",children:[t.current_approvals,"/",t.required_approvals," approvals"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>D(t),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-500",children:[e.jsx(G,{className:"h-4 w-4"}),"Approve"]}),e.jsxs("button",{onClick:()=>C(t),className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-500",children:[e.jsx(H,{className:"h-4 w-4"}),"Reject"]})]})]})},t.id))}),s==="integrations"&&e.jsx("div",{className:"grid gap-4",children:S.map(t=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${t.status==="connected"?"bg-green-400":"bg-red-400"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:t.name}),e.jsxs("p",{className:"text-gray-400 text-sm capitalize",children:[t.integration_type," â€¢ ",t.vendor||"Custom"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:`text-sm ${t.status==="connected"?"text-green-400":"text-red-400"}`,children:t.status}),e.jsx("button",{className:"p-2 bg-gray-700 rounded-lg hover:bg-gray-600",children:e.jsx(J,{className:"h-4 w-4 text-gray-300"})})]})]})},t.id))})]})]})})};export{Y as default};
