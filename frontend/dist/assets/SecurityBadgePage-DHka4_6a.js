import{j as e}from"./vendor-state-oFDmcCcB.js";import{i as P,e as _,r as c}from"./vendor-react-5KxtEOLM.js";import{S as R,aa as N,h as G,O as I,d as f,J as v,F as M,bz as U,a0 as Y,V as H,B as h,as as W,aB as q,aC as z}from"./vendor-ui-7EurIAWU.js";const K=()=>{const{domain:x}=P(),[F]=_(),[r,T]=c.useState(x||F.get("domain")||""),[t,g]=c.useState(null),[l,$]=c.useState(null),[m,w]=c.useState(!1),[n,S]=c.useState(!1),[u,d]=c.useState(null),[b,C]=c.useState(null),[i,D]=c.useState("shield");c.useEffect(()=>{x&&(k(x),y(x))},[x]);const k=async s=>{w(!0),d(null);try{const a=await fetch(`/api/badges/${s}/score`),o=await a.json();o.success?g(o.data):(g(null),a.status!==404&&d(o.error||"Failed to load score"))}catch{d("Failed to connect to server")}finally{w(!1)}},y=async s=>{try{const o=await(await fetch(`/api/badges/${s}/embed`)).json();o.success&&$(o.data)}catch(a){console.error("Failed to load embed codes:",a)}},E=async()=>{if(r){S(!0),d(null);try{const a=await(await fetch(`/api/badges/${r}/scan`,{method:"POST"})).json();a.success?(g(a.data),y(r),h.success("Security scan completed!")):(d(a.error||"Scan failed"),h.error(a.error||"Scan failed"))}catch{d("Failed to perform scan"),h.error("Failed to perform scan")}finally{S(!1)}}},B=s=>{s.preventDefault(),r&&(k(r),y(r),window.history.pushState({},"",`/security/${r}`))},j=(s,a)=>{navigator.clipboard.writeText(s),C(a),h.success("Copied to clipboard!"),setTimeout(()=>C(null),2e3)},A=s=>{switch(s){case"A+":case"A":return"Excellent security posture";case"A-":case"B+":return"Good security with minor improvements needed";case"B":case"B-":return"Acceptable security with some gaps";case"C+":case"C":return"Fair security with notable issues";case"C-":case"D+":return"Poor security requiring attention";case"D":return"Significant security issues found";default:return"Critical security vulnerabilities present"}},L=s=>s>=80?e.jsx(W,{className:"w-4 h-4 text-green-400"}):s>=60?e.jsx(q,{className:"w-4 h-4 text-yellow-400"}):e.jsx(z,{className:"w-4 h-4 text-red-400"}),p=()=>{const s=window.location.origin,a=i!=="shield"?`?style=${i}`:"";return`${s}/api/badges/${r}${a}`};return e.jsxs("div",{className:"min-h-screen bg-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-b from-gray-800 to-gray-900 py-12 px-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-4",children:[e.jsx(R,{className:"w-10 h-10 text-cyan-400"}),e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Security Score Badge"})]}),e.jsx("p",{className:"text-gray-400 mb-8",children:"Showcase your website's security posture with a live security badge"}),e.jsx("form",{onSubmit:B,className:"max-w-xl mx-auto",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:r,onChange:s=>T(s.target.value),placeholder:"Enter domain (e.g., example.com)",className:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500"}),e.jsx("button",{type:"submit",disabled:m||!r,className:"px-6 py-3 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsx(N,{className:"w-5 h-5 animate-spin"}):"Check"})]})})]})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-8",children:[u&&e.jsxs("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-4 mb-6 flex items-center text-red-400",children:[e.jsx(G,{className:"w-5 h-5 mr-2 flex-shrink-0"}),u]}),t?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:t.domain}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Last scanned: ",t.last_scan?new Date(t.last_scan).toLocaleString():"Never"]})]}),e.jsxs("button",{onClick:E,disabled:n,className:"flex items-center px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors disabled:opacity-50",children:[e.jsx(N,{className:`w-4 h-4 mr-2 ${n?"animate-spin":""}`}),n?"Scanning...":"Rescan"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-4xl font-bold mb-1",style:{color:t.grade_color},children:t.grade}),e.jsx("div",{className:"text-sm text-gray-400",children:"Grade"})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 text-center",children:[e.jsxs("div",{className:"text-4xl font-bold text-white mb-1 flex items-center justify-center",children:[t.score,e.jsx("span",{className:"text-lg text-gray-500 ml-1",children:"/100"})]}),e.jsxs("div",{className:"text-sm text-gray-400 flex items-center justify-center",children:["Score ",L(t.score)]})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-white mb-1",children:t.issues.critical+t.issues.high+t.issues.medium+t.issues.low+t.issues.info}),e.jsx("div",{className:"text-sm text-gray-400",children:"Total Issues"})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-sm text-gray-300 mb-1",children:A(t.grade)}),e.jsx("div",{className:"text-sm text-gray-400",children:"Status"})]})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[e.jsxs("div",{className:"bg-red-900/30 border border-red-800 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:t.issues.critical}),e.jsx("div",{className:"text-xs text-red-300",children:"Critical"})]}),e.jsxs("div",{className:"bg-orange-900/30 border border-orange-800 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400",children:t.issues.high}),e.jsx("div",{className:"text-xs text-orange-300",children:"High"})]}),e.jsxs("div",{className:"bg-yellow-900/30 border border-yellow-800 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:t.issues.medium}),e.jsx("div",{className:"text-xs text-yellow-300",children:"Medium"})]}),e.jsxs("div",{className:"bg-blue-900/30 border border-blue-800 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:t.issues.low}),e.jsx("div",{className:"text-xs text-blue-300",children:"Low"})]}),e.jsxs("div",{className:"bg-gray-700/50 border border-gray-600 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-400",children:t.issues.info}),e.jsx("div",{className:"text-xs text-gray-300",children:"Info"})]})]})]})}),e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"border-b border-gray-700 p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Embed Your Badge"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Add this badge to your website to showcase your security score"})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Style:"}),e.jsx("div",{className:"flex space-x-2",children:["shield","flat","gradient"].map(s=>e.jsx("button",{onClick:()=>D(s),className:`px-3 py-1 rounded text-sm capitalize ${i===s?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:s},s))})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 text-center mb-6",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-3",children:"Preview"}),e.jsx("img",{src:p(),alt:`Security score for ${r}`,className:"inline-block"})]}),l&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx(I,{className:"w-4 h-4 mr-1"}),"HTML"]}),e.jsxs("button",{onClick:()=>j(i==="flat"?l.html_flat:i==="gradient"?l.html_gradient:l.html,"html"),className:"flex items-center text-xs text-cyan-400 hover:text-cyan-300",children:[b==="html"?e.jsx(f,{className:"w-3 h-3 mr-1"}):e.jsx(v,{className:"w-3 h-3 mr-1"}),"Copy"]})]}),e.jsx("code",{className:"block bg-gray-900 rounded p-3 text-xs text-gray-300 overflow-x-auto",children:i==="flat"?l.html_flat:i==="gradient"?l.html_gradient:l.html})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx(M,{className:"w-4 h-4 mr-1"}),"Markdown"]}),e.jsxs("button",{onClick:()=>j(l.markdown,"markdown"),className:"flex items-center text-xs text-cyan-400 hover:text-cyan-300",children:[b==="markdown"?e.jsx(f,{className:"w-3 h-3 mr-1"}):e.jsx(v,{className:"w-3 h-3 mr-1"}),"Copy"]})]}),e.jsx("code",{className:"block bg-gray-900 rounded p-3 text-xs text-gray-300 overflow-x-auto",children:l.markdown})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx(U,{className:"w-4 h-4 mr-1"}),"Direct Image URL"]}),e.jsxs("button",{onClick:()=>j(p(),"url"),className:"flex items-center text-xs text-cyan-400 hover:text-cyan-300",children:[b==="url"?e.jsx(f,{className:"w-3 h-3 mr-1"}):e.jsx(v,{className:"w-3 h-3 mr-1"}),"Copy"]})]}),e.jsx("code",{className:"block bg-gray-900 rounded p-3 text-xs text-gray-300 overflow-x-auto",children:p()})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-cyan-900/50 to-blue-900/50 rounded-xl border border-cyan-800 p-6 text-center",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Want deeper security insights?"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Get comprehensive vulnerability scanning, compliance checks, and continuous monitoring with HeroForge."}),e.jsxs("a",{href:"/register",className:"inline-flex items-center px-6 py-3 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg font-medium transition-colors",children:["Start Free Trial",e.jsx(Y,{className:"w-4 h-4 ml-2"})]})]})]}):!m&&r&&!u?e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-8 text-center",children:[e.jsx(H,{className:"w-12 h-12 text-yellow-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No security score found"}),e.jsxs("p",{className:"text-gray-400 mb-6",children:["We haven't scanned ",r," yet. Click below to run a free security scan."]}),e.jsxs("button",{onClick:E,disabled:n,className:"inline-flex items-center px-6 py-3 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50",children:[e.jsx(N,{className:`w-5 h-5 mr-2 ${n?"animate-spin":""}`}),n?"Scanning...":"Run Free Scan"]})]}):!m&&!r?e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6",children:[e.jsx("div",{className:"w-10 h-10 bg-cyan-900 rounded-lg flex items-center justify-center mb-4",children:e.jsx("span",{className:"text-cyan-400 font-bold",children:"1"})}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Enter Your Domain"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Type your website's domain name in the search box above."})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6",children:[e.jsx("div",{className:"w-10 h-10 bg-cyan-900 rounded-lg flex items-center justify-center mb-4",children:e.jsx("span",{className:"text-cyan-400 font-bold",children:"2"})}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Get Your Score"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"We'll scan your site for security headers, SSL config, and more."})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6",children:[e.jsx("div",{className:"w-10 h-10 bg-cyan-900 rounded-lg flex items-center justify-center mb-4",children:e.jsx("span",{className:"text-cyan-400 font-bold",children:"3"})}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Embed Your Badge"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Copy the embed code and add it to your website or README."})]})]}):null]})]})};export{K as default};
