import{j as e,u as D,b as ae,d as B}from"./vendor-state-DdX3IZQk.js";import{R as he,r as b,j as Ce,u as Se}from"./vendor-react-Da1CiaFS.js";import{aq as G,K,O as I,af as W,E as ce,S as O,J as ge,N as be,x as ye,G as Pe,q as Ae,Q as je,bf as fe,a as Ne,bv as ve,aD as J,h as Te,bR as Re,d as qe,aH as Q,B as T,bl as te,P as Y,aQ as Z,aK as de,Y as re,A as V,ae as we,bo as ue,aB as ne,aR as ie,at as Le,aN as Fe,F as $e}from"./vendor-ui-wM19Qo8C.js";import{T as pe,E as Me,a4 as L,b as M,d as Ee}from"./index-9Ba8KlZ7.js";import"./vendor-charts-CCbxmwBt.js";const Ke=[{id:"password_spray",name:"Password Spray",description:"Test common passwords against multiple accounts with lockout evasion",category:"credential",icon:e.jsx(K,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium",requirements:["Target IP/hostname","Username list","Password list"]},{id:"kerberoast",name:"Kerberoasting",description:"Extract TGS tickets from Active Directory for offline cracking",category:"credential",icon:e.jsx(O,{className:"h-6 w-6"}),difficulty:"medium",risk:"low",requirements:["Domain credentials","Domain controller access"]},{id:"asrep_roast",name:"AS-REP Roasting",description:"Target accounts without Kerberos pre-authentication",category:"credential",icon:e.jsx(ge,{className:"h-6 w-6"}),difficulty:"medium",risk:"low",requirements:["Domain controller","Username list"]},{id:"smb_relay",name:"SMB Relay",description:"Relay NTLM authentication to other targets",category:"credential",icon:e.jsx(be,{className:"h-6 w-6"}),difficulty:"hard",risk:"high",requirements:["Network position","Target systems"]},{id:"reverse_shell",name:"Reverse Shell",description:"Generate reverse shell payloads in various formats",category:"payload",icon:e.jsx(I,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium",requirements:["LHOST","LPORT"]},{id:"bind_shell",name:"Bind Shell",description:"Generate bind shell payloads that listen for connections",category:"payload",icon:e.jsx(ye,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium",requirements:["LPORT"]},{id:"web_shell",name:"Web Shell",description:"Generate web shells for PHP, ASPX, JSP",category:"payload",icon:e.jsx(Pe,{className:"h-6 w-6"}),difficulty:"easy",risk:"high",requirements:["Target web server"]},{id:"meterpreter",name:"Meterpreter",description:"Generate advanced Meterpreter payloads via msfvenom",category:"payload",icon:e.jsx(Ae,{className:"h-6 w-6"}),difficulty:"medium",risk:"high",requirements:["msfvenom installed","LHOST","LPORT"]},{id:"credential_dump",name:"Credential Dump",description:"Extract credentials from memory, registry, or files",category:"post-exploit",icon:e.jsx(je,{className:"h-6 w-6"}),difficulty:"medium",risk:"high",requirements:["Admin/root access","Target system"]},{id:"priv_esc",name:"Privilege Escalation",description:"Check for privilege escalation vectors",category:"post-exploit",icon:e.jsx(fe,{className:"h-6 w-6"}),difficulty:"medium",risk:"medium",requirements:["Target system access"]},{id:"persistence",name:"Persistence",description:"Establish persistent access mechanisms",category:"post-exploit",icon:e.jsx(Ne,{className:"h-6 w-6"}),difficulty:"hard",risk:"high",requirements:["System access","Admin/root privileges"]},{id:"lateral_movement",name:"Lateral Movement",description:"Move to other systems using Pass-the-Hash, WMI, PsExec",category:"post-exploit",icon:e.jsx(ve,{className:"h-6 w-6"}),difficulty:"hard",risk:"high",requirements:["Credentials/hashes","Network access"]}],De=({isOpen:g,onClose:y,onSelect:j,msfvenomAvailable:_=!1})=>{const[x,c]=he.useState("all"),[m,A]=he.useState("");if(!g)return null;const f=Ke.filter(d=>{const p=x==="all"||d.category===x,C=m===""||d.name.toLowerCase().includes(m.toLowerCase())||d.description.toLowerCase().includes(m.toLowerCase());return p&&C}),h=d=>{switch(d){case"easy":return"bg-green-500/20 text-green-400";case"medium":return"bg-yellow-500/20 text-yellow-400";case"hard":return"bg-red-500/20 text-red-400";default:return"bg-gray-500/20 text-gray-400"}},w=d=>{switch(d){case"low":return"bg-green-500/20 text-green-400";case"medium":return"bg-yellow-500/20 text-yellow-400";case"high":return"bg-red-500/20 text-red-400";default:return"bg-gray-500/20 text-gray-400"}},N=d=>{switch(d){case"credential":return"text-blue-400";case"payload":return"text-green-400";case"post-exploit":return"text-red-400"}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Select Attack Type"}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-white p-2 rounded-lg hover:bg-dark-bg transition-colors",children:e.jsx(G,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search attacks...",value:m,onChange:d=>A(d.target.value),className:"flex-1 px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${x==="all"?"bg-primary text-white":"bg-dark-bg text-gray-400 hover:text-white"}`,children:"All"}),e.jsxs("button",{onClick:()=>c("credential"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${x==="credential"?"bg-blue-500/20 text-blue-400 border border-blue-500/50":"bg-dark-bg text-gray-400 hover:text-white"}`,children:[e.jsx(K,{className:"h-4 w-4"}),"Credentials"]}),e.jsxs("button",{onClick:()=>c("payload"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${x==="payload"?"bg-green-500/20 text-green-400 border border-green-500/50":"bg-dark-bg text-gray-400 hover:text-white"}`,children:[e.jsx(I,{className:"h-4 w-4"}),"Payloads"]}),e.jsxs("button",{onClick:()=>c("post-exploit"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${x==="post-exploit"?"bg-red-500/20 text-red-400 border border-red-500/50":"bg-dark-bg text-gray-400 hover:text-white"}`,children:[e.jsx(W,{className:"h-4 w-4"}),"Post-Exploit"]})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(d=>{const p=d.id==="meterpreter"&&!_;return e.jsxs("button",{onClick:()=>!p&&j(d),disabled:p,className:`p-4 rounded-lg border text-left transition-all ${p?"bg-dark-bg/50 border-dark-border opacity-50 cursor-not-allowed":"bg-dark-bg border-dark-border hover:border-primary hover:shadow-lg hover:shadow-primary/10"}`,children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-dark-surface ${N(d.category)}`,children:d.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-white font-medium truncate",children:d.name}),p&&e.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-400 px-2 py-0.5 rounded",children:"msfvenom required"})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1 line-clamp-2",children:d.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${h(d.difficulty)}`,children:d.difficulty}),e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded ${w(d.risk)}`,children:[d.risk," risk"]})]})]})]}),d.requirements&&d.requirements.length>0&&e.jsx("div",{className:"mt-3 pt-3 border-t border-dark-border",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Requires: ",d.requirements.join(", ")]})})]},d.id)})}),f.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ce,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No attacks match your search"})]})]}),e.jsx("div",{className:"p-4 border-t border-dark-border bg-dark-bg/50",children:e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Select an attack type to configure and execute. All actions are logged for audit purposes."})})]})})},oe=({customerId:g,assetIds:y,engagementId:j,onCustomerChange:_,onAssetChange:x,onEngagementChange:c,onTargetsFromAssets:m,disabled:A=!1})=>{const[f,h]=b.useState(!1),{data:w=[]}=D({queryKey:["crm-customers-list"],queryFn:async()=>(await pe.customers.getAll()).data||[]}),{data:N=[]}=D({queryKey:["customer-assets",g],queryFn:async()=>g?(await Me.getAssets()).data||[]:[],enabled:!!g}),{data:d=[]}=D({queryKey:["customer-engagements",g],queryFn:async()=>g?(await pe.engagements.getByCustomer(g)).data||[]:[],enabled:!!g});b.useEffect(()=>{if(y.length>0&&N.length>0&&m){const R=N.filter(k=>y.includes(k.id)).map(k=>k.ip_address||k.hostname).filter(Boolean);R.length>0&&m(R)}},[y,N,m]);const p=r=>{y.includes(r)?x(y.filter(R=>R!==r)):x([...y,r])},C=()=>{x(N.map(r=>r.id))},a=()=>{x([])},s=y.length,i=N.filter(r=>y.includes(r.id)).map(r=>r.hostname||r.ip_address).slice(0,3).join(", ");return e.jsxs("div",{className:"space-y-4 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(J,{className:"h-5 w-5 text-red-400"}),e.jsx("h4",{className:"text-red-400 font-medium",children:"Authorization Scope (Required)"})]}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"All exploitation campaigns must be tied to a specific customer and their assets. This ensures proper authorization and audit trails."}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 mb-2",children:[e.jsx(Te,{className:"h-4 w-4"}),"Customer"]}),e.jsxs("select",{value:g,onChange:r=>{_(r.target.value),x([]),c==null||c("")},disabled:A,className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Select a customer..."}),w.map(r=>e.jsxs("option",{value:r.id,children:[r.name," ",r.industry?`(${r.industry})`:""]},r.id))]})]}),g&&d.length>0&&c&&e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 mb-2",children:[e.jsx(Re,{className:"h-4 w-4"}),"Engagement (Optional)"]}),e.jsxs("select",{value:j||"",onChange:r=>c(r.target.value),disabled:A,className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white disabled:opacity-50",children:[e.jsx("option",{value:"",children:"No specific engagement"}),d.filter(r=>r.status==="in_progress"||r.status==="planning").map(r=>e.jsxs("option",{value:r.id,children:[r.name," (",r.engagement_type,")"]},r.id))]})]}),g&&e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 mb-2",children:[e.jsx(ye,{className:"h-4 w-4"}),"Target Assets"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>h(!f),disabled:A||N.length===0,className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-left text-white disabled:opacity-50 flex items-center justify-between",children:[e.jsx("span",{className:s===0?"text-gray-500":"",children:s===0?"Select assets...":`${s} asset(s): ${i}${s>3?"...":""}`}),e.jsx(qe,{className:`h-4 w-4 transition-transform ${f?"rotate-180":""}`})]}),f&&e.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-dark-surface border border-dark-border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-dark-border",children:[e.jsx("button",{type:"button",onClick:C,className:"text-xs text-primary hover:underline",children:"Select All"}),e.jsx("button",{type:"button",onClick:a,className:"text-xs text-gray-400 hover:text-white",children:"Clear"})]}),N.length===0?e.jsx("div",{className:"p-3 text-gray-400 text-sm text-center",children:"No assets found for this customer"}):N.map(r=>e.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-dark-bg cursor-pointer border-b border-dark-border last:border-0",children:[e.jsx("input",{type:"checkbox",checked:y.includes(r.id),onChange:()=>p(r.id),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-white text-sm font-medium truncate",children:r.hostname||r.ip_address}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[r.ip_address&&e.jsx("span",{children:r.ip_address}),r.os_family&&e.jsx("span",{children:r.os_family})]})]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${r.status==="active"?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:r.status})]},r.id))]})]}),s>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:N.filter(r=>y.includes(r.id)).map(r=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-dark-bg rounded text-xs text-gray-300",children:[r.ip_address||r.hostname,e.jsx("button",{type:"button",onClick:()=>p(r.id),className:"text-gray-500 hover:text-red-400",children:"Ã—"})]},r.id))})]}),e.jsx("div",{className:`flex items-center gap-2 p-2 rounded ${g&&y.length>0?"bg-green-500/10 text-green-400":"bg-yellow-500/10 text-yellow-400"}`,children:g&&y.length>0?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Authorization scope defined"})]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:g?"Select at least one asset to target":"Select a customer to continue"})]})})]})},Ue=[{value:"smb",label:"SMB (445)",description:"Windows file sharing"},{value:"ldap",label:"LDAP (389/636)",description:"Active Directory"},{value:"rdp",label:"RDP (3389)",description:"Remote Desktop"},{value:"ssh",label:"SSH (22)",description:"Secure Shell"},{value:"http_basic",label:"HTTP Basic",description:"Basic authentication"},{value:"http_ntlm",label:"HTTP NTLM",description:"NTLM over HTTP"},{value:"kerberos",label:"Kerberos (88)",description:"Kerberos auth"},{value:"winrm",label:"WinRM (5985/5986)",description:"Windows Remote Management"}],Oe=["Password1!","Welcome1!","Summer2024!","Winter2024!","Spring2024!","Fall2024!","Company123!","Qwerty123!","Password123","Welcome123","Admin123!","User123!"],ze=({isOpen:g,onClose:y,onSuccess:j,onCampaignCreated:_})=>{const x=ae(),[c,m]=b.useState(1),[A,f]=b.useState(!1),[h,w]=b.useState(""),[N,d]=b.useState([]),[p,C]=b.useState(""),[a,s]=b.useState({name:"",targets:[""],usernames:[""],passwords:[""],protocol:"smb",domain:"",delay_between_attempts_ms:1e3,delay_between_users_ms:5e3,max_attempts_per_user:3,stop_on_success:!1,threads:5}),i=b.useCallback(l=>{s(u=>({...u,targets:l}))},[]),r=B({mutationFn:async()=>(await L.createCampaign({name:a.name||`Password Spray - ${new Date().toLocaleString()}`,attack_type:"password_spray",config:{protocol:a.protocol,domain:a.domain||null,usernames:a.usernames.filter(u=>u.trim()),passwords:a.passwords.filter(u=>u.trim()),delay_between_attempts_ms:a.delay_between_attempts_ms,delay_between_users_ms:a.delay_between_users_ms,max_attempts_per_user:a.max_attempts_per_user,stop_on_success:a.stop_on_success,threads:a.threads},targets:a.targets.filter(u=>u.trim()),customer_id:h,asset_ids:N,engagement_id:p||void 0})).data,onSuccess:async l=>{if(A)try{await L.startCampaign(l.id,!0),T.success("Campaign created and started!")}catch{T.success("Campaign created. Start it manually to begin.")}else T.success("Campaign created. Authorize to start.");x.invalidateQueries({queryKey:["exploitation-campaigns"]}),x.invalidateQueries({queryKey:["exploitation-status"]}),j==null||j(),_==null||_(l.id),y()},onError:l=>{var u,S;T.error(((S=(u=l.response)==null?void 0:u.data)==null?void 0:S.error)||"Failed to create campaign")}}),R=()=>s({...a,targets:[...a.targets,""]}),k=l=>{const u=a.targets.filter((S,E)=>E!==l);s({...a,targets:u.length?u:[""]})},o=(l,u)=>{const S=[...a.targets];S[l]=u,s({...a,targets:S})},F=()=>s({...a,usernames:[...a.usernames,""]}),U=l=>{const u=a.usernames.filter((S,E)=>E!==l);s({...a,usernames:u.length?u:[""]})},ee=(l,u)=>{const S=[...a.usernames];S[l]=u,s({...a,usernames:S})},X=()=>s({...a,passwords:[...a.passwords,""]}),q=l=>{const u=a.passwords.filter((S,E)=>E!==l);s({...a,passwords:u.length?u:[""]})},z=(l,u)=>{const S=[...a.passwords];S[l]=u,s({...a,passwords:S})},H=()=>{s({...a,passwords:Oe})},n=l=>u=>{var me;const S=(me=u.target.files)==null?void 0:me[0];if(!S)return;const E=new FileReader;E.onload=ke=>{var xe;const _e=((xe=ke.target)==null?void 0:xe.result).split(`
`).map(le=>le.trim()).filter(le=>le);s({...a,[l]:_e})},E.readAsText(S)};if(!g)return null;const v=a.targets.filter(l=>l.trim()).length,t=a.usernames.filter(l=>l.trim()).length,P=a.passwords.filter(l=>l.trim()).length,$=v*t*P,se=Math.ceil($*a.delay_between_attempts_ms/1e3/60);return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-blue-400"}),"Password Spray Attack"]}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-white",children:e.jsx(G,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex items-center gap-2 mt-4",children:[{num:1,label:"Scope"},{num:2,label:"Targets"},{num:3,label:"Credentials"},{num:4,label:"Options"}].map(l=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${c>=l.num?"bg-primary text-white":"bg-dark-bg text-gray-400 border border-dark-border"}`,children:l.num}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:l.label})]}),l.num<4&&e.jsx("div",{className:`w-8 h-0.5 mx-1 ${c>l.num?"bg-primary":"bg-dark-border"}`})]},l.num))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[c===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Campaign Name (Optional)"}),e.jsx("input",{type:"text",value:a.name,onChange:l=>s({...a,name:l.target.value}),placeholder:"Password Spray - Domain Admin Hunt",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsx(oe,{customerId:h,assetIds:N,engagementId:p,onCustomerChange:w,onAssetChange:d,onEngagementChange:C,onTargetsFromAssets:i})]}),c===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Targets (Auto-populated from assets)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:n("targets")}),e.jsx(te,{className:"h-4 w-4 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:R,className:"text-xs text-primary hover:underline",children:[e.jsx(Y,{className:"h-4 w-4 inline"})," Add"]})]})]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:a.targets.map((l,u)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:S=>o(u,S.target.value),placeholder:"192.168.1.10 or dc01.domain.local",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),a.targets.length>1&&e.jsx("button",{onClick:()=>k(u),className:"text-red-400 hover:text-red-300 px-2",children:e.jsx(Z,{className:"h-4 w-4"})})]},u))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Protocol"}),e.jsx("select",{value:a.protocol,onChange:l=>s({...a,protocol:l.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:Ue.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Domain (Optional)"}),e.jsx("input",{type:"text",value:a.domain,onChange:l=>s({...a,domain:l.target.value}),placeholder:"CORP or corp.local",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]})]}),c===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Usernames"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:n("usernames")}),e.jsx(te,{className:"h-4 w-4 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:F,className:"text-xs text-primary hover:underline",children:[e.jsx(Y,{className:"h-4 w-4 inline"})," Add"]})]})]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:a.usernames.map((l,u)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:S=>ee(u,S.target.value),placeholder:"administrator",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),a.usernames.length>1&&e.jsx("button",{onClick:()=>U(u),className:"text-red-400 hover:text-red-300 px-2",children:e.jsx(Z,{className:"h-4 w-4"})})]},u))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Passwords"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:H,className:"text-xs text-yellow-400 hover:underline",children:"Load Common"}),e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:n("passwords")}),e.jsx(te,{className:"h-4 w-4 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:X,className:"text-xs text-primary hover:underline",children:[e.jsx(Y,{className:"h-4 w-4 inline"})," Add"]})]})]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:a.passwords.map((l,u)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:S=>z(u,S.target.value),placeholder:"Password123!",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),a.passwords.length>1&&e.jsx("button",{onClick:()=>q(u),className:"text-red-400 hover:text-red-300 px-2",children:e.jsx(Z,{className:"h-4 w-4"})})]},u))})]})]}),c===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4 border border-dark-border",children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-yellow-400"}),"Lockout Protection"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Delay Between Attempts (ms)"}),e.jsx("input",{type:"number",value:a.delay_between_attempts_ms,onChange:l=>s({...a,delay_between_attempts_ms:parseInt(l.target.value)||1e3}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Delay Between Users (ms)"}),e.jsx("input",{type:"number",value:a.delay_between_users_ms,onChange:l=>s({...a,delay_between_users_ms:parseInt(l.target.value)||5e3}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Max Attempts Per User"}),e.jsx("input",{type:"number",value:a.max_attempts_per_user,onChange:l=>s({...a,max_attempts_per_user:parseInt(l.target.value)||3}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Threads"}),e.jsx("input",{type:"number",value:a.threads,onChange:l=>s({...a,threads:parseInt(l.target.value)||5}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"stop-on-success",checked:a.stop_on_success,onChange:l=>s({...a,stop_on_success:l.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary"}),e.jsx("label",{htmlFor:"stop-on-success",className:"text-gray-300 text-sm",children:"Stop on first successful authentication"})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-blue-400 font-medium mb-2 flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"Attack Summary"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Targets:"}),e.jsx("span",{className:"text-white ml-2",children:v})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Usernames:"}),e.jsx("span",{className:"text-white ml-2",children:t})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Passwords:"}),e.jsx("span",{className:"text-white ml-2",children:P})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Total Attempts:"}),e.jsx("span",{className:"text-white ml-2",children:$.toLocaleString()})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-400",children:"Estimated Time:"}),e.jsxs("span",{className:"text-white ml-2",children:["~",se," minutes"]})]})]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",id:"authorized",checked:A,onChange:l=>f(l.target.checked),className:"w-4 h-4 mt-1 rounded border-yellow-500 bg-dark-bg text-yellow-500"}),e.jsxs("label",{htmlFor:"authorized",className:"text-sm",children:[e.jsx("span",{className:"text-yellow-400 font-medium",children:"Authorization Required"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"I am authorized to perform this security test against the specified targets. I understand that unauthorized access attempts are illegal."})]})]})})]})]}),e.jsxs("div",{className:"p-4 border-t border-dark-border flex justify-between",children:[e.jsx(M,{variant:"secondary",onClick:()=>c>1?m(c-1):y(),children:c>1?"Back":"Cancel"}),e.jsx(M,{variant:"primary",onClick:()=>{c<4?m(c+1):r.mutate()},disabled:c===1&&(!h||N.length===0)||c===2&&v===0||c===3&&(t===0||P===0)||c===4&&!A||r.isPending,children:c<4?"Next":r.isPending?"Creating...":"Start Attack"})]})]})})},He=({isOpen:g,onClose:y,onSuccess:j,onCampaignCreated:_,attackType:x})=>{const c=ae(),[m,A]=b.useState(1),[f,h]=b.useState(!1),[w,N]=b.useState(""),[d,p]=b.useState([]),[C,a]=b.useState(""),[s,i]=b.useState({name:"",domain_controller:"",domain:"",username:"",password:"",ntlm_hash:"",use_hash:!1,target_spns:[""],enumerate_spns:!0,usernames:[""],enumerate_users:!1,output_format:"hashcat",request_rc4:!0}),r=B({mutationFn:async()=>{const n=x==="kerberoast"?{domain_controller:s.domain_controller,domain:s.domain,username:s.username,password:s.use_hash?null:s.password,ntlm_hash:s.use_hash?s.ntlm_hash:null,target_spns:s.enumerate_spns?null:s.target_spns.filter(t=>t.trim()),output_format:s.output_format,request_rc4:s.request_rc4}:{domain_controller:s.domain_controller,domain:s.domain,usernames:s.enumerate_users?[]:s.usernames.filter(t=>t.trim()),enumerate_users:s.enumerate_users,output_format:s.output_format};return(await L.createCampaign({name:s.name||`${x==="kerberoast"?"Kerberoast":"AS-REP Roast"} - ${new Date().toLocaleString()}`,attack_type:x,config:n,targets:[s.domain_controller],customer_id:w,asset_ids:d,engagement_id:C||void 0})).data},onSuccess:async n=>{if(f)try{await L.startCampaign(n.id,!0),T.success("Kerberos attack started!")}catch{T.success("Campaign created. Start manually to begin.")}else T.success("Campaign created.");c.invalidateQueries({queryKey:["exploitation-campaigns"]}),c.invalidateQueries({queryKey:["exploitation-status"]}),j==null||j(),_==null||_(n.id),y()},onError:n=>{var v,t;T.error(((t=(v=n.response)==null?void 0:v.data)==null?void 0:t.error)||"Failed to create campaign")}}),R=()=>i({...s,target_spns:[...s.target_spns,""]}),k=n=>{const v=s.target_spns.filter((t,P)=>P!==n);i({...s,target_spns:v.length?v:[""]})},o=(n,v)=>{const t=[...s.target_spns];t[n]=v,i({...s,target_spns:t})},F=()=>i({...s,usernames:[...s.usernames,""]}),U=n=>{const v=s.usernames.filter((t,P)=>P!==n);i({...s,usernames:v.length?v:[""]})},ee=(n,v)=>{const t=[...s.usernames];t[n]=v,i({...s,usernames:t})},X=n=>v=>{var $;const t=($=v.target.files)==null?void 0:$[0];if(!t)return;const P=new FileReader;P.onload=se=>{var S;const u=((S=se.target)==null?void 0:S.result).split(`
`).map(E=>E.trim()).filter(E=>E);i({...s,[n]:u})},P.readAsText(t)};if(!g)return null;const q=x==="kerberoast",z=q?"Kerberoasting Attack":"AS-REP Roasting Attack",H=q?e.jsx(O,{className:"h-5 w-5 text-purple-400"}):e.jsx(ge,{className:"h-5 w-5 text-orange-400"});return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[H,z]}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-white",children:e.jsx(G,{className:"h-5 w-5"})})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:q?"Extract TGS tickets for service accounts to crack offline. Targets accounts with SPNs set.":"Target accounts without Kerberos pre-authentication to extract AS-REP hashes."}),e.jsx("div",{className:"flex items-center gap-2 mt-4",children:[{num:1,label:"Scope"},{num:2,label:"Target"},{num:3,label:"Options"}].map(n=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${m>=n.num?q?"bg-purple-500 text-white":"bg-orange-500 text-white":"bg-dark-bg text-gray-400 border border-dark-border"}`,children:n.num}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:n.label})]}),n.num<3&&e.jsx("div",{className:`w-8 h-0.5 mx-1 ${m>n.num?q?"bg-purple-500":"bg-orange-500":"bg-dark-border"}`})]},n.num))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[m===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Campaign Name (Optional)"}),e.jsx("input",{type:"text",value:s.name,onChange:n=>i({...s,name:n.target.value}),placeholder:`${q?"Kerberoast":"AS-REP Roast"} - SQL Admins`,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsx(oe,{customerId:w,assetIds:d,engagementId:C,onCustomerChange:N,onAssetChange:p,onEngagementChange:a})]}),m===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Domain Controller"}),e.jsx("input",{type:"text",value:s.domain_controller,onChange:n=>i({...s,domain_controller:n.target.value}),placeholder:"dc01.corp.local or 192.168.1.10",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Domain"}),e.jsx("input",{type:"text",value:s.domain,onChange:n=>i({...s,domain:n.target.value}),placeholder:"corp.local",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]}),q&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4 text-yellow-400"}),"Authentication"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Username"}),e.jsx("input",{type:"text",value:s.username,onChange:n=>i({...s,username:n.target.value}),placeholder:"domain_user",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:!s.use_hash,onChange:()=>i({...s,use_hash:!1}),className:"text-primary"}),"Use Password"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:s.use_hash,onChange:()=>i({...s,use_hash:!0}),className:"text-primary"}),"Use NTLM Hash"]})]}),s.use_hash?e.jsx("input",{type:"text",value:s.ntlm_hash,onChange:n=>i({...s,ntlm_hash:n.target.value}),placeholder:"AABBCCDD11223344:EEFFGGHHII556677",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white font-mono text-sm"}):e.jsx("input",{type:"password",value:s.password,onChange:n=>i({...s,password:n.target.value}),placeholder:"Password",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]}),e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Target SPNs"}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("input",{type:"checkbox",id:"enumerate-spns",checked:s.enumerate_spns,onChange:n=>i({...s,enumerate_spns:n.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary"}),e.jsx("label",{htmlFor:"enumerate-spns",className:"text-gray-300 text-sm",children:"Enumerate all SPNs automatically"})]}),!s.enumerate_spns&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Specify target SPNs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:X("target_spns")}),e.jsx(te,{className:"h-3 w-3 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:R,className:"text-xs text-primary hover:underline",children:[e.jsx(Y,{className:"h-3 w-3 inline"})," Add"]})]})]}),s.target_spns.map((n,v)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:n,onChange:t=>o(v,t.target.value),placeholder:"MSSQLSvc/sql01.corp.local:1433",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm font-mono"}),s.target_spns.length>1&&e.jsx("button",{onClick:()=>k(v),className:"text-red-400 px-2",children:e.jsx(Z,{className:"h-4 w-4"})})]},v))]})]})]}),!q&&e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Target Users"}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("input",{type:"checkbox",id:"enumerate-users",checked:s.enumerate_users,onChange:n=>i({...s,enumerate_users:n.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary"}),e.jsx("label",{htmlFor:"enumerate-users",className:"text-gray-300 text-sm",children:"Enumerate users without pre-auth automatically"})]}),!s.enumerate_users&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Specify target usernames"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:X("usernames")}),e.jsx(te,{className:"h-3 w-3 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:F,className:"text-xs text-primary hover:underline",children:[e.jsx(Y,{className:"h-3 w-3 inline"})," Add"]})]})]}),s.usernames.map((n,v)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:n,onChange:t=>ee(v,t.target.value),placeholder:"svc_backup",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),s.usernames.length>1&&e.jsx("button",{onClick:()=>U(v),className:"text-red-400 px-2",children:e.jsx(Z,{className:"h-4 w-4"})})]},v))]})]})]}),m===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4 border border-dark-border",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Output Options"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Hash Format"}),e.jsxs("select",{value:s.output_format,onChange:n=>i({...s,output_format:n.target.value}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"hashcat",children:"Hashcat"}),e.jsx("option",{value:"john",children:"John the Ripper"})]})]}),q&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"request-rc4",checked:s.request_rc4,onChange:n=>i({...s,request_rc4:n.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary mr-3"}),e.jsx("label",{htmlFor:"request-rc4",className:"text-gray-300 text-sm",children:"Request RC4 encryption (easier to crack)"})]})]})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${q?"bg-purple-500/10 border-purple-500/30":"bg-orange-500/10 border-orange-500/30"}`,children:[e.jsxs("h4",{className:`font-medium mb-2 flex items-center gap-2 ${q?"text-purple-400":"text-orange-400"}`,children:[e.jsx(de,{className:"h-4 w-4"}),"Attack Summary"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Domain Controller:"}),e.jsx("span",{className:"text-white ml-2",children:s.domain_controller||"Not set"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Domain:"}),e.jsx("span",{className:"text-white ml-2",children:s.domain||"Not set"})]}),q&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Authentication:"}),e.jsxs("span",{className:"text-white ml-2",children:[s.username," (",s.use_hash?"NTLM Hash":"Password",")"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"SPNs:"}),e.jsx("span",{className:"text-white ml-2",children:s.enumerate_spns?"Auto-enumerate":`${s.target_spns.filter(n=>n.trim()).length} specified`})]})]}),!q&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Users:"}),e.jsx("span",{className:"text-white ml-2",children:s.enumerate_users?"Auto-enumerate":`${s.usernames.filter(n=>n.trim()).length} specified`})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Output Format:"}),e.jsx("span",{className:"text-white ml-2 capitalize",children:s.output_format})]})]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",id:"authorized",checked:f,onChange:n=>h(n.target.checked),className:"w-4 h-4 mt-1 rounded border-yellow-500 bg-dark-bg text-yellow-500"}),e.jsxs("label",{htmlFor:"authorized",className:"text-sm",children:[e.jsx("span",{className:"text-yellow-400 font-medium",children:"Authorization Required"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"I am authorized to perform this Active Directory security test. Extracted hashes will be used for authorized security assessment only."})]})]})})]})]}),e.jsxs("div",{className:"p-4 border-t border-dark-border flex justify-between",children:[e.jsx(M,{variant:"secondary",onClick:()=>m>1?A(m-1):y(),children:m>1?"Back":"Cancel"}),e.jsx(M,{variant:"primary",onClick:()=>{m<3?A(m+1):r.mutate()},disabled:m===1&&(!w||d.length===0)||m===2&&(!s.domain_controller||!s.domain)||m===2&&q&&(!s.username||!s.password&&!s.ntlm_hash)||m===3&&!f||r.isPending,children:m<3?"Next":r.isPending?"Creating...":"Start Attack"})]})]})})},We={credential_dump:{title:"Credential Dump",icon:e.jsx(je,{className:"h-6 w-6 text-red-400"}),description:"Extract credentials from memory, registry, or files on the target system.",modules:[{value:"dump_sam",label:"SAM Database",description:"Extract local account hashes from SAM"},{value:"dump_lsass",label:"LSASS Memory",description:"Dump credentials from LSASS process"},{value:"browser_creds",label:"Browser Credentials",description:"Extract saved passwords from browsers"},{value:"wifi_passwords",label:"WiFi Passwords",description:"Extract saved WiFi passwords"},{value:"keepass",label:"KeePass Databases",description:"Find and extract KeePass databases"}]},priv_esc:{title:"Privilege Escalation",icon:e.jsx(fe,{className:"h-6 w-6 text-yellow-400"}),description:"Check for privilege escalation vectors on the target system.",modules:[{value:"always_install_elevated",label:"AlwaysInstallElevated",description:"Check for AlwaysInstallElevated policy"},{value:"unquoted_paths",label:"Unquoted Service Paths",description:"Find unquoted service paths"},{value:"weak_service_perms",label:"Weak Service Permissions",description:"Check for modifiable services"},{value:"se_impersonate",label:"SeImpersonate",description:"Check for token impersonation privileges"},{value:"sudoers",label:"Sudoers Check",description:"Analyze sudo configuration (Linux)"},{value:"suid_binaries",label:"SUID Binaries",description:"Find SUID/SGID binaries (Linux)"}]},persistence:{title:"Persistence",icon:e.jsx(Ne,{className:"h-6 w-6 text-purple-400"}),description:"Establish persistent access mechanisms on the target system.",modules:[{value:"scheduled_task",label:"Scheduled Task",description:"Create a scheduled task for persistence"},{value:"registry_run",label:"Registry Run Key",description:"Add registry run key for startup"},{value:"service",label:"Windows Service",description:"Create a Windows service"},{value:"cron_job",label:"Cron Job",description:"Add cron job for persistence (Linux)"},{value:"ssh_key",label:"SSH Key",description:"Add SSH authorized key (Linux)"}]},lateral_movement:{title:"Lateral Movement",icon:e.jsx(ve,{className:"h-6 w-6 text-blue-400"}),description:"Move to other systems using various techniques.",modules:[{value:"pass_the_hash",label:"Pass-the-Hash",description:"Authenticate using NTLM hash"},{value:"pass_the_ticket",label:"Pass-the-Ticket",description:"Authenticate using Kerberos ticket"},{value:"psexec",label:"PsExec",description:"Execute commands via PsExec"},{value:"wmi_exec",label:"WMI Exec",description:"Execute commands via WMI"},{value:"ssh_pivot",label:"SSH Pivot",description:"Pivot through SSH connections"}]},smb_relay:{title:"SMB Relay",icon:e.jsx(be,{className:"h-6 w-6 text-orange-400"}),description:"Relay NTLM authentication to other targets for credential theft or command execution.",modules:[{value:"ntlm_relay",label:"NTLM Relay",description:"Relay NTLM auth to target SMB"},{value:"ldap_relay",label:"LDAP Relay",description:"Relay to LDAP for account takeover"},{value:"http_relay",label:"HTTP Relay",description:"Relay to HTTP endpoints"}]}},Ie=({isOpen:g,onClose:y,onSuccess:j,onCampaignCreated:_,attackType:x})=>{var k;const c=ae(),[m,A]=b.useState(!1),f=We[x],[h,w]=b.useState(""),[N,d]=b.useState([]),[p,C]=b.useState(""),[a,s]=b.useState({name:"",target:"",module:((k=f.modules[0])==null?void 0:k.value)||"",username:"",password:"",ntlm_hash:"",use_hash:!1,options:{}}),i=b.useCallback(o=>{o.length>0&&s(F=>({...F,target:o[0]}))},[]),r=B({mutationFn:async()=>(await L.createCampaign({name:a.name||`${f.title} - ${new Date().toLocaleString()}`,attack_type:x,config:{module:a.module,username:a.username||null,password:a.use_hash?null:a.password,ntlm_hash:a.use_hash?a.ntlm_hash:null,options:a.options},targets:[a.target],customer_id:h,asset_ids:N,engagement_id:p||void 0})).data,onSuccess:async o=>{if(m)try{await L.startCampaign(o.id,!0),T.success(`${f.title} campaign started!`)}catch{T.success("Campaign created. Start manually to begin.")}else T.success("Campaign created.");c.invalidateQueries({queryKey:["exploitation-campaigns"]}),c.invalidateQueries({queryKey:["exploitation-status"]}),j==null||j(),_==null||_(o.id),y()},onError:o=>{var F,U;T.error(((U=(F=o.response)==null?void 0:F.data)==null?void 0:U.error)||"Failed to create campaign")}});if(!g)return null;const R=f.modules.find(o=>o.value===a.module);return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-dark-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[f.icon,e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:f.title}),e.jsx("p",{className:"text-gray-400 text-sm",children:f.description})]})]}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-white p-2 rounded-lg hover:bg-dark-bg",children:e.jsx(G,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Campaign Name (optional)"}),e.jsx("input",{type:"text",value:a.name,onChange:o=>s({...a,name:o.target.value}),placeholder:`${f.title} - ${new Date().toLocaleDateString()}`,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary"})]}),e.jsx(oe,{customerId:h,assetIds:N,engagementId:p,onCustomerChange:w,onAssetChange:d,onEngagementChange:C,onTargetsFromAssets:i}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Target ",e.jsx("span",{className:"text-red-400",children:"*"}),e.jsx("span",{className:"text-gray-500 text-xs ml-2",children:"(Auto-populated from selected asset)"})]}),e.jsx("input",{type:"text",value:a.target,onChange:o=>s({...a,target:o.target.value}),placeholder:"192.168.1.100 or hostname",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Module"}),e.jsx("select",{value:a.module,onChange:o=>s({...a,module:o.target.value}),className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-primary",children:f.modules.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))}),R&&e.jsxs("p",{className:"mt-2 text-sm text-gray-400 flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),R.description]})]}),(x==="lateral_movement"||x==="smb_relay")&&e.jsxs("div",{className:"space-y-4 p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h4",{className:"text-white font-medium flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"Credentials"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Username"}),e.jsx("input",{type:"text",value:a.username,onChange:o=>s({...a,username:o.target.value}),placeholder:"DOMAIN\\\\username or username@domain",className:"w-full px-4 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:!a.use_hash,onChange:()=>s({...a,use_hash:!1}),className:"text-primary"}),e.jsx("span",{className:"text-gray-300",children:"Password"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:a.use_hash,onChange:()=>s({...a,use_hash:!0}),className:"text-primary"}),e.jsx("span",{className:"text-gray-300",children:"NTLM Hash"})]})]}),a.use_hash?e.jsx("input",{type:"text",value:a.ntlm_hash,onChange:o=>s({...a,ntlm_hash:o.target.value}),placeholder:"aad3b435b51404eeaad3b435b51404ee:hash",className:"w-full px-4 py-2 bg-dark-surface border border-dark-border rounded-lg text-white font-mono"}):e.jsx("input",{type:"password",value:a.password,onChange:o=>s({...a,password:o.target.value}),placeholder:"Password",className:"w-full px-4 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:[e.jsx(J,{className:"h-5 w-5 text-red-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400 font-medium",children:"Authorization Required"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"This action may modify system configuration, access sensitive data, or execute commands on target systems. Ensure you have explicit written authorization before proceeding."})]})]}),e.jsxs("label",{className:"flex items-start gap-3 p-4 bg-dark-bg border border-dark-border rounded-lg cursor-pointer hover:border-primary transition-colors",children:[e.jsx("input",{type:"checkbox",checked:m,onChange:o=>A(o.target.checked),className:"mt-1 h-4 w-4 text-primary rounded border-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"I am authorized to perform this test"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"I confirm that I have written authorization from the system owner to perform post-exploitation activities on the specified target(s). I understand that unauthorized access is illegal."})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-dark-border flex justify-end gap-3",children:[e.jsx(M,{variant:"secondary",onClick:y,children:"Cancel"}),e.jsx(M,{variant:"primary",onClick:()=>r.mutate(),disabled:!h||N.length===0||!a.target||!m||r.isPending,children:r.isPending?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[f.icon,e.jsx("span",{className:"ml-2",children:"Create & Start Campaign"})]})})]})]})})};function Be({campaignId:g,enabled:y=!0,onProgress:j,onComplete:_,onError:x}){const c=b.useRef(null),[m,A]=b.useState(!1),[f,h]=b.useState([]),[w,N]=b.useState(null),d=b.useRef(0),p=3,C=b.useCallback(()=>{if(!y||!g)return;const i=localStorage.getItem("token");if(!i){x==null||x("No authentication token");return}c.current&&c.current.close();const R=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/api/ws/exploitation/${g}?token=${i}`;console.log("[ExploitationWS] Connecting to:",R),c.current=new WebSocket(R),c.current.onopen=()=>{console.log("[ExploitationWS] Connected to campaign:",g),A(!0),d.current=0},c.current.onmessage=k=>{try{const o=JSON.parse(k.data);console.log("[ExploitationWS] Received:",o.type,o),N(o),h(F=>[...F,o]),j==null||j(o),(o.type==="campaignCompleted"||o.type==="campaign_completed")&&(_==null||_(o)),o.type==="error"&&(x==null||x(o.message||"Unknown error"))}catch(o){console.error("[ExploitationWS] Failed to parse message:",o)}},c.current.onclose=k=>{console.log("[ExploitationWS] Connection closed:",k.code,k.reason),A(!1),k.code!==1e3&&d.current<p&&(d.current++,console.log(`[ExploitationWS] Reconnecting... attempt ${d.current}`),setTimeout(C,2e3*d.current))},c.current.onerror=k=>{console.error("[ExploitationWS] Error:",k),x==null||x("WebSocket connection error")}},[g,y,j,_,x]),a=b.useCallback(()=>{c.current&&(c.current.close(1e3,"User disconnected"),c.current=null),A(!1)},[]),s=b.useCallback(()=>{h([]),N(null)},[]);return b.useEffect(()=>(y&&g&&C(),()=>{a()}),[g,y,C,a]),{connected:m,progress:f,lastMessage:w,connect:C,disconnect:a,clearProgress:s}}const es=()=>{const{tab:g}=Ce(),y=Se(),j=ae(),[_,x]=b.useState("dashboard"),[c,m]=b.useState(!1),[A,f]=b.useState(!1),[h,w]=b.useState(null),[N,d]=b.useState(null);b.useEffect(()=>{if(!g){x("dashboard");return}switch(g){case"password-spray":w({id:"password_spray",name:"Password Spray",description:"Test common passwords against multiple accounts",category:"credential",icon:e.jsx(K,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium"});break;case"kerberos":w({id:"kerberoast",name:"Kerberoasting",description:"Extract TGS tickets for offline cracking",category:"credential",icon:e.jsx(O,{className:"h-6 w-6"}),difficulty:"medium",risk:"low"});break;case"asrep-roast":w({id:"asrep_roast",name:"AS-REP Roasting",description:"Target accounts without Kerberos pre-authentication",category:"credential",icon:e.jsx(K,{className:"h-6 w-6"}),difficulty:"medium",risk:"low"});break;case"smb-relay":w({id:"smb_relay",name:"SMB Relay",description:"Relay NTLM authentication to other targets",category:"credential",icon:e.jsx(O,{className:"h-6 w-6"}),difficulty:"hard",risk:"high"});break;case"shells":x("shells");break;case"credential-dump":w({id:"credential_dump",name:"Credential Dump",description:"Extract credentials from memory, registry, or files",category:"post-exploit",icon:e.jsx(W,{className:"h-6 w-6"}),difficulty:"medium",risk:"high"});break;case"priv-esc":w({id:"priv_esc",name:"Privilege Escalation",description:"Check for privilege escalation vectors",category:"post-exploit",icon:e.jsx(W,{className:"h-6 w-6"}),difficulty:"medium",risk:"medium"});break;case"persistence":w({id:"persistence",name:"Persistence",description:"Establish persistent access mechanisms",category:"post-exploit",icon:e.jsx(W,{className:"h-6 w-6"}),difficulty:"hard",risk:"high"});break;case"lateral-movement":w({id:"lateral_movement",name:"Lateral Movement",description:"Move to other systems using Pass-the-Hash, WMI, PsExec",category:"post-exploit",icon:e.jsx(W,{className:"h-6 w-6"}),difficulty:"hard",risk:"high"});break;case"post-exploit":x("modules");break;case"campaigns":x("campaigns");break;default:x("dashboard")}},[g]);const[p,C]=b.useState({shell_type:"reverse_shell",platform:"linux",format:"bash",lhost:"",lport:4444,encoding:"none",obfuscation_level:0,staged:!1}),[a,s]=b.useState(null),{data:i}=D({queryKey:["exploitation-status"],queryFn:async()=>(await L.getStatus()).data}),{data:r=[]}=D({queryKey:["exploitation-campaigns"],queryFn:async()=>(await L.listCampaigns()).data}),{data:R=[]}=D({queryKey:["shell-templates"],queryFn:async()=>(await L.listShellTemplates()).data}),{data:k=[]}=D({queryKey:["post-exploit-modules"],queryFn:async()=>(await L.listModules()).data}),o=B({mutationFn:async t=>(await L.generateShell(t)).data,onSuccess:t=>{s(t),T.success("Shell payload generated!"),j.invalidateQueries({queryKey:["exploitation-status"]})},onError:t=>{var P,$;T.error((($=(P=t.response)==null?void 0:P.data)==null?void 0:$.message)||"Failed to generate shell")}}),F=B({mutationFn:async t=>{await L.deleteCampaign(t)},onSuccess:()=>{T.success("Campaign deleted"),j.invalidateQueries({queryKey:["exploitation-campaigns"]})}}),U=B({mutationFn:async({id:t,authorized:P})=>{await L.startCampaign(t,P)},onSuccess:()=>{T.success("Campaign started"),j.invalidateQueries({queryKey:["exploitation-campaigns"]}),j.invalidateQueries({queryKey:["exploitation-status"]})},onError:t=>{var P,$;T.error((($=(P=t.response)==null?void 0:P.data)==null?void 0:$.message)||"Failed to start campaign")}}),ee=B({mutationFn:async t=>{await L.stopCampaign(t)},onSuccess:()=>{T.success("Campaign stopped"),j.invalidateQueries({queryKey:["exploitation-campaigns"]}),j.invalidateQueries({queryKey:["exploitation-status"]})}}),X=t=>{if(f(!1),["reverse_shell","bind_shell","web_shell","meterpreter"].includes(t.id)){const P={reverse_shell:"reverse_shell",bind_shell:"bind_shell",web_shell:"web_shell",meterpreter:"reverse_shell"},$={reverse_shell:"bash",bind_shell:"bash",web_shell:"php",meterpreter:"meterpreter_exe"};C({...p,shell_type:P[t.id]||"reverse_shell",format:$[t.id]||"bash"}),m(!0);return}w(t)},q=t=>{w(null),j.invalidateQueries({queryKey:["exploitation-campaigns"]}),j.invalidateQueries({queryKey:["exploitation-status"]}),x("campaigns"),y("/exploitation/campaigns"),T.success("Campaign created successfully!")},z=()=>{w(null),y("/exploitation")},H=t=>{navigator.clipboard.writeText(t),T.success("Copied to clipboard!")},n=t=>{switch(t){case"running":return"text-yellow-400";case"completed":return"text-green-400";case"failed":return"text-red-400";case"cancelled":return"text-gray-400";default:return"text-blue-400"}},v=t=>{switch(t){case"running":return e.jsx(V,{className:"h-4 w-4 animate-pulse"});case"completed":return e.jsx(Q,{className:"h-4 w-4"});case"failed":return e.jsx(J,{className:"h-4 w-4"});case"cancelled":return e.jsx(ue,{className:"h-4 w-4"});default:return e.jsx(Le,{className:"h-4 w-4"})}};return e.jsx(Ee,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(re,{className:"h-7 w-7 text-red-500"}),"Exploitation Framework"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Password spraying, Kerberos attacks, shell generation, and post-exploitation"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(M,{variant:"secondary",onClick:()=>m(!0),children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Generate Shell"]}),e.jsxs(M,{variant:"primary",onClick:()=>f(!0),children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"New Campaign"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Active Campaigns"}),e.jsx(V,{className:"h-5 w-5 text-yellow-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(i==null?void 0:i.active_campaigns)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Total Campaigns"}),e.jsx(re,{className:"h-5 w-5 text-blue-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(i==null?void 0:i.total_campaigns)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Credentials Found"}),e.jsx(K,{className:"h-5 w-5 text-green-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(i==null?void 0:i.credentials_stored)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Payloads Generated"}),e.jsx(I,{className:"h-5 w-5 text-purple-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(i==null?void 0:i.payloads_generated)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Msfvenom"}),i!=null&&i.msfvenom_available?e.jsx(Q,{className:"h-5 w-5 text-green-400"}):e.jsx(J,{className:"h-5 w-5 text-yellow-400"})]}),e.jsx("p",{className:"text-sm font-medium text-white mt-2",children:i!=null&&i.msfvenom_available?"Available":"Not Found"})]})]}),e.jsx("div",{className:"border-b border-dark-border",children:e.jsx("nav",{className:"flex gap-4",children:["dashboard","campaigns","shells","modules"].map(t=>e.jsx("button",{onClick:()=>x(t),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${_===t?"border-primary text-primary":"border-transparent text-gray-400 hover:text-white"}`,children:t.charAt(0).toUpperCase()+t.slice(1)},t))})}),_==="dashboard"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Recent Campaigns"}),r.length===0?e.jsx("p",{className:"text-gray-400 text-sm",children:"No campaigns yet"}):e.jsx("div",{className:"space-y-3",children:r.slice(0,5).map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-bg rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:t.attack_type})]}),e.jsxs("div",{className:`flex items-center gap-2 ${n(t.status)}`,children:[v(t.status),e.jsx("span",{className:"text-sm capitalize",children:t.status})]})]},t.id))})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>w({id:"password_spray",name:"Password Spray",description:"Test common passwords against multiple accounts",category:"credential",icon:e.jsx(K,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium"}),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(K,{className:"h-6 w-6 text-blue-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Password Spray"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Credential testing"})]}),e.jsxs("button",{onClick:()=>w({id:"kerberoast",name:"Kerberoasting",description:"Extract TGS tickets for offline cracking",category:"credential",icon:e.jsx(O,{className:"h-6 w-6"}),difficulty:"medium",risk:"low"}),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(O,{className:"h-6 w-6 text-purple-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Kerberoast"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Extract TGS tickets"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(I,{className:"h-6 w-6 text-green-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Shell Generator"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Create payloads"})]}),e.jsxs("button",{onClick:()=>x("modules"),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(W,{className:"h-6 w-6 text-red-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Post-Exploit"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Modules & tools"})]})]})]})]}),_==="campaigns"&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg",children:[e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Campaigns"})}),r.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(re,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No campaigns yet"}),e.jsx(M,{variant:"primary",className:"mt-4",onClick:()=>f(!0),children:"Create First Campaign"})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-400 text-sm border-b border-dark-border",children:[e.jsx("th",{className:"p-4",children:"Name"}),e.jsx("th",{className:"p-4",children:"Type"}),e.jsx("th",{className:"p-4",children:"Status"}),e.jsx("th",{className:"p-4",children:"Targets"}),e.jsx("th",{className:"p-4",children:"Results"}),e.jsx("th",{className:"p-4",children:"Created"}),e.jsx("th",{className:"p-4",children:"Actions"})]})}),e.jsx("tbody",{children:r.map(t=>e.jsxs("tr",{className:"border-b border-dark-border hover:bg-dark-bg",children:[e.jsx("td",{className:"p-4 text-white font-medium",children:t.name}),e.jsx("td",{className:"p-4 text-gray-300",children:t.attack_type}),e.jsx("td",{className:"p-4",children:e.jsxs("span",{className:`flex items-center gap-2 ${n(t.status)}`,children:[v(t.status),e.jsx("span",{className:"capitalize",children:t.status})]})}),e.jsx("td",{className:"p-4 text-gray-300",children:t.targets.length}),e.jsxs("td",{className:"p-4",children:[e.jsx("span",{className:"text-green-400",children:t.successful_count}),e.jsxs("span",{className:"text-gray-500",children:[" / ",t.results_count]})]}),e.jsx("td",{className:"p-4 text-gray-400 text-sm",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.status==="pending"&&e.jsx("button",{onClick:()=>U.mutate({id:t.id,authorized:!0}),className:"text-green-400 hover:text-green-300 p-2",title:"Start Campaign",children:e.jsx(we,{className:"h-4 w-4"})}),t.status==="running"&&e.jsx("button",{onClick:()=>ee.mutate(t.id),className:"text-yellow-400 hover:text-yellow-300 p-2",title:"Stop Campaign",children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>d(t.id),className:"text-blue-400 hover:text-blue-300 p-2",title:"View Results",children:e.jsx(ce,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>F.mutate(t.id),className:"text-red-400 hover:text-red-300 p-2",title:"Delete Campaign",children:e.jsx(Z,{className:"h-4 w-4"})})]})})]},t.id))})]})]}),_==="shells"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Shell Templates"}),e.jsx("div",{className:"space-y-3",children:R.map((t,P)=>e.jsx("div",{className:"p-3 bg-dark-bg rounded-lg border border-dark-border hover:border-primary cursor-pointer transition-colors",onClick:()=>{C({...p,format:t.format.toLowerCase(),platform:t.platform.toLowerCase()}),m(!0)},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:t.description})]}),t.requires_msfvenom&&e.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-400 px-2 py-1 rounded",children:"msfvenom"})]})},P))})]}),a&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Generated Payload"}),e.jsx("button",{onClick:()=>s(null),className:"text-gray-400 hover:text-white",children:e.jsx(G,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Payload"}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-dark-bg p-3 rounded-lg text-green-400 text-sm overflow-x-auto max-h-48",children:a.payload}),e.jsx("button",{onClick:()=>H(a.payload),className:"absolute top-2 right-2 text-gray-400 hover:text-white",children:e.jsx(ne,{className:"h-4 w-4"})})]})]}),a.one_liner&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"One-Liner"}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-dark-bg p-3 rounded-lg text-blue-400 text-sm overflow-x-auto",children:a.one_liner}),e.jsx("button",{onClick:()=>H(a.one_liner),className:"absolute top-2 right-2 text-gray-400 hover:text-white",children:e.jsx(ne,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Listener Command"}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-dark-bg p-3 rounded-lg text-yellow-400 text-sm",children:a.listener_command}),e.jsx("button",{onClick:()=>H(a.listener_command),className:"absolute top-2 right-2 text-gray-400 hover:text-white",children:e.jsx(ne,{className:"h-4 w-4"})})]})]})]})]})]}),_==="modules"&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Post-Exploitation Modules"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map((t,P)=>{const se={credential_harvesting:"credential_dump",privilege_escalation:"priv_esc",persistence:"persistence",lateral_movement:"lateral_movement"}[t.category]||"credential_dump";return e.jsxs("div",{onClick:()=>w({id:se,name:t.name,description:t.description,category:"post-exploit",icon:e.jsx(W,{className:"h-6 w-6"}),difficulty:"medium",risk:"high"}),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary cursor-pointer transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.name}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:t.description})]})}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-1 rounded",children:t.category}),t.platforms.map(l=>e.jsx("span",{className:"text-xs bg-gray-500/20 text-gray-400 px-2 py-1 rounded",children:l},l))]})]},P)})})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5 text-green-400"}),"Shell Generator"]}),e.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-white",children:e.jsx(G,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Shell Type"}),e.jsxs("select",{value:p.shell_type,onChange:t=>C({...p,shell_type:t.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"reverse_shell",children:"Reverse Shell"}),e.jsx("option",{value:"bind_shell",children:"Bind Shell"}),e.jsx("option",{value:"web_shell",children:"Web Shell"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Platform"}),e.jsxs("select",{value:p.platform,onChange:t=>C({...p,platform:t.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"linux",children:"Linux"}),e.jsx("option",{value:"windows",children:"Windows"}),e.jsx("option",{value:"macos",children:"macOS"}),e.jsx("option",{value:"universal",children:"Universal"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Format"}),e.jsxs("select",{value:p.format,onChange:t=>C({...p,format:t.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"bash",children:"Bash"}),e.jsx("option",{value:"powershell",children:"PowerShell"}),e.jsx("option",{value:"python",children:"Python"}),e.jsx("option",{value:"perl",children:"Perl"}),e.jsx("option",{value:"php",children:"PHP"}),e.jsx("option",{value:"meterpreter_exe",children:"Meterpreter EXE"}),e.jsx("option",{value:"meterpreter_elf",children:"Meterpreter ELF"}),e.jsx("option",{value:"meterpreter_powershell",children:"Meterpreter PowerShell"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"LHOST"}),e.jsx("input",{type:"text",value:p.lhost,onChange:t=>C({...p,lhost:t.target.value}),placeholder:"192.168.1.100",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"LPORT"}),e.jsx("input",{type:"number",value:p.lport,onChange:t=>C({...p,lport:parseInt(t.target.value)||4444}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Encoding"}),e.jsxs("select",{value:p.encoding,onChange:t=>C({...p,encoding:t.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"none",children:"None"}),e.jsx("option",{value:"base64",children:"Base64"}),e.jsx("option",{value:"hex",children:"Hex"}),e.jsx("option",{value:"xor",children:"XOR"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Obfuscation"}),e.jsxs("select",{value:p.obfuscation_level,onChange:t=>C({...p,obfuscation_level:parseInt(t.target.value)}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:0,children:"None"}),e.jsx("option",{value:1,children:"Light"}),e.jsx("option",{value:2,children:"Medium"}),e.jsx("option",{value:3,children:"Heavy"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-dark-border",children:[e.jsx(M,{variant:"secondary",onClick:()=>m(!1),children:"Cancel"}),e.jsxs(M,{variant:"primary",onClick:()=>{o.mutate(p),m(!1)},disabled:!p.lhost||o.isPending,children:[o.isPending?e.jsx(ie,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(I,{className:"h-4 w-4 mr-2"}),"Generate"]})]})]})]})}),e.jsx(De,{isOpen:A,onClose:()=>f(!1),onSelect:X,msfvenomAvailable:(i==null?void 0:i.msfvenom_available)??!1}),(h==null?void 0:h.id)==="password_spray"&&e.jsx(ze,{isOpen:!0,onClose:z,onCampaignCreated:q}),((h==null?void 0:h.id)==="kerberoast"||(h==null?void 0:h.id)==="asrep_roast")&&e.jsx(He,{isOpen:!0,onClose:z,onCampaignCreated:q,attackType:h.id}),((h==null?void 0:h.id)==="credential_dump"||(h==null?void 0:h.id)==="priv_esc"||(h==null?void 0:h.id)==="persistence"||(h==null?void 0:h.id)==="lateral_movement"||(h==null?void 0:h.id)==="smb_relay")&&e.jsx(Ie,{isOpen:!0,onClose:z,onCampaignCreated:q,attackType:h.id}),N&&e.jsx(Qe,{campaignId:N,onClose:()=>d(null)})]})})},Qe=({campaignId:g,onClose:y})=>{const j=ae(),[_,x]=b.useState(!0),{data:c}=D({queryKey:["campaign-detail",g],queryFn:async()=>(await L.getCampaign(g)).data}),m=(c==null?void 0:c.status)==="running",{data:A=[],isLoading:f,refetch:h}=D({queryKey:["campaign-results",g],queryFn:async()=>(await L.getCampaignResults(g)).data,refetchInterval:m?5e3:!1}),{connected:w,progress:N,lastMessage:d}=Be({campaignId:g,enabled:m,onComplete:()=>{h(),j.invalidateQueries({queryKey:["exploitation-campaigns"]}),j.invalidateQueries({queryKey:["exploitation-status"]}),T.success("Campaign completed!")},onError:s=>{T.error(`Campaign error: ${s}`)}}),p=async s=>{try{const i=await L.exportResults(g,s),r=new Blob([i.data],{type:s==="json"?"application/json":"text/csv"}),R=URL.createObjectURL(r),k=document.createElement("a");k.href=R,k.download=`campaign-${g}.${s}`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(R),T.success(`Results exported as ${s.toUpperCase()}`)}catch{T.error("Failed to export results")}},C=s=>{switch(s){case"campaignStarted":case"campaign_started":return e.jsx(we,{className:"h-4 w-4 text-blue-400"});case"targetStarted":case"target_started":return e.jsx(re,{className:"h-4 w-4 text-yellow-400"});case"attemptMade":case"attempt_made":return e.jsx(V,{className:"h-4 w-4 text-gray-400"});case"credentialFound":case"credential_found":return e.jsx(Q,{className:"h-4 w-4 text-green-400"});case"hashExtracted":case"hash_extracted":return e.jsx(K,{className:"h-4 w-4 text-purple-400"});case"campaignProgress":case"campaign_progress":return e.jsx(ie,{className:"h-4 w-4 text-blue-400 animate-spin"});case"campaignCompleted":case"campaign_completed":return e.jsx(Q,{className:"h-4 w-4 text-green-400"});case"error":return e.jsx(J,{className:"h-4 w-4 text-red-400"});default:return e.jsx(V,{className:"h-4 w-4 text-gray-400"})}},a=s=>{switch(s.type){case"campaignStarted":case"campaign_started":return`Campaign started with ${s.total_targets} target(s)`;case"targetStarted":case"target_started":return`Scanning target ${s.index}/${s.total}: ${s.target}`;case"attemptMade":case"attempt_made":return s.success?`SUCCESS: ${s.username} @ ${s.target}`:`Attempt: ${s.username} @ ${s.target}`;case"credentialFound":case"credential_found":return`Credential found: ${s.username} @ ${s.target} (${s.credential_type})`;case"hashExtracted":case"hash_extracted":return`Hash extracted: ${s.username} (${s.hash_type})`;case"campaignProgress":case"campaign_progress":return`${s.progress_percent}% - ${s.message}`;case"campaignCompleted":case"campaign_completed":return`Completed: ${s.successful}/${s.total_results} successful (${s.duration_ms}ms)`;case"error":return s.message||"Unknown error";default:return JSON.stringify(s)}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-4xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Campaign Results"}),m&&e.jsxs("span",{className:"flex items-center gap-2 text-sm text-yellow-400 bg-yellow-400/10 px-3 py-1 rounded-full",children:[e.jsx(V,{className:"h-4 w-4 animate-pulse"}),"Running",w&&e.jsx("span",{className:"text-xs text-green-400",children:"(Live)"})]}),(c==null?void 0:c.status)==="completed"&&e.jsxs("span",{className:"flex items-center gap-2 text-sm text-green-400 bg-green-400/10 px-3 py-1 rounded-full",children:[e.jsx(Q,{className:"h-4 w-4"}),"Completed"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(M,{variant:"secondary",onClick:()=>p("json"),children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"JSON"]}),e.jsxs(M,{variant:"secondary",onClick:()=>p("csv"),children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),"CSV"]}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-white",children:e.jsx(G,{className:"h-6 w-6"})})]})]}),m&&(d==null?void 0:d.progress_percent)!==void 0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[d.progress_percent,"%"]})]}),e.jsx("div",{className:"h-2 bg-dark-bg rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-300",style:{width:`${d.progress_percent}%`}})})]})]}),e.jsxs("div",{className:"flex-1 overflow-hidden flex",children:[m&&_&&N.length>0&&e.jsxs("div",{className:"w-80 border-r border-dark-border overflow-y-auto p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-400",children:"Live Progress"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[N.length," events"]})]}),e.jsx("div",{className:"space-y-2",children:N.slice(-50).reverse().map((s,i)=>e.jsxs("div",{className:`p-2 rounded text-xs flex items-start gap-2 ${s.success===!0?"bg-green-500/10 border border-green-500/30":s.type==="error"?"bg-red-500/10 border border-red-500/30":"bg-dark-bg"}`,children:[C(s.type),e.jsx("span",{className:"text-gray-300 break-all",children:a(s)})]},i))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:f?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ie,{className:"h-8 w-8 text-primary animate-spin"})}):A.length===0&&!m?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ce,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No results yet"})]}):A.length===0&&m?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(V,{className:"h-12 w-12 text-yellow-400 mx-auto mb-4 animate-pulse"}),e.jsx("p",{className:"text-gray-400",children:"Waiting for results..."}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Results will appear as they are found"})]}):e.jsx("div",{className:"space-y-4",children:A.map(s=>{var i,r,R,k,o,F;return e.jsxs("div",{className:`p-4 rounded-lg border ${(i=s.result_type)!=null&&i.includes("success")||(r=s.result_type)!=null&&r.includes("found")||(R=s.result_type)!=null&&R.includes("extracted")?"bg-green-500/10 border-green-500/30":"bg-dark-bg border-dark-border"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[(k=s.result_type)!=null&&k.includes("success")||(o=s.result_type)!=null&&o.includes("found")||(F=s.result_type)!=null&&F.includes("extracted")?e.jsx(Q,{className:"h-5 w-5 text-green-400"}):e.jsx(J,{className:"h-5 w-5 text-gray-400"}),e.jsx("span",{className:"text-white font-medium",children:s.target})]}),e.jsx("span",{className:"text-sm text-gray-400",children:new Date(s.created_at).toLocaleString()})]}),s.result_type&&e.jsx("span",{className:"inline-block text-xs bg-primary/20 text-primary px-2 py-1 rounded mb-2",children:s.result_type.replace(/_/g," ")}),s.severity&&e.jsx("span",{className:`inline-block text-xs px-2 py-1 rounded mb-2 ml-2 ${s.severity==="critical"?"bg-red-500/20 text-red-400":s.severity==="high"?"bg-orange-500/20 text-orange-400":"bg-gray-500/20 text-gray-400"}`,children:s.severity}),s.data&&e.jsx("pre",{className:"mt-2 p-3 bg-dark-bg rounded text-sm text-gray-300 overflow-x-auto",children:typeof s.data=="string"?s.data:JSON.stringify(s.data,null,2)})]},s.id)})})})]})]})})};export{es as default};
