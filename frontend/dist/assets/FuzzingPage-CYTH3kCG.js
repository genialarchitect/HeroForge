import{b as W,u as N,d as v,j as e}from"./vendor-state-DdX3IZQk.js";import{r as i}from"./vendor-react-Da1CiaFS.js";import{B as g,Z as _,aS as Z,P as M,T as z,A as L,D as C,aE as J,L as k,bh as X,aa as V,aR as Y,aH as D,m as ee,aC as se,aO as te,a4 as I,J as ae,v as re,G as le,N as ne}from"./vendor-ui-CMpNZlkF.js";import{ak as p,d as ie}from"./index-ehpIhJkX.js";import"./vendor-charts-Blu-kkrH.js";const w=({title:s,value:m,icon:l,color:d})=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:s}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:m})]}),e.jsx("div",{className:`p-3 rounded-lg ${d}`,children:l})]})}),U=s=>{switch(s){case"protocol":return e.jsx(ne,{className:"w-5 h-5"});case"http":return e.jsx(le,{className:"w-5 h-5"});case"file":return e.jsx(I,{className:"w-5 h-5"});case"api":return e.jsx(re,{className:"w-5 h-5"});case"binary":return e.jsx(ae,{className:"w-5 h-5"});default:return e.jsx(z,{className:"w-5 h-5"})}},E=s=>{switch(s){case"running":return"bg-green-500/20 text-green-400";case"completed":return"bg-blue-500/20 text-blue-400";case"failed":return"bg-red-500/20 text-red-400";case"paused":return"bg-yellow-500/20 text-yellow-400";default:return"bg-gray-500/20 text-gray-400"}},ce=s=>{switch(s){case"high":return"bg-red-500/20 text-red-400";case"medium":return"bg-orange-500/20 text-orange-400";case"low":return"bg-yellow-500/20 text-yellow-400";default:return"bg-gray-500/20 text-gray-400"}},oe=s=>{switch(s){case"heap_overflow":case"stack_overflow":case"use_after_free":case"double_free":return"bg-red-500/20 text-red-400";case"segfault":case"null_deref":return"bg-orange-500/20 text-orange-400";case"assertion":case"timeout":return"bg-yellow-500/20 text-yellow-400";default:return"bg-gray-500/20 text-gray-400"}},de=({campaign:s,onSelect:m,onStart:l,onStop:d,onDelete:x})=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50 cursor-pointer transition-colors",onClick:m,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-cyan-500",children:U(s.target_type)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.name}),e.jsxs("p",{className:"text-gray-500 text-xs",children:[s.target_type," / ",s.fuzzer_type]})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${E(s.status)}`,children:s.status})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.iterations.toLocaleString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(C,{className:"w-4 h-4 text-red-400"}),e.jsx("span",{className:"text-red-400 font-medium",children:s.crashes_found}),e.jsxs("span",{className:"text-gray-500",children:["(",s.unique_crashes," unique)"]})]})}),e.jsx("td",{className:"px-4 py-3",children:s.coverage_percent!==null?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-24 bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-cyan-500 h-2 rounded-full",style:{width:`${s.coverage_percent}%`}})}),e.jsxs("span",{className:"text-gray-300 text-sm",children:[s.coverage_percent.toFixed(1),"%"]})]}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[s.status==="running"?e.jsx("button",{onClick:c=>{c.stopPropagation(),d()},className:"p-1.5 text-yellow-400 hover:bg-yellow-500/20 rounded transition-colors",title:"Pause Campaign",children:e.jsx(X,{className:"w-4 h-4"})}):s.status!=="completed"&&e.jsx("button",{onClick:c=>{c.stopPropagation(),l()},className:"p-1.5 text-green-400 hover:bg-green-500/20 rounded transition-colors",title:"Start Campaign",children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx("button",{onClick:c=>{c.stopPropagation(),x()},className:"p-1.5 text-gray-400 hover:text-red-400 transition-colors",title:"Delete Campaign",children:e.jsx(Y,{className:"w-4 h-4"})})]})})]}),xe=({onClose:s,onSubmit:m,isLoading:l})=>{const[d,x]=i.useState(""),[c,n]=i.useState(""),[o,h]=i.useState("http"),[y,b]=i.useState("mutation"),[t,u]=i.useState(""),[a,f]=i.useState(""),[S,A]=i.useState(""),[F,K]=i.useState("tcp"),[T,Q]=i.useState(""),[q,R]=i.useState(""),[P,B]=i.useState("10000"),[$,H]=i.useState("5000"),G=r=>{r.preventDefault();const j={};o==="http"?j.url=t:o==="protocol"?(j.host=a,j.port=parseInt(S),j.protocol=F):o==="file"&&(j.file_path=T,j.command=q);const O={max_iterations:parseInt(P),timeout_ms:parseInt($),mutation_strategies:["bit_flip","byte_flip","havoc"]};m({name:d,description:c||void 0,target_type:o,fuzzer_type:y,target_config:j,fuzzer_config:O})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center",children:[e.jsx(M,{className:"w-6 h-6 mr-2 text-cyan-500"}),"Create Fuzzing Campaign"]}),e.jsx("button",{onClick:s,className:"p-2 text-gray-400 hover:text-white",children:e.jsx(D,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:G,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Campaign Name"}),e.jsx("input",{type:"text",value:d,onChange:r=>x(r.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white focus:border-cyan-500 focus:outline-none",placeholder:"My Fuzzing Campaign",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Description (optional)"}),e.jsx("textarea",{value:c,onChange:r=>n(r.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white focus:border-cyan-500 focus:outline-none",placeholder:"Describe the fuzzing campaign...",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Target Type"}),e.jsxs("select",{value:o,onChange:r=>h(r.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white focus:border-cyan-500 focus:outline-none",children:[e.jsx("option",{value:"http",children:"HTTP/HTTPS"}),e.jsx("option",{value:"protocol",children:"Network Protocol"}),e.jsx("option",{value:"file",children:"File Format"}),e.jsx("option",{value:"api",children:"API"}),e.jsx("option",{value:"binary",children:"Binary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Fuzzer Type"}),e.jsxs("select",{value:y,onChange:r=>b(r.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white focus:border-cyan-500 focus:outline-none",children:[e.jsx("option",{value:"mutation",children:"Mutation-based"}),e.jsx("option",{value:"generation",children:"Generation-based"}),e.jsx("option",{value:"grammar",children:"Grammar-based"}),e.jsx("option",{value:"template",children:"Template-based"})]})]})]}),o==="http"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Target URL"}),e.jsx("input",{type:"url",value:t,onChange:r=>u(r.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white focus:border-cyan-500 focus:outline-none",placeholder:"https://example.com/api/endpoint",required:!0})]}),o==="protocol"&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Host"}),e.jsx("input",{type:"text",value:a,onChange:r=>f(r.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white focus:border-cyan-500 focus:outline-none",placeholder:"192.168.1.1",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Port"}),e.jsx("input",{type:"number",value:S,onChange:r=>A(r.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white focus:border-cyan-500 focus:outline-none",placeholder:"8080",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Protocol"}),e.jsxs("select",{value:F,onChange:r=>K(r.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white focus:border-cyan-500 focus:outline-none",children:[e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"})]})]})]}),o==="file"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"File Path"}),e.jsx("input",{type:"text",value:T,onChange:r=>Q(r.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white focus:border-cyan-500 focus:outline-none",placeholder:"/path/to/input/file",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Command to Execute"}),e.jsx("input",{type:"text",value:q,onChange:r=>R(r.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white focus:border-cyan-500 focus:outline-none",placeholder:"/usr/bin/myapp @@",required:!0}),e.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"Use @@ as placeholder for input file"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Max Iterations"}),e.jsx("input",{type:"number",value:P,onChange:r=>B(r.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white focus:border-cyan-500 focus:outline-none",min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Timeout (ms)"}),e.jsx("input",{type:"number",value:$,onChange:r=>H(r.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white focus:border-cyan-500 focus:outline-none",min:"100"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors disabled:opacity-50 flex items-center",children:[l&&e.jsx(k,{className:"w-4 h-4 mr-2 animate-spin"}),"Create Campaign"]})]})]})]})})},me=({campaign:s,onClose:m})=>{var y,b;const[l,d]=i.useState("overview"),{data:x,isLoading:c}=N({queryKey:["fuzzing-crashes",s.id],queryFn:()=>p.listCrashes(s.id,{limit:50}).then(t=>t.data),enabled:l==="crashes"}),{data:n}=N({queryKey:["fuzzing-coverage",s.id],queryFn:()=>p.getCoverage(s.id).then(t=>t.data),enabled:l==="coverage"}),{data:o}=N({queryKey:["fuzzing-seeds",s.id],queryFn:()=>p.listSeeds(s.id).then(t=>t.data),enabled:l==="seeds"}),h=(t,u)=>{navigator.clipboard.writeText(t),g.success(`${u} copied to clipboard`)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-cyan-500",children:U(s.target_type)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:s.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[s.target_type," / ",s.fuzzer_type]})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${E(s.status)}`,children:s.status})]}),e.jsx("button",{onClick:m,className:"p-2 text-gray-400 hover:text-white",children:e.jsx(D,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"flex border-b border-gray-700",children:["overview","crashes","coverage","seeds"].map(t=>e.jsxs("button",{onClick:()=>d(t),className:`px-4 py-3 text-sm font-medium transition-colors ${l===t?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:[t.charAt(0).toUpperCase()+t.slice(1),t==="crashes"&&s.crashes_found>0&&e.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-red-500/20 text-red-400 rounded text-xs",children:s.crashes_found})]},t))}),e.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[l==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[e.jsx(ee,{className:"w-5 h-5 mr-2 text-cyan-500"}),"Campaign Statistics"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Iterations"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:s.iterations.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Crashes Found"}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:s.crashes_found})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Unique Crashes"}),e.jsx("p",{className:"text-2xl font-bold text-orange-400",children:s.unique_crashes})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Coverage"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:s.coverage_percent!==null?`${s.coverage_percent.toFixed(1)}%`:"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[e.jsx(z,{className:"w-5 h-5 mr-2 text-cyan-500"}),"Target Configuration"]}),e.jsxs("div",{className:"space-y-2",children:[s.target_config.url&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"URL:"}),e.jsx("span",{className:"text-white font-mono text-sm",children:s.target_config.url})]}),s.target_config.host&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Host:"}),e.jsxs("span",{className:"text-white font-mono",children:[s.target_config.host,":",s.target_config.port]})]}),s.target_config.protocol&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Protocol:"}),e.jsx("span",{className:"text-white",children:s.target_config.protocol.toUpperCase()})]}),s.target_config.file_path&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"File:"}),e.jsx("span",{className:"text-white font-mono text-sm",children:s.target_config.file_path})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 lg:col-span-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[e.jsx(_,{className:"w-5 h-5 mr-2 text-cyan-500"}),"Fuzzer Configuration"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Max Iterations"}),e.jsx("p",{className:"text-white",children:((y=s.fuzzer_config.max_iterations)==null?void 0:y.toLocaleString())||"Unlimited"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Timeout"}),e.jsxs("p",{className:"text-white",children:[s.fuzzer_config.timeout_ms||5e3,"ms"]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Mutation Strategies"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(b=s.fuzzer_config.mutation_strategies)==null?void 0:b.map((t,u)=>e.jsx("span",{className:"px-2 py-0.5 bg-cyan-500/20 text-cyan-400 rounded text-xs",children:t.replace("_"," ")},u))})]})]})]})]}),l==="crashes"&&e.jsx("div",{children:c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(k,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):x&&x.length>0?e.jsx("div",{className:"space-y-4",children:x.map(t=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(C,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${oe(t.crash_type)}`,children:t.crash_type.replace("_"," ")}),e.jsxs("span",{className:`px-2 py-1 rounded text-xs ${ce(t.exploitability)}`,children:[t.exploitability," exploitability"]}),t.is_unique&&e.jsx("span",{className:"px-2 py-1 bg-purple-500/20 text-purple-400 rounded text-xs",children:"Unique"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>h(t.crash_hash,"Crash hash"),className:"p-1.5 text-gray-400 hover:text-white transition-colors",title:"Copy hash",children:e.jsx(se,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{const u=new Blob([atob(t.input_data)],{type:"application/octet-stream"}),a=URL.createObjectURL(u),f=document.createElement("a");f.href=a,f.download=`crash_${t.crash_hash.substring(0,8)}.bin`,f.click()},className:"p-1.5 text-gray-400 hover:text-white transition-colors",title:"Download input",children:e.jsx(te,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"text-gray-500 text-xs font-mono mb-2",children:["Hash: ",t.crash_hash.substring(0,32),"... | Iteration: ",t.iteration]}),t.stack_trace&&e.jsxs("div",{className:"bg-gray-900 rounded p-2 mt-2",children:[e.jsx("p",{className:"text-gray-400 text-xs mb-1",children:"Stack Trace:"}),e.jsx("pre",{className:"text-gray-300 text-xs font-mono whitespace-pre-wrap overflow-x-auto",children:t.stack_trace.split(`
`).slice(0,5).join(`
`)})]})]},t.id))}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(C,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No crashes found yet"})]})}),l==="coverage"&&e.jsx("div",{children:n?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Coverage Overview"}),e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsxs("div",{className:"relative w-32 h-32",children:[e.jsxs("svg",{className:"transform -rotate-90 w-32 h-32",children:[e.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"currentColor",strokeWidth:"12",fill:"none",className:"text-gray-700"}),e.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"currentColor",strokeWidth:"12",fill:"none",strokeDasharray:`${n.coverage_percent*3.51} 351`,className:"text-cyan-500"})]}),e.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-2xl font-bold text-white",children:[n.coverage_percent.toFixed(1),"%"]})]})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Coverage Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-400",children:"Edge Coverage"}),e.jsxs("span",{className:"text-white",children:[n.edge_coverage," / ",n.total_edges]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-cyan-500 h-2 rounded-full",style:{width:`${n.edge_coverage/n.total_edges*100}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-400",children:"Block Coverage"}),e.jsxs("span",{className:"text-white",children:[n.block_coverage," / ",n.total_blocks]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:`${n.block_coverage/n.total_blocks*100}%`}})})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-700",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"New Edges Found"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:n.new_edges_found})]})]})]})]}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(L,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No coverage data available"})]})}),l==="seeds"&&e.jsx("div",{children:o&&o.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(t=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.source==="crash"?"bg-red-500/20 text-red-400":t.source==="corpus"?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:t.source}),t.coverage_contribution!==null&&e.jsxs("span",{className:"text-cyan-400 text-sm",children:["+",t.coverage_contribution.toFixed(2),"% coverage"]})]}),e.jsxs("div",{className:"bg-gray-900 rounded p-2 font-mono text-xs text-gray-300 break-all",children:[t.data.substring(0,64),"..."]})]},t.id))}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(I,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No seeds in corpus"})]})})]})]})})},je=()=>{const s=W(),[m,l]=i.useState(!1),[d,x]=i.useState(null),{data:c,isLoading:n,refetch:o}=N({queryKey:["fuzzing-campaigns"],queryFn:()=>p.listCampaigns({limit:100}).then(a=>a.data)}),{data:h}=N({queryKey:["fuzzing-stats"],queryFn:()=>p.getStats().then(a=>a.data)}),y=v({mutationFn:p.createCampaign,onSuccess:()=>{g.success("Fuzzing campaign created"),s.invalidateQueries({queryKey:["fuzzing-campaigns"]}),s.invalidateQueries({queryKey:["fuzzing-stats"]}),l(!1)},onError:a=>{g.error(`Failed to create campaign: ${a.message}`)}}),b=v({mutationFn:a=>p.startCampaign(a),onSuccess:()=>{g.success("Campaign started"),s.invalidateQueries({queryKey:["fuzzing-campaigns"]})},onError:a=>{g.error(`Failed to start campaign: ${a.message}`)}}),t=v({mutationFn:a=>p.stopCampaign(a),onSuccess:()=>{g.success("Campaign stopped"),s.invalidateQueries({queryKey:["fuzzing-campaigns"]})},onError:a=>{g.error(`Failed to stop campaign: ${a.message}`)}}),u=v({mutationFn:a=>p.deleteCampaign(a),onSuccess:()=>{g.success("Campaign deleted"),s.invalidateQueries({queryKey:["fuzzing-campaigns"]}),s.invalidateQueries({queryKey:["fuzzing-stats"]})},onError:a=>{g.error(`Failed to delete campaign: ${a.message}`)}});return e.jsx(ie,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center",children:[e.jsx(_,{className:"w-8 h-8 mr-3 text-cyan-500"}),"Fuzzing Framework"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Automated vulnerability discovery through intelligent fuzzing"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>o(),className:"p-2 text-gray-400 hover:text-white transition-colors",children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsxs("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors flex items-center",children:[e.jsx(M,{className:"w-5 h-5 mr-2"}),"New Campaign"]})]})]}),h&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(w,{title:"Total Campaigns",value:h.total_campaigns,icon:e.jsx(z,{className:"w-6 h-6 text-white"}),color:"bg-cyan-500/20"}),e.jsx(w,{title:"Active Campaigns",value:h.active_campaigns,icon:e.jsx(L,{className:"w-6 h-6 text-white"}),color:"bg-green-500/20"}),e.jsx(w,{title:"Total Crashes",value:h.total_crashes,icon:e.jsx(C,{className:"w-6 h-6 text-white"}),color:"bg-red-500/20"}),e.jsx(w,{title:"Unique Crashes",value:h.unique_crashes,icon:e.jsx(J,{className:"w-6 h-6 text-white"}),color:"bg-orange-500/20"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Fuzzing Campaigns"})}),n?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx(k,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):c&&c.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-400 text-sm border-b border-gray-700",children:[e.jsx("th",{className:"px-4 py-3",children:"Campaign"}),e.jsx("th",{className:"px-4 py-3",children:"Status"}),e.jsx("th",{className:"px-4 py-3",children:"Iterations"}),e.jsx("th",{className:"px-4 py-3",children:"Crashes"}),e.jsx("th",{className:"px-4 py-3",children:"Coverage"}),e.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),e.jsx("tbody",{children:c.map(a=>e.jsx(de,{campaign:a,onSelect:()=>x(a),onStart:()=>b.mutate(a.id),onStop:()=>t.mutate(a.id),onDelete:()=>{confirm("Are you sure you want to delete this campaign?")&&u.mutate(a.id)}},a.id))})]})}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(_,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No fuzzing campaigns yet"}),e.jsx("p",{className:"text-sm mt-1",children:"Create a campaign to start discovering vulnerabilities"})]})]}),m&&e.jsx(xe,{onClose:()=>l(!1),onSubmit:a=>y.mutate(a),isLoading:y.isPending}),d&&e.jsx(me,{campaign:d,onClose:()=>x(null)})]})})};export{je as default};
