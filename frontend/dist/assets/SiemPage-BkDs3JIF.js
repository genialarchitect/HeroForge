import{a as oe,u as A,b as N,j as e}from"./vendor-state-CmPn7D-C.js";import{r as k}from"./vendor-react-Da1CiaFS.js";import{A as G,aj as C,n as E,ax as ne,S as M,aV as K,a$ as ce,x as T,b8 as V,ai as X,g as I,a7 as xe,B as x,X as ge}from"./vendor-ui-x7nsgIrh.js";import{d as me,B as y,a0 as u}from"./index-Dm7rwmyo.js";import"./vendor-charts-DS95vaJa.js";const p={debug:{bg:"bg-gray-500/20",text:"text-gray-400",border:"border-gray-500"},info:{bg:"bg-blue-500/20",text:"text-blue-400",border:"border-blue-500"},notice:{bg:"bg-cyan-500/20",text:"text-cyan-400",border:"border-cyan-500"},warning:{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500"},error:{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500"},critical:{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500"},alert:{bg:"bg-red-600/20",text:"text-red-500",border:"border-red-600"},emergency:{bg:"bg-purple-500/20",text:"text-purple-400",border:"border-purple-500"}},w={pending:{bg:"bg-yellow-500/20",text:"text-yellow-400"},active:{bg:"bg-green-500/20",text:"text-green-400"},inactive:{bg:"bg-gray-500/20",text:"text-gray-400"},error:{bg:"bg-red-500/20",text:"text-red-400"},enabled:{bg:"bg-green-500/20",text:"text-green-400"},disabled:{bg:"bg-gray-500/20",text:"text-gray-400"},testing:{bg:"bg-blue-500/20",text:"text-blue-400"},new:{bg:"bg-blue-500/20",text:"text-blue-400"},in_progress:{bg:"bg-yellow-500/20",text:"text-yellow-400"},escalated:{bg:"bg-orange-500/20",text:"text-orange-400"},resolved:{bg:"bg-green-500/20",text:"text-green-400"},false_positive:{bg:"bg-gray-500/20",text:"text-gray-400"},ignored:{bg:"bg-gray-600/20",text:"text-gray-500"}},Q=({isOpen:s,onClose:v,title:_,children:m})=>s?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:v}),e.jsxs("div",{className:"relative bg-dark-surface border border-dark-border rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-border",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:_}),e.jsx("button",{onClick:v,className:"p-1 rounded-lg hover:bg-dark-hover text-gray-400 hover:text-white",children:e.jsx(ge,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4",children:m})]})]}):null,he=({source:s,onSubmit:v,onCancel:_,isLoading:m})=>{var b,f,j;const[a,r]=k.useState({name:(s==null?void 0:s.name)||"",description:(s==null?void 0:s.description)||"",source_type:(s==null?void 0:s.source_type)||"syslog",host:(s==null?void 0:s.host)||"",format:(s==null?void 0:s.format)||"syslog_rfc5424",protocol:(s==null?void 0:s.protocol)||"udp",port:((b=s==null?void 0:s.port)==null?void 0:b.toString())||"514",auto_enrich:(s==null?void 0:s.auto_enrich)??!0,retention_days:((f=s==null?void 0:s.retention_days)==null?void 0:f.toString())||"90",tags:((j=s==null?void 0:s.tags)==null?void 0:j.join(", "))||""}),g=d=>{d.preventDefault(),v({name:a.name,description:a.description||void 0,source_type:a.source_type,host:a.host||void 0,format:a.format,protocol:a.protocol,port:a.port?parseInt(a.port):void 0,auto_enrich:a.auto_enrich,retention_days:a.retention_days?parseInt(a.retention_days):void 0,tags:a.tags?a.tags.split(",").map(S=>S.trim()).filter(Boolean):void 0})};return e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{type:"text",required:!0,value:a.name,onChange:d=>r({...a,name:d.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"e.g., Firewall Logs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Source Type"}),e.jsxs("select",{value:a.source_type,onChange:d=>r({...a,source_type:d.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"syslog",children:"Syslog"}),e.jsx("option",{value:"windows",children:"Windows Event"}),e.jsx("option",{value:"firewall",children:"Firewall"}),e.jsx("option",{value:"ids",children:"IDS/IPS"}),e.jsx("option",{value:"application",children:"Application"}),e.jsx("option",{value:"database",children:"Database"}),e.jsx("option",{value:"cloud",children:"Cloud Service"}),e.jsx("option",{value:"endpoint",children:"Endpoint"}),e.jsx("option",{value:"custom",children:"Custom"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:a.description,onChange:d=>r({...a,description:d.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",rows:2,placeholder:"Optional description of the log source"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Host"}),e.jsx("input",{type:"text",value:a.host,onChange:d=>r({...a,host:d.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"e.g., 192.168.1.1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Protocol"}),e.jsxs("select",{value:a.protocol,onChange:d=>r({...a,protocol:d.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"udp",children:"UDP"}),e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"tcp_tls",children:"TCP+TLS"}),e.jsx("option",{value:"http",children:"HTTP"}),e.jsx("option",{value:"https",children:"HTTPS"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Port"}),e.jsx("input",{type:"number",value:a.port,onChange:d=>r({...a,port:d.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"514"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Log Format"}),e.jsxs("select",{value:a.format,onChange:d=>r({...a,format:d.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"syslog_rfc5424",children:"Syslog RFC5424"}),e.jsx("option",{value:"syslog_rfc3164",children:"Syslog RFC3164 (BSD)"}),e.jsx("option",{value:"cef",children:"CEF"}),e.jsx("option",{value:"leef",children:"LEEF"}),e.jsx("option",{value:"json",children:"JSON"}),e.jsx("option",{value:"windows_event",children:"Windows Event"}),e.jsx("option",{value:"raw",children:"Raw Text"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Retention (days)"}),e.jsx("input",{type:"number",value:a.retention_days,onChange:d=>r({...a,retention_days:d.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"90"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:a.tags,onChange:d=>r({...a,tags:d.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"network, production, firewall"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"auto_enrich",checked:a.auto_enrich,onChange:d=>r({...a,auto_enrich:d.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),e.jsx("label",{htmlFor:"auto_enrich",className:"text-sm text-gray-300",children:"Enable automatic enrichment (GeoIP, threat intelligence, etc.)"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-dark-border",children:[e.jsx(y,{type:"button",variant:"ghost",onClick:_,disabled:m,children:"Cancel"}),e.jsx(y,{type:"submit",disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[s?"Update":"Create"," Log Source"]})})]})]})},ue=({rule:s,logSources:v,onSubmit:_,onCancel:m,isLoading:a})=>{var f,j,d,S,h;const[r,g]=k.useState({name:(s==null?void 0:s.name)||"",description:(s==null?void 0:s.description)||"",rule_type:(s==null?void 0:s.rule_type)||"pattern",severity:(s==null?void 0:s.severity)||"warning",status:(s==null?void 0:s.status)||"disabled",definition:JSON.stringify((s==null?void 0:s.definition)||{pattern:""},null,2),source_ids:(s==null?void 0:s.source_ids)||[],mitre_tactics:((f=s==null?void 0:s.mitre_tactics)==null?void 0:f.join(", "))||"",mitre_techniques:((j=s==null?void 0:s.mitre_techniques)==null?void 0:j.join(", "))||"",tags:((d=s==null?void 0:s.tags)==null?void 0:d.join(", "))||"",time_window_seconds:((S=s==null?void 0:s.time_window_seconds)==null?void 0:S.toString())||"",threshold_count:((h=s==null?void 0:s.threshold_count)==null?void 0:h.toString())||""}),b=i=>{i.preventDefault();let c={};try{c=JSON.parse(r.definition)}catch{x.error("Invalid JSON in rule definition");return}_({name:r.name,description:r.description||void 0,rule_type:r.rule_type,severity:r.severity,status:r.status,definition:c,source_ids:r.source_ids.length>0?r.source_ids:void 0,mitre_tactics:r.mitre_tactics?r.mitre_tactics.split(",").map(o=>o.trim()).filter(Boolean):void 0,mitre_techniques:r.mitre_techniques?r.mitre_techniques.split(",").map(o=>o.trim()).filter(Boolean):void 0,tags:r.tags?r.tags.split(",").map(o=>o.trim()).filter(Boolean):void 0,time_window_seconds:r.time_window_seconds?parseInt(r.time_window_seconds):void 0,threshold_count:r.threshold_count?parseInt(r.threshold_count):void 0})};return e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{type:"text",required:!0,value:r.name,onChange:i=>g({...r,name:i.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"e.g., Brute Force Detection"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Rule Type"}),e.jsxs("select",{value:r.rule_type,onChange:i=>g({...r,rule_type:i.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"pattern",children:"Pattern Match"}),e.jsx("option",{value:"regex",children:"Regular Expression"}),e.jsx("option",{value:"threshold",children:"Threshold"}),e.jsx("option",{value:"correlation",children:"Correlation"}),e.jsx("option",{value:"anomaly",children:"Anomaly Detection"}),e.jsx("option",{value:"sigma",children:"Sigma Rule"}),e.jsx("option",{value:"yara",children:"YARA Rule"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:r.description,onChange:i=>g({...r,description:i.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",rows:2,placeholder:"What does this rule detect?"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Severity"}),e.jsxs("select",{value:r.severity,onChange:i=>g({...r,severity:i.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"debug",children:"Debug"}),e.jsx("option",{value:"info",children:"Info"}),e.jsx("option",{value:"notice",children:"Notice"}),e.jsx("option",{value:"warning",children:"Warning"}),e.jsx("option",{value:"error",children:"Error"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"alert",children:"Alert"}),e.jsx("option",{value:"emergency",children:"Emergency"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Status"}),e.jsxs("select",{value:r.status,onChange:i=>g({...r,status:i.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"disabled",children:"Disabled"}),e.jsx("option",{value:"testing",children:"Testing"}),e.jsx("option",{value:"enabled",children:"Enabled"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Rule Definition (JSON) *"}),e.jsx("textarea",{value:r.definition,onChange:i=>g({...r,definition:i.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white font-mono text-sm focus:ring-2 focus:ring-primary focus:border-primary",rows:6,placeholder:'{"pattern": "failed login", "field": "message"}'})]}),v&&v.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Apply to Log Sources"}),e.jsx("div",{className:"flex flex-wrap gap-2 p-3 bg-dark-bg border border-dark-border rounded-lg max-h-32 overflow-y-auto",children:v.map(i=>e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:r.source_ids.includes(i.id),onChange:c=>{c.target.checked?g({...r,source_ids:[...r.source_ids,i.id]}):g({...r,source_ids:r.source_ids.filter(o=>o!==i.id)})},className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),i.name]},i.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Time Window (seconds)"}),e.jsx("input",{type:"number",value:r.time_window_seconds,onChange:i=>g({...r,time_window_seconds:i.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"300"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Threshold Count"}),e.jsx("input",{type:"number",value:r.threshold_count,onChange:i=>g({...r,threshold_count:i.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"5"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"MITRE Tactics (comma-separated)"}),e.jsx("input",{type:"text",value:r.mitre_tactics,onChange:i=>g({...r,mitre_tactics:i.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"TA0001, TA0002"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:r.tags,onChange:i=>g({...r,tags:i.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"brute-force, authentication"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-dark-border",children:[e.jsx(y,{type:"button",variant:"ghost",onClick:m,disabled:a,children:"Cancel"}),e.jsx(y,{type:"submit",disabled:a,children:a?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[s?"Update":"Create"," Rule"]})})]})]})};function fe(){var W,U;const[s,v]=k.useState("dashboard"),[_,m]=k.useState(!1),[a,r]=k.useState(),[g,b]=k.useState(!1),[f,j]=k.useState(),[d,S]=k.useState(null),[h,i]=k.useState({limit:50,offset:0}),c=oe(),{data:o,isLoading:Z}=A({queryKey:["siemStats"],queryFn:()=>u.getStats().then(t=>t.data),refetchInterval:3e4}),{data:D,isLoading:ee}=A({queryKey:["siemLogSources"],queryFn:()=>u.listLogSources().then(t=>t.data)}),{data:L,isLoading:te}=A({queryKey:["siemLogs",h],queryFn:()=>u.queryLogs(h).then(t=>t.data),enabled:s==="logs"}),{data:P,isLoading:se}=A({queryKey:["siemRules"],queryFn:()=>u.listRules().then(t=>t.data)}),{data:F,isLoading:re}=A({queryKey:["siemAlerts"],queryFn:()=>u.listAlerts({limit:100}).then(t=>t.data)}),O=N({mutationFn:t=>u.createLogSource(t),onSuccess:()=>{c.invalidateQueries({queryKey:["siemLogSources"]}),c.invalidateQueries({queryKey:["siemStats"]}),x.success("Log source created successfully"),m(!1)},onError:()=>x.error("Failed to create log source")}),B=N({mutationFn:({id:t,data:l})=>u.updateLogSource(t,l),onSuccess:()=>{c.invalidateQueries({queryKey:["siemLogSources"]}),x.success("Log source updated"),m(!1),r(void 0)},onError:()=>x.error("Failed to update log source")}),ae=N({mutationFn:t=>u.deleteLogSource(t),onSuccess:()=>{c.invalidateQueries({queryKey:["siemLogSources"]}),c.invalidateQueries({queryKey:["siemStats"]}),x.success("Log source deleted")},onError:()=>x.error("Failed to delete log source")}),z=N({mutationFn:t=>u.createRule(t),onSuccess:()=>{c.invalidateQueries({queryKey:["siemRules"]}),c.invalidateQueries({queryKey:["siemStats"]}),x.success("Rule created successfully"),b(!1)},onError:()=>x.error("Failed to create rule")}),H=N({mutationFn:({id:t,data:l})=>u.updateRule(t,l),onSuccess:()=>{c.invalidateQueries({queryKey:["siemRules"]}),x.success("Rule updated"),b(!1),j(void 0)},onError:()=>x.error("Failed to update rule")}),de=N({mutationFn:t=>u.deleteRule(t),onSuccess:()=>{c.invalidateQueries({queryKey:["siemRules"]}),c.invalidateQueries({queryKey:["siemStats"]}),x.success("Rule deleted")},onError:()=>x.error("Failed to delete rule")}),ie=N({mutationFn:({id:t,status:l,assigned_to:n})=>u.updateAlertStatus(t,{status:l,assigned_to:n}),onSuccess:()=>{c.invalidateQueries({queryKey:["siemAlerts"]}),c.invalidateQueries({queryKey:["siemStats"]}),x.success("Alert updated")},onError:()=>x.error("Failed to update alert")}),J=N({mutationFn:({id:t,resolution_notes:l,is_false_positive:n})=>u.resolveAlert(t,{resolution_notes:l,is_false_positive:n}),onSuccess:()=>{c.invalidateQueries({queryKey:["siemAlerts"]}),c.invalidateQueries({queryKey:["siemStats"]}),x.success("Alert resolved")},onError:()=>x.error("Failed to resolve alert")}),le=[{id:"dashboard",label:"Dashboard",icon:e.jsx(G,{className:"w-4 h-4"})},{id:"sources",label:"Log Sources",icon:e.jsx(E,{className:"w-4 h-4"})},{id:"logs",label:"Log Search",icon:e.jsx(I,{className:"w-4 h-4"})},{id:"rules",label:"Detection Rules",icon:e.jsx(M,{className:"w-4 h-4"})},{id:"alerts",label:"Alerts",icon:e.jsx(K,{className:"w-4 h-4"})}],$=t=>t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString();return e.jsx(me,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white flex items-center gap-3",children:[e.jsx(G,{className:"w-8 h-8 text-primary"}),"SIEM Dashboard"]}),e.jsx("p",{className:"text-slate-600 dark:text-gray-400 mt-1",children:"Security Information and Event Management - Log collection, detection, and alerting"})]})}),e.jsx("div",{className:"border-b border-light-border dark:border-dark-border",children:e.jsx("nav",{className:"flex gap-4",children:le.map(t=>e.jsxs("button",{onClick:()=>v(t.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${s===t.id?"border-primary text-primary":"border-transparent text-slate-600 dark:text-gray-400 hover:text-slate-900 dark:hover:text-gray-200"}`,children:[t.icon,t.label,t.id==="alerts"&&F&&F.filter(l=>l.status==="new").length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs rounded-full bg-red-500 text-white",children:F.filter(l=>l.status==="new").length})]},t.id))})}),e.jsxs("div",{children:[s==="dashboard"&&e.jsx("div",{className:"space-y-6",children:Z?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(C,{className:"w-8 h-8 text-primary animate-spin"})}):o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-blue-500/20 rounded-lg",children:e.jsx(E,{className:"w-6 h-6 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-gray-400",children:"Log Sources"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:o.total_sources}),e.jsxs("p",{className:"text-xs text-green-400",children:[o.active_sources," active"]})]})]})}),e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-purple-500/20 rounded-lg",children:e.jsx(ne,{className:"w-6 h-6 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-gray-400",children:"Logs Today"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:$(o.total_logs_today)}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-gray-500",children:[o.ingestion_rate.toFixed(1),"/sec"]})]})]})}),e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-cyan-500/20 rounded-lg",children:e.jsx(M,{className:"w-6 h-6 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-gray-400",children:"Detection Rules"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:o.total_rules}),e.jsxs("p",{className:"text-xs text-green-400",children:[o.enabled_rules," enabled"]})]})]})}),e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-red-500/20 rounded-lg",children:e.jsx(K,{className:"w-6 h-6 text-red-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-gray-400",children:"Open Alerts"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:o.open_alerts}),e.jsxs("p",{className:"text-xs text-red-400",children:[o.critical_alerts," critical"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4",children:"Alerts by Status"}),e.jsxs("div",{className:"space-y-3",children:[o.alerts_by_status.map(t=>{var l,n;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${((l=w[t.status])==null?void 0:l.bg)||"bg-gray-500/20"} ${((n=w[t.status])==null?void 0:n.text)||"text-gray-400"}`,children:t.status.replace("_"," ")})}),e.jsx("span",{className:"text-slate-600 dark:text-gray-400",children:t.count})]},t.status)}),o.alerts_by_status.length===0&&e.jsx("p",{className:"text-slate-500 dark:text-gray-500 text-sm",children:"No alerts yet"})]})]}),e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4",children:"Alerts by Severity"}),e.jsxs("div",{className:"space-y-3",children:[o.alerts_by_severity.map(t=>{var l,n;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${((l=p[t.severity])==null?void 0:l.bg)||"bg-gray-500/20"} ${((n=p[t.severity])==null?void 0:n.text)||"text-gray-400"}`,children:t.severity})}),e.jsx("span",{className:"text-slate-600 dark:text-gray-400",children:t.count})]},t.severity)}),o.alerts_by_severity.length===0&&e.jsx("p",{className:"text-slate-500 dark:text-gray-500 text-sm",children:"No alerts yet"})]})]})]}),e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4",children:"Top Log Sources"}),e.jsxs("div",{className:"space-y-3",children:[o.top_sources.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-light-bg dark:bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(E,{className:"w-5 h-5 text-slate-400 dark:text-gray-500"}),e.jsx("span",{className:"text-slate-700 dark:text-gray-300",children:t.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-slate-900 dark:text-white font-medium",children:[$(t.log_count)," logs"]}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-gray-500",children:[t.logs_per_hour,"/hr"]})]})]},t.id)),o.top_sources.length===0&&e.jsx("p",{className:"text-slate-500 dark:text-gray-500 text-sm text-center py-4",children:"No log sources configured yet"})]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ce,{className:"w-16 h-16 text-slate-400 dark:text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600 dark:text-gray-400",children:"Failed to load statistics"})]})}),s==="sources"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(y,{onClick:()=>{r(void 0),m(!0)},children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Add Log Source"]})}),ee?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(C,{className:"w-8 h-8 text-primary animate-spin"})}):D&&D.length>0?e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-light-border dark:border-dark-border",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-slate-600 dark:text-gray-400",children:"Name"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-slate-600 dark:text-gray-400",children:"Type"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-slate-600 dark:text-gray-400",children:"Host"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-slate-600 dark:text-gray-400",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-slate-600 dark:text-gray-400",children:"Logs"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-slate-600 dark:text-gray-400",children:"Last Seen"}),e.jsx("th",{className:"text-right p-4 text-sm font-medium text-slate-600 dark:text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:D.map(t=>{var l,n;return e.jsxs("tr",{className:"border-b border-light-border dark:border-dark-border hover:bg-light-hover dark:hover:bg-dark-hover",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:t.name}),t.description&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-gray-500 truncate max-w-xs",children:t.description})]})}),e.jsx("td",{className:"p-4 text-slate-600 dark:text-gray-400",children:t.source_type}),e.jsx("td",{className:"p-4 text-slate-600 dark:text-gray-400",children:t.host||"-"}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${((l=w[t.status])==null?void 0:l.bg)||"bg-gray-500/20"} ${((n=w[t.status])==null?void 0:n.text)||"text-gray-400"}`,children:t.status})}),e.jsx("td",{className:"p-4 text-slate-600 dark:text-gray-400",children:$(t.log_count)}),e.jsx("td",{className:"p-4 text-slate-500 dark:text-gray-500 text-sm",children:t.last_seen?new Date(t.last_seen).toLocaleString():"Never"}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>{r(t),m(!0)},className:"p-2 hover:bg-light-hover dark:hover:bg-dark-hover rounded-lg text-slate-500 dark:text-gray-400 hover:text-slate-700 dark:hover:text-white",children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{confirm("Delete this log source?")&&ae.mutate(t.id)},className:"p-2 hover:bg-red-500/20 rounded-lg text-slate-500 dark:text-gray-400 hover:text-red-400",children:e.jsx(X,{className:"w-4 h-4"})})]})})]},t.id)})})]})}):e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-12 text-center",children:[e.jsx(E,{className:"w-16 h-16 text-slate-400 dark:text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-slate-700 dark:text-gray-300 mb-2",children:"No Log Sources Configured"}),e.jsx("p",{className:"text-slate-500 dark:text-gray-400 mb-6",children:"Add log sources to start collecting and analyzing security events"}),e.jsxs(y,{onClick:()=>m(!0),children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Add Log Source"]})]})]}),s==="logs"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 dark:text-gray-400 mb-1",children:"Search"}),e.jsx("input",{type:"text",value:h.query||"",onChange:t=>i({...h,query:t.target.value||void 0}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"Search logs..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 dark:text-gray-400 mb-1",children:"Min Severity"}),e.jsxs("select",{value:h.min_severity||"",onChange:t=>i({...h,min_severity:t.target.value||void 0}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"debug",children:"Debug+"}),e.jsx("option",{value:"info",children:"Info+"}),e.jsx("option",{value:"warning",children:"Warning+"}),e.jsx("option",{value:"error",children:"Error+"}),e.jsx("option",{value:"critical",children:"Critical+"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 dark:text-gray-400 mb-1",children:"Source IP"}),e.jsx("input",{type:"text",value:h.source_ip||"",onChange:t=>i({...h,source_ip:t.target.value||void 0}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"192.168.1.1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 dark:text-gray-400 mb-1",children:"Hostname"}),e.jsx("input",{type:"text",value:h.hostname||"",onChange:t=>i({...h,hostname:t.target.value||void 0}),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-slate-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"server01"})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs(y,{size:"sm",onClick:()=>c.invalidateQueries({queryKey:["siemLogs"]}),children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Search"]})})]}),te?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(C,{className:"w-8 h-8 text-primary animate-spin"})}):L?e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-light-border dark:border-dark-border flex items-center justify-between",children:e.jsxs("p",{className:"text-sm text-slate-600 dark:text-gray-400",children:["Showing ",L.entries.length," of ",L.total_count," logs (",L.query_time_ms,"ms)"]})}),e.jsxs("div",{className:"divide-y divide-light-border dark:divide-dark-border max-h-[600px] overflow-y-auto",children:[L.entries.map(t=>{var l,n;return e.jsx("div",{className:"p-3 hover:bg-light-hover dark:hover:bg-dark-hover cursor-pointer",onClick:()=>S(t),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${((l=p[t.severity])==null?void 0:l.bg)||"bg-gray-500/20"} ${((n=p[t.severity])==null?void 0:n.text)||"text-gray-400"}`,children:t.severity}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 dark:text-gray-500 mb-1",children:[e.jsx("span",{children:new Date(t.timestamp).toLocaleString()}),t.hostname&&e.jsx("span",{className:"text-slate-400 dark:text-gray-600",children:"|"}),t.hostname&&e.jsx("span",{children:t.hostname}),t.application&&e.jsx("span",{className:"text-slate-400 dark:text-gray-600",children:"|"}),t.application&&e.jsx("span",{children:t.application})]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-gray-300 truncate",children:t.message})]}),t.alerted&&e.jsx(K,{className:"w-4 h-4 text-red-400 flex-shrink-0"})]})},t.id)}),L.entries.length===0&&e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(I,{className:"w-12 h-12 text-slate-400 dark:text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-500 dark:text-gray-400",children:"No logs found matching your criteria"})]})]})]}):null]}),s==="rules"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(y,{onClick:()=>{j(void 0),b(!0)},children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Add Rule"]})}),se?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(C,{className:"w-8 h-8 text-primary animate-spin"})}):P&&P.length>0?e.jsx("div",{className:"space-y-3",children:P.map(t=>{var l,n,R,q;return e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-medium text-slate-900 dark:text-white",children:t.name}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${((l=w[t.status])==null?void 0:l.bg)||"bg-gray-500/20"} ${((n=w[t.status])==null?void 0:n.text)||"text-gray-400"}`,children:t.status}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${((R=p[t.severity])==null?void 0:R.bg)||"bg-gray-500/20"} ${((q=p[t.severity])==null?void 0:q.text)||"text-gray-400"}`,children:t.severity}),e.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-slate-500/20 text-slate-400",children:t.rule_type})]}),t.description&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-gray-400 mb-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500 dark:text-gray-500",children:[e.jsxs("span",{children:["Triggered: ",t.trigger_count," times"]}),t.last_triggered&&e.jsxs("span",{children:["Last: ",new Date(t.last_triggered).toLocaleString()]}),t.mitre_tactics.length>0&&e.jsxs("span",{children:["MITRE: ",t.mitre_tactics.join(", ")]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{j(t),b(!0)},className:"p-2 hover:bg-light-hover dark:hover:bg-dark-hover rounded-lg text-slate-500 dark:text-gray-400 hover:text-slate-700 dark:hover:text-white",children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{confirm("Delete this rule?")&&de.mutate(t.id)},className:"p-2 hover:bg-red-500/20 rounded-lg text-slate-500 dark:text-gray-400 hover:text-red-400",children:e.jsx(X,{className:"w-4 h-4"})})]})]})},t.id)})}):e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-12 text-center",children:[e.jsx(M,{className:"w-16 h-16 text-slate-400 dark:text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-slate-700 dark:text-gray-300 mb-2",children:"No Detection Rules"}),e.jsx("p",{className:"text-slate-500 dark:text-gray-400 mb-6",children:"Create detection rules to automatically identify security threats"}),e.jsxs(y,{onClick:()=>b(!0),children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Add Rule"]})]})]}),s==="alerts"&&e.jsx("div",{className:"space-y-4",children:re?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(C,{className:"w-8 h-8 text-primary animate-spin"})}):F&&F.length>0?e.jsx("div",{className:"space-y-3",children:F.map(t=>{var l,n,R,q,Y;return e.jsx("div",{className:`bg-light-surface dark:bg-dark-surface border rounded-lg p-4 ${(l=p[t.severity])!=null&&l.border?`border-l-4 ${p[t.severity].border}`:"border-dark-border"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-medium text-slate-900 dark:text-white",children:t.title}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${((n=w[t.status])==null?void 0:n.bg)||"bg-gray-500/20"} ${((R=w[t.status])==null?void 0:R.text)||"text-gray-400"}`,children:t.status.replace("_"," ")}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${((q=p[t.severity])==null?void 0:q.bg)||"bg-gray-500/20"} ${((Y=p[t.severity])==null?void 0:Y.text)||"text-gray-400"}`,children:t.severity})]}),t.description&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-gray-400 mb-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500 dark:text-gray-500",children:[e.jsxs("span",{children:["Rule: ",t.rule_name]}),e.jsxs("span",{children:["Events: ",t.event_count]}),e.jsxs("span",{children:["First: ",new Date(t.first_seen).toLocaleString()]}),t.source_ips.length>0&&e.jsxs("span",{children:["Sources: ",t.source_ips.slice(0,3).join(", "),t.source_ips.length>3?"...":""]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:t.status!=="resolved"&&t.status!=="false_positive"&&e.jsxs(e.Fragment,{children:[e.jsx(y,{size:"sm",variant:"ghost",onClick:()=>ie.mutate({id:t.id,status:"in_progress"}),children:"Investigate"}),e.jsx(y,{size:"sm",variant:"ghost",onClick:()=>J.mutate({id:t.id}),children:"Resolve"}),e.jsx(y,{size:"sm",variant:"ghost",onClick:()=>J.mutate({id:t.id,is_false_positive:!0}),children:"False Positive"})]})})]})},t.id)})}):e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-12 text-center",children:[e.jsx(xe,{className:"w-16 h-16 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-slate-700 dark:text-gray-300 mb-2",children:"No Alerts"}),e.jsx("p",{className:"text-slate-500 dark:text-gray-400",children:"Your detection rules have not triggered any alerts yet"})]})})]}),e.jsx(Q,{isOpen:_,onClose:()=>{m(!1),r(void 0)},title:a?"Edit Log Source":"Add Log Source",children:e.jsx(he,{source:a,onSubmit:t=>{a?B.mutate({id:a.id,data:t}):O.mutate(t)},onCancel:()=>{m(!1),r(void 0)},isLoading:O.isPending||B.isPending})}),e.jsx(Q,{isOpen:g,onClose:()=>{b(!1),j(void 0)},title:f?"Edit Detection Rule":"Add Detection Rule",children:e.jsx(ue,{rule:f,logSources:D,onSubmit:t=>{f?H.mutate({id:f.id,data:t}):z.mutate(t)},onCancel:()=>{b(!1),j(void 0)},isLoading:z.isPending||H.isPending})}),e.jsx(Q,{isOpen:!!d,onClose:()=>S(null),title:"Log Entry Details",children:d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-gray-500",children:"Timestamp"}),e.jsx("p",{className:"text-slate-900 dark:text-white",children:new Date(d.timestamp).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-gray-500",children:"Severity"}),e.jsx("p",{children:e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${((W=p[d.severity])==null?void 0:W.bg)||"bg-gray-500/20"} ${((U=p[d.severity])==null?void 0:U.text)||"text-gray-400"}`,children:d.severity})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-gray-500",children:"Hostname"}),e.jsx("p",{className:"text-slate-900 dark:text-white",children:d.hostname||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-gray-500",children:"Application"}),e.jsx("p",{className:"text-slate-900 dark:text-white",children:d.application||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-gray-500",children:"Source IP"}),e.jsx("p",{className:"text-slate-900 dark:text-white",children:d.source_ip||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-gray-500",children:"Destination IP"}),e.jsx("p",{className:"text-slate-900 dark:text-white",children:d.destination_ip||"-"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-gray-500",children:"Message"}),e.jsx("p",{className:"text-slate-900 dark:text-white bg-light-bg dark:bg-dark-bg p-3 rounded-lg mt-1",children:d.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-gray-500",children:"Raw Log"}),e.jsx("pre",{className:"text-xs text-slate-700 dark:text-gray-300 bg-light-bg dark:bg-dark-bg p-3 rounded-lg mt-1 overflow-x-auto",children:d.raw})]}),Object.keys(d.structured_data).length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 dark:text-gray-500",children:"Structured Data"}),e.jsx("pre",{className:"text-xs text-slate-700 dark:text-gray-300 bg-light-bg dark:bg-dark-bg p-3 rounded-lg mt-1 overflow-x-auto",children:JSON.stringify(d.structured_data,null,2)})]})]})})]})})}export{fe as default};
