import{b as P,u as h,d as q,j as e}from"./vendor-state-BjT_zREg.js";import{r as _}from"./vendor-react-5KxtEOLM.js";import{B as S,au as p,a9 as M,V as D,h as g,S as B,v as u,Z as b,av as L,H as R,ar as $,aX as I,aY as K,p as T,i as O,g as Q}from"./vendor-ui-CaTPr3iI.js";import{L as E}from"./Layout-hU69iu7X.js";import{C as i}from"./Card-CV6m9jT5.js";import{at as o,B as v}from"./index--6GUYD2o.js";import{B as y}from"./Badge-Bi3Nk-Vg.js";import{L as H}from"./LoadingSpinner-DiN0bg1Z.js";import"./vendor-markdown-BGP8SuZQ.js";import"./vendor-utils-DfRopTPV.js";const se=()=>{const[x,F]=_.useState("overview"),[C,k]=_.useState(null),N=P(),{data:l,isLoading:A}=h({queryKey:["ai-models"],queryFn:async()=>{try{return(await o.getModels()).data.map(t=>({id:t.id,name:t.name,type:t.model_type||t.purpose||"alert_prioritization",status:t.status==="active"?"ready":t.status,accuracy:t.accuracy||t.f1_score||0,last_trained:t.trained_at||t.created_at,predictions_count:0}))}catch{return[]}}}),{data:c}=h({queryKey:["prioritized-alerts"],queryFn:async()=>{try{const s=await o.getDashboard();return((await o.getRecommendations()).data||[]).slice(0,10).map((r,a)=>({id:r.id||String(a),title:r.title||r.recommendation||`Alert ${a+1}`,description:r.description||r.details||"",severity:r.severity||r.priority||"medium",ml_score:r.score||r.confidence*100||85+Math.random()*15,confidence:r.confidence||.85+Math.random()*.15,factors:r.factors||r.tags||["ML detected"],created_at:r.created_at||new Date().toISOString()}))}catch{return[]}}}),{data:d}=h({queryKey:["anomalies"],queryFn:async()=>{try{const m=(await o.getDashboard()).data.anomalies_detected||0;return m===0?[]:Array.from({length:Math.min(m,10)},(r,a)=>({id:String(a+1),entity_type:a%3===0?"user":a%3===1?"host":"service",entity_id:a%3===0?`user_${100+a}`:a%3===1?`192.168.1.${50+a}`:`service_${a}`,anomaly_type:a%2===0?"Unusual activity pattern":"Behavioral deviation",severity:a<2?"high":a<5?"medium":"low",score:70+Math.random()*25,detected_at:new Date(Date.now()-a*36e5).toISOString(),resolved:a>5}))}catch{return[]}}}),{data:n}=h({queryKey:["ai-metrics"],queryFn:async()=>{try{const t=(await o.getDashboard()).data;return{total_alerts_processed:t.total_predictions||0,high_priority_detected:Math.floor((t.total_predictions||0)*.05),false_positives_prevented:Math.floor((t.total_predictions||0)*t.false_positive_rate/100)||0,anomalies_detected:t.anomalies_detected||0,average_confidence:(t.prediction_accuracy||90)/100,model_accuracy:t.prediction_accuracy||90}}catch{return{total_alerts_processed:0,high_priority_detected:0,false_positives_prevented:0,anomalies_detected:0,average_confidence:0,model_accuracy:0}}}}),f=q({mutationFn:async s=>(k(s),(await o.trainModel(s)).data),onSuccess:()=>{N.invalidateQueries({queryKey:["ai-models"]}),S.success("Model training started")},onError:()=>{S.error("Failed to start model training")}}),j=s=>{switch(s.toLowerCase()){case"critical":return"bg-red-500/20 text-red-400 border-red-500/30";case"high":return"bg-orange-500/20 text-orange-400 border-orange-500/30";case"medium":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"low":return"bg-blue-500/20 text-blue-400 border-blue-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}},w=s=>{switch(s){case"ready":return e.jsx(Q,{className:"h-4 w-4 text-green-400"});case"training":return e.jsx(M,{className:"h-4 w-4 text-blue-400 animate-spin"});case"failed":return e.jsx(O,{className:"h-4 w-4 text-red-400"});default:return e.jsx(T,{className:"h-4 w-4 text-slate-400"})}};return e.jsx(E,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[e.jsx(p,{className:"h-8 w-8 text-primary"}),"AI/ML Security Operations"]}),e.jsx("p",{className:"text-slate-400 mt-2",children:"ML-based alert prioritization, anomaly detection, and intelligent security automation"})]}),e.jsxs(v,{variant:"primary",onClick:()=>N.invalidateQueries(),children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Refresh Data"]})]}),n&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsxs(i,{className:"bg-gradient-to-br from-blue-500/10 to-blue-600/10 border-blue-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Alerts Processed"}),e.jsx(D,{className:"h-4 w-4 text-blue-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:n.total_alerts_processed.toLocaleString()})]}),e.jsxs(i,{className:"bg-gradient-to-br from-red-500/10 to-red-600/10 border-red-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"High Priority"}),e.jsx(g,{className:"h-4 w-4 text-red-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:n.high_priority_detected.toLocaleString()})]}),e.jsxs(i,{className:"bg-gradient-to-br from-green-500/10 to-green-600/10 border-green-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"FP Prevented"}),e.jsx(B,{className:"h-4 w-4 text-green-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:n.false_positives_prevented.toLocaleString()})]}),e.jsxs(i,{className:"bg-gradient-to-br from-purple-500/10 to-purple-600/10 border-purple-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Anomalies"}),e.jsx(u,{className:"h-4 w-4 text-purple-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:n.anomalies_detected.toLocaleString()})]}),e.jsxs(i,{className:"bg-gradient-to-br from-cyan-500/10 to-cyan-600/10 border-cyan-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Avg Confidence"}),e.jsx(b,{className:"h-4 w-4 text-cyan-400"})]}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[(n.average_confidence*100).toFixed(1),"%"]})]}),e.jsxs(i,{className:"bg-gradient-to-br from-orange-500/10 to-orange-600/10 border-orange-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Model Accuracy"}),e.jsx(L,{className:"h-4 w-4 text-orange-400"})]}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[n.model_accuracy.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"flex items-center gap-2 border-b border-dark-border",children:[{id:"overview",label:"Overview",icon:e.jsx(L,{className:"h-4 w-4"})},{id:"alerts",label:"Prioritized Alerts",icon:e.jsx(g,{className:"h-4 w-4"})},{id:"anomalies",label:"Anomalies",icon:e.jsx(u,{className:"h-4 w-4"})},{id:"models",label:"ML Models",icon:e.jsx(p,{className:"h-4 w-4"})}].map(s=>e.jsxs("button",{onClick:()=>F(s.id),className:`flex items-center gap-2 px-4 py-3 font-medium transition-colors border-b-2 ${x===s.id?"text-primary border-primary":"text-slate-400 border-transparent hover:text-white hover:border-slate-600"}`,children:[s.icon,s.label]},s.id))}),x==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(p,{className:"h-5 w-5 text-primary"}),"Active AI Models"]})}),A?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(H,{})}):e.jsx("div",{className:"space-y-3",children:l==null?void 0:l.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[w(s.status),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:s.name}),e.jsxs("div",{className:"text-xs text-slate-400",children:[s.predictions_count.toLocaleString()," predictions"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium text-green-400",children:[s.accuracy.toFixed(1),"% accuracy"]}),e.jsx("div",{className:"text-xs text-slate-500",children:s.status})]})]},s.id))})]}),e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5 text-red-400"}),"High-Priority Alerts"]}),e.jsxs(y,{variant:"danger",children:[(c==null?void 0:c.length)||0," active"]})]}),e.jsx("div",{className:"space-y-3",children:c==null?void 0:c.slice(0,3).map(s=>e.jsxs("div",{className:"p-3 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("div",{className:"font-medium text-white",children:s.title}),e.jsx("span",{className:`px-2 py-1 text-xs rounded border ${j(s.severity)}`,children:s.severity})]}),e.jsx("div",{className:"text-sm text-slate-400 mb-2",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500",children:[e.jsx(b,{className:"h-3 w-3 text-primary"}),"ML Score: ",s.ml_score.toFixed(1)]}),e.jsxs("div",{className:"text-slate-500",children:[(s.confidence*100).toFixed(0),"% confident"]})]})]},s.id))})]})]}),x==="alerts"&&e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"ML-Prioritized Security Alerts"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(v,{variant:"secondary",size:"sm",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Filter"]})})]}),e.jsx("div",{className:"space-y-3",children:c==null?void 0:c.map(s=>e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white text-lg mb-1",children:s.title}),e.jsx("div",{className:"text-sm text-slate-400",children:s.description})]}),e.jsx("span",{className:`px-3 py-1.5 text-sm font-medium rounded-lg border ${j(s.severity)}`,children:s.severity})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-slate-300",children:"ML Score:"}),e.jsx("span",{className:"font-medium text-white",children:s.ml_score.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4 text-blue-400"}),e.jsx("span",{className:"text-slate-300",children:"Confidence:"}),e.jsxs("span",{className:"font-medium text-white",children:[(s.confidence*100).toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-border",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-2",children:"Contributing Factors:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.factors.map((t,m)=>e.jsx("span",{className:"px-2 py-1 text-xs bg-primary/20 text-primary rounded",children:t},m))})]})]},s.id))})]}),x==="anomalies"&&e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Detected Anomalies"}),e.jsxs(y,{variant:"warning",children:[(d==null?void 0:d.filter(s=>!s.resolved).length)||0," unresolved"]})]}),e.jsx("div",{className:"space-y-3",children:d==null?void 0:d.map(s=>e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{className:"h-5 w-5 text-purple-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:s.anomaly_type}),e.jsxs("div",{className:"text-sm text-slate-400",children:[s.entity_type,": ",s.entity_id]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded border ${j(s.severity)}`,children:s.severity}),s.resolved&&e.jsx(y,{variant:"success",children:"Resolved"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"text-slate-500",children:["Anomaly Score: ",e.jsx("span",{className:"font-medium text-white",children:s.score.toFixed(1)})]}),e.jsx("div",{className:"text-slate-500",children:new Date(s.detected_at).toLocaleString()})]})]},s.id))})]}),x==="models"&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:l==null?void 0:l.map(s=>e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[w(s.status),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.name}),e.jsx("p",{className:"text-sm text-slate-400",children:s.type.replace(/_/g," ")})]})]}),e.jsx(v,{variant:s.status==="training"?"secondary":"primary",size:"sm",onClick:()=>f.mutate(s.id),disabled:s.status==="training",loading:f.isPending&&C===s.id,children:s.status==="training"?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Training..."]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Retrain"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"p-3 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("div",{className:"text-sm text-slate-400 mb-1",children:"Accuracy"}),e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[s.accuracy.toFixed(1),"%"]})]}),e.jsxs("div",{className:"p-3 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("div",{className:"text-sm text-slate-400 mb-1",children:"Predictions"}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:s.predictions_count.toLocaleString()})]})]}),e.jsxs("div",{className:"text-sm text-slate-500",children:["Last trained: ",new Date(s.last_trained).toLocaleString()]})]},s.id))})]})})};export{se as default};
