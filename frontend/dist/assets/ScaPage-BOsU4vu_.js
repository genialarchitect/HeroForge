import{j as e}from"./vendor-state-DdX3IZQk.js";import{r as l}from"./vendor-react-Da1CiaFS.js";import{B as i,a9 as V,aN as u,P as $,aR as T,aD as M,s as R,ae as z,n as B,aI as I,R as U}from"./vendor-ui-B6SJ_7kK.js";import{aq as d,d as O}from"./index-CHBEgFD4.js";import"./vendor-charts-gFVtv0RJ.js";const Y=()=>{const[c,v]=l.useState("overview"),[r,b]=l.useState(null),[f,w]=l.useState([]),[t,_]=l.useState(null),[S,C]=l.useState([]),[h,P]=l.useState([]),[D,g]=l.useState(!0),[p,A]=l.useState(""),[X,L]=l.useState(!1),[q,G]=l.useState(new Set);l.useEffect(()=>{y()},[]);const y=async()=>{try{g(!0);const[s,a]=await Promise.all([d.getStats().then(n=>n.data),d.getProjects().then(n=>n.data)]);b(s),w(a),a.length>0&&await x(a[0])}catch(s){console.error("Failed to load SCA data:",s),i.error("Failed to load SCA data")}finally{g(!1)}},x=async s=>{_(s);try{const[a,n]=await Promise.all([d.getDependencies(s.id).then(m=>m.data),d.getVulnerabilities(s.id).then(m=>m.data)]);C(a),P(n)}catch(a){console.error("Failed to load project details:",a),i.error("Failed to load project details")}},k=async s=>{try{i.info(`Analyzing ${s.name}...`),await d.analyzeProject(s.id,{check_updates:!0}),i.success("Analysis complete!"),await y(),(t==null?void 0:t.id)===s.id&&await x(s)}catch(a){console.error("Analysis failed:",a),i.error("Analysis failed")}},j=async s=>{if(t)try{i.info(`SBOM export for ${s.toUpperCase()} is not yet implemented`)}catch(a){console.error("Failed to export SBOM:",a),i.error("Failed to export SBOM")}},N=s=>{switch(s.toLowerCase()){case"critical":return"bg-purple-600";case"high":return"bg-red-600";case"medium":return"bg-yellow-600";case"low":return"bg-blue-600";default:return"bg-gray-600"}},E=s=>{switch(s==null?void 0:s.toLowerCase()){case"high":return"text-red-400";case"medium":return"text-yellow-400";case"low":return"text-green-400";default:return"text-gray-400"}},o=s=>{switch(s){case"cargo":return"ðŸ¦€";case"npm":return"ðŸ“¦";case"pypi":return"ðŸ";case"go":return"ðŸ¹";case"maven":return"â˜•";default:return"ðŸ“¦"}},F=S.filter(s=>s.name.toLowerCase().includes(p.toLowerCase()));return e.jsx(O,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{className:"h-8 w-8 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Software Composition Analysis"}),e.jsx("p",{className:"text-gray-400",children:"Analyze dependencies and identify vulnerabilities"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>j("cyclonedx"),className:"flex items-center gap-2 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",disabled:!t,children:[e.jsx(u,{className:"h-4 w-4"}),"CycloneDX"]}),e.jsxs("button",{onClick:()=>j("spdx"),className:"flex items-center gap-2 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",disabled:!t,children:[e.jsx(u,{className:"h-4 w-4"}),"SPDX"]}),e.jsxs("button",{onClick:()=>L(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-500",children:[e.jsx($,{className:"h-4 w-4"}),"Add Project"]})]})]}),r&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:r.total_projects}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Projects"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:r.total_dependencies}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Dependencies"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:r.vulnerable_dependencies}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Vulnerable"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400",children:r.critical_vulns}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Critical"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:r.high_vulns}),e.jsx("div",{className:"text-gray-400 text-sm",children:"High"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:r.medium_vulns}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Medium"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400",children:r.license_issues}),e.jsx("div",{className:"text-gray-400 text-sm",children:"License Issues"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-cyan-400",children:r.updates_available}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Updates"})]})]}),e.jsx("div",{className:"flex gap-1 mb-6 border-b border-gray-700",children:["overview","projects","dependencies","vulnerabilities"].map(s=>e.jsx("button",{onClick:()=>v(s),className:`px-4 py-2 font-medium capitalize ${c===s?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:s},s))}),D?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(T,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs(e.Fragment,{children:[c==="projects"&&e.jsx("div",{className:"grid gap-4",children:f.map(s=>e.jsx("div",{className:`bg-gray-800 rounded-lg p-4 cursor-pointer border-2 transition-colors ${(t==null?void 0:t.id)===s.id?"border-cyan-500":"border-transparent hover:border-gray-600"}`,onClick:()=>x(s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:o(s.ecosystem)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:s.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[s.ecosystem," â€¢ ",s.total_dependencies," dependencies"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[s.vulnerable_dependencies>0&&e.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.vulnerable_dependencies," vulnerable"]})]}),s.license_issues>0&&e.jsxs("div",{className:"flex items-center gap-2 text-yellow-400",children:[e.jsx(R,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.license_issues," license issues"]})]}),e.jsx("button",{onClick:a=>{a.stopPropagation(),k(s)},className:"p-2 bg-cyan-600 rounded-lg hover:bg-cyan-500",children:e.jsx(z,{className:"h-4 w-4 text-white"})})]})]})},s.id))}),c==="dependencies"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-4 mb-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(B,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search dependencies...",value:p,onChange:s=>A(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white"})]})}),e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Package"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Version"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Latest"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"License"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{children:F.map(s=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:o(s.ecosystem)}),e.jsx("span",{className:"text-white",children:s.name})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.version}),e.jsx("td",{className:"px-4 py-3",children:s.update_available?e.jsx("span",{className:"text-cyan-400",children:s.latest_version}):e.jsx("span",{className:"text-green-400",children:s.version})}),e.jsx("td",{className:`px-4 py-3 ${E(s.license_risk)}`,children:s.license||"Unknown"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.is_direct?"bg-cyan-600 text-white":"bg-gray-600 text-gray-300"}`,children:s.is_direct?"Direct":"Transitive"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{className:"p-1 hover:bg-gray-700 rounded",children:e.jsx(I,{className:"h-4 w-4 text-gray-400"})})})]},s.id))})]})})]}),c==="vulnerabilities"&&e.jsx("div",{className:"space-y-4",children:h.map(s=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs text-white ${N(s.severity)}`,children:s.severity.toUpperCase()}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:s.vuln_id}),e.jsx("p",{className:"text-gray-300 mt-1",children:s.title}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:s.description}),s.fixed_version&&e.jsxs("p",{className:"text-green-400 text-sm mt-2",children:["Fixed in version: ",s.fixed_version]})]})]}),e.jsxs("div",{className:"text-right",children:[s.cvss_score&&e.jsxs("div",{className:"text-white font-bold",children:["CVSS: ",s.cvss_score]}),e.jsx("div",{className:"text-gray-400 text-sm",children:s.source}),s.exploited_in_wild&&e.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-red-600 text-white text-xs rounded",children:"Exploited in Wild"})]})]})},s.id))}),c==="overview"&&t&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Selected Project"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-3xl",children:o(t.ecosystem)}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold text-white",children:t.name}),e.jsx("p",{className:"text-gray-400",children:t.ecosystem})]})]}),t.repository_url&&e.jsxs("a",{href:t.repository_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-cyan-400 hover:underline",children:[e.jsx(U,{className:"h-4 w-4"}),t.repository_url]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{className:"bg-gray-700 rounded p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:t.total_dependencies}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Dependencies"})]}),e.jsxs("div",{className:"bg-gray-700 rounded p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:t.vulnerable_dependencies}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Vulnerable"})]}),e.jsxs("div",{className:"bg-gray-700 rounded p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:t.license_issues}),e.jsx("div",{className:"text-gray-400 text-sm",children:"License Issues"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Recent Vulnerabilities"}),e.jsx("div",{className:"space-y-3",children:h.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 rounded p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs text-white ${N(s.severity)}`,children:s.severity.toUpperCase()}),e.jsx("span",{className:"text-white",children:s.vuln_id})]}),s.cvss_score&&e.jsxs("span",{className:"text-gray-300",children:["CVSS: ",s.cvss_score]})]},s.id))})]})]})]})]})})};export{Y as default};
