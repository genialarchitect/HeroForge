import{b as J,u as b,d as R,j as e}from"./vendor-state-DdX3IZQk.js";import{r as x}from"./vendor-react-Da1CiaFS.js";import{S as P,aR as p,z as M,a9 as f,h as S,a4 as Y,P as N,aH as D,E as W,aD as q,aF as C,B as v,m as X,at as Z,T as ee,b1 as te,u as se,a2 as ae,d as re,aI as le,aN as ne,n as ie}from"./vendor-ui-wM19Qo8C.js";import{d as ce,ad as u}from"./index-lpqdgxD1.js";import"./vendor-charts-CCbxmwBt.js";function w({status:r}){const l={pending:"bg-yellow-900/50 text-yellow-300 border border-yellow-700",running:"bg-cyan-900/50 text-cyan-300 border border-cyan-700",completed:"bg-green-900/50 text-green-300 border border-green-700",failed:"bg-red-900/50 text-red-300 border border-red-700",in_progress:"bg-blue-900/50 text-blue-300 border border-blue-700",draft:"bg-gray-700 text-gray-300 border border-gray-600",approved:"bg-green-900/50 text-green-300 border border-green-700",rejected:"bg-red-900/50 text-red-300 border border-red-700"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${l[r]||l.pending}`,children:r.charAt(0).toUpperCase()+r.slice(1).replace("_"," ")})}function B({severity:r}){const l={critical:"bg-red-900/50 text-red-300 border border-red-700",high:"bg-orange-900/50 text-orange-300 border border-orange-700",medium:"bg-yellow-900/50 text-yellow-300 border border-yellow-700",low:"bg-blue-900/50 text-blue-300 border border-blue-700",info:"bg-gray-700 text-gray-300 border border-gray-600"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${l[r]||l.info}`,children:r.charAt(0).toUpperCase()+r.slice(1)})}function E({category:r}){const l={spoofing:"bg-purple-900/50 text-purple-300",tampering:"bg-red-900/50 text-red-300",repudiation:"bg-yellow-900/50 text-yellow-300",information_disclosure:"bg-blue-900/50 text-blue-300",denial_of_service:"bg-orange-900/50 text-orange-300",elevation_of_privilege:"bg-pink-900/50 text-pink-300"},i={spoofing:"Spoofing",tampering:"Tampering",repudiation:"Repudiation",information_disclosure:"Info Disclosure",denial_of_service:"DoS",elevation_of_privilege:"Priv Escalation"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${l[r]||"bg-gray-700 text-gray-300"}`,children:i[r]||r})}function de({data:r}){const l=[{label:"Mean Time to Remediate",value:`${r.mttr_days.toFixed(1)}d`,icon:e.jsx(Z,{className:"h-5 w-5 text-cyan-400"}),trend:r.mttr_trend},{label:"Vulnerability Density",value:`${r.vuln_density.toFixed(2)}/kLOC`,icon:e.jsx(q,{className:"h-5 w-5 text-orange-400"}),trend:r.vuln_density_trend},{label:"SLA Compliance",value:`${r.sla_compliance.toFixed(1)}%`,icon:e.jsx(ee,{className:"h-5 w-5 text-green-400"}),trend:r.sla_trend},{label:"Open Findings",value:r.open_findings,icon:e.jsx(P,{className:"h-5 w-5 text-red-400"}),subtext:`${r.critical_findings} critical`}];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:l.map(i=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"p-2 bg-gray-700 rounded-lg",children:i.icon}),i.trend!==void 0&&e.jsxs("div",{className:`flex items-center text-sm ${i.trend<0?"text-green-400":"text-red-400"}`,children:[i.trend<0?e.jsx(te,{className:"h-4 w-4 mr-1"}):e.jsx(se,{className:"h-4 w-4 mr-1"}),Math.abs(i.trend).toFixed(1),"%"]})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:i.label}),e.jsx("p",{className:"text-2xl font-bold text-white",children:i.value}),i.subtext&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:i.subtext})]},i.label))})}function oe({data:r}){var l,i;return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Findings by Category"}),e.jsxs("div",{className:"space-y-3",children:[(l=r.findings_by_category)==null?void 0:l.map(n=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-32 text-sm text-gray-400 truncate",children:n.category}),e.jsx("div",{className:"flex-1 h-6 bg-gray-700 rounded overflow-hidden",children:e.jsx("div",{className:"h-full bg-cyan-500 transition-all duration-300",style:{width:`${n.count/(r.total_findings||1)*100}%`}})}),e.jsx("div",{className:"w-12 text-right text-sm font-medium text-white",children:n.count})]},n.category)),(!r.findings_by_category||r.findings_by_category.length===0)&&e.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:"No findings data available"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"SLA Compliance by Severity"}),e.jsxs("div",{className:"space-y-3",children:[(i=r.sla_by_severity)==null?void 0:i.map(n=>{const d=n.compliance_rate;let c="bg-red-500";return d>=90?c="bg-green-500":d>=70?c="bg-yellow-500":d>=50&&(c="bg-orange-500"),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-20",children:e.jsx(B,{severity:n.severity})}),e.jsx("div",{className:"flex-1 h-6 bg-gray-700 rounded overflow-hidden",children:e.jsx("div",{className:`h-full ${c} transition-all duration-300`,style:{width:`${d}%`}})}),e.jsxs("div",{className:"w-16 text-right text-sm font-medium text-white",children:[d.toFixed(0),"%"]})]},n.severity)}),(!r.sla_by_severity||r.sla_by_severity.length===0)&&e.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:"No SLA data available"})]})]})]})}function xe({isOpen:r,onClose:l,onCreate:i}){const[n,d]=x.useState(""),[c,m]=x.useState(""),[o,h]=x.useState("git"),[s,a]=x.useState("");if(!r)return null;const y=g=>{g.preventDefault(),i({project_name:n,language:c,source_type:o,source_path:s}),d(""),m(""),h("git"),a(""),l()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Start SAST Scan"}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Project Name *"}),e.jsx("input",{type:"text",value:n,onChange:g=>d(g.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"my-web-app"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Language"}),e.jsxs("select",{value:c,onChange:g=>m(g.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"",children:"Auto-detect"}),e.jsx("option",{value:"javascript",children:"JavaScript/TypeScript"}),e.jsx("option",{value:"python",children:"Python"}),e.jsx("option",{value:"java",children:"Java"}),e.jsx("option",{value:"go",children:"Go"}),e.jsx("option",{value:"rust",children:"Rust"}),e.jsx("option",{value:"csharp",children:"C#"}),e.jsx("option",{value:"php",children:"PHP"}),e.jsx("option",{value:"ruby",children:"Ruby"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Source Type"}),e.jsxs("select",{value:o,onChange:g=>h(g.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"git",children:"Git Repository"}),e.jsx("option",{value:"path",children:"Local Path"}),e.jsx("option",{value:"upload",children:"Upload Archive"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:[o==="git"?"Repository URL":o==="path"?"Path":"Archive Path"," *"]}),e.jsx("input",{type:"text",value:s,onChange:g=>a(g.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:o==="git"?"https://github.com/org/repo":"/path/to/code"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:l,className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:"Start Scan"})]})]})]})})}function me({isOpen:r,onClose:l,onCreate:i}){const[n,d]=x.useState(""),[c,m]=x.useState("git"),[o,h]=x.useState("");if(!r)return null;const s=a=>{a.preventDefault(),i({name:n,source_type:c,source_path:o}),d(""),m("git"),h(""),l()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Generate SBOM"}),e.jsxs("form",{onSubmit:s,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Project Name *"}),e.jsx("input",{type:"text",value:n,onChange:a=>d(a.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"my-application"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Source Type"}),e.jsxs("select",{value:c,onChange:a=>m(a.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"git",children:"Git Repository"}),e.jsx("option",{value:"container",children:"Container Image"}),e.jsx("option",{value:"path",children:"Local Path"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:[c==="git"?"Repository URL":c==="container"?"Image Reference":"Path"," *"]}),e.jsx("input",{type:"text",value:o,onChange:a=>h(a.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:c==="git"?"https://github.com/org/repo":c==="container"?"nginx:latest":"/path/to/project"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:l,className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:"Generate"})]})]})]})})}function he({isOpen:r,onClose:l,onCreate:i}){const[n,d]=x.useState(""),[c,m]=x.useState(""),[o,h]=x.useState("");if(!r)return null;const s=a=>{a.preventDefault(),i({project_name:n,description:c,diagram_data:o||void 0}),d(""),m(""),h(""),l()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-lg border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Create Architecture Review"}),e.jsxs("form",{onSubmit:s,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Project Name *"}),e.jsx("input",{type:"text",value:n,onChange:a=>d(a.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"Payment Processing Service"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description *"}),e.jsx("textarea",{value:c,onChange:a=>m(a.target.value),required:!0,rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"Describe the system architecture and components..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Architecture Diagram (JSON/Mermaid)"}),e.jsx("textarea",{value:o,onChange:a=>h(a.target.value),rows:4,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white font-mono text-sm focus:outline-none focus:border-cyan-500",placeholder:"Paste diagram data or Mermaid syntax..."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:l,className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:"Create Review"})]})]})]})})}function ge({scanId:r,onBack:l}){const{data:i,isLoading:n}=b({queryKey:["sast-findings",r],queryFn:()=>u.getSastFindings(r).then(s=>s.data)}),[d,c]=x.useState(null),[m,o]=x.useState("all"),h=i==null?void 0:i.filter(s=>m==="all"||s.severity===m);return e.jsxs("div",{children:[e.jsxs("button",{onClick:l,className:"flex items-center gap-2 text-gray-400 hover:text-gray-200 mb-4",children:[e.jsx(C,{className:"w-4 h-4 rotate-180"}),"Back to Scans"]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"SAST Findings"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{value:m,onChange:s=>o(s.target.value),className:"px-3 py-1.5 bg-gray-700 border border-gray-600 rounded text-white text-sm focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})})]}),n?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(p,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):h&&h.length>0?e.jsx("div",{className:"space-y-3",children:h.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-700/50",onClick:()=>c(d===s.id?null:s.id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(B,{severity:s.severity}),e.jsx("span",{className:"text-white font-medium",children:s.rule_id})]}),e.jsx("p",{className:"text-gray-300",children:s.message}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ae,{className:"w-4 h-4"}),s.file_path,":",s.line_number]}),e.jsx("span",{children:s.category})]})]}),e.jsx(re,{className:`w-5 h-5 text-gray-400 transition-transform ${d===s.id?"rotate-180":""}`})]})}),d===s.id&&e.jsxs("div",{className:"border-t border-gray-700 p-4 bg-gray-900",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Code Snippet"}),e.jsx("pre",{className:"text-sm bg-gray-950 p-3 rounded overflow-x-auto text-gray-300",children:s.code_snippet||"No code snippet available"})]}),s.remediation&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Remediation"}),e.jsx("p",{className:"text-sm text-gray-300",children:s.remediation})]}),s.cwe_id&&e.jsx("div",{className:"mt-2",children:e.jsxs("a",{href:`https://cwe.mitre.org/data/definitions/${s.cwe_id}.html`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-cyan-400 hover:text-cyan-300 flex items-center gap-1",children:["CWE-",s.cwe_id,e.jsx(le,{className:"w-3 h-3"})]})})]})]},s.id))}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(D,{className:"w-16 h-16 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Findings"}),e.jsx("p",{className:"text-gray-400",children:"No security issues detected in this scan"})]})]})}function ue({projectId:r,projectName:l,onBack:i}){const{data:n,isLoading:d}=b({queryKey:["sbom-components",r],queryFn:()=>u.getSbomComponents(r).then(a=>a.data)}),[c,m]=x.useState(""),[o,h]=x.useState(!1),s=n==null?void 0:n.filter(a=>{const y=!c||a.name.toLowerCase().includes(c.toLowerCase())||a.version.toLowerCase().includes(c.toLowerCase()),g=!o||a.vulnerabilities&&a.vulnerabilities.length>0;return y&&g});return e.jsxs("div",{children:[e.jsxs("button",{onClick:i,className:"flex items-center gap-2 text-gray-400 hover:text-gray-200 mb-4",children:[e.jsx(C,{className:"w-4 h-4 rotate-180"}),"Back to Projects"]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:l}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Software Bill of Materials"})]}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-white rounded text-sm",children:[e.jsx(ne,{className:"w-4 h-4"}),"Export SBOM"]})]}),e.jsxs("div",{className:"flex gap-3 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:c,onChange:a=>m(a.target.value),placeholder:"Search components...",className:"w-full pl-10 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:a=>h(a.target.checked),className:"w-4 h-4 rounded bg-gray-700 border-gray-600 text-cyan-500 focus:ring-cyan-500"}),"Vulnerable only"]})]}),d?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(p,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):s&&s.length>0?e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Component"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Version"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"License"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Type"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Vulnerabilities"})]})}),e.jsx("tbody",{children:s.map(a=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-medium text-white",children:a.name}),a.purl&&e.jsx("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:a.purl})]}),e.jsx("td",{className:"p-4 text-gray-300 font-mono text-sm",children:a.version}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${a.license_risk==="high"?"bg-red-900/50 text-red-300":a.license_risk==="medium"?"bg-yellow-900/50 text-yellow-300":"bg-green-900/50 text-green-300"}`,children:a.license||"Unknown"})}),e.jsx("td",{className:"p-4 text-gray-400 text-sm",children:a.component_type}),e.jsx("td",{className:"p-4",children:a.vulnerabilities&&a.vulnerabilities.length>0?e.jsxs("span",{className:"flex items-center gap-1 text-red-400",children:[e.jsx(q,{className:"w-4 h-4"}),a.vulnerabilities.length]}):e.jsx("span",{className:"text-green-400",children:e.jsx(D,{className:"w-4 h-4"})})})]},a.id))})]})}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(f,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Components"}),e.jsx("p",{className:"text-gray-400",children:"No components found matching your criteria"})]})]})}function be({reviewId:r,projectName:l,onBack:i}){const{data:n,isLoading:d}=b({queryKey:["architecture-threats",r],queryFn:()=>u.getArchitectureThreats(r).then(s=>s.data)}),[c,m]=x.useState("all"),o=n==null?void 0:n.filter(s=>c==="all"||s.stride_category===c),h=n==null?void 0:n.reduce((s,a)=>(s[a.stride_category]=(s[a.stride_category]||0)+1,s),{});return e.jsxs("div",{children:[e.jsxs("button",{onClick:i,className:"flex items-center gap-2 text-gray-400 hover:text-gray-200 mb-4",children:[e.jsx(C,{className:"w-4 h-4 rotate-180"}),"Back to Reviews"]}),e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:l}),e.jsx("p",{className:"text-gray-400 text-sm",children:"STRIDE Threat Model"})]})}),h&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-3 mb-6",children:Object.entries(h).map(([s,a])=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-3 border border-gray-700 text-center cursor-pointer hover:bg-gray-700/50",onClick:()=>m(c===s?"all":s),children:[e.jsx(E,{category:s}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:a})]},s))}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-medium text-white",children:"Identified Threats"}),c!=="all"&&e.jsx("button",{onClick:()=>m("all"),className:"text-sm text-cyan-400 hover:text-cyan-300",children:"Clear Filter"})]}),d?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(p,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):o&&o.length>0?e.jsx("div",{className:"space-y-3",children:o.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{category:s.stride_category}),e.jsx(B,{severity:s.severity})]}),e.jsx(w,{status:s.status})]}),e.jsx("h4",{className:"text-white font-medium mb-1",children:s.title}),e.jsx("p",{className:"text-gray-400 text-sm mb-3",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Affected Component:"}),e.jsx("span",{className:"text-gray-300 ml-2",children:s.affected_component})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Attack Vector:"}),e.jsx("span",{className:"text-gray-300 ml-2",children:s.attack_vector})]})]}),s.mitigation&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-900 rounded",children:[e.jsx("span",{className:"text-sm font-medium text-gray-400",children:"Recommended Mitigation:"}),e.jsx("p",{className:"text-sm text-gray-300 mt-1",children:s.mitigation})]})]},s.id))}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(P,{className:"w-16 h-16 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Threats Identified"}),e.jsx("p",{className:"text-gray-400",children:"No threats found matching the current filter"})]})]})}function fe(){var O;const r=J(),[l,i]=x.useState("dashboard"),[n,d]=x.useState(!1),[c,m]=x.useState(!1),[o,h]=x.useState(!1),[s,a]=x.useState(null),[y,g]=x.useState(null),[_,k]=x.useState(null),{data:j,isLoading:$}=b({queryKey:["yellow-team-dashboard"],queryFn:()=>u.getDashboardOverview().then(t=>t.data)}),{data:A,isLoading:K}=b({queryKey:["sast-scans"],queryFn:()=>u.listSastScans().then(t=>t.data),enabled:l==="sast"}),{data:F}=b({queryKey:["sast-rules"],queryFn:()=>u.getSastRules().then(t=>t.data),enabled:l==="sast"}),{data:T,isLoading:I}=b({queryKey:["sbom-projects"],queryFn:()=>u.listSbomProjects().then(t=>t.data),enabled:l==="sbom"}),{data:L,isLoading:V}=b({queryKey:["architecture-reviews"],queryFn:()=>u.listArchitectureReviews().then(t=>t.data),enabled:l==="architecture"}),G=R({mutationFn:u.startSastScan,onSuccess:()=>{r.invalidateQueries({queryKey:["sast-scans"]}),r.invalidateQueries({queryKey:["yellow-team-dashboard"]}),v.success("SAST scan started")},onError:()=>v.error("Failed to start SAST scan")}),Q=R({mutationFn:u.generateSbom,onSuccess:()=>{r.invalidateQueries({queryKey:["sbom-projects"]}),v.success("SBOM generation started")},onError:()=>v.error("Failed to generate SBOM")}),U=R({mutationFn:u.createArchitectureReview,onSuccess:()=>{r.invalidateQueries({queryKey:["architecture-reviews"]}),v.success("Architecture review created")},onError:()=>v.error("Failed to create architecture review")}),z=[{id:"dashboard",label:"Dashboard",icon:e.jsx(X,{className:"w-4 h-4"})},{id:"sast",label:"SAST",icon:e.jsx(M,{className:"w-4 h-4"})},{id:"sbom",label:"SBOM",icon:e.jsx(f,{className:"w-4 h-4"})},{id:"architecture",label:"Architecture",icon:e.jsx(S,{className:"w-4 h-4"})}];return e.jsx(ce,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"h-8 w-8 text-yellow-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Yellow Team"}),e.jsx("p",{className:"text-gray-400",children:"DevSecOps & Security Architecture"})]})]})}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:z.map(t=>e.jsxs("button",{onClick:()=>{i(t.id),a(null),g(null),k(null)},className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${l===t.id?"border-cyan-500 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[t.icon,t.label]},t.id))})}),e.jsxs("div",{children:[l==="dashboard"&&e.jsx("div",{children:$?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(p,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):j?e.jsxs(e.Fragment,{children:[e.jsx(de,{data:j}),e.jsx(oe,{data:j}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Recent Activity"}),e.jsxs("div",{className:"space-y-3",children:[(O=j.recent_activity)==null?void 0:O.map((t,H)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"p-2 bg-gray-800 rounded",children:[t.type==="sast"&&e.jsx(M,{className:"w-4 h-4 text-cyan-400"}),t.type==="sbom"&&e.jsx(f,{className:"w-4 h-4 text-green-400"}),t.type==="architecture"&&e.jsx(S,{className:"w-4 h-4 text-purple-400"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-gray-300",children:t.message}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(t.timestamp).toLocaleString()})]}),e.jsx(w,{status:t.status})]},H)),(!j.recent_activity||j.recent_activity.length===0)&&e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent activity"})]})]})]}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(Y,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Data Available"}),e.jsx("p",{className:"text-gray-400",children:"Start a SAST scan or generate an SBOM to see metrics"})]})}),l==="sast"&&e.jsx("div",{children:s?e.jsx(ge,{scanId:s,onBack:()=>a(null)}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Static Application Security Testing"}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[(F==null?void 0:F.length)||0," rules available"]})]}),e.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(N,{className:"w-4 h-4"}),"Start Scan"]})]}),K?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(p,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):A&&A.length>0?e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Project"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Language"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Findings"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Date"}),e.jsx("th",{className:"text-right p-4 text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:A.map(t=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-medium text-white",children:t.project_name}),e.jsx("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:t.source_path})]}),e.jsx("td",{className:"p-4 text-gray-300",children:t.language||"Auto"}),e.jsx("td",{className:"p-4",children:e.jsx(w,{status:t.status})}),e.jsx("td",{className:"p-4",children:t.status==="completed"&&e.jsxs("div",{className:"flex items-center gap-2",children:[t.critical_count>0&&e.jsxs("span",{className:"text-red-400",children:[t.critical_count,"C"]}),t.high_count>0&&e.jsxs("span",{className:"text-orange-400",children:[t.high_count,"H"]}),t.medium_count>0&&e.jsxs("span",{className:"text-yellow-400",children:[t.medium_count,"M"]}),t.low_count>0&&e.jsxs("span",{className:"text-blue-400",children:[t.low_count,"L"]}),t.finding_count===0&&e.jsx(D,{className:"w-4 h-4 text-green-400"})]})}),e.jsx("td",{className:"p-4 text-gray-500 text-sm",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("button",{onClick:()=>a(t.id),className:"p-2 hover:bg-gray-700 rounded text-gray-400 hover:text-white",children:e.jsx(W,{className:"w-4 h-4"})})})]},t.id))})]})}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(M,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No SAST Scans"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Start scanning your source code for security vulnerabilities"}),e.jsxs("button",{onClick:()=>d(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(N,{className:"w-4 h-4"}),"Start First Scan"]})]})]})}),l==="sbom"&&e.jsx("div",{children:y?e.jsx(ue,{projectId:y.id,projectName:y.name,onBack:()=>g(null)}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Software Bill of Materials"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Track dependencies and component vulnerabilities"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(N,{className:"w-4 h-4"}),"Generate SBOM"]})]}),I?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(p,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):T&&T.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map(t=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700 hover:border-gray-600 cursor-pointer transition-colors",onClick:()=>g({id:t.id,name:t.name}),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"p-2 bg-gray-700 rounded",children:e.jsx(f,{className:"w-5 h-5 text-cyan-400"})}),e.jsx(w,{status:t.status})]}),e.jsx("h3",{className:"font-medium text-white mb-1",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:t.source_type}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-400",children:[t.component_count," components"]}),t.vulnerable_count>0&&e.jsxs("span",{className:"text-red-400 flex items-center gap-1",children:[e.jsx(q,{className:"w-4 h-4"}),t.vulnerable_count]})]})]},t.id))}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(f,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No SBOM Projects"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Generate SBOMs to track your software dependencies"}),e.jsxs("button",{onClick:()=>m(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(N,{className:"w-4 h-4"}),"Generate First SBOM"]})]})]})}),l==="architecture"&&e.jsx("div",{children:_?e.jsx(be,{reviewId:_.id,projectName:_.name,onBack:()=>k(null)}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Architecture Reviews"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"STRIDE threat modeling and security architecture analysis"})]}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(N,{className:"w-4 h-4"}),"New Review"]})]}),V?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(p,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):L&&L.length>0?e.jsx("div",{className:"space-y-3",children:L.map(t=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700 hover:border-gray-600 cursor-pointer transition-colors",onClick:()=>k({id:t.id,name:t.project_name}),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-700 rounded",children:e.jsx(S,{className:"w-5 h-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-white",children:t.project_name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500",children:[e.jsx("span",{children:new Date(t.created_at).toLocaleDateString()}),e.jsxs("span",{children:[t.threat_count," threats identified"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{status:t.status}),e.jsx(C,{className:"w-5 h-5 text-gray-400"})]})]})},t.id))}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(S,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Architecture Reviews"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Create architecture reviews with STRIDE threat modeling"}),e.jsxs("button",{onClick:()=>h(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(N,{className:"w-4 h-4"}),"Create First Review"]})]})]})})]}),e.jsx(xe,{isOpen:n,onClose:()=>d(!1),onCreate:t=>G.mutate(t)}),e.jsx(me,{isOpen:c,onClose:()=>m(!1),onCreate:t=>Q.mutate(t)}),e.jsx(he,{isOpen:o,onClose:()=>h(!1),onCreate:t=>U.mutate(t)})]})})}export{fe as default};
