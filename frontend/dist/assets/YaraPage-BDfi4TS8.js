import{j as e,u as C,b as F,d as f}from"./vendor-state-DdX3IZQk.js";import{r as x}from"./vendor-react-Da1CiaFS.js";import{S as ee,ab as se,a8 as T,x as Y,G as D,m as $,aJ as j,az as q,_ as te,B as g,P as V,E as z,aI as E,ai as S,Z as ae,at as G,ay as U,bf as I,aj as le,aF as re,bb as X,al as ne}from"./vendor-ui-Bpofv04e.js";import{d as ie,a5 as u}from"./index-BFR8FZnv.js";import"./vendor-charts-DIEgeIZG.js";const b={getStats:()=>u.get("/detection/yara/rules/stats").then(s=>s.data),getCategories:()=>u.get("/detection/yara/rules/categories").then(s=>s.data),listRules:s=>u.get("/detection/yara/rules",{params:s}).then(t=>t.data),createRule:s=>u.post("/detection/yara/rules",s).then(t=>t.data),getRule:s=>u.get(`/detection/yara/rules/${s}`).then(t=>t.data),updateRule:(s,t)=>u.put(`/detection/yara/rules/${s}`,t).then(a=>a.data),deleteRule:s=>u.delete(`/detection/yara/rules/${s}`),buildRule:s=>u.post("/detection/yara/rules/build",s).then(t=>t.data),validateRule:s=>u.post("/detection/yara/validate",{rule_content:s}).then(t=>t.data),scanPath:s=>u.post("/detection/yara/scan",s).then(t=>t.data),bulkScan:s=>u.post("/detection/yara/scan/bulk",s).then(t=>t.data),listScans:()=>u.get("/detection/yara/scans").then(s=>s.data),getScan:s=>u.get(`/detection/yara/scans/${s}`).then(t=>t.data),deleteScan:s=>u.delete(`/detection/yara/scans/${s}`),getCommunitySourcesList:()=>u.get("/detection/yara/community/sources").then(s=>s.data),fetchFromCommunity:s=>u.post(`/detection/yara/community/fetch/${s}`).then(t=>t.data),importRules:s=>u.post("/detection/yara/rules/import",s).then(t=>t.data)},B={pending:{bg:"bg-yellow-500/20",text:"text-yellow-400"},running:{bg:"bg-blue-500/20",text:"text-blue-400"},completed:{bg:"bg-green-500/20",text:"text-green-400"},failed:{bg:"bg-red-500/20",text:"text-red-400"}},Q={malware:{bg:"bg-red-500/20",text:"text-red-400"},ransomware:{bg:"bg-red-600/20",text:"text-red-300"},apt:{bg:"bg-purple-500/20",text:"text-purple-400"},packer:{bg:"bg-orange-500/20",text:"text-orange-400"},webshell:{bg:"bg-yellow-500/20",text:"text-yellow-400"},exploit:{bg:"bg-pink-500/20",text:"text-pink-400"},miner:{bg:"bg-cyan-500/20",text:"text-cyan-400"},rat:{bg:"bg-violet-500/20",text:"text-violet-400"},backdoor:{bg:"bg-rose-500/20",text:"text-rose-400"},generic:{bg:"bg-gray-500/20",text:"text-gray-400"},custom:{bg:"bg-blue-500/20",text:"text-blue-400"}};function Z({status:s}){const t=B[s.toLowerCase()]||B.pending,a=s==="completed"?q:s==="failed"?U:s==="running"?j:ne;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ${t.bg} ${t.text}`,children:[e.jsx(a,{className:`h-3 w-3 ${s==="running"?"animate-spin":""}`}),s]})}function L({category:s}){const t=Q[s.toLowerCase()]||Q.generic;return e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${t.bg} ${t.text}`,children:s})}function ce(){const{data:s,isLoading:t}=C({queryKey:["yara","stats"],queryFn:b.getStats});return t?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(j,{className:"h-8 w-8 animate-spin text-cyan-400"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-cyan-500/20 rounded-lg",children:e.jsx(T,{className:"h-5 w-5 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:(s==null?void 0:s.total_rules)||0}),e.jsx("p",{className:"text-sm text-gray-400",children:"Total Rules"})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(q,{className:"h-5 w-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:(s==null?void 0:s.enabled_rules)||0}),e.jsx("p",{className:"text-sm text-gray-400",children:"Enabled"})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx($,{className:"h-5 w-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:(s==null?void 0:s.total_scans)||0}),e.jsx("p",{className:"text-sm text-gray-400",children:"Total Scans"})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/20 rounded-lg",children:e.jsx(te,{className:"h-5 w-5 text-red-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:(s==null?void 0:s.total_matches)||0}),e.jsx("p",{className:"text-sm text-gray-400",children:"Matches Found"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Rules by Category"}),e.jsxs("div",{className:"space-y-2",children:[(s==null?void 0:s.by_category)&&Object.entries(s.by_category).map(([a,d])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(L,{category:a}),e.jsx("span",{className:"text-gray-300",children:d})]},a)),(!(s!=null&&s.by_category)||Object.keys(s.by_category).length===0)&&e.jsx("p",{className:"text-gray-500 text-sm",children:"No rules yet"})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Rules by Source"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Built-in Rules"}),e.jsx("span",{className:"text-cyan-400 font-semibold",children:(s==null?void 0:s.builtin_rules)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-300",children:"Custom Rules"}),e.jsx("span",{className:"text-green-400 font-semibold",children:(s==null?void 0:s.custom_rules)||0})]})]})]})]})]})}function de(){const s=F(),[t,a]=x.useState(""),[d,r]=x.useState(""),[h,m]=x.useState(!1),[o,n]=x.useState(null),[i,N]=x.useState(!1),{data:k,isLoading:A}=C({queryKey:["yara","rules",{category:d,search:t}],queryFn:()=>b.listRules({...d&&{category:d},...t&&{search:t}})}),{data:R}=C({queryKey:["yara","categories"],queryFn:b.getCategories}),w=f({mutationFn:b.deleteRule,onSuccess:()=>{g.success("Rule deleted"),s.invalidateQueries({queryKey:["yara"]})},onError:()=>g.error("Failed to delete rule")}),P=f({mutationFn:({id:c,enabled:_})=>b.updateRule(c,{enabled:_}),onSuccess:()=>{s.invalidateQueries({queryKey:["yara"]})}}),v=(k==null?void 0:k.filter(c=>!(t&&!c.name.toLowerCase().includes(t.toLowerCase()))))||[];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search rules...",value:t,onChange:c=>a(c.target.value),className:"pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs("select",{value:d,onChange:c=>r(c.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"",children:"All Categories"}),R==null?void 0:R.map(c=>e.jsx("option",{value:c,children:c},c))]})]}),e.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(V,{className:"h-4 w-4"}),"Add Rule"]})]}),A?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(j,{className:"h-8 w-8 animate-spin text-cyan-400"})}):v.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(T,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No YARA rules found"})]}):e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Matches"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-400 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:v.map(c=>e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:c.name}),c.description&&e.jsx("p",{className:"text-gray-400 text-sm truncate max-w-xs",children:c.description})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(L,{category:c.category||"generic"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${c.is_builtin?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400"}`,children:c.is_builtin?"Built-in":"Custom"})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:c.match_count}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>P.mutate({id:c.id,enabled:!c.enabled}),className:`text-xs px-2 py-0.5 rounded ${c.enabled?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:c.enabled?"Enabled":"Disabled"})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>{n(c),N(!0)},className:"p-1 text-gray-400 hover:text-white",title:"View",children:e.jsx(z,{className:"h-4 w-4"})}),!c.is_builtin&&e.jsx("button",{onClick:()=>w.mutate(c.id),className:"p-1 text-gray-400 hover:text-red-400",title:"Delete",children:e.jsx(E,{className:"h-4 w-4"})})]})})]},c.id))})]})}),h&&e.jsx(he,{onClose:()=>m(!1)}),i&&o&&e.jsx(ge,{rule:o,onClose:()=>N(!1)})]})}function xe(){const[s,t]=x.useState(""),[a,d]=x.useState(""),[r,h]=x.useState([]),[m,o]=x.useState(""),[n,i]=x.useState([]),[N,k]=x.useState("any"),[A,R]=x.useState(""),[w,P]=x.useState(""),[v,c]=x.useState(null),_=f({mutationFn:b.buildRule,onSuccess:l=>{P(l.rule_content),c(l.validation),l.validation.is_valid?g.success("Rule generated successfully"):g.warning("Rule has validation warnings")},onError:()=>g.error("Failed to build rule")}),O=()=>{i([...n,{identifier:`str${n.length+1}`,string_type:"text",value:"",modifiers:{nocase:!1,wide:!1,ascii:!0,fullword:!1,xor:!1,base64:!1}}])},M=(l,y)=>{const p=[...n];p[l]={...p[l],...y},i(p)},H=l=>{i(n.filter((y,p)=>p!==l))},K=()=>{m&&!r.includes(m)&&(h([...r,m]),o(""))},J=()=>{if(!s||n.length===0){g.error("Please provide a name and at least one string");return}_.mutate({name:s,description:a||void 0,tags:r,metadata:[],strings:n,condition:{condition_type:N,custom_condition:N==="custom"?A:void 0}})};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Rule Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Rule Name *"}),e.jsx("input",{type:"text",value:s,onChange:l=>t(l.target.value),placeholder:"e.g., Detect_Malware_XYZ",className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("textarea",{value:a,onChange:l=>d(l.target.value),placeholder:"Describe what this rule detects...",rows:2,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Tags"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:m,onChange:l=>o(l.target.value),onKeyPress:l=>l.key==="Enter"&&K(),placeholder:"Add tag...",className:"flex-1 px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white"}),e.jsx("button",{onClick:K,className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg",children:"Add"})]}),r.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:r.map(l=>e.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 bg-cyan-500/20 text-cyan-400 rounded text-sm",children:[l,e.jsx("button",{onClick:()=>h(r.filter(y=>y!==l)),children:e.jsx(S,{className:"h-3 w-3"})})]},l))})]})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Strings"}),e.jsxs("button",{onClick:O,className:"flex items-center gap-1 px-2 py-1 bg-cyan-600 hover:bg-cyan-700 text-white rounded text-sm",children:[e.jsx(V,{className:"h-3 w-3"})," Add String"]})]}),e.jsxs("div",{className:"space-y-4",children:[n.map((l,y)=>e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{type:"text",value:l.identifier,onChange:p=>M(y,{identifier:p.target.value}),placeholder:"$identifier",className:"w-24 px-2 py-1 bg-gray-800 border border-gray-600 rounded text-white text-sm"}),e.jsxs("select",{value:l.string_type,onChange:p=>M(y,{string_type:p.target.value}),className:"px-2 py-1 bg-gray-800 border border-gray-600 rounded text-white text-sm",children:[e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"hex",children:"Hex"}),e.jsx("option",{value:"regex",children:"Regex"})]}),e.jsx("button",{onClick:()=>H(y),className:"ml-auto p-1 text-gray-400 hover:text-red-400",children:e.jsx(E,{className:"h-4 w-4"})})]}),e.jsx("input",{type:"text",value:l.value,onChange:p=>M(y,{value:p.target.value}),placeholder:l.string_type==="hex"?"{ 4D 5A 90 00 }":"Enter string value...",className:"w-full px-2 py-1 bg-gray-800 border border-gray-600 rounded text-white text-sm mb-2"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["nocase","wide","ascii","fullword","xor","base64"].map(p=>e.jsxs("label",{className:"flex items-center gap-1 text-xs text-gray-400",children:[e.jsx("input",{type:"checkbox",checked:l.modifiers[p],onChange:W=>M(y,{modifiers:{...l.modifiers,[p]:W.target.checked}}),className:"rounded border-gray-600"}),p]},p))})]},y)),n.length===0&&e.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:'No strings defined. Click "Add String" to begin.'})]})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Condition"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("select",{value:N,onChange:l=>k(l.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"any",children:"Any of them"}),e.jsx("option",{value:"all",children:"All of them"}),e.jsx("option",{value:"count",children:"At least N matches"}),e.jsx("option",{value:"custom",children:"Custom condition"})]}),N==="custom"&&e.jsx("input",{type:"text",value:A,onChange:l=>R(l.target.value),placeholder:"e.g., $str1 and ($str2 or $str3)",className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white"})]})]}),e.jsxs("button",{onClick:J,disabled:_.isPending,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-cyan-600 hover:bg-cyan-700 disabled:bg-cyan-800 text-white rounded-lg transition-colors",children:[_.isPending?e.jsx(j,{className:"h-5 w-5 animate-spin"}):e.jsx(ae,{className:"h-5 w-5"}),"Generate Rule"]})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Generated Rule"}),w&&e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(w),g.success("Copied to clipboard")},className:"flex items-center gap-1 px-2 py-1 bg-gray-700 hover:bg-gray-600 text-white rounded text-sm",children:[e.jsx(G,{className:"h-3 w-3"})," Copy"]})]}),w?e.jsxs(e.Fragment,{children:[e.jsx("pre",{className:"bg-gray-900 p-4 rounded-lg overflow-x-auto text-sm text-gray-300 font-mono",children:w}),v&&e.jsxs("div",{className:"mt-4 space-y-2",children:[v.is_valid?e.jsxs("div",{className:"flex items-center gap-2 text-green-400",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx("span",{children:"Rule is valid"})]}):e.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx("span",{children:"Rule has errors"})]}),v.errors.map((l,y)=>e.jsx("p",{className:"text-red-400 text-sm",children:l},y)),v.warnings.map((l,y)=>e.jsx("p",{className:"text-yellow-400 text-sm",children:l},y))]})]}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Y,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:'Fill in the form and click "Generate Rule"'})]})]})]})})}function oe(){const s=F(),[t,a]=x.useState(""),[d,r]=x.useState(!1),{data:h,isLoading:m}=C({queryKey:["yara","community","sources"],queryFn:b.getCommunitySourcesList}),o=f({mutationFn:b.fetchFromCommunity,onSuccess:i=>{g.success(`Fetched ${i.rules_fetched} rules`),s.invalidateQueries({queryKey:["yara"]})},onError:()=>g.error("Failed to fetch rules")}),n=f({mutationFn:b.importRules,onSuccess:i=>{g.success(`Imported ${i.imported} rules, skipped ${i.skipped}`),i.errors.length>0&&i.errors.forEach(N=>g.warning(N)),s.invalidateQueries({queryKey:["yara"]}),r(!1),a("")},onError:()=>g.error("Failed to import rules")});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>r(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg",children:[e.jsx(I,{className:"h-4 w-4"}),"Import Rules"]})}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Community Sources"}),m?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(j,{className:"h-6 w-6 animate-spin text-cyan-400"})}):h&&h.length>0?e.jsx("div",{className:"grid gap-4",children:h.map(i=>e.jsx("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-cyan-500/20 rounded-lg",children:e.jsx(D,{className:"h-5 w-5 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:i.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:i.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"h-4 w-4"}),i.rules_count," rules"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"h-4 w-4"}),i.source_type]})]})]})]}),e.jsxs("button",{onClick:()=>o.mutate(i.id),disabled:o.isPending,className:"flex items-center gap-2 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 text-white rounded-lg text-sm",children:[o.isPending?e.jsx(j,{className:"h-4 w-4 animate-spin"}):e.jsx(re,{className:"h-4 w-4"}),"Fetch"]})]})},i.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(D,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No community sources configured"})]})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Import YARA Rules"}),e.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Paste YARA rules content"}),e.jsx("textarea",{value:t,onChange:i=>a(i.target.value),placeholder:'rule example { strings: $a = "test" condition: $a }',rows:12,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white font-mono text-sm"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>r(!1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg",children:"Cancel"}),e.jsxs("button",{onClick:()=>n.mutate({content:t,overwrite_existing:!1}),disabled:!t||n.isPending,className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 disabled:bg-cyan-800 text-white rounded-lg",children:[n.isPending?e.jsx(j,{className:"h-4 w-4 animate-spin"}):e.jsx(I,{className:"h-4 w-4"}),"Import"]})]})]})]})})]})}function me(){const s=F(),[t,a]=x.useState(!1),[d,r]=x.useState(null),{data:h,isLoading:m}=C({queryKey:["yara","scans"],queryFn:b.listScans,refetchInterval:5e3}),o=f({mutationFn:b.deleteScan,onSuccess:()=>{g.success("Scan deleted"),s.invalidateQueries({queryKey:["yara","scans"]})}});return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg",children:[e.jsx(X,{className:"h-4 w-4"}),"New Scan"]})}),m?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(j,{className:"h-8 w-8 animate-spin text-cyan-400"})}):h&&h.length>0?e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Target"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Files"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Matches"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Time"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-400 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:h.map(n=>e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-white font-medium",children:n.name||"Unnamed Scan"}),e.jsx("td",{className:"px-4 py-3 text-gray-300 truncate max-w-xs",children:n.target_path}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(Z,{status:n.status})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:n.files_scanned}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:n.matches_found>0?"text-red-400 font-semibold":"text-gray-400",children:n.matches_found})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(n.created_at).toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>r(n),className:"p-1 text-gray-400 hover:text-white",title:"View Details",children:e.jsx(z,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>o.mutate(n.id),className:"p-1 text-gray-400 hover:text-red-400",title:"Delete",children:e.jsx(E,{className:"h-4 w-4"})})]})})]},n.id))})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx($,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No YARA scans yet"}),e.jsx("button",{onClick:()=>a(!0),className:"mt-4 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg",children:"Start Your First Scan"})]}),t&&e.jsx(ue,{onClose:()=>a(!1)}),d&&e.jsx(pe,{scan:d,onClose:()=>r(null)})]})}function he({onClose:s}){const t=F(),[a,d]=x.useState(""),[r,h]=x.useState(""),[m,o]=x.useState("custom"),n=f({mutationFn:b.createRule,onSuccess:()=>{g.success("Rule created"),t.invalidateQueries({queryKey:["yara"]}),s()},onError:i=>g.error(i.message||"Failed to create rule")});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Create YARA Rule"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Rule Name"}),e.jsx("input",{type:"text",value:a,onChange:i=>d(i.target.value),placeholder:"e.g., Detect_Ransomware_LockBit",className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Category"}),e.jsxs("select",{value:m,onChange:i=>o(i.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"custom",children:"Custom"}),e.jsx("option",{value:"malware",children:"Malware"}),e.jsx("option",{value:"ransomware",children:"Ransomware"}),e.jsx("option",{value:"apt",children:"APT"}),e.jsx("option",{value:"packer",children:"Packer"}),e.jsx("option",{value:"webshell",children:"Webshell"}),e.jsx("option",{value:"exploit",children:"Exploit"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Rule Content"}),e.jsx("textarea",{value:r,onChange:i=>h(i.target.value),placeholder:`rule example {
  strings:
    $a = "malicious"
  condition:
    $a
}`,rows:12,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white font-mono text-sm"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg",children:"Cancel"}),e.jsxs("button",{onClick:()=>n.mutate({name:a,rule_text:r,category:m}),disabled:!a||!r||n.isPending,className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 disabled:bg-cyan-800 text-white rounded-lg",children:[n.isPending&&e.jsx(j,{className:"h-4 w-4 animate-spin"}),"Create Rule"]})]})]})]})})}function ge({rule:s,onClose:t}){return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-3xl max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.name}),e.jsx(L,{category:s.category}),s.is_builtin&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded",children:"Built-in"})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto max-h-[60vh]",children:[s.description&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("p",{className:"text-gray-300",children:s.description})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-gray-400",children:["Match Count: ",e.jsx("span",{className:"text-white",children:s.match_count})]}),e.jsxs("span",{className:"text-gray-400",children:["Created: ",e.jsx("span",{className:"text-white",children:new Date(s.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm text-gray-400",children:"Rule Content"}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(s.rule_text),g.success("Copied to clipboard")},className:"flex items-center gap-1 px-2 py-1 bg-gray-700 hover:bg-gray-600 text-white rounded text-xs",children:[e.jsx(G,{className:"h-3 w-3"})," Copy"]})]}),e.jsx("pre",{className:"bg-gray-900 p-4 rounded-lg overflow-x-auto text-sm text-gray-300 font-mono",children:s.rule_text})]}),s.tags&&s.tags.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map(a=>e.jsx("span",{className:"px-2 py-1 bg-cyan-500/20 text-cyan-400 rounded text-sm",children:a},a))})]})]})]})})}function ue({onClose:s}){const t=F(),[a,d]=x.useState(""),[r,h]=x.useState(!0),m=f({mutationFn:b.scanPath,onSuccess:()=>{g.success("Scan started"),t.invalidateQueries({queryKey:["yara","scans"]}),s()},onError:o=>g.error(o.message||"Failed to start scan")});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"New YARA Scan"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Target Path"}),e.jsx("input",{type:"text",value:a,onChange:o=>d(o.target.value),placeholder:"/path/to/scan",className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:o=>h(o.target.checked),className:"rounded border-gray-600"}),"Scan recursively"]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg",children:"Cancel"}),e.jsxs("button",{onClick:()=>m.mutate({path:a,recursive:r}),disabled:!a||m.isPending,className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 disabled:bg-cyan-800 text-white rounded-lg",children:[m.isPending?e.jsx(j,{className:"h-4 w-4 animate-spin"}):e.jsx(X,{className:"h-4 w-4"}),"Start Scan"]})]})]})]})})}function pe({scan:s,onClose:t}){const{data:a,isLoading:d}=C({queryKey:["yara","scan",s.id],queryFn:()=>b.getScan(s.id)});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-3xl max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.name||"Scan Details"}),e.jsx(Z,{status:s.status})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto max-h-[60vh]",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Target:"}),e.jsx("p",{className:"text-white",children:s.target_path})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Rules Used:"}),e.jsx("p",{className:"text-white",children:s.rules_used})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Files Scanned:"}),e.jsx("p",{className:"text-white",children:s.files_scanned})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Matches Found:"}),e.jsx("p",{className:s.matches_found>0?"text-red-400 font-semibold":"text-white",children:s.matches_found})]})]}),s.error_message&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-3",children:e.jsx("p",{className:"text-red-400 text-sm",children:s.error_message})}),d?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(j,{className:"h-6 w-6 animate-spin text-cyan-400"})}):a!=null&&a.matches&&a.matches.length>0?e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Matches"}),e.jsx("div",{className:"space-y-2",children:a.matches.map((r,h)=>e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-cyan-400 font-medium",children:r.rule_name}),e.jsx("span",{className:"text-gray-400 text-xs",children:new Date(r.matched_at).toLocaleString()})]}),r.file_path&&e.jsx("p",{className:"text-gray-300 text-sm truncate",children:r.file_path}),r.matched_strings&&r.matched_strings.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-gray-400 text-xs",children:"Matched Strings:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:r.matched_strings.map((m,o)=>e.jsx("span",{className:"px-1.5 py-0.5 bg-gray-800 text-gray-300 rounded text-xs font-mono",children:m},o))})]})]},h))})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(q,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No matches found"})]})]})]})})}function ve(){const[s,t]=x.useState("dashboard"),a=[{id:"dashboard",label:"Dashboard",icon:e.jsx(se,{className:"h-4 w-4"})},{id:"rules",label:"Rules",icon:e.jsx(T,{className:"h-4 w-4"})},{id:"builder",label:"Visual Builder",icon:e.jsx(Y,{className:"h-4 w-4"})},{id:"community",label:"Community",icon:e.jsx(D,{className:"h-4 w-4"})},{id:"scans",label:"Scans",icon:e.jsx($,{className:"h-4 w-4"})}];return e.jsx(ie,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-cyan-500/20 rounded-lg",children:e.jsx(ee,{className:"h-6 w-6 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"YARA Rule Management"}),e.jsx("p",{className:"text-gray-400",children:"Create, manage, and scan with YARA detection rules"})]})]})}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("div",{className:"flex gap-1",children:a.map(d=>e.jsxs("button",{onClick:()=>t(d.id),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors border-b-2 -mb-px ${s===d.id?"border-cyan-500 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[d.icon,d.label]},d.id))})}),e.jsxs("div",{children:[s==="dashboard"&&e.jsx(ce,{}),s==="rules"&&e.jsx(de,{}),s==="builder"&&e.jsx(xe,{}),s==="community"&&e.jsx(oe,{}),s==="scans"&&e.jsx(me,{})]})]})})}export{ve as default};
