import{j as e}from"./vendor-state-DdX3IZQk.js";import{r,R as re}from"./vendor-react-Da1CiaFS.js";import{e as ts,C as B,L as ee,I as J,b as E,a as Pe,B as oe,g as _e,t as Je,s as qe,c as Fs,n as ye,h as Me,i as Le,j as Be,m as ss,k as cs,l as He,o as We,p as Ue,q as pt,v as ve,u as Ne,w as Ie,x as ke,y as Ce,z as Fe,A as we,d as gt}from"./index-CEs23Zco.js";import{B as l,U as xs,S as ue,b0 as ns,M as De,az as Ae,a as Ze,aD as ge,l as Ds,d as Ye,aF as ft,be as jt,bf as bt,J as yt,aQ as le,bg as Ts,at as fe,T as Rs,P as ie,aq as je,ay as Ms,bb as be,bh as Ls,ae as fs,bi as Us,am as as,aH as me,aY as vt,F as Ee,aw as js,G as bs,j as is,Z as Nt,as as rs,bj as us,V as wt,n as Os,aB as he,av as _t,bk as $s,aA as kt,aI as es,aK as Ge,ax as zs,bl as $e,x as Se,N as hs,bm as Ns,aN as Gs,K as Xe,h as Vs,Q as qs,a4 as Ve,bn as Bs,aR as ze,X as Hs,aE as ws,bo as Ct,E as Ws,A as _s,i as St,af as os,q as Et,aG as Te,bp as Qs,bq as At,au as Js,R as Ks,br as Pt,aT as It,bs as Ft,bt as ys,bu as Dt,w as Tt}from"./vendor-ui-B6SJ_7kK.js";import{S as Rt}from"./ScanComparison-Dx_O2ge-.js";import"./vendor-charts-gFVtv0RJ.js";const Mt=()=>{var T;const[o,F]=r.useState(null),[_,h]=r.useState(!0),[y,b]=r.useState(!1),[N,L]=r.useState(!1),[t,a]=r.useState(""),[s,n]=r.useState(!1),[m,p]=r.useState(""),[c,D]=r.useState(""),[A,q]=r.useState("");r.useEffect(()=>{g()},[]);const g=async()=>{h(!0);try{const P=await ts.me();F(P.data),a(P.data.email||"")}catch(P){l.error("Failed to load profile"),console.error(P)}finally{h(!1)}},C=async P=>{var z,M;if(P.preventDefault(),!t.trim()){l.error("Email is required");return}b(!0);try{const U=await ts.updateProfile({email:t.trim()});F(U.data),l.success("Profile updated successfully")}catch(U){const w=U;l.error(((M=(z=w.response)==null?void 0:z.data)==null?void 0:M.error)||"Failed to update profile")}finally{b(!1)}},S=async P=>{var z,M;if(P.preventDefault(),!m||!c){l.error("All password fields are required");return}if(c.length<6){l.error("New password must be at least 6 characters");return}if(c!==A){l.error("Passwords do not match");return}L(!0);try{await ts.changePassword({current_password:m,new_password:c}),l.success("Password changed successfully"),n(!1),p(""),D(""),q("")}catch(U){const w=U;l.error(((M=(z=w.response)==null?void 0:z.data)==null?void 0:M.error)||"Failed to change password")}finally{L(!1)}},x=P=>P?new Date(P).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"N/A";return _?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(xs,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Profile Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(xs,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Username"}),e.jsx("p",{className:"text-white font-medium",children:o==null?void 0:o.username})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(ue,{className:"h-5 w-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Roles"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:((T=o==null?void 0:o.roles)==null?void 0:T.map(P=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-primary/20 text-primary rounded capitalize",children:P},P)))||e.jsx("span",{className:"text-slate-400",children:"No roles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(ns,{className:"h-5 w-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Member Since"}),e.jsx("p",{className:"text-white",children:x(o==null?void 0:o.created_at)})]})]})]}),e.jsx("form",{onSubmit:C,className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-2",children:[e.jsx(De,{className:"h-4 w-4"}),"Email Address"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(J,{type:"email",value:t,onChange:P=>a(P.target.value),placeholder:"your@email.com",className:"flex-1"}),e.jsxs(E,{type:"submit",variant:"primary",loading:y,disabled:y||t===(o==null?void 0:o.email),children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Save"]})]})]})})]}),e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ze,{className:"h-6 w-6 text-yellow-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Security"})]}),!s&&e.jsx(E,{variant:"secondary",onClick:()=>n(!0),children:"Change Password"})]}),s?e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsx(J,{label:"Current Password",type:"password",value:m,onChange:P=>p(P.target.value),placeholder:"Enter current password"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(J,{label:"New Password",type:"password",value:c,onChange:P=>D(P.target.value),placeholder:"Enter new password"}),e.jsx(J,{label:"Confirm New Password",type:"password",value:A,onChange:P=>q(P.target.value),placeholder:"Confirm new password"})]}),c&&A&&c!==A&&e.jsx("p",{className:"text-sm text-red-400",children:"Passwords do not match"}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:()=>{n(!1),p(""),D(""),q("")},children:"Cancel"}),e.jsx(E,{type:"submit",variant:"primary",loading:N,disabled:N||!m||!c||c!==A,children:"Update Password"})]})]}):e.jsx("p",{className:"text-slate-400",children:"Keep your account secure by using a strong, unique password."})]}),e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(ue,{className:"h-6 w-6 text-green-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Account Status"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${(o==null?void 0:o.is_active)!==!1?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-white",children:(o==null?void 0:o.is_active)!==!1?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Your account is in good standing."})]})]})},Lt=[{id:"admin",name:"Admin",description:"Full system access"},{id:"user",name:"User",description:"Standard user access"},{id:"auditor",name:"Auditor",description:"Read-only access to all scans"},{id:"viewer",name:"Viewer",description:"Limited view access"}],Ut=()=>{const[o,F]=r.useState([]),[_,h]=r.useState([]),[y,b]=r.useState(!0),[N,L]=r.useState(!1),[t,a]=r.useState(new Set),[s,n]=r.useState(!1),[m,p]=r.useState(!0),[c,D]=r.useState(null),[A,q]=r.useState(!1);r.useEffect(()=>{g()},[]);const g=async()=>{var k;b(!0);try{const u=await Pe.getUsers();F(u.data),p(!0)}catch(u){((k=u.response)==null?void 0:k.status)===403?p(!1):l.error("Failed to load users"),console.error(u)}finally{b(!1)}},C=async()=>{L(!0);try{const k=await Pe.getAuditLogs({limit:50,offset:0});h(k.data.logs)}catch(k){l.error("Failed to load audit logs"),console.error(k)}finally{L(!1)}},S=k=>{const u=new Set(t);u.has(k)?u.delete(k):u.add(k),a(u)},x=async k=>{var u,R;try{await Pe.updateUser(k.id,{is_active:!k.is_active}),l.success(`User ${k.is_active?"deactivated":"activated"}`),g()}catch(j){const Y=j;l.error(((R=(u=Y.response)==null?void 0:u.data)==null?void 0:R.error)||"Failed to update user")}},T=async()=>{var k,u;if(c){q(!0);try{await Pe.deleteUser(c.id),l.success(`User "${c.username}" deleted successfully`),g(),D(null)}catch(R){const j=R;l.error(((u=(k=j.response)==null?void 0:k.data)==null?void 0:u.error)||"Failed to delete user")}finally{q(!1)}}},P=async(k,u)=>{var R,j;try{await Pe.assignRole(k,u),l.success("Role assigned"),g()}catch(Y){const X=Y;l.error(((j=(R=X.response)==null?void 0:R.data)==null?void 0:j.error)||"Failed to assign role")}},z=async(k,u)=>{var R,j;try{await Pe.removeRole(k,u),l.success("Role removed"),g()}catch(Y){const X=Y;l.error(((j=(R=X.response)==null?void 0:R.data)==null?void 0:j.error)||"Failed to remove role")}},M=async k=>{var u,R;try{await Pe.unlockUser(k.id),l.success(`Account "${k.username}" unlocked`),g()}catch(j){const Y=j;l.error(((R=(u=Y.response)==null?void 0:u.data)==null?void 0:R.error)||"Failed to unlock account")}},U=k=>new Date(k).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),w=k=>{switch(k){case"admin":return"bg-red-500/20 text-red-400 border-red-500/30";case"user":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"auditor":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"viewer":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return y?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):m?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ds,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"User Management"})]}),e.jsxs(oe,{variant:"status",type:"completed",children:[o.length," users"]})]}),e.jsx("div",{className:"space-y-3",children:o.map(k=>{const u=t.has(k.id),R=k.roles||[];return e.jsxs("div",{className:"bg-dark-bg rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>S(k.id),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"text-slate-400",children:u?e.jsx(Ye,{className:"h-4 w-4"}):e.jsx(ft,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${k.is_active!==!1?"bg-green-400":"bg-red-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:k.username}),e.jsx("p",{className:"text-sm text-slate-400",children:k.email})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex gap-1",children:R.map(j=>e.jsx("span",{className:`px-2 py-0.5 text-xs rounded border capitalize ${w(j)}`,children:j},j))}),k.is_locked&&e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded border bg-red-500/20 text-red-400 border-red-500/30 flex items-center gap-1",children:[e.jsx(Ze,{className:"h-3 w-3"}),"Locked"]}),e.jsx("span",{className:"text-xs text-slate-500",children:k.created_at?U(k.created_at):"N/A"})]})]}),u&&e.jsxs("div",{className:"border-t border-dark-border p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"Manage Roles"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:Lt.map(j=>{const Y=R.includes(j.id);return e.jsxs("button",{onClick:X=>{X.stopPropagation(),Y?z(k.id,j.id):P(k.id,j.id)},className:`p-3 rounded-lg border text-left transition-colors ${Y?"bg-primary/20 border-primary/50 text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-primary/30"}`,children:[e.jsx("p",{className:"font-medium text-sm capitalize",children:j.name}),e.jsx("p",{className:"text-xs opacity-75",children:j.description})]},j.id)})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-dark-border",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{variant:k.is_active!==!1?"secondary":"primary",size:"sm",onClick:j=>{j.stopPropagation(),x(k)},children:k.is_active!==!1?e.jsxs(e.Fragment,{children:[e.jsx(jt,{className:"h-4 w-4 mr-1"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(bt,{className:"h-4 w-4 mr-1"}),"Activate"]})}),k.is_locked&&e.jsxs(E,{variant:"primary",size:"sm",onClick:j=>{j.stopPropagation(),M(k)},children:[e.jsx(yt,{className:"h-4 w-4 mr-1"}),"Unlock Account"]})]}),e.jsxs(E,{variant:"secondary",size:"sm",onClick:j=>{j.stopPropagation(),D(k)},className:"text-red-400 hover:text-red-300 hover:bg-red-500/10","aria-label":`Delete user ${k.username}`,children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})]},k.id)})})]}),e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ts,{className:"h-6 w-6 text-purple-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Audit Logs"})]}),e.jsx(E,{variant:"secondary",onClick:()=>{n(!s),!s&&_.length===0&&C()},children:s?"Hide Logs":"Show Logs"})]}),s&&e.jsx(e.Fragment,{children:N?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ee,{})}):_.length===0?e.jsx("p",{className:"text-slate-400 text-center py-8",children:"No audit logs found"}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:_.map(k=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-dark-bg rounded-lg text-sm",children:[e.jsx(fe,{className:"h-4 w-4 text-slate-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium text-white",children:k.action}),k.target_type&&e.jsxs("span",{className:"text-slate-400",children:["on ",k.target_type]}),k.target_id&&e.jsx("span",{className:"text-xs text-slate-500 font-mono truncate max-w-32",children:k.target_id})]}),k.details&&e.jsx("p",{className:"text-xs text-slate-500 mt-1 truncate",children:k.details})]}),e.jsx("span",{className:"text-xs text-slate-500 whitespace-nowrap",children:U(k.created_at)})]},k.id))})}),!s&&e.jsx("p",{className:"text-slate-400",children:"View a log of administrative actions performed in the system."})]}),e.jsx(_e,{isOpen:!!c,onClose:()=>D(null),onConfirm:T,title:"Delete User",message:`Are you sure you want to delete user "${c==null?void 0:c.username}"? All their data, including scans and settings, will be permanently removed.`,confirmLabel:"Delete User",variant:"danger",loading:A})]}):e.jsx(B,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ge,{className:"h-12 w-12 text-yellow-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-slate-400",children:"You don't have permission to access the administration panel."}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Contact an administrator if you need elevated access."})]})})},ds=["#ef4444","#f97316","#eab308","#22c55e","#14b8a6","#3b82f6","#8b5cf6","#ec4899","#6366f1","#64748b"],Ot=()=>{const[o,F]=r.useState([]),[_,h]=r.useState(!0),[y,b]=r.useState(!1),[N,L]=r.useState(null),[t,a]=r.useState({name:"",description:"",targets:"",color:ds[0]}),[s,n]=r.useState(null),[m,p]=r.useState(!1);r.useEffect(()=>{c()},[]);const c=async()=>{h(!0);try{const S=await Je.getAll();F(S.data)}catch(S){l.error("Failed to load target groups"),console.error(S)}finally{h(!1)}},D=()=>{a({name:"",description:"",targets:"",color:ds[0]}),L(null),b(!1)},A=S=>{const x=JSON.parse(S.targets||"[]");a({name:S.name,description:S.description||"",targets:x.join(`
`),color:S.color}),L(S.id),b(!0)},q=async S=>{var T,P;S.preventDefault();const x=t.targets.split(`
`).map(z=>z.trim()).filter(z=>z.length>0);if(!t.name.trim()){l.error("Name is required");return}if(x.length===0){l.error("At least one target is required");return}try{N?(await Je.update(N,{name:t.name,description:t.description||void 0,targets:x,color:t.color}),l.success("Target group updated")):(await Je.create({name:t.name,description:t.description||void 0,targets:x,color:t.color}),l.success("Target group created")),D(),c()}catch(z){const M=z;l.error(((P=(T=M.response)==null?void 0:T.data)==null?void 0:P.error)||"Failed to save target group")}},g=async()=>{var S,x;if(s){p(!0);try{await Je.delete(s.id),l.success(`Target group "${s.name}" deleted`),c(),n(null)}catch(T){const P=T;l.error(((x=(S=P.response)==null?void 0:S.data)==null?void 0:x.error)||"Failed to delete")}finally{p(!1)}}},C=S=>{try{return JSON.parse(S||"[]")}catch{return[]}};return _?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Target Groups"})]}),!y&&e.jsxs(E,{variant:"primary",onClick:()=>b(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"New Group"]})]})}),y&&e.jsx(B,{children:e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:N?"Edit Target Group":"Create Target Group"}),e.jsx("button",{type:"button",onClick:D,className:"text-slate-400 hover:text-white",children:e.jsx(je,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:t.name,onChange:S=>a({...t,name:S.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Production Servers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Color"}),e.jsx("div",{className:"flex gap-2",children:ds.map(S=>e.jsx("button",{type:"button",onClick:()=>a({...t,color:S}),className:`w-8 h-8 rounded-full border-2 transition-all ${t.color===S?"border-white scale-110":"border-transparent"}`,style:{backgroundColor:S}},S))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:t.description,onChange:S=>a({...t,description:S.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Targets (one per line)"}),e.jsx("textarea",{value:t.targets,onChange:S=>a({...t,targets:S.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:5,placeholder:`192.168.1.0/24
10.0.0.1
example.com`})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:D,children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"primary",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),N?"Update":"Create"]})]})]})}),o.length===0&&!y?e.jsx(B,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ms,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No target groups yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create groups to organize your scan targets"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(S=>{const x=C(S.targets);return e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:S.color}}),e.jsx("h4",{className:"font-medium text-white",children:S.name})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>A(S),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",children:e.jsx(be,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>n(S),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete target group ${S.name}`,children:e.jsx(le,{className:"h-4 w-4"})})]})]}),S.description&&e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:S.description}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:[x.length," target",x.length!==1?"s":""]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[x.slice(0,5).map((T,P)=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-300 font-mono",children:T},P)),x.length>5&&e.jsxs("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-500",children:["+",x.length-5," more"]})]})]})]},S.id)})}),e.jsx(_e,{isOpen:!!s,onClose:()=>n(null),onConfirm:g,title:"Delete Target Group",message:`Are you sure you want to delete the target group "${s==null?void 0:s.name}"? Scheduled scans using this group will need to be updated.`,confirmLabel:"Delete Group",variant:"danger",loading:m})]})},ks={name:"",description:"",schedule_type:"daily",schedule_value:"02:00",targets:"",port_range_start:1,port_range_end:1e3,threads:100,enable_os_detection:!0,enable_service_detection:!0,enable_vuln_scan:!0,enable_enumeration:!1},Cs=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],$t=()=>{const[o,F]=r.useState([]),[_,h]=r.useState([]),[y,b]=r.useState(!0),[N,L]=r.useState(!1),[t,a]=r.useState(null),[s,n]=r.useState(ks),[m,p]=r.useState(0),[c,D]=r.useState(1),[A,q]=r.useState(null),[g,C]=r.useState(!1);r.useEffect(()=>{S()},[]);const S=async()=>{b(!0);try{const[u,R]=await Promise.all([qe.getAll(),Je.getAll()]);F(u.data),h(R.data)}catch(u){l.error("Failed to load scheduled scans"),console.error(u)}finally{b(!1)}},x=()=>{n(ks),a(null),L(!1),p(0),D(1)},T=u=>{const R=JSON.parse(u.config);if(n({name:u.name,description:u.description||"",schedule_type:u.schedule_type,schedule_value:u.schedule_value,targets:R.targets.join(`
`),port_range_start:R.port_range[0],port_range_end:R.port_range[1],threads:R.threads,enable_os_detection:R.enable_os_detection,enable_service_detection:R.enable_service_detection,enable_vuln_scan:R.enable_vuln_scan,enable_enumeration:R.enable_enumeration}),u.schedule_type==="weekly"){const j=u.schedule_value.split(" ");j.length>=2&&p(parseInt(j[1])||0)}else if(u.schedule_type==="monthly"){const j=u.schedule_value.split(" ");j.length>=2&&D(parseInt(j[1])||1)}a(u.id),L(!0)},P=()=>{const u=s.schedule_value.includes(":")?s.schedule_value:"02:00";switch(s.schedule_type){case"daily":return u;case"weekly":return`${u} ${m}`;case"monthly":return`${u} ${c}`;default:return u}},z=async u=>{var X,i;u.preventDefault();const R=s.targets.split(`
`).map($=>$.trim()).filter($=>$.length>0);if(!s.name.trim()){l.error("Name is required");return}if(R.length===0){l.error("At least one target is required");return}const j={targets:R,port_range:[s.port_range_start,s.port_range_end],threads:s.threads,enable_os_detection:s.enable_os_detection,enable_service_detection:s.enable_service_detection,enable_vuln_scan:s.enable_vuln_scan,enable_enumeration:s.enable_enumeration},Y=P();try{t?(await qe.update(t,{name:s.name,description:s.description||void 0,config:j,schedule_type:s.schedule_type,schedule_value:Y}),l.success("Scheduled scan updated")):(await qe.create({name:s.name,description:s.description||void 0,config:j,schedule_type:s.schedule_type,schedule_value:Y}),l.success("Scheduled scan created")),x(),S()}catch($){const V=$;l.error(((i=(X=V.response)==null?void 0:X.data)==null?void 0:i.error)||"Failed to save scheduled scan")}},M=async u=>{var R,j;try{await qe.update(u.id,{is_active:!u.is_active}),l.success(`Scheduled scan ${u.is_active?"paused":"activated"}`),S()}catch(Y){const X=Y;l.error(((j=(R=X.response)==null?void 0:R.data)==null?void 0:j.error)||"Failed to update")}},U=async()=>{var u,R;if(A){C(!0);try{await qe.delete(A.id),l.success(`Scheduled scan "${A.name}" deleted`),S(),q(null)}catch(j){const Y=j;l.error(((R=(u=Y.response)==null?void 0:u.data)==null?void 0:R.error)||"Failed to delete")}finally{C(!1)}}},w=u=>{const R=JSON.parse(u.targets||"[]");n(j=>({...j,targets:R.join(`
`)}))},k=u=>{const R=u.schedule_value.split(" "),j=R[0];switch(u.schedule_type){case"daily":return`Daily at ${j}`;case"weekly":return`Every ${Cs[parseInt(R[1])||0]} at ${j}`;case"monthly":return`Monthly on day ${R[1]||1} at ${j}`;default:return u.schedule_value}};return y?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scheduled Scans"})]}),!N&&e.jsxs(E,{variant:"primary",onClick:()=>L(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"New Schedule"]})]})}),N&&e.jsx(B,{children:e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:t?"Edit Scheduled Scan":"Create Scheduled Scan"}),e.jsx("button",{type:"button",onClick:x,className:"text-slate-400 hover:text-white",children:e.jsx(je,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:u=>n({...s,name:u.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Daily Network Scan"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:s.description,onChange:u=>n({...s,description:u.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(ns,{className:"h-4 w-4"})," Schedule"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Frequency"}),e.jsxs("select",{value:s.schedule_type,onChange:u=>n({...s,schedule_type:u.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),s.schedule_type==="weekly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Week"}),e.jsx("select",{value:m,onChange:u=>p(parseInt(u.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Cs.map((u,R)=>e.jsx("option",{value:R,children:u},u))})]}),s.schedule_type==="monthly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Month"}),e.jsx("select",{value:c,onChange:u=>D(parseInt(u.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Array.from({length:28},(u,R)=>R+1).map(u=>e.jsx("option",{value:u,children:u},u))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Time (UTC)"}),e.jsx("input",{type:"time",value:s.schedule_value.split(" ")[0],onChange:u=>n({...s,schedule_value:u.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Targets (one per line)"}),_.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Use group:"}),_.slice(0,3).map(u=>e.jsx("button",{type:"button",onClick:()=>w(u),className:"px-2 py-0.5 text-xs rounded border border-dark-border text-slate-400 hover:text-white hover:border-primary",style:{borderLeftColor:u.color,borderLeftWidth:3},children:u.name},u.id))]})]}),e.jsx("textarea",{value:s.targets,onChange:u=>n({...s,targets:u.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:4,placeholder:`192.168.1.0/24
10.0.0.1`})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port Start"}),e.jsx("input",{type:"number",value:s.port_range_start,onChange:u=>n({...s,port_range_start:parseInt(u.target.value)||1}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port End"}),e.jsx("input",{type:"number",value:s.port_range_end,onChange:u=>n({...s,port_range_end:parseInt(u.target.value)||1e3}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Threads"}),e.jsx("input",{type:"number",value:s.threads,onChange:u=>n({...s,threads:parseInt(u.target.value)||100}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:1e3})]})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:[{key:"enable_os_detection",label:"OS Detection"},{key:"enable_service_detection",label:"Service Detection"},{key:"enable_vuln_scan",label:"Vulnerability Scan"},{key:"enable_enumeration",label:"Enumeration"}].map(({key:u,label:R})=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s[u],onChange:j=>n({...s,[u]:j.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-slate-300",children:R})]},u))}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:x,children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"primary",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),t?"Update":"Create"]})]})]})}),o.length===0&&!N?e.jsx(B,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(fe,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scheduled scans"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create automated recurring scans"})]})}):e.jsx("div",{className:"space-y-3",children:o.map(u=>{const R=JSON.parse(u.config);return e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${u.is_active?"bg-green-500/20":"bg-slate-500/20"}`,children:e.jsx(fe,{className:`h-5 w-5 ${u.is_active?"text-green-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-white",children:u.name}),e.jsx(oe,{variant:"status",type:u.is_active?"completed":"pending",children:u.is_active?"Active":"Paused"})]}),e.jsx("p",{className:"text-sm text-slate-400",children:k(u)}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[R.targets.length," target",R.targets.length!==1?"s":""," | Ports ",R.port_range[0],"-",R.port_range[1]," |",u.run_count," runs",u.last_run_at&&e.jsxs(e.Fragment,{children:[" | Last run ",Fs(new Date(u.last_run_at))," ago"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>M(u),className:`p-2 rounded transition-colors ${u.is_active?"text-yellow-400 hover:bg-yellow-500/20":"text-green-400 hover:bg-green-500/20"}`,title:u.is_active?"Pause":"Activate",children:u.is_active?e.jsx(Ls,{className:"h-4 w-4"}):e.jsx(fs,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>T(u),className:"p-2 text-slate-400 hover:text-primary transition-colors",children:e.jsx(be,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>q(u),className:"p-2 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete scheduled scan ${u.name}`,children:e.jsx(le,{className:"h-4 w-4"})})]})]})},u.id)})}),e.jsx(_e,{isOpen:!!A,onClose:()=>q(null),onConfirm:U,title:"Delete Scheduled Scan",message:`Are you sure you want to delete the scheduled scan "${A==null?void 0:A.name}"? Future automated scans will no longer run.`,confirmLabel:"Delete Schedule",variant:"warning",loading:g})]})},zt=()=>{const[o,F]=r.useState(null),[_,h]=r.useState(!0),[y,b]=r.useState(!1),[N,L]=r.useState(!1),[t,a]=r.useState(!1),[s,n]=r.useState(!1),[m,p]=r.useState(null),[c,D]=r.useState({email_on_scan_complete:!1,email_on_critical_vuln:!0,email_address:"",slack_webhook_url:"",teams_webhook_url:""});r.useEffect(()=>{A(),q()},[]);const A=async()=>{var T;h(!0);try{const P=await ye.getSettings();F(P.data),D({email_on_scan_complete:P.data.email_on_scan_complete,email_on_critical_vuln:P.data.email_on_critical_vuln,email_address:P.data.email_address||"",slack_webhook_url:P.data.slack_webhook_url||"",teams_webhook_url:P.data.teams_webhook_url||""})}catch(P){((T=P.response)==null?void 0:T.status)!==404&&(l.error("Failed to load notification settings"),console.error(P))}finally{h(!1)}},q=async()=>{try{const T=await ye.checkSmtpStatus();p(T.data.configured)}catch(T){console.error("Failed to check SMTP status:",T),p(!1)}},g=async T=>{var P,z;if(T.preventDefault(),(c.email_on_scan_complete||c.email_on_critical_vuln)&&!c.email_address){l.error("Email address is required when notifications are enabled");return}b(!0);try{const M=await ye.updateSettings(c);F(M.data),l.success("Notification settings saved")}catch(M){const U=M;l.error(((z=(P=U.response)==null?void 0:P.data)==null?void 0:z.error)||"Failed to save settings")}finally{b(!1)}},C=async()=>{var T,P;if(!c.slack_webhook_url){l.error("Please enter a Slack webhook URL first");return}L(!0);try{c.slack_webhook_url!==(o==null?void 0:o.slack_webhook_url)&&await ye.updateSettings({slack_webhook_url:c.slack_webhook_url});const z=await ye.testSlack();l.success(z.data.message)}catch(z){const M=z;l.error(((P=(T=M.response)==null?void 0:T.data)==null?void 0:P.error)||"Failed to send test message")}finally{L(!1)}},S=async()=>{var T,P;if(!c.teams_webhook_url){l.error("Please enter a Teams webhook URL first");return}a(!0);try{c.teams_webhook_url!==(o==null?void 0:o.teams_webhook_url)&&await ye.updateSettings({teams_webhook_url:c.teams_webhook_url});const z=await ye.testTeams();l.success(z.data.message)}catch(z){const M=z;l.error(((P=(T=M.response)==null?void 0:T.data)==null?void 0:P.error)||"Failed to send test message")}finally{a(!1)}},x=async()=>{var T,P;if(!c.email_address){l.error("Please enter an email address first");return}if(!m){l.error("SMTP is not configured on the server. Contact your administrator.");return}n(!0);try{c.email_address!==(o==null?void 0:o.email_address)&&await ye.updateSettings({email_address:c.email_address});const z=await ye.testEmail();l.success(z.data.message)}catch(z){const M=z;l.error(((P=(T=M.response)==null?void 0:T.data)==null?void 0:P.error)||"Failed to send test email")}finally{n(!1)}};return _?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Us,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Notification Settings"})]}),e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Notification Email Address"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(De,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"email",value:c.email_address,onChange:T=>D({...c,email_address:T.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"your@email.com"})]}),e.jsx(E,{type:"button",variant:"secondary",onClick:x,disabled:!c.email_address||s||!m,title:m?"Send test email":"SMTP not configured on server",children:s?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Sending..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Email address where notifications will be sent"}),m!==null&&e.jsx("span",{className:`text-xs flex items-center gap-1 ${m?"text-green-400":"text-amber-400"}`,children:m?e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"h-3 w-3"}),"SMTP configured"]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"h-3 w-3"}),"SMTP not configured"]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Email Notifications"}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:c.email_on_scan_complete,onChange:T=>D({...c,email_on_scan_complete:T.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"font-medium text-white",children:"Scan Completion"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Receive an email when any of your scans complete, including a summary of findings"})]})]}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:c.email_on_critical_vuln,onChange:T=>D({...c,email_on_critical_vuln:T.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"font-medium text-white",children:"Critical Vulnerabilities"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Get immediate alerts when critical or high severity vulnerabilities are discovered"})]})]})]}),m===!1?e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ge,{className:"h-5 w-5 text-amber-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-200",children:"SMTP is not configured on this server. Email notifications are disabled."}),e.jsx("p",{className:"text-xs text-amber-300/70 mt-1",children:"Contact your administrator to configure SMTP settings (SMTP_HOST, SMTP_USER, etc.)"})]})]})}):e.jsx("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(De,{className:"h-5 w-5 text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-200",children:m?"Email notifications are ready. Use the Test button to verify delivery.":"Checking SMTP configuration..."}),e.jsx("p",{className:"text-xs text-blue-300/70 mt-1",children:"Contact your administrator if you're not receiving emails."})]})]})}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-dark-border",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(vt,{className:"h-4 w-4"}),"Webhook Integrations"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Slack Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:c.slack_webhook_url,onChange:T=>D({...c,slack_webhook_url:T.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://hooks.slack.com/services/YOUR/WEBHOOK/URL"}),e.jsx(E,{type:"button",variant:"secondary",onClick:C,disabled:!c.slack_webhook_url||N,children:N?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Send scan notifications to a Slack channel. Create a webhook at"," ",e.jsx("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Slack Incoming Webhooks"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Microsoft Teams Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:c.teams_webhook_url,onChange:T=>D({...c,teams_webhook_url:T.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://outlook.office.com/webhook/YOUR/WEBHOOK/URL"}),e.jsx(E,{type:"button",variant:"secondary",onClick:S,disabled:!c.teams_webhook_url||t,children:t?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Send scan notifications to a Teams channel. Create a webhook in your Teams channel connectors."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(E,{type:"submit",variant:"primary",disabled:y,children:y?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Save Settings"]})})})]})]}),o&&e.jsxs(B,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"Current Status"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Scan Complete Emails:"}),e.jsx("span",{className:`ml-2 ${o.email_on_scan_complete?"text-green-400":"text-slate-400"}`,children:o.email_on_scan_complete?"Enabled":"Disabled"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Critical Vuln Alerts:"}),e.jsx("span",{className:`ml-2 ${o.email_on_critical_vuln?"text-green-400":"text-slate-400"}`,children:o.email_on_critical_vuln?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-slate-500",children:"Last Updated:"}),e.jsx("span",{className:"ml-2 text-slate-300",children:new Date(o.updated_at).toLocaleString()})]})]})]})]})},Qe={quick:{label:"Quick",icon:Nt,color:"text-yellow-400"},standard:{label:"Standard",icon:is,color:"text-blue-400"},comprehensive:{label:"Comprehensive",icon:ue,color:"text-purple-400"},web:{label:"Web",icon:bs,color:"text-green-400"},stealth:{label:"Stealth",icon:js,color:"text-slate-400"},custom:{label:"Custom",icon:Ee,color:"text-cyan-400"}},Gt=()=>{var V;const[o,F]=r.useState([]),[_,h]=r.useState(!0),[y,b]=r.useState(!1),[N,L]=r.useState(null),[t,a]=r.useState({name:"",description:"",category:"custom",estimated_duration_mins:""}),[s,n]=r.useState(new Set),[m,p]=r.useState(new Set),[c,D]=r.useState(null),[A,q]=r.useState(!1),[g,C]=r.useState(null),[S,x]=r.useState(null);r.useEffect(()=>{T()},[]);const T=async()=>{h(!0);try{const f=await Me.getAll();F(f.data)}catch(f){l.error("Failed to load templates"),console.error(f)}finally{h(!1)}},P=r.useMemo(()=>{const f={};return o.forEach(G=>{const Q=G.category||"custom";f[Q]||(f[Q]=[]),f[Q].push(G)}),Object.keys(f).forEach(G=>{f[G].sort((Q,v)=>Q.is_system!==v.is_system?Q.is_system?-1:1:Q.is_default!==v.is_default?Q.is_default?-1:1:v.use_count-Q.use_count)}),f},[o]),z=r.useMemo(()=>["quick","standard","comprehensive","web","stealth","custom"].filter(G=>{var Q;return((Q=P[G])==null?void 0:Q.length)>0}),[P]),M=r.useMemo(()=>g?P[g]||[]:o,[o,g,P]),U=()=>{a({name:"",description:"",category:"custom",estimated_duration_mins:""}),L(null),b(!1)},w=f=>{if(f.is_system){l.error("System templates cannot be edited. Clone it to create your own version.");return}a({name:f.name,description:f.description||"",category:f.category,estimated_duration_mins:f.estimated_duration_mins||""}),L(f.id),b(!0)},k=async f=>{var G,Q;if(f.preventDefault(),!t.name.trim()){l.error("Name is required");return}if(!N){l.error('Cannot create templates from this form. Use "Save as Template" in the scan form.');return}try{await Me.update(N,{name:t.name,description:t.description||void 0,category:t.category,estimated_duration_mins:t.estimated_duration_mins||void 0}),l.success("Template updated"),U(),T()}catch(v){const H=v;l.error(((Q=(G=H.response)==null?void 0:G.data)==null?void 0:Q.error)||"Failed to update template")}},u=async()=>{var f,G;if(c){q(!0);try{await Me.delete(c.id),l.success(`Template "${c.name}" deleted`),T(),D(null)}catch(Q){const v=Q;l.error(((G=(f=v.response)==null?void 0:f.data)==null?void 0:G.error)||"Failed to delete")}finally{q(!1)}}},R=async f=>{var Q,v;const G=prompt("Enter name for the cloned template:",`${f.name} (Copy)`);if(G){p(H=>new Set([...H,f.id]));try{await Me.clone(f.id,G),l.success("Template cloned successfully"),T()}catch(H){const d=H;l.error(((v=(Q=d.response)==null?void 0:Q.data)==null?void 0:v.error)||"Failed to clone template")}finally{p(H=>{const d=new Set(H);return d.delete(f.id),d})}}},j=async f=>{var G,Q;x(f.id);try{await Me.setDefault(f.id),l.success(`"${f.name}" set as default template`),T()}catch(v){const H=v;l.error(((Q=(G=H.response)==null?void 0:G.data)==null?void 0:Q.error)||"Failed to set default")}finally{x(null)}},Y=async f=>{var H,d;const G=prompt(`Enter name for new scan (based on "${f.name}"):`,`${f.name} - ${new Date().toLocaleDateString()}`);if(!G)return;const Q=prompt("Enter target(s) to scan (comma-separated IPs or hostnames):");if(!Q)return;const v=Q.split(",").map(W=>W.trim()).filter(Boolean);if(v.length===0){l.error("At least one target is required");return}n(new Set([...s,f.id]));try{await Me.createScan(f.id,G,v),l.success("Scan started from template!")}catch(W){const K=W;l.error(((d=(H=K.response)==null?void 0:H.data)==null?void 0:d.error)||"Failed to create scan")}finally{n(W=>{const K=new Set(W);return K.delete(f.id),K})}},X=f=>{if(!f)return"-";if(f<60)return`~${f}m`;const G=Math.floor(f/60),Q=f%60;return Q?`~${G}h ${Q}m`:`~${G}h`},i=f=>new Date(f).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),$=f=>e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[f.enable_os_detection&&e.jsx(oe,{variant:"status",type:"completed",children:"OS"}),f.enable_service_detection&&e.jsx(oe,{variant:"status",type:"completed",children:"Services"}),f.enable_vuln_scan&&e.jsx(oe,{variant:"status",type:"running",children:"Vuln Scan"}),f.enable_enumeration&&e.jsx(oe,{variant:"status",type:"pending",children:"Enum"})]});return _?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scan Templates"})]}),e.jsx("div",{className:"text-sm text-slate-400",children:"Reusable scan profiles for quick configuration"})]}),z.length>0&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>C(null),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${g===null?"bg-primary text-white":"bg-dark-bg text-slate-400 hover:text-white hover:bg-slate-700"}`,children:["All (",o.length,")"]}),z.map(f=>{var H;const G=Qe[f],Q=G.icon,v=((H=P[f])==null?void 0:H.length)||0;return e.jsxs("button",{onClick:()=>C(f),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${g===f?"bg-primary text-white":"bg-dark-bg text-slate-400 hover:text-white hover:bg-slate-700"}`,children:[e.jsx(Q,{className:`h-4 w-4 ${g===f?"text-white":G.color}`}),G.label," (",v,")"]},f)})]})]}),y&&e.jsx(B,{children:e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Edit Template"}),e.jsx("button",{type:"button",onClick:U,className:"text-slate-400 hover:text-white",children:e.jsx(je,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:t.name,onChange:f=>a({...t,name:f.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"My Custom Template"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Category"}),e.jsx("select",{value:t.category,onChange:f=>a({...t,category:f.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Object.entries(Qe).map(([f,G])=>e.jsx("option",{value:f,children:G.label},f))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("textarea",{value:t.description,onChange:f=>a({...t,description:f.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",rows:2,placeholder:"Optional description of the template"})]}),e.jsxs("div",{className:"w-48",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Est. Duration (mins)"}),e.jsx("input",{type:"number",value:t.estimated_duration_mins,onChange:f=>a({...t,estimated_duration_mins:f.target.value?parseInt(f.target.value):""}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"30",min:"1"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:U,children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"primary",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Update"]})]})]})}),M.length===0&&!y?e.jsx(B,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ee,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:g?`No ${((V=Qe[g])==null?void 0:V.label)||""} templates`:"No scan templates yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:'Save scan configurations using "Save as Template" when creating a scan'})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:M.map(f=>{const G=f.config,Q=s.has(f.id),v=m.has(f.id),H=S===f.id,d=Qe[f.category]||Qe.custom,W=d.icon;return e.jsxs(B,{className:"relative",children:[f.is_system&&e.jsx("div",{className:"absolute top-2 right-2",title:"System template (read-only)",children:e.jsx(Ze,{className:"h-4 w-4 text-slate-500"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-dark-bg ${d.color}`,children:e.jsx(W,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-white truncate",children:f.name}),f.is_default&&e.jsx("span",{title:"Default template",children:e.jsx(rs,{className:"h-4 w-4 text-yellow-400 flex-shrink-0"})})]}),f.description&&e.jsx("p",{className:"text-sm text-slate-400 line-clamp-2 mt-0.5",children:f.description})]})]}),e.jsxs("div",{className:"space-y-2 border-t border-dark-border pt-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(us,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Ports: ",G.port_range[0],"-",G.port_range[1]]})]}),G.scan_type&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wt,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-slate-400 capitalize",children:G.scan_type.replace("_"," ")})]}),G.enable_enumeration&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Os,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Enum: ",G.enum_depth||"light"]})]}),f.estimated_duration_mins&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-slate-400",children:X(f.estimated_duration_mins)})]})]}),$(G)]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 border-t border-dark-border pt-3",children:[e.jsxs("span",{children:["Used ",f.use_count," times"]}),f.last_used_at?e.jsxs("span",{children:["Last: ",i(f.last_used_at)]}):e.jsxs("span",{children:["Created ",i(f.created_at)]})]}),e.jsxs("div",{className:"flex items-center justify-between border-t border-dark-border pt-3",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>R(f),disabled:v,className:"p-1.5 text-slate-400 hover:text-primary transition-colors disabled:opacity-50",title:"Clone template",children:e.jsx(he,{className:"h-4 w-4"})}),!f.is_system&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>w(f),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit template",children:e.jsx(be,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>D(f),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete template",children:e.jsx(le,{className:"h-4 w-4"})})]}),!f.is_default&&e.jsx("button",{onClick:()=>j(f),disabled:H,className:"p-1.5 text-slate-400 hover:text-yellow-400 transition-colors disabled:opacity-50",title:"Set as default",children:e.jsx(rs,{className:"h-4 w-4"})})]}),e.jsxs(E,{variant:"primary",size:"sm",onClick:()=>Y(f),loading:Q,disabled:Q,children:[e.jsx(_t,{className:"h-4 w-4 mr-1.5"}),"Use"]})]})]})]},f.id)})}),e.jsx(_e,{isOpen:!!c,onClose:()=>D(null),onConfirm:u,title:"Delete Template",message:`Are you sure you want to delete the template "${c==null?void 0:c.name}"? This will not affect any scans previously created from this template.`,confirmLabel:"Delete Template",variant:"danger",loading:A})]})},Ss=["critical","high","medium","low","info"],Vt=["web","network","infrastructure","cloud","api","mobile","other"],qt=()=>{var Q,v,H;const[o,F]=r.useState([]),[_,h]=r.useState([]),[y,b]=r.useState(!0),[N,L]=r.useState(!1),[t,a]=r.useState(null),[s,n]=r.useState(null),[m,p]=r.useState(!1),[c,D]=r.useState(!1),[A,q]=r.useState(null),[g,C]=r.useState(""),[S,x]=r.useState(""),[T,P]=r.useState(""),[z,M]=r.useState(!0),[U,w]=r.useState({category:"web",title:"",severity:"medium",description:"",impact:"",remediation:"",references:[],cwe_ids:[],cvss_vector:"",cvss_score:void 0,tags:[]});r.useEffect(()=>{k(),u()},[S,T,g,z]);const k=async()=>{b(!0);try{const d=await Le.list({category:S||void 0,severity:T||void 0,search:g||void 0,include_system:z});F(d.data)}catch(d){l.error("Failed to load finding templates"),console.error(d)}finally{b(!1)}},u=async()=>{try{const d=await Le.getCategories();h(d.data)}catch(d){console.error("Failed to load categories:",d)}},R=()=>{w({category:"web",title:"",severity:"medium",description:"",impact:"",remediation:"",references:[],cwe_ids:[],cvss_vector:"",cvss_score:void 0,tags:[]}),a(null),L(!1)},j=d=>{w({category:d.category,title:d.title,severity:d.severity,description:d.description,impact:d.impact||"",remediation:d.remediation||"",references:d.references?JSON.parse(d.references):[],cwe_ids:d.cwe_ids?JSON.parse(d.cwe_ids):[],cvss_vector:d.cvss_vector||"",cvss_score:d.cvss_score||void 0,tags:d.tags?JSON.parse(d.tags):[]}),a(d),L(!0)},Y=async d=>{var K,de;const W=prompt("Enter name for cloned template:",`${d.title} (Copy)`);if(W)try{await Le.clone(d.id,{new_title:W}),l.success("Template cloned successfully"),k(),u()}catch(I){const ae=I;l.error(((de=(K=ae.response)==null?void 0:K.data)==null?void 0:de.error)||"Failed to clone template")}},X=async d=>{var W,K;if(d.preventDefault(),!U.title.trim()){l.error("Title is required");return}if(!U.description.trim()){l.error("Description is required");return}D(!0);try{t?(await Le.update(t.id,U),l.success("Template updated successfully")):(await Le.create(U),l.success("Template created successfully")),R(),k(),u()}catch(de){const I=de;l.error(((K=(W=I.response)==null?void 0:W.data)==null?void 0:K.error)||"Failed to save template")}finally{D(!1)}},i=async()=>{var d,W;if(s){p(!0);try{await Le.delete(s.id),l.success(`Template "${s.title}" deleted`),k(),u(),n(null)}catch(K){const de=K;l.error(((W=(d=de.response)==null?void 0:d.data)==null?void 0:W.error)||"Failed to delete template")}finally{p(!1)}}},$=d=>{switch(d.toLowerCase()){case"critical":case"high":return e.jsx(ge,{className:"h-4 w-4"});case"medium":return e.jsx(ue,{className:"h-4 w-4"});default:return e.jsx(Ge,{className:"h-4 w-4"})}},V=d=>{const W=d.toLowerCase();return W==="critical"?"critical":W==="high"?"high":W==="medium"?"medium":"low"},f=d=>{if(!d)return[];try{return JSON.parse(d)}catch{return[]}},G=d=>new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return y&&o.length===0?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Finding Templates"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-slate-400",children:[o.length," template",o.length!==1?"s":""]}),e.jsxs(E,{variant:"primary",size:"sm",onClick:()=>L(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-1.5"}),"New Template"]})]})]})}),e.jsx(B,{children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(Os,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",value:g,onChange:d=>C(d.target.value),placeholder:"Search templates...",className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})}),e.jsxs("div",{className:"relative",children:[e.jsx(kt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsxs("select",{value:S,onChange:d=>x(d.target.value),className:"bg-dark-bg border border-dark-border rounded-lg pl-10 pr-8 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"All Categories"}),_.map(d=>e.jsxs("option",{value:d.category,children:[d.category.charAt(0).toUpperCase()+d.category.slice(1)," (",d.count,")"]},d.category))]}),e.jsx(Ye,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:T,onChange:d=>P(d.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent appearance-none cursor-pointer pr-8",children:[e.jsx("option",{value:"",children:"All Severities"}),Ss.map(d=>e.jsx("option",{value:d,children:d.charAt(0).toUpperCase()+d.slice(1)},d))]}),e.jsx(Ye,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:z,onChange:d=>M(d.target.checked),className:"rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),"Include system templates"]})]})}),N&&e.jsx(B,{children:e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:t?"Edit Template":"New Template"}),e.jsx("button",{type:"button",onClick:R,className:"text-slate-400 hover:text-white",children:e.jsx(je,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Category"}),e.jsx("select",{value:U.category,onChange:d=>w({...U,category:d.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Vt.map(d=>e.jsx("option",{value:d,children:d.charAt(0).toUpperCase()+d.slice(1)},d))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Severity"}),e.jsx("select",{value:U.severity,onChange:d=>w({...U,severity:d.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Ss.map(d=>e.jsx("option",{value:d,children:d.charAt(0).toUpperCase()+d.slice(1)},d))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CVSS Score"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"10",value:U.cvss_score||"",onChange:d=>w({...U,cvss_score:d.target.value?parseFloat(d.target.value):void 0}),placeholder:"0.0 - 10.0",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:U.title,onChange:d=>w({...U,title:d.target.value}),placeholder:"e.g., SQL Injection in Login Form",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description *"}),e.jsx("textarea",{value:U.description,onChange:d=>w({...U,description:d.target.value}),rows:4,placeholder:"Detailed description of the vulnerability...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Impact"}),e.jsx("textarea",{value:U.impact||"",onChange:d=>w({...U,impact:d.target.value}),rows:2,placeholder:"Potential impact if exploited...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Remediation"}),e.jsx("textarea",{value:U.remediation||"",onChange:d=>w({...U,remediation:d.target.value}),rows:3,placeholder:"Recommended steps to fix...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CVSS Vector"}),e.jsx("input",{type:"text",value:U.cvss_vector||"",onChange:d=>w({...U,cvss_vector:d.target.value}),placeholder:"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CWE IDs (comma-separated)"}),e.jsx("input",{type:"text",value:((Q=U.cwe_ids)==null?void 0:Q.join(", "))||"",onChange:d=>{const W=d.target.value.split(",").map(K=>parseInt(K.trim())).filter(K=>!isNaN(K));w({...U,cwe_ids:W})},placeholder:"e.g., 89, 564",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"References (one URL per line)"}),e.jsx("textarea",{value:((v=U.references)==null?void 0:v.join(`
`))||"",onChange:d=>{const W=d.target.value.split(`
`).map(K=>K.trim()).filter(K=>K);w({...U,references:W})},rows:2,placeholder:"https://owasp.org/...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:((H=U.tags)==null?void 0:H.join(", "))||"",onChange:d=>{const W=d.target.value.split(",").map(K=>K.trim()).filter(K=>K);w({...U,tags:W})},placeholder:"e.g., owasp, web, injection",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:R,children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"primary",loading:c,disabled:c,children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),t?"Update":"Create"]})]})]})}),o.length===0&&!N?e.jsx(B,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ee,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No finding templates found"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:S||T||g?"Try adjusting your filters":"Create your first template or include system templates"})]})}):e.jsx("div",{className:"space-y-3",children:o.map(d=>{const W=A===d.id,K=f(d.references),de=f(d.cwe_ids),I=f(d.tags);return e.jsx(B,{className:W?"ring-1 ring-primary":"",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>q(W?null:d.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(oe,{variant:"severity",type:V(d.severity),children:[$(d.severity),e.jsx("span",{className:"ml-1",children:d.severity})]}),e.jsx(oe,{variant:"status",type:"pending",children:d.category}),d.is_system&&e.jsx(oe,{variant:"status",type:"completed",children:"System"})]}),e.jsx("h4",{className:"font-semibold text-white text-lg mt-2",children:d.title}),!W&&e.jsx("p",{className:"text-sm text-slate-400 mt-1 line-clamp-2",children:d.description})]}),e.jsxs("div",{className:"flex gap-1 ml-4",children:[e.jsx("button",{onClick:()=>Y(d),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Clone template",children:e.jsx(he,{className:"h-4 w-4"})}),!d.is_system&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>j(d),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit template",children:e.jsx(be,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>n(d),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete template",children:e.jsx(le,{className:"h-4 w-4"})})]})]})]}),W&&e.jsxs("div",{className:"border-t border-dark-border pt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:d.description})]}),d.impact&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Impact"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:d.impact})]}),d.remediation&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Remediation"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:d.remediation})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[d.cvss_score!==null&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"CVSS:"})," ",e.jsx("span",{className:"text-white font-medium",children:d.cvss_score.toFixed(1)})]}),d.cvss_vector&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Vector:"})," ",e.jsx("code",{className:"text-slate-300 text-xs",children:d.cvss_vector})]}),de.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"CWE:"})," ",de.map((ae,pe)=>e.jsxs("span",{children:[pe>0&&", ",e.jsxs("a",{href:`https://cwe.mitre.org/data/definitions/${ae}.html`,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:["CWE-",ae]})]},ae))]})]}),K.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-2",children:"References"}),e.jsx("div",{className:"space-y-1",children:K.map((ae,pe)=>e.jsxs("a",{href:ae,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-primary hover:underline",children:[e.jsx(es,{className:"h-3 w-3"}),ae]},pe))})]}),I.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5",children:I.map(ae=>e.jsx("span",{className:"px-2 py-0.5 bg-dark-border rounded text-xs text-slate-300",children:ae},ae))}),e.jsxs("div",{className:"text-xs text-slate-500 pt-2 border-t border-dark-border",children:["Created ",G(d.created_at),d.updated_at!==d.created_at&&e.jsxs(e.Fragment,{children:["  Updated ",G(d.updated_at)]})]})]})]})},d.id)})}),e.jsx(_e,{isOpen:!!s,onClose:()=>n(null),onConfirm:i,title:"Delete Template",message:`Are you sure you want to delete the template "${s==null?void 0:s.title}"? This action cannot be undone.`,confirmLabel:"Delete Template",variant:"danger",loading:m})]})},Ke=[{id:"host",label:"Single Host",description:"Exclude a single IP address",placeholder:"192.168.1.1",icon:e.jsx(Se,{className:"h-4 w-4"})},{id:"cidr",label:"CIDR Range",description:"Exclude a network range",placeholder:"192.168.1.0/24",icon:e.jsx(hs,{className:"h-4 w-4"})},{id:"hostname",label:"Hostname Pattern",description:"Exclude by hostname (supports wildcards)",placeholder:"*.internal.example.com",icon:e.jsx(bs,{className:"h-4 w-4"})},{id:"port",label:"Single Port",description:"Exclude a specific port",placeholder:"22",icon:e.jsx(us,{className:"h-4 w-4"})},{id:"port_range",label:"Port Range",description:"Exclude a range of ports",placeholder:"1-1000",icon:e.jsx(us,{className:"h-4 w-4"})}],Bt=()=>{const[o,F]=r.useState([]),[_,h]=r.useState(!0),[y,b]=r.useState(!1),[N,L]=r.useState(!1),[t,a]=r.useState(null),[s,n]=r.useState({name:"",description:"",exclusion_type:"host",value:"",is_global:!0}),[m,p]=r.useState({exclusion_type:"host",values:"",is_global:!0,name_prefix:"Imported"}),[c,D]=r.useState(!1),[A,q]=r.useState(null),[g,C]=r.useState(!1);r.useEffect(()=>{S()},[]);const S=async()=>{h(!0);try{const j=await Be.getAll();F(j.data)}catch(j){l.error("Failed to load exclusions"),console.error(j)}finally{h(!1)}},x=()=>{n({name:"",description:"",exclusion_type:"host",value:"",is_global:!0}),a(null),b(!1)},T=()=>{p({exclusion_type:"host",values:"",is_global:!0,name_prefix:"Imported"}),L(!1)},P=j=>{n({name:j.name,description:j.description||"",exclusion_type:j.exclusion_type,value:j.value,is_global:j.is_global}),a(j.id),b(!0)},z=async j=>{var Y,X;if(j.preventDefault(),!s.name.trim()){l.error("Name is required");return}if(!s.value.trim()){l.error("Value is required");return}try{const i={name:s.name.trim(),description:s.description.trim()||void 0,exclusion_type:s.exclusion_type,value:s.value.trim(),is_global:s.is_global};t?(await Be.update(t,i),l.success("Exclusion updated")):(await Be.create(i),l.success("Exclusion created")),x(),S()}catch(i){const $=i;l.error(((X=(Y=$.response)==null?void 0:Y.data)==null?void 0:X.error)||"Failed to save exclusion")}},M=async()=>{var j,Y;if(A){C(!0);try{await Be.delete(A.id),l.success(`Exclusion "${A.name}" deleted`),S(),q(null)}catch(X){const i=X;l.error(((Y=(j=i.response)==null?void 0:j.data)==null?void 0:Y.error)||"Failed to delete")}finally{C(!1)}}},U=async j=>{var Y,X;if(j.preventDefault(),!m.values.trim()){l.error("Please enter values to import");return}if(!m.name_prefix.trim()){l.error("Please enter a name prefix");return}D(!0);try{const $=(await Be.bulkImport({exclusion_type:m.exclusion_type,values:m.values,is_global:m.is_global,name_prefix:m.name_prefix.trim()})).data;$.imported>0&&l.success(`Imported ${$.imported} exclusion(s)`),$.failed>0&&(l.warning(`${$.failed} value(s) failed to import`),$.errors.slice(0,3).forEach(V=>{l.error(V,{autoClose:5e3})})),T(),S()}catch(i){const $=i;l.error(((X=(Y=$.response)==null?void 0:Y.data)==null?void 0:X.error)||"Failed to bulk import")}finally{D(!1)}},w=()=>m.values.trim()?m.values.split(/[,\n;]/).map(j=>j.trim()).filter(j=>j.length>0).length:0,k=j=>Ke.find(Y=>Y.id===j)||Ke[0],u=o.filter(j=>j.is_global),R=o.filter(j=>!j.is_global);return _?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scan Exclusions"})]}),!y&&!N&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(E,{variant:"secondary",onClick:()=>L(!0),children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),"Bulk Import"]}),e.jsxs(E,{variant:"primary",onClick:()=>b(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"New Exclusion"]})]})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Configure hosts and ports to exclude from scans. Global exclusions apply to all scans automatically."})]}),y&&e.jsx(B,{children:e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:t?"Edit Exclusion":"Create Exclusion"}),e.jsx("button",{type:"button",onClick:x,className:"text-slate-400 hover:text-white",children:e.jsx(je,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:j=>n({...s,name:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Development Servers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Type"}),e.jsx("select",{value:s.exclusion_type,onChange:j=>n({...s,exclusion_type:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Ke.map(j=>e.jsx("option",{value:j.id,children:j.label},j.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Value"}),e.jsx("input",{type:"text",value:s.value,onChange:j=>n({...s,value:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono",placeholder:k(s.exclusion_type).placeholder}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:k(s.exclusion_type).description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description (optional)"}),e.jsx("input",{type:"text",value:s.description,onChange:j=>n({...s,description:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Why is this excluded?"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.is_global,onChange:j=>n({...s,is_global:j.target.checked}),className:"w-4 h-4 rounded bg-dark-bg border-dark-border text-primary focus:ring-primary focus:ring-offset-dark-bg"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Apply to all scans (global exclusion)"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(Ge,{className:"h-3 w-3"}),e.jsx("span",{children:"Non-global exclusions can be selected per-scan"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:x,children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"primary",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),t?"Update":"Create"]})]})]})}),N&&e.jsx(B,{children:e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5 text-cyan-400"}),e.jsx("h4",{className:"text-lg font-medium text-white",children:"Bulk Import Exclusions"})]}),e.jsx("button",{type:"button",onClick:T,className:"text-slate-400 hover:text-white",children:e.jsx(je,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Exclusion Type"}),e.jsx("select",{value:m.exclusion_type,onChange:j=>p({...m,exclusion_type:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Ke.map(j=>e.jsx("option",{value:j.id,children:j.label},j.id))}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:k(m.exclusion_type).description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name Prefix"}),e.jsx("input",{type:"text",value:m.name_prefix,onChange:j=>p({...m,name_prefix:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Imported"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:['Exclusions will be named "',m.name_prefix||"Imported",' 1", "',m.name_prefix||"Imported",' 2", etc.']})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Values"}),e.jsxs("span",{className:"text-xs text-slate-500",children:[w()," value(s) detected"]})]}),e.jsx("textarea",{value:m.values,onChange:j=>p({...m,values:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:6,placeholder:`Paste values here, one per line or comma-separated.

Example for IPs:
192.168.1.1
192.168.1.2
10.0.0.0/8

Example for ports:
22, 23, 135, 139, 445`})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m.is_global,onChange:j=>p({...m,is_global:j.target.checked}),className:"w-4 h-4 rounded bg-dark-bg border-dark-border text-primary focus:ring-primary focus:ring-offset-dark-bg"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Apply to all scans (global exclusions)"})]})}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(Ge,{className:"h-3 w-3"}),e.jsx("span",{children:"Separate values with commas, newlines, or semicolons"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:T,children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"primary",loading:c,disabled:w()===0,children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),"Import ",w()>0?`(${w()})`:""]})]})]})]})}),o.length===0&&!y&&!N?e.jsx(B,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ms,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No exclusions configured"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create exclusions to skip specific hosts or ports during scans"})]})}):e.jsxs(e.Fragment,{children:[u.length>0&&e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(bs,{className:"h-4 w-4 text-green-400"}),e.jsx("h4",{className:"font-medium text-white",children:"Global Exclusions"}),e.jsx("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-0.5 rounded",children:"Applied to all scans"})]}),e.jsx("div",{className:"space-y-2",children:u.map(j=>e.jsx(Es,{exclusion:j,onEdit:P,onDelete:q},j.id))})]}),R.length>0&&e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Se,{className:"h-4 w-4 text-blue-400"}),e.jsx("h4",{className:"font-medium text-white",children:"Per-Scan Exclusions"}),e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded",children:"Select when creating scans"})]}),e.jsx("div",{className:"space-y-2",children:R.map(j=>e.jsx(Es,{exclusion:j,onEdit:P,onDelete:q},j.id))})]})]}),e.jsx(_e,{isOpen:!!A,onClose:()=>q(null),onConfirm:M,title:"Delete Exclusion",message:`Are you sure you want to delete the exclusion "${A==null?void 0:A.name}"? This cannot be undone.`,confirmLabel:"Delete Exclusion",variant:"danger",loading:g})]})},Es=({exclusion:o,onEdit:F,onDelete:_})=>{const h=Ke.find(b=>b.id===o.exclusion_type),y=b=>{switch(b){case"host":case"cidr":return"bg-purple-500/20 text-purple-400";case"hostname":return"bg-cyan-500/20 text-cyan-400";case"port":case"port_range":return"bg-orange-500/20 text-orange-400";default:return"bg-slate-500/20 text-slate-400"}};return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"text-slate-400",children:h==null?void 0:h.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:o.name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${y(o.exclusion_type)}`,children:(h==null?void 0:h.label)||o.exclusion_type})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("code",{className:"text-sm font-mono text-slate-300 bg-dark-surface px-2 py-0.5 rounded",children:o.value}),o.description&&e.jsx("span",{className:"text-xs text-slate-500 truncate",children:o.description})]})]})]}),e.jsxs("div",{className:"flex gap-1 ml-4",children:[e.jsx("button",{onClick:()=>F(o),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit exclusion",children:e.jsx(be,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>_(o),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete exclusion",children:e.jsx(le,{className:"h-4 w-4"})})]})]})};var Ht=Object.defineProperty,ls=Object.getOwnPropertySymbols,Ys=Object.prototype.hasOwnProperty,Xs=Object.prototype.propertyIsEnumerable,As=(o,F,_)=>F in o?Ht(o,F,{enumerable:!0,configurable:!0,writable:!0,value:_}):o[F]=_,ps=(o,F)=>{for(var _ in F||(F={}))Ys.call(F,_)&&As(o,_,F[_]);if(ls)for(var _ of ls(F))Xs.call(F,_)&&As(o,_,F[_]);return o},gs=(o,F)=>{var _={};for(var h in o)Ys.call(o,h)&&F.indexOf(h)<0&&(_[h]=o[h]);if(o!=null&&ls)for(var h of ls(o))F.indexOf(h)<0&&Xs.call(o,h)&&(_[h]=o[h]);return _};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Re;(o=>{const F=class Z{constructor(t,a,s,n){if(this.version=t,this.errorCorrectionLevel=a,this.modules=[],this.isFunction=[],t<Z.MIN_VERSION||t>Z.MAX_VERSION)throw new RangeError("Version value out of range");if(n<-1||n>7)throw new RangeError("Mask value out of range");this.size=t*4+17;let m=[];for(let c=0;c<this.size;c++)m.push(!1);for(let c=0;c<this.size;c++)this.modules.push(m.slice()),this.isFunction.push(m.slice());this.drawFunctionPatterns();const p=this.addEccAndInterleave(s);if(this.drawCodewords(p),n==-1){let c=1e9;for(let D=0;D<8;D++){this.applyMask(D),this.drawFormatBits(D);const A=this.getPenaltyScore();A<c&&(n=D,c=A),this.applyMask(D)}}y(0<=n&&n<=7),this.mask=n,this.applyMask(n),this.drawFormatBits(n),this.isFunction=[]}static encodeText(t,a){const s=o.QrSegment.makeSegments(t);return Z.encodeSegments(s,a)}static encodeBinary(t,a){const s=o.QrSegment.makeBytes(t);return Z.encodeSegments([s],a)}static encodeSegments(t,a,s=1,n=40,m=-1,p=!0){if(!(Z.MIN_VERSION<=s&&s<=n&&n<=Z.MAX_VERSION)||m<-1||m>7)throw new RangeError("Invalid value");let c,D;for(c=s;;c++){const C=Z.getNumDataCodewords(c,a)*8,S=N.getTotalBits(t,c);if(S<=C){D=S;break}if(c>=n)throw new RangeError("Data too long")}for(const C of[Z.Ecc.MEDIUM,Z.Ecc.QUARTILE,Z.Ecc.HIGH])p&&D<=Z.getNumDataCodewords(c,C)*8&&(a=C);let A=[];for(const C of t){_(C.mode.modeBits,4,A),_(C.numChars,C.mode.numCharCountBits(c),A);for(const S of C.getData())A.push(S)}y(A.length==D);const q=Z.getNumDataCodewords(c,a)*8;y(A.length<=q),_(0,Math.min(4,q-A.length),A),_(0,(8-A.length%8)%8,A),y(A.length%8==0);for(let C=236;A.length<q;C^=253)_(C,8,A);let g=[];for(;g.length*8<A.length;)g.push(0);return A.forEach((C,S)=>g[S>>>3]|=C<<7-(S&7)),new Z(c,a,g,m)}getModule(t,a){return 0<=t&&t<this.size&&0<=a&&a<this.size&&this.modules[a][t]}getModules(){return this.modules}drawFunctionPatterns(){for(let s=0;s<this.size;s++)this.setFunctionModule(6,s,s%2==0),this.setFunctionModule(s,6,s%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const t=this.getAlignmentPatternPositions(),a=t.length;for(let s=0;s<a;s++)for(let n=0;n<a;n++)s==0&&n==0||s==0&&n==a-1||s==a-1&&n==0||this.drawAlignmentPattern(t[s],t[n]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){const a=this.errorCorrectionLevel.formatBits<<3|t;let s=a;for(let m=0;m<10;m++)s=s<<1^(s>>>9)*1335;const n=(a<<10|s)^21522;y(n>>>15==0);for(let m=0;m<=5;m++)this.setFunctionModule(8,m,h(n,m));this.setFunctionModule(8,7,h(n,6)),this.setFunctionModule(8,8,h(n,7)),this.setFunctionModule(7,8,h(n,8));for(let m=9;m<15;m++)this.setFunctionModule(14-m,8,h(n,m));for(let m=0;m<8;m++)this.setFunctionModule(this.size-1-m,8,h(n,m));for(let m=8;m<15;m++)this.setFunctionModule(8,this.size-15+m,h(n,m));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let s=0;s<12;s++)t=t<<1^(t>>>11)*7973;const a=this.version<<12|t;y(a>>>18==0);for(let s=0;s<18;s++){const n=h(a,s),m=this.size-11+s%3,p=Math.floor(s/3);this.setFunctionModule(m,p,n),this.setFunctionModule(p,m,n)}}drawFinderPattern(t,a){for(let s=-4;s<=4;s++)for(let n=-4;n<=4;n++){const m=Math.max(Math.abs(n),Math.abs(s)),p=t+n,c=a+s;0<=p&&p<this.size&&0<=c&&c<this.size&&this.setFunctionModule(p,c,m!=2&&m!=4)}}drawAlignmentPattern(t,a){for(let s=-2;s<=2;s++)for(let n=-2;n<=2;n++)this.setFunctionModule(t+n,a+s,Math.max(Math.abs(n),Math.abs(s))!=1)}setFunctionModule(t,a,s){this.modules[a][t]=s,this.isFunction[a][t]=!0}addEccAndInterleave(t){const a=this.version,s=this.errorCorrectionLevel;if(t.length!=Z.getNumDataCodewords(a,s))throw new RangeError("Invalid argument");const n=Z.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][a],m=Z.ECC_CODEWORDS_PER_BLOCK[s.ordinal][a],p=Math.floor(Z.getNumRawDataModules(a)/8),c=n-p%n,D=Math.floor(p/n);let A=[];const q=Z.reedSolomonComputeDivisor(m);for(let C=0,S=0;C<n;C++){let x=t.slice(S,S+D-m+(C<c?0:1));S+=x.length;const T=Z.reedSolomonComputeRemainder(x,q);C<c&&x.push(0),A.push(x.concat(T))}let g=[];for(let C=0;C<A[0].length;C++)A.forEach((S,x)=>{(C!=D-m||x>=c)&&g.push(S[C])});return y(g.length==p),g}drawCodewords(t){if(t.length!=Math.floor(Z.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let a=0;for(let s=this.size-1;s>=1;s-=2){s==6&&(s=5);for(let n=0;n<this.size;n++)for(let m=0;m<2;m++){const p=s-m,D=(s+1&2)==0?this.size-1-n:n;!this.isFunction[D][p]&&a<t.length*8&&(this.modules[D][p]=h(t[a>>>3],7-(a&7)),a++)}}y(a==t.length*8)}applyMask(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(let a=0;a<this.size;a++)for(let s=0;s<this.size;s++){let n;switch(t){case 0:n=(s+a)%2==0;break;case 1:n=a%2==0;break;case 2:n=s%3==0;break;case 3:n=(s+a)%3==0;break;case 4:n=(Math.floor(s/3)+Math.floor(a/2))%2==0;break;case 5:n=s*a%2+s*a%3==0;break;case 6:n=(s*a%2+s*a%3)%2==0;break;case 7:n=((s+a)%2+s*a%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[a][s]&&n&&(this.modules[a][s]=!this.modules[a][s])}}getPenaltyScore(){let t=0;for(let m=0;m<this.size;m++){let p=!1,c=0,D=[0,0,0,0,0,0,0];for(let A=0;A<this.size;A++)this.modules[m][A]==p?(c++,c==5?t+=Z.PENALTY_N1:c>5&&t++):(this.finderPenaltyAddHistory(c,D),p||(t+=this.finderPenaltyCountPatterns(D)*Z.PENALTY_N3),p=this.modules[m][A],c=1);t+=this.finderPenaltyTerminateAndCount(p,c,D)*Z.PENALTY_N3}for(let m=0;m<this.size;m++){let p=!1,c=0,D=[0,0,0,0,0,0,0];for(let A=0;A<this.size;A++)this.modules[A][m]==p?(c++,c==5?t+=Z.PENALTY_N1:c>5&&t++):(this.finderPenaltyAddHistory(c,D),p||(t+=this.finderPenaltyCountPatterns(D)*Z.PENALTY_N3),p=this.modules[A][m],c=1);t+=this.finderPenaltyTerminateAndCount(p,c,D)*Z.PENALTY_N3}for(let m=0;m<this.size-1;m++)for(let p=0;p<this.size-1;p++){const c=this.modules[m][p];c==this.modules[m][p+1]&&c==this.modules[m+1][p]&&c==this.modules[m+1][p+1]&&(t+=Z.PENALTY_N2)}let a=0;for(const m of this.modules)a=m.reduce((p,c)=>p+(c?1:0),a);const s=this.size*this.size,n=Math.ceil(Math.abs(a*20-s*10)/s)-1;return y(0<=n&&n<=9),t+=n*Z.PENALTY_N4,y(0<=t&&t<=2568888),t}getAlignmentPatternPositions(){if(this.version==1)return[];{const t=Math.floor(this.version/7)+2,a=this.version==32?26:Math.ceil((this.version*4+4)/(t*2-2))*2;let s=[6];for(let n=this.size-7;s.length<t;n-=a)s.splice(1,0,n);return s}}static getNumRawDataModules(t){if(t<Z.MIN_VERSION||t>Z.MAX_VERSION)throw new RangeError("Version number out of range");let a=(16*t+128)*t+64;if(t>=2){const s=Math.floor(t/7)+2;a-=(25*s-10)*s-55,t>=7&&(a-=36)}return y(208<=a&&a<=29648),a}static getNumDataCodewords(t,a){return Math.floor(Z.getNumRawDataModules(t)/8)-Z.ECC_CODEWORDS_PER_BLOCK[a.ordinal][t]*Z.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw new RangeError("Degree out of range");let a=[];for(let n=0;n<t-1;n++)a.push(0);a.push(1);let s=1;for(let n=0;n<t;n++){for(let m=0;m<a.length;m++)a[m]=Z.reedSolomonMultiply(a[m],s),m+1<a.length&&(a[m]^=a[m+1]);s=Z.reedSolomonMultiply(s,2)}return a}static reedSolomonComputeRemainder(t,a){let s=a.map(n=>0);for(const n of t){const m=n^s.shift();s.push(0),a.forEach((p,c)=>s[c]^=Z.reedSolomonMultiply(p,m))}return s}static reedSolomonMultiply(t,a){if(t>>>8||a>>>8)throw new RangeError("Byte out of range");let s=0;for(let n=7;n>=0;n--)s=s<<1^(s>>>7)*285,s^=(a>>>n&1)*t;return y(s>>>8==0),s}finderPenaltyCountPatterns(t){const a=t[1];y(a<=this.size*3);const s=a>0&&t[2]==a&&t[3]==a*3&&t[4]==a&&t[5]==a;return(s&&t[0]>=a*4&&t[6]>=a?1:0)+(s&&t[6]>=a*4&&t[0]>=a?1:0)}finderPenaltyTerminateAndCount(t,a,s){return t&&(this.finderPenaltyAddHistory(a,s),a=0),a+=this.size,this.finderPenaltyAddHistory(a,s),this.finderPenaltyCountPatterns(s)}finderPenaltyAddHistory(t,a){a[0]==0&&(t+=this.size),a.pop(),a.unshift(t)}};F.MIN_VERSION=1,F.MAX_VERSION=40,F.PENALTY_N1=3,F.PENALTY_N2=3,F.PENALTY_N3=40,F.PENALTY_N4=10,F.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],F.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],o.QrCode=F;function _(L,t,a){if(t<0||t>31||L>>>t)throw new RangeError("Value out of range");for(let s=t-1;s>=0;s--)a.push(L>>>s&1)}function h(L,t){return(L>>>t&1)!=0}function y(L){if(!L)throw new Error("Assertion error")}const b=class te{constructor(t,a,s){if(this.mode=t,this.numChars=a,this.bitData=s,a<0)throw new RangeError("Invalid argument");this.bitData=s.slice()}static makeBytes(t){let a=[];for(const s of t)_(s,8,a);return new te(te.Mode.BYTE,t.length,a)}static makeNumeric(t){if(!te.isNumeric(t))throw new RangeError("String contains non-numeric characters");let a=[];for(let s=0;s<t.length;){const n=Math.min(t.length-s,3);_(parseInt(t.substring(s,s+n),10),n*3+1,a),s+=n}return new te(te.Mode.NUMERIC,t.length,a)}static makeAlphanumeric(t){if(!te.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");let a=[],s;for(s=0;s+2<=t.length;s+=2){let n=te.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s))*45;n+=te.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s+1)),_(n,11,a)}return s<t.length&&_(te.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s)),6,a),new te(te.Mode.ALPHANUMERIC,t.length,a)}static makeSegments(t){return t==""?[]:te.isNumeric(t)?[te.makeNumeric(t)]:te.isAlphanumeric(t)?[te.makeAlphanumeric(t)]:[te.makeBytes(te.toUtf8ByteArray(t))]}static makeEci(t){let a=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)_(t,8,a);else if(t<16384)_(2,2,a),_(t,14,a);else if(t<1e6)_(6,3,a),_(t,21,a);else throw new RangeError("ECI assignment value out of range");return new te(te.Mode.ECI,0,a)}static isNumeric(t){return te.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return te.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(t,a){let s=0;for(const n of t){const m=n.mode.numCharCountBits(a);if(n.numChars>=1<<m)return 1/0;s+=4+m+n.bitData.length}return s}static toUtf8ByteArray(t){t=encodeURI(t);let a=[];for(let s=0;s<t.length;s++)t.charAt(s)!="%"?a.push(t.charCodeAt(s)):(a.push(parseInt(t.substring(s+1,s+3),16)),s+=2);return a}};b.NUMERIC_REGEX=/^[0-9]*$/,b.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,b.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let N=b;o.QrSegment=b})(Re||(Re={}));(o=>{(F=>{const _=class{constructor(y,b){this.ordinal=y,this.formatBits=b}};_.LOW=new _(0,1),_.MEDIUM=new _(1,0),_.QUARTILE=new _(2,3),_.HIGH=new _(3,2),F.Ecc=_})(o.QrCode||(o.QrCode={}))})(Re||(Re={}));(o=>{(F=>{const _=class{constructor(y,b){this.modeBits=y,this.numBitsCharCount=b}numCharCountBits(y){return this.numBitsCharCount[Math.floor((y+7)/17)]}};_.NUMERIC=new _(1,[10,12,14]),_.ALPHANUMERIC=new _(2,[9,11,13]),_.BYTE=new _(4,[8,16,16]),_.KANJI=new _(8,[8,10,12]),_.ECI=new _(7,[0,0,0]),F.Mode=_})(o.QrSegment||(o.QrSegment={}))})(Re||(Re={}));var Oe=Re;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Wt={L:Oe.QrCode.Ecc.LOW,M:Oe.QrCode.Ecc.MEDIUM,Q:Oe.QrCode.Ecc.QUARTILE,H:Oe.QrCode.Ecc.HIGH},Zs=128,et="L",st="#FFFFFF",tt="#000000",at=!1,rt=1,Qt=4,Jt=0,Kt=.1;function lt(o,F=0){const _=[];return o.forEach(function(h,y){let b=null;h.forEach(function(N,L){if(!N&&b!==null){_.push(`M${b+F} ${y+F}h${L-b}v1H${b+F}z`),b=null;return}if(L===h.length-1){if(!N)return;b===null?_.push(`M${L+F},${y+F} h1v1H${L+F}z`):_.push(`M${b+F},${y+F} h${L+1-b}v1H${b+F}z`);return}N&&b===null&&(b=L)})}),_.join("")}function nt(o,F){return o.slice().map((_,h)=>h<F.y||h>=F.y+F.h?_:_.map((y,b)=>b<F.x||b>=F.x+F.w?y:!1))}function Yt(o,F,_,h){if(h==null)return null;const y=o.length+_*2,b=Math.floor(F*Kt),N=y/F,L=(h.width||b)*N,t=(h.height||b)*N,a=h.x==null?o.length/2-L/2:h.x*N,s=h.y==null?o.length/2-t/2:h.y*N,n=h.opacity==null?1:h.opacity;let m=null;if(h.excavate){let c=Math.floor(a),D=Math.floor(s),A=Math.ceil(L+a-c),q=Math.ceil(t+s-D);m={x:c,y:D,w:A,h:q}}const p=h.crossOrigin;return{x:a,y:s,h:t,w:L,excavation:m,opacity:n,crossOrigin:p}}function Xt(o,F){return F!=null?Math.max(Math.floor(F),0):o?Qt:Jt}function it({value:o,level:F,minVersion:_,includeMargin:h,marginSize:y,imageSettings:b,size:N,boostLevel:L}){let t=re.useMemo(()=>{const c=(Array.isArray(o)?o:[o]).reduce((D,A)=>(D.push(...Oe.QrSegment.makeSegments(A)),D),[]);return Oe.QrCode.encodeSegments(c,Wt[F],_,void 0,void 0,L)},[o,F,_,L]);const{cells:a,margin:s,numCells:n,calculatedImageSettings:m}=re.useMemo(()=>{let p=t.getModules();const c=Xt(h,y),D=p.length+c*2,A=Yt(p,N,c,b);return{cells:p,margin:c,numCells:D,calculatedImageSettings:A}},[t,N,b,h,y]);return{qrcode:t,margin:s,cells:a,numCells:n,calculatedImageSettings:m}}var Zt=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),ea=re.forwardRef(function(F,_){const h=F,{value:y,size:b=Zs,level:N=et,bgColor:L=st,fgColor:t=tt,includeMargin:a=at,minVersion:s=rt,boostLevel:n,marginSize:m,imageSettings:p}=h,D=gs(h,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:A}=D,q=gs(D,["style"]),g=p==null?void 0:p.src,C=re.useRef(null),S=re.useRef(null),x=re.useCallback(R=>{C.current=R,typeof _=="function"?_(R):_&&(_.current=R)},[_]),[T,P]=re.useState(!1),{margin:z,cells:M,numCells:U,calculatedImageSettings:w}=it({value:y,level:N,minVersion:s,boostLevel:n,includeMargin:a,marginSize:m,imageSettings:p,size:b});re.useEffect(()=>{if(C.current!=null){const R=C.current,j=R.getContext("2d");if(!j)return;let Y=M;const X=S.current,i=w!=null&&X!==null&&X.complete&&X.naturalHeight!==0&&X.naturalWidth!==0;i&&w.excavation!=null&&(Y=nt(M,w.excavation));const $=window.devicePixelRatio||1;R.height=R.width=b*$;const V=b/U*$;j.scale(V,V),j.fillStyle=L,j.fillRect(0,0,U,U),j.fillStyle=t,Zt?j.fill(new Path2D(lt(Y,z))):M.forEach(function(f,G){f.forEach(function(Q,v){Q&&j.fillRect(v+z,G+z,1,1)})}),w&&(j.globalAlpha=w.opacity),i&&j.drawImage(X,w.x+z,w.y+z,w.w,w.h)}}),re.useEffect(()=>{P(!1)},[g]);const k=ps({height:b,width:b},A);let u=null;return g!=null&&(u=re.createElement("img",{src:g,key:g,style:{display:"none"},onLoad:()=>{P(!0)},ref:S,crossOrigin:w==null?void 0:w.crossOrigin})),re.createElement(re.Fragment,null,re.createElement("canvas",ps({style:k,height:b,width:b,ref:x,role:"img"},q)),u)});ea.displayName="QRCodeCanvas";var ct=re.forwardRef(function(F,_){const h=F,{value:y,size:b=Zs,level:N=et,bgColor:L=st,fgColor:t=tt,includeMargin:a=at,minVersion:s=rt,boostLevel:n,title:m,marginSize:p,imageSettings:c}=h,D=gs(h,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:A,cells:q,numCells:g,calculatedImageSettings:C}=it({value:y,level:N,minVersion:s,boostLevel:n,includeMargin:a,marginSize:p,imageSettings:c,size:b});let S=q,x=null;c!=null&&C!=null&&(C.excavation!=null&&(S=nt(q,C.excavation)),x=re.createElement("image",{href:c.src,height:C.h,width:C.w,x:C.x+A,y:C.y+A,preserveAspectRatio:"none",opacity:C.opacity,crossOrigin:C.crossOrigin}));const T=lt(S,A);return re.createElement("svg",ps({height:b,width:b,viewBox:`0 0 ${g} ${g}`,ref:_,role:"img"},D),!!m&&re.createElement("title",null,m),re.createElement("path",{fill:L,d:`M0,0 h${g}v${g}H0z`,shapeRendering:"crispEdges"}),re.createElement("path",{fill:t,d:T,shapeRendering:"crispEdges"}),x)});ct.displayName="QRCodeSVG";const sa=()=>{const[o,F]=r.useState(!1),[_,h]=r.useState(!0),[y,b]=r.useState("idle"),[N,L]=r.useState(""),[t,a]=r.useState(""),[s,n]=r.useState([]),[m,p]=r.useState(""),[c,D]=r.useState(!1),[A,q]=r.useState(!1),[g,C]=r.useState(""),[S,x]=r.useState(""),[T,P]=r.useState(!1),[z,M]=r.useState(!1),[U,w]=r.useState(""),[k,u]=r.useState(""),[R,j]=r.useState(!1);r.useEffect(()=>{Y()},[]);const Y=async()=>{h(!0);try{const v=await ts.me();F(v.data.mfa_enabled||!1)}catch(v){console.error("Failed to check MFA status:",v)}finally{h(!1)}},X=async()=>{var v,H;try{const d=await ss.setup();L(d.data.secret),a(d.data.qr_code_url),n(d.data.recovery_codes),b("scan-qr")}catch(d){const W=d;l.error(((H=(v=W.response)==null?void 0:v.data)==null?void 0:H.error)||"Failed to initialize MFA setup")}},i=async v=>{var H,d;if(v.preventDefault(),!m||m.length!==6){l.error("Please enter a valid 6-digit code");return}D(!0);try{await ss.verifySetup({totp_code:m}),l.success("MFA enabled successfully!"),b("show-recovery"),F(!0)}catch(W){const K=W;l.error(((d=(H=K.response)==null?void 0:H.data)==null?void 0:d.error)||"Invalid verification code")}finally{D(!1)}},$=()=>{b("idle"),L(""),a(""),n([]),p("")},V=async v=>{var H,d;if(v.preventDefault(),!g||!S){l.error("Password and TOTP code are required");return}P(!0);try{await ss.disable({password:g,totp_code:S}),l.success("MFA disabled successfully"),F(!1),q(!1),C(""),x("")}catch(W){const K=W;l.error(((d=(H=K.response)==null?void 0:H.data)==null?void 0:d.error)||"Failed to disable MFA")}finally{P(!1)}},f=async v=>{var H,d;if(v.preventDefault(),!U||!k){l.error("Password and TOTP code are required");return}j(!0);try{const W=await ss.regenerateRecoveryCodes({password:U,totp_code:k});n(W.data.recovery_codes),l.success("Recovery codes regenerated successfully"),M(!1),w(""),u(""),b("show-recovery")}catch(W){const K=W;l.error(((d=(H=K.response)==null?void 0:H.data)==null?void 0:d.error)||"Failed to regenerate recovery codes")}finally{j(!1)}},G=v=>{navigator.clipboard.writeText(v),l.success("Copied to clipboard")},Q=()=>{const v=new Blob([s.join(`
`)],{type:"text/plain"}),H=URL.createObjectURL(v),d=document.createElement("a");d.href=H,d.download="heroforge-recovery-codes.txt",document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(H),l.success("Recovery codes downloaded")};return _?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):y!=="idle"?e.jsx("div",{className:"space-y-6",children:e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Enable Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{className:y==="scan-qr"?"text-primary":"",children:"1. Scan QR"}),e.jsx("span",{children:""}),e.jsx("span",{className:y==="verify-code"?"text-primary":"",children:"2. Verify"}),e.jsx("span",{children:""}),e.jsx("span",{className:y==="show-recovery"?"text-primary":"",children:"3. Save Codes"})]})]}),y==="scan-qr"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 1: Scan QR Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Use an authenticator app like Google Authenticator, Authy, or 1Password to scan this QR code:"}),t&&e.jsx("div",{className:"bg-white p-4 rounded-lg mb-4",children:e.jsx(ct,{value:t,size:256,level:"M",marginSize:2})}),e.jsxs("div",{className:"mt-4 w-full max-w-md",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Or enter this secret manually:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(J,{type:"text",value:N,readOnly:!0,className:"font-mono text-sm flex-1"}),e.jsx(E,{variant:"secondary",onClick:()=>G(N),children:e.jsx(he,{className:"h-4 w-4"})})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(E,{variant:"primary",onClick:()=>b("verify-code"),children:"Next: Verify Code"})})]}),y==="verify-code"&&e.jsxs("form",{onSubmit:i,className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Ns,{className:"h-12 w-12 text-primary mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 2: Verify Your Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Enter the 6-digit code from your authenticator app to confirm setup:"}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsx(J,{type:"text",value:m,onChange:v=>p(v.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center text-2xl tracking-widest font-mono",maxLength:6,autoFocus:!0})})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:()=>b("scan-qr"),children:"Back"}),e.jsx(E,{type:"submit",variant:"primary",loading:c,disabled:c||m.length!==6,children:"Verify & Enable MFA"})]})]}),y==="show-recovery"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ge,{className:"h-6 w-6 text-yellow-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-yellow-400 mb-2",children:"Save Your Recovery Codes"}),e.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Store these recovery codes in a safe place. Each code can be used once to access your account if you lose your authenticator device."}),e.jsx("div",{className:"grid grid-cols-2 gap-2 bg-dark-bg rounded-lg p-4 font-mono text-sm mb-4",children:s.map((v,H)=>e.jsxs("div",{className:"text-white",children:[H+1,". ",v]},H))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(E,{variant:"secondary",onClick:()=>G(s.join(`
`)),children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Copy Codes"]}),e.jsxs(E,{variant:"secondary",onClick:Q,children:[e.jsx(Gs,{className:"h-4 w-4 mr-2"}),"Download Codes"]})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(E,{variant:"primary",onClick:$,children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Finish Setup"]})})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ue,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-start justify-between mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[o?e.jsx(me,{className:"h-6 w-6 text-green-400 flex-shrink-0"}):e.jsx(ge,{className:"h-6 w-6 text-yellow-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white mb-1",children:o?"MFA Enabled":"MFA Disabled"}),e.jsx("p",{className:"text-sm text-slate-400",children:o?"Your account is protected with two-factor authentication.":"Enable MFA to add an extra layer of security to your account."})]})]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${o?"bg-green-400":"bg-yellow-400"}`})]}),o?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Xe,{className:"h-5 w-5 text-primary"}),e.jsx("h5",{className:"font-medium text-white",children:"Recovery Codes"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Generate new recovery codes if you've lost the originals or used them."}),e.jsx(E,{variant:"secondary",size:"sm",onClick:()=>M(!0),children:"Regenerate Codes"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ze,{className:"h-5 w-5 text-red-400"}),e.jsx("h5",{className:"font-medium text-white",children:"Disable MFA"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Turn off two-factor authentication for your account."}),e.jsx(E,{variant:"danger",size:"sm",onClick:()=>q(!0),children:"Disable MFA"})]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h5",{className:"text-white font-medium mb-2",children:"Why enable MFA?"}),e.jsxs("ul",{className:"text-sm text-slate-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Adds an extra layer of security beyond your password"}),e.jsx("li",{children:"Prevents unauthorized access even if your password is compromised"}),e.jsx("li",{children:"Uses time-based codes from your smartphone"}),e.jsx("li",{children:"Industry standard for securing sensitive accounts"})]})]}),e.jsxs(E,{variant:"primary",onClick:X,children:[e.jsx(Ns,{className:"h-4 w-4 mr-2"}),"Enable Two-Factor Authentication"]})]})]}),A&&e.jsx(B,{children:e.jsxs("form",{onSubmit:V,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Disable Two-Factor Authentication"}),e.jsxs("button",{type:"button",onClick:()=>{q(!1),C(""),x("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"Disabling MFA will make your account less secure. You'll need to provide your password and a TOTP code to confirm."})}),e.jsx(J,{label:"Password",type:"password",value:g,onChange:v=>C(v.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(J,{label:"TOTP Code",type:"text",value:S,onChange:v=>x(v.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:()=>{q(!1),C(""),x("")},children:"Cancel"}),e.jsx(E,{type:"submit",variant:"danger",loading:T,disabled:T||!g||S.length!==6,children:"Disable MFA"})]})]})}),z&&e.jsx(B,{children:e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Regenerate Recovery Codes"}),e.jsxs("button",{type:"button",onClick:()=>{M(!1),w(""),u("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"This will invalidate all existing recovery codes. Make sure to save the new codes in a safe place."})}),e.jsx(J,{label:"Password",type:"password",value:U,onChange:v=>w(v.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(J,{label:"TOTP Code",type:"text",value:k,onChange:v=>u(v.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:()=>{M(!1),w(""),u("")},children:"Cancel"}),e.jsx(E,{type:"submit",variant:"primary",loading:R,disabled:R||!U||k.length!==6,children:"Generate New Codes"})]})]})})]})},ta=()=>{const[o,F]=r.useState([]),[_,h]=r.useState(!0),[y,b]=r.useState(!1),[N,L]=r.useState(""),[t,a]=r.useState(!1),[s,n]=r.useState(null),[m,p]=r.useState(null),[c,D]=r.useState(!1);r.useEffect(()=>{A()},[]);const A=async()=>{h(!0);try{const x=await cs.getAll();F(x.data)}catch(x){l.error("Failed to load API keys"),console.error(x)}finally{h(!1)}},q=async()=>{var x,T;if(!N.trim()){l.error("Please enter a name for the API key");return}a(!0);try{const P=await cs.create({name:N.trim()});n(P.data),L(""),await A(),l.success("API key created successfully")}catch(P){const z=P;l.error(((T=(x=z.response)==null?void 0:x.data)==null?void 0:T.error)||"Failed to create API key")}finally{a(!1)}},g=async()=>{var x,T;if(m){D(!0);try{await cs.delete(m.id),await A(),l.success(`API key "${m.name}" revoked successfully`),p(null)}catch(P){const z=P;l.error(((T=(x=z.response)==null?void 0:x.data)==null?void 0:T.error)||"Failed to revoke API key")}finally{D(!1)}}},C=x=>{navigator.clipboard.writeText(x),l.success("API key copied to clipboard")},S=()=>{n(null),b(!1)};return _?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Keys"})]}),e.jsxs(E,{variant:"primary",onClick:()=>b(!0),className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"Create API Key"]})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"API keys allow programmatic access to HeroForge. Keep your keys secure and never share them publicly."}),o.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Xe,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No API keys yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Create your first API key to get started"})]}):e.jsx("div",{className:"space-y-3",children:o.map(x=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary/30 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-medium text-white",children:x.name}),e.jsxs("code",{className:"px-2 py-1 bg-dark-surface rounded text-xs text-slate-400 font-mono",children:[x.prefix,"..."]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ns,{className:"h-3 w-3"}),"Created ",new Date(x.created_at).toLocaleDateString()]}),x.last_used_at&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fe,{className:"h-3 w-3"}),"Last used ",new Date(x.last_used_at).toLocaleDateString()]}),!x.last_used_at&&e.jsx("span",{className:"text-amber-500",children:"Never used"})]})]}),e.jsxs(E,{variant:"danger",size:"sm",onClick:()=>p(x),className:"flex items-center gap-2","aria-label":`Revoke API key ${x.name}`,children:[e.jsx(le,{className:"h-4 w-4"}),"Revoke"]})]},x.id))})]}),y&&!s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Create API Key"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Key Name"}),e.jsx("input",{type:"text",value:N,onChange:x=>L(x.target.value),placeholder:"e.g., Production Server, CI/CD Pipeline",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",autoFocus:!0}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Give your API key a descriptive name to remember where it's used"})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4",children:[e.jsx(E,{variant:"secondary",onClick:()=>{b(!1),L("")},children:"Cancel"}),e.jsx(E,{variant:"primary",onClick:q,disabled:t||!N.trim(),children:t?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Creating..."})]}):"Create Key"})]})]})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-2xl w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(me,{className:"h-6 w-6 text-green-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Key Created Successfully"})]}),e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-amber-200 font-medium mb-2",children:"Important: Save your API key now!"}),e.jsx("p",{className:"text-xs text-amber-300/70",children:"This is the only time you'll see the full key. If you lose it, you'll need to create a new one."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"API Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("code",{className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-3 text-white font-mono text-sm break-all",children:s.key}),e.jsxs(E,{variant:"secondary",onClick:()=>C(s.key),className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),"Copy"]})]})]}),e.jsxs("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-200 mb-2",children:"Using your API key"}),e.jsx("p",{className:"text-xs text-blue-300/70 mb-3",children:"Include your API key in the X-API-Key header:"}),e.jsxs("code",{className:"block bg-dark-bg border border-dark-border rounded px-3 py-2 text-xs text-slate-300 font-mono",children:['curl -H "X-API-Key: ',s.key,'" https://heroforge.example.com/api/scans']})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(E,{variant:"primary",onClick:S,children:"Done"})})]})]})}),e.jsx(_e,{isOpen:!!m,onClose:()=>p(null),onConfirm:g,title:"Revoke API Key",message:`Are you sure you want to revoke the API key "${m==null?void 0:m.name}"? Any applications using this key will lose access immediately.`,confirmLabel:"Revoke Key",variant:"danger",loading:c})]})},aa=()=>{const[o,F]=r.useState(!0),[_,h]=r.useState(!1),[y,b]=r.useState(!1),[N,L]=r.useState(!1),[t,a]=r.useState({jira_url:"",username:"",api_token:"",project_key:"",issue_type:"Task",default_assignee:"",enabled:!0}),[s,n]=r.useState([]),[m,p]=r.useState([]),[c,D]=r.useState(!1);r.useEffect(()=>{A()},[]);const A=async()=>{var x;F(!0);try{const T=await He.getSettings();a(T.data),L(!0)}catch(T){((x=T.response)==null?void 0:x.status)===404?L(!1):console.error("Failed to load JIRA settings:",T)}finally{F(!1)}},q=async()=>{var x,T;if(!t.jira_url||!t.username||!t.api_token||!t.project_key){l.error("Please fill in all required fields");return}h(!0);try{await He.updateSettings(t),l.success("JIRA settings saved successfully"),L(!0)}catch(P){const z=P;console.error("Failed to save JIRA settings:",P),l.error(((T=(x=z.response)==null?void 0:x.data)==null?void 0:T.error)||"Failed to save JIRA settings")}finally{h(!1)}},g=async()=>{var x,T;if(!N){l.error("Please save your settings first");return}b(!0);try{await He.testConnection(),l.success("JIRA connection successful!")}catch(P){const z=P;console.error("JIRA connection failed:",P),l.error(((T=(x=z.response)==null?void 0:x.data)==null?void 0:T.error)||"JIRA connection failed")}finally{b(!1)}},C=async()=>{var x,T;if(!N){l.error("Please save your settings first");return}D(!0);try{const P=await He.listProjects();n(P.data),l.success(`Loaded ${P.data.length} projects`)}catch(P){const z=P;console.error("Failed to load projects:",P),l.error(((T=(x=z.response)==null?void 0:x.data)==null?void 0:T.error)||"Failed to load projects")}finally{D(!1)}},S=async()=>{var x,T;if(!N||!t.project_key){l.error("Please save your settings and select a project first");return}D(!0);try{const P=await He.listIssueTypes();p(P.data),l.success(`Loaded ${P.data.length} issue types`)}catch(P){const z=P;console.error("Failed to load issue types:",P),l.error(((T=(x=z.response)==null?void 0:x.data)==null?void 0:T.error)||"Failed to load issue types")}finally{D(!1)}};return o?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(is,{className:"h-6 w-6 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"JIRA Integration"})]}),e.jsxs("div",{className:"space-y-4",children:[!N&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(ge,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"JIRA Integration Not Configured"}),e.jsx("p",{children:"Configure your JIRA instance to automatically create tickets from vulnerabilities."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["JIRA URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"url",placeholder:"https://your-domain.atlassian.net",value:t.jira_url,onChange:x=>a({...t,jira_url:x.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your JIRA instance URL (e.g., https://company.atlassian.net)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Username/Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"text",placeholder:"user@example.com",value:t.username,onChange:x=>a({...t,username:x.target.value})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["API Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"password",placeholder:"Your JIRA API token",value:t.api_token,onChange:x=>a({...t,api_token:x.target.value})}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Generate an API token at"," ",e.jsxs("a",{href:"https://id.atlassian.com/manage-profile/security/api-tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 inline-flex items-center gap-1",children:["Atlassian Account Settings ",e.jsx(es,{className:"h-3 w-3"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Key ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:s.length>0?e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:t.project_key,onChange:x=>a({...t,project_key:x.target.value}),children:[e.jsx("option",{value:"",children:"Select a project"}),s.map(x=>e.jsxs("option",{value:x.key,children:[x.name," (",x.key,")"]},x.key))]}):e.jsx(J,{type:"text",placeholder:"PROJECT",value:t.project_key,onChange:x=>a({...t,project_key:x.target.value})})}),e.jsx(E,{onClick:C,disabled:!N||c,variant:"secondary",children:c?"Loading...":"Load Projects"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Issue Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:m.length>0?e.jsx("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:t.issue_type,onChange:x=>a({...t,issue_type:x.target.value}),children:m.map(x=>e.jsx("option",{value:x.name,children:x.name},x.id))}):e.jsx(J,{type:"text",placeholder:"Task",value:t.issue_type,onChange:x=>a({...t,issue_type:x.target.value})})}),e.jsx(E,{onClick:S,disabled:!N||!t.project_key||c,variant:"secondary",children:c?"Loading...":"Load Types"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Assignee (optional)"}),e.jsx(J,{type:"text",placeholder:"username",value:t.default_assignee||"",onChange:x=>a({...t,default_assignee:x.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Leave empty for unassigned or enter a JIRA username"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"jira-enabled",checked:t.enabled,onChange:x=>a({...t,enabled:x.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"jira-enabled",className:"text-sm font-medium text-gray-700",children:"Enable JIRA integration"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(E,{onClick:q,disabled:_,children:_?"Saving...":"Save Settings"}),e.jsx(E,{onClick:g,disabled:!N||y,variant:"secondary",children:y?"Testing...":"Test Connection"})]}),N&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(me,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("p",{className:"font-medium",children:"JIRA Integration Configured"}),e.jsx("p",{children:"You can now create JIRA tickets from vulnerabilities."})]})]})]})]}),e.jsxs(B,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"How to Use JIRA Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Configure your JIRA instance settings above and test the connection."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Navigate to any vulnerability in your scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"3"})}),e.jsx("p",{children:'Click the "Create JIRA Ticket" button to automatically create an issue with vulnerability details.'})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"The vulnerability will be linked to the JIRA ticket, and you can track it in your JIRA project."})]})]})]})]})},ra=()=>{const[o,F]=r.useState(!0),[_,h]=r.useState(!1),[y,b]=r.useState(!1),[N,L]=r.useState(!1),[t,a]=r.useState({instance_url:"",username:"",password:"",default_assignment_group:"",default_category:"",default_impact:3,default_urgency:3,enabled:!0}),[s,n]=r.useState([]),[m,p]=r.useState([]),[c,D]=r.useState(!1),[A,q]=r.useState(!1);r.useEffect(()=>{g()},[]);const g=async()=>{var M;F(!0);try{const w=(await We.getSettings()).data;a({instance_url:w.instance_url||"",username:w.username||"",password:"",default_assignment_group:w.default_assignment_group||"",default_category:w.default_category||"",default_impact:w.default_impact||3,default_urgency:w.default_urgency||3,enabled:w.enabled}),L(!0)}catch(U){((M=U.response)==null?void 0:M.status)===404?L(!1):console.error("Failed to load ServiceNow settings:",U)}finally{F(!1)}},C=async()=>{var M,U;if(!t.instance_url||!t.username||!t.password){l.error("Please fill in all required fields");return}if(!t.instance_url.startsWith("https://")){l.error("Instance URL must start with https://");return}h(!0);try{await We.updateSettings({instance_url:t.instance_url,username:t.username,password:t.password,default_assignment_group:t.default_assignment_group||void 0,default_category:t.default_category||void 0,default_impact:t.default_impact,default_urgency:t.default_urgency,enabled:t.enabled}),l.success("ServiceNow settings saved successfully"),L(!0)}catch(w){const k=w;console.error("Failed to save ServiceNow settings:",w),l.error(((U=(M=k.response)==null?void 0:M.data)==null?void 0:U.error)||"Failed to save ServiceNow settings")}finally{h(!1)}},S=async()=>{var M,U;if(!N){l.error("Please save your settings first");return}b(!0);try{await We.testConnection(),l.success("ServiceNow connection successful!")}catch(w){const k=w;console.error("ServiceNow connection failed:",w),l.error(((U=(M=k.response)==null?void 0:M.data)==null?void 0:U.error)||"ServiceNow connection failed")}finally{b(!1)}},x=async()=>{var M,U;if(!N){l.error("Please save your settings first");return}D(!0);try{const w=await We.getAssignmentGroups();n(w.data),l.success(`Loaded ${w.data.length} assignment groups`)}catch(w){const k=w;console.error("Failed to load assignment groups:",w),l.error(((U=(M=k.response)==null?void 0:M.data)==null?void 0:U.error)||"Failed to load assignment groups")}finally{D(!1)}},T=async()=>{var M,U;if(!N){l.error("Please save your settings first");return}q(!0);try{const w=await We.getCategories();p(w.data),l.success(`Loaded ${w.data.length} categories`)}catch(w){const k=w;console.error("Failed to load categories:",w),l.error(((U=(M=k.response)==null?void 0:M.data)==null?void 0:U.error)||"Failed to load categories")}finally{q(!1)}},P=[{value:1,label:"1 - High"},{value:2,label:"2 - Medium"},{value:3,label:"3 - Low"}],z=[{value:1,label:"1 - High"},{value:2,label:"2 - Medium"},{value:3,label:"3 - Low"}];return o?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Vs,{className:"h-6 w-6 text-green-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"ServiceNow Integration"})]}),e.jsxs("div",{className:"space-y-4",children:[!N&&e.jsxs("div",{className:"bg-blue-900/30 border border-blue-700 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(ge,{className:"h-5 w-5 text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-300",children:[e.jsx("p",{className:"font-medium mb-1",children:"ServiceNow Integration Not Configured"}),e.jsx("p",{children:"Configure your ServiceNow instance to create incidents and change requests from vulnerabilities."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Instance URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"url",placeholder:"https://yourcompany.service-now.com",value:t.instance_url,onChange:M=>a({...t,instance_url:M.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your ServiceNow instance URL (e.g., https://company.service-now.com)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"text",placeholder:"username",value:t.username,onChange:M=>a({...t,username:M.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"ServiceNow user with API access permissions"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"password",placeholder:N?"********":"Enter password",value:t.password,onChange:M=>a({...t,password:M.target.value})}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Password for the ServiceNow user. Consider using a"," ",e.jsxs("a",{href:"https://docs.servicenow.com/bundle/tokyo-platform-security/page/administer/users/concept/c_OAuthApplications.html",target:"_blank",rel:"noopener noreferrer",className:"text-cyan-400 hover:text-cyan-300 inline-flex items-center gap-1",children:["OAuth token ",e.jsx(es,{className:"h-3 w-3"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Assignment Group"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:s.length>0?e.jsxs("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:t.default_assignment_group,onChange:M=>a({...t,default_assignment_group:M.target.value}),children:[e.jsx("option",{value:"",children:"Select an assignment group"}),s.map(M=>e.jsx("option",{value:M.sys_id,children:M.name},M.sys_id))]}):e.jsx(J,{type:"text",placeholder:"Group sys_id or name",value:t.default_assignment_group,onChange:M=>a({...t,default_assignment_group:M.target.value})})}),e.jsx(E,{onClick:x,disabled:!N||c,variant:"secondary",children:c?"Loading...":"Load Groups"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Category"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:m.length>0?e.jsxs("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:t.default_category,onChange:M=>a({...t,default_category:M.target.value}),children:[e.jsx("option",{value:"",children:"Select a category"}),m.map(M=>e.jsx("option",{value:M.value,children:M.label},M.value))]}):e.jsx(J,{type:"text",placeholder:"security",value:t.default_category,onChange:M=>a({...t,default_category:M.target.value})})}),e.jsx(E,{onClick:T,disabled:!N||A,variant:"secondary",children:A?"Loading...":"Load Categories"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Impact"}),e.jsx("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:t.default_impact,onChange:M=>a({...t,default_impact:parseInt(M.target.value)}),children:P.map(M=>e.jsx("option",{value:M.value,children:M.label},M.value))}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Auto-calculated from severity when creating tickets"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Urgency"}),e.jsx("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:t.default_urgency,onChange:M=>a({...t,default_urgency:parseInt(M.target.value)}),children:z.map(M=>e.jsx("option",{value:M.value,children:M.label},M.value))}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Auto-calculated from severity when creating tickets"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"servicenow-enabled",checked:t.enabled,onChange:M=>a({...t,enabled:M.target.checked}),className:"h-4 w-4 text-cyan-500 focus:ring-cyan-500 border-gray-600 rounded bg-gray-700"}),e.jsx("label",{htmlFor:"servicenow-enabled",className:"text-sm font-medium text-gray-300",children:"Enable ServiceNow integration"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(E,{onClick:C,disabled:_,children:_?"Saving...":"Save Settings"}),e.jsx(E,{onClick:S,disabled:!N||y,variant:"secondary",children:y?"Testing...":"Test Connection"})]}),N&&e.jsxs("div",{className:"bg-green-900/30 border border-green-700 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(me,{className:"h-5 w-5 text-green-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-green-300",children:[e.jsx("p",{className:"font-medium",children:"ServiceNow Integration Configured"}),e.jsx("p",{children:"You can now create incidents and change requests from vulnerabilities."})]})]})]})]}),e.jsxs(B,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-100 mb-4",children:"How to Use ServiceNow Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Configure your ServiceNow instance settings above and test the connection."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Navigate to any vulnerability in your scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"3"})}),e.jsx("p",{children:"Use the ServiceNow dropdown to create an Incident or Change Request with vulnerability details."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"Tickets are linked to vulnerabilities and can be tracked in HeroForge."})]})]})]}),e.jsxs(B,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-100 mb-4",children:"ServiceNow Table API Reference"}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-2",children:[e.jsx("p",{children:"HeroForge uses the ServiceNow Table API to create tickets:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("code",{className:"text-cyan-400",children:"/api/now/table/incident"})," - Create incidents"]}),e.jsxs("li",{children:[e.jsx("code",{className:"text-cyan-400",children:"/api/now/table/change_request"})," - Create change requests"]}),e.jsxs("li",{children:[e.jsx("code",{className:"text-cyan-400",children:"/api/now/table/sys_user_group"})," - List assignment groups"]})]}),e.jsxs("p",{className:"mt-3",children:["Ensure your ServiceNow user has the following roles: ",e.jsx("code",{className:"text-cyan-400",children:"itil"})," or ",e.jsx("code",{className:"text-cyan-400",children:"rest_api_explorer"}),"."]})]})]})]})},la=()=>{const[o,F]=r.useState([]),[_,h]=r.useState(!0),[y,b]=r.useState(!1),[N,L]=r.useState(null),[t,a]=r.useState(null),[s,n]=r.useState(null),[m,p]=r.useState(!1),[c,D]=r.useState([]),[A,q]=r.useState(!1),[g,C]=r.useState(""),[S,x]=r.useState(!1);r.useEffect(()=>{T(),M()},[]);const T=async()=>{h(!0);try{const w=await Ue.getSettings();F(w.data)}catch(w){l.error("Failed to load SIEM settings"),console.error(w)}finally{h(!1)}},P=async w=>{var k,u;a(w);try{const R=await Ue.testConnection(w);R.data.success?l.success("Connection test successful!"):l.error(`Connection test failed: ${R.data.message}`)}catch(R){const j=R;l.error(((u=(k=j.response)==null?void 0:k.data)==null?void 0:u.error)||"Connection test failed")}finally{a(null)}},z=async()=>{var w,k;if(s){p(!0);try{await Ue.deleteSettings(s.id),l.success(`${s.siem_type.toUpperCase()} integration deleted`),T(),n(null)}catch(u){const R=u;l.error(((k=(w=R.response)==null?void 0:w.data)==null?void 0:k.error)||"Failed to delete SIEM integration")}finally{p(!1)}}},M=async()=>{q(!0);try{const w=await pt.getAll();D(w.data.filter(k=>k.status==="completed"))}catch(w){console.error("Failed to load scans:",w)}finally{q(!1)}},U=async()=>{var k,u;if(!g){l.error("Please select a scan to export");return}if(o.filter(R=>R.enabled).length===0){l.error("No enabled SIEM integrations found. Please enable at least one integration.");return}x(!0);try{const R=await Ue.exportScan(g);R.data.success?(l.success(`Scan exported to ${R.data.exported_to} SIEM integration(s). ${R.data.events_count} events sent.`),R.data.errors&&R.data.errors.length>0&&R.data.errors.forEach(j=>l.warning(j))):l.error("Export failed. Check SIEM configuration.")}catch(R){const j=R;l.error(((u=(k=j.response)==null?void 0:k.data)==null?void 0:u.error)||"Failed to export scan to SIEM")}finally{x(!1)}};return _?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"SIEM Integrations"})]}),e.jsxs(E,{variant:"primary",onClick:()=>b(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add Integration"]})]}),o.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Se,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"No SIEM integrations configured"}),e.jsxs(E,{variant:"primary",onClick:()=>b(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add Your First Integration"]})]}):e.jsx("div",{className:"space-y-4",children:o.map(w=>e.jsx("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-primary/20 text-primary rounded-md text-sm font-medium uppercase",children:w.siem_type}),w.enabled?e.jsxs("span",{className:"flex items-center gap-1 text-green-400 text-sm",children:[e.jsx(me,{className:"h-4 w-4"}),"Enabled"]}):e.jsxs("span",{className:"flex items-center gap-1 text-slate-500 text-sm",children:[e.jsx(Ve,{className:"h-4 w-4"}),"Disabled"]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Endpoint:"}),e.jsx("span",{className:"text-white font-mono",children:w.endpoint_url})]}),w.protocol&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Protocol:"}),e.jsx("span",{className:"text-white uppercase",children:w.protocol})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:w.export_on_scan_complete,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export on scan complete"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:w.export_on_critical_vuln,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export critical vulnerabilities"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{variant:"outline",size:"sm",onClick:()=>P(w.id),disabled:t===w.id,children:t===w.id?e.jsx(ee,{}):e.jsx(Bs,{className:"h-4 w-4"})}),e.jsx(E,{variant:"outline",size:"sm",onClick:()=>L(w),children:e.jsx(be,{className:"h-4 w-4"})}),e.jsx(E,{variant:"outline",size:"sm",onClick:()=>n(w),"aria-label":`Delete ${w.siem_type} integration`,children:e.jsx(le,{className:"h-4 w-4 text-red-400"})})]})]})},w.id))})]}),e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Manual Export"})]}),e.jsx(E,{variant:"outline",size:"sm",onClick:M,disabled:A,children:A?e.jsx(ee,{}):e.jsx(ze,{className:"h-4 w-4"})})]}),o.filter(w=>w.enabled).length===0?e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(Ve,{className:"h-5 w-5 text-amber-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-200",children:[e.jsx("p",{className:"font-medium mb-1",children:"No Enabled Integrations"}),e.jsx("p",{children:"Enable at least one SIEM integration above before exporting scan results."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Manually export scan results to all enabled SIEM integrations."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:g,onChange:w=>C(w.target.value),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",disabled:A||S,children:[e.jsx("option",{value:"",children:"Select a completed scan..."}),c.map(w=>e.jsxs("option",{value:w.id,children:[w.name," - ",new Date(w.created_at).toLocaleDateString()," ",new Date(w.created_at).toLocaleTimeString()]},w.id))]}),e.jsx(E,{variant:"primary",onClick:U,disabled:!g||S||A,children:S?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Exporting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),"Export to SIEM"]})})]}),c.length===0&&!A&&e.jsx("p",{className:"text-sm text-slate-500",children:"No completed scans available for export."}),e.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["Export will send data to: ",o.filter(w=>w.enabled).map(w=>w.siem_type.toUpperCase()).join(", ")]})]})]}),e.jsxs(B,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"About SIEM Integration"}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-400",children:[e.jsx("p",{children:"SIEM (Security Information and Event Management) integration allows HeroForge to automatically export scan results and vulnerability findings to your security monitoring platform."}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Syslog:"})," RFC 5424 compliant syslog over TCP/UDP"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Splunk:"})," Splunk HTTP Event Collector (HEC)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Elasticsearch:"})," Direct indexing via Bulk API"]})]})]})]}),(y||N)&&e.jsx(na,{settings:N,onClose:()=>{b(!1),L(null)},onSave:()=>{b(!1),L(null),T()}}),e.jsx(_e,{isOpen:!!s,onClose:()=>n(null),onConfirm:z,title:"Delete SIEM Integration",message:`Are you sure you want to delete the ${s==null?void 0:s.siem_type.toUpperCase()} integration? Automatic exports to this endpoint will stop.`,confirmLabel:"Delete Integration",variant:"danger",loading:m})]})},na=({settings:o,onClose:F,onSave:_})=>{const[h,y]=r.useState({siem_type:(o==null?void 0:o.siem_type)||"syslog",endpoint_url:(o==null?void 0:o.endpoint_url)||"",api_key:(o==null?void 0:o.api_key)||"",protocol:(o==null?void 0:o.protocol)||"tcp",enabled:(o==null?void 0:o.enabled)??!0,export_on_scan_complete:(o==null?void 0:o.export_on_scan_complete)??!1,export_on_critical_vuln:(o==null?void 0:o.export_on_critical_vuln)??!0}),[b,N]=r.useState(!1),L=async t=>{var a,s;if(t.preventDefault(),!h.endpoint_url){l.error("Endpoint URL is required");return}if(h.siem_type==="splunk"&&!h.api_key){l.error("API key is required for Splunk HEC");return}N(!0);try{if(o){const n={endpoint_url:h.endpoint_url,enabled:h.enabled,export_on_scan_complete:h.export_on_scan_complete,export_on_critical_vuln:h.export_on_critical_vuln};h.api_key&&(n.api_key=h.api_key),h.siem_type==="syslog"&&(n.protocol=h.protocol),await Ue.updateSettings(o.id,n),l.success("SIEM integration updated")}else{const n={siem_type:h.siem_type,endpoint_url:h.endpoint_url,enabled:h.enabled,export_on_scan_complete:h.export_on_scan_complete,export_on_critical_vuln:h.export_on_critical_vuln};h.api_key&&(n.api_key=h.api_key),h.siem_type==="syslog"&&(n.protocol=h.protocol),await Ue.createSettings(n),l.success("SIEM integration created")}_()}catch(n){const m=n;l.error(((s=(a=m.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to save SIEM integration")}finally{N(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white",children:[o?"Edit":"Add"," SIEM Integration"]}),e.jsx("button",{onClick:F,className:"text-slate-400 hover:text-white",children:e.jsx(je,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:L,className:"p-6 space-y-6",children:[!o&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"SIEM Type"}),e.jsxs("select",{value:h.siem_type,onChange:t=>y({...h,siem_type:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"syslog",children:"Syslog (RFC 5424)"}),e.jsx("option",{value:"splunk",children:"Splunk HEC"}),e.jsx("option",{value:"elasticsearch",children:"Elasticsearch"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Endpoint URL"}),e.jsx("input",{type:"text",value:h.endpoint_url,onChange:t=>y({...h,endpoint_url:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:h.siem_type==="syslog"?"192.168.1.100:514":h.siem_type==="splunk"?"https://splunk.example.com:8088":"https://elasticsearch.example.com:9200"})]}),h.siem_type==="syslog"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Protocol"}),e.jsxs("select",{value:h.protocol,onChange:t=>y({...h,protocol:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"})]})]}),(h.siem_type==="splunk"||h.siem_type==="elasticsearch")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:[h.siem_type==="splunk"?"HEC Token":"API Key"," ",h.siem_type==="splunk"&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"password",value:h.api_key,onChange:t=>y({...h,api_key:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:o?"(leave blank to keep current)":""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h.enabled,onChange:t=>y({...h,enabled:t.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Enable this integration"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h.export_on_scan_complete,onChange:t=>y({...h,export_on_scan_complete:t.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export when scans complete"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h.export_on_critical_vuln,onChange:t=>y({...h,export_on_critical_vuln:t.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export critical vulnerabilities immediately"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(E,{type:"button",variant:"outline",onClick:F,children:"Cancel"}),e.jsx(E,{type:"submit",variant:"primary",disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs("span",{children:[o?"Update":"Create"," Integration"]})})]})]})]})})},ia=()=>{const[o,F]=r.useState(!0),[_,h]=r.useState([]),[y,b]=r.useState(null),[N,L]=r.useState(!1),[t,a]=r.useState(!1),[s,n]=r.useState(null),[m,p]=r.useState(!1),[c,D]=r.useState(!1),[A,q]=r.useState(null),[g,C]=r.useState(""),S=r.useRef(null),[x,T]=r.useState({name:"",vpnType:"openvpn",username:"",password:""}),[P,z]=r.useState(null);r.useEffect(()=>{M()},[]);const M=async()=>{F(!0);try{const[i,$]=await Promise.all([ve.getConfigs(),ve.getStatus()]);h(i.data),b($.data)}catch(i){console.error("Failed to load VPN data:",i),l.error("Failed to load VPN settings")}finally{F(!1)}},U=i=>{var G,Q;const $=(G=i.target.files)==null?void 0:G[0];if(!$)return;const V=(Q=$.name.split(".").pop())==null?void 0:Q.toLowerCase();let f="openvpn";V==="conf"&&(f="wireguard"),z($),T({...x,name:$.name.replace(/\.(ovpn|conf)$/i,""),vpnType:f}),L(!0)},w=async()=>{if(!P){l.error("Please select a VPN config file");return}if(!x.name.trim()){l.error("Please enter a name for the VPN config");return}a(!0);try{const i=new FileReader;i.onload=async()=>{var V,f;const $=i.result.split(",")[1];try{await ve.uploadConfig({name:x.name.trim(),vpn_type:x.vpnType,config_data:$,filename:P.name,username:x.username||void 0,password:x.password||void 0,set_as_default:!1}),l.success("VPN config uploaded successfully"),L(!1),z(null),T({name:"",vpnType:"openvpn",username:"",password:""}),S.current&&(S.current.value=""),await M()}catch(G){const Q=G;console.error("Failed to upload VPN config:",G),l.error(((f=(V=Q.response)==null?void 0:V.data)==null?void 0:f.error)||"Failed to upload VPN config")}},i.readAsDataURL(P)}finally{a(!1)}},k=async i=>{var $,V;if(window.confirm("Are you sure you want to delete this VPN config?"))try{await ve.deleteConfig(i),l.success("VPN config deleted"),await M()}catch(f){const G=f;console.error("Failed to delete VPN config:",f),l.error(((V=($=G.response)==null?void 0:$.data)==null?void 0:V.error)||"Failed to delete VPN config")}},u=async i=>{var $,V;n(i);try{const f=await ve.testConfig(i);f.data.success?l.success(`Connection successful! IP: ${f.data.assigned_ip||"N/A"}`):l.error(f.data.message||"Connection test failed")}catch(f){const G=f;console.error("Failed to test VPN config:",f),l.error(((V=($=G.response)==null?void 0:$.data)==null?void 0:V.error)||"Connection test failed")}finally{n(null)}},R=async i=>{var $,V;p(!0);try{await ve.connect({config_id:i,connection_mode:"persistent"}),l.success("VPN connected"),await M()}catch(f){const G=f;console.error("Failed to connect VPN:",f),l.error(((V=($=G.response)==null?void 0:$.data)==null?void 0:V.error)||"Failed to connect")}finally{p(!1)}},j=async()=>{var i,$;D(!0);try{await ve.disconnect(),l.success("VPN disconnected"),await M()}catch(V){const f=V;console.error("Failed to disconnect VPN:",V),l.error((($=(i=f.response)==null?void 0:i.data)==null?void 0:$.error)||"Failed to disconnect")}finally{D(!1)}},Y=async i=>{var $,V;try{await ve.updateConfig(i,{is_default:!0}),l.success("Default VPN config updated"),await M()}catch(f){const G=f;console.error("Failed to set default:",f),l.error(((V=($=G.response)==null?void 0:$.data)==null?void 0:V.error)||"Failed to set default")}},X=async i=>{var $,V;if(!g.trim()){l.error("Name cannot be empty");return}try{await ve.updateConfig(i,{name:g.trim()}),l.success("VPN config updated"),q(null),await M()}catch(f){const G=f;console.error("Failed to update config:",f),l.error(((V=($=G.response)==null?void 0:$.data)==null?void 0:V.error)||"Failed to update")}};return o?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[y!=null&&y.connected?e.jsx(Hs,{className:"h-6 w-6 text-green-500"}):e.jsx(ws,{className:"h-6 w-6 text-slate-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"VPN Status"}),e.jsx("p",{className:"text-sm text-slate-400",children:y!=null&&y.connected?`Connected to ${y.config_name}`:"Not connected"})]})]}),(y==null?void 0:y.connected)&&e.jsxs(E,{onClick:j,disabled:c,variant:"danger",className:"flex items-center gap-2",children:[e.jsx(Ct,{className:"h-4 w-4"}),c?"Disconnecting...":"Disconnect"]})]}),(y==null?void 0:y.connected)&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-dark-hover rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Mode"}),e.jsx("p",{className:"text-sm text-white",children:y.connection_mode==="persistent"?"Persistent":"Per-Scan"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Assigned IP"}),e.jsx("p",{className:"text-sm text-white font-mono",children:y.assigned_ip||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Interface"}),e.jsx("p",{className:"text-sm text-white font-mono",children:y.interface_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Connected Since"}),e.jsx("p",{className:"text-sm text-white",children:y.connected_since?new Date(y.connected_since).toLocaleString():"N/A"})]})]})]}),e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"VPN Configurations"})]}),e.jsxs("div",{children:[e.jsx("input",{ref:S,type:"file",accept:".ovpn,.conf",onChange:U,className:"hidden"}),e.jsxs(E,{onClick:()=>{var i;return(i=S.current)==null?void 0:i.click()},className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),"Upload Config"]})]})]}),N&&e.jsxs("div",{className:"mb-6 p-4 bg-dark-hover rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"Upload VPN Configuration"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{children:"File:"}),e.jsx("span",{className:"text-white font-mono",children:P==null?void 0:P.name}),e.jsx("span",{className:"px-2 py-0.5 bg-primary/20 text-primary rounded text-xs uppercase",children:x.vpnType})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Config Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"text",placeholder:"My VPN Connection",value:x.name,onChange:i=>T({...x,name:i.target.value})})]}),x.vpnType==="openvpn"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Username (optional)"}),e.jsx(J,{type:"text",placeholder:"VPN username",value:x.username,onChange:i=>T({...x,username:i.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Required if your VPN requires authentication"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Password (optional)"}),e.jsx(J,{type:"password",placeholder:"VPN password",value:x.password,onChange:i=>T({...x,password:i.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(E,{onClick:w,disabled:t,children:t?"Uploading...":"Upload"}),e.jsx(E,{onClick:()=>{L(!1),z(null),S.current&&(S.current.value="")},variant:"secondary",children:"Cancel"})]})]})]}),_.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(ws,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No VPN configurations yet"}),e.jsx("p",{className:"text-sm",children:"Upload an OpenVPN (.ovpn) or WireGuard (.conf) file to get started"})]}):e.jsx("div",{className:"space-y-3",children:_.map(i=>e.jsxs("div",{className:"p-4 bg-dark-hover rounded-lg border border-dark-border flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${i.vpn_type==="openvpn"?"bg-orange-500/20 text-orange-400":"bg-blue-500/20 text-blue-400"}`,children:e.jsx(ue,{className:"h-5 w-5"})}),e.jsxs("div",{children:[A===i.id?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{type:"text",value:g,onChange:$=>C($.target.value),className:"w-48",autoFocus:!0,onKeyDown:$=>{$.key==="Enter"&&X(i.id),$.key==="Escape"&&q(null)}}),e.jsx(E,{size:"sm",onClick:()=>X(i.id),children:"Save"}),e.jsx(E,{size:"sm",variant:"secondary",onClick:()=>q(null),children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium",children:i.name}),i.is_default&&e.jsx(rs,{className:"h-4 w-4 text-yellow-400 fill-yellow-400"}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-700 text-slate-300 rounded text-xs uppercase",children:i.vpn_type}),(y==null?void 0:y.connected)&&y.config_id===i.id&&e.jsx("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 rounded text-xs",children:"Connected"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500 mt-1",children:[i.requires_credentials&&e.jsx("span",{className:i.has_credentials?"text-green-400":"text-yellow-400",children:i.has_credentials?"Credentials saved":"Credentials required"}),i.last_used_at&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(fe,{className:"h-3 w-3"}),"Last used: ",new Date(i.last_used_at).toLocaleDateString()]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:A!==i.id&&e.jsxs(e.Fragment,{children:[!i.is_default&&e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>Y(i.id),title:"Set as default",children:e.jsx(rs,{className:"h-4 w-4"})}),e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>{q(i.id),C(i.name)},title:"Edit",children:e.jsx(be,{className:"h-4 w-4"})}),e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>u(i.id),disabled:s===i.id,title:"Test connection",children:s===i.id?e.jsx(ee,{size:"sm"}):e.jsx(me,{className:"h-4 w-4"})}),!(y!=null&&y.connected)||y.config_id!==i.id?e.jsx(E,{size:"sm",variant:"secondary",onClick:()=>R(i.id),disabled:m||(y==null?void 0:y.connected),title:"Connect",children:e.jsx(fs,{className:"h-4 w-4"})}):null,e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>k(i.id),className:"text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(le,{className:"h-4 w-4"})})]})})]},i.id))})]}),e.jsxs(B,{children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"How to Use VPN Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-slate-400",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Upload your OpenVPN (.ovpn) or WireGuard (.conf) configuration file."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"If your VPN requires credentials, enter them during upload. They are stored encrypted."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"3"})}),e.jsx("p",{children:"Test your connection to verify it works before using it for scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"When creating a scan, select a VPN config to route the scan through that VPN. The VPN connects before the scan starts and disconnects when it completes."})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ge,{className:"h-5 w-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-200",children:[e.jsx("p",{className:"font-medium",children:"Security Note"}),e.jsx("p",{className:"text-yellow-300/80 mt-1",children:"VPN credentials are encrypted using AES-256-GCM. Config files containing dangerous options (scripts, hooks) are rejected. Only use VPN configurations from trusted sources."})]})]})})]})]})},ca=()=>{const[o,F]=r.useState(!0),[_,h]=r.useState([]),[y,b]=r.useState([]),[N,L]=r.useState(null),[t,a]=r.useState(!1),[s,n]=r.useState(!1),[m,p]=r.useState(!1),[c,D]=r.useState(!1),[A,q]=r.useState(null),[g,C]=r.useState(!1),[S,x]=r.useState(null),[T,P]=r.useState(""),[z,M]=r.useState("agents"),[U,w]=r.useState({name:"",description:"",network_zones:[],max_concurrent_tasks:1}),[k,u]=r.useState({name:"",description:"",network_ranges:"",color:"#06b6d4"});r.useEffect(()=>{R()},[]);const R=async()=>{F(!0);try{const[v,H,d]=await Promise.all([Ne.list(),Ne.groups.list(),Ne.getStats()]);h(v.data),b(H.data),L(d.data)}catch(v){console.error("Failed to load agent data:",v),l.error("Failed to load agent data")}finally{F(!1)}},j=async()=>{var v,H,d;if(!U.name.trim()){l.error("Agent name is required");return}p(!0);try{const W=await Ne.register({...U,network_zones:(v=U.network_zones)==null?void 0:v.filter(K=>K.trim())});q(W.data.token),l.success("Agent registered successfully"),a(!1),w({name:"",description:"",network_zones:[],max_concurrent_tasks:1}),await R()}catch(W){const K=W;l.error(((d=(H=K.response)==null?void 0:H.data)==null?void 0:d.error)||"Failed to register agent")}finally{p(!1)}},Y=async()=>{var v,H;if(!k.name.trim()){l.error("Group name is required");return}D(!0);try{await Ne.groups.create({name:k.name.trim(),description:k.description.trim()||void 0,network_ranges:k.network_ranges.split(",").map(d=>d.trim()).filter(Boolean),color:k.color}),l.success("Group created successfully"),n(!1),u({name:"",description:"",network_ranges:"",color:"#06b6d4"}),await R()}catch(d){const W=d;l.error(((H=(v=W.response)==null?void 0:v.data)==null?void 0:H.error)||"Failed to create group")}finally{D(!1)}},X=async v=>{var H,d;if(window.confirm("Are you sure you want to delete this agent?"))try{await Ne.delete(v),l.success("Agent deleted"),await R()}catch(W){const K=W;l.error(((d=(H=K.response)==null?void 0:H.data)==null?void 0:d.error)||"Failed to delete agent")}},i=async v=>{var H,d;if(window.confirm("Are you sure you want to delete this group?"))try{await Ne.groups.delete(v),l.success("Group deleted"),await R()}catch(W){const K=W;l.error(((d=(H=K.response)==null?void 0:H.data)==null?void 0:d.error)||"Failed to delete group")}},$=async v=>{var H,d;if(window.confirm("Are you sure? The current token will be invalidated."))try{const W=await Ne.regenerateToken(v);q(W.data.token),l.success("Token regenerated")}catch(W){const K=W;l.error(((d=(H=K.response)==null?void 0:H.data)==null?void 0:d.error)||"Failed to regenerate token")}},V=async v=>{var H,d;if(!T.trim()){l.error("Name cannot be empty");return}try{await Ne.update(v,{name:T.trim()}),l.success("Agent updated"),x(null),await R()}catch(W){const K=W;l.error(((d=(H=K.response)==null?void 0:H.data)==null?void 0:d.error)||"Failed to update agent")}},f=v=>{navigator.clipboard.writeText(v),l.success("Copied to clipboard")},G=v=>{switch(v){case"online":return e.jsx(me,{className:"h-4 w-4 text-green-400"});case"busy":return e.jsx(_s,{className:"h-4 w-4 text-yellow-400 animate-pulse"});case"offline":return e.jsx(Te,{className:"h-4 w-4 text-red-400"});case"pending":return e.jsx(fe,{className:"h-4 w-4 text-slate-400"});case"disabled":return e.jsx(je,{className:"h-4 w-4 text-slate-500"});default:return e.jsx(Ve,{className:"h-4 w-4 text-slate-400"})}},Q=v=>{switch(v){case"online":return"completed";case"busy":return"running";case"offline":case"disabled":return"failed";default:return"pending"}};return o?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[A&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-lg w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Ve,{className:"h-6 w-6 text-yellow-400"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Agent Token"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"This token will only be shown once. Copy it now and configure it in your agent."}),e.jsxs("div",{className:"relative",children:[e.jsx(J,{type:g?"text":"password",value:A,readOnly:!0,className:"font-mono text-sm pr-24"}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex gap-1",children:[e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>C(!g),children:g?e.jsx(js,{className:"h-4 w-4"}):e.jsx(Ws,{className:"h-4 w-4"})}),e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>f(A),children:e.jsx(he,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:e.jsx("p",{className:"text-sm text-yellow-200",children:"Store this token securely. You will need to regenerate it if lost."})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(E,{onClick:()=>q(null),children:"Done"})})]})}),N&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(Se,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:N.total_agents}),e.jsx("p",{className:"text-sm text-slate-400",children:"Total Agents"})]})]})}),e.jsx(B,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(me,{className:"h-5 w-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:N.online_agents}),e.jsx("p",{className:"text-sm text-slate-400",children:"Online"})]})]})}),e.jsx(B,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:e.jsx(_s,{className:"h-5 w-5 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:N.busy_agents}),e.jsx("p",{className:"text-sm text-slate-400",children:"Busy"})]})]})}),e.jsx(B,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-500/20 rounded-lg",children:e.jsx(St,{className:"h-5 w-5 text-slate-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:N.total_tasks_completed}),e.jsx("p",{className:"text-sm text-slate-400",children:"Tasks Completed"})]})]})})]}),e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>M("agents"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium ${z==="agents"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(Se,{className:"h-4 w-4"}),"Agents (",_.length,")"]}),e.jsxs("button",{onClick:()=>M("groups"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium ${z==="groups"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(os,{className:"h-4 w-4"}),"Groups (",y.length,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(E,{onClick:()=>R(),variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-4 w-4"}),"Refresh"]}),z==="agents"?e.jsxs(E,{onClick:()=>a(!0),className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"Register Agent"]}):e.jsxs(E,{onClick:()=>n(!0),className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"Create Group"]})]})]}),t&&e.jsxs("div",{className:"mb-6 p-4 bg-dark-hover rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"Register New Agent"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"text",placeholder:"Production Agent 1",value:U.name,onChange:v=>w({...U,name:v.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Description"}),e.jsx(J,{type:"text",placeholder:"Agent for internal network scanning",value:U.description||"",onChange:v=>w({...U,description:v.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Max Concurrent Tasks"}),e.jsx(J,{type:"number",min:1,max:10,value:U.max_concurrent_tasks,onChange:v=>w({...U,max_concurrent_tasks:parseInt(v.target.value)||1})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Network Zones (comma-separated)"}),e.jsx(J,{type:"text",placeholder:"10.0.0.0/8, 192.168.0.0/16",value:(U.network_zones||[]).join(", "),onChange:v=>w({...U,network_zones:v.target.value.split(",").map(H=>H.trim())})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(E,{onClick:j,disabled:m,children:m?"Registering...":"Register"}),e.jsx(E,{variant:"secondary",onClick:()=>a(!1),children:"Cancel"})]})]})]}),s&&e.jsxs("div",{className:"mb-6 p-4 bg-dark-hover rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"Create Agent Group"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"text",placeholder:"Internal Network",value:k.name,onChange:v=>u({...k,name:v.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Color"}),e.jsx(J,{type:"color",value:k.color,onChange:v=>u({...k,color:v.target.value}),className:"h-10 p-1"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Description"}),e.jsx(J,{type:"text",placeholder:"Agents for internal network segments",value:k.description,onChange:v=>u({...k,description:v.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Network Ranges (comma-separated)"}),e.jsx(J,{type:"text",placeholder:"10.0.0.0/8, 192.168.0.0/16",value:k.network_ranges,onChange:v=>u({...k,network_ranges:v.target.value})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(E,{onClick:Y,disabled:c,children:c?"Creating...":"Create Group"}),e.jsx(E,{variant:"secondary",onClick:()=>n(!1),children:"Cancel"})]})]})]}),z==="agents"&&e.jsx("div",{className:"space-y-3",children:_.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(Se,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No agents registered yet"}),e.jsx("p",{className:"text-sm",children:"Register an agent to start distributed scanning"})]}):_.map(v=>e.jsx("div",{className:"p-4 bg-dark-hover rounded-lg border border-dark-border",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(Se,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[S===v.id?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{type:"text",value:T,onChange:H=>P(H.target.value),className:"w-48",autoFocus:!0,onKeyDown:H=>{H.key==="Enter"&&V(v.id),H.key==="Escape"&&x(null)}}),e.jsx(E,{size:"sm",onClick:()=>V(v.id),children:"Save"}),e.jsx(E,{size:"sm",variant:"secondary",onClick:()=>x(null),children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium",children:v.name}),G(v.status),e.jsx(oe,{type:Q(v.status),children:v.status})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-slate-400",children:[v.hostname&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Et,{className:"h-3 w-3"}),v.hostname]}),v.ip_address&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(hs,{className:"h-3 w-3"}),v.ip_address]}),v.version&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(is,{className:"h-3 w-3"}),"v",v.version]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-slate-500",children:[e.jsxs("span",{children:["Token: ",v.token_prefix,"..."]}),e.jsxs("span",{children:["Tasks: ",v.current_tasks,"/",v.max_concurrent_tasks]}),v.last_heartbeat_at&&e.jsxs("span",{children:["Last seen: ",new Date(v.last_heartbeat_at).toLocaleString()]})]}),v.groups.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Groups:"}),v.groups.map(H=>e.jsx("span",{className:"px-2 py-0.5 rounded text-xs",style:{backgroundColor:`${H.color}20`,color:H.color},children:H.name},H.id))]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:S!==v.id&&e.jsxs(e.Fragment,{children:[e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>{x(v.id),P(v.name)},title:"Edit",children:e.jsx(be,{className:"h-4 w-4"})}),e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>$(v.id),title:"Regenerate token",children:e.jsx(ze,{className:"h-4 w-4"})}),e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>X(v.id),className:"text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(le,{className:"h-4 w-4"})})]})})]})},v.id))}),z==="groups"&&e.jsx("div",{className:"space-y-3",children:y.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(os,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No groups created yet"}),e.jsx("p",{className:"text-sm",children:"Create groups to organize agents by network zone"})]}):y.map(v=>e.jsx("div",{className:"p-4 bg-dark-hover rounded-lg border border-dark-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${v.color}20`},children:e.jsx(os,{className:"h-5 w-5",style:{color:v.color}})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium",children:v.name}),e.jsxs("span",{className:"text-sm text-slate-400",children:["(",v.agent_count," agent",v.agent_count!==1?"s":"",")"]})]}),v.description&&e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:v.description}),v.network_ranges&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(hs,{className:"h-3 w-3 text-slate-500"}),e.jsx("span",{className:"text-xs text-slate-500",children:JSON.parse(v.network_ranges).join(", ")})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>i(v.id),className:"text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(le,{className:"h-4 w-4"})})})]})},v.id))})]}),e.jsxs(B,{children:[e.jsxs("h4",{className:"text-md font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5 text-primary"}),"How to Deploy Agents"]}),e.jsxs("div",{className:"space-y-4 text-sm text-slate-400",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Register a new agent above to receive a unique token. This token authenticates the agent with the server."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Download and run the HeroForge agent on your target network. Configure it with the server URL and token."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"3"})}),e.jsx("p",{children:"Create groups to organize agents by network zone (e.g., DMZ, Internal, Cloud)."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"When creating scans, select an agent or group to route the scan through the appropriate network segment."})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-dark-hover rounded-lg",children:[e.jsx("p",{className:"text-sm text-slate-300 font-medium mb-2",children:"Agent Configuration Example"}),e.jsx("pre",{className:"text-xs text-slate-400 overflow-x-auto",children:`# heroforge-agent.yaml
server_url: https://heroforge.example.com
token: hfa_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
heartbeat_interval: 30
max_concurrent_tasks: 3`})]})]})]})},Ps={name:"",description:"",report_type:"vulnerability",format:"pdf",schedule:"0 8 * * *",recipients:[],filters:{days_back:30},include_charts:!0},ms=[{value:"vulnerability",label:"Vulnerability Report",description:"All discovered vulnerabilities with severity and remediation"},{value:"scan_summary",label:"Scan Summary",description:"Overview of completed scans and their results"},{value:"compliance",label:"Compliance Report",description:"Compliance framework analysis and control mappings"},{value:"executive",label:"Executive Summary",description:"High-level security posture overview"}],oa=[{value:"pdf",label:"PDF"},{value:"html",label:"HTML"},{value:"csv",label:"CSV"}],da=[{value:"",label:"All Severities"},{value:"low",label:"Low and above"},{value:"medium",label:"Medium and above"},{value:"high",label:"High and above"},{value:"critical",label:"Critical only"}],ma=[{value:"pci_dss",label:"PCI-DSS 4.0"},{value:"nist_800_53",label:"NIST 800-53"},{value:"nist_csf",label:"NIST CSF"},{value:"cis",label:"CIS Benchmarks"},{value:"hipaa",label:"HIPAA"},{value:"soc2",label:"SOC 2"},{value:"owasp_top10",label:"OWASP Top 10"}],xa=()=>{var X;const[o,F]=r.useState([]),[_,h]=r.useState([]),[y,b]=r.useState(!0),[N,L]=r.useState(!1),[t,a]=r.useState(null),[s,n]=r.useState(Ps),[m,p]=r.useState(""),[c,D]=r.useState(null),[A,q]=r.useState(!1),[g,C]=r.useState(null),[S,x]=r.useState(!1);r.useEffect(()=>{T()},[]);const T=async()=>{b(!0);try{const[i,$]=await Promise.all([Ie.getAll(),Ie.getPresets()]);F(i.data),h($.data)}catch(i){l.error("Failed to load scheduled reports"),console.error(i)}finally{b(!1)}},P=()=>{n(Ps),a(null),L(!1),p(""),x(!1)},z=i=>{const $=JSON.parse(i.recipients),V=i.filters?JSON.parse(i.filters):{};n({name:i.name,description:i.description||"",report_type:i.report_type,format:i.format,schedule:i.schedule,recipients:$,filters:V,include_charts:i.include_charts});const f=_.some(G=>G.cron===i.schedule);x(!f),a(i.id),L(!0)},M=()=>{const i=m.trim().toLowerCase();if(!i)return;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)){l.error("Please enter a valid email address");return}if(s.recipients.includes(i)){l.warning("Email already added");return}n(V=>({...V,recipients:[...V.recipients,i]})),p("")},U=i=>{n($=>({...$,recipients:$.recipients.filter(V=>V!==i)}))},w=async i=>{var $,V;if(i.preventDefault(),!s.name.trim()){l.error("Name is required");return}if(s.recipients.length===0){l.error("At least one recipient is required");return}try{t?(await Ie.update(t,{name:s.name,description:s.description||void 0,report_type:s.report_type,format:s.format,schedule:s.schedule,recipients:s.recipients,filters:s.filters,include_charts:s.include_charts}),l.success("Scheduled report updated")):(await Ie.create({name:s.name,description:s.description||void 0,report_type:s.report_type,format:s.format,schedule:s.schedule,recipients:s.recipients,filters:s.filters,include_charts:s.include_charts}),l.success("Scheduled report created")),P(),T()}catch(f){const G=f;l.error(((V=($=G.response)==null?void 0:$.data)==null?void 0:V.error)||"Failed to save scheduled report")}},k=async i=>{var $,V;try{await Ie.update(i.id,{is_active:!i.is_active}),l.success(`Scheduled report ${i.is_active?"paused":"activated"}`),T()}catch(f){const G=f;l.error(((V=($=G.response)==null?void 0:$.data)==null?void 0:V.error)||"Failed to update")}},u=async i=>{var $,V;C(i.id);try{await Ie.runNow(i.id),l.success("Report generation started. You will receive it via email shortly.")}catch(f){const G=f;l.error(((V=($=G.response)==null?void 0:$.data)==null?void 0:V.error)||"Failed to run report")}finally{C(null)}},R=async()=>{var i,$;if(c){q(!0);try{await Ie.delete(c.id),l.success(`Scheduled report "${c.name}" deleted`),T(),D(null)}catch(V){const f=V;l.error((($=(i=f.response)==null?void 0:i.data)==null?void 0:$.error)||"Failed to delete")}finally{q(!1)}}},j=i=>{const $=_.find(f=>f.cron===i);if($)return $.label;const V=i.split(" ");if(V.length===5){const[f,G]=V,Q=`${G.padStart(2,"0")}:${f.padStart(2,"0")}`;if(V[4]==="*"&&V[3]==="*"&&V[2]==="*")return`Daily at ${Q}`;if(V[4]!=="*")return`Weekly on ${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][parseInt(V[4])]} at ${Q}`;if(V[2]!=="*")return`Monthly on day ${V[2]} at ${Q}`}return i},Y=i=>{var $;return(($=ms.find(V=>V.value===i))==null?void 0:$.label)||i};return y?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scheduled Reports"})]}),!N&&e.jsxs(E,{variant:"primary",onClick:()=>L(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"New Scheduled Report"]})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Automatically generate and email reports on a schedule"})]}),N&&e.jsx(B,{children:e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:t?"Edit Scheduled Report":"Create Scheduled Report"}),e.jsx("button",{type:"button",onClick:P,className:"text-slate-400 hover:text-white",children:e.jsx(je,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:i=>n({...s,name:i.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Weekly Vulnerability Report"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:s.description,onChange:i=>n({...s,description:i.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Report Type"}),e.jsx("select",{value:s.report_type,onChange:i=>n({...s,report_type:i.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",children:ms.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:(X=ms.find(i=>i.value===s.report_type))==null?void 0:X.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Format"}),e.jsx("div",{className:"flex gap-2",children:oa.map(i=>e.jsx("button",{type:"button",onClick:()=>n({...s,format:i.value}),className:`flex-1 px-4 py-2 rounded-lg border transition-colors ${s.format===i.value?"bg-primary/20 border-primary text-primary":"bg-dark-bg border-dark-border text-slate-400 hover:border-slate-500"}`,children:i.label},i.value))})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(ns,{className:"h-4 w-4"})," Schedule"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[_.map(i=>e.jsx("button",{type:"button",onClick:()=>{n({...s,schedule:i.cron}),x(!1)},className:`px-3 py-1.5 rounded-lg border text-sm transition-colors ${s.schedule===i.cron&&!S?"bg-primary/20 border-primary text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-slate-500"}`,title:i.description,children:i.label},i.id)),e.jsx("button",{type:"button",onClick:()=>x(!0),className:`px-3 py-1.5 rounded-lg border text-sm transition-colors ${S?"bg-primary/20 border-primary text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-slate-500"}`,children:"Custom"})]}),S&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Cron Expression"}),e.jsx("input",{type:"text",value:s.schedule,onChange:i=>n({...s,schedule:i.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white font-mono text-sm",placeholder:"0 8 * * *"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:'Format: minute hour day-of-month month day-of-week (e.g., "0 8 * * *" for daily at 8am)'})]})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(De,{className:"h-4 w-4"})," Recipients"]}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"email",value:m,onChange:i=>p(i.target.value),onKeyDown:i=>{i.key==="Enter"&&(i.preventDefault(),M())},className:"flex-1 bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",placeholder:"email@example.com"}),e.jsx(E,{type:"button",variant:"secondary",onClick:M,children:e.jsx(ie,{className:"h-4 w-4"})})]}),s.recipients.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:s.recipients.map(i=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-dark-surface rounded-lg text-sm text-slate-300",children:[e.jsx(De,{className:"h-3 w-3"}),i,e.jsx("button",{type:"button",onClick:()=>U(i),className:"ml-1 text-slate-500 hover:text-red-400",children:e.jsx(je,{className:"h-3 w-3"})})]},i))}):e.jsx("p",{className:"text-sm text-slate-500",children:"No recipients added"})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-3",children:"Filters"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Time Period"}),e.jsxs("select",{value:s.filters.days_back||30,onChange:i=>n({...s,filters:{...s.filters,days_back:parseInt(i.target.value)}}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:7,children:"Last 7 days"}),e.jsx("option",{value:14,children:"Last 14 days"}),e.jsx("option",{value:30,children:"Last 30 days"}),e.jsx("option",{value:60,children:"Last 60 days"}),e.jsx("option",{value:90,children:"Last 90 days"})]})]}),s.report_type==="vulnerability"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Minimum Severity"}),e.jsx("select",{value:s.filters.min_severity||"",onChange:i=>n({...s,filters:{...s.filters,min_severity:i.target.value||void 0}}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:da.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]}),s.report_type==="compliance"&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Frameworks"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ma.map(i=>{var $;return e.jsx("button",{type:"button",onClick:()=>{const V=s.filters.frameworks||[],f=V.includes(i.value)?V.filter(G=>G!==i.value):[...V,i.value];n({...s,filters:{...s.filters,frameworks:f}})},className:`px-2 py-1 rounded text-xs border transition-colors ${($=s.filters.frameworks)!=null&&$.includes(i.value)?"bg-primary/20 border-primary text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-slate-500"}`,children:i.label},i.value)})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"include_charts",checked:s.include_charts,onChange:i=>n({...s,include_charts:i.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),e.jsx("label",{htmlFor:"include_charts",className:"text-sm text-slate-300",children:"Include charts and visualizations"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:P,children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"primary",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),t?"Update":"Create"]})]})]})}),o.length===0&&!N?e.jsx(B,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ee,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scheduled reports"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create automated reports to receive regular updates via email"})]})}):e.jsx("div",{className:"space-y-3",children:o.map(i=>{const $=JSON.parse(i.recipients);return e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${i.is_active?"bg-green-500/20":"bg-slate-500/20"}`,children:e.jsx(Ee,{className:`h-5 w-5 ${i.is_active?"text-green-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-white",children:i.name}),e.jsx(oe,{variant:"status",type:i.is_active?"completed":"pending",children:i.is_active?"Active":"Paused"}),e.jsx(oe,{variant:"primary",children:i.format.toUpperCase()})]}),e.jsxs("p",{className:"text-sm text-slate-400",children:[Y(i.report_type)," - ",j(i.schedule)]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(De,{className:"h-3 w-3"}),$.length," recipient",$.length!==1?"s":""]}),i.last_run_at&&e.jsxs("span",{className:"ml-3",children:[e.jsx(fe,{className:"h-3 w-3 inline mr-1"}),"Last run ",Fs(new Date(i.last_run_at))," ago"]}),e.jsxs("span",{className:"ml-3",children:["Next: ",new Date(i.next_run_at).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>u(i),disabled:g===i.id,className:"p-2 text-cyan-400 hover:bg-cyan-500/20 rounded transition-colors disabled:opacity-50",title:"Run Now",children:g===i.id?e.jsx(ee,{size:"sm"}):e.jsx(as,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>k(i),className:`p-2 rounded transition-colors ${i.is_active?"text-yellow-400 hover:bg-yellow-500/20":"text-green-400 hover:bg-green-500/20"}`,title:i.is_active?"Pause":"Activate",children:i.is_active?e.jsx(Ls,{className:"h-4 w-4"}):e.jsx(fs,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>z(i),className:"p-2 text-slate-400 hover:text-primary transition-colors",children:e.jsx(be,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>D(i),className:"p-2 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete scheduled report ${i.name}`,children:e.jsx(le,{className:"h-4 w-4"})})]})]})},i.id)})}),e.jsx(_e,{isOpen:!!c,onClose:()=>D(null),onConfirm:R,title:"Delete Scheduled Report",message:`Are you sure you want to delete the scheduled report "${c==null?void 0:c.name}"? Future reports will no longer be generated.`,confirmLabel:"Delete Report",variant:"warning",loading:A})]})},Is={"scan.started":"Scan Started","scan.completed":"Scan Completed","scan.failed":"Scan Failed","vulnerability.found":"Vulnerability Found","vulnerability.critical":"Critical Vulnerability","vulnerability.resolved":"Vulnerability Resolved","asset.discovered":"Asset Discovered","compliance.violation":"Compliance Violation"};function ua(){const[o,F]=r.useState([]),[_,h]=r.useState([]),[y,b]=r.useState(!0),[N,L]=r.useState(!1),[t,a]=r.useState(null),[s,n]=r.useState(!1),[m,p]=r.useState(null),[c,D]=r.useState([]),[A,q]=r.useState(!1),[g,C]=r.useState(null),[S,x]=r.useState(null),[T,P]=r.useState(""),[z,M]=r.useState(""),[U,w]=r.useState(""),[k,u]=r.useState([]),[R,j]=r.useState([]),[Y,X]=r.useState(!0),[i,$]=r.useState(!1),[V,f]=r.useState(!1);r.useEffect(()=>{G(),Q()},[]);const G=async()=>{try{const O=await ke.list();F(O.data)}catch(O){console.error("Failed to load webhooks:",O),l.error("Failed to load webhooks")}finally{b(!1)}},Q=async()=>{try{const O=await ke.getEventTypes();h(O.data.event_types)}catch(O){console.error("Failed to load event types:",O)}},v=()=>{P(""),M(""),w(""),u([]),j([]),X(!0),$(!1),a(null)},H=()=>{v(),L(!0)},d=O=>{a(O),P(O.name),M(O.url),w(""),u([...O.events]),j(O.headers?Object.entries(O.headers).map(([se,ce])=>({key:se,value:ce})):[]),X(O.is_active),L(!0)},W=()=>{L(!1),v()},K=async()=>{try{const O=await ke.generateSecret();w(O.data.secret),$(!0),l.success("Secret generated")}catch{l.error("Failed to generate secret")}},de=()=>{U&&(navigator.clipboard.writeText(U),l.success("Secret copied to clipboard"))},I=()=>{j([...R,{key:"",value:""}])},ae=O=>{j(R.filter((se,ce)=>ce!==O))},pe=(O,se,ce)=>{const xe=[...R];xe[O][se]=ce,j(xe)},ot=O=>{k.includes(O)?u(k.filter(se=>se!==O)):u([...k,O])},dt=async O=>{var se,ce;if(O.preventDefault(),!z.startsWith("http://")&&!z.startsWith("https://")){l.error("URL must start with http:// or https://");return}if(k.length===0){l.error("Please select at least one event");return}f(!0);try{const xe={};if(R.forEach(ne=>{ne.key.trim()&&ne.value.trim()&&(xe[ne.key.trim()]=ne.value.trim())}),t){const ne={name:T,url:z,events:k,headers:Object.keys(xe).length>0?xe:void 0,is_active:Y};U&&(ne.secret=U),await ke.update(t.id,ne),l.success("Webhook updated")}else{const ne={name:T,url:z,events:k,headers:Object.keys(xe).length>0?xe:void 0,is_active:Y};U&&(ne.secret=U),await ke.create(ne),l.success("Webhook created")}W(),G()}catch(xe){const ne=((ce=(se=xe.response)==null?void 0:se.data)==null?void 0:ce.error)||"Failed to save webhook";l.error(ne)}finally{f(!1)}},mt=async(O,se)=>{if(confirm(`Are you sure you want to delete the webhook "${se}"?`))try{await ke.delete(O),l.success("Webhook deleted"),G()}catch{l.error("Failed to delete webhook")}},xt=async O=>{var se,ce;C(O);try{const ne=(await ke.test(O)).data;ne.success?l.success(`Test successful (HTTP ${ne.status_code})`):l.error(`Test failed: ${ne.error||"Unknown error"}`)}catch(xe){const ne=((ce=(se=xe.response)==null?void 0:se.data)==null?void 0:ce.error)||"Failed to test webhook";l.error(ne)}finally{C(null)}},ut=async O=>{p(O),n(!0),q(!0);try{const se=await ke.getDeliveries(O,50);D(se.data)}catch{l.error("Failed to load delivery history"),D([])}finally{q(!1)}},ht=O=>O.is_active?O.failure_count>=5?e.jsx(Te,{className:"w-5 h-5 text-red-500"}):O.last_status_code&&O.last_status_code>=200&&O.last_status_code<300?e.jsx(me,{className:"w-5 h-5 text-green-500"}):e.jsx(Ve,{className:"w-5 h-5 text-yellow-500"}):e.jsx(Ve,{className:"w-5 h-5 text-gray-500"}),vs=O=>O?new Date(O).toLocaleString():"Never";return y?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ze,{className:"w-6 h-6 animate-spin text-cyan-400"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"Webhooks"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Send HTTP notifications to external systems when events occur"})]}),e.jsxs("button",{onClick:H,className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(ie,{className:"w-4 h-4"}),"Add Webhook"]})]}),o.length===0?e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-8 text-center",children:[e.jsx(Qs,{className:"w-12 h-12 mx-auto text-gray-500 mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-300",children:"No webhooks configured"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Create a webhook to send notifications to external systems"})]}):e.jsx("div",{className:"space-y-4",children:o.map(O=>e.jsx("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[ht(O),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-100",children:O.name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 font-mono",children:O.url}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:O.events.map(se=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-700 text-gray-300 rounded",children:Is[se]||se},se))}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-400",children:[e.jsxs("span",{children:["Last triggered: ",vs(O.last_triggered_at)]}),O.last_status_code&&e.jsxs("span",{className:O.last_status_code>=200&&O.last_status_code<300?"text-green-400":"text-red-400",children:["HTTP ",O.last_status_code]}),O.failure_count>0&&e.jsxs("span",{className:"text-red-400",children:[O.failure_count," failures"]}),O.has_secret&&e.jsx("span",{className:"text-cyan-400",children:"Signed"}),!O.is_active&&e.jsx("span",{className:"text-gray-500",children:"Disabled"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>xt(O.id),disabled:g===O.id,className:"p-2 text-gray-400 hover:text-cyan-400 transition-colors disabled:opacity-50",title:"Test webhook",children:g===O.id?e.jsx(ze,{className:"w-4 h-4 animate-spin"}):e.jsx(At,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ut(O.id),className:"p-2 text-gray-400 hover:text-cyan-400 transition-colors",title:"View delivery history",children:e.jsx(Ts,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>d(O),className:"p-2 text-gray-400 hover:text-cyan-400 transition-colors",title:"Edit webhook",children:e.jsx(be,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>mt(O.id,O.name),className:"p-2 text-gray-400 hover:text-red-400 transition-colors",title:"Delete webhook",children:e.jsx(le,{className:"w-4 h-4"})})]})]})},O.id))}),N&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100 mb-4",children:t?"Edit Webhook":"Create Webhook"}),e.jsxs("form",{onSubmit:dt,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:T,onChange:O=>P(O.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"My Webhook"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"URL"}),e.jsx("input",{type:"url",value:z,onChange:O=>M(O.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent font-mono text-sm",placeholder:"https://example.com/webhook"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Secret Key (optional)"}),e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"If set, requests will include an X-Webhook-Signature header with HMAC-SHA256 signature"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:i?"text":"password",value:U,onChange:O=>w(O.target.value),className:"w-full px-3 py-2 pr-20 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent font-mono text-sm",placeholder:t!=null&&t.has_secret?"(unchanged)":"Enter or generate a secret"}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex gap-1",children:[e.jsx("button",{type:"button",onClick:()=>$(!i),className:"p-1 text-gray-400 hover:text-gray-200",children:i?e.jsx(js,{className:"w-4 h-4"}):e.jsx(Ws,{className:"w-4 h-4"})}),U&&e.jsx("button",{type:"button",onClick:de,className:"p-1 text-gray-400 hover:text-gray-200",children:e.jsx(he,{className:"w-4 h-4"})})]})]}),e.jsx("button",{type:"button",onClick:K,className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg transition-colors",children:"Generate"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Events"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:_.map(O=>e.jsxs("label",{className:"flex items-start gap-2 p-3 bg-gray-700/50 rounded-lg cursor-pointer hover:bg-gray-700",children:[e.jsx("input",{type:"checkbox",checked:k.includes(O.id),onChange:()=>ot(O.id),className:"mt-1 rounded border-gray-600 bg-gray-700 text-cyan-500 focus:ring-cyan-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-200",children:O.name}),e.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:O.description})]})]},O.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Custom Headers (optional)"}),e.jsx("button",{type:"button",onClick:I,className:"text-sm text-cyan-400 hover:text-cyan-300",children:"+ Add Header"})]}),R.length>0&&e.jsx("div",{className:"space-y-2",children:R.map((O,se)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:O.key,onChange:ce=>pe(se,"key",ce.target.value),placeholder:"Header name",className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 text-sm"}),e.jsx("input",{type:"text",value:O.value,onChange:ce=>pe(se,"value",ce.target.value),placeholder:"Header value",className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 text-sm"}),e.jsx("button",{type:"button",onClick:()=>ae(se),className:"p-2 text-gray-400 hover:text-red-400",children:e.jsx(le,{className:"w-4 h-4"})})]},se))})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:Y,onChange:O=>X(O.target.checked),className:"rounded border-gray-600 bg-gray-700 text-cyan-500 focus:ring-cyan-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Enable webhook"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:W,className:"px-4 py-2 text-gray-300 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:V,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors disabled:opacity-50",children:V?"Saving...":t?"Save Changes":"Create Webhook"})]})]})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"Delivery History"}),e.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-white",children:"Close"})]}),A?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ze,{className:"w-6 h-6 animate-spin text-cyan-400"})}):c.length===0?e.jsx("div",{className:"text-center py-12 text-gray-400",children:"No deliveries yet"}):e.jsx("div",{className:"space-y-3",children:c.map(O=>e.jsxs("div",{className:"bg-gray-700/50 rounded-lg border border-gray-600",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer",onClick:()=>x(S===O.id?null:O.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[O.response_status&&O.response_status>=200&&O.response_status<300?e.jsx(me,{className:"w-5 h-5 text-green-500"}):e.jsx(Te,{className:"w-5 h-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-200",children:Is[O.event_type]||O.event_type}),e.jsx("span",{className:"text-sm text-gray-400 ml-3",children:vs(O.delivered_at)})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[O.response_status&&e.jsxs("span",{className:O.response_status>=200&&O.response_status<300?"text-green-400":"text-red-400",children:["HTTP ",O.response_status]}),O.error&&e.jsx("span",{className:"text-red-400 text-sm",children:O.error}),S===O.id?e.jsx(Js,{className:"w-4 h-4 text-gray-400"}):e.jsx(Ye,{className:"w-4 h-4 text-gray-400"})]})]}),S===O.id&&e.jsxs("div",{className:"px-4 pb-4 border-t border-gray-600 pt-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-400 mb-2",children:"Request Payload"}),e.jsx("pre",{className:"bg-gray-900 p-3 rounded text-xs text-gray-300 overflow-x-auto",children:JSON.stringify(JSON.parse(O.payload||"{}"),null,2)})]}),O.response_body&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-400 mb-2",children:"Response Body"}),e.jsx("pre",{className:"bg-gray-900 p-3 rounded text-xs text-gray-300 overflow-x-auto max-h-48",children:O.response_body})]})]})]},O.id))})]})})]})}const ha=()=>{var de;const[o,F]=r.useState([]),[_,h]=r.useState(!0),[y,b]=r.useState(!1),[N,L]=r.useState({name:"",platform:"github_actions",permissions:{trigger_scans:!0,view_results:!0,download_reports:!0,view_quality_gates:!0},expires_in_days:90}),[t,a]=r.useState(null),[s,n]=r.useState(!1),[m,p]=r.useState([]),[c,D]=r.useState(!0),[A,q]=r.useState(!1),[g,C]=r.useState({name:"",description:"",fail_on_critical:!0,fail_on_high:!0,max_critical:0,max_high:0,max_medium:10,max_low:50,is_default:!1}),[S,x]=r.useState(!1),[T,P]=r.useState([]),[z,M]=r.useState(!0),[U,w]=r.useState("tokens"),[k,u]=r.useState("github"),[R,j]=r.useState(""),[Y,X]=r.useState(!1);r.useEffect(()=>{i(),$(),V()},[]),r.useEffect(()=>{U==="examples"&&f()},[k,U]);const i=async()=>{try{h(!0);const I=await Ce.tokens.list();F(I.data)}catch(I){console.error("Failed to load tokens:",I),l.error("Failed to load CI/CD tokens")}finally{h(!1)}},$=async()=>{try{D(!0);const I=await Ce.qualityGates.list();p(I.data)}catch(I){console.error("Failed to load quality gates:",I),l.error("Failed to load quality gates")}finally{D(!1)}},V=async()=>{try{M(!0);const I=await Ce.runs.list(20);P(I.data)}catch(I){console.error("Failed to load runs:",I),l.error("Failed to load CI/CD runs")}finally{M(!1)}},f=async()=>{try{X(!0);const I=await Ce.examples.get(k);j(I.data.content)}catch(I){console.error("Failed to load pipeline example:",I),l.error("Failed to load pipeline example")}finally{X(!1)}},G=async()=>{if(!N.name.trim()){l.error("Token name is required");return}try{n(!0);let I;if(N.expires_in_days){const pe=new Date;pe.setDate(pe.getDate()+N.expires_in_days),I=pe.toISOString()}const ae=await Ce.tokens.create({name:N.name,platform:N.platform==="generic"?"github_actions":N.platform,permissions:N.permissions,expires_at:I});a(ae.data.token),await i(),l.success("CI/CD token created successfully")}catch(I){console.error("Failed to create token:",I),l.error("Failed to create token")}finally{n(!1)}},Q=async I=>{if(confirm("Are you sure you want to revoke this token?"))try{await Ce.tokens.delete(I),await i(),l.success("Token revoked successfully")}catch(ae){console.error("Failed to delete token:",ae),l.error("Failed to revoke token")}},v=async()=>{if(!g.name.trim()){l.error("Quality gate name is required");return}try{x(!0),await Ce.qualityGates.create({name:g.name,description:g.description||void 0,fail_on_critical:g.fail_on_critical,fail_on_high:g.fail_on_high,max_critical:g.max_critical,max_high:g.max_high,max_medium:g.max_medium,max_low:g.max_low,is_default:g.is_default}),await $(),q(!1),C({name:"",description:"",fail_on_critical:!0,fail_on_high:!0,max_critical:0,max_high:0,max_medium:10,max_low:50,is_default:!1}),l.success("Quality gate created successfully")}catch(I){console.error("Failed to create quality gate:",I),l.error("Failed to create quality gate")}finally{x(!1)}},H=async I=>{if(confirm("Are you sure you want to delete this quality gate?"))try{await Ce.qualityGates.delete(I),await $(),l.success("Quality gate deleted")}catch(ae){console.error("Failed to delete quality gate:",ae),l.error("Failed to delete quality gate")}},d=I=>{navigator.clipboard.writeText(I),l.success("Copied to clipboard")},W=I=>new Date(I).toLocaleString(),K=I=>{switch(I){case"github_actions":return"GitHub Actions";case"jenkins":return"Jenkins";case"gitlab_ci":return"GitLab CI";default:return"Generic"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-2 border-b border-dark-border pb-2",children:[e.jsxs("button",{onClick:()=>w("tokens"),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg font-medium transition-colors ${U==="tokens"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(Xe,{className:"h-4 w-4"}),"API Tokens"]}),e.jsxs("button",{onClick:()=>w("quality-gates"),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg font-medium transition-colors ${U==="quality-gates"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(ue,{className:"h-4 w-4"}),"Quality Gates"]}),e.jsxs("button",{onClick:()=>w("runs"),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg font-medium transition-colors ${U==="runs"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(Ks,{className:"h-4 w-4"}),"Recent Runs"]}),e.jsxs("button",{onClick:()=>w("examples"),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg font-medium transition-colors ${U==="examples"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(Pt,{className:"h-4 w-4"}),"Pipeline Examples"]})]}),U==="tokens"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"CI/CD API Tokens"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Create tokens for your CI/CD pipelines to trigger scans"})]}),e.jsxs(E,{onClick:()=>{b(!0),a(null)},children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"New Token"]})]}),y&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4 space-y-4",children:[e.jsx("h4",{className:"font-medium text-white",children:"Create New Token"}),t?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:[e.jsx("p",{className:"text-green-400 text-sm mb-2",children:"Token created successfully! Copy it now - it won't be shown again."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"bg-dark-bg px-3 py-2 rounded text-sm text-white flex-1 font-mono",children:t}),e.jsx(E,{onClick:()=>d(t),variant:"outline",size:"sm",children:e.jsx(he,{className:"h-4 w-4"})})]})]}),e.jsx(E,{onClick:()=>{b(!1),a(null)},variant:"outline",children:"Done"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(J,{label:"Token Name",value:N.name,onChange:I=>L({...N,name:I.target.value}),placeholder:"e.g., GitHub Actions Production"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Platform"}),e.jsxs("select",{value:N.platform,onChange:I=>L({...N,platform:I.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"github_actions",children:"GitHub Actions"}),e.jsx("option",{value:"jenkins",children:"Jenkins"}),e.jsx("option",{value:"gitlab_ci",children:"GitLab CI"}),e.jsx("option",{value:"generic",children:"Generic"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Permissions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(Fe,{checked:N.permissions.trigger_scans,onChange:I=>L({...N,permissions:{...N.permissions,trigger_scans:I}}),label:"Trigger scans"}),e.jsx(Fe,{checked:N.permissions.view_results,onChange:I=>L({...N,permissions:{...N.permissions,view_results:I}}),label:"View results"}),e.jsx(Fe,{checked:N.permissions.download_reports,onChange:I=>L({...N,permissions:{...N.permissions,download_reports:I}}),label:"Download reports"}),e.jsx(Fe,{checked:N.permissions.view_quality_gates,onChange:I=>L({...N,permissions:{...N.permissions,view_quality_gates:I}}),label:"View quality gates"})]})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Expiration (days)"}),e.jsx(J,{type:"number",value:((de=N.expires_in_days)==null?void 0:de.toString())||"",onChange:I=>L({...N,expires_in_days:I.target.value?parseInt(I.target.value):null}),placeholder:"Never expires if empty"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{onClick:G,loading:s,children:"Create Token"}),e.jsx(E,{onClick:()=>b(!1),variant:"outline",children:"Cancel"})]})]})]}),_?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"Loading tokens..."}):o.length===0?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No CI/CD tokens created yet. Create one to get started."}):e.jsx("div",{className:"space-y-2",children:o.map(I=>e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:I.name}),e.jsx("span",{className:"text-xs bg-primary/20 text-primary px-2 py-0.5 rounded",children:K(I.platform)})]}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:[e.jsxs("code",{className:"bg-dark-bg px-2 py-0.5 rounded",children:[I.prefix,"..."]}),e.jsx("span",{className:"mx-2",children:"-"}),"Created ",W(I.created_at),I.last_used_at&&e.jsxs("span",{className:"ml-2",children:["- Last used ",W(I.last_used_at)]}),I.expires_at&&e.jsxs("span",{className:"ml-2",children:["- Expires ",W(I.expires_at)]})]})]}),e.jsx(E,{onClick:()=>Q(I.id),variant:"outline",size:"sm",className:"text-red-400 hover:text-red-300",children:e.jsx(le,{className:"h-4 w-4"})})]},I.id))})]}),U==="quality-gates"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Quality Gates"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Configure pass/fail thresholds for your CI/CD pipelines"})]}),e.jsxs(E,{onClick:()=>q(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"New Quality Gate"]})]}),A&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4 space-y-4",children:[e.jsx("h4",{className:"font-medium text-white",children:"Create Quality Gate"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(J,{label:"Name",value:g.name,onChange:I=>C({...g,name:I.target.value}),placeholder:"e.g., Production Standards"}),e.jsx(J,{label:"Description",value:g.description,onChange:I=>C({...g,description:I.target.value}),placeholder:"Optional description"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(Fe,{checked:g.fail_on_critical,onChange:I=>C({...g,fail_on_critical:I}),label:"Fail on critical vulnerabilities"}),e.jsx(Fe,{checked:g.fail_on_high,onChange:I=>C({...g,fail_on_high:I}),label:"Fail on high vulnerabilities"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Max Critical"}),e.jsx(J,{type:"number",value:g.max_critical.toString(),onChange:I=>C({...g,max_critical:parseInt(I.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Max High"}),e.jsx(J,{type:"number",value:g.max_high.toString(),onChange:I=>C({...g,max_high:parseInt(I.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Max Medium"}),e.jsx(J,{type:"number",value:g.max_medium.toString(),onChange:I=>C({...g,max_medium:parseInt(I.target.value)||0}),placeholder:"10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Max Low"}),e.jsx(J,{type:"number",value:g.max_low.toString(),onChange:I=>C({...g,max_low:parseInt(I.target.value)||0}),placeholder:"50"})]})]}),e.jsx("div",{className:"flex gap-4",children:e.jsx(Fe,{checked:g.is_default,onChange:I=>C({...g,is_default:I}),label:"Set as default quality gate"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{onClick:v,loading:S,children:"Create Quality Gate"}),e.jsx(E,{onClick:()=>q(!1),variant:"outline",children:"Cancel"})]})]}),c?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"Loading quality gates..."}):m.length===0?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No quality gates configured. The default gate will block any critical vulnerabilities."}):e.jsx("div",{className:"space-y-2",children:m.map(I=>e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:I.name}),I.is_default&&e.jsx("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-0.5 rounded",children:"Default"}),!I.user_id&&e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded",children:"System"})]}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:[I.fail_on_critical&&"Fail on Critical",I.fail_on_high&&(I.fail_on_critical?", High":"Fail on High"),` - Max: Critical=${I.max_critical}, High=${I.max_high}, Medium=${I.max_medium}, Low=${I.max_low}`]}),I.description&&e.jsx("div",{className:"text-sm text-slate-500 mt-1",children:I.description})]}),I.user_id&&e.jsx(E,{onClick:()=>H(I.id),variant:"outline",size:"sm",className:"text-red-400 hover:text-red-300",children:e.jsx(le,{className:"h-4 w-4"})})]},I.id))})]}),U==="runs"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Recent CI/CD Runs"}),e.jsx("p",{className:"text-sm text-slate-400",children:"View recent scans triggered from CI/CD pipelines"})]}),z?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"Loading runs..."}):T.length===0?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No CI/CD runs yet. Trigger a scan from your pipeline to see results here."}):e.jsx("div",{className:"space-y-2",children:T.map(I=>e.jsx("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[I.quality_gate_passed===!0?e.jsx(It,{className:"h-5 w-5 text-green-400"}):I.quality_gate_passed===!1?e.jsx(Te,{className:"h-5 w-5 text-red-400"}):e.jsx(Ft,{className:"h-5 w-5 text-slate-400 animate-spin"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:I.scan_id?`Scan ${I.scan_id.slice(0,8)}...`:"Pending Scan"}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${I.status==="completed"?"bg-green-500/20 text-green-400":I.status==="failed"?"bg-red-500/20 text-red-400":I.status==="running"?"bg-blue-500/20 text-blue-400":"bg-slate-500/20 text-slate-400"}`,children:I.status})]}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:[K(I.platform),I.branch&&` - ${I.branch}`,I.commit_sha&&` (${I.commit_sha.slice(0,7)})`,e.jsxs("span",{className:"ml-2",children:["- ",W(I.started_at)]}),I.exit_code!==null&&e.jsxs("span",{className:"ml-2",children:["Exit code: ",I.exit_code]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:I.pipeline_url&&e.jsx("a",{href:I.pipeline_url,target:"_blank",rel:"noopener noreferrer",className:"text-slate-400 hover:text-white",children:e.jsx(es,{className:"h-4 w-4"})})})]})},I.id))})]}),U==="examples"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Pipeline Configuration Examples"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Copy these examples to integrate HeroForge with your CI/CD platform"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>u("github"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${k==="github"?"bg-primary text-white":"bg-dark-surface text-slate-400 hover:text-white"}`,children:"GitHub Actions"}),e.jsx("button",{onClick:()=>u("jenkins"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${k==="jenkins"?"bg-primary text-white":"bg-dark-surface text-slate-400 hover:text-white"}`,children:"Jenkins"}),e.jsx("button",{onClick:()=>u("gitlab"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${k==="gitlab"?"bg-primary text-white":"bg-dark-surface text-slate-400 hover:text-white"}`,children:"GitLab CI"})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm text-slate-400",children:[k==="github"&&".github/workflows/security-scan.yml",k==="jenkins"&&"Jenkinsfile",k==="gitlab"&&".gitlab-ci.yml"]}),e.jsxs(E,{onClick:()=>d(R),variant:"outline",size:"sm",children:[e.jsx(he,{className:"h-4 w-4 mr-1"}),"Copy"]})]}),Y?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"Loading example..."}):e.jsx("pre",{className:"bg-dark-bg rounded-lg p-4 text-sm text-slate-300 overflow-x-auto max-h-[500px]",children:e.jsx("code",{children:R})})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-400 mb-2",children:"Setup Instructions"}),e.jsxs("ol",{className:"text-sm text-slate-300 space-y-2 list-decimal list-inside",children:[e.jsx("li",{children:'Create a CI/CD token in the "API Tokens" tab above'}),e.jsxs("li",{children:["Add the token as a secret in your CI/CD platform:",e.jsxs("ul",{className:"ml-6 mt-1 space-y-1",children:[e.jsx("li",{children:"GitHub: Settings > Secrets > HEROFORGE_CI_TOKEN"}),e.jsx("li",{children:"Jenkins: Credentials > Add > heroforge-ci-token"}),e.jsx("li",{children:"GitLab: Settings > CI/CD > Variables > HEROFORGE_CI_TOKEN"})]})]}),e.jsx("li",{children:"Copy the pipeline configuration above to your repository"}),e.jsx("li",{children:"Update the target IP addresses in the configuration"}),e.jsx("li",{children:"Configure a quality gate if needed (defaults will be used otherwise)"})]})]})]})]})},pa=()=>{const[o,F]=r.useState(!0),[_,h]=r.useState([]),[y,b]=r.useState([]),[N,L]=r.useState(null),[t,a]=r.useState(!1),[s,n]=r.useState(!1),[m,p]=r.useState(null);r.useEffect(()=>{c()},[]);const c=async()=>{F(!0);try{const[g,C]=await Promise.all([we.admin.listProviders(),we.admin.getPresets()]);h(g.data),b(C.data)}catch(g){console.error("Failed to load SSO data:",g),l.error("Failed to load SSO providers")}finally{F(!1)}},D=async g=>{p(g);try{const C=await we.admin.testProvider(g);C.data.success?l.success(C.data.message):l.error(C.data.message)}catch(C){console.error("Test failed:",C),l.error("Connection test failed")}finally{p(null)}},A=async g=>{if(confirm("Are you sure you want to delete this SSO provider?"))try{await we.admin.deleteProvider(g),l.success("SSO provider deleted"),c()}catch(C){console.error("Delete failed:",C),l.error("Failed to delete provider")}},q=async g=>{const C=g.status==="active"?"disabled":"active";try{await we.admin.updateProvider(g.id,{status:C}),l.success(`Provider ${C==="active"?"enabled":"disabled"}`),c()}catch(S){console.error("Status toggle failed:",S),l.error("Failed to update provider status")}};return o?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx(ee,{})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"SSO Authentication"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Configure SAML 2.0 and OpenID Connect identity providers for enterprise single sign-on"})]}),e.jsxs(E,{onClick:()=>a(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add Provider"]})]}),_.length===0?e.jsxs(B,{className:"p-8 text-center",children:[e.jsx(ys,{className:"h-12 w-12 text-gray-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"No SSO Providers Configured"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Add an identity provider to enable single sign-on for your users."}),e.jsxs(E,{onClick:()=>a(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add Your First Provider"]})]}):e.jsx("div",{className:"space-y-4",children:_.map(g=>e.jsx(ga,{provider:g,onEdit:()=>{L(g),n(!0)},onDelete:()=>A(g.id),onTest:()=>D(g.id),onToggleStatus:()=>q(g),testing:m===g.id},g.id))}),t&&e.jsx(fa,{presets:y,onClose:()=>a(!1),onSuccess:()=>{a(!1),c()}}),s&&N&&e.jsx(ja,{provider:N,onClose:()=>{n(!1),L(null)},onSuccess:()=>{n(!1),L(null),c()}})]})},ga=({provider:o,onEdit:F,onDelete:_,onTest:h,onToggleStatus:y,testing:b})=>{const[N,L]=r.useState(!1),[t,a]=r.useState(null),[s,n]=r.useState(!1),m=async()=>{if(!t){n(!0);try{const A=await we.admin.getMetadata(o.id);a(A.data)}catch(A){console.error("Failed to load metadata:",A)}finally{n(!1)}}},p=()=>{N||m(),L(!N)},c=A=>{navigator.clipboard.writeText(A),l.success("Copied to clipboard")},D=async()=>{try{const A=await we.admin.downloadMetadataXml(o.id),q=new Blob([A.data],{type:"application/xml"}),g=window.URL.createObjectURL(q),C=document.createElement("a");C.href=g,C.download=`sp-metadata-${o.name}.xml`,C.click(),window.URL.revokeObjectURL(g)}catch(A){console.error("Download failed:",A),l.error("Failed to download metadata")}};return e.jsxs(B,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-gray-700 rounded-lg",children:o.provider_type==="saml"?e.jsx(ue,{className:"h-6 w-6 text-cyan-400"}):e.jsx(ys,{className:"h-6 w-6 text-cyan-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-white",children:o.display_name}),e.jsx(oe,{className:o.provider_type==="saml"?"bg-purple-600":"bg-blue-600",children:o.provider_type.toUpperCase()}),o.status==="active"?e.jsx(oe,{className:"bg-green-600",children:"Active"}):e.jsx(oe,{className:"bg-gray-600",children:"Disabled"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:o.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(E,{variant:"secondary",size:"sm",onClick:h,disabled:b,children:[b?e.jsx(ee,{size:"sm"}):e.jsx(Bs,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-1",children:"Test"})]}),e.jsx(E,{variant:"secondary",size:"sm",onClick:y,children:o.status==="active"?e.jsx(Te,{className:"h-4 w-4"}):e.jsx(me,{className:"h-4 w-4"})}),e.jsx(E,{variant:"secondary",size:"sm",onClick:F,children:e.jsx(Dt,{className:"h-4 w-4"})}),e.jsx(E,{variant:"danger",size:"sm",onClick:_,children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(E,{variant:"secondary",size:"sm",onClick:p,children:N?e.jsx(Js,{className:"h-4 w-4"}):e.jsx(Ye,{className:"h-4 w-4"})})]})]}),N&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-700",children:s?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(ee,{})}):t?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300",children:"Service Provider Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Entity ID"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm text-cyan-400 bg-gray-800 px-2 py-1 rounded flex-1 truncate",children:t.entity_id}),e.jsx(E,{size:"sm",variant:"secondary",onClick:()=>c(t.entity_id),children:e.jsx(he,{className:"h-3 w-3"})})]})]}),t.acs_url&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"ACS URL"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm text-cyan-400 bg-gray-800 px-2 py-1 rounded flex-1 truncate",children:t.acs_url}),e.jsx(E,{size:"sm",variant:"secondary",onClick:()=>c(t.acs_url),children:e.jsx(he,{className:"h-3 w-3"})})]})]}),t.redirect_uri&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Redirect URI"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm text-cyan-400 bg-gray-800 px-2 py-1 rounded flex-1 truncate",children:t.redirect_uri}),e.jsx(E,{size:"sm",variant:"secondary",onClick:()=>c(t.redirect_uri),children:e.jsx(he,{className:"h-3 w-3"})})]})]})]}),o.provider_type==="saml"&&e.jsxs(E,{variant:"secondary",size:"sm",onClick:D,children:[e.jsx(Gs,{className:"h-4 w-4 mr-2"}),"Download SP Metadata XML"]}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(Ge,{className:"h-3 w-3"}),"Configure your Identity Provider with the above values"]})]}):e.jsx("p",{className:"text-gray-400 text-sm",children:"Failed to load metadata"})})]})},fa=({presets:o,onClose:F,onSuccess:_})=>{const[h,y]=r.useState("preset"),[b,N]=r.useState(null),[L,t]=r.useState(!1),[a,s]=r.useState({name:"",display_name:"",idp_entity_id:"",idp_sso_url:"",idp_slo_url:"",idp_certificate:"",issuer_url:"",client_id:"",client_secret:"",scopes:"openid email profile",jit_provisioning:!0,default_role:"user"}),n=p=>{N(p),s(c=>({...c,name:p.name.toLowerCase().replace(/\s+/g,"_"),display_name:p.name})),y("configure")},m=async()=>{var p,c;if(b){t(!0);try{let D;b.provider_type==="saml"?D={type:"saml",idp_entity_id:a.idp_entity_id,idp_sso_url:a.idp_sso_url,idp_slo_url:a.idp_slo_url||void 0,idp_certificate:a.idp_certificate,sign_requests:!0,require_signed_response:!0,require_signed_assertion:!0,encrypt_assertions:!1,force_authn:!1,allowed_clock_skew:60}:D={type:"oidc",issuer_url:a.issuer_url,client_id:a.client_id,client_secret:a.client_secret,scopes:a.scopes.split(/[,\s]+/).filter(Boolean),use_pkce:!0,response_type:"code"};const A={name:a.name,display_name:a.display_name,provider_type:b.provider_type,icon:b.icon,config:D,attribute_mappings:b.default_attribute_mappings,jit_provisioning:a.jit_provisioning,default_role:a.default_role};await we.admin.createProvider(A),l.success("SSO provider created"),_()}catch(D){const A=D;console.error("Create failed:",D),l.error(((c=(p=A.response)==null?void 0:p.data)==null?void 0:c.error)||"Failed to create provider")}finally{t(!1)}}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Add SSO Provider"}),e.jsx("button",{onClick:F,className:"text-gray-400 hover:text-white",children:e.jsx(Te,{className:"h-6 w-6"})})]}),h==="preset"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-400 mb-4",children:"Select an identity provider:"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:o.map(p=>e.jsxs("button",{onClick:()=>n(p),className:"p-4 bg-gray-700 hover:bg-gray-600 rounded-lg text-left transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[p.provider_type==="saml"?e.jsx(ue,{className:"h-6 w-6 text-purple-400"}):e.jsx(ys,{className:"h-6 w-6 text-blue-400"}),e.jsx("span",{className:"font-medium text-white",children:p.name})]}),e.jsx("p",{className:"text-sm text-gray-400",children:p.description}),e.jsx(oe,{className:p.provider_type==="saml"?"bg-purple-600 mt-2":"bg-blue-600 mt-2",children:p.provider_type.toUpperCase()})]},p.id))})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("button",{onClick:()=>y("preset"),className:"text-cyan-400 hover:text-cyan-300",children:"Back"}),e.jsx("span",{className:"text-gray-500",children:"/"}),e.jsx("span",{className:"text-white",children:b==null?void 0:b.name})]}),(b==null?void 0:b.setup_instructions)&&e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg mb-4 text-sm text-gray-300",children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),"Setup Instructions"]}),e.jsx("div",{className:"prose prose-invert prose-sm max-w-none whitespace-pre-wrap",children:b.setup_instructions})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Internal Name"}),e.jsx(J,{value:a.name,onChange:p=>s(c=>({...c,name:p.target.value})),placeholder:"my_idp"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Display Name"}),e.jsx(J,{value:a.display_name,onChange:p=>s(c=>({...c,display_name:p.target.value})),placeholder:"My Identity Provider"})]})]}),(b==null?void 0:b.provider_type)==="saml"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"IdP Entity ID"}),e.jsx(J,{value:a.idp_entity_id,onChange:p=>s(c=>({...c,idp_entity_id:p.target.value})),placeholder:"https://idp.example.com/metadata"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"IdP SSO URL"}),e.jsx(J,{value:a.idp_sso_url,onChange:p=>s(c=>({...c,idp_sso_url:p.target.value})),placeholder:"https://idp.example.com/sso/saml"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"IdP SLO URL (Optional)"}),e.jsx(J,{value:a.idp_slo_url,onChange:p=>s(c=>({...c,idp_slo_url:p.target.value})),placeholder:"https://idp.example.com/slo/saml"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"IdP Certificate (PEM)"}),e.jsx("textarea",{value:a.idp_certificate,onChange:p=>s(c=>({...c,idp_certificate:p.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 font-mono text-sm",rows:5,placeholder:`-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----`})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Issuer URL"}),e.jsx(J,{value:a.issuer_url,onChange:p=>s(c=>({...c,issuer_url:p.target.value})),placeholder:"https://login.microsoftonline.com/{tenant}/v2.0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Client ID"}),e.jsx(J,{value:a.client_id,onChange:p=>s(c=>({...c,client_id:p.target.value})),placeholder:"your-client-id"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Client Secret"}),e.jsx(J,{type:"password",value:a.client_secret,onChange:p=>s(c=>({...c,client_secret:p.target.value})),placeholder:"your-client-secret"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Scopes"}),e.jsx(J,{value:a.scopes,onChange:p=>s(c=>({...c,scopes:p.target.value})),placeholder:"openid email profile"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Default Role"}),e.jsxs("select",{value:a.default_role,onChange:p=>s(c=>({...c,default_role:p.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"auditor",children:"Auditor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsx("div",{className:"flex items-center pt-6",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.jit_provisioning,onChange:p=>s(c=>({...c,jit_provisioning:p.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Enable JIT User Provisioning"})]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(E,{variant:"secondary",onClick:F,children:"Cancel"}),e.jsx(E,{onClick:m,disabled:L,children:L?e.jsx(ee,{size:"sm"}):"Create Provider"})]})]})]})})},ja=({provider:o,onClose:F,onSuccess:_})=>{const[h,y]=r.useState(!1),[b,N]=r.useState("general"),[L,t]=r.useState({display_name:o.display_name,jit_provisioning:o.jit_provisioning,default_role:o.default_role,update_on_login:o.update_on_login}),[a,s]=r.useState(o.attribute_mappings||[]),[n,m]=r.useState(o.group_mappings||[]),p=async()=>{y(!0);try{const g={display_name:L.display_name,jit_provisioning:L.jit_provisioning,default_role:L.default_role,update_on_login:L.update_on_login,attribute_mappings:a,group_mappings:n};await we.admin.updateProvider(o.id,g),l.success("SSO provider updated"),_()}catch(g){console.error("Update failed:",g),l.error("Failed to update provider")}finally{y(!1)}},c=()=>{s([...a,{source:"",target:"",required:!1}])},D=g=>{s(a.filter((C,S)=>S!==g))},A=()=>{m([...n,{group:"",role:"user",priority:0}])},q=g=>{m(n.filter((C,S)=>S!==g))};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-white",children:["Edit ",o.display_name]}),e.jsx("button",{onClick:F,className:"text-gray-400 hover:text-white",children:e.jsx(Te,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex border-b border-gray-700 mb-4",children:[e.jsx("button",{onClick:()=>N("general"),className:`px-4 py-2 text-sm font-medium ${b==="general"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:"General"}),e.jsx("button",{onClick:()=>N("mappings"),className:`px-4 py-2 text-sm font-medium ${b==="mappings"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:"Attribute Mappings"})]}),b==="general"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Display Name"}),e.jsx(J,{value:L.display_name,onChange:g=>t(C=>({...C,display_name:g.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Default Role"}),e.jsxs("select",{value:L.default_role,onChange:g=>t(C=>({...C,default_role:g.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"auditor",children:"Auditor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:L.jit_provisioning,onChange:g=>t(C=>({...C,jit_provisioning:g.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Enable JIT User Provisioning"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:L.update_on_login,onChange:g=>t(C=>({...C,update_on_login:g.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Update User Profile on Login"})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300",children:"Attribute Mappings"}),e.jsxs(E,{size:"sm",variant:"secondary",onClick:c,children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),"Add"]})]}),e.jsx("div",{className:"space-y-2",children:a.map((g,C)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{placeholder:"IdP Attribute",value:g.source,onChange:S=>{const x=[...a];x[C].source=S.target.value,s(x)},className:"flex-1"}),e.jsx("span",{className:"text-gray-500",children:"->"}),e.jsxs("select",{value:g.target,onChange:S=>{const x=[...a];x[C].target=S.target.value,s(x)},className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white",children:[e.jsx("option",{value:"",children:"Select field"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"username",children:"Username"}),e.jsx("option",{value:"display_name",children:"Display Name"}),e.jsx("option",{value:"first_name",children:"First Name"}),e.jsx("option",{value:"last_name",children:"Last Name"}),e.jsx("option",{value:"groups",children:"Groups"})]}),e.jsx(E,{size:"sm",variant:"danger",onClick:()=>D(C),children:e.jsx(le,{className:"h-3 w-3"})})]},C))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300",children:"Group to Role Mappings"}),e.jsxs(E,{size:"sm",variant:"secondary",onClick:A,children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),"Add"]})]}),e.jsx("div",{className:"space-y-2",children:n.map((g,C)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{placeholder:"IdP Group",value:g.group,onChange:S=>{const x=[...n];x[C].group=S.target.value,m(x)},className:"flex-1"}),e.jsx("span",{className:"text-gray-500",children:"->"}),e.jsxs("select",{value:g.role,onChange:S=>{const x=[...n];x[C].role=S.target.value,m(x)},className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"auditor",children:"Auditor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]}),e.jsx(E,{size:"sm",variant:"danger",onClick:()=>q(C),children:e.jsx(le,{className:"h-3 w-3"})})]},C))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(E,{variant:"secondary",onClick:F,children:"Cancel"}),e.jsx(E,{onClick:p,disabled:h,children:h?e.jsx(ee,{size:"sm"}):"Save Changes"})]})]})})},Sa=()=>{const[o,F]=r.useState("profile"),_=[{name:"Account",tabs:[{id:"profile",label:"Profile",icon:e.jsx(xs,{className:"h-4 w-4"}),component:e.jsx(Mt,{})},{id:"security",label:"Security",icon:e.jsx(Ze,{className:"h-4 w-4"}),component:e.jsx(sa,{})},{id:"api-keys",label:"API Keys",icon:e.jsx(Xe,{className:"h-4 w-4"}),component:e.jsx(ta,{})}]},{name:"Administration",tabs:[{id:"administration",label:"Users",icon:e.jsx(ue,{className:"h-4 w-4"}),component:e.jsx(Ut,{})},{id:"sso",label:"SSO",icon:e.jsx(Ds,{className:"h-4 w-4"}),component:e.jsx(pa,{})}]},{name:"Scanning",tabs:[{id:"target-groups",label:"Target Groups",icon:e.jsx(Rs,{className:"h-4 w-4"}),component:e.jsx(Ot,{})},{id:"exclusions",label:"Exclusions",icon:e.jsx(zs,{className:"h-4 w-4"}),component:e.jsx(Bt,{})},{id:"scheduled-scans",label:"Scheduled Scans",icon:e.jsx(fe,{className:"h-4 w-4"}),component:e.jsx($t,{})},{id:"scheduled-reports",label:"Scheduled Reports",icon:e.jsx(De,{className:"h-4 w-4"}),component:e.jsx(xa,{})},{id:"templates",label:"Scan Templates",icon:e.jsx(Ee,{className:"h-4 w-4"}),component:e.jsx(Gt,{})},{id:"finding-templates",label:"Finding Templates",icon:e.jsx($s,{className:"h-4 w-4"}),component:e.jsx(qt,{})},{id:"vpn",label:"VPN",icon:e.jsx(Hs,{className:"h-4 w-4"}),component:e.jsx(ia,{})},{id:"agents",label:"Agents",icon:e.jsx(Se,{className:"h-4 w-4"}),component:e.jsx(ca,{})},{id:"compare-scans",label:"Compare",icon:e.jsx(Tt,{className:"h-4 w-4"}),component:e.jsx(Rt,{})}]},{name:"Integrations",tabs:[{id:"notifications",label:"Notifications",icon:e.jsx(Us,{className:"h-4 w-4"}),component:e.jsx(zt,{})},{id:"webhooks",label:"Webhooks",icon:e.jsx(Qs,{className:"h-4 w-4"}),component:e.jsx(ua,{})},{id:"jira-integration",label:"JIRA",icon:e.jsx(es,{className:"h-4 w-4"}),component:e.jsx(aa,{})},{id:"servicenow-integration",label:"ServiceNow",icon:e.jsx(Vs,{className:"h-4 w-4"}),component:e.jsx(ra,{})},{id:"siem-integration",label:"SIEM",icon:e.jsx(qs,{className:"h-4 w-4"}),component:e.jsx(la,{})},{id:"cicd",label:"CI/CD",icon:e.jsx(Ks,{className:"h-4 w-4"}),component:e.jsx(ha,{})}]}],y=_.flatMap(b=>b.tabs).find(b=>b.id===o);return e.jsx(gt,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(is,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Settings"})]}),e.jsx("p",{className:"text-slate-400",children:"Manage your account, scanning configuration, and integrations"})]}),e.jsx("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:e.jsx("div",{className:"flex flex-wrap gap-6",children:_.map(b=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:b.name}),e.jsx("div",{className:"flex gap-1",children:b.tabs.map(N=>e.jsxs("button",{onClick:()=>F(N.id),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${o===N.id?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[N.icon,N.label]},N.id))})]},b.name))})}),e.jsx("div",{children:y==null?void 0:y.component})]})})};export{Sa as default};
