import{b as I,u,d as N,j as e}from"./vendor-state-BjT_zREg.js";import{r as x}from"./vendor-react-5KxtEOLM.js";import{S as P,m as K,a9 as Q,v as C,y as $,g as _,B as m,V as B,ar as O,O as q,_ as E,aY as V,b3 as G,aN as z,I as f,i as k,p as U}from"./vendor-ui-CaTPr3iI.js";import{L as H}from"./Layout-hU69iu7X.js";import{ae as o}from"./index--6GUYD2o.js";import"./vendor-markdown-BGP8SuZQ.js";import"./vendor-utils-DfRopTPV.js";const X=["Reconnaissance","ResourceDevelopment","InitialAccess","Execution","Persistence","PrivilegeEscalation","DefenseEvasion","CredentialAccess","Discovery","LateralMovement","Collection","CommandAndControl","Exfiltration","Impact"],Y={Reconnaissance:"Reconnaissance",ResourceDevelopment:"Resource Dev",InitialAccess:"Initial Access",Execution:"Execution",Persistence:"Persistence",PrivilegeEscalation:"Priv Escalation",DefenseEvasion:"Defense Evasion",CredentialAccess:"Cred Access",Discovery:"Discovery",LateralMovement:"Lateral Move",Collection:"Collection",CommandAndControl:"C2",Exfiltration:"Exfiltration",Impact:"Impact"};function S({status:t}){const i={pending:"bg-gray-700 text-gray-300",running:"bg-cyan-900 text-cyan-300",completed:"bg-green-900 text-green-300",failed:"bg-red-900 text-red-300",cancelled:"bg-yellow-900 text-yellow-300"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${i[t]}`,children:t.charAt(0).toUpperCase()+t.slice(1)})}function J({status:t}){const i={detected:{color:"bg-green-900 text-green-300",icon:e.jsx(_,{className:"h-3 w-3"}),label:"Detected"},partially_detected:{color:"bg-yellow-900 text-yellow-300",icon:e.jsx(q,{className:"h-3 w-3"}),label:"Partial"},not_detected:{color:"bg-red-900 text-red-300",icon:e.jsx(k,{className:"h-3 w-3"}),label:"Not Detected"},pending:{color:"bg-gray-700 text-gray-300",icon:e.jsx(U,{className:"h-3 w-3"}),label:"Pending"}},{color:n,icon:l,label:s}=i[t];return e.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium flex items-center gap-1 ${n}`,children:[l," ",s]})}function W({severity:t}){const i={critical:"bg-red-900 text-red-300",high:"bg-orange-900 text-orange-300",medium:"bg-yellow-900 text-yellow-300",low:"bg-blue-900 text-blue-300"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${i[t]}`,children:t.charAt(0).toUpperCase()+t.slice(1)})}function Z({dashboard:t,onExercisesClick:i,onGapsClick:n}){const l=[{label:"Total Exercises",value:t.total_exercises,icon:e.jsx(C,{className:"h-5 w-5"}),onClick:i},{label:"Running",value:t.running_exercises,icon:e.jsx(B,{className:"h-5 w-5 text-cyan-400"}),onClick:i},{label:"Overall Coverage",value:`${t.overall_coverage.toFixed(1)}%`,icon:e.jsx(O,{className:"h-5 w-5 text-green-400"}),onClick:void 0},{label:"Open Gaps",value:t.open_gaps,icon:e.jsx(q,{className:"h-5 w-5 text-red-400"}),onClick:n}];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:l.map(s=>e.jsxs("div",{onClick:s.onClick,className:`bg-gray-800 rounded-lg p-4 flex items-center gap-4 ${s.onClick?"cursor-pointer hover:border hover:border-cyan-500/50 hover:bg-gray-750 transition-all group":"border border-transparent"}`,children:[e.jsx("div",{className:"p-3 bg-gray-700 rounded-lg",children:s.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:s.label}),e.jsx("p",{className:"text-2xl font-bold text-white",children:s.value})]}),s.onClick&&e.jsx(E,{className:"w-5 h-5 text-gray-500 group-hover:text-cyan-400 transition-colors"})]},s.label))})}function ee({coverage:t}){return!t||!t.by_tactic?null:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Detection Coverage by Tactic"}),e.jsx("div",{className:"space-y-2",children:Object.entries(t.by_tactic).map(([i,n])=>{const l=n.coverage_percent;let s="bg-red-500";return l>=75?s="bg-green-500":l>=50?s="bg-yellow-500":l>=25&&(s="bg-orange-500"),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-32 text-sm text-gray-400 truncate",title:n.tactic_name,children:n.tactic_name}),e.jsx("div",{className:"flex-1 h-6 bg-gray-700 rounded overflow-hidden",children:e.jsx("div",{className:`h-full ${s} transition-all duration-300`,style:{width:`${l}%`}})}),e.jsxs("div",{className:"w-16 text-right text-sm font-medium text-white",children:[l.toFixed(0),"%"]}),e.jsxs("div",{className:"w-24 text-xs text-gray-500",children:[n.detected,"/",n.total_techniques]})]},i)})})]})}function te({matrix:t}){const[i,n]=x.useState(null);if(!t||!t.cells)return null;const l=s=>{if(!s.tested)return"bg-gray-700 hover:bg-gray-600";switch(s.detection_status){case"detected":return"bg-green-700 hover:bg-green-600";case"partially_detected":return"bg-yellow-700 hover:bg-yellow-600";case"not_detected":return"bg-red-700 hover:bg-red-600";default:return"bg-gray-700 hover:bg-gray-600"}};return e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 overflow-x-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"MITRE ATT&CK Matrix"}),e.jsxs("div",{className:"flex gap-4 text-xs",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 bg-green-700 rounded"})," Detected"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 bg-yellow-700 rounded"})," Partial"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 bg-red-700 rounded"})," Not Detected"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 bg-gray-700 rounded"})," Not Tested"]})]})]}),e.jsx("div",{className:"flex gap-1 min-w-max",children:X.map(s=>{const r=t.cells[s]||[];return e.jsxs("div",{className:"flex-shrink-0 w-24",children:[e.jsx("div",{className:"text-xs font-medium text-gray-400 text-center mb-2 truncate",title:s,children:Y[s]||s}),e.jsxs("div",{className:"space-y-1",children:[r.slice(0,15).map(c=>e.jsxs("div",{className:`p-1 rounded text-xs cursor-pointer transition-colors ${l(c)}`,onMouseEnter:()=>n(c.technique_id),onMouseLeave:()=>n(null),title:`${c.technique_id}: ${c.technique_name}`,children:[e.jsx("div",{className:"truncate text-gray-200",children:c.technique_id}),i===c.technique_id&&e.jsxs("div",{className:"absolute z-10 bg-gray-900 border border-gray-600 rounded p-2 mt-1 text-xs max-w-xs",children:[e.jsx("p",{className:"font-medium text-white",children:c.technique_name}),e.jsx("p",{className:"text-gray-400",children:c.technique_id}),c.tested&&e.jsxs("p",{className:"mt-1 text-gray-300",children:["Coverage: ",c.coverage_percent.toFixed(0),"%"]})]})]},c.technique_id)),r.length>15&&e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["+",r.length-15," more"]})]})]},s)})}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm text-gray-400",children:[e.jsxs("span",{children:["Tested: ",t.tested_techniques," / ",t.total_techniques," techniques"]}),e.jsxs("span",{children:["Overall: ",t.overall_coverage.toFixed(1),"%"]})]})]})}function se({exercise:t,onStart:i,onStop:n,onView:l}){return e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700 hover:border-gray-600 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:t.name}),t.description&&e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:t.description})]}),e.jsx(S,{status:t.status})]}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-1 mb-3",children:[e.jsxs("p",{children:["Attacks: ",t.attack_configs.length]}),e.jsxs("p",{children:["Detection Timeout: ",t.detection_timeout_secs,"s"]}),e.jsxs("p",{children:["Created: ",new Date(t.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[t.status==="pending"&&e.jsxs("button",{onClick:i,className:"flex items-center gap-1 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white text-sm rounded transition-colors",children:[e.jsx(V,{className:"h-4 w-4"})," Start"]}),t.status==="running"&&e.jsxs("button",{onClick:n,className:"flex items-center gap-1 px-3 py-1.5 bg-red-600 hover:bg-red-700 text-white text-sm rounded transition-colors",children:[e.jsx(G,{className:"h-4 w-4"})," Stop"]}),e.jsxs("button",{onClick:l,className:"flex items-center gap-1 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-white text-sm rounded transition-colors",children:[e.jsx(z,{className:"h-4 w-4"})," View"]})]})]})}function D({gap:t,onCopyRule:i}){const[n,l]=x.useState(!1);return e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-mono text-cyan-400 text-sm",children:t.technique_id}),e.jsx(W,{severity:t.severity}),t.status==="remediated"&&e.jsx("span",{className:"px-2 py-0.5 bg-green-900 text-green-300 rounded text-xs",children:"Remediated"})]}),e.jsx("h4",{className:"text-white font-medium",children:t.technique_name}),e.jsx("p",{className:"text-sm text-gray-400",children:t.tactic})]}),e.jsx("button",{onClick:()=>l(!n),className:"p-1 hover:bg-gray-700 rounded transition-colors",children:e.jsx(E,{className:`h-5 w-5 text-gray-400 transition-transform ${n?"rotate-90":""}`})})]}),n&&t.recommendations&&t.recommendations.length>0&&e.jsxs("div",{className:"mt-4 space-y-3 border-t border-gray-700 pt-3",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-300",children:"Recommendations"}),t.recommendations.map((s,r)=>e.jsxs("div",{className:"bg-gray-900 rounded p-3",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-white",children:s.title}),e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs",children:s.recommendation_type})]}),s.sigma_rule&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Sigma Rule"}),e.jsxs("button",{onClick:()=>i(s.sigma_rule),className:"flex items-center gap-1 text-xs text-cyan-400 hover:text-cyan-300",children:[e.jsx(f,{className:"h-3 w-3"})," Copy"]})]}),e.jsx("pre",{className:"text-xs bg-gray-950 p-2 rounded overflow-x-auto max-h-32 text-gray-300",children:s.sigma_rule})]}),s.splunk_query&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Splunk Query"}),e.jsxs("button",{onClick:()=>i(s.splunk_query),className:"flex items-center gap-1 text-xs text-cyan-400 hover:text-cyan-300",children:[e.jsx(f,{className:"h-3 w-3"})," Copy"]})]}),e.jsx("pre",{className:"text-xs bg-gray-950 p-2 rounded overflow-x-auto text-gray-300",children:s.splunk_query})]}),s.elastic_query&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Elastic Query"}),e.jsxs("button",{onClick:()=>i(s.elastic_query),className:"flex items-center gap-1 text-xs text-cyan-400 hover:text-cyan-300",children:[e.jsx(f,{className:"h-3 w-3"})," Copy"]})]}),e.jsx("pre",{className:"text-xs bg-gray-950 p-2 rounded overflow-x-auto text-gray-300",children:s.elastic_query})]})]},r))]})]})}function ae({isOpen:t,onClose:i,onCreate:n}){const[l,s]=x.useState(""),[r,c]=x.useState(""),[h,b]=x.useState(300);if(!t)return null;const v=d=>{d.preventDefault(),n({name:l,description:r||void 0,siem_integration_id:void 0,attack_configs:[],detection_timeout_secs:h}),s(""),c(""),b(300),i()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Create Purple Team Exercise"}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{type:"text",value:l,onChange:d=>s(d.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"Q4 Detection Validation"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:r,onChange:d=>c(d.target.value),rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"Quarterly purple team exercise to validate detection coverage..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Detection Timeout (seconds)"}),e.jsx("input",{type:"number",value:h,onChange:d=>b(parseInt(d.target.value)||300),min:30,max:3600,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Time to wait for SIEM detection after each attack"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:i,className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:"Create Exercise"})]})]})]})})}function re({exercise:t,onClose:i}){const{data:n}=u({queryKey:["purple-team-results",t.id],queryFn:()=>o.getExerciseResults(t.id).then(r=>r.data)}),{data:l}=u({queryKey:["purple-team-coverage",t.id],queryFn:()=>o.getExerciseCoverage(t.id).then(r=>r.data),enabled:t.status==="completed"}),{data:s}=u({queryKey:["purple-team-gaps",t.id],queryFn:()=>o.getExerciseGaps(t.id).then(r=>r.data),enabled:t.status==="completed"});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:t.name}),e.jsx("p",{className:"text-sm text-gray-400",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{status:t.status}),e.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-700 rounded",children:e.jsx(k,{className:"h-5 w-5 text-gray-400"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[n&&n.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"Attack Results"}),e.jsx("div",{className:"space-y-2",children:n.map(r=>e.jsxs("div",{className:"bg-gray-900 rounded p-3 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-cyan-400 text-sm",children:r.technique_id}),e.jsx("span",{className:"text-white",children:r.technique_name})]}),e.jsxs("div",{className:"text-sm text-gray-400 mt-1",children:["Target: ",r.target," | Type: ",r.attack_type]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(J,{status:r.detection_status}),r.time_to_detect_ms&&e.jsxs("span",{className:"text-sm text-gray-400",children:[(r.time_to_detect_ms/1e3).toFixed(1),"s"]})]})]},r.id))})]}),l&&e.jsx(ee,{coverage:l}),s&&s.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-white mb-3",children:["Detection Gaps (",s.length,")"]}),e.jsx("div",{className:"space-y-2",children:s.map(r=>e.jsx(D,{gap:r,onCopyRule:c=>{navigator.clipboard.writeText(c),m.success("Copied to clipboard")}},r.id))})]})]})]})})}function me(){const t=I(),[i,n]=x.useState(!1),[l,s]=x.useState(null),[r,c]=x.useState("all"),[h,b]=x.useState(""),{data:v,isLoading:d}=u({queryKey:["purple-team-dashboard"],queryFn:()=>o.getDashboard().then(a=>a.data)}),{data:g,isLoading:T}=u({queryKey:["purple-team-exercises"],queryFn:()=>o.listExercises().then(a=>a.data)}),{data:w,isLoading:A}=u({queryKey:["purple-team-matrix"],queryFn:()=>o.getCoverageMatrix().then(a=>a.data)}),{data:p}=u({queryKey:["purple-team-all-gaps"],queryFn:()=>o.listGaps().then(a=>a.data)}),F=N({mutationFn:o.createExercise,onSuccess:()=>{t.invalidateQueries({queryKey:["purple-team-exercises"]}),t.invalidateQueries({queryKey:["purple-team-dashboard"]}),m.success("Exercise created")},onError:()=>m.error("Failed to create exercise")}),L=N({mutationFn:o.startExercise,onSuccess:()=>{t.invalidateQueries({queryKey:["purple-team-exercises"]}),t.invalidateQueries({queryKey:["purple-team-dashboard"]}),m.success("Exercise started")},onError:()=>m.error("Failed to start exercise")}),R=N({mutationFn:o.stopExercise,onSuccess:()=>{t.invalidateQueries({queryKey:["purple-team-exercises"]}),t.invalidateQueries({queryKey:["purple-team-dashboard"]}),m.success("Exercise stopped")},onError:()=>m.error("Failed to stop exercise")}),y=p==null?void 0:p.filter(a=>{if(r==="open"&&a.status==="remediated"||r==="remediated"&&a.status!=="remediated")return!1;if(h){const j=h.toLowerCase();return a.technique_id.toLowerCase().includes(j)||a.technique_name.toLowerCase().includes(j)||a.tactic.toLowerCase().includes(j)}return!0}),M=d||T||A;return e.jsx(H,{children:e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"h-8 w-8 text-purple-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Purple Team"}),e.jsx("p",{className:"text-gray-400",children:"Attack simulation and detection validation"})]})]}),e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(K,{className:"h-4 w-4"})," New Exercise"]})]}),M?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(Q,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[v&&e.jsx(Z,{dashboard:v,onExercisesClick:()=>{var a;return(a=document.getElementById("exercises-section"))==null?void 0:a.scrollIntoView({behavior:"smooth"})},onGapsClick:()=>{var a;c("open"),(a=document.getElementById("gaps-section"))==null||a.scrollIntoView({behavior:"smooth"})}}),w&&e.jsx(te,{matrix:w}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{id:"exercises-section",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Exercises"}),e.jsxs("div",{className:"space-y-3",children:[(g==null?void 0:g.length)===0&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 text-center",children:[e.jsx(C,{className:"h-12 w-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No exercises yet"}),e.jsx("button",{onClick:()=>n(!0),className:"mt-3 text-cyan-400 hover:text-cyan-300",children:"Create your first exercise"})]}),g==null?void 0:g.map(a=>e.jsx(se,{exercise:a,onStart:()=>L.mutate(a.id),onStop:()=>R.mutate(a.id),onView:()=>s(a)},a.id))]})]}),e.jsxs("div",{id:"gaps-section",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Detection Gaps"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:h,onChange:a=>b(a.target.value),placeholder:"Search...",className:"pl-8 pr-3 py-1.5 bg-gray-700 border border-gray-600 rounded text-white text-sm focus:outline-none focus:border-cyan-500"})]}),e.jsxs("select",{value:r,onChange:a=>c(a.target.value),className:"px-3 py-1.5 bg-gray-700 border border-gray-600 rounded text-white text-sm focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"all",children:"All Gaps"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"remediated",children:"Remediated"})]})]})]}),e.jsxs("div",{className:"space-y-2 max-h-[500px] overflow-y-auto",children:[(y==null?void 0:y.length)===0&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 text-center",children:[e.jsx(_,{className:"h-12 w-12 text-green-500 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:(p==null?void 0:p.length)===0?"No detection gaps found":"No gaps match your filter"})]}),y==null?void 0:y.map(a=>e.jsx(D,{gap:a,onCopyRule:j=>{navigator.clipboard.writeText(j),m.success("Copied to clipboard")}},a.id))]})]})]})]}),e.jsx(ae,{isOpen:i,onClose:()=>n(!1),onCreate:a=>F.mutate(a)}),l&&e.jsx(re,{exercise:l,onClose:()=>s(null)})]})})}export{me as default};
