import{j as e,u as U,b as ae,d as Q}from"./vendor-state-BjT_zREg.js";import{R as he,r as b,i as Ce,u as Se}from"./vendor-react-5KxtEOLM.js";import{X as J,K as D,a1 as I,n as H,aO as ce,S as z,ar as ge,ag as be,y as ye,G as Pe,x as Ae,ap as je,aW as fe,a as Ne,b as ve,V as X,f as Te,j as Re,l as qe,g as G,B as T,b2 as te,m as Z,ac as ee,a3 as de,bA as re,Y,aZ as we,b4 as ue,J as ne,aa as ie,p as Le,a7 as Fe,F as Ee}from"./vendor-ui-CfSMq23b.js";import{L as $e}from"./Layout-C_2au5Vm.js";import{c as pe,J as Me,a9 as E,B as $}from"./index-CJ_zz9jP.js";import{u as Ke,E as De}from"./useRequireEngagement-PpLJuw5s.js";import"./vendor-markdown-BGP8SuZQ.js";import"./vendor-utils-DfRopTPV.js";const Ue=[{id:"password_spray",name:"Password Spray",description:"Test common passwords against multiple accounts with lockout evasion",category:"credential",icon:e.jsx(D,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium",requirements:["Target IP/hostname","Username list","Password list"]},{id:"kerberoast",name:"Kerberoasting",description:"Extract TGS tickets from Active Directory for offline cracking",category:"credential",icon:e.jsx(z,{className:"h-6 w-6"}),difficulty:"medium",risk:"low",requirements:["Domain credentials","Domain controller access"]},{id:"asrep_roast",name:"AS-REP Roasting",description:"Target accounts without Kerberos pre-authentication",category:"credential",icon:e.jsx(ge,{className:"h-6 w-6"}),difficulty:"medium",risk:"low",requirements:["Domain controller","Username list"]},{id:"smb_relay",name:"SMB Relay",description:"Relay NTLM authentication to other targets",category:"credential",icon:e.jsx(be,{className:"h-6 w-6"}),difficulty:"hard",risk:"high",requirements:["Network position","Target systems"]},{id:"reverse_shell",name:"Reverse Shell",description:"Generate reverse shell payloads in various formats",category:"payload",icon:e.jsx(I,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium",requirements:["LHOST","LPORT"]},{id:"bind_shell",name:"Bind Shell",description:"Generate bind shell payloads that listen for connections",category:"payload",icon:e.jsx(ye,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium",requirements:["LPORT"]},{id:"web_shell",name:"Web Shell",description:"Generate web shells for PHP, ASPX, JSP",category:"payload",icon:e.jsx(Pe,{className:"h-6 w-6"}),difficulty:"easy",risk:"high",requirements:["Target web server"]},{id:"meterpreter",name:"Meterpreter",description:"Generate advanced Meterpreter payloads via msfvenom",category:"payload",icon:e.jsx(Ae,{className:"h-6 w-6"}),difficulty:"medium",risk:"high",requirements:["msfvenom installed","LHOST","LPORT"]},{id:"credential_dump",name:"Credential Dump",description:"Extract credentials from memory, registry, or files",category:"post-exploit",icon:e.jsx(je,{className:"h-6 w-6"}),difficulty:"medium",risk:"high",requirements:["Admin/root access","Target system"]},{id:"priv_esc",name:"Privilege Escalation",description:"Check for privilege escalation vectors",category:"post-exploit",icon:e.jsx(fe,{className:"h-6 w-6"}),difficulty:"medium",risk:"medium",requirements:["Target system access"]},{id:"persistence",name:"Persistence",description:"Establish persistent access mechanisms",category:"post-exploit",icon:e.jsx(Ne,{className:"h-6 w-6"}),difficulty:"hard",risk:"high",requirements:["System access","Admin/root privileges"]},{id:"lateral_movement",name:"Lateral Movement",description:"Move to other systems using Pass-the-Hash, WMI, PsExec",category:"post-exploit",icon:e.jsx(ve,{className:"h-6 w-6"}),difficulty:"hard",risk:"high",requirements:["Credentials/hashes","Network access"]}],Oe=({isOpen:p,onClose:y,onSelect:f,msfvenomAvailable:S=!1})=>{const[m,i]=he.useState("all"),[x,v]=he.useState("");if(!p)return null;const k=Ue.filter(c=>{const P=m==="all"||c.category===m,j=x===""||c.name.toLowerCase().includes(x.toLowerCase())||c.description.toLowerCase().includes(x.toLowerCase());return P&&j}),R=c=>{switch(c){case"easy":return"bg-green-500/20 text-green-400";case"medium":return"bg-yellow-500/20 text-yellow-400";case"hard":return"bg-red-500/20 text-red-400";default:return"bg-gray-500/20 text-gray-400"}},u=c=>{switch(c){case"low":return"bg-green-500/20 text-green-400";case"medium":return"bg-yellow-500/20 text-yellow-400";case"high":return"bg-red-500/20 text-red-400";default:return"bg-gray-500/20 text-gray-400"}},h=c=>{switch(c){case"credential":return"text-blue-400";case"payload":return"text-green-400";case"post-exploit":return"text-red-400"}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Select Attack Type"}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-white p-2 rounded-lg hover:bg-dark-bg transition-colors",children:e.jsx(J,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search attacks...",value:x,onChange:c=>v(c.target.value),className:"flex-1 px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>i("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${m==="all"?"bg-primary text-white":"bg-dark-bg text-gray-400 hover:text-white"}`,children:"All"}),e.jsxs("button",{onClick:()=>i("credential"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${m==="credential"?"bg-blue-500/20 text-blue-400 border border-blue-500/50":"bg-dark-bg text-gray-400 hover:text-white"}`,children:[e.jsx(D,{className:"h-4 w-4"}),"Credentials"]}),e.jsxs("button",{onClick:()=>i("payload"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${m==="payload"?"bg-green-500/20 text-green-400 border border-green-500/50":"bg-dark-bg text-gray-400 hover:text-white"}`,children:[e.jsx(I,{className:"h-4 w-4"}),"Payloads"]}),e.jsxs("button",{onClick:()=>i("post-exploit"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${m==="post-exploit"?"bg-red-500/20 text-red-400 border border-red-500/50":"bg-dark-bg text-gray-400 hover:text-white"}`,children:[e.jsx(H,{className:"h-4 w-4"}),"Post-Exploit"]})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(c=>{const P=c.id==="meterpreter"&&!S;return e.jsxs("button",{onClick:()=>!P&&f(c),disabled:P,className:`p-4 rounded-lg border text-left transition-all ${P?"bg-dark-bg/50 border-dark-border opacity-50 cursor-not-allowed":"bg-dark-bg border-dark-border hover:border-primary hover:shadow-lg hover:shadow-primary/10"}`,children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-dark-surface ${h(c.category)}`,children:c.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-white font-medium truncate",children:c.name}),P&&e.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-400 px-2 py-0.5 rounded",children:"msfvenom required"})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1 line-clamp-2",children:c.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${R(c.difficulty)}`,children:c.difficulty}),e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded ${u(c.risk)}`,children:[c.risk," risk"]})]})]})]}),c.requirements&&c.requirements.length>0&&e.jsx("div",{className:"mt-3 pt-3 border-t border-dark-border",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Requires: ",c.requirements.join(", ")]})})]},c.id)})}),k.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ce,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No attacks match your search"})]})]}),e.jsx("div",{className:"p-4 border-t border-dark-border bg-dark-bg/50",children:e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Select an attack type to configure and execute. All actions are logged for audit purposes."})})]})})},oe=({customerId:p,assetIds:y,engagementId:f,onCustomerChange:S,onAssetChange:m,onEngagementChange:i,onTargetsFromAssets:x,disabled:v=!1})=>{const[k,R]=b.useState(!1),{data:u=[]}=U({queryKey:["crm-customers-list"],queryFn:async()=>(await pe.customers.getAll()).data||[]}),{data:h=[]}=U({queryKey:["customer-assets",p],queryFn:async()=>p?(await Me.getAssets()).data||[]:[],enabled:!!p}),{data:c=[]}=U({queryKey:["customer-engagements",p],queryFn:async()=>p?(await pe.engagements.getByCustomer(p)).data||[]:[],enabled:!!p});b.useEffect(()=>{if(y.length>0&&h.length>0&&x){const A=h.filter(w=>y.includes(w.id)).map(w=>w.ip_address||w.hostname).filter(Boolean);A.length>0&&x(A)}},[y,h,x]);const P=r=>{y.includes(r)?m(y.filter(A=>A!==r)):m([...y,r])},j=()=>{m(h.map(r=>r.id))},t=()=>{m([])},s=y.length,g=h.filter(r=>y.includes(r.id)).map(r=>r.hostname||r.ip_address).slice(0,3).join(", ");return e.jsxs("div",{className:"space-y-4 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(X,{className:"h-5 w-5 text-red-400"}),e.jsx("h4",{className:"text-red-400 font-medium",children:"Authorization Scope (Required)"})]}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"All exploitation campaigns must be tied to a specific customer and their assets. This ensures proper authorization and audit trails."}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 mb-2",children:[e.jsx(Te,{className:"h-4 w-4"}),"Customer"]}),e.jsxs("select",{value:p,onChange:r=>{S(r.target.value),m([]),i==null||i("")},disabled:v,className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Select a customer..."}),u.map(r=>e.jsxs("option",{value:r.id,children:[r.name," ",r.industry?`(${r.industry})`:""]},r.id))]})]}),p&&c.length>0&&i&&e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 mb-2",children:[e.jsx(Re,{className:"h-4 w-4"}),"Engagement (Optional)"]}),e.jsxs("select",{value:f||"",onChange:r=>i(r.target.value),disabled:v,className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white disabled:opacity-50",children:[e.jsx("option",{value:"",children:"No specific engagement"}),c.filter(r=>r.status==="in_progress"||r.status==="planning").map(r=>e.jsxs("option",{value:r.id,children:[r.name," (",r.engagement_type,")"]},r.id))]})]}),p&&e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 mb-2",children:[e.jsx(ye,{className:"h-4 w-4"}),"Target Assets"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>R(!k),disabled:v||h.length===0,className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-left text-white disabled:opacity-50 flex items-center justify-between",children:[e.jsx("span",{className:s===0?"text-gray-500":"",children:s===0?"Select assets...":`${s} asset(s): ${g}${s>3?"...":""}`}),e.jsx(qe,{className:`h-4 w-4 transition-transform ${k?"rotate-180":""}`})]}),k&&e.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-dark-surface border border-dark-border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-dark-border",children:[e.jsx("button",{type:"button",onClick:j,className:"text-xs text-primary hover:underline",children:"Select All"}),e.jsx("button",{type:"button",onClick:t,className:"text-xs text-gray-400 hover:text-white",children:"Clear"})]}),h.length===0?e.jsx("div",{className:"p-3 text-gray-400 text-sm text-center",children:"No assets found for this customer"}):h.map(r=>e.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-dark-bg cursor-pointer border-b border-dark-border last:border-0",children:[e.jsx("input",{type:"checkbox",checked:y.includes(r.id),onChange:()=>P(r.id),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-white text-sm font-medium truncate",children:r.hostname||r.ip_address}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[r.ip_address&&e.jsx("span",{children:r.ip_address}),r.os_family&&e.jsx("span",{children:r.os_family})]})]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${r.status==="active"?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:r.status})]},r.id))]})]}),s>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:h.filter(r=>y.includes(r.id)).map(r=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-dark-bg rounded text-xs text-gray-300",children:[r.ip_address||r.hostname,e.jsx("button",{type:"button",onClick:()=>P(r.id),className:"text-gray-500 hover:text-red-400",children:"Ã—"})]},r.id))})]}),e.jsx("div",{className:`flex items-center gap-2 p-2 rounded ${p&&y.length>0?"bg-green-500/10 text-green-400":"bg-yellow-500/10 text-yellow-400"}`,children:p&&y.length>0?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Authorization scope defined"})]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:p?"Select at least one asset to target":"Select a customer to continue"})]})})]})},ze=[{value:"smb",label:"SMB (445)",description:"Windows file sharing"},{value:"ldap",label:"LDAP (389/636)",description:"Active Directory"},{value:"rdp",label:"RDP (3389)",description:"Remote Desktop"},{value:"ssh",label:"SSH (22)",description:"Secure Shell"},{value:"http_basic",label:"HTTP Basic",description:"Basic authentication"},{value:"http_ntlm",label:"HTTP NTLM",description:"NTLM over HTTP"},{value:"kerberos",label:"Kerberos (88)",description:"Kerberos auth"},{value:"winrm",label:"WinRM (5985/5986)",description:"Windows Remote Management"}],We=["Password1!","Welcome1!","Summer2024!","Winter2024!","Spring2024!","Fall2024!","Company123!","Qwerty123!","Password123","Welcome123","Admin123!","User123!"],Be=({isOpen:p,onClose:y,onSuccess:f,onCampaignCreated:S})=>{const m=ae(),[i,x]=b.useState(1),[v,k]=b.useState(!1),[R,u]=b.useState(""),[h,c]=b.useState([]),[P,j]=b.useState(""),[t,s]=b.useState({name:"",targets:[""],usernames:[""],passwords:[""],protocol:"smb",domain:"",delay_between_attempts_ms:1e3,delay_between_users_ms:5e3,max_attempts_per_user:3,stop_on_success:!1,threads:5}),g=b.useCallback(l=>{s(o=>({...o,targets:l}))},[]),r=Q({mutationFn:async()=>(await E.createCampaign({name:t.name||`Password Spray - ${new Date().toLocaleString()}`,attack_type:"password_spray",config:{protocol:t.protocol,domain:t.domain||null,usernames:t.usernames.filter(o=>o.trim()),passwords:t.passwords.filter(o=>o.trim()),delay_between_attempts_ms:t.delay_between_attempts_ms,delay_between_users_ms:t.delay_between_users_ms,max_attempts_per_user:t.max_attempts_per_user,stop_on_success:t.stop_on_success,threads:t.threads},targets:t.targets.filter(o=>o.trim()),customer_id:R,asset_ids:h,engagement_id:P||void 0})).data,onSuccess:async l=>{if(v)try{await E.startCampaign(l.id,!0),T.success("Campaign created and started!")}catch{T.success("Campaign created. Start it manually to begin.")}else T.success("Campaign created. Authorize to start.");m.invalidateQueries({queryKey:["exploitation-campaigns"]}),m.invalidateQueries({queryKey:["exploitation-status"]}),f==null||f(),S==null||S(l.id),y()},onError:l=>{var o,C;T.error(((C=(o=l.response)==null?void 0:o.data)==null?void 0:C.error)||"Failed to create campaign")}}),A=()=>s({...t,targets:[...t.targets,""]}),w=l=>{const o=t.targets.filter((C,K)=>K!==l);s({...t,targets:o.length?o:[""]})},d=(l,o)=>{const C=[...t.targets];C[l]=o,s({...t,targets:C})},L=()=>s({...t,usernames:[...t.usernames,""]}),O=l=>{const o=t.usernames.filter((C,K)=>K!==l);s({...t,usernames:o.length?o:[""]})},se=(l,o)=>{const C=[...t.usernames];C[l]=o,s({...t,usernames:C})},V=()=>s({...t,passwords:[...t.passwords,""]}),F=l=>{const o=t.passwords.filter((C,K)=>K!==l);s({...t,passwords:o.length?o:[""]})},W=(l,o)=>{const C=[...t.passwords];C[l]=o,s({...t,passwords:C})},B=()=>{s({...t,passwords:We})},n=l=>o=>{var me;const C=(me=o.target.files)==null?void 0:me[0];if(!C)return;const K=new FileReader;K.onload=ke=>{var xe;const _e=((xe=ke.target)==null?void 0:xe.result).split(`
`).map(le=>le.trim()).filter(le=>le);s({...t,[l]:_e})},K.readAsText(C)};if(!p)return null;const N=t.targets.filter(l=>l.trim()).length,_=t.usernames.filter(l=>l.trim()).length,a=t.passwords.filter(l=>l.trim()).length,q=N*_*a,M=Math.ceil(q*t.delay_between_attempts_ms/1e3/60);return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5 text-blue-400"}),"Password Spray Attack"]}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-white",children:e.jsx(J,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex items-center gap-2 mt-4",children:[{num:1,label:"Scope"},{num:2,label:"Targets"},{num:3,label:"Credentials"},{num:4,label:"Options"}].map(l=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${i>=l.num?"bg-primary text-white":"bg-dark-bg text-gray-400 border border-dark-border"}`,children:l.num}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:l.label})]}),l.num<4&&e.jsx("div",{className:`w-8 h-0.5 mx-1 ${i>l.num?"bg-primary":"bg-dark-border"}`})]},l.num))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[i===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Campaign Name (Optional)"}),e.jsx("input",{type:"text",value:t.name,onChange:l=>s({...t,name:l.target.value}),placeholder:"Password Spray - Domain Admin Hunt",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsx(oe,{customerId:R,assetIds:h,engagementId:P,onCustomerChange:u,onAssetChange:c,onEngagementChange:j,onTargetsFromAssets:g})]}),i===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Targets (Auto-populated from assets)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:n("targets")}),e.jsx(te,{className:"h-4 w-4 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:A,className:"text-xs text-primary hover:underline",children:[e.jsx(Z,{className:"h-4 w-4 inline"})," Add"]})]})]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:t.targets.map((l,o)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:C=>d(o,C.target.value),placeholder:"192.168.1.10 or dc01.domain.local",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),t.targets.length>1&&e.jsx("button",{onClick:()=>w(o),className:"text-red-400 hover:text-red-300 px-2",children:e.jsx(ee,{className:"h-4 w-4"})})]},o))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Protocol"}),e.jsx("select",{value:t.protocol,onChange:l=>s({...t,protocol:l.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:ze.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Domain (Optional)"}),e.jsx("input",{type:"text",value:t.domain,onChange:l=>s({...t,domain:l.target.value}),placeholder:"CORP or corp.local",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]})]}),i===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Usernames"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:n("usernames")}),e.jsx(te,{className:"h-4 w-4 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:L,className:"text-xs text-primary hover:underline",children:[e.jsx(Z,{className:"h-4 w-4 inline"})," Add"]})]})]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:t.usernames.map((l,o)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:C=>se(o,C.target.value),placeholder:"administrator",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),t.usernames.length>1&&e.jsx("button",{onClick:()=>O(o),className:"text-red-400 hover:text-red-300 px-2",children:e.jsx(ee,{className:"h-4 w-4"})})]},o))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Passwords"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:B,className:"text-xs text-yellow-400 hover:underline",children:"Load Common"}),e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:n("passwords")}),e.jsx(te,{className:"h-4 w-4 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:V,className:"text-xs text-primary hover:underline",children:[e.jsx(Z,{className:"h-4 w-4 inline"})," Add"]})]})]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:t.passwords.map((l,o)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:C=>W(o,C.target.value),placeholder:"Password123!",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),t.passwords.length>1&&e.jsx("button",{onClick:()=>F(o),className:"text-red-400 hover:text-red-300 px-2",children:e.jsx(ee,{className:"h-4 w-4"})})]},o))})]})]}),i===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4 border border-dark-border",children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4 text-yellow-400"}),"Lockout Protection"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Delay Between Attempts (ms)"}),e.jsx("input",{type:"number",value:t.delay_between_attempts_ms,onChange:l=>s({...t,delay_between_attempts_ms:parseInt(l.target.value)||1e3}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Delay Between Users (ms)"}),e.jsx("input",{type:"number",value:t.delay_between_users_ms,onChange:l=>s({...t,delay_between_users_ms:parseInt(l.target.value)||5e3}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Max Attempts Per User"}),e.jsx("input",{type:"number",value:t.max_attempts_per_user,onChange:l=>s({...t,max_attempts_per_user:parseInt(l.target.value)||3}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Threads"}),e.jsx("input",{type:"number",value:t.threads,onChange:l=>s({...t,threads:parseInt(l.target.value)||5}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"stop-on-success",checked:t.stop_on_success,onChange:l=>s({...t,stop_on_success:l.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary"}),e.jsx("label",{htmlFor:"stop-on-success",className:"text-gray-300 text-sm",children:"Stop on first successful authentication"})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-blue-400 font-medium mb-2 flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"Attack Summary"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Targets:"}),e.jsx("span",{className:"text-white ml-2",children:N})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Usernames:"}),e.jsx("span",{className:"text-white ml-2",children:_})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Passwords:"}),e.jsx("span",{className:"text-white ml-2",children:a})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Total Attempts:"}),e.jsx("span",{className:"text-white ml-2",children:q.toLocaleString()})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-400",children:"Estimated Time:"}),e.jsxs("span",{className:"text-white ml-2",children:["~",M," minutes"]})]})]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",id:"authorized",checked:v,onChange:l=>k(l.target.checked),className:"w-4 h-4 mt-1 rounded border-yellow-500 bg-dark-bg text-yellow-500"}),e.jsxs("label",{htmlFor:"authorized",className:"text-sm",children:[e.jsx("span",{className:"text-yellow-400 font-medium",children:"Authorization Required"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"I am authorized to perform this security test against the specified targets. I understand that unauthorized access attempts are illegal."})]})]})})]})]}),e.jsxs("div",{className:"p-4 border-t border-dark-border flex justify-between",children:[e.jsx($,{variant:"secondary",onClick:()=>i>1?x(i-1):y(),children:i>1?"Back":"Cancel"}),e.jsx($,{variant:"primary",onClick:()=>{i<4?x(i+1):r.mutate()},disabled:i===1&&(!R||h.length===0)||i===2&&N===0||i===3&&(_===0||a===0)||i===4&&!v||r.isPending,children:i<4?"Next":r.isPending?"Creating...":"Start Attack"})]})]})})},He=({isOpen:p,onClose:y,onSuccess:f,onCampaignCreated:S,attackType:m})=>{const i=ae(),[x,v]=b.useState(1),[k,R]=b.useState(!1),[u,h]=b.useState(""),[c,P]=b.useState([]),[j,t]=b.useState(""),[s,g]=b.useState({name:"",domain_controller:"",domain:"",username:"",password:"",ntlm_hash:"",use_hash:!1,target_spns:[""],enumerate_spns:!0,usernames:[""],enumerate_users:!1,output_format:"hashcat",request_rc4:!0}),r=Q({mutationFn:async()=>{const n=m==="kerberoast"?{domain_controller:s.domain_controller,domain:s.domain,username:s.username,password:s.use_hash?null:s.password,ntlm_hash:s.use_hash?s.ntlm_hash:null,target_spns:s.enumerate_spns?null:s.target_spns.filter(_=>_.trim()),output_format:s.output_format,request_rc4:s.request_rc4}:{domain_controller:s.domain_controller,domain:s.domain,usernames:s.enumerate_users?[]:s.usernames.filter(_=>_.trim()),enumerate_users:s.enumerate_users,output_format:s.output_format};return(await E.createCampaign({name:s.name||`${m==="kerberoast"?"Kerberoast":"AS-REP Roast"} - ${new Date().toLocaleString()}`,attack_type:m,config:n,targets:[s.domain_controller],customer_id:u,asset_ids:c,engagement_id:j||void 0})).data},onSuccess:async n=>{if(k)try{await E.startCampaign(n.id,!0),T.success("Kerberos attack started!")}catch{T.success("Campaign created. Start manually to begin.")}else T.success("Campaign created.");i.invalidateQueries({queryKey:["exploitation-campaigns"]}),i.invalidateQueries({queryKey:["exploitation-status"]}),f==null||f(),S==null||S(n.id),y()},onError:n=>{var N,_;T.error(((_=(N=n.response)==null?void 0:N.data)==null?void 0:_.error)||"Failed to create campaign")}}),A=()=>g({...s,target_spns:[...s.target_spns,""]}),w=n=>{const N=s.target_spns.filter((_,a)=>a!==n);g({...s,target_spns:N.length?N:[""]})},d=(n,N)=>{const _=[...s.target_spns];_[n]=N,g({...s,target_spns:_})},L=()=>g({...s,usernames:[...s.usernames,""]}),O=n=>{const N=s.usernames.filter((_,a)=>a!==n);g({...s,usernames:N.length?N:[""]})},se=(n,N)=>{const _=[...s.usernames];_[n]=N,g({...s,usernames:_})},V=n=>N=>{var q;const _=(q=N.target.files)==null?void 0:q[0];if(!_)return;const a=new FileReader;a.onload=M=>{var C;const o=((C=M.target)==null?void 0:C.result).split(`
`).map(K=>K.trim()).filter(K=>K);g({...s,[n]:o})},a.readAsText(_)};if(!p)return null;const F=m==="kerberoast",W=F?"Kerberoasting Attack":"AS-REP Roasting Attack",B=F?e.jsx(z,{className:"h-5 w-5 text-purple-400"}):e.jsx(ge,{className:"h-5 w-5 text-orange-400"});return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[B,W]}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-white",children:e.jsx(J,{className:"h-5 w-5"})})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:F?"Extract TGS tickets for service accounts to crack offline. Targets accounts with SPNs set.":"Target accounts without Kerberos pre-authentication to extract AS-REP hashes."}),e.jsx("div",{className:"flex items-center gap-2 mt-4",children:[{num:1,label:"Scope"},{num:2,label:"Target"},{num:3,label:"Options"}].map(n=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${x>=n.num?F?"bg-purple-500 text-white":"bg-orange-500 text-white":"bg-dark-bg text-gray-400 border border-dark-border"}`,children:n.num}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:n.label})]}),n.num<3&&e.jsx("div",{className:`w-8 h-0.5 mx-1 ${x>n.num?F?"bg-purple-500":"bg-orange-500":"bg-dark-border"}`})]},n.num))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[x===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Campaign Name (Optional)"}),e.jsx("input",{type:"text",value:s.name,onChange:n=>g({...s,name:n.target.value}),placeholder:`${F?"Kerberoast":"AS-REP Roast"} - SQL Admins`,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsx(oe,{customerId:u,assetIds:c,engagementId:j,onCustomerChange:h,onAssetChange:P,onEngagementChange:t})]}),x===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Domain Controller"}),e.jsx("input",{type:"text",value:s.domain_controller,onChange:n=>g({...s,domain_controller:n.target.value}),placeholder:"dc01.corp.local or 192.168.1.10",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Domain"}),e.jsx("input",{type:"text",value:s.domain,onChange:n=>g({...s,domain:n.target.value}),placeholder:"corp.local",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]}),F&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-yellow-400"}),"Authentication"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Username"}),e.jsx("input",{type:"text",value:s.username,onChange:n=>g({...s,username:n.target.value}),placeholder:"domain_user",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:!s.use_hash,onChange:()=>g({...s,use_hash:!1}),className:"text-primary"}),"Use Password"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:s.use_hash,onChange:()=>g({...s,use_hash:!0}),className:"text-primary"}),"Use NTLM Hash"]})]}),s.use_hash?e.jsx("input",{type:"text",value:s.ntlm_hash,onChange:n=>g({...s,ntlm_hash:n.target.value}),placeholder:"AABBCCDD11223344:EEFFGGHHII556677",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white font-mono text-sm"}):e.jsx("input",{type:"password",value:s.password,onChange:n=>g({...s,password:n.target.value}),placeholder:"Password",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]}),e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Target SPNs"}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("input",{type:"checkbox",id:"enumerate-spns",checked:s.enumerate_spns,onChange:n=>g({...s,enumerate_spns:n.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary"}),e.jsx("label",{htmlFor:"enumerate-spns",className:"text-gray-300 text-sm",children:"Enumerate all SPNs automatically"})]}),!s.enumerate_spns&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Specify target SPNs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:V("target_spns")}),e.jsx(te,{className:"h-3 w-3 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:A,className:"text-xs text-primary hover:underline",children:[e.jsx(Z,{className:"h-3 w-3 inline"})," Add"]})]})]}),s.target_spns.map((n,N)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:n,onChange:_=>d(N,_.target.value),placeholder:"MSSQLSvc/sql01.corp.local:1433",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm font-mono"}),s.target_spns.length>1&&e.jsx("button",{onClick:()=>w(N),className:"text-red-400 px-2",children:e.jsx(ee,{className:"h-4 w-4"})})]},N))]})]})]}),!F&&e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Target Users"}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("input",{type:"checkbox",id:"enumerate-users",checked:s.enumerate_users,onChange:n=>g({...s,enumerate_users:n.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary"}),e.jsx("label",{htmlFor:"enumerate-users",className:"text-gray-300 text-sm",children:"Enumerate users without pre-auth automatically"})]}),!s.enumerate_users&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Specify target usernames"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:V("usernames")}),e.jsx(te,{className:"h-3 w-3 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:L,className:"text-xs text-primary hover:underline",children:[e.jsx(Z,{className:"h-3 w-3 inline"})," Add"]})]})]}),s.usernames.map((n,N)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:n,onChange:_=>se(N,_.target.value),placeholder:"svc_backup",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),s.usernames.length>1&&e.jsx("button",{onClick:()=>O(N),className:"text-red-400 px-2",children:e.jsx(ee,{className:"h-4 w-4"})})]},N))]})]})]}),x===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4 border border-dark-border",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Output Options"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Hash Format"}),e.jsxs("select",{value:s.output_format,onChange:n=>g({...s,output_format:n.target.value}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"hashcat",children:"Hashcat"}),e.jsx("option",{value:"john",children:"John the Ripper"})]})]}),F&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"request-rc4",checked:s.request_rc4,onChange:n=>g({...s,request_rc4:n.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary mr-3"}),e.jsx("label",{htmlFor:"request-rc4",className:"text-gray-300 text-sm",children:"Request RC4 encryption (easier to crack)"})]})]})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${F?"bg-purple-500/10 border-purple-500/30":"bg-orange-500/10 border-orange-500/30"}`,children:[e.jsxs("h4",{className:`font-medium mb-2 flex items-center gap-2 ${F?"text-purple-400":"text-orange-400"}`,children:[e.jsx(de,{className:"h-4 w-4"}),"Attack Summary"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Domain Controller:"}),e.jsx("span",{className:"text-white ml-2",children:s.domain_controller||"Not set"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Domain:"}),e.jsx("span",{className:"text-white ml-2",children:s.domain||"Not set"})]}),F&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Authentication:"}),e.jsxs("span",{className:"text-white ml-2",children:[s.username," (",s.use_hash?"NTLM Hash":"Password",")"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"SPNs:"}),e.jsx("span",{className:"text-white ml-2",children:s.enumerate_spns?"Auto-enumerate":`${s.target_spns.filter(n=>n.trim()).length} specified`})]})]}),!F&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Users:"}),e.jsx("span",{className:"text-white ml-2",children:s.enumerate_users?"Auto-enumerate":`${s.usernames.filter(n=>n.trim()).length} specified`})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Output Format:"}),e.jsx("span",{className:"text-white ml-2 capitalize",children:s.output_format})]})]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",id:"authorized",checked:k,onChange:n=>R(n.target.checked),className:"w-4 h-4 mt-1 rounded border-yellow-500 bg-dark-bg text-yellow-500"}),e.jsxs("label",{htmlFor:"authorized",className:"text-sm",children:[e.jsx("span",{className:"text-yellow-400 font-medium",children:"Authorization Required"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"I am authorized to perform this Active Directory security test. Extracted hashes will be used for authorized security assessment only."})]})]})})]})]}),e.jsxs("div",{className:"p-4 border-t border-dark-border flex justify-between",children:[e.jsx($,{variant:"secondary",onClick:()=>x>1?v(x-1):y(),children:x>1?"Back":"Cancel"}),e.jsx($,{variant:"primary",onClick:()=>{x<3?v(x+1):r.mutate()},disabled:x===1&&(!u||c.length===0)||x===2&&(!s.domain_controller||!s.domain)||x===2&&F&&(!s.username||!s.password&&!s.ntlm_hash)||x===3&&!k||r.isPending,children:x<3?"Next":r.isPending?"Creating...":"Start Attack"})]})]})})},Ie={credential_dump:{title:"Credential Dump",icon:e.jsx(je,{className:"h-6 w-6 text-red-400"}),description:"Extract credentials from memory, registry, or files on the target system.",modules:[{value:"dump_sam",label:"SAM Database",description:"Extract local account hashes from SAM"},{value:"dump_lsass",label:"LSASS Memory",description:"Dump credentials from LSASS process"},{value:"browser_creds",label:"Browser Credentials",description:"Extract saved passwords from browsers"},{value:"wifi_passwords",label:"WiFi Passwords",description:"Extract saved WiFi passwords"},{value:"keepass",label:"KeePass Databases",description:"Find and extract KeePass databases"}]},priv_esc:{title:"Privilege Escalation",icon:e.jsx(fe,{className:"h-6 w-6 text-yellow-400"}),description:"Check for privilege escalation vectors on the target system.",modules:[{value:"always_install_elevated",label:"AlwaysInstallElevated",description:"Check for AlwaysInstallElevated policy"},{value:"unquoted_paths",label:"Unquoted Service Paths",description:"Find unquoted service paths"},{value:"weak_service_perms",label:"Weak Service Permissions",description:"Check for modifiable services"},{value:"se_impersonate",label:"SeImpersonate",description:"Check for token impersonation privileges"},{value:"sudoers",label:"Sudoers Check",description:"Analyze sudo configuration (Linux)"},{value:"suid_binaries",label:"SUID Binaries",description:"Find SUID/SGID binaries (Linux)"}]},persistence:{title:"Persistence",icon:e.jsx(Ne,{className:"h-6 w-6 text-purple-400"}),description:"Establish persistent access mechanisms on the target system.",modules:[{value:"scheduled_task",label:"Scheduled Task",description:"Create a scheduled task for persistence"},{value:"registry_run",label:"Registry Run Key",description:"Add registry run key for startup"},{value:"service",label:"Windows Service",description:"Create a Windows service"},{value:"cron_job",label:"Cron Job",description:"Add cron job for persistence (Linux)"},{value:"ssh_key",label:"SSH Key",description:"Add SSH authorized key (Linux)"}]},lateral_movement:{title:"Lateral Movement",icon:e.jsx(ve,{className:"h-6 w-6 text-blue-400"}),description:"Move to other systems using various techniques.",modules:[{value:"pass_the_hash",label:"Pass-the-Hash",description:"Authenticate using NTLM hash"},{value:"pass_the_ticket",label:"Pass-the-Ticket",description:"Authenticate using Kerberos ticket"},{value:"psexec",label:"PsExec",description:"Execute commands via PsExec"},{value:"wmi_exec",label:"WMI Exec",description:"Execute commands via WMI"},{value:"ssh_pivot",label:"SSH Pivot",description:"Pivot through SSH connections"}]},smb_relay:{title:"SMB Relay",icon:e.jsx(be,{className:"h-6 w-6 text-orange-400"}),description:"Relay NTLM authentication to other targets for credential theft or command execution.",modules:[{value:"ntlm_relay",label:"NTLM Relay",description:"Relay NTLM auth to target SMB"},{value:"ldap_relay",label:"LDAP Relay",description:"Relay to LDAP for account takeover"},{value:"http_relay",label:"HTTP Relay",description:"Relay to HTTP endpoints"}]}},Qe=({isOpen:p,onClose:y,onSuccess:f,onCampaignCreated:S,attackType:m})=>{var w;const i=ae(),[x,v]=b.useState(!1),k=Ie[m],[R,u]=b.useState(""),[h,c]=b.useState([]),[P,j]=b.useState(""),[t,s]=b.useState({name:"",target:"",module:((w=k.modules[0])==null?void 0:w.value)||"",username:"",password:"",ntlm_hash:"",use_hash:!1,options:{}}),g=b.useCallback(d=>{d.length>0&&s(L=>({...L,target:d[0]}))},[]),r=Q({mutationFn:async()=>(await E.createCampaign({name:t.name||`${k.title} - ${new Date().toLocaleString()}`,attack_type:m,config:{module:t.module,username:t.username||null,password:t.use_hash?null:t.password,ntlm_hash:t.use_hash?t.ntlm_hash:null,options:t.options},targets:[t.target],customer_id:R,asset_ids:h,engagement_id:P||void 0})).data,onSuccess:async d=>{if(x)try{await E.startCampaign(d.id,!0),T.success(`${k.title} campaign started!`)}catch{T.success("Campaign created. Start manually to begin.")}else T.success("Campaign created.");i.invalidateQueries({queryKey:["exploitation-campaigns"]}),i.invalidateQueries({queryKey:["exploitation-status"]}),f==null||f(),S==null||S(d.id),y()},onError:d=>{var L,O;T.error(((O=(L=d.response)==null?void 0:L.data)==null?void 0:O.error)||"Failed to create campaign")}});if(!p)return null;const A=k.modules.find(d=>d.value===t.module);return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-dark-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[k.icon,e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:k.title}),e.jsx("p",{className:"text-gray-400 text-sm",children:k.description})]})]}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-white p-2 rounded-lg hover:bg-dark-bg",children:e.jsx(J,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Campaign Name (optional)"}),e.jsx("input",{type:"text",value:t.name,onChange:d=>s({...t,name:d.target.value}),placeholder:`${k.title} - ${new Date().toLocaleDateString()}`,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary"})]}),e.jsx(oe,{customerId:R,assetIds:h,engagementId:P,onCustomerChange:u,onAssetChange:c,onEngagementChange:j,onTargetsFromAssets:g}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Target ",e.jsx("span",{className:"text-red-400",children:"*"}),e.jsx("span",{className:"text-gray-500 text-xs ml-2",children:"(Auto-populated from selected asset)"})]}),e.jsx("input",{type:"text",value:t.target,onChange:d=>s({...t,target:d.target.value}),placeholder:"192.168.1.100 or hostname",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Module"}),e.jsx("select",{value:t.module,onChange:d=>s({...t,module:d.target.value}),className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-primary",children:k.modules.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))}),A&&e.jsxs("p",{className:"mt-2 text-sm text-gray-400 flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),A.description]})]}),(m==="lateral_movement"||m==="smb_relay")&&e.jsxs("div",{className:"space-y-4 p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h4",{className:"text-white font-medium flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),"Credentials"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Username"}),e.jsx("input",{type:"text",value:t.username,onChange:d=>s({...t,username:d.target.value}),placeholder:"DOMAIN\\\\username or username@domain",className:"w-full px-4 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:!t.use_hash,onChange:()=>s({...t,use_hash:!1}),className:"text-primary"}),e.jsx("span",{className:"text-gray-300",children:"Password"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:t.use_hash,onChange:()=>s({...t,use_hash:!0}),className:"text-primary"}),e.jsx("span",{className:"text-gray-300",children:"NTLM Hash"})]})]}),t.use_hash?e.jsx("input",{type:"text",value:t.ntlm_hash,onChange:d=>s({...t,ntlm_hash:d.target.value}),placeholder:"aad3b435b51404eeaad3b435b51404ee:hash",className:"w-full px-4 py-2 bg-dark-surface border border-dark-border rounded-lg text-white font-mono"}):e.jsx("input",{type:"password",value:t.password,onChange:d=>s({...t,password:d.target.value}),placeholder:"Password",className:"w-full px-4 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:[e.jsx(X,{className:"h-5 w-5 text-red-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400 font-medium",children:"Authorization Required"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"This action may modify system configuration, access sensitive data, or execute commands on target systems. Ensure you have explicit written authorization before proceeding."})]})]}),e.jsxs("label",{className:"flex items-start gap-3 p-4 bg-dark-bg border border-dark-border rounded-lg cursor-pointer hover:border-primary transition-colors",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:d=>v(d.target.checked),className:"mt-1 h-4 w-4 text-primary rounded border-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"I am authorized to perform this test"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"I confirm that I have written authorization from the system owner to perform post-exploitation activities on the specified target(s). I understand that unauthorized access is illegal."})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-dark-border flex justify-end gap-3",children:[e.jsx($,{variant:"secondary",onClick:y,children:"Cancel"}),e.jsx($,{variant:"primary",onClick:()=>r.mutate(),disabled:!R||h.length===0||!t.target||!x||r.isPending,children:r.isPending?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[k.icon,e.jsx("span",{className:"ml-2",children:"Create & Start Campaign"})]})})]})]})})};function Ge({campaignId:p,enabled:y=!0,onProgress:f,onComplete:S,onError:m}){const i=b.useRef(null),[x,v]=b.useState(!1),[k,R]=b.useState([]),[u,h]=b.useState(null),c=b.useRef(0),P=3,j=b.useCallback(()=>{if(!y||!p)return;const g=localStorage.getItem("token");if(!g){m==null||m("No authentication token");return}i.current&&i.current.close();const A=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/api/ws/exploitation/${p}?token=${g}`;console.log("[ExploitationWS] Connecting to:",A),i.current=new WebSocket(A),i.current.onopen=()=>{console.log("[ExploitationWS] Connected to campaign:",p),v(!0),c.current=0},i.current.onmessage=w=>{try{const d=JSON.parse(w.data);console.log("[ExploitationWS] Received:",d.type,d),h(d),R(L=>[...L,d]),f==null||f(d),(d.type==="campaignCompleted"||d.type==="campaign_completed")&&(S==null||S(d)),d.type==="error"&&(m==null||m(d.message||"Unknown error"))}catch(d){console.error("[ExploitationWS] Failed to parse message:",d)}},i.current.onclose=w=>{console.log("[ExploitationWS] Connection closed:",w.code,w.reason),v(!1),w.code!==1e3&&c.current<P&&(c.current++,console.log(`[ExploitationWS] Reconnecting... attempt ${c.current}`),setTimeout(j,2e3*c.current))},i.current.onerror=w=>{console.error("[ExploitationWS] Error:",w),m==null||m("WebSocket connection error")}},[p,y,f,S,m]),t=b.useCallback(()=>{i.current&&(i.current.close(1e3,"User disconnected"),i.current=null),v(!1)},[]),s=b.useCallback(()=>{R([]),h(null)},[]);return b.useEffect(()=>(y&&p&&j(),()=>{t()}),[p,y,j,t]),{connected:x,progress:k,lastMessage:u,connect:j,disconnect:t,clearProgress:s}}const ls=()=>{const{tab:p}=Ce(),y=Se(),f=ae(),{hasEngagement:S}=Ke(),[m,i]=b.useState("dashboard"),[x,v]=b.useState(!1),[k,R]=b.useState(!1),[u,h]=b.useState(null),[c,P]=b.useState(null);b.useEffect(()=>{if(!p){i("dashboard");return}switch(p){case"password-spray":h({id:"password_spray",name:"Password Spray",description:"Test common passwords against multiple accounts",category:"credential",icon:e.jsx(D,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium"});break;case"kerberos":h({id:"kerberoast",name:"Kerberoasting",description:"Extract TGS tickets for offline cracking",category:"credential",icon:e.jsx(z,{className:"h-6 w-6"}),difficulty:"medium",risk:"low"});break;case"asrep-roast":h({id:"asrep_roast",name:"AS-REP Roasting",description:"Target accounts without Kerberos pre-authentication",category:"credential",icon:e.jsx(D,{className:"h-6 w-6"}),difficulty:"medium",risk:"low"});break;case"smb-relay":h({id:"smb_relay",name:"SMB Relay",description:"Relay NTLM authentication to other targets",category:"credential",icon:e.jsx(z,{className:"h-6 w-6"}),difficulty:"hard",risk:"high"});break;case"shells":i("shells");break;case"credential-dump":h({id:"credential_dump",name:"Credential Dump",description:"Extract credentials from memory, registry, or files",category:"post-exploit",icon:e.jsx(H,{className:"h-6 w-6"}),difficulty:"medium",risk:"high"});break;case"priv-esc":h({id:"priv_esc",name:"Privilege Escalation",description:"Check for privilege escalation vectors",category:"post-exploit",icon:e.jsx(H,{className:"h-6 w-6"}),difficulty:"medium",risk:"medium"});break;case"persistence":h({id:"persistence",name:"Persistence",description:"Establish persistent access mechanisms",category:"post-exploit",icon:e.jsx(H,{className:"h-6 w-6"}),difficulty:"hard",risk:"high"});break;case"lateral-movement":h({id:"lateral_movement",name:"Lateral Movement",description:"Move to other systems using Pass-the-Hash, WMI, PsExec",category:"post-exploit",icon:e.jsx(H,{className:"h-6 w-6"}),difficulty:"hard",risk:"high"});break;case"post-exploit":i("modules");break;case"campaigns":i("campaigns");break;default:i("dashboard")}},[p]);const[j,t]=b.useState({shell_type:"reverse_shell",platform:"linux",format:"bash",lhost:"",lport:4444,encoding:"none",obfuscation_level:0,staged:!1}),[s,g]=b.useState(null),{data:r}=U({queryKey:["exploitation-status"],queryFn:async()=>(await E.getStatus()).data}),{data:A=[]}=U({queryKey:["exploitation-campaigns"],queryFn:async()=>(await E.listCampaigns()).data}),{data:w=[]}=U({queryKey:["shell-templates"],queryFn:async()=>(await E.listShellTemplates()).data}),{data:d=[]}=U({queryKey:["post-exploit-modules"],queryFn:async()=>(await E.listModules()).data}),L=Q({mutationFn:async a=>(await E.generateShell(a)).data,onSuccess:a=>{g(a),T.success("Shell payload generated!"),f.invalidateQueries({queryKey:["exploitation-status"]})},onError:a=>{var q,M;T.error(((M=(q=a.response)==null?void 0:q.data)==null?void 0:M.message)||"Failed to generate shell")}}),O=Q({mutationFn:async a=>{await E.deleteCampaign(a)},onSuccess:()=>{T.success("Campaign deleted"),f.invalidateQueries({queryKey:["exploitation-campaigns"]})}}),se=Q({mutationFn:async({id:a,authorized:q})=>{await E.startCampaign(a,q)},onSuccess:()=>{T.success("Campaign started"),f.invalidateQueries({queryKey:["exploitation-campaigns"]}),f.invalidateQueries({queryKey:["exploitation-status"]})},onError:a=>{var q,M;T.error(((M=(q=a.response)==null?void 0:q.data)==null?void 0:M.message)||"Failed to start campaign")}}),V=Q({mutationFn:async a=>{await E.stopCampaign(a)},onSuccess:()=>{T.success("Campaign stopped"),f.invalidateQueries({queryKey:["exploitation-campaigns"]}),f.invalidateQueries({queryKey:["exploitation-status"]})}}),F=a=>{if(R(!1),["reverse_shell","bind_shell","web_shell","meterpreter"].includes(a.id)){const q={reverse_shell:"reverse_shell",bind_shell:"bind_shell",web_shell:"web_shell",meterpreter:"reverse_shell"},M={reverse_shell:"bash",bind_shell:"bash",web_shell:"php",meterpreter:"meterpreter_exe"};t({...j,shell_type:q[a.id]||"reverse_shell",format:M[a.id]||"bash"}),v(!0);return}h(a)},W=a=>{h(null),f.invalidateQueries({queryKey:["exploitation-campaigns"]}),f.invalidateQueries({queryKey:["exploitation-status"]}),i("campaigns"),y("/exploitation/campaigns"),T.success("Campaign created successfully!")},B=()=>{h(null),y("/exploitation")},n=a=>{navigator.clipboard.writeText(a),T.success("Copied to clipboard!")},N=a=>{switch(a){case"running":return"text-yellow-400";case"completed":return"text-green-400";case"failed":return"text-red-400";case"cancelled":return"text-gray-400";default:return"text-blue-400"}},_=a=>{switch(a){case"running":return e.jsx(Y,{className:"h-4 w-4 animate-pulse"});case"completed":return e.jsx(G,{className:"h-4 w-4"});case"failed":return e.jsx(X,{className:"h-4 w-4"});case"cancelled":return e.jsx(ue,{className:"h-4 w-4"});default:return e.jsx(Le,{className:"h-4 w-4"})}};return e.jsx($e,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(re,{className:"h-7 w-7 text-red-500"}),"Exploitation Framework"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Password spraying, Kerberos attacks, shell generation, and post-exploitation"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs($,{variant:"secondary",onClick:()=>v(!0),disabled:!S,children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Generate Shell"]}),e.jsxs($,{variant:"primary",onClick:()=>R(!0),disabled:!S,children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"New Campaign"]})]})]}),e.jsx(De,{toolName:"Exploitation Framework"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Active Campaigns"}),e.jsx(Y,{className:"h-5 w-5 text-yellow-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(r==null?void 0:r.active_campaigns)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Total Campaigns"}),e.jsx(re,{className:"h-5 w-5 text-blue-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(r==null?void 0:r.total_campaigns)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Credentials Found"}),e.jsx(D,{className:"h-5 w-5 text-green-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(r==null?void 0:r.credentials_stored)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Payloads Generated"}),e.jsx(I,{className:"h-5 w-5 text-purple-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(r==null?void 0:r.payloads_generated)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Msfvenom"}),r!=null&&r.msfvenom_available?e.jsx(G,{className:"h-5 w-5 text-green-400"}):e.jsx(X,{className:"h-5 w-5 text-yellow-400"})]}),e.jsx("p",{className:"text-sm font-medium text-white mt-2",children:r!=null&&r.msfvenom_available?"Available":"Not Found"})]})]}),e.jsx("div",{className:"border-b border-dark-border",children:e.jsx("nav",{className:"flex gap-4",children:["dashboard","campaigns","shells","modules"].map(a=>e.jsx("button",{onClick:()=>i(a),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${m===a?"border-primary text-primary":"border-transparent text-gray-400 hover:text-white"}`,children:a.charAt(0).toUpperCase()+a.slice(1)},a))})}),m==="dashboard"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Recent Campaigns"}),A.length===0?e.jsx("p",{className:"text-gray-400 text-sm",children:"No campaigns yet"}):e.jsx("div",{className:"space-y-3",children:A.slice(0,5).map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-bg rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:a.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:a.attack_type})]}),e.jsxs("div",{className:`flex items-center gap-2 ${N(a.status)}`,children:[_(a.status),e.jsx("span",{className:"text-sm capitalize",children:a.status})]})]},a.id))})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>h({id:"password_spray",name:"Password Spray",description:"Test common passwords against multiple accounts",category:"credential",icon:e.jsx(D,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium"}),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(D,{className:"h-6 w-6 text-blue-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Password Spray"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Credential testing"})]}),e.jsxs("button",{onClick:()=>h({id:"kerberoast",name:"Kerberoasting",description:"Extract TGS tickets for offline cracking",category:"credential",icon:e.jsx(z,{className:"h-6 w-6"}),difficulty:"medium",risk:"low"}),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(z,{className:"h-6 w-6 text-purple-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Kerberoast"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Extract TGS tickets"})]}),e.jsxs("button",{onClick:()=>v(!0),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(I,{className:"h-6 w-6 text-green-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Shell Generator"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Create payloads"})]}),e.jsxs("button",{onClick:()=>i("modules"),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(H,{className:"h-6 w-6 text-red-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Post-Exploit"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Modules & tools"})]})]})]})]}),m==="campaigns"&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg",children:[e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Campaigns"})}),A.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(re,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No campaigns yet"}),e.jsx($,{variant:"primary",className:"mt-4",onClick:()=>R(!0),children:"Create First Campaign"})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-400 text-sm border-b border-dark-border",children:[e.jsx("th",{className:"p-4",children:"Name"}),e.jsx("th",{className:"p-4",children:"Type"}),e.jsx("th",{className:"p-4",children:"Status"}),e.jsx("th",{className:"p-4",children:"Targets"}),e.jsx("th",{className:"p-4",children:"Results"}),e.jsx("th",{className:"p-4",children:"Created"}),e.jsx("th",{className:"p-4",children:"Actions"})]})}),e.jsx("tbody",{children:A.map(a=>e.jsxs("tr",{className:"border-b border-dark-border hover:bg-dark-bg",children:[e.jsx("td",{className:"p-4 text-white font-medium",children:a.name}),e.jsx("td",{className:"p-4 text-gray-300",children:a.attack_type}),e.jsx("td",{className:"p-4",children:e.jsxs("span",{className:`flex items-center gap-2 ${N(a.status)}`,children:[_(a.status),e.jsx("span",{className:"capitalize",children:a.status})]})}),e.jsx("td",{className:"p-4 text-gray-300",children:a.targets.length}),e.jsxs("td",{className:"p-4",children:[e.jsx("span",{className:"text-green-400",children:a.successful_count}),e.jsxs("span",{className:"text-gray-500",children:[" / ",a.results_count]})]}),e.jsx("td",{className:"p-4 text-gray-400 text-sm",children:new Date(a.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.status==="pending"&&e.jsx("button",{onClick:()=>se.mutate({id:a.id,authorized:!0}),className:"text-green-400 hover:text-green-300 p-2",title:"Start Campaign",children:e.jsx(we,{className:"h-4 w-4"})}),a.status==="running"&&e.jsx("button",{onClick:()=>V.mutate(a.id),className:"text-yellow-400 hover:text-yellow-300 p-2",title:"Stop Campaign",children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>P(a.id),className:"text-blue-400 hover:text-blue-300 p-2",title:"View Results",children:e.jsx(ce,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>O.mutate(a.id),className:"text-red-400 hover:text-red-300 p-2",title:"Delete Campaign",children:e.jsx(ee,{className:"h-4 w-4"})})]})})]},a.id))})]})]}),m==="shells"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Shell Templates"}),e.jsx("div",{className:"space-y-3",children:w.map((a,q)=>e.jsx("div",{className:"p-3 bg-dark-bg rounded-lg border border-dark-border hover:border-primary cursor-pointer transition-colors",onClick:()=>{t({...j,format:a.format.toLowerCase(),platform:a.platform.toLowerCase()}),v(!0)},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:a.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:a.description})]}),a.requires_msfvenom&&e.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-400 px-2 py-1 rounded",children:"msfvenom"})]})},q))})]}),s&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Generated Payload"}),e.jsx("button",{onClick:()=>g(null),className:"text-gray-400 hover:text-white",children:e.jsx(J,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Payload"}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-dark-bg p-3 rounded-lg text-green-400 text-sm overflow-x-auto max-h-48",children:s.payload}),e.jsx("button",{onClick:()=>n(s.payload),className:"absolute top-2 right-2 text-gray-400 hover:text-white",children:e.jsx(ne,{className:"h-4 w-4"})})]})]}),s.one_liner&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"One-Liner"}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-dark-bg p-3 rounded-lg text-blue-400 text-sm overflow-x-auto",children:s.one_liner}),e.jsx("button",{onClick:()=>n(s.one_liner),className:"absolute top-2 right-2 text-gray-400 hover:text-white",children:e.jsx(ne,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Listener Command"}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-dark-bg p-3 rounded-lg text-yellow-400 text-sm",children:s.listener_command}),e.jsx("button",{onClick:()=>n(s.listener_command),className:"absolute top-2 right-2 text-gray-400 hover:text-white",children:e.jsx(ne,{className:"h-4 w-4"})})]})]})]})]})]}),m==="modules"&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Post-Exploitation Modules"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map((a,q)=>{const l={credential_harvesting:"credential_dump",privilege_escalation:"priv_esc",persistence:"persistence",lateral_movement:"lateral_movement"}[a.category]||"credential_dump";return e.jsxs("div",{onClick:()=>h({id:l,name:a.name,description:a.description,category:"post-exploit",icon:e.jsx(H,{className:"h-6 w-6"}),difficulty:"medium",risk:"high"}),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary cursor-pointer transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:a.name}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:a.description})]})}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-1 rounded",children:a.category}),a.platforms.map(o=>e.jsx("span",{className:"text-xs bg-gray-500/20 text-gray-400 px-2 py-1 rounded",children:o},o))]})]},q)})})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5 text-green-400"}),"Shell Generator"]}),e.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-white",children:e.jsx(J,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Shell Type"}),e.jsxs("select",{value:j.shell_type,onChange:a=>t({...j,shell_type:a.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"reverse_shell",children:"Reverse Shell"}),e.jsx("option",{value:"bind_shell",children:"Bind Shell"}),e.jsx("option",{value:"web_shell",children:"Web Shell"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Platform"}),e.jsxs("select",{value:j.platform,onChange:a=>t({...j,platform:a.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"linux",children:"Linux"}),e.jsx("option",{value:"windows",children:"Windows"}),e.jsx("option",{value:"macos",children:"macOS"}),e.jsx("option",{value:"universal",children:"Universal"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Format"}),e.jsxs("select",{value:j.format,onChange:a=>t({...j,format:a.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"bash",children:"Bash"}),e.jsx("option",{value:"powershell",children:"PowerShell"}),e.jsx("option",{value:"python",children:"Python"}),e.jsx("option",{value:"perl",children:"Perl"}),e.jsx("option",{value:"php",children:"PHP"}),e.jsx("option",{value:"meterpreter_exe",children:"Meterpreter EXE"}),e.jsx("option",{value:"meterpreter_elf",children:"Meterpreter ELF"}),e.jsx("option",{value:"meterpreter_powershell",children:"Meterpreter PowerShell"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"LHOST"}),e.jsx("input",{type:"text",value:j.lhost,onChange:a=>t({...j,lhost:a.target.value}),placeholder:"192.168.1.100",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"LPORT"}),e.jsx("input",{type:"number",value:j.lport,onChange:a=>t({...j,lport:parseInt(a.target.value)||4444}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Encoding"}),e.jsxs("select",{value:j.encoding,onChange:a=>t({...j,encoding:a.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"none",children:"None"}),e.jsx("option",{value:"base64",children:"Base64"}),e.jsx("option",{value:"hex",children:"Hex"}),e.jsx("option",{value:"xor",children:"XOR"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Obfuscation"}),e.jsxs("select",{value:j.obfuscation_level,onChange:a=>t({...j,obfuscation_level:parseInt(a.target.value)}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:0,children:"None"}),e.jsx("option",{value:1,children:"Light"}),e.jsx("option",{value:2,children:"Medium"}),e.jsx("option",{value:3,children:"Heavy"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-dark-border",children:[e.jsx($,{variant:"secondary",onClick:()=>v(!1),children:"Cancel"}),e.jsxs($,{variant:"primary",onClick:()=>{L.mutate(j),v(!1)},disabled:!j.lhost||L.isPending,children:[L.isPending?e.jsx(ie,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(I,{className:"h-4 w-4 mr-2"}),"Generate"]})]})]})]})}),e.jsx(Oe,{isOpen:k,onClose:()=>R(!1),onSelect:F,msfvenomAvailable:(r==null?void 0:r.msfvenom_available)??!1}),(u==null?void 0:u.id)==="password_spray"&&e.jsx(Be,{isOpen:!0,onClose:B,onCampaignCreated:W}),((u==null?void 0:u.id)==="kerberoast"||(u==null?void 0:u.id)==="asrep_roast")&&e.jsx(He,{isOpen:!0,onClose:B,onCampaignCreated:W,attackType:u.id}),((u==null?void 0:u.id)==="credential_dump"||(u==null?void 0:u.id)==="priv_esc"||(u==null?void 0:u.id)==="persistence"||(u==null?void 0:u.id)==="lateral_movement"||(u==null?void 0:u.id)==="smb_relay")&&e.jsx(Qe,{isOpen:!0,onClose:B,onCampaignCreated:W,attackType:u.id}),c&&e.jsx(Je,{campaignId:c,onClose:()=>P(null)})]})})},Je=({campaignId:p,onClose:y})=>{const f=ae(),[S,m]=b.useState(!0),{data:i}=U({queryKey:["campaign-detail",p],queryFn:async()=>(await E.getCampaign(p)).data}),x=(i==null?void 0:i.status)==="running",{data:v=[],isLoading:k,refetch:R}=U({queryKey:["campaign-results",p],queryFn:async()=>(await E.getCampaignResults(p)).data,refetchInterval:x?5e3:!1}),{connected:u,progress:h,lastMessage:c}=Ge({campaignId:p,enabled:x,onComplete:()=>{R(),f.invalidateQueries({queryKey:["exploitation-campaigns"]}),f.invalidateQueries({queryKey:["exploitation-status"]}),T.success("Campaign completed!")},onError:s=>{T.error(`Campaign error: ${s}`)}}),P=async s=>{try{const g=await E.exportResults(p,s),r=new Blob([g.data],{type:s==="json"?"application/json":"text/csv"}),A=URL.createObjectURL(r),w=document.createElement("a");w.href=A,w.download=`campaign-${p}.${s}`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(A),T.success(`Results exported as ${s.toUpperCase()}`)}catch{T.error("Failed to export results")}},j=s=>{switch(s){case"campaignStarted":case"campaign_started":return e.jsx(we,{className:"h-4 w-4 text-blue-400"});case"targetStarted":case"target_started":return e.jsx(re,{className:"h-4 w-4 text-yellow-400"});case"attemptMade":case"attempt_made":return e.jsx(Y,{className:"h-4 w-4 text-gray-400"});case"credentialFound":case"credential_found":return e.jsx(G,{className:"h-4 w-4 text-green-400"});case"hashExtracted":case"hash_extracted":return e.jsx(D,{className:"h-4 w-4 text-purple-400"});case"campaignProgress":case"campaign_progress":return e.jsx(ie,{className:"h-4 w-4 text-blue-400 animate-spin"});case"campaignCompleted":case"campaign_completed":return e.jsx(G,{className:"h-4 w-4 text-green-400"});case"error":return e.jsx(X,{className:"h-4 w-4 text-red-400"});default:return e.jsx(Y,{className:"h-4 w-4 text-gray-400"})}},t=s=>{switch(s.type){case"campaignStarted":case"campaign_started":return`Campaign started with ${s.total_targets} target(s)`;case"targetStarted":case"target_started":return`Scanning target ${s.index}/${s.total}: ${s.target}`;case"attemptMade":case"attempt_made":return s.success?`SUCCESS: ${s.username} @ ${s.target}`:`Attempt: ${s.username} @ ${s.target}`;case"credentialFound":case"credential_found":return`Credential found: ${s.username} @ ${s.target} (${s.credential_type})`;case"hashExtracted":case"hash_extracted":return`Hash extracted: ${s.username} (${s.hash_type})`;case"campaignProgress":case"campaign_progress":return`${s.progress_percent}% - ${s.message}`;case"campaignCompleted":case"campaign_completed":return`Completed: ${s.successful}/${s.total_results} successful (${s.duration_ms}ms)`;case"error":return s.message||"Unknown error";default:return JSON.stringify(s)}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-4xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Campaign Results"}),x&&e.jsxs("span",{className:"flex items-center gap-2 text-sm text-yellow-400 bg-yellow-400/10 px-3 py-1 rounded-full",children:[e.jsx(Y,{className:"h-4 w-4 animate-pulse"}),"Running",u&&e.jsx("span",{className:"text-xs text-green-400",children:"(Live)"})]}),(i==null?void 0:i.status)==="completed"&&e.jsxs("span",{className:"flex items-center gap-2 text-sm text-green-400 bg-green-400/10 px-3 py-1 rounded-full",children:[e.jsx(G,{className:"h-4 w-4"}),"Completed"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs($,{variant:"secondary",onClick:()=>P("json"),children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"JSON"]}),e.jsxs($,{variant:"secondary",onClick:()=>P("csv"),children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"CSV"]}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-white",children:e.jsx(J,{className:"h-6 w-6"})})]})]}),x&&(c==null?void 0:c.progress_percent)!==void 0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[c.progress_percent,"%"]})]}),e.jsx("div",{className:"h-2 bg-dark-bg rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary transition-all duration-300",style:{width:`${c.progress_percent}%`}})})]})]}),e.jsxs("div",{className:"flex-1 overflow-hidden flex",children:[x&&S&&h.length>0&&e.jsxs("div",{className:"w-80 border-r border-dark-border overflow-y-auto p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-400",children:"Live Progress"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[h.length," events"]})]}),e.jsx("div",{className:"space-y-2",children:h.slice(-50).reverse().map((s,g)=>e.jsxs("div",{className:`p-2 rounded text-xs flex items-start gap-2 ${s.success===!0?"bg-green-500/10 border border-green-500/30":s.type==="error"?"bg-red-500/10 border border-red-500/30":"bg-dark-bg"}`,children:[j(s.type),e.jsx("span",{className:"text-gray-300 break-all",children:t(s)})]},g))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:k?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ie,{className:"h-8 w-8 text-primary animate-spin"})}):v.length===0&&!x?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ce,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No results yet"})]}):v.length===0&&x?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Y,{className:"h-12 w-12 text-yellow-400 mx-auto mb-4 animate-pulse"}),e.jsx("p",{className:"text-gray-400",children:"Waiting for results..."}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Results will appear as they are found"})]}):e.jsx("div",{className:"space-y-4",children:v.map(s=>{var g,r,A,w,d,L;return e.jsxs("div",{className:`p-4 rounded-lg border ${(g=s.result_type)!=null&&g.includes("success")||(r=s.result_type)!=null&&r.includes("found")||(A=s.result_type)!=null&&A.includes("extracted")?"bg-green-500/10 border-green-500/30":"bg-dark-bg border-dark-border"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[(w=s.result_type)!=null&&w.includes("success")||(d=s.result_type)!=null&&d.includes("found")||(L=s.result_type)!=null&&L.includes("extracted")?e.jsx(G,{className:"h-5 w-5 text-green-400"}):e.jsx(X,{className:"h-5 w-5 text-gray-400"}),e.jsx("span",{className:"text-white font-medium",children:s.target})]}),e.jsx("span",{className:"text-sm text-gray-400",children:new Date(s.created_at).toLocaleString()})]}),s.result_type&&e.jsx("span",{className:"inline-block text-xs bg-primary/20 text-primary px-2 py-1 rounded mb-2",children:s.result_type.replace(/_/g," ")}),s.severity&&e.jsx("span",{className:`inline-block text-xs px-2 py-1 rounded mb-2 ml-2 ${s.severity==="critical"?"bg-red-500/20 text-red-400":s.severity==="high"?"bg-orange-500/20 text-orange-400":"bg-gray-500/20 text-gray-400"}`,children:s.severity}),s.data&&e.jsx("pre",{className:"mt-2 p-3 bg-dark-bg rounded text-sm text-gray-300 overflow-x-auto",children:typeof s.data=="string"?s.data:JSON.stringify(s.data,null,2)})]},s.id)})})})]})]})})};export{ls as default};
