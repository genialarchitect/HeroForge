import{j as e}from"./vendor-state-BeiY7NuG.js";import{r as a}from"./vendor-react-B7quoyFx.js";import{d as me,C as S,L as U,I as J,B as y,a as W,b as G,e as te,t as ne,s as re,f as ze,n as z,g as De,h as Ve,u as Ge,i as de,m as oe,j as je,k as le,l as ee,c as Be}from"./index-xNNqxsLO.js";import{B as r,U as ye,S as Q,a8 as Se,an as ve,l as ie,a as ue,r as V,g as Ye,t as Le,v as Me,ao as We,ap as Qe,aq as Xe,P as ae,ar as Ze,n as se,T as Ce,ag as q,X as pe,F as es,al as ge,as as ss,at as ts,au as Ue,av as be,x as H,aw as as,ax as Ne,A as rs,ay as Z,Q as xe,N as Pe,d as we,M as _e,H as ls,R as ns,k as is,az as cs,y as ke,aA as Ie,I as ds,K as he,f as $e,z as Oe,a6 as Je,aB as Fe,aC as os,aD as Te}from"./vendor-ui-mM58YA-T.js";import"./vendor-charts-BdrvRaAD.js";const ms=()=>{var t;const[c,D]=a.useState(null),[L,u]=a.useState(!0),[N,w]=a.useState(!1),[f,P]=a.useState(!1),[d,k]=a.useState(""),[n,v]=a.useState(!1),[_,T]=a.useState(""),[p,C]=a.useState(""),[I,R]=a.useState("");a.useEffect(()=>{E()},[]);const E=async()=>{u(!0);try{const o=await me.me();D(o.data),k(o.data.email||"")}catch(o){r.error("Failed to load profile"),console.error(o)}finally{u(!1)}},i=async o=>{var F,j;if(o.preventDefault(),!d.trim()){r.error("Email is required");return}w(!0);try{const A=await me.updateProfile({email:d.trim()});D(A.data),r.success("Profile updated successfully")}catch(A){r.error(((j=(F=A.response)==null?void 0:F.data)==null?void 0:j.error)||"Failed to update profile")}finally{w(!1)}},h=async o=>{var F,j;if(o.preventDefault(),!_||!p){r.error("All password fields are required");return}if(p.length<6){r.error("New password must be at least 6 characters");return}if(p!==I){r.error("Passwords do not match");return}P(!0);try{await me.changePassword({current_password:_,new_password:p}),r.success("Password changed successfully"),v(!1),T(""),C(""),R("")}catch(A){r.error(((j=(F=A.response)==null?void 0:F.data)==null?void 0:j.error)||"Failed to change password")}finally{P(!1)}},l=o=>o?new Date(o).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"N/A";return L?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(U,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ye,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Profile Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(ye,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Username"}),e.jsx("p",{className:"text-white font-medium",children:c==null?void 0:c.username})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(Q,{className:"h-5 w-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Roles"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:((t=c==null?void 0:c.roles)==null?void 0:t.map(o=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-primary/20 text-primary rounded capitalize",children:o},o)))||e.jsx("span",{className:"text-slate-400",children:"No roles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(Se,{className:"h-5 w-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Member Since"}),e.jsx("p",{className:"text-white",children:l(c==null?void 0:c.created_at)})]})]})]}),e.jsx("form",{onSubmit:i,className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-2",children:[e.jsx(ve,{className:"h-4 w-4"}),"Email Address"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(J,{type:"email",value:d,onChange:o=>k(o.target.value),placeholder:"your@email.com",className:"flex-1"}),e.jsxs(y,{type:"submit",variant:"primary",loading:N,disabled:N||d===(c==null?void 0:c.email),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Save"]})]})]})})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"h-6 w-6 text-yellow-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Security"})]}),!n&&e.jsx(y,{variant:"secondary",onClick:()=>v(!0),children:"Change Password"})]}),n?e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsx(J,{label:"Current Password",type:"password",value:_,onChange:o=>T(o.target.value),placeholder:"Enter current password"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(J,{label:"New Password",type:"password",value:p,onChange:o=>C(o.target.value),placeholder:"Enter new password"}),e.jsx(J,{label:"Confirm New Password",type:"password",value:I,onChange:o=>R(o.target.value),placeholder:"Confirm new password"})]}),p&&I&&p!==I&&e.jsx("p",{className:"text-sm text-red-400",children:"Passwords do not match"}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(y,{type:"button",variant:"secondary",onClick:()=>{v(!1),T(""),C(""),R("")},children:"Cancel"}),e.jsx(y,{type:"submit",variant:"primary",loading:f,disabled:f||!_||!p||p!==I,children:"Update Password"})]})]}):e.jsx("p",{className:"text-slate-400",children:"Keep your account secure by using a strong, unique password."})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Q,{className:"h-6 w-6 text-green-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Account Status"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${(c==null?void 0:c.is_active)!==!1?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-white",children:(c==null?void 0:c.is_active)!==!1?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Your account is in good standing."})]})]})},xs=[{id:"admin",name:"Admin",description:"Full system access"},{id:"user",name:"User",description:"Standard user access"},{id:"auditor",name:"Auditor",description:"Read-only access to all scans"},{id:"viewer",name:"Viewer",description:"Limited view access"}],hs=()=>{const[c,D]=a.useState([]),[L,u]=a.useState([]),[N,w]=a.useState(!0),[f,P]=a.useState(!1),[d,k]=a.useState(new Set),[n,v]=a.useState(!1),[_,T]=a.useState(!0),[p,C]=a.useState(null),[I,R]=a.useState(!1);a.useEffect(()=>{E()},[]);const E=async()=>{var m;w(!0);try{const s=await W.getUsers();D(s.data),T(!0)}catch(s){((m=s.response)==null?void 0:m.status)===403?T(!1):r.error("Failed to load users"),console.error(s)}finally{w(!1)}},i=async()=>{P(!0);try{const m=await W.getAuditLogs(50);u(m.data)}catch(m){r.error("Failed to load audit logs"),console.error(m)}finally{P(!1)}},h=m=>{const s=new Set(d);s.has(m)?s.delete(m):s.add(m),k(s)},l=async m=>{var s,x;try{await W.updateUser(m.id,{is_active:!m.is_active}),r.success(`User ${m.is_active?"deactivated":"activated"}`),E()}catch(b){r.error(((x=(s=b.response)==null?void 0:s.data)==null?void 0:x.error)||"Failed to update user")}},t=async()=>{var m,s;if(p){R(!0);try{await W.deleteUser(p.id),r.success(`User "${p.username}" deleted successfully`),E(),C(null)}catch(x){r.error(((s=(m=x.response)==null?void 0:m.data)==null?void 0:s.error)||"Failed to delete user")}finally{R(!1)}}},o=async(m,s)=>{var x,b;try{await W.assignRole(m,s),r.success("Role assigned"),E()}catch(K){r.error(((b=(x=K.response)==null?void 0:x.data)==null?void 0:b.error)||"Failed to assign role")}},F=async(m,s)=>{var x,b;try{await W.removeRole(m,s),r.success("Role removed"),E()}catch(K){r.error(((b=(x=K.response)==null?void 0:x.data)==null?void 0:b.error)||"Failed to remove role")}},j=async m=>{var s,x;try{await W.unlockUser(m.id),r.success(`Account "${m.username}" unlocked`),E()}catch(b){r.error(((x=(s=b.response)==null?void 0:s.data)==null?void 0:x.error)||"Failed to unlock account")}},A=m=>new Date(m).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),g=m=>{switch(m){case"admin":return"bg-red-500/20 text-red-400 border-red-500/30";case"user":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"auditor":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"viewer":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return N?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(U,{})})}):_?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ye,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"User Management"})]}),e.jsxs(G,{variant:"status",type:"completed",children:[c.length," users"]})]}),e.jsx("div",{className:"space-y-3",children:c.map(m=>{const s=d.has(m.id),x=m.roles||[];return e.jsxs("div",{className:"bg-dark-bg rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>h(m.id),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"text-slate-400",children:s?e.jsx(Le,{className:"h-4 w-4"}):e.jsx(Me,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${m.is_active!==!1?"bg-green-400":"bg-red-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:m.username}),e.jsx("p",{className:"text-sm text-slate-400",children:m.email})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex gap-1",children:x.map(b=>e.jsx("span",{className:`px-2 py-0.5 text-xs rounded border capitalize ${g(b)}`,children:b},b))}),m.is_locked&&e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded border bg-red-500/20 text-red-400 border-red-500/30 flex items-center gap-1",children:[e.jsx(ue,{className:"h-3 w-3"}),"Locked"]}),e.jsx("span",{className:"text-xs text-slate-500",children:m.created_at?A(m.created_at):"N/A"})]})]}),s&&e.jsxs("div",{className:"border-t border-dark-border p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"Manage Roles"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:xs.map(b=>{const K=x.includes(b.id);return e.jsxs("button",{onClick:X=>{X.stopPropagation(),K?F(m.id,b.id):o(m.id,b.id)},className:`p-3 rounded-lg border text-left transition-colors ${K?"bg-primary/20 border-primary/50 text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-primary/30"}`,children:[e.jsx("p",{className:"font-medium text-sm capitalize",children:b.name}),e.jsx("p",{className:"text-xs opacity-75",children:b.description})]},b.id)})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-dark-border",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{variant:m.is_active!==!1?"secondary":"primary",size:"sm",onClick:b=>{b.stopPropagation(),l(m)},children:m.is_active!==!1?e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"h-4 w-4 mr-1"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(Qe,{className:"h-4 w-4 mr-1"}),"Activate"]})}),m.is_locked&&e.jsxs(y,{variant:"primary",size:"sm",onClick:b=>{b.stopPropagation(),j(m)},children:[e.jsx(Xe,{className:"h-4 w-4 mr-1"}),"Unlock Account"]})]}),e.jsxs(y,{variant:"secondary",size:"sm",onClick:b=>{b.stopPropagation(),C(m)},className:"text-red-400 hover:text-red-300 hover:bg-red-500/10","aria-label":`Delete user ${m.username}`,children:[e.jsx(ae,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})]},m.id)})})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ze,{className:"h-6 w-6 text-purple-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Audit Logs"})]}),e.jsx(y,{variant:"secondary",onClick:()=>{v(!n),!n&&L.length===0&&i()},children:n?"Hide Logs":"Show Logs"})]}),n&&e.jsx(e.Fragment,{children:f?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(U,{})}):L.length===0?e.jsx("p",{className:"text-slate-400 text-center py-8",children:"No audit logs found"}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:L.map(m=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-dark-bg rounded-lg text-sm",children:[e.jsx(se,{className:"h-4 w-4 text-slate-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium text-white",children:m.action}),m.target_type&&e.jsxs("span",{className:"text-slate-400",children:["on ",m.target_type]}),m.target_id&&e.jsx("span",{className:"text-xs text-slate-500 font-mono truncate max-w-32",children:m.target_id})]}),m.details&&e.jsx("p",{className:"text-xs text-slate-500 mt-1 truncate",children:m.details})]}),e.jsx("span",{className:"text-xs text-slate-500 whitespace-nowrap",children:A(m.created_at)})]},m.id))})}),!n&&e.jsx("p",{className:"text-slate-400",children:"View a log of administrative actions performed in the system."})]}),e.jsx(te,{isOpen:!!p,onClose:()=>C(null),onConfirm:t,title:"Delete User",message:`Are you sure you want to delete user "${p==null?void 0:p.username}"? All their data, including scans and settings, will be permanently removed.`,confirmLabel:"Delete User",variant:"danger",loading:I})]}):e.jsx(S,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(V,{className:"h-12 w-12 text-yellow-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-slate-400",children:"You don't have permission to access the administration panel."}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Contact an administrator if you need elevated access."})]})})},fe=["#ef4444","#f97316","#eab308","#22c55e","#14b8a6","#3b82f6","#8b5cf6","#ec4899","#6366f1","#64748b"],us=()=>{const[c,D]=a.useState([]),[L,u]=a.useState(!0),[N,w]=a.useState(!1),[f,P]=a.useState(null),[d,k]=a.useState({name:"",description:"",targets:"",color:fe[0]}),[n,v]=a.useState(null),[_,T]=a.useState(!1);a.useEffect(()=>{p()},[]);const p=async()=>{u(!0);try{const h=await ne.getAll();D(h.data)}catch(h){r.error("Failed to load target groups"),console.error(h)}finally{u(!1)}},C=()=>{k({name:"",description:"",targets:"",color:fe[0]}),P(null),w(!1)},I=h=>{const l=JSON.parse(h.targets||"[]");k({name:h.name,description:h.description||"",targets:l.join(`
`),color:h.color}),P(h.id),w(!0)},R=async h=>{var t,o;h.preventDefault();const l=d.targets.split(`
`).map(F=>F.trim()).filter(F=>F.length>0);if(!d.name.trim()){r.error("Name is required");return}if(l.length===0){r.error("At least one target is required");return}try{f?(await ne.update(f,{name:d.name,description:d.description||void 0,targets:l,color:d.color}),r.success("Target group updated")):(await ne.create({name:d.name,description:d.description||void 0,targets:l,color:d.color}),r.success("Target group created")),C(),p()}catch(F){r.error(((o=(t=F.response)==null?void 0:t.data)==null?void 0:o.error)||"Failed to save target group")}},E=async()=>{var h,l;if(n){T(!0);try{await ne.delete(n.id),r.success(`Target group "${n.name}" deleted`),p(),v(null)}catch(t){r.error(((l=(h=t.response)==null?void 0:h.data)==null?void 0:l.error)||"Failed to delete")}finally{T(!1)}}},i=h=>{try{return JSON.parse(h||"[]")}catch{return[]}};return L?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(U,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Target Groups"})]}),!N&&e.jsxs(y,{variant:"primary",onClick:()=>w(!0),children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"New Group"]})]})}),N&&e.jsx(S,{children:e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:f?"Edit Target Group":"Create Target Group"}),e.jsx("button",{type:"button",onClick:C,className:"text-slate-400 hover:text-white",children:e.jsx(pe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:d.name,onChange:h=>k({...d,name:h.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Production Servers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Color"}),e.jsx("div",{className:"flex gap-2",children:fe.map(h=>e.jsx("button",{type:"button",onClick:()=>k({...d,color:h}),className:`w-8 h-8 rounded-full border-2 transition-all ${d.color===h?"border-white scale-110":"border-transparent"}`,style:{backgroundColor:h}},h))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:d.description,onChange:h=>k({...d,description:h.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Targets (one per line)"}),e.jsx("textarea",{value:d.targets,onChange:h=>k({...d,targets:h.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:5,placeholder:`192.168.1.0/24
10.0.0.1
example.com`})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(y,{type:"button",variant:"secondary",onClick:C,children:"Cancel"}),e.jsxs(y,{type:"submit",variant:"primary",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),f?"Update":"Create"]})]})]})}),c.length===0&&!N?e.jsx(S,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(es,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No target groups yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create groups to organize your scan targets"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(h=>{const l=i(h.targets);return e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:h.color}}),e.jsx("h4",{className:"font-medium text-white",children:h.name})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>I(h),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>v(h),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete target group ${h.name}`,children:e.jsx(ae,{className:"h-4 w-4"})})]})]}),h.description&&e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:h.description}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:[l.length," target",l.length!==1?"s":""]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[l.slice(0,5).map((t,o)=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-300 font-mono",children:t},o)),l.length>5&&e.jsxs("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-500",children:["+",l.length-5," more"]})]})]})]},h.id)})}),e.jsx(te,{isOpen:!!n,onClose:()=>v(null),onConfirm:E,title:"Delete Target Group",message:`Are you sure you want to delete the target group "${n==null?void 0:n.name}"? Scheduled scans using this group will need to be updated.`,confirmLabel:"Delete Group",variant:"danger",loading:_})]})},Ee={name:"",description:"",schedule_type:"daily",schedule_value:"02:00",targets:"",port_range_start:1,port_range_end:1e3,threads:100,enable_os_detection:!0,enable_service_detection:!0,enable_vuln_scan:!0,enable_enumeration:!1},Re=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],ps=()=>{const[c,D]=a.useState([]),[L,u]=a.useState([]),[N,w]=a.useState(!0),[f,P]=a.useState(!1),[d,k]=a.useState(null),[n,v]=a.useState(Ee),[_,T]=a.useState(0),[p,C]=a.useState(1),[I,R]=a.useState(null),[E,i]=a.useState(!1);a.useEffect(()=>{h()},[]);const h=async()=>{w(!0);try{const[s,x]=await Promise.all([re.getAll(),ne.getAll()]);D(s.data),u(x.data)}catch(s){r.error("Failed to load scheduled scans"),console.error(s)}finally{w(!1)}},l=()=>{v(Ee),k(null),P(!1),T(0),C(1)},t=s=>{const x=JSON.parse(s.config);if(v({name:s.name,description:s.description||"",schedule_type:s.schedule_type,schedule_value:s.schedule_value,targets:x.targets.join(`
`),port_range_start:x.port_range[0],port_range_end:x.port_range[1],threads:x.threads,enable_os_detection:x.enable_os_detection,enable_service_detection:x.enable_service_detection,enable_vuln_scan:x.enable_vuln_scan,enable_enumeration:x.enable_enumeration}),s.schedule_type==="weekly"){const b=s.schedule_value.split(" ");b.length>=2&&T(parseInt(b[1])||0)}else if(s.schedule_type==="monthly"){const b=s.schedule_value.split(" ");b.length>=2&&C(parseInt(b[1])||1)}k(s.id),P(!0)},o=()=>{const s=n.schedule_value.includes(":")?n.schedule_value:"02:00";switch(n.schedule_type){case"daily":return s;case"weekly":return`${s} ${_}`;case"monthly":return`${s} ${p}`;default:return s}},F=async s=>{var X,ce;s.preventDefault();const x=n.targets.split(`
`).map(B=>B.trim()).filter(B=>B.length>0);if(!n.name.trim()){r.error("Name is required");return}if(x.length===0){r.error("At least one target is required");return}const b={targets:x,port_range:[n.port_range_start,n.port_range_end],threads:n.threads,enable_os_detection:n.enable_os_detection,enable_service_detection:n.enable_service_detection,enable_vuln_scan:n.enable_vuln_scan,enable_enumeration:n.enable_enumeration},K=o();try{d?(await re.update(d,{name:n.name,description:n.description||void 0,config:b,schedule_type:n.schedule_type,schedule_value:K}),r.success("Scheduled scan updated")):(await re.create({name:n.name,description:n.description||void 0,config:b,schedule_type:n.schedule_type,schedule_value:K}),r.success("Scheduled scan created")),l(),h()}catch(B){r.error(((ce=(X=B.response)==null?void 0:X.data)==null?void 0:ce.error)||"Failed to save scheduled scan")}},j=async s=>{var x,b;try{await re.update(s.id,{is_active:!s.is_active}),r.success(`Scheduled scan ${s.is_active?"paused":"activated"}`),h()}catch(K){r.error(((b=(x=K.response)==null?void 0:x.data)==null?void 0:b.error)||"Failed to update")}},A=async()=>{var s,x;if(I){i(!0);try{await re.delete(I.id),r.success(`Scheduled scan "${I.name}" deleted`),h(),R(null)}catch(b){r.error(((x=(s=b.response)==null?void 0:s.data)==null?void 0:x.error)||"Failed to delete")}finally{i(!1)}}},g=s=>{const x=JSON.parse(s.targets||"[]");v(b=>({...b,targets:x.join(`
`)}))},m=s=>{const x=s.schedule_value.split(" "),b=x[0];switch(s.schedule_type){case"daily":return`Daily at ${b}`;case"weekly":return`Every ${Re[parseInt(x[1])||0]} at ${b}`;case"monthly":return`Monthly on day ${x[1]||1} at ${b}`;default:return s.schedule_value}};return N?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(U,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scheduled Scans"})]}),!f&&e.jsxs(y,{variant:"primary",onClick:()=>P(!0),children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"New Schedule"]})]})}),f&&e.jsx(S,{children:e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:d?"Edit Scheduled Scan":"Create Scheduled Scan"}),e.jsx("button",{type:"button",onClick:l,className:"text-slate-400 hover:text-white",children:e.jsx(pe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:n.name,onChange:s=>v({...n,name:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Daily Network Scan"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:n.description,onChange:s=>v({...n,description:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"})," Schedule"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Frequency"}),e.jsxs("select",{value:n.schedule_type,onChange:s=>v({...n,schedule_type:s.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),n.schedule_type==="weekly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Week"}),e.jsx("select",{value:_,onChange:s=>T(parseInt(s.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Re.map((s,x)=>e.jsx("option",{value:x,children:s},s))})]}),n.schedule_type==="monthly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Month"}),e.jsx("select",{value:p,onChange:s=>C(parseInt(s.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Array.from({length:28},(s,x)=>x+1).map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Time (UTC)"}),e.jsx("input",{type:"time",value:n.schedule_value.split(" ")[0],onChange:s=>v({...n,schedule_value:s.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Targets (one per line)"}),L.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Use group:"}),L.slice(0,3).map(s=>e.jsx("button",{type:"button",onClick:()=>g(s),className:"px-2 py-0.5 text-xs rounded border border-dark-border text-slate-400 hover:text-white hover:border-primary",style:{borderLeftColor:s.color,borderLeftWidth:3},children:s.name},s.id))]})]}),e.jsx("textarea",{value:n.targets,onChange:s=>v({...n,targets:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:4,placeholder:`192.168.1.0/24
10.0.0.1`})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port Start"}),e.jsx("input",{type:"number",value:n.port_range_start,onChange:s=>v({...n,port_range_start:parseInt(s.target.value)||1}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port End"}),e.jsx("input",{type:"number",value:n.port_range_end,onChange:s=>v({...n,port_range_end:parseInt(s.target.value)||1e3}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Threads"}),e.jsx("input",{type:"number",value:n.threads,onChange:s=>v({...n,threads:parseInt(s.target.value)||100}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:1e3})]})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:[{key:"enable_os_detection",label:"OS Detection"},{key:"enable_service_detection",label:"Service Detection"},{key:"enable_vuln_scan",label:"Vulnerability Scan"},{key:"enable_enumeration",label:"Enumeration"}].map(({key:s,label:x})=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n[s],onChange:b=>v({...n,[s]:b.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-slate-300",children:x})]},s))}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(y,{type:"button",variant:"secondary",onClick:l,children:"Cancel"}),e.jsxs(y,{type:"submit",variant:"primary",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),d?"Update":"Create"]})]})]})}),c.length===0&&!f?e.jsx(S,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(se,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scheduled scans"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create automated recurring scans"})]})}):e.jsx("div",{className:"space-y-3",children:c.map(s=>{const x=JSON.parse(s.config);return e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.is_active?"bg-green-500/20":"bg-slate-500/20"}`,children:e.jsx(se,{className:`h-5 w-5 ${s.is_active?"text-green-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-white",children:s.name}),e.jsx(G,{variant:"status",type:s.is_active?"completed":"pending",children:s.is_active?"Active":"Paused"})]}),e.jsx("p",{className:"text-sm text-slate-400",children:m(s)}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[x.targets.length," target",x.targets.length!==1?"s":""," | Ports ",x.port_range[0],"-",x.port_range[1]," |",s.run_count," runs",s.last_run_at&&e.jsxs(e.Fragment,{children:[" | Last run ",ze(new Date(s.last_run_at))," ago"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>j(s),className:`p-2 rounded transition-colors ${s.is_active?"text-yellow-400 hover:bg-yellow-500/20":"text-green-400 hover:bg-green-500/20"}`,title:s.is_active?"Pause":"Activate",children:s.is_active?e.jsx(ss,{className:"h-4 w-4"}):e.jsx(ts,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>t(s),className:"p-2 text-slate-400 hover:text-primary transition-colors",children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>R(s),className:"p-2 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete scheduled scan ${s.name}`,children:e.jsx(ae,{className:"h-4 w-4"})})]})]})},s.id)})}),e.jsx(te,{isOpen:!!I,onClose:()=>R(null),onConfirm:A,title:"Delete Scheduled Scan",message:`Are you sure you want to delete the scheduled scan "${I==null?void 0:I.name}"? Future automated scans will no longer run.`,confirmLabel:"Delete Schedule",variant:"warning",loading:E})]})},gs=()=>{const[c,D]=a.useState(null),[L,u]=a.useState(!0),[N,w]=a.useState(!1),[f,P]=a.useState(!1),[d,k]=a.useState(!1),[n,v]=a.useState(!1),[_,T]=a.useState(null),[p,C]=a.useState({email_on_scan_complete:!1,email_on_critical_vuln:!0,email_address:"",slack_webhook_url:"",teams_webhook_url:""});a.useEffect(()=>{I(),R()},[]);const I=async()=>{var t;u(!0);try{const o=await z.getSettings();D(o.data),C({email_on_scan_complete:o.data.email_on_scan_complete,email_on_critical_vuln:o.data.email_on_critical_vuln,email_address:o.data.email_address||"",slack_webhook_url:o.data.slack_webhook_url||"",teams_webhook_url:o.data.teams_webhook_url||""})}catch(o){((t=o.response)==null?void 0:t.status)!==404&&(r.error("Failed to load notification settings"),console.error(o))}finally{u(!1)}},R=async()=>{try{const t=await z.checkSmtpStatus();T(t.data.configured)}catch(t){console.error("Failed to check SMTP status:",t),T(!1)}},E=async t=>{var o,F;if(t.preventDefault(),(p.email_on_scan_complete||p.email_on_critical_vuln)&&!p.email_address){r.error("Email address is required when notifications are enabled");return}w(!0);try{const j=await z.updateSettings(p);D(j.data),r.success("Notification settings saved")}catch(j){r.error(((F=(o=j.response)==null?void 0:o.data)==null?void 0:F.error)||"Failed to save settings")}finally{w(!1)}},i=async()=>{var t,o;if(!p.slack_webhook_url){r.error("Please enter a Slack webhook URL first");return}P(!0);try{p.slack_webhook_url!==(c==null?void 0:c.slack_webhook_url)&&await z.updateSettings({slack_webhook_url:p.slack_webhook_url});const F=await z.testSlack();r.success(F.data.message)}catch(F){r.error(((o=(t=F.response)==null?void 0:t.data)==null?void 0:o.error)||"Failed to send test message")}finally{P(!1)}},h=async()=>{var t,o;if(!p.teams_webhook_url){r.error("Please enter a Teams webhook URL first");return}k(!0);try{p.teams_webhook_url!==(c==null?void 0:c.teams_webhook_url)&&await z.updateSettings({teams_webhook_url:p.teams_webhook_url});const F=await z.testTeams();r.success(F.data.message)}catch(F){r.error(((o=(t=F.response)==null?void 0:t.data)==null?void 0:o.error)||"Failed to send test message")}finally{k(!1)}},l=async()=>{var t,o;if(!p.email_address){r.error("Please enter an email address first");return}if(!_){r.error("SMTP is not configured on the server. Contact your administrator.");return}v(!0);try{p.email_address!==(c==null?void 0:c.email_address)&&await z.updateSettings({email_address:p.email_address});const F=await z.testEmail();r.success(F.data.message)}catch(F){r.error(((o=(t=F.response)==null?void 0:t.data)==null?void 0:o.error)||"Failed to send test email")}finally{v(!1)}};return L?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(U,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Ue,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Notification Settings"})]}),e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Notification Email Address"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"email",value:p.email_address,onChange:t=>C({...p,email_address:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"your@email.com"})]}),e.jsx(y,{type:"button",variant:"secondary",onClick:l,disabled:!p.email_address||n||!_,title:_?"Send test email":"SMTP not configured on server",children:n?e.jsxs(e.Fragment,{children:[e.jsx(U,{}),e.jsx("span",{className:"ml-2",children:"Sending..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Email address where notifications will be sent"}),_!==null&&e.jsx("span",{className:`text-xs flex items-center gap-1 ${_?"text-green-400":"text-amber-400"}`,children:_?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-3 w-3"}),"SMTP configured"]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"h-3 w-3"}),"SMTP not configured"]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Email Notifications"}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:p.email_on_scan_complete,onChange:t=>C({...p,email_on_scan_complete:t.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"font-medium text-white",children:"Scan Completion"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Receive an email when any of your scans complete, including a summary of findings"})]})]}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:p.email_on_critical_vuln,onChange:t=>C({...p,email_on_critical_vuln:t.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"font-medium text-white",children:"Critical Vulnerabilities"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Get immediate alerts when critical or high severity vulnerabilities are discovered"})]})]})]}),_===!1?e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(V,{className:"h-5 w-5 text-amber-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-200",children:"SMTP is not configured on this server. Email notifications are disabled."}),e.jsx("p",{className:"text-xs text-amber-300/70 mt-1",children:"Contact your administrator to configure SMTP settings (SMTP_HOST, SMTP_USER, etc.)"})]})]})}):e.jsx("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ve,{className:"h-5 w-5 text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-200",children:_?"Email notifications are ready. Use the Test button to verify delivery.":"Checking SMTP configuration..."}),e.jsx("p",{className:"text-xs text-blue-300/70 mt-1",children:"Contact your administrator if you're not receiving emails."})]})]})}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-dark-border",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(as,{className:"h-4 w-4"}),"Webhook Integrations"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Slack Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:p.slack_webhook_url,onChange:t=>C({...p,slack_webhook_url:t.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://hooks.slack.com/services/YOUR/WEBHOOK/URL"}),e.jsx(y,{type:"button",variant:"secondary",onClick:i,disabled:!p.slack_webhook_url||f,children:f?e.jsxs(e.Fragment,{children:[e.jsx(U,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Send scan notifications to a Slack channel. Create a webhook at"," ",e.jsx("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Slack Incoming Webhooks"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Microsoft Teams Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:p.teams_webhook_url,onChange:t=>C({...p,teams_webhook_url:t.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://outlook.office.com/webhook/YOUR/WEBHOOK/URL"}),e.jsx(y,{type:"button",variant:"secondary",onClick:h,disabled:!p.teams_webhook_url||d,children:d?e.jsxs(e.Fragment,{children:[e.jsx(U,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Send scan notifications to a Teams channel. Create a webhook in your Teams channel connectors."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(y,{type:"submit",variant:"primary",disabled:N,children:N?e.jsxs(e.Fragment,{children:[e.jsx(U,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Save Settings"]})})})]})]}),c&&e.jsxs(S,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"Current Status"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Scan Complete Emails:"}),e.jsx("span",{className:`ml-2 ${c.email_on_scan_complete?"text-green-400":"text-slate-400"}`,children:c.email_on_scan_complete?"Enabled":"Disabled"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Critical Vuln Alerts:"}),e.jsx("span",{className:`ml-2 ${c.email_on_critical_vuln?"text-green-400":"text-slate-400"}`,children:c.email_on_critical_vuln?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-slate-500",children:"Last Updated:"}),e.jsx("span",{className:"ml-2 text-slate-300",children:new Date(c.updated_at).toLocaleString()})]})]})]})]})},js=()=>{const[c,D]=a.useState([]),[L,u]=a.useState(!0),[N,w]=a.useState(""),[f,P]=a.useState(""),[d,k]=a.useState(!1),[n,v]=a.useState(null),[_,T]=a.useState(new Set);a.useEffect(()=>{p()},[]);const p=async()=>{u(!0);try{const h=(await De.getAll()).data.filter(l=>l.status==="completed");D(h)}catch(i){r.error("Failed to load scans"),console.error(i)}finally{u(!1)}},C=async()=>{var i,h;if(!N||!f){r.error("Please select two scans to compare");return}if(N===f){r.error("Please select two different scans");return}k(!0);try{const l=await Ve.compare(N,f);v(l.data),r.success("Comparison completed")}catch(l){r.error(((h=(i=l.response)==null?void 0:i.data)==null?void 0:h.error)||"Failed to compare scans"),console.error(l)}finally{k(!1)}},I=i=>{const h=new Set(_);h.has(i)?h.delete(i):h.add(i),T(h)},R=i=>{switch(i){case"NewService":return e.jsx(q,{className:"h-3 w-3 text-green-400"});case"ServiceRemoved":return e.jsx(Z,{className:"h-3 w-3 text-red-400"});case"ServiceChanged":case"VersionChanged":return e.jsx(xe,{className:"h-3 w-3 text-yellow-400"});default:return null}},E=i=>{switch(i){case"NewService":return"New Service";case"ServiceRemoved":return"Service Removed";case"ServiceChanged":return"Service Changed";case"VersionChanged":return"Version Changed";default:return i}};return L?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(U,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ne,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Compare Scans"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"Select two completed scans to compare their results and identify changes in hosts, ports, services, and vulnerabilities."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Baseline Scan (Older)"}),e.jsxs("select",{value:N,onChange:i=>w(i.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a scan..."}),c.map(i=>e.jsxs("option",{value:i.id,children:[i.name," - ",new Date(i.created_at).toLocaleString()]},i.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Comparison Scan (Newer)"}),e.jsxs("select",{value:f,onChange:i=>P(i.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a scan..."}),c.map(i=>e.jsxs("option",{value:i.id,children:[i.name," - ",new Date(i.created_at).toLocaleString()]},i.id))]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(y,{variant:"primary",onClick:C,loading:d,disabled:!N||!f||N===f,children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Compare Scans"]})})]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(rs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Comparison Summary"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(q,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"New Hosts"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:n.diff.summary.total_new_hosts})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Z,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Removed"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:n.diff.summary.total_removed_hosts})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-yellow-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(xe,{className:"h-4 w-4 text-yellow-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Changed"})]}),e.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:n.diff.summary.total_hosts_changed})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Pe,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"New Ports"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:n.diff.summary.total_new_ports})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Pe,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Closed"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:n.diff.summary.total_closed_ports})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(V,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"New Vulns"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:n.diff.summary.total_new_vulnerabilities})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(H,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Resolved"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:n.diff.summary.total_resolved_vulnerabilities})]})]})]}),n.diff.new_hosts.length>0&&e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(q,{className:"h-5 w-5 text-green-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["New Hosts (",n.diff.new_hosts.length,")"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.diff.new_hosts.map(i=>e.jsx("span",{className:"px-3 py-1.5 bg-green-500/20 border border-green-500/30 rounded-lg text-green-400 font-mono text-sm",children:i},i))})]}),n.diff.removed_hosts.length>0&&e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Z,{className:"h-5 w-5 text-red-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Removed Hosts (",n.diff.removed_hosts.length,")"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.diff.removed_hosts.map(i=>e.jsx("span",{className:"px-3 py-1.5 bg-red-500/20 border border-red-500/30 rounded-lg text-red-400 font-mono text-sm",children:i},i))})]}),n.diff.host_changes.length>0&&e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(we,{className:"h-5 w-5 text-yellow-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Host Changes (",n.diff.host_changes.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:n.diff.host_changes.map(i=>{const h=_.has(i.ip);return i.new_ports.length>0||i.closed_ports.length>0||i.new_vulnerabilities.length>0||i.resolved_vulnerabilities.length>0||i.service_changes.length>0||i.os_change!==null?e.jsxs("div",{className:"bg-dark-bg rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("button",{onClick:()=>I(i.ip),className:"w-full flex items-center justify-between p-4 hover:bg-dark-hover transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[h?e.jsx(Le,{className:"h-4 w-4 text-slate-400"}):e.jsx(Me,{className:"h-4 w-4 text-slate-400"}),e.jsx(we,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"font-mono text-white",children:i.ip}),i.hostname&&e.jsxs("span",{className:"text-sm text-slate-400",children:["(",i.hostname,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.new_ports.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-green-500/20 border border-green-500/30 rounded text-xs text-green-400",children:["+",i.new_ports.length," ports"]}),i.closed_ports.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 border border-red-500/30 rounded text-xs text-red-400",children:["-",i.closed_ports.length," ports"]}),i.new_vulnerabilities.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 border border-red-500/30 rounded text-xs text-red-400",children:["+",i.new_vulnerabilities.length," vulns"]}),i.resolved_vulnerabilities.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-green-500/20 border border-green-500/30 rounded text-xs text-green-400",children:["-",i.resolved_vulnerabilities.length," vulns"]})]})]}),h&&e.jsxs("div",{className:"border-t border-dark-border p-4 space-y-4",children:[i.os_change&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-2",children:"Operating System Change"}),e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-3 w-3 text-red-400"}),e.jsxs("span",{className:"text-sm text-red-400",children:[i.os_change.old_os," (",i.os_change.old_confidence,"% confidence)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-3 w-3 text-green-400"}),e.jsxs("span",{className:"text-sm text-green-400",children:[i.os_change.new_os," (",i.os_change.new_confidence,"% confidence)"]})]})]})]}),i.new_ports.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-green-400"}),"New Open Ports (",i.new_ports.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:i.new_ports.map(t=>e.jsxs("div",{className:"bg-dark-surface rounded p-2 flex items-center justify-between",children:[e.jsxs("span",{className:"font-mono text-sm text-green-400",children:[t.port,"/",t.protocol]}),t.service&&e.jsxs("span",{className:"text-xs text-slate-400",children:[t.service.name,t.service.version&&` ${t.service.version}`]})]},t.port))})]}),i.closed_ports.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-red-400"}),"Closed Ports (",i.closed_ports.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:i.closed_ports.map(t=>e.jsxs("div",{className:"bg-dark-surface rounded p-2 flex items-center justify-between",children:[e.jsxs("span",{className:"font-mono text-sm text-red-400",children:[t.port,"/",t.protocol]}),t.service&&e.jsxs("span",{className:"text-xs text-slate-400",children:[t.service.name,t.service.version&&` ${t.service.version}`]})]},t.port))})]}),i.service_changes.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4 text-yellow-400"}),"Service Changes (",i.service_changes.length,")"]}),e.jsx("div",{className:"space-y-2",children:i.service_changes.map((t,o)=>e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-mono text-sm text-white",children:[t.port,"/",t.protocol]}),e.jsxs("div",{className:"flex items-center gap-2",children:[R(t.change_type),e.jsx("span",{className:"text-xs text-yellow-400",children:E(t.change_type)})]})]}),t.old_service&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Z,{className:"h-3 w-3 text-red-400"}),e.jsxs("span",{className:"text-red-400",children:[t.old_service,t.old_version&&` ${t.old_version}`]})]}),t.new_service&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(q,{className:"h-3 w-3 text-green-400"}),e.jsxs("span",{className:"text-green-400",children:[t.new_service,t.new_version&&` ${t.new_version}`]})]})]},o))})]}),i.new_vulnerabilities.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-red-400"}),"New Vulnerabilities (",i.new_vulnerabilities.length,")"]}),e.jsx("div",{className:"space-y-2",children:i.new_vulnerabilities.map((t,o)=>e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-white",children:t.cve_id||t.title}),e.jsx(G,{variant:"severity",type:t.severity.toLowerCase(),children:t.severity})]}),e.jsx("p",{className:"text-xs text-slate-400",children:t.description}),t.affected_service&&e.jsxs("span",{className:"text-xs text-slate-500",children:["Service: ",t.affected_service]})]},o))})]}),i.resolved_vulnerabilities.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4 text-green-400"}),"Resolved Vulnerabilities (",i.resolved_vulnerabilities.length,")"]}),e.jsx("div",{className:"space-y-2",children:i.resolved_vulnerabilities.map((t,o)=>e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1 opacity-75",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-green-400 line-through",children:t.cve_id||t.title}),e.jsx(G,{variant:"severity",type:t.severity.toLowerCase(),children:t.severity})]}),e.jsx("p",{className:"text-xs text-slate-500",children:t.description})]},o))})]})]})]},i.ip):null})})]}),n.diff.new_hosts.length===0&&n.diff.removed_hosts.length===0&&n.diff.host_changes.length===0&&e.jsx(S,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(H,{className:"h-12 w-12 text-green-400 mx-auto mb-4"}),e.jsx("p",{className:"text-lg text-white font-medium mb-2",children:"No Changes Detected"}),e.jsx("p",{className:"text-sm text-slate-400",children:"The selected scans have identical results"})]})})]}),!n&&c.length===0&&e.jsx(S,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Q,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No completed scans available"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Complete at least two scans to use the comparison feature"})]})})]})},bs=()=>{const[c,D]=a.useState([]),[L,u]=a.useState(!0),[N,w]=a.useState(!1),[f,P]=a.useState(null),[d,k]=a.useState({name:"",description:""}),[n,v]=a.useState(new Set),[_,T]=a.useState(null),[p,C]=a.useState(!1),{addScan:I}=Ge();a.useEffect(()=>{R()},[]);const R=async()=>{u(!0);try{const j=await de.getAll();D(j.data)}catch(j){r.error("Failed to load templates"),console.error(j)}finally{u(!1)}},E=()=>{k({name:"",description:""}),P(null),w(!1)},i=j=>{k({name:j.name,description:j.description||""}),P(j.id),w(!0)},h=async j=>{var A,g;if(j.preventDefault(),!d.name.trim()){r.error("Name is required");return}if(!f){r.error('Cannot create templates from this form. Use "Save as Template" in the scan form.');return}try{await de.update(f,{name:d.name,description:d.description||void 0}),r.success("Template updated"),E(),R()}catch(m){r.error(((g=(A=m.response)==null?void 0:A.data)==null?void 0:g.error)||"Failed to update template")}},l=async()=>{var j,A;if(_){C(!0);try{await de.delete(_.id),r.success(`Template "${_.name}" deleted`),R(),T(null)}catch(g){r.error(((A=(j=g.response)==null?void 0:j.data)==null?void 0:A.error)||"Failed to delete")}finally{C(!1)}}},t=async(j,A)=>{var m,s;const g=prompt(`Enter name for new scan (based on "${A}"):`,`${A} - ${new Date().toLocaleDateString()}`);if(g){v(new Set([...n,j]));try{const x=await de.createScan(j,g);I(x.data),r.success("Scan started from template!")}catch(x){r.error(((s=(m=x.response)==null?void 0:m.data)==null?void 0:s.error)||"Failed to create scan")}finally{v(x=>{const b=new Set(x);return b.delete(j),b})}}},o=j=>{try{return JSON.parse(j)}catch{return null}},F=j=>new Date(j).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return L?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(U,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scan Templates"})]}),e.jsx("div",{className:"text-sm text-slate-400",children:"Save scan configurations for quick reuse"})]})}),N&&e.jsx(S,{children:e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Edit Template"}),e.jsx("button",{type:"button",onClick:E,className:"text-slate-400 hover:text-white",children:e.jsx(pe,{className:"h-5 w-5"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:d.name,onChange:j=>k({...d,name:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Production Network Template"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("textarea",{value:d.description,onChange:j=>k({...d,description:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",rows:3,placeholder:"Optional description"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(y,{type:"button",variant:"secondary",onClick:E,children:"Cancel"}),e.jsxs(y,{type:"submit",variant:"primary",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Update"]})]})]})}),c.length===0&&!N?e.jsx(S,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_e,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scan templates yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:'Save scan configurations using "Save as Template" when creating a scan'})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:c.map(j=>{const A=o(j.config),g=n.has(j.id);return e.jsx(S,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white text-lg",children:j.name}),j.description&&e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:j.description})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>i(j),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit template",children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>T(j),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete template","aria-label":`Delete template ${j.name}`,children:e.jsx(ae,{className:"h-4 w-4"})})]})]}),A&&e.jsxs("div",{className:"space-y-2 border-t border-dark-border pt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:[A.targets.length," target",A.targets.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Ports: ",A.port_range[0],"-",A.port_range[1]]})]}),A.scan_type&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-slate-400 capitalize",children:A.scan_type.replace("_"," ")})]}),A.enable_enumeration&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(is,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Enumeration: ",A.enum_depth||"light"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[A.enable_os_detection&&e.jsx(G,{variant:"status",type:"completed",children:"OS Detection"}),A.enable_service_detection&&e.jsx(G,{variant:"status",type:"completed",children:"Services"}),A.enable_vuln_scan&&e.jsx(G,{variant:"status",type:"running",children:"Vuln Scan"}),A.enable_enumeration&&e.jsx(G,{variant:"status",type:"pending",children:"Enumeration"})]})]}),e.jsxs("div",{className:"flex items-center justify-between border-t border-dark-border pt-4",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:["Created ",F(j.created_at)]}),e.jsxs(y,{variant:"primary",size:"sm",onClick:()=>t(j.id,j.name),loading:g,disabled:g,children:[e.jsx(cs,{className:"h-4 w-4 mr-1.5"}),"Create Scan"]})]})]})},j.id)})}),e.jsx(te,{isOpen:!!_,onClose:()=>T(null),onConfirm:l,title:"Delete Template",message:`Are you sure you want to delete the template "${_==null?void 0:_.name}"? This will not affect any scans previously created from this template.`,confirmLabel:"Delete Template",variant:"danger",loading:p})]})},fs=()=>{const[c,D]=a.useState(!1),[L,u]=a.useState(!0),[N,w]=a.useState("idle"),[f,P]=a.useState(""),[d,k]=a.useState(""),[n,v]=a.useState([]),[_,T]=a.useState(""),[p,C]=a.useState(!1),[I,R]=a.useState(!1),[E,i]=a.useState(""),[h,l]=a.useState(""),[t,o]=a.useState(!1),[F,j]=a.useState(!1),[A,g]=a.useState(""),[m,s]=a.useState(""),[x,b]=a.useState(!1);a.useEffect(()=>{K()},[]);const K=async()=>{u(!0);try{const M=await me.me();D(M.data.mfa_enabled||!1)}catch(M){console.error("Failed to check MFA status:",M)}finally{u(!1)}},X=async()=>{var M,O;try{const $=await oe.setup();P($.data.secret),k($.data.qr_code_url),v($.data.recovery_codes),w("scan-qr")}catch($){r.error(((O=(M=$.response)==null?void 0:M.data)==null?void 0:O.error)||"Failed to initialize MFA setup")}},ce=async M=>{var O,$;if(M.preventDefault(),!_||_.length!==6){r.error("Please enter a valid 6-digit code");return}C(!0);try{await oe.verifySetup({totp_code:_}),r.success("MFA enabled successfully!"),w("show-recovery"),D(!0)}catch(Y){r.error((($=(O=Y.response)==null?void 0:O.data)==null?void 0:$.error)||"Invalid verification code")}finally{C(!1)}},B=()=>{w("idle"),P(""),k(""),v([]),T("")},Ke=async M=>{var O,$;if(M.preventDefault(),!E||!h){r.error("Password and TOTP code are required");return}o(!0);try{await oe.disable({password:E,totp_code:h}),r.success("MFA disabled successfully"),D(!1),R(!1),i(""),l("")}catch(Y){r.error((($=(O=Y.response)==null?void 0:O.data)==null?void 0:$.error)||"Failed to disable MFA")}finally{o(!1)}},qe=async M=>{var O,$;if(M.preventDefault(),!A||!m){r.error("Password and TOTP code are required");return}b(!0);try{const Y=await oe.regenerateRecoveryCodes({password:A,totp_code:m});v(Y.data.recovery_codes),r.success("Recovery codes regenerated successfully"),j(!1),g(""),s(""),w("show-recovery")}catch(Y){r.error((($=(O=Y.response)==null?void 0:O.data)==null?void 0:$.error)||"Failed to regenerate recovery codes")}finally{b(!1)}},Ae=M=>{navigator.clipboard.writeText(M),r.success("Copied to clipboard")},He=()=>{const M=new Blob([n.join(`
`)],{type:"text/plain"}),O=URL.createObjectURL(M),$=document.createElement("a");$.href=O,$.download="heroforge-recovery-codes.txt",document.body.appendChild($),$.click(),document.body.removeChild($),URL.revokeObjectURL(O),r.success("Recovery codes downloaded")};return L?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(U,{})})}):N!=="idle"?e.jsx("div",{className:"space-y-6",children:e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Q,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Enable Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{className:N==="scan-qr"?"text-primary":"",children:"1. Scan QR"}),e.jsx("span",{children:""}),e.jsx("span",{className:N==="verify-code"?"text-primary":"",children:"2. Verify"}),e.jsx("span",{children:""}),e.jsx("span",{className:N==="show-recovery"?"text-primary":"",children:"3. Save Codes"})]})]}),N==="scan-qr"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 1: Scan QR Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Use an authenticator app like Google Authenticator, Authy, or 1Password to scan this QR code:"}),d&&e.jsx("div",{className:"bg-white p-4 rounded-lg mb-4",children:e.jsx("img",{src:d,alt:"MFA QR Code",className:"w-64 h-64"})}),e.jsxs("div",{className:"mt-4 w-full max-w-md",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Or enter this secret manually:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(J,{type:"text",value:f,readOnly:!0,className:"font-mono text-sm flex-1"}),e.jsx(y,{variant:"secondary",onClick:()=>Ae(f),children:e.jsx(ke,{className:"h-4 w-4"})})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(y,{variant:"primary",onClick:()=>w("verify-code"),children:"Next: Verify Code"})})]}),N==="verify-code"&&e.jsxs("form",{onSubmit:ce,className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Ie,{className:"h-12 w-12 text-primary mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 2: Verify Your Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Enter the 6-digit code from your authenticator app to confirm setup:"}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsx(J,{type:"text",value:_,onChange:M=>T(M.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center text-2xl tracking-widest font-mono",maxLength:6,autoFocus:!0})})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(y,{type:"button",variant:"secondary",onClick:()=>w("scan-qr"),children:"Back"}),e.jsx(y,{type:"submit",variant:"primary",loading:p,disabled:p||_.length!==6,children:"Verify & Enable MFA"})]})]}),N==="show-recovery"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(V,{className:"h-6 w-6 text-yellow-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-yellow-400 mb-2",children:"Save Your Recovery Codes"}),e.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Store these recovery codes in a safe place. Each code can be used once to access your account if you lose your authenticator device."}),e.jsx("div",{className:"grid grid-cols-2 gap-2 bg-dark-bg rounded-lg p-4 font-mono text-sm mb-4",children:n.map((M,O)=>e.jsxs("div",{className:"text-white",children:[O+1,". ",M]},O))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{variant:"secondary",onClick:()=>Ae(n.join(`
`)),children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Copy Codes"]}),e.jsxs(y,{variant:"secondary",onClick:He,children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),"Download Codes"]})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(y,{variant:"primary",onClick:B,children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Finish Setup"]})})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Q,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-start justify-between mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[c?e.jsx(H,{className:"h-6 w-6 text-green-400 flex-shrink-0"}):e.jsx(V,{className:"h-6 w-6 text-yellow-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white mb-1",children:c?"MFA Enabled":"MFA Disabled"}),e.jsx("p",{className:"text-sm text-slate-400",children:c?"Your account is protected with two-factor authentication.":"Enable MFA to add an extra layer of security to your account."})]})]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${c?"bg-green-400":"bg-yellow-400"}`})]}),c?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(he,{className:"h-5 w-5 text-primary"}),e.jsx("h5",{className:"font-medium text-white",children:"Recovery Codes"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Generate new recovery codes if you've lost the originals or used them."}),e.jsx(y,{variant:"secondary",size:"sm",onClick:()=>j(!0),children:"Regenerate Codes"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ue,{className:"h-5 w-5 text-red-400"}),e.jsx("h5",{className:"font-medium text-white",children:"Disable MFA"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Turn off two-factor authentication for your account."}),e.jsx(y,{variant:"danger",size:"sm",onClick:()=>R(!0),children:"Disable MFA"})]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h5",{className:"text-white font-medium mb-2",children:"Why enable MFA?"}),e.jsxs("ul",{className:"text-sm text-slate-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Adds an extra layer of security beyond your password"}),e.jsx("li",{children:"Prevents unauthorized access even if your password is compromised"}),e.jsx("li",{children:"Uses time-based codes from your smartphone"}),e.jsx("li",{children:"Industry standard for securing sensitive accounts"})]})]}),e.jsxs(y,{variant:"primary",onClick:X,children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Enable Two-Factor Authentication"]})]})]}),I&&e.jsx(S,{children:e.jsxs("form",{onSubmit:Ke,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Disable Two-Factor Authentication"}),e.jsxs("button",{type:"button",onClick:()=>{R(!1),i(""),l("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"Disabling MFA will make your account less secure. You'll need to provide your password and a TOTP code to confirm."})}),e.jsx(J,{label:"Password",type:"password",value:E,onChange:M=>i(M.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(J,{label:"TOTP Code",type:"text",value:h,onChange:M=>l(M.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(y,{type:"button",variant:"secondary",onClick:()=>{R(!1),i(""),l("")},children:"Cancel"}),e.jsx(y,{type:"submit",variant:"danger",loading:t,disabled:t||!E||h.length!==6,children:"Disable MFA"})]})]})}),F&&e.jsx(S,{children:e.jsxs("form",{onSubmit:qe,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Regenerate Recovery Codes"}),e.jsxs("button",{type:"button",onClick:()=>{j(!1),g(""),s("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"This will invalidate all existing recovery codes. Make sure to save the new codes in a safe place."})}),e.jsx(J,{label:"Password",type:"password",value:A,onChange:M=>g(M.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(J,{label:"TOTP Code",type:"text",value:m,onChange:M=>s(M.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(y,{type:"button",variant:"secondary",onClick:()=>{j(!1),g(""),s("")},children:"Cancel"}),e.jsx(y,{type:"submit",variant:"primary",loading:x,disabled:x||!A||m.length!==6,children:"Generate New Codes"})]})]})})]})},ys=()=>{const[c,D]=a.useState([]),[L,u]=a.useState(!0),[N,w]=a.useState(!1),[f,P]=a.useState(""),[d,k]=a.useState(!1),[n,v]=a.useState(null),[_,T]=a.useState(null),[p,C]=a.useState(!1);a.useEffect(()=>{I()},[]);const I=async()=>{u(!0);try{const l=await je.getAll();D(l.data)}catch(l){r.error("Failed to load API keys"),console.error(l)}finally{u(!1)}},R=async()=>{var l,t;if(!f.trim()){r.error("Please enter a name for the API key");return}k(!0);try{const o=await je.create({name:f.trim()});v(o.data),P(""),await I(),r.success("API key created successfully")}catch(o){r.error(((t=(l=o.response)==null?void 0:l.data)==null?void 0:t.error)||"Failed to create API key")}finally{k(!1)}},E=async()=>{var l,t;if(_){C(!0);try{await je.delete(_.id),await I(),r.success(`API key "${_.name}" revoked successfully`),T(null)}catch(o){r.error(((t=(l=o.response)==null?void 0:l.data)==null?void 0:t.error)||"Failed to revoke API key")}finally{C(!1)}}},i=l=>{navigator.clipboard.writeText(l),r.success("API key copied to clipboard")},h=()=>{v(null),w(!1)};return L?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(U,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Keys"})]}),e.jsxs(y,{variant:"primary",onClick:()=>w(!0),className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Create API Key"]})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"API keys allow programmatic access to HeroForge. Keep your keys secure and never share them publicly."}),c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(he,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No API keys yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Create your first API key to get started"})]}):e.jsx("div",{className:"space-y-3",children:c.map(l=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary/30 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-medium text-white",children:l.name}),e.jsxs("code",{className:"px-2 py-1 bg-dark-surface rounded text-xs text-slate-400 font-mono",children:[l.prefix,"..."]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Se,{className:"h-3 w-3"}),"Created ",new Date(l.created_at).toLocaleDateString()]}),l.last_used_at&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"h-3 w-3"}),"Last used ",new Date(l.last_used_at).toLocaleDateString()]}),!l.last_used_at&&e.jsx("span",{className:"text-amber-500",children:"Never used"})]})]}),e.jsxs(y,{variant:"danger",size:"sm",onClick:()=>T(l),className:"flex items-center gap-2","aria-label":`Revoke API key ${l.name}`,children:[e.jsx(ae,{className:"h-4 w-4"}),"Revoke"]})]},l.id))})]}),N&&!n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Create API Key"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Key Name"}),e.jsx("input",{type:"text",value:f,onChange:l=>P(l.target.value),placeholder:"e.g., Production Server, CI/CD Pipeline",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",autoFocus:!0}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Give your API key a descriptive name to remember where it's used"})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4",children:[e.jsx(y,{variant:"secondary",onClick:()=>{w(!1),P("")},children:"Cancel"}),e.jsx(y,{variant:"primary",onClick:R,disabled:d||!f.trim(),children:d?e.jsxs(e.Fragment,{children:[e.jsx(U,{}),e.jsx("span",{className:"ml-2",children:"Creating..."})]}):"Create Key"})]})]})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-2xl w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(H,{className:"h-6 w-6 text-green-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Key Created Successfully"})]}),e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-amber-200 font-medium mb-2",children:"Important: Save your API key now!"}),e.jsx("p",{className:"text-xs text-amber-300/70",children:"This is the only time you'll see the full key. If you lose it, you'll need to create a new one."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"API Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("code",{className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-3 text-white font-mono text-sm break-all",children:n.key}),e.jsxs(y,{variant:"secondary",onClick:()=>i(n.key),className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-4 w-4"}),"Copy"]})]})]}),e.jsxs("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-200 mb-2",children:"Using your API key"}),e.jsx("p",{className:"text-xs text-blue-300/70 mb-3",children:"Include your API key in the X-API-Key header:"}),e.jsxs("code",{className:"block bg-dark-bg border border-dark-border rounded px-3 py-2 text-xs text-slate-300 font-mono",children:['curl -H "X-API-Key: ',n.key,'" https://heroforge.example.com/api/scans']})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(y,{variant:"primary",onClick:h,children:"Done"})})]})]})}),e.jsx(te,{isOpen:!!_,onClose:()=>T(null),onConfirm:E,title:"Revoke API Key",message:`Are you sure you want to revoke the API key "${_==null?void 0:_.name}"? Any applications using this key will lose access immediately.`,confirmLabel:"Revoke Key",variant:"danger",loading:p})]})},vs=()=>{const[c,D]=a.useState(!0),[L,u]=a.useState(!1),[N,w]=a.useState(!1),[f,P]=a.useState(!1),[d,k]=a.useState({jira_url:"",username:"",api_token:"",project_key:"",issue_type:"Task",default_assignee:"",enabled:!0}),[n,v]=a.useState([]),[_,T]=a.useState([]),[p,C]=a.useState(!1);a.useEffect(()=>{I()},[]);const I=async()=>{var l;D(!0);try{const t=await le.getSettings();k(t.data),P(!0)}catch(t){((l=t.response)==null?void 0:l.status)===404?P(!1):console.error("Failed to load JIRA settings:",t)}finally{D(!1)}},R=async()=>{var l,t;if(!d.jira_url||!d.username||!d.api_token||!d.project_key){r.error("Please fill in all required fields");return}u(!0);try{await le.updateSettings(d),r.success("JIRA settings saved successfully"),P(!0)}catch(o){console.error("Failed to save JIRA settings:",o),r.error(((t=(l=o.response)==null?void 0:l.data)==null?void 0:t.error)||"Failed to save JIRA settings")}finally{u(!1)}},E=async()=>{var l,t;if(!f){r.error("Please save your settings first");return}w(!0);try{await le.testConnection(),r.success("JIRA connection successful!")}catch(o){console.error("JIRA connection failed:",o),r.error(((t=(l=o.response)==null?void 0:l.data)==null?void 0:t.error)||"JIRA connection failed")}finally{w(!1)}},i=async()=>{var l,t;if(!f){r.error("Please save your settings first");return}C(!0);try{const o=await le.listProjects();v(o.data),r.success(`Loaded ${o.data.length} projects`)}catch(o){console.error("Failed to load projects:",o),r.error(((t=(l=o.response)==null?void 0:l.data)==null?void 0:t.error)||"Failed to load projects")}finally{C(!1)}},h=async()=>{var l,t;if(!f||!d.project_key){r.error("Please save your settings and select a project first");return}C(!0);try{const o=await le.listIssueTypes();T(o.data),r.success(`Loaded ${o.data.length} issue types`)}catch(o){console.error("Failed to load issue types:",o),r.error(((t=(l=o.response)==null?void 0:l.data)==null?void 0:t.error)||"Failed to load issue types")}finally{C(!1)}};return c?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(U,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx($e,{className:"h-6 w-6 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"JIRA Integration"})]}),e.jsxs("div",{className:"space-y-4",children:[!f&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(V,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"JIRA Integration Not Configured"}),e.jsx("p",{children:"Configure your JIRA instance to automatically create tickets from vulnerabilities."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["JIRA URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"url",placeholder:"https://your-domain.atlassian.net",value:d.jira_url,onChange:l=>k({...d,jira_url:l.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your JIRA instance URL (e.g., https://company.atlassian.net)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Username/Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"text",placeholder:"user@example.com",value:d.username,onChange:l=>k({...d,username:l.target.value})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["API Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"password",placeholder:"Your JIRA API token",value:d.api_token,onChange:l=>k({...d,api_token:l.target.value})}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Generate an API token at"," ",e.jsxs("a",{href:"https://id.atlassian.com/manage-profile/security/api-tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 inline-flex items-center gap-1",children:["Atlassian Account Settings ",e.jsx(Oe,{className:"h-3 w-3"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Key ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:n.length>0?e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:d.project_key,onChange:l=>k({...d,project_key:l.target.value}),children:[e.jsx("option",{value:"",children:"Select a project"}),n.map(l=>e.jsxs("option",{value:l.key,children:[l.name," (",l.key,")"]},l.key))]}):e.jsx(J,{type:"text",placeholder:"PROJECT",value:d.project_key,onChange:l=>k({...d,project_key:l.target.value})})}),e.jsx(y,{onClick:i,disabled:!f||p,variant:"secondary",children:p?"Loading...":"Load Projects"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Issue Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:_.length>0?e.jsx("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:d.issue_type,onChange:l=>k({...d,issue_type:l.target.value}),children:_.map(l=>e.jsx("option",{value:l.name,children:l.name},l.id))}):e.jsx(J,{type:"text",placeholder:"Task",value:d.issue_type,onChange:l=>k({...d,issue_type:l.target.value})})}),e.jsx(y,{onClick:h,disabled:!f||!d.project_key||p,variant:"secondary",children:p?"Loading...":"Load Types"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Assignee (optional)"}),e.jsx(J,{type:"text",placeholder:"username",value:d.default_assignee||"",onChange:l=>k({...d,default_assignee:l.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Leave empty for unassigned or enter a JIRA username"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"jira-enabled",checked:d.enabled,onChange:l=>k({...d,enabled:l.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"jira-enabled",className:"text-sm font-medium text-gray-700",children:"Enable JIRA integration"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(y,{onClick:R,disabled:L,children:L?"Saving...":"Save Settings"}),e.jsx(y,{onClick:E,disabled:!f||N,variant:"secondary",children:N?"Testing...":"Test Connection"})]}),f&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(H,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("p",{className:"font-medium",children:"JIRA Integration Configured"}),e.jsx("p",{children:"You can now create JIRA tickets from vulnerabilities."})]})]})]})]}),e.jsxs(S,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"How to Use JIRA Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Configure your JIRA instance settings above and test the connection."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Navigate to any vulnerability in your scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"3"})}),e.jsx("p",{children:'Click the "Create JIRA Ticket" button to automatically create an issue with vulnerability details.'})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"The vulnerability will be linked to the JIRA ticket, and you can track it in your JIRA project."})]})]})]})]})},Ns=()=>{const[c,D]=a.useState([]),[L,u]=a.useState(!0),[N,w]=a.useState(!1),[f,P]=a.useState(null),[d,k]=a.useState(null),[n,v]=a.useState(null),[_,T]=a.useState(!1),[p,C]=a.useState([]),[I,R]=a.useState(!1),[E,i]=a.useState(""),[h,l]=a.useState(!1);a.useEffect(()=>{t(),j()},[]);const t=async()=>{u(!0);try{const g=await ee.getSettings();D(g.data)}catch(g){r.error("Failed to load SIEM settings"),console.error(g)}finally{u(!1)}},o=async g=>{var m,s;k(g);try{const x=await ee.testConnection(g);x.data.success?r.success("Connection test successful!"):r.error(`Connection test failed: ${x.data.message}`)}catch(x){r.error(((s=(m=x.response)==null?void 0:m.data)==null?void 0:s.error)||"Connection test failed")}finally{k(null)}},F=async()=>{var g,m;if(n){T(!0);try{await ee.deleteSettings(n.id),r.success(`${n.siem_type.toUpperCase()} integration deleted`),t(),v(null)}catch(s){r.error(((m=(g=s.response)==null?void 0:g.data)==null?void 0:m.error)||"Failed to delete SIEM integration")}finally{T(!1)}}},j=async()=>{R(!0);try{const g=await De.getAll();C(g.data.filter(m=>m.status==="completed"))}catch(g){console.error("Failed to load scans:",g)}finally{R(!1)}},A=async()=>{var m,s;if(!E){r.error("Please select a scan to export");return}if(c.filter(x=>x.enabled).length===0){r.error("No enabled SIEM integrations found. Please enable at least one integration.");return}l(!0);try{const x=await ee.exportScan(E);x.data.success?(r.success(`Scan exported to ${x.data.exported_to} SIEM integration(s). ${x.data.events_count} events sent.`),x.data.errors&&x.data.errors.length>0&&x.data.errors.forEach(b=>r.warning(b))):r.error("Export failed. Check SIEM configuration.")}catch(x){r.error(((s=(m=x.response)==null?void 0:m.data)==null?void 0:s.error)||"Failed to export scan to SIEM")}finally{l(!1)}};return L?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(U,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"SIEM Integrations"})]}),e.jsxs(y,{variant:"primary",onClick:()=>w(!0),children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Add Integration"]})]}),c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(we,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"No SIEM integrations configured"}),e.jsxs(y,{variant:"primary",onClick:()=>w(!0),children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Add Your First Integration"]})]}):e.jsx("div",{className:"space-y-4",children:c.map(g=>e.jsx("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-primary/20 text-primary rounded-md text-sm font-medium uppercase",children:g.siem_type}),g.enabled?e.jsxs("span",{className:"flex items-center gap-1 text-green-400 text-sm",children:[e.jsx(H,{className:"h-4 w-4"}),"Enabled"]}):e.jsxs("span",{className:"flex items-center gap-1 text-slate-500 text-sm",children:[e.jsx(Fe,{className:"h-4 w-4"}),"Disabled"]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Endpoint:"}),e.jsx("span",{className:"text-white font-mono",children:g.endpoint_url})]}),g.protocol&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Protocol:"}),e.jsx("span",{className:"text-white uppercase",children:g.protocol})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:g.export_on_scan_complete,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export on scan complete"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:g.export_on_critical_vuln,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export critical vulnerabilities"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{variant:"outline",size:"sm",onClick:()=>o(g.id),disabled:d===g.id,children:d===g.id?e.jsx(U,{}):e.jsx(os,{className:"h-4 w-4"})}),e.jsx(y,{variant:"outline",size:"sm",onClick:()=>P(g),children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx(y,{variant:"outline",size:"sm",onClick:()=>v(g),"aria-label":`Delete ${g.siem_type} integration`,children:e.jsx(ae,{className:"h-4 w-4 text-red-400"})})]})]})},g.id))})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Manual Export"})]}),e.jsx(y,{variant:"outline",size:"sm",onClick:j,disabled:I,children:I?e.jsx(U,{}):e.jsx(xe,{className:"h-4 w-4"})})]}),c.filter(g=>g.enabled).length===0?e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(Fe,{className:"h-5 w-5 text-amber-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-200",children:[e.jsx("p",{className:"font-medium mb-1",children:"No Enabled Integrations"}),e.jsx("p",{children:"Enable at least one SIEM integration above before exporting scan results."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Manually export scan results to all enabled SIEM integrations."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:E,onChange:g=>i(g.target.value),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",disabled:I||h,children:[e.jsx("option",{value:"",children:"Select a completed scan..."}),p.map(g=>e.jsxs("option",{value:g.id,children:[g.name," - ",new Date(g.created_at).toLocaleDateString()," ",new Date(g.created_at).toLocaleTimeString()]},g.id))]}),e.jsx(y,{variant:"primary",onClick:A,disabled:!E||h||I,children:h?e.jsxs(e.Fragment,{children:[e.jsx(U,{}),e.jsx("span",{className:"ml-2",children:"Exporting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Export to SIEM"]})})]}),p.length===0&&!I&&e.jsx("p",{className:"text-sm text-slate-500",children:"No completed scans available for export."}),e.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["Export will send data to: ",c.filter(g=>g.enabled).map(g=>g.siem_type.toUpperCase()).join(", ")]})]})]}),e.jsxs(S,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"About SIEM Integration"}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-400",children:[e.jsx("p",{children:"SIEM (Security Information and Event Management) integration allows HeroForge to automatically export scan results and vulnerability findings to your security monitoring platform."}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Syslog:"})," RFC 5424 compliant syslog over TCP/UDP"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Splunk:"})," Splunk HTTP Event Collector (HEC)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Elasticsearch:"})," Direct indexing via Bulk API"]})]})]})]}),(N||f)&&e.jsx(ws,{settings:f,onClose:()=>{w(!1),P(null)},onSave:()=>{w(!1),P(null),t()}}),e.jsx(te,{isOpen:!!n,onClose:()=>v(null),onConfirm:F,title:"Delete SIEM Integration",message:`Are you sure you want to delete the ${n==null?void 0:n.siem_type.toUpperCase()} integration? Automatic exports to this endpoint will stop.`,confirmLabel:"Delete Integration",variant:"danger",loading:_})]})},ws=({settings:c,onClose:D,onSave:L})=>{const[u,N]=a.useState({siem_type:(c==null?void 0:c.siem_type)||"syslog",endpoint_url:(c==null?void 0:c.endpoint_url)||"",api_key:(c==null?void 0:c.api_key)||"",protocol:(c==null?void 0:c.protocol)||"tcp",enabled:(c==null?void 0:c.enabled)??!0,export_on_scan_complete:(c==null?void 0:c.export_on_scan_complete)??!1,export_on_critical_vuln:(c==null?void 0:c.export_on_critical_vuln)??!0}),[w,f]=a.useState(!1),P=async d=>{var k,n;if(d.preventDefault(),!u.endpoint_url){r.error("Endpoint URL is required");return}if(u.siem_type==="splunk"&&!u.api_key){r.error("API key is required for Splunk HEC");return}f(!0);try{if(c){const v={endpoint_url:u.endpoint_url,enabled:u.enabled,export_on_scan_complete:u.export_on_scan_complete,export_on_critical_vuln:u.export_on_critical_vuln};u.api_key&&(v.api_key=u.api_key),u.siem_type==="syslog"&&(v.protocol=u.protocol),await ee.updateSettings(c.id,v),r.success("SIEM integration updated")}else{const v={siem_type:u.siem_type,endpoint_url:u.endpoint_url,enabled:u.enabled,export_on_scan_complete:u.export_on_scan_complete,export_on_critical_vuln:u.export_on_critical_vuln};u.api_key&&(v.api_key=u.api_key),u.siem_type==="syslog"&&(v.protocol=u.protocol),await ee.createSettings(v),r.success("SIEM integration created")}L()}catch(v){r.error(((n=(k=v.response)==null?void 0:k.data)==null?void 0:n.error)||"Failed to save SIEM integration")}finally{f(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white",children:[c?"Edit":"Add"," SIEM Integration"]}),e.jsx("button",{onClick:D,className:"text-slate-400 hover:text-white",children:e.jsx(pe,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:P,className:"p-6 space-y-6",children:[!c&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"SIEM Type"}),e.jsxs("select",{value:u.siem_type,onChange:d=>N({...u,siem_type:d.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"syslog",children:"Syslog (RFC 5424)"}),e.jsx("option",{value:"splunk",children:"Splunk HEC"}),e.jsx("option",{value:"elasticsearch",children:"Elasticsearch"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Endpoint URL"}),e.jsx("input",{type:"text",value:u.endpoint_url,onChange:d=>N({...u,endpoint_url:d.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:u.siem_type==="syslog"?"192.168.1.100:514":u.siem_type==="splunk"?"https://splunk.example.com:8088":"https://elasticsearch.example.com:9200"})]}),u.siem_type==="syslog"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Protocol"}),e.jsxs("select",{value:u.protocol,onChange:d=>N({...u,protocol:d.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"})]})]}),(u.siem_type==="splunk"||u.siem_type==="elasticsearch")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:[u.siem_type==="splunk"?"HEC Token":"API Key"," ",u.siem_type==="splunk"&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"password",value:u.api_key,onChange:d=>N({...u,api_key:d.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:c?"(leave blank to keep current)":""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.enabled,onChange:d=>N({...u,enabled:d.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Enable this integration"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.export_on_scan_complete,onChange:d=>N({...u,export_on_scan_complete:d.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export when scans complete"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.export_on_critical_vuln,onChange:d=>N({...u,export_on_critical_vuln:d.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export critical vulnerabilities immediately"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(y,{type:"button",variant:"outline",onClick:D,children:"Cancel"}),e.jsx(y,{type:"submit",variant:"primary",disabled:w,children:w?e.jsxs(e.Fragment,{children:[e.jsx(U,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs("span",{children:[c?"Update":"Create"," Integration"]})})]})]})]})})},Ps=()=>{const[c,D]=a.useState("profile"),L=[{name:"Account",tabs:[{id:"profile",label:"Profile",icon:e.jsx(ye,{className:"h-4 w-4"}),component:e.jsx(ms,{})},{id:"security",label:"Security",icon:e.jsx(ue,{className:"h-4 w-4"}),component:e.jsx(fs,{})},{id:"api-keys",label:"API Keys",icon:e.jsx(he,{className:"h-4 w-4"}),component:e.jsx(ys,{})}]},{name:"Administration",tabs:[{id:"administration",label:"Users",icon:e.jsx(Q,{className:"h-4 w-4"}),component:e.jsx(hs,{})}]},{name:"Scanning",tabs:[{id:"target-groups",label:"Target Groups",icon:e.jsx(Ce,{className:"h-4 w-4"}),component:e.jsx(us,{})},{id:"scheduled-scans",label:"Scheduled Scans",icon:e.jsx(se,{className:"h-4 w-4"}),component:e.jsx(ps,{})},{id:"templates",label:"Templates",icon:e.jsx(_e,{className:"h-4 w-4"}),component:e.jsx(bs,{})},{id:"compare-scans",label:"Compare",icon:e.jsx(Ne,{className:"h-4 w-4"}),component:e.jsx(js,{})}]},{name:"Integrations",tabs:[{id:"notifications",label:"Notifications",icon:e.jsx(Ue,{className:"h-4 w-4"}),component:e.jsx(gs,{})},{id:"jira-integration",label:"JIRA",icon:e.jsx(Oe,{className:"h-4 w-4"}),component:e.jsx(vs,{})},{id:"siem-integration",label:"SIEM",icon:e.jsx(Je,{className:"h-4 w-4"}),component:e.jsx(Ns,{})}]}],N=L.flatMap(w=>w.tabs).find(w=>w.id===c);return e.jsx(Be,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx($e,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Settings"})]}),e.jsx("p",{className:"text-slate-400",children:"Manage your account, scanning configuration, and integrations"})]}),e.jsx("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:e.jsx("div",{className:"flex flex-wrap gap-6",children:L.map(w=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:w.name}),e.jsx("div",{className:"flex gap-1",children:w.tabs.map(f=>e.jsxs("button",{onClick:()=>D(f.id),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${c===f.id?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[f.icon,f.label]},f.id))})]},w.name))})}),e.jsx("div",{children:N==null?void 0:N.component})]})})};export{Ps as default};
