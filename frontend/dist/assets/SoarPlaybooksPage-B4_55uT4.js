import{j as e}from"./vendor-state-BXNPjUwt.js";import{r as a}from"./vendor-react-5KxtEOLM.js";import{B as r,c0 as j,O as u,m as z,a9 as y,l as E,_ as B,aO as L,b2 as X,Z,g as N,d as M,X as W,s as G,p as v,i as H}from"./vendor-ui-PizTOSgB.js";import{L as J}from"./Layout-CeExTnzB.js";import{ao as l}from"./index-DgePDh_X.js";import"./Header-Dw99lsG2.js";import"./vendor-markdown-RN55YrVy.js";import"./vendor-utils-DfRopTPV.js";const ae=()=>{const[i,o]=a.useState("playbooks"),[m,b]=a.useState([]),[f,w]=a.useState([]),[x,_]=a.useState([]),[c,S]=a.useState([]),[P,C]=a.useState([]),[A,h]=a.useState(!0),[g,k]=a.useState(null);a.useEffect(()=>{d()},[]);const d=async()=>{try{h(!0);const[s,n,I,T,q]=await Promise.all([l.getPlaybooks().then(t=>t.data).catch(()=>[]),l.getActions().then(t=>t.data).catch(()=>[]),l.getRuns().then(t=>t.data).catch(()=>[]),l.getApprovals().then(t=>t.data).catch(()=>[]),l.getIntegrations().then(t=>t.data).catch(()=>[])]);b(s),w(n),_(I),S(T),C(q)}catch(s){console.error("Failed to load SOAR data:",s),r.error("Failed to load SOAR data")}finally{h(!1)}},R=async s=>{try{r.info(`Starting ${s.name}...`),await l.runPlaybook(s.id),r.success("Playbook started successfully"),d()}catch(n){console.error("Failed to start playbook:",n),r.error("Failed to start playbook")}},$=async s=>{try{await l.approveStep(s.id,"approved"),r.success("Step approved"),d()}catch(n){console.error("Failed to approve step:",n),r.error("Failed to approve step")}},F=async s=>{try{await l.rejectStep(s.id,"Manual rejection"),r.success("Step rejected"),d()}catch(n){console.error("Failed to reject step:",n),r.error("Failed to reject step")}},D=s=>{switch(s){case"completed":return e.jsx(N,{className:"h-5 w-5 text-green-400"});case"failed":return e.jsx(H,{className:"h-5 w-5 text-red-400"});case"running":return e.jsx(y,{className:"h-5 w-5 text-cyan-400 animate-spin"});case"waiting_approval":return e.jsx(u,{className:"h-5 w-5 text-yellow-400"});case"pending":return e.jsx(v,{className:"h-5 w-5 text-gray-400"});default:return e.jsx(v,{className:"h-5 w-5 text-gray-400"})}},p=s=>{switch(s){case"enrichment":return"bg-blue-600";case"containment":return"bg-red-600";case"remediation":return"bg-green-600";case"notification":return"bg-purple-600";case"incident_response":return"bg-orange-600";case"utility":return"bg-gray-600";default:return"bg-gray-600"}},O=s=>{switch(s){case"high":return"text-red-400";case"medium":return"text-yellow-400";case"low":return"text-green-400";default:return"text-gray-400"}};return e.jsx(J,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{className:"h-8 w-8 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"SOAR Playbooks"}),e.jsx("p",{className:"text-gray-400",children:"Security Orchestration, Automation, and Response"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[c.length>0&&e.jsxs("button",{onClick:()=>o("approvals"),className:"flex items-center gap-2 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-500",children:[e.jsx(u,{className:"h-4 w-4"}),c.length," Pending Approval"]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-500",children:[e.jsx(z,{className:"h-4 w-4"}),"Create Playbook"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:m.filter(s=>s.status==="active").length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Active Playbooks"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-cyan-400",children:x.filter(s=>s.status==="running").length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Running"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:x.filter(s=>s.status==="completed").length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Completed Today"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:c.length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Pending Approvals"})]})]}),e.jsx("div",{className:"flex gap-1 mb-6 border-b border-gray-700",children:["playbooks","actions","runs","approvals","integrations"].map(s=>e.jsxs("button",{onClick:()=>o(s),className:`px-4 py-2 font-medium capitalize ${i===s?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:[s,s==="approvals"&&c.length>0&&e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-yellow-600 text-white text-xs rounded-full",children:c.length})]},s))}),A?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(y,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs(e.Fragment,{children:[i==="playbooks"&&e.jsx("div",{className:"grid gap-4",children:m.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>k(g===s.id?null:s.id),className:"text-gray-400 hover:text-white",children:g===s.id?e.jsx(E,{className:"h-5 w-5"}):e.jsx(B,{className:"h-5 w-5"})}),e.jsx(j,{className:"h-6 w-6 text-cyan-400"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[s.name,e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${s.status==="active"?"bg-green-600":"bg-gray-600"} text-white`,children:s.status})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{className:"text-white",children:[s.run_count," runs"]}),s.success_rate&&e.jsxs("div",{className:"text-green-400",children:[s.success_rate,"% success"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>R(s),className:"p-2 bg-cyan-600 rounded-lg hover:bg-cyan-500",disabled:s.status!=="active",children:e.jsx(L,{className:"h-4 w-4 text-white"})}),e.jsx("button",{className:"p-2 bg-gray-700 rounded-lg hover:bg-gray-600",children:e.jsx(X,{className:"h-4 w-4 text-gray-300"})})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-3",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs text-white ${p(s.category)}`,children:s.category}),e.jsxs("span",{className:"text-gray-400 text-sm flex items-center gap-1",children:[e.jsx(Z,{className:"h-3 w-3"}),s.trigger_type]}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["v",s.version]}),s.avg_duration_seconds&&e.jsxs("span",{className:"text-gray-400 text-sm",children:["~",s.avg_duration_seconds,"s avg"]})]})]},s.id))}),i==="actions"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:s.display_name}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:s.description})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs text-white ${p(s.category)}`,children:s.category}),e.jsxs("span",{className:`text-xs ${O(s.risk_level)}`,children:[s.risk_level," risk"]}),s.requires_approval&&e.jsx("span",{className:"px-2 py-1 bg-yellow-600 text-white text-xs rounded",children:"Requires Approval"})]})]},s.id))}),i==="runs"&&e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Playbook"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Trigger"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Progress"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Initiated By"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Duration"})]})}),e.jsx("tbody",{children:x.map(s=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[D(s.status),e.jsx("span",{className:"text-white capitalize",children:s.status.replace("_"," ")})]})}),e.jsx("td",{className:"px-4 py-3 text-white",children:s.playbook_name}),e.jsx("td",{className:"px-4 py-3 text-gray-300 capitalize",children:s.trigger_type}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-cyan-500 h-2 rounded-full",style:{width:`${s.current_step/s.total_steps*100}%`}})}),e.jsxs("span",{className:"text-gray-400 text-sm",children:[s.current_step,"/",s.total_steps]})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:s.initiated_by}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.duration_seconds?`${s.duration_seconds}s`:"-"})]},s.id))})]})}),i==="approvals"&&e.jsx("div",{className:"space-y-4",children:c.length===0?e.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 text-center",children:[e.jsx(N,{className:"h-12 w-12 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-white text-lg font-medium",children:"No Pending Approvals"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"All playbook steps are up to date"})]}):c.map(s=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:s.playbook_name}),e.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Step: ",s.step_name]}),e.jsxs("p",{className:"text-gray-500 text-xs mt-2",children:[s.current_approvals,"/",s.required_approvals," approvals"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>$(s),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-500",children:[e.jsx(M,{className:"h-4 w-4"}),"Approve"]}),e.jsxs("button",{onClick:()=>F(s),className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-500",children:[e.jsx(W,{className:"h-4 w-4"}),"Reject"]})]})]})},s.id))}),i==="integrations"&&e.jsx("div",{className:"grid gap-4",children:P.map(s=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${s.status==="connected"?"bg-green-400":"bg-red-400"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:s.name}),e.jsxs("p",{className:"text-gray-400 text-sm capitalize",children:[s.integration_type," â€¢ ",s.vendor||"Custom"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:`text-sm ${s.status==="connected"?"text-green-400":"text-red-400"}`,children:s.status}),e.jsx("button",{className:"p-2 bg-gray-700 rounded-lg hover:bg-gray-600",children:e.jsx(G,{className:"h-4 w-4 text-gray-300"})})]})]})},s.id))})]})]})})};export{ae as default};
