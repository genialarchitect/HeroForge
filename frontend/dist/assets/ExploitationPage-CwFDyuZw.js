import{j as e,b as X,d as I,u as G}from"./vendor-state-DdX3IZQk.js";import{R as ne,r as S,j as be,u as ge}from"./vendor-react-Da1CiaFS.js";import{X as z,K as E,t as U,u as ee,b2 as ae,S as O,aq as oe,N as ce,n as je,p as ye,W as Ne,ax as me,aR as xe,a as he,b9 as pe,B as N,aZ as Q,D as H,ai as B,ab as te,a4 as J,r as Y,A as ie,a8 as se,aU as ve,b1 as de,a1 as Z,aj as ue,H as fe,af as we,v as ke}from"./vendor-ui-D0INE3me.js";import{a3 as P,B as q,d as _e}from"./index-BPYi--Yq.js";import"./vendor-charts-4MaU3c_5.js";const Ce=[{id:"password_spray",name:"Password Spray",description:"Test common passwords against multiple accounts with lockout evasion",category:"credential",icon:e.jsx(E,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium",requirements:["Target IP/hostname","Username list","Password list"]},{id:"kerberoast",name:"Kerberoasting",description:"Extract TGS tickets from Active Directory for offline cracking",category:"credential",icon:e.jsx(O,{className:"h-6 w-6"}),difficulty:"medium",risk:"low",requirements:["Domain credentials","Domain controller access"]},{id:"asrep_roast",name:"AS-REP Roasting",description:"Target accounts without Kerberos pre-authentication",category:"credential",icon:e.jsx(oe,{className:"h-6 w-6"}),difficulty:"medium",risk:"low",requirements:["Domain controller","Username list"]},{id:"smb_relay",name:"SMB Relay",description:"Relay NTLM authentication to other targets",category:"credential",icon:e.jsx(ce,{className:"h-6 w-6"}),difficulty:"hard",risk:"high",requirements:["Network position","Target systems"]},{id:"reverse_shell",name:"Reverse Shell",description:"Generate reverse shell payloads in various formats",category:"payload",icon:e.jsx(U,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium",requirements:["LHOST","LPORT"]},{id:"bind_shell",name:"Bind Shell",description:"Generate bind shell payloads that listen for connections",category:"payload",icon:e.jsx(je,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium",requirements:["LPORT"]},{id:"web_shell",name:"Web Shell",description:"Generate web shells for PHP, ASPX, JSP",category:"payload",icon:e.jsx(ye,{className:"h-6 w-6"}),difficulty:"easy",risk:"high",requirements:["Target web server"]},{id:"meterpreter",name:"Meterpreter",description:"Generate advanced Meterpreter payloads via msfvenom",category:"payload",icon:e.jsx(Ne,{className:"h-6 w-6"}),difficulty:"medium",risk:"high",requirements:["msfvenom installed","LHOST","LPORT"]},{id:"credential_dump",name:"Credential Dump",description:"Extract credentials from memory, registry, or files",category:"post-exploit",icon:e.jsx(me,{className:"h-6 w-6"}),difficulty:"medium",risk:"high",requirements:["Admin/root access","Target system"]},{id:"priv_esc",name:"Privilege Escalation",description:"Check for privilege escalation vectors",category:"post-exploit",icon:e.jsx(xe,{className:"h-6 w-6"}),difficulty:"medium",risk:"medium",requirements:["Target system access"]},{id:"persistence",name:"Persistence",description:"Establish persistent access mechanisms",category:"post-exploit",icon:e.jsx(he,{className:"h-6 w-6"}),difficulty:"hard",risk:"high",requirements:["System access","Admin/root privileges"]},{id:"lateral_movement",name:"Lateral Movement",description:"Move to other systems using Pass-the-Hash, WMI, PsExec",category:"post-exploit",icon:e.jsx(pe,{className:"h-6 w-6"}),difficulty:"hard",risk:"high",requirements:["Credentials/hashes","Network access"]}],Se=({isOpen:_,onClose:w,onSelect:j,msfvenomAvailable:v=!1})=>{const[h,n]=ne.useState("all"),[c,T]=ne.useState("");if(!_)return null;const b=Ce.filter(o=>{const x=h==="all"||o.category===h,d=c===""||o.name.toLowerCase().includes(c.toLowerCase())||o.description.toLowerCase().includes(c.toLowerCase());return x&&d}),s=o=>{switch(o){case"easy":return"bg-green-500/20 text-green-400";case"medium":return"bg-yellow-500/20 text-yellow-400";case"hard":return"bg-red-500/20 text-red-400";default:return"bg-gray-500/20 text-gray-400"}},a=o=>{switch(o){case"low":return"bg-green-500/20 text-green-400";case"medium":return"bg-yellow-500/20 text-yellow-400";case"high":return"bg-red-500/20 text-red-400";default:return"bg-gray-500/20 text-gray-400"}},m=o=>{switch(o){case"credential":return"text-blue-400";case"payload":return"text-green-400";case"post-exploit":return"text-red-400"}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Select Attack Type"}),e.jsx("button",{onClick:w,className:"text-gray-400 hover:text-white p-2 rounded-lg hover:bg-dark-bg transition-colors",children:e.jsx(z,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search attacks...",value:c,onChange:o=>T(o.target.value),className:"flex-1 px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>n("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${h==="all"?"bg-primary text-white":"bg-dark-bg text-gray-400 hover:text-white"}`,children:"All"}),e.jsxs("button",{onClick:()=>n("credential"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${h==="credential"?"bg-blue-500/20 text-blue-400 border border-blue-500/50":"bg-dark-bg text-gray-400 hover:text-white"}`,children:[e.jsx(E,{className:"h-4 w-4"}),"Credentials"]}),e.jsxs("button",{onClick:()=>n("payload"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${h==="payload"?"bg-green-500/20 text-green-400 border border-green-500/50":"bg-dark-bg text-gray-400 hover:text-white"}`,children:[e.jsx(U,{className:"h-4 w-4"}),"Payloads"]}),e.jsxs("button",{onClick:()=>n("post-exploit"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${h==="post-exploit"?"bg-red-500/20 text-red-400 border border-red-500/50":"bg-dark-bg text-gray-400 hover:text-white"}`,children:[e.jsx(ee,{className:"h-4 w-4"}),"Post-Exploit"]})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map(o=>{const x=o.id==="meterpreter"&&!v;return e.jsxs("button",{onClick:()=>!x&&j(o),disabled:x,className:`p-4 rounded-lg border text-left transition-all ${x?"bg-dark-bg/50 border-dark-border opacity-50 cursor-not-allowed":"bg-dark-bg border-dark-border hover:border-primary hover:shadow-lg hover:shadow-primary/10"}`,children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-dark-surface ${m(o.category)}`,children:o.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-white font-medium truncate",children:o.name}),x&&e.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-400 px-2 py-0.5 rounded",children:"msfvenom required"})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1 line-clamp-2",children:o.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${s(o.difficulty)}`,children:o.difficulty}),e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded ${a(o.risk)}`,children:[o.risk," risk"]})]})]})]}),o.requirements&&o.requirements.length>0&&e.jsx("div",{className:"mt-3 pt-3 border-t border-dark-border",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Requires: ",o.requirements.join(", ")]})})]},o.id)})}),b.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ae,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No attacks match your search"})]})]}),e.jsx("div",{className:"p-4 border-t border-dark-border bg-dark-bg/50",children:e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Select an attack type to configure and execute. All actions are logged for audit purposes."})})]})})},Pe=[{value:"smb",label:"SMB (445)",description:"Windows file sharing"},{value:"ldap",label:"LDAP (389/636)",description:"Active Directory"},{value:"rdp",label:"RDP (3389)",description:"Remote Desktop"},{value:"ssh",label:"SSH (22)",description:"Secure Shell"},{value:"http_basic",label:"HTTP Basic",description:"Basic authentication"},{value:"http_ntlm",label:"HTTP NTLM",description:"NTLM over HTTP"},{value:"kerberos",label:"Kerberos (88)",description:"Kerberos auth"},{value:"winrm",label:"WinRM (5985/5986)",description:"Windows Remote Management"}],Te=["Password1!","Welcome1!","Summer2024!","Winter2024!","Spring2024!","Fall2024!","Company123!","Qwerty123!","Password123","Welcome123","Admin123!","User123!"],Ae=({isOpen:_,onClose:w,onSuccess:j,onCampaignCreated:v})=>{const h=X(),[n,c]=S.useState(1),[T,b]=S.useState(!1),[s,a]=S.useState({name:"",targets:[""],usernames:[""],passwords:[""],protocol:"smb",domain:"",delay_between_attempts_ms:1e3,delay_between_users_ms:5e3,max_attempts_per_user:3,stop_on_success:!1,threads:5}),m=I({mutationFn:async()=>(await P.createCampaign({name:s.name||`Password Spray - ${new Date().toLocaleString()}`,attack_type:"password_spray",config:{protocol:s.protocol,domain:s.domain||null,usernames:s.usernames.filter(i=>i.trim()),passwords:s.passwords.filter(i=>i.trim()),delay_between_attempts_ms:s.delay_between_attempts_ms,delay_between_users_ms:s.delay_between_users_ms,max_attempts_per_user:s.max_attempts_per_user,stop_on_success:s.stop_on_success,threads:s.threads},targets:s.targets.filter(i=>i.trim())})).data,onSuccess:async r=>{if(T)try{await P.startCampaign(r.id,!0),N.success("Campaign created and started!")}catch{N.success("Campaign created. Start it manually to begin.")}else N.success("Campaign created. Authorize to start.");h.invalidateQueries({queryKey:["exploitation-campaigns"]}),h.invalidateQueries({queryKey:["exploitation-status"]}),j==null||j(),v==null||v(r.id),w()},onError:r=>{var i,u;N.error(((u=(i=r.response)==null?void 0:i.data)==null?void 0:u.error)||"Failed to create campaign")}}),o=()=>a({...s,targets:[...s.targets,""]}),x=r=>{const i=s.targets.filter((u,t)=>t!==r);a({...s,targets:i.length?i:[""]})},d=(r,i)=>{const u=[...s.targets];u[r]=i,a({...s,targets:u})},C=()=>a({...s,usernames:[...s.usernames,""]}),L=r=>{const i=s.usernames.filter((u,t)=>t!==r);a({...s,usernames:i.length?i:[""]})},y=(r,i)=>{const u=[...s.usernames];u[r]=i,a({...s,usernames:u})},M=()=>a({...s,passwords:[...s.passwords,""]}),$=r=>{const i=s.passwords.filter((u,t)=>t!==r);a({...s,passwords:i.length?i:[""]})},k=(r,i)=>{const u=[...s.passwords];u[r]=i,a({...s,passwords:u})},D=()=>{a({...s,passwords:Te})},K=r=>i=>{var f;const u=(f=i.target.files)==null?void 0:f[0];if(!u)return;const t=new FileReader;t.onload=R=>{var le;const W=((le=R.target)==null?void 0:le.result).split(`
`).map(V=>V.trim()).filter(V=>V);a({...s,[r]:W})},t.readAsText(u)};if(!_)return null;const l=s.targets.filter(r=>r.trim()).length,p=s.usernames.filter(r=>r.trim()).length,g=s.passwords.filter(r=>r.trim()).length,A=l*p*g,F=Math.ceil(A*s.delay_between_attempts_ms/1e3/60);return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5 text-blue-400"}),"Password Spray Attack"]}),e.jsx("button",{onClick:w,className:"text-gray-400 hover:text-white",children:e.jsx(z,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex items-center gap-4 mt-4",children:[1,2,3].map(r=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${n>=r?"bg-primary text-white":"bg-dark-bg text-gray-400 border border-dark-border"}`,children:r}),r<3&&e.jsx("div",{className:`w-16 h-0.5 mx-2 ${n>r?"bg-primary":"bg-dark-border"}`})]},r))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[n===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Campaign Name (Optional)"}),e.jsx("input",{type:"text",value:s.name,onChange:r=>a({...s,name:r.target.value}),placeholder:"Password Spray - Domain Admin Hunt",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Targets"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:K("targets")}),e.jsx(Q,{className:"h-4 w-4 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:o,className:"text-xs text-primary hover:underline",children:[e.jsx(H,{className:"h-4 w-4 inline"})," Add"]})]})]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:s.targets.map((r,i)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:r,onChange:u=>d(i,u.target.value),placeholder:"192.168.1.10 or dc01.domain.local",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),s.targets.length>1&&e.jsx("button",{onClick:()=>x(i),className:"text-red-400 hover:text-red-300 px-2",children:e.jsx(B,{className:"h-4 w-4"})})]},i))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Protocol"}),e.jsx("select",{value:s.protocol,onChange:r=>a({...s,protocol:r.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:Pe.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Domain (Optional)"}),e.jsx("input",{type:"text",value:s.domain,onChange:r=>a({...s,domain:r.target.value}),placeholder:"CORP or corp.local",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]})]}),n===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Usernames"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:K("usernames")}),e.jsx(Q,{className:"h-4 w-4 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:C,className:"text-xs text-primary hover:underline",children:[e.jsx(H,{className:"h-4 w-4 inline"})," Add"]})]})]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:s.usernames.map((r,i)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:r,onChange:u=>y(i,u.target.value),placeholder:"administrator",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),s.usernames.length>1&&e.jsx("button",{onClick:()=>L(i),className:"text-red-400 hover:text-red-300 px-2",children:e.jsx(B,{className:"h-4 w-4"})})]},i))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Passwords"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:D,className:"text-xs text-yellow-400 hover:underline",children:"Load Common"}),e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:K("passwords")}),e.jsx(Q,{className:"h-4 w-4 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:M,className:"text-xs text-primary hover:underline",children:[e.jsx(H,{className:"h-4 w-4 inline"})," Add"]})]})]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:s.passwords.map((r,i)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:r,onChange:u=>k(i,u.target.value),placeholder:"Password123!",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),s.passwords.length>1&&e.jsx("button",{onClick:()=>$(i),className:"text-red-400 hover:text-red-300 px-2",children:e.jsx(B,{className:"h-4 w-4"})})]},i))})]})]}),n===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4 border border-dark-border",children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-yellow-400"}),"Lockout Protection"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Delay Between Attempts (ms)"}),e.jsx("input",{type:"number",value:s.delay_between_attempts_ms,onChange:r=>a({...s,delay_between_attempts_ms:parseInt(r.target.value)||1e3}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Delay Between Users (ms)"}),e.jsx("input",{type:"number",value:s.delay_between_users_ms,onChange:r=>a({...s,delay_between_users_ms:parseInt(r.target.value)||5e3}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Max Attempts Per User"}),e.jsx("input",{type:"number",value:s.max_attempts_per_user,onChange:r=>a({...s,max_attempts_per_user:parseInt(r.target.value)||3}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Threads"}),e.jsx("input",{type:"number",value:s.threads,onChange:r=>a({...s,threads:parseInt(r.target.value)||5}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"stop-on-success",checked:s.stop_on_success,onChange:r=>a({...s,stop_on_success:r.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary"}),e.jsx("label",{htmlFor:"stop-on-success",className:"text-gray-300 text-sm",children:"Stop on first successful authentication"})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-blue-400 font-medium mb-2 flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),"Attack Summary"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Targets:"}),e.jsx("span",{className:"text-white ml-2",children:l})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Usernames:"}),e.jsx("span",{className:"text-white ml-2",children:p})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Passwords:"}),e.jsx("span",{className:"text-white ml-2",children:g})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Total Attempts:"}),e.jsx("span",{className:"text-white ml-2",children:A.toLocaleString()})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-400",children:"Estimated Time:"}),e.jsxs("span",{className:"text-white ml-2",children:["~",F," minutes"]})]})]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",id:"authorized",checked:T,onChange:r=>b(r.target.checked),className:"w-4 h-4 mt-1 rounded border-yellow-500 bg-dark-bg text-yellow-500"}),e.jsxs("label",{htmlFor:"authorized",className:"text-sm",children:[e.jsx("span",{className:"text-yellow-400 font-medium",children:"Authorization Required"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"I am authorized to perform this security test against the specified targets. I understand that unauthorized access attempts are illegal."})]})]})})]})]}),e.jsxs("div",{className:"p-4 border-t border-dark-border flex justify-between",children:[e.jsx(q,{variant:"secondary",onClick:()=>n>1?c(n-1):w(),children:n>1?"Back":"Cancel"}),e.jsx(q,{variant:"primary",onClick:()=>{n<3?c(n+1):m.mutate()},disabled:n===1&&l===0||n===2&&(p===0||g===0)||n===3&&!T||m.isPending,children:n<3?"Next":m.isPending?"Creating...":"Start Attack"})]})]})})},qe=({isOpen:_,onClose:w,onSuccess:j,onCampaignCreated:v,attackType:h})=>{const n=X(),[c,T]=S.useState(1),[b,s]=S.useState(!1),[a,m]=S.useState({name:"",domain_controller:"",domain:"",username:"",password:"",ntlm_hash:"",use_hash:!1,target_spns:[""],enumerate_spns:!0,usernames:[""],enumerate_users:!1,output_format:"hashcat",request_rc4:!0}),o=I({mutationFn:async()=>{const l=h==="kerberoast"?{domain_controller:a.domain_controller,domain:a.domain,username:a.username,password:a.use_hash?null:a.password,ntlm_hash:a.use_hash?a.ntlm_hash:null,target_spns:a.enumerate_spns?null:a.target_spns.filter(g=>g.trim()),output_format:a.output_format,request_rc4:a.request_rc4}:{domain_controller:a.domain_controller,domain:a.domain,usernames:a.enumerate_users?[]:a.usernames.filter(g=>g.trim()),enumerate_users:a.enumerate_users,output_format:a.output_format};return(await P.createCampaign({name:a.name||`${h==="kerberoast"?"Kerberoast":"AS-REP Roast"} - ${new Date().toLocaleString()}`,attack_type:h,config:l,targets:[a.domain_controller]})).data},onSuccess:async l=>{if(b)try{await P.startCampaign(l.id,!0),N.success("Kerberos attack started!")}catch{N.success("Campaign created. Start manually to begin.")}else N.success("Campaign created.");n.invalidateQueries({queryKey:["exploitation-campaigns"]}),n.invalidateQueries({queryKey:["exploitation-status"]}),j==null||j(),v==null||v(l.id),w()},onError:l=>{var p,g;N.error(((g=(p=l.response)==null?void 0:p.data)==null?void 0:g.error)||"Failed to create campaign")}}),x=()=>m({...a,target_spns:[...a.target_spns,""]}),d=l=>{const p=a.target_spns.filter((g,A)=>A!==l);m({...a,target_spns:p.length?p:[""]})},C=(l,p)=>{const g=[...a.target_spns];g[l]=p,m({...a,target_spns:g})},L=()=>m({...a,usernames:[...a.usernames,""]}),y=l=>{const p=a.usernames.filter((g,A)=>A!==l);m({...a,usernames:p.length?p:[""]})},M=(l,p)=>{const g=[...a.usernames];g[l]=p,m({...a,usernames:g})},$=l=>p=>{var F;const g=(F=p.target.files)==null?void 0:F[0];if(!g)return;const A=new FileReader;A.onload=r=>{var t;const u=((t=r.target)==null?void 0:t.result).split(`
`).map(f=>f.trim()).filter(f=>f);m({...a,[l]:u})},A.readAsText(g)};if(!_)return null;const k=h==="kerberoast",D=k?"Kerberoasting Attack":"AS-REP Roasting Attack",K=k?e.jsx(O,{className:"h-5 w-5 text-purple-400"}):e.jsx(oe,{className:"h-5 w-5 text-orange-400"});return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[K,D]}),e.jsx("button",{onClick:w,className:"text-gray-400 hover:text-white",children:e.jsx(z,{className:"h-5 w-5"})})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:k?"Extract TGS tickets for service accounts to crack offline. Targets accounts with SPNs set.":"Target accounts without Kerberos pre-authentication to extract AS-REP hashes."}),e.jsx("div",{className:"flex items-center gap-4 mt-4",children:[1,2].map(l=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${c>=l?k?"bg-purple-500 text-white":"bg-orange-500 text-white":"bg-dark-bg text-gray-400 border border-dark-border"}`,children:l}),l<2&&e.jsx("div",{className:`w-16 h-0.5 mx-2 ${c>l?k?"bg-purple-500":"bg-orange-500":"bg-dark-border"}`})]},l))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[c===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Campaign Name (Optional)"}),e.jsx("input",{type:"text",value:a.name,onChange:l=>m({...a,name:l.target.value}),placeholder:`${k?"Kerberoast":"AS-REP Roast"} - SQL Admins`,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Domain Controller"}),e.jsx("input",{type:"text",value:a.domain_controller,onChange:l=>m({...a,domain_controller:l.target.value}),placeholder:"dc01.corp.local or 192.168.1.10",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Domain"}),e.jsx("input",{type:"text",value:a.domain,onChange:l=>m({...a,domain:l.target.value}),placeholder:"corp.local",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]}),k&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4 text-yellow-400"}),"Authentication"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Username"}),e.jsx("input",{type:"text",value:a.username,onChange:l=>m({...a,username:l.target.value}),placeholder:"domain_user",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:!a.use_hash,onChange:()=>m({...a,use_hash:!1}),className:"text-primary"}),"Use Password"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:a.use_hash,onChange:()=>m({...a,use_hash:!0}),className:"text-primary"}),"Use NTLM Hash"]})]}),a.use_hash?e.jsx("input",{type:"text",value:a.ntlm_hash,onChange:l=>m({...a,ntlm_hash:l.target.value}),placeholder:"AABBCCDD11223344:EEFFGGHHII556677",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white font-mono text-sm"}):e.jsx("input",{type:"password",value:a.password,onChange:l=>m({...a,password:l.target.value}),placeholder:"Password",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]}),e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Target SPNs"}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("input",{type:"checkbox",id:"enumerate-spns",checked:a.enumerate_spns,onChange:l=>m({...a,enumerate_spns:l.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary"}),e.jsx("label",{htmlFor:"enumerate-spns",className:"text-gray-300 text-sm",children:"Enumerate all SPNs automatically"})]}),!a.enumerate_spns&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Specify target SPNs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:$("target_spns")}),e.jsx(Q,{className:"h-3 w-3 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:x,className:"text-xs text-primary hover:underline",children:[e.jsx(H,{className:"h-3 w-3 inline"})," Add"]})]})]}),a.target_spns.map((l,p)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:g=>C(p,g.target.value),placeholder:"MSSQLSvc/sql01.corp.local:1433",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm font-mono"}),a.target_spns.length>1&&e.jsx("button",{onClick:()=>d(p),className:"text-red-400 px-2",children:e.jsx(B,{className:"h-4 w-4"})})]},p))]})]})]}),!k&&e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Target Users"}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("input",{type:"checkbox",id:"enumerate-users",checked:a.enumerate_users,onChange:l=>m({...a,enumerate_users:l.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary"}),e.jsx("label",{htmlFor:"enumerate-users",className:"text-gray-300 text-sm",children:"Enumerate users without pre-auth automatically"})]}),!a.enumerate_users&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Specify target usernames"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"text-xs text-primary cursor-pointer hover:underline",children:[e.jsx("input",{type:"file",accept:".txt",className:"hidden",onChange:$("usernames")}),e.jsx(Q,{className:"h-3 w-3 inline mr-1"}),"Import"]}),e.jsxs("button",{onClick:L,className:"text-xs text-primary hover:underline",children:[e.jsx(H,{className:"h-3 w-3 inline"})," Add"]})]})]}),a.usernames.map((l,p)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:g=>M(p,g.target.value),placeholder:"svc_backup",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white text-sm"}),a.usernames.length>1&&e.jsx("button",{onClick:()=>y(p),className:"text-red-400 px-2",children:e.jsx(B,{className:"h-4 w-4"})})]},p))]})]})]}),c===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4 border border-dark-border",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Output Options"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Hash Format"}),e.jsxs("select",{value:a.output_format,onChange:l=>m({...a,output_format:l.target.value}),className:"w-full px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"hashcat",children:"Hashcat"}),e.jsx("option",{value:"john",children:"John the Ripper"})]})]}),k&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"request-rc4",checked:a.request_rc4,onChange:l=>m({...a,request_rc4:l.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary mr-3"}),e.jsx("label",{htmlFor:"request-rc4",className:"text-gray-300 text-sm",children:"Request RC4 encryption (easier to crack)"})]})]})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${k?"bg-purple-500/10 border-purple-500/30":"bg-orange-500/10 border-orange-500/30"}`,children:[e.jsxs("h4",{className:`font-medium mb-2 flex items-center gap-2 ${k?"text-purple-400":"text-orange-400"}`,children:[e.jsx(te,{className:"h-4 w-4"}),"Attack Summary"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Domain Controller:"}),e.jsx("span",{className:"text-white ml-2",children:a.domain_controller||"Not set"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Domain:"}),e.jsx("span",{className:"text-white ml-2",children:a.domain||"Not set"})]}),k&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Authentication:"}),e.jsxs("span",{className:"text-white ml-2",children:[a.username," (",a.use_hash?"NTLM Hash":"Password",")"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"SPNs:"}),e.jsx("span",{className:"text-white ml-2",children:a.enumerate_spns?"Auto-enumerate":`${a.target_spns.filter(l=>l.trim()).length} specified`})]})]}),!k&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Users:"}),e.jsx("span",{className:"text-white ml-2",children:a.enumerate_users?"Auto-enumerate":`${a.usernames.filter(l=>l.trim()).length} specified`})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Output Format:"}),e.jsx("span",{className:"text-white ml-2 capitalize",children:a.output_format})]})]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",id:"authorized",checked:b,onChange:l=>s(l.target.checked),className:"w-4 h-4 mt-1 rounded border-yellow-500 bg-dark-bg text-yellow-500"}),e.jsxs("label",{htmlFor:"authorized",className:"text-sm",children:[e.jsx("span",{className:"text-yellow-400 font-medium",children:"Authorization Required"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"I am authorized to perform this Active Directory security test. Extracted hashes will be used for authorized security assessment only."})]})]})})]})]}),e.jsxs("div",{className:"p-4 border-t border-dark-border flex justify-between",children:[e.jsx(q,{variant:"secondary",onClick:()=>c>1?T(c-1):w(),children:c>1?"Back":"Cancel"}),e.jsx(q,{variant:"primary",onClick:()=>{c<2?T(c+1):o.mutate()},disabled:c===1&&(!a.domain_controller||!a.domain)||c===1&&k&&(!a.username||!a.password&&!a.ntlm_hash)||c===2&&!b||o.isPending,children:c<2?"Next":o.isPending?"Creating...":"Start Attack"})]})]})})},Re={credential_dump:{title:"Credential Dump",icon:e.jsx(me,{className:"h-6 w-6 text-red-400"}),description:"Extract credentials from memory, registry, or files on the target system.",modules:[{value:"dump_sam",label:"SAM Database",description:"Extract local account hashes from SAM"},{value:"dump_lsass",label:"LSASS Memory",description:"Dump credentials from LSASS process"},{value:"browser_creds",label:"Browser Credentials",description:"Extract saved passwords from browsers"},{value:"wifi_passwords",label:"WiFi Passwords",description:"Extract saved WiFi passwords"},{value:"keepass",label:"KeePass Databases",description:"Find and extract KeePass databases"}]},priv_esc:{title:"Privilege Escalation",icon:e.jsx(xe,{className:"h-6 w-6 text-yellow-400"}),description:"Check for privilege escalation vectors on the target system.",modules:[{value:"always_install_elevated",label:"AlwaysInstallElevated",description:"Check for AlwaysInstallElevated policy"},{value:"unquoted_paths",label:"Unquoted Service Paths",description:"Find unquoted service paths"},{value:"weak_service_perms",label:"Weak Service Permissions",description:"Check for modifiable services"},{value:"se_impersonate",label:"SeImpersonate",description:"Check for token impersonation privileges"},{value:"sudoers",label:"Sudoers Check",description:"Analyze sudo configuration (Linux)"},{value:"suid_binaries",label:"SUID Binaries",description:"Find SUID/SGID binaries (Linux)"}]},persistence:{title:"Persistence",icon:e.jsx(he,{className:"h-6 w-6 text-purple-400"}),description:"Establish persistent access mechanisms on the target system.",modules:[{value:"scheduled_task",label:"Scheduled Task",description:"Create a scheduled task for persistence"},{value:"registry_run",label:"Registry Run Key",description:"Add registry run key for startup"},{value:"service",label:"Windows Service",description:"Create a Windows service"},{value:"cron_job",label:"Cron Job",description:"Add cron job for persistence (Linux)"},{value:"ssh_key",label:"SSH Key",description:"Add SSH authorized key (Linux)"}]},lateral_movement:{title:"Lateral Movement",icon:e.jsx(pe,{className:"h-6 w-6 text-blue-400"}),description:"Move to other systems using various techniques.",modules:[{value:"pass_the_hash",label:"Pass-the-Hash",description:"Authenticate using NTLM hash"},{value:"pass_the_ticket",label:"Pass-the-Ticket",description:"Authenticate using Kerberos ticket"},{value:"psexec",label:"PsExec",description:"Execute commands via PsExec"},{value:"wmi_exec",label:"WMI Exec",description:"Execute commands via WMI"},{value:"ssh_pivot",label:"SSH Pivot",description:"Pivot through SSH connections"}]},smb_relay:{title:"SMB Relay",icon:e.jsx(ce,{className:"h-6 w-6 text-orange-400"}),description:"Relay NTLM authentication to other targets for credential theft or command execution.",modules:[{value:"ntlm_relay",label:"NTLM Relay",description:"Relay NTLM auth to target SMB"},{value:"ldap_relay",label:"LDAP Relay",description:"Relay to LDAP for account takeover"},{value:"http_relay",label:"HTTP Relay",description:"Relay to HTTP endpoints"}]}},Le=({isOpen:_,onClose:w,onSuccess:j,onCampaignCreated:v,attackType:h})=>{var x;const n=X(),[c,T]=S.useState(!1),b=Re[h],[s,a]=S.useState({name:"",target:"",module:((x=b.modules[0])==null?void 0:x.value)||"",username:"",password:"",ntlm_hash:"",use_hash:!1,options:{}}),m=I({mutationFn:async()=>(await P.createCampaign({name:s.name||`${b.title} - ${new Date().toLocaleString()}`,attack_type:h,config:{module:s.module,username:s.username||null,password:s.use_hash?null:s.password,ntlm_hash:s.use_hash?s.ntlm_hash:null,options:s.options},targets:[s.target]})).data,onSuccess:async d=>{if(c)try{await P.startCampaign(d.id,!0),N.success(`${b.title} campaign started!`)}catch{N.success("Campaign created. Start manually to begin.")}else N.success("Campaign created.");n.invalidateQueries({queryKey:["exploitation-campaigns"]}),n.invalidateQueries({queryKey:["exploitation-status"]}),j==null||j(),v==null||v(d.id),w()},onError:d=>{var C,L;N.error(((L=(C=d.response)==null?void 0:C.data)==null?void 0:L.error)||"Failed to create campaign")}});if(!_)return null;const o=b.modules.find(d=>d.value===s.module);return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-dark-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[b.icon,e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:b.title}),e.jsx("p",{className:"text-gray-400 text-sm",children:b.description})]})]}),e.jsx("button",{onClick:w,className:"text-gray-400 hover:text-white p-2 rounded-lg hover:bg-dark-bg",children:e.jsx(z,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Campaign Name (optional)"}),e.jsx("input",{type:"text",value:s.name,onChange:d=>a({...s,name:d.target.value}),placeholder:`${b.title} - ${new Date().toLocaleDateString()}`,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Target ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:s.target,onChange:d=>a({...s,target:d.target.value}),placeholder:"192.168.1.100 or hostname",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Module"}),e.jsx("select",{value:s.module,onChange:d=>a({...s,module:d.target.value}),className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-primary",children:b.modules.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))}),o&&e.jsxs("p",{className:"mt-2 text-sm text-gray-400 flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),o.description]})]}),(h==="lateral_movement"||h==="smb_relay")&&e.jsxs("div",{className:"space-y-4 p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h4",{className:"text-white font-medium flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"Credentials"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Username"}),e.jsx("input",{type:"text",value:s.username,onChange:d=>a({...s,username:d.target.value}),placeholder:"DOMAIN\\\\username or username@domain",className:"w-full px-4 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:!s.use_hash,onChange:()=>a({...s,use_hash:!1}),className:"text-primary"}),e.jsx("span",{className:"text-gray-300",children:"Password"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:s.use_hash,onChange:()=>a({...s,use_hash:!0}),className:"text-primary"}),e.jsx("span",{className:"text-gray-300",children:"NTLM Hash"})]})]}),s.use_hash?e.jsx("input",{type:"text",value:s.ntlm_hash,onChange:d=>a({...s,ntlm_hash:d.target.value}),placeholder:"aad3b435b51404eeaad3b435b51404ee:hash",className:"w-full px-4 py-2 bg-dark-surface border border-dark-border rounded-lg text-white font-mono"}):e.jsx("input",{type:"password",value:s.password,onChange:d=>a({...s,password:d.target.value}),placeholder:"Password",className:"w-full px-4 py-2 bg-dark-surface border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:[e.jsx(J,{className:"h-5 w-5 text-red-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400 font-medium",children:"Authorization Required"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"This action may modify system configuration, access sensitive data, or execute commands on target systems. Ensure you have explicit written authorization before proceeding."})]})]}),e.jsxs("label",{className:"flex items-start gap-3 p-4 bg-dark-bg border border-dark-border rounded-lg cursor-pointer hover:border-primary transition-colors",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:d=>T(d.target.checked),className:"mt-1 h-4 w-4 text-primary rounded border-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"I am authorized to perform this test"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"I confirm that I have written authorization from the system owner to perform post-exploitation activities on the specified target(s). I understand that unauthorized access is illegal."})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-dark-border flex justify-end gap-3",children:[e.jsx(q,{variant:"secondary",onClick:w,children:"Cancel"}),e.jsx(q,{variant:"primary",onClick:()=>m.mutate(),disabled:!s.target||!c||m.isPending,children:m.isPending?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[b.icon,e.jsx("span",{className:"ml-2",children:"Create & Start Campaign"})]})})]})]})})},Ie=()=>{const{tab:_}=be(),w=ge(),j=X(),[v,h]=S.useState("dashboard"),[n,c]=S.useState(!1),[T,b]=S.useState(!1),[s,a]=S.useState(null),[m,o]=S.useState(null);S.useEffect(()=>{if(!_){h("dashboard");return}switch(_){case"password-spray":a({id:"password_spray",name:"Password Spray",description:"Test common passwords against multiple accounts",category:"credential",icon:e.jsx(E,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium"});break;case"kerberos":a({id:"kerberoast",name:"Kerberoasting",description:"Extract TGS tickets for offline cracking",category:"credential",icon:e.jsx(O,{className:"h-6 w-6"}),difficulty:"medium",risk:"low"});break;case"shells":h("shells");break;case"post-exploit":h("modules");break;case"campaigns":h("campaigns");break;default:h("dashboard")}},[_]);const[x,d]=S.useState({shell_type:"reverse_shell",platform:"linux",format:"bash",lhost:"",lport:4444,encoding:"none",obfuscation_level:0,staged:!1}),[C,L]=S.useState(null),{data:y}=G({queryKey:["exploitation-status"],queryFn:async()=>(await P.getStatus()).data}),{data:M=[]}=G({queryKey:["exploitation-campaigns"],queryFn:async()=>(await P.listCampaigns()).data}),{data:$=[]}=G({queryKey:["shell-templates"],queryFn:async()=>(await P.listShellTemplates()).data}),{data:k=[]}=G({queryKey:["post-exploit-modules"],queryFn:async()=>(await P.listModules()).data}),D=I({mutationFn:async t=>(await P.generateShell(t)).data,onSuccess:t=>{L(t),N.success("Shell payload generated!"),j.invalidateQueries({queryKey:["exploitation-status"]})},onError:t=>{var f,R;N.error(((R=(f=t.response)==null?void 0:f.data)==null?void 0:R.message)||"Failed to generate shell")}}),K=I({mutationFn:async t=>{await P.deleteCampaign(t)},onSuccess:()=>{N.success("Campaign deleted"),j.invalidateQueries({queryKey:["exploitation-campaigns"]})}}),l=I({mutationFn:async({id:t,authorized:f})=>{await P.startCampaign(t,f)},onSuccess:()=>{N.success("Campaign started"),j.invalidateQueries({queryKey:["exploitation-campaigns"]}),j.invalidateQueries({queryKey:["exploitation-status"]})},onError:t=>{var f,R;N.error(((R=(f=t.response)==null?void 0:f.data)==null?void 0:R.message)||"Failed to start campaign")}}),p=I({mutationFn:async t=>{await P.stopCampaign(t)},onSuccess:()=>{N.success("Campaign stopped"),j.invalidateQueries({queryKey:["exploitation-campaigns"]}),j.invalidateQueries({queryKey:["exploitation-status"]})}}),g=t=>{if(b(!1),["reverse_shell","bind_shell","web_shell","meterpreter"].includes(t.id)){const f={reverse_shell:"reverse_shell",bind_shell:"bind_shell",web_shell:"web_shell",meterpreter:"reverse_shell"},R={reverse_shell:"bash",bind_shell:"bash",web_shell:"php",meterpreter:"meterpreter_exe"};d({...x,shell_type:f[t.id]||"reverse_shell",format:R[t.id]||"bash"}),c(!0);return}a(t)},A=t=>{a(null),j.invalidateQueries({queryKey:["exploitation-campaigns"]}),j.invalidateQueries({queryKey:["exploitation-status"]}),h("campaigns"),w("/exploitation/campaigns"),N.success("Campaign created successfully!")},F=()=>{a(null),w("/exploitation")},r=t=>{navigator.clipboard.writeText(t),N.success("Copied to clipboard!")},i=t=>{switch(t){case"running":return"text-yellow-400";case"completed":return"text-green-400";case"failed":return"text-red-400";case"cancelled":return"text-gray-400";default:return"text-blue-400"}},u=t=>{switch(t){case"running":return e.jsx(ie,{className:"h-4 w-4 animate-pulse"});case"completed":return e.jsx(se,{className:"h-4 w-4"});case"failed":return e.jsx(J,{className:"h-4 w-4"});case"cancelled":return e.jsx(de,{className:"h-4 w-4"});default:return e.jsx(fe,{className:"h-4 w-4"})}};return e.jsx(_e,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(Y,{className:"h-7 w-7 text-red-500"}),"Exploitation Framework"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Password spraying, Kerberos attacks, shell generation, and post-exploitation"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(q,{variant:"secondary",onClick:()=>c(!0),children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Generate Shell"]}),e.jsxs(q,{variant:"primary",onClick:()=>b(!0),children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"New Campaign"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Active Campaigns"}),e.jsx(ie,{className:"h-5 w-5 text-yellow-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(y==null?void 0:y.active_campaigns)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Total Campaigns"}),e.jsx(Y,{className:"h-5 w-5 text-blue-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(y==null?void 0:y.total_campaigns)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Credentials Found"}),e.jsx(E,{className:"h-5 w-5 text-green-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(y==null?void 0:y.credentials_stored)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Payloads Generated"}),e.jsx(U,{className:"h-5 w-5 text-purple-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:(y==null?void 0:y.payloads_generated)??0})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Msfvenom"}),y!=null&&y.msfvenom_available?e.jsx(se,{className:"h-5 w-5 text-green-400"}):e.jsx(J,{className:"h-5 w-5 text-yellow-400"})]}),e.jsx("p",{className:"text-sm font-medium text-white mt-2",children:y!=null&&y.msfvenom_available?"Available":"Not Found"})]})]}),e.jsx("div",{className:"border-b border-dark-border",children:e.jsx("nav",{className:"flex gap-4",children:["dashboard","campaigns","shells","modules"].map(t=>e.jsx("button",{onClick:()=>h(t),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${v===t?"border-primary text-primary":"border-transparent text-gray-400 hover:text-white"}`,children:t.charAt(0).toUpperCase()+t.slice(1)},t))})}),v==="dashboard"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Recent Campaigns"}),M.length===0?e.jsx("p",{className:"text-gray-400 text-sm",children:"No campaigns yet"}):e.jsx("div",{className:"space-y-3",children:M.slice(0,5).map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-bg rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:t.attack_type})]}),e.jsxs("div",{className:`flex items-center gap-2 ${i(t.status)}`,children:[u(t.status),e.jsx("span",{className:"text-sm capitalize",children:t.status})]})]},t.id))})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>a({id:"password_spray",name:"Password Spray",description:"Test common passwords against multiple accounts",category:"credential",icon:e.jsx(E,{className:"h-6 w-6"}),difficulty:"easy",risk:"medium"}),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(E,{className:"h-6 w-6 text-blue-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Password Spray"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Credential testing"})]}),e.jsxs("button",{onClick:()=>a({id:"kerberoast",name:"Kerberoasting",description:"Extract TGS tickets for offline cracking",category:"credential",icon:e.jsx(O,{className:"h-6 w-6"}),difficulty:"medium",risk:"low"}),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(O,{className:"h-6 w-6 text-purple-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Kerberoast"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Extract TGS tickets"})]}),e.jsxs("button",{onClick:()=>c(!0),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(U,{className:"h-6 w-6 text-green-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Shell Generator"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Create payloads"})]}),e.jsxs("button",{onClick:()=>h("modules"),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors text-left",children:[e.jsx(ee,{className:"h-6 w-6 text-red-400 mb-2"}),e.jsx("p",{className:"text-white font-medium",children:"Post-Exploit"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Modules & tools"})]})]})]})]}),v==="campaigns"&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg",children:[e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Campaigns"})}),M.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Y,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No campaigns yet"}),e.jsx(q,{variant:"primary",className:"mt-4",onClick:()=>b(!0),children:"Create First Campaign"})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-400 text-sm border-b border-dark-border",children:[e.jsx("th",{className:"p-4",children:"Name"}),e.jsx("th",{className:"p-4",children:"Type"}),e.jsx("th",{className:"p-4",children:"Status"}),e.jsx("th",{className:"p-4",children:"Targets"}),e.jsx("th",{className:"p-4",children:"Results"}),e.jsx("th",{className:"p-4",children:"Created"}),e.jsx("th",{className:"p-4",children:"Actions"})]})}),e.jsx("tbody",{children:M.map(t=>e.jsxs("tr",{className:"border-b border-dark-border hover:bg-dark-bg",children:[e.jsx("td",{className:"p-4 text-white font-medium",children:t.name}),e.jsx("td",{className:"p-4 text-gray-300",children:t.attack_type}),e.jsx("td",{className:"p-4",children:e.jsxs("span",{className:`flex items-center gap-2 ${i(t.status)}`,children:[u(t.status),e.jsx("span",{className:"capitalize",children:t.status})]})}),e.jsx("td",{className:"p-4 text-gray-300",children:t.targets.length}),e.jsxs("td",{className:"p-4",children:[e.jsx("span",{className:"text-green-400",children:t.successful_count}),e.jsxs("span",{className:"text-gray-500",children:[" / ",t.results_count]})]}),e.jsx("td",{className:"p-4 text-gray-400 text-sm",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.status==="pending"&&e.jsx("button",{onClick:()=>l.mutate({id:t.id,authorized:!0}),className:"text-green-400 hover:text-green-300 p-2",title:"Start Campaign",children:e.jsx(ve,{className:"h-4 w-4"})}),t.status==="running"&&e.jsx("button",{onClick:()=>p.mutate(t.id),className:"text-yellow-400 hover:text-yellow-300 p-2",title:"Stop Campaign",children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>o(t.id),className:"text-blue-400 hover:text-blue-300 p-2",title:"View Results",children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>K.mutate(t.id),className:"text-red-400 hover:text-red-300 p-2",title:"Delete Campaign",children:e.jsx(B,{className:"h-4 w-4"})})]})})]},t.id))})]})]}),v==="shells"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Shell Templates"}),e.jsx("div",{className:"space-y-3",children:$.map((t,f)=>e.jsx("div",{className:"p-3 bg-dark-bg rounded-lg border border-dark-border hover:border-primary cursor-pointer transition-colors",onClick:()=>{d({...x,format:t.format.toLowerCase(),platform:t.platform.toLowerCase()}),c(!0)},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:t.description})]}),t.requires_msfvenom&&e.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-400 px-2 py-1 rounded",children:"msfvenom"})]})},f))})]}),C&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Generated Payload"}),e.jsx("button",{onClick:()=>L(null),className:"text-gray-400 hover:text-white",children:e.jsx(z,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Payload"}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-dark-bg p-3 rounded-lg text-green-400 text-sm overflow-x-auto max-h-48",children:C.payload}),e.jsx("button",{onClick:()=>r(C.payload),className:"absolute top-2 right-2 text-gray-400 hover:text-white",children:e.jsx(Z,{className:"h-4 w-4"})})]})]}),C.one_liner&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"One-Liner"}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-dark-bg p-3 rounded-lg text-blue-400 text-sm overflow-x-auto",children:C.one_liner}),e.jsx("button",{onClick:()=>r(C.one_liner),className:"absolute top-2 right-2 text-gray-400 hover:text-white",children:e.jsx(Z,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Listener Command"}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-dark-bg p-3 rounded-lg text-yellow-400 text-sm",children:C.listener_command}),e.jsx("button",{onClick:()=>r(C.listener_command),className:"absolute top-2 right-2 text-gray-400 hover:text-white",children:e.jsx(Z,{className:"h-4 w-4"})})]})]})]})]})]}),v==="modules"&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Post-Exploitation Modules"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map((t,f)=>{const re={credential_harvesting:"credential_dump",privilege_escalation:"priv_esc",persistence:"persistence",lateral_movement:"lateral_movement"}[t.category]||"credential_dump";return e.jsxs("div",{onClick:()=>a({id:re,name:t.name,description:t.description,category:"post-exploit",icon:e.jsx(ee,{className:"h-6 w-6"}),difficulty:"medium",risk:"high"}),className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary cursor-pointer transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.name}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:t.description})]})}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-1 rounded",children:t.category}),t.platforms.map(W=>e.jsx("span",{className:"text-xs bg-gray-500/20 text-gray-400 px-2 py-1 rounded",children:W},W))]})]},f)})})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-green-400"}),"Shell Generator"]}),e.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-white",children:e.jsx(z,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Shell Type"}),e.jsxs("select",{value:x.shell_type,onChange:t=>d({...x,shell_type:t.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"reverse_shell",children:"Reverse Shell"}),e.jsx("option",{value:"bind_shell",children:"Bind Shell"}),e.jsx("option",{value:"web_shell",children:"Web Shell"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Platform"}),e.jsxs("select",{value:x.platform,onChange:t=>d({...x,platform:t.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"linux",children:"Linux"}),e.jsx("option",{value:"windows",children:"Windows"}),e.jsx("option",{value:"macos",children:"macOS"}),e.jsx("option",{value:"universal",children:"Universal"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Format"}),e.jsxs("select",{value:x.format,onChange:t=>d({...x,format:t.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"bash",children:"Bash"}),e.jsx("option",{value:"powershell",children:"PowerShell"}),e.jsx("option",{value:"python",children:"Python"}),e.jsx("option",{value:"perl",children:"Perl"}),e.jsx("option",{value:"php",children:"PHP"}),e.jsx("option",{value:"meterpreter_exe",children:"Meterpreter EXE"}),e.jsx("option",{value:"meterpreter_elf",children:"Meterpreter ELF"}),e.jsx("option",{value:"meterpreter_powershell",children:"Meterpreter PowerShell"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"LHOST"}),e.jsx("input",{type:"text",value:x.lhost,onChange:t=>d({...x,lhost:t.target.value}),placeholder:"192.168.1.100",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"LPORT"}),e.jsx("input",{type:"number",value:x.lport,onChange:t=>d({...x,lport:parseInt(t.target.value)||4444}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Encoding"}),e.jsxs("select",{value:x.encoding,onChange:t=>d({...x,encoding:t.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:"none",children:"None"}),e.jsx("option",{value:"base64",children:"Base64"}),e.jsx("option",{value:"hex",children:"Hex"}),e.jsx("option",{value:"xor",children:"XOR"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Obfuscation"}),e.jsxs("select",{value:x.obfuscation_level,onChange:t=>d({...x,obfuscation_level:parseInt(t.target.value)}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white",children:[e.jsx("option",{value:0,children:"None"}),e.jsx("option",{value:1,children:"Light"}),e.jsx("option",{value:2,children:"Medium"}),e.jsx("option",{value:3,children:"Heavy"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-dark-border",children:[e.jsx(q,{variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsxs(q,{variant:"primary",onClick:()=>{D.mutate(x),c(!1)},disabled:!x.lhost||D.isPending,children:[D.isPending?e.jsx(ue,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(U,{className:"h-4 w-4 mr-2"}),"Generate"]})]})]})]})}),e.jsx(Se,{isOpen:T,onClose:()=>b(!1),onSelect:g,msfvenomAvailable:(y==null?void 0:y.msfvenom_available)??!1}),(s==null?void 0:s.id)==="password_spray"&&e.jsx(Ae,{isOpen:!0,onClose:F,onCampaignCreated:A}),((s==null?void 0:s.id)==="kerberoast"||(s==null?void 0:s.id)==="asrep_roast")&&e.jsx(qe,{isOpen:!0,onClose:F,onCampaignCreated:A,attackType:s.id}),((s==null?void 0:s.id)==="credential_dump"||(s==null?void 0:s.id)==="priv_esc"||(s==null?void 0:s.id)==="persistence"||(s==null?void 0:s.id)==="lateral_movement"||(s==null?void 0:s.id)==="smb_relay")&&e.jsx(Le,{isOpen:!0,onClose:F,onCampaignCreated:A,attackType:s.id}),m&&e.jsx(Ee,{campaignId:m,onClose:()=>o(null)})]})})},Ee=({campaignId:_,onClose:w})=>{const{data:j=[],isLoading:v}=G({queryKey:["campaign-results",_],queryFn:async()=>(await P.getCampaignResults(_)).data}),h=async n=>{try{const c=await P.exportResults(_,n),T=new Blob([c.data],{type:n==="json"?"application/json":"text/csv"}),b=URL.createObjectURL(T),s=document.createElement("a");s.href=b,s.download=`campaign-${_}.${n}`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(b),N.success(`Results exported as ${n.toUpperCase()}`)}catch{N.error("Failed to export results")}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-xl w-full max-w-4xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-dark-border flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Campaign Results"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(q,{variant:"secondary",onClick:()=>h("json"),children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"JSON"]}),e.jsxs(q,{variant:"secondary",onClick:()=>h("csv"),children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"CSV"]}),e.jsx("button",{onClick:w,className:"text-gray-400 hover:text-white",children:e.jsx(z,{className:"h-6 w-6"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:v?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ue,{className:"h-8 w-8 text-primary animate-spin"})}):j.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ae,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No results yet"})]}):e.jsx("div",{className:"space-y-4",children:j.map(n=>e.jsxs("div",{className:`p-4 rounded-lg border ${n.success?"bg-green-500/10 border-green-500/30":"bg-dark-bg border-dark-border"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[n.success?e.jsx(se,{className:"h-5 w-5 text-green-400"}):e.jsx(J,{className:"h-5 w-5 text-gray-400"}),e.jsx("span",{className:"text-white font-medium",children:n.target})]}),e.jsx("span",{className:"text-sm text-gray-400",children:new Date(n.created_at).toLocaleString()})]}),n.result_type&&e.jsx("span",{className:"inline-block text-xs bg-primary/20 text-primary px-2 py-1 rounded mb-2",children:n.result_type}),n.data&&e.jsx("pre",{className:"mt-2 p-3 bg-dark-bg rounded text-sm text-gray-300 overflow-x-auto",children:typeof n.data=="string"?n.data:JSON.stringify(n.data,null,2)})]},n.id))})})]})})};export{Ie as default};
