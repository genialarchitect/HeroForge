import{b as ee,u as S,d as p,j as e}from"./vendor-state-BXNPjUwt.js";import{r as g}from"./vendor-react-5KxtEOLM.js";import{B as r,y as P,O as se,R as I,V as O,W as _,F as te,S as ae,K as M,a9 as j,Y as re,aW as le,aO as de,v as T,l as ie,_ as ne,Z as B,aI as ce,ak as oe,a as xe,ch as me}from"./vendor-ui-PizTOSgB.js";import{L as he}from"./Layout-CeExTnzB.js";import{L as d,B as i}from"./index-DgePDh_X.js";import"./Header-Dw99lsG2.js";import"./vendor-markdown-RN55YrVy.js";import"./vendor-utils-DfRopTPV.js";const c={getDashboard:()=>d.get("/wireless/dashboard"),listInterfaces:()=>d.get("/wireless/interfaces"),enableMonitor:t=>d.post(`/wireless/interfaces/${t}/monitor`),disableMonitor:t=>d.post(`/wireless/interfaces/${t}/managed`),startScan:t=>d.post("/wireless/scans",t),listScans:()=>d.get("/wireless/scans"),getScan:t=>d.get(`/wireless/scans/${t}`),stopScan:t=>d.delete(`/wireless/scans/${t}`),listNetworks:()=>d.get("/wireless/networks"),getNetwork:t=>d.get(`/wireless/networks/${t}`),sendDeauth:t=>d.post("/wireless/deauth",t),captureHandshake:t=>d.post("/wireless/capture/handshake",t),capturePmkid:t=>d.post("/wireless/capture/pmkid",t),wpsPixieDust:t=>d.post("/wireless/wps/pixie-dust",t),listHandshakes:()=>d.get("/wireless/handshakes"),crackHandshake:(t,a)=>d.post(`/wireless/handshakes/${t}/crack`,{wordlist:a}),listPmkids:()=>d.get("/wireless/pmkids"),listWordlists:()=>d.get("/wireless/wordlists")},W=({encryption:t})=>{const a=()=>{const n=t.toLowerCase();return n.includes("wpa3")?"bg-green-500/20 text-green-400 border-green-500/30":n.includes("wpa2")?"bg-blue-500/20 text-blue-400 border-blue-500/30":n.includes("wpa")?"bg-yellow-500/20 text-yellow-400 border-yellow-500/30":n.includes("wep")||n==="open"?"bg-red-500/20 text-red-400 border-red-500/30":"bg-gray-500/20 text-gray-400 border-gray-500/30"},m=()=>t.toLowerCase()==="open"?e.jsx(oe,{className:"h-3 w-3"}):e.jsx(xe,{className:"h-3 w-3"});return e.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 text-xs font-medium rounded border ${a()}`,children:[m(),t]})},ue=({dbm:t})=>{const a=()=>t>=-50?"text-green-400":t>=-60?"text-green-300":t>=-70?"text-yellow-400":t>=-80?"text-orange-400":"text-red-400";return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(me,{className:`h-4 w-4 ${a()}`}),e.jsxs("span",{className:`text-sm ${a()}`,children:[t," dBm"]})]})},be=({status:t})=>{const a=()=>{switch(t.toLowerCase()){case"running":return"bg-green-500/20 text-green-400 border-green-500/30";case"success":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"failed":return"bg-red-500/20 text-red-400 border-red-500/30";case"cancelled":return"bg-gray-500/20 text-gray-400 border-gray-500/30";default:return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30"}};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded border capitalize ${a()}`,children:t})},C=({label:t,value:a,icon:m,color:n})=>e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:t}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:a})]}),e.jsx("div",{className:`p-3 rounded-lg ${n}`,children:m})]})}),pe=({network:t,onCapture:a,onDeauth:m,onPmkid:n,onWps:D,isLoading:k})=>{var N;const[h,q]=g.useState(!1);return e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>q(!h),children:[e.jsx(_,{className:"h-5 w-5 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:t.ssid||"<Hidden SSID>"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono",children:t.bssid})]}),h?e.jsx(ie,{className:"h-4 w-4 text-slate-400"}):e.jsx(ne,{className:"h-4 w-4 text-slate-400"})]}),e.jsx(W,{encryption:t.encryption})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center text-sm mb-4",children:[e.jsxs("div",{className:"bg-light-bg dark:bg-dark-bg rounded p-2",children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Channel"}),e.jsx("p",{className:"font-semibold text-slate-900 dark:text-white",children:t.channel})]}),e.jsxs("div",{className:"bg-light-bg dark:bg-dark-bg rounded p-2",children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Signal"}),e.jsx(ue,{dbm:t.signal_strength})]}),e.jsxs("div",{className:"bg-light-bg dark:bg-dark-bg rounded p-2",children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Clients"}),e.jsx("p",{className:"font-semibold text-cyan-400",children:((N=t.clients)==null?void 0:N.length)||0})]})]}),h&&t.clients&&t.clients.length>0&&e.jsxs("div",{className:"mb-4 bg-light-bg dark:bg-dark-bg rounded p-3",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:"Connected Clients:"}),e.jsx("div",{className:"space-y-1",children:t.clients.map(x=>e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"font-mono text-slate-600 dark:text-slate-300",children:x.mac_address}),e.jsxs("span",{className:"text-slate-400",children:[x.signal_strength," dBm"]})]},x.mac_address))})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(i,{size:"sm",onClick:a,disabled:k,title:"Capture WPA Handshake",children:[e.jsx(T,{className:"h-4 w-4 mr-1"}),"Handshake"]}),e.jsxs(i,{size:"sm",variant:"outline",onClick:n,disabled:k,title:"Capture PMKID",children:[e.jsx(M,{className:"h-4 w-4 mr-1"}),"PMKID"]}),e.jsxs(i,{size:"sm",variant:"outline",onClick:m,disabled:k,title:"Send Deauth",children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"Deauth"]}),t.wps_enabled&&e.jsxs(i,{size:"sm",variant:"outline",onClick:D,disabled:k,title:"WPS Pixie Dust",children:[e.jsx(ce,{className:"h-4 w-4 mr-1"}),"WPS"]})]})]})},ge=({handshake:t,onCrack:a,isCracking:m})=>e.jsxs("tr",{className:"hover:bg-light-hover dark:hover:bg-dark-hover",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:t.ssid||"<Hidden>"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono",children:t.bssid})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300 font-mono",children:t.client_mac}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex items-center gap-1",children:t.is_complete?e.jsxs("span",{className:"text-green-400 text-sm",children:["Complete (",t.eapol_messages,"/4)"]}):e.jsxs("span",{className:"text-yellow-400 text-sm",children:["Partial (",t.eapol_messages,"/4)"]})})}),e.jsx("td",{className:"px-4 py-3",children:t.cracked?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(M,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-sm text-green-400 font-mono",children:t.password})]}):e.jsx("span",{className:"text-slate-400 text-sm",children:"Not cracked"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-500 dark:text-slate-400",children:new Date(t.captured_at).toLocaleString()}),e.jsx("td",{className:"px-4 py-3",children:!t.cracked&&t.is_complete&&e.jsxs(i,{size:"sm",onClick:a,disabled:m,children:[m?e.jsx(j,{className:"h-4 w-4 animate-spin"}):e.jsx(B,{className:"h-4 w-4 mr-1"}),"Crack"]})})]}),_e=()=>{const t=ee(),[a,m]=g.useState("dashboard"),[n,D]=g.useState(""),[k,h]=g.useState(!1),[q,N]=g.useState(!1),[x,R]=g.useState(null),[V,K]=g.useState(null),[f,E]=g.useState({interface:"",duration_secs:60,channels:[]}),{data:o,isLoading:je}=S({queryKey:["wireless-dashboard"],queryFn:()=>c.getDashboard().then(s=>s.data)}),{data:u,isLoading:Z}=S({queryKey:["wireless-interfaces"],queryFn:()=>c.listInterfaces().then(s=>s.data)}),{data:b,isLoading:Y}=S({queryKey:["wireless-networks"],queryFn:()=>c.listNetworks().then(s=>s.data)}),{data:w,isLoading:G}=S({queryKey:["wireless-scans"],queryFn:()=>c.listScans().then(s=>s.data)}),{data:y,isLoading:J}=S({queryKey:["wireless-handshakes"],queryFn:()=>c.listHandshakes().then(s=>s.data),enabled:a==="handshakes"}),{data:ke}=S({queryKey:["wireless-wordlists"],queryFn:()=>c.listWordlists().then(s=>s.data),enabled:a==="handshakes"}),$=p({mutationFn:s=>c.enableMonitor(s),onSuccess:()=>{r.success("Monitor mode enabled"),t.invalidateQueries({queryKey:["wireless-interfaces"]})},onError:()=>r.error("Failed to enable monitor mode")}),z=p({mutationFn:s=>c.disableMonitor(s),onSuccess:()=>{r.success("Monitor mode disabled"),t.invalidateQueries({queryKey:["wireless-interfaces"]})},onError:()=>r.error("Failed to disable monitor mode")}),F=p({mutationFn:s=>c.startScan(s),onSuccess:()=>{r.success("Wireless scan started"),t.invalidateQueries({queryKey:["wireless-scans"]}),t.invalidateQueries({queryKey:["wireless-dashboard"]}),h(!1)},onError:()=>r.error("Failed to start scan")}),U=p({mutationFn:s=>c.stopScan(s),onSuccess:()=>{r.success("Scan stopped"),t.invalidateQueries({queryKey:["wireless-scans"]})}}),L=p({mutationFn:s=>c.sendDeauth(s),onSuccess:()=>{r.success("Deauth packets sent")},onError:()=>r.error("Deauth failed")}),H=p({mutationFn:s=>c.captureHandshake(s),onSuccess:()=>{r.success("Handshake captured!"),t.invalidateQueries({queryKey:["wireless-handshakes"]}),t.invalidateQueries({queryKey:["wireless-dashboard"]}),N(!1)},onError:()=>r.error("Handshake capture failed")}),A=p({mutationFn:s=>c.capturePmkid(s),onSuccess:s=>{s.data?(r.success("PMKID captured!"),t.invalidateQueries({queryKey:["wireless-dashboard"]})):r.warning("No PMKID captured")},onError:()=>r.error("PMKID capture failed")}),Q=p({mutationFn:s=>c.wpsPixieDust(s),onSuccess:s=>{var l;(l=s.data)!=null&&l.success?r.success(`WPS cracked! PIN: ${s.data.pin}, PSK: ${s.data.psk}`):r.warning("WPS attack unsuccessful")},onError:()=>r.error("WPS attack failed")}),X=p({mutationFn:({id:s,wordlist:l})=>(K(s),c.crackHandshake(s,l)),onSuccess:s=>{var l;(l=s.data)!=null&&l.password?r.success(`Password cracked: ${s.data.password}`):r.warning("Password not found in wordlist"),t.invalidateQueries({queryKey:["wireless-handshakes"]}),K(null)},onError:()=>{r.error("Cracking failed"),K(null)}}),v=()=>(u==null?void 0:u.filter(s=>s.mode==="monitor"))||[];return e.jsx(he,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Wireless Security Assessment"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"WiFi network discovery, handshake capture, and password cracking"})]}),e.jsxs(i,{onClick:()=>h(!0),children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Start Scan"]})]}),e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(se,{className:"h-5 w-5 text-yellow-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-400",children:"Authorization Required"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Wireless security assessment requires proper authorization. Only test networks you own or have explicit permission to assess. Deauthentication attacks can disrupt network services."})]})]}),o&&e.jsxs("div",{className:"grid grid-cols-6 gap-4",children:[e.jsx(C,{label:"Total Scans",value:o.total_scans,icon:e.jsx(I,{className:"h-5 w-5 text-blue-400"}),color:"bg-blue-500/10"}),e.jsx(C,{label:"Active Scans",value:o.active_scans,icon:e.jsx(O,{className:"h-5 w-5 text-green-400"}),color:"bg-green-500/10"}),e.jsx(C,{label:"Networks",value:o.networks_discovered,icon:e.jsx(_,{className:"h-5 w-5 text-cyan-400"}),color:"bg-cyan-500/10"}),e.jsx(C,{label:"Handshakes",value:o.handshakes_captured,icon:e.jsx(te,{className:"h-5 w-5 text-purple-400"}),color:"bg-purple-500/10"}),e.jsx(C,{label:"PMKIDs",value:o.pmkids_captured,icon:e.jsx(ae,{className:"h-5 w-5 text-orange-400"}),color:"bg-orange-500/10"}),e.jsx(C,{label:"Cracked",value:o.passwords_cracked,icon:e.jsx(M,{className:"h-5 w-5 text-red-400"}),color:"bg-red-500/10"})]}),e.jsx("div",{className:"flex gap-2 border-b border-light-border dark:border-dark-border pb-2",children:[{id:"dashboard",label:"Overview",icon:e.jsx(O,{className:"h-4 w-4"})},{id:"interfaces",label:"Interfaces",icon:e.jsx(I,{className:"h-4 w-4"})},{id:"networks",label:"Networks",icon:e.jsx(_,{className:"h-4 w-4"})},{id:"scans",label:"Scans",icon:e.jsx(P,{className:"h-4 w-4"})},{id:"handshakes",label:"Captures",icon:e.jsx(M,{className:"h-4 w-4"})}].map(s=>e.jsxs("button",{onClick:()=>m(s.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${a===s.id?"bg-primary text-white":"text-slate-600 dark:text-slate-400 hover:bg-light-hover dark:hover:bg-dark-hover"}`,children:[s.icon,s.label]},s.id))}),a==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[o&&Object.keys(o.networks_by_encryption).length>0&&e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white mb-4",children:"Networks by Encryption"}),e.jsx("div",{className:"flex gap-4",children:Object.entries(o.networks_by_encryption).map(([s,l])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{encryption:s}),e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:l})]},s))})]}),o&&o.top_vulnerable_networks.length>0&&e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-light-border dark:border-dark-border",children:e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:"Vulnerable Networks"})}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-light-bg dark:bg-dark-bg",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"SSID"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"BSSID"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Encryption"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Vulnerability"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Severity"})]})}),e.jsx("tbody",{className:"divide-y divide-light-border dark:divide-dark-border",children:o.top_vulnerable_networks.map(s=>e.jsxs("tr",{className:"hover:bg-light-hover dark:hover:bg-dark-hover",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-slate-900 dark:text-white",children:s.ssid||"<Hidden>"}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300 font-mono",children:s.bssid}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(W,{encryption:s.encryption})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:s.vulnerability}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded border ${s.severity==="critical"?"bg-red-500/20 text-red-400 border-red-500/30":s.severity==="high"?"bg-orange-500/20 text-orange-400 border-orange-500/30":"bg-yellow-500/20 text-yellow-400 border-yellow-500/30"}`,children:s.severity})})]},s.bssid))})]})]})]}),a==="interfaces"&&e.jsx("div",{className:"space-y-4",children:Z?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(j,{className:"h-8 w-8 animate-spin text-primary"})}):(u==null?void 0:u.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(I,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No wireless interfaces found"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Ensure a wireless adapter with monitor mode support is connected"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u==null?void 0:u.map(s=>e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{className:`h-5 w-5 ${s.mode==="monitor"?"text-green-400":"text-slate-400"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:s.driver})]})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${s.mode==="monitor"?"bg-green-500/20 text-green-400":"bg-slate-500/20 text-slate-400"}`,children:s.mode})]}),s.chipset&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-3",children:s.chipset}),e.jsx("div",{className:"flex gap-2",children:s.mode==="monitor"?e.jsxs(i,{size:"sm",variant:"outline",onClick:()=>z.mutate(s.name),disabled:z.isPending,children:[e.jsx(re,{className:"h-4 w-4 mr-1"}),"Disable Monitor"]}):e.jsxs(i,{size:"sm",onClick:()=>$.mutate(s.name),disabled:!s.monitor_capable||$.isPending,children:[e.jsx(_,{className:"h-4 w-4 mr-1"}),"Enable Monitor"]})}),!s.monitor_capable&&e.jsx("p",{className:"text-xs text-red-400 mt-2",children:"This interface does not support monitor mode"})]},s.name))})}),a==="networks"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[(b==null?void 0:b.length)||0," networks discovered"]}),e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>t.invalidateQueries({queryKey:["wireless-networks"]}),children:[e.jsx(j,{className:"h-4 w-4 mr-1"}),"Refresh"]})]}),Y?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(j,{className:"h-8 w-8 animate-spin text-primary"})}):(b==null?void 0:b.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No networks discovered"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Start a wireless scan to discover nearby networks"}),e.jsxs(i,{onClick:()=>h(!0),children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Start Scan"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b==null?void 0:b.map(s=>e.jsx(pe,{network:s,onCapture:()=>{R(s),N(!0)},onDeauth:()=>{const l=v()[0];l?L.mutate({interface:l.name,bssid:s.bssid,count:5}):r.error("Enable monitor mode on an interface first")},onPmkid:()=>{const l=v()[0];l?A.mutate({interface:l.name,bssid:s.bssid,channel:s.channel}):r.error("Enable monitor mode on an interface first")},onWps:()=>{const l=v()[0];l?Q.mutate({interface:l.name,bssid:s.bssid}):r.error("Enable monitor mode on an interface first")},isLoading:L.isPending||A.isPending||Q.isPending},s.bssid))})]}),a==="scans"&&e.jsx("div",{className:"space-y-4",children:G?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(j,{className:"h-8 w-8 animate-spin text-primary"})}):(w==null?void 0:w.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(P,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No scans yet"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Start a wireless scan to discover nearby networks"}),e.jsxs(i,{onClick:()=>h(!0),children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Start Scan"]})]}):e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-light-bg dark:bg-dark-bg",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Interface"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Status"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Networks"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Clients"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Handshakes"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Started"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-light-border dark:divide-dark-border",children:w==null?void 0:w.map(s=>e.jsxs("tr",{className:"hover:bg-light-hover dark:hover:bg-dark-hover",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-slate-900 dark:text-white",children:s.interface}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(be,{status:s.status})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:s.networks_found}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:s.clients_found}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-300",children:s.handshakes_captured}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-500 dark:text-slate-400",children:new Date(s.started_at).toLocaleString()}),e.jsx("td",{className:"px-4 py-3",children:s.status==="running"&&e.jsx(i,{size:"sm",variant:"ghost",className:"text-red-400",onClick:()=>U.mutate(s.id),children:e.jsx(le,{className:"h-4 w-4"})})})]},s.id))})]})})}),a==="handshakes"&&e.jsx("div",{className:"space-y-4",children:J?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(j,{className:"h-8 w-8 animate-spin text-primary"})}):(y==null?void 0:y.length)===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(M,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"No handshakes captured"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Capture WPA handshakes from target networks to crack passwords"})]}):e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-light-bg dark:bg-dark-bg",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Network"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Client"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Status"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Password"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Captured"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-slate-500 dark:text-slate-400",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-light-border dark:divide-dark-border",children:y==null?void 0:y.map(s=>e.jsx(ge,{handshake:s,onCrack:()=>X.mutate({id:s.id}),isCracking:V===s.id},s.id))})]})})}),k&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4",children:"Start Wireless Scan"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Interface"}),e.jsxs("select",{value:f.interface,onChange:s=>E({...f,interface:s.target.value}),className:"w-full px-3 py-2 rounded-lg border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Select interface..."}),v().map(s=>e.jsxs("option",{value:s.name,children:[s.name," (monitor mode)"]},s.name))]}),v().length===0&&e.jsx("p",{className:"text-xs text-yellow-400 mt-1",children:"Enable monitor mode on an interface first"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Duration (seconds)"}),e.jsx("input",{type:"number",value:f.duration_secs,onChange:s=>E({...f,duration_secs:parseInt(s.target.value)}),className:"w-full px-3 py-2 rounded-lg border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white",min:"10",max:"3600"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx(i,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsxs(i,{onClick:()=>F.mutate(f),disabled:!f.interface||F.isPending,children:[F.isPending?e.jsx(j,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(de,{className:"h-4 w-4 mr-2"}),"Start Scan"]})]})]})}),q&&x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4",children:"Capture WPA Handshake"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-light-bg dark:bg-dark-bg rounded p-3",children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Target Network:"}),e.jsx("p",{className:"font-semibold text-slate-900 dark:text-white",children:x.ssid||"<Hidden SSID>"}),e.jsx("p",{className:"text-xs text-slate-400 font-mono",children:x.bssid})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Interface"}),e.jsxs("select",{value:n,onChange:s=>D(s.target.value),className:"w-full px-3 py-2 rounded-lg border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Select interface..."}),v().map(s=>e.jsx("option",{value:s.name,children:s.name},s.name))]})]}),e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:[e.jsx("p",{children:"This will:"}),e.jsxs("ul",{className:"list-disc list-inside mt-1",children:[e.jsxs("li",{children:["Lock to channel ",x.channel]}),e.jsx("li",{children:"Send deauth packets to force reconnection"}),e.jsx("li",{children:"Capture the 4-way handshake"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx(i,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),e.jsxs(i,{onClick:()=>{n&&x&&H.mutate({interface:n,bssid:x.bssid,channel:x.channel,timeout_secs:120})},disabled:!n||H.isPending,children:[H.isPending?e.jsx(j,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(T,{className:"h-4 w-4 mr-2"}),"Start Capture"]})]})]})})]})})};export{_e as default};
