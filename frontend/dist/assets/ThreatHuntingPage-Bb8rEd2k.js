import{b as Q,u as N,d as f,j as e}from"./vendor-state-DdX3IZQk.js";import{r as y}from"./vendor-react-Da1CiaFS.js";import{Y as F,P as L,ae as E,bl as Y,aN as J,aR as v,Q as C,aB as Z,B as u,aQ as ee,F as T,at as q,b9 as O,M as se,cf as te,bj as ae,G as re,x as le,aq as ie,T as ne}from"./vendor-ui-wM19Qo8C.js";import{d as oe,a5 as c}from"./index-9Ba8KlZ7.js";import"./vendor-charts-CCbxmwBt.js";const h={listIocs:s=>c.get("/hunting/iocs",{params:s}).then(t=>t.data),getIocStats:()=>c.get("/hunting/iocs/stats").then(s=>s.data),createIoc:s=>c.post("/hunting/iocs",s).then(t=>t.data),updateIoc:(s,t)=>c.put(`/hunting/iocs/${s}`,t).then(o=>o.data),deleteIoc:s=>c.delete(`/hunting/iocs/${s}`),importIocs:(s,t)=>c.post("/hunting/iocs/import",{format:s,data:t}).then(o=>o.data),exportIocs:(s,t)=>c.get(`/hunting/iocs/export/${s}`,{params:t,responseType:"blob"}),matchIocs:s=>c.post("/hunting/iocs/match",{data:s}).then(t=>t.data),listPlaybooks:s=>c.get("/hunting/playbooks",{params:s}).then(t=>t.data),createPlaybook:s=>c.post("/hunting/playbooks",s).then(t=>t.data),getPlaybook:s=>c.get(`/hunting/playbooks/${s}`).then(t=>t.data),updatePlaybook:(s,t)=>c.put(`/hunting/playbooks/${s}`,t).then(o=>o.data),listSessions:s=>c.get("/hunting/sessions",{params:s}).then(t=>t.data),createSession:s=>c.post("/hunting/sessions",s).then(t=>t.data),getSession:s=>c.get(`/hunting/sessions/${s}`).then(t=>t.data),updateSession:(s,t)=>c.put(`/hunting/sessions/${s}`,t).then(o=>o.data),addSessionNote:(s,t)=>c.post(`/hunting/sessions/${s}/notes`,{note:t}).then(o=>o.data),getSessionFindings:s=>c.get(`/hunting/sessions/${s}/findings`).then(t=>t.data),addSessionFinding:(s,t)=>c.post(`/hunting/sessions/${s}/findings`,t).then(o=>o.data),getMitreCoverage:()=>c.get("/hunting/mitre/coverage").then(s=>s.data),getMitreMatrix:()=>c.get("/hunting/mitre/matrix").then(s=>s.data),listRetrospectives:()=>c.get("/hunting/retrospective").then(s=>s.data),createRetrospective:s=>c.post("/hunting/retrospective",s).then(t=>t.data),getRetrospective:s=>c.get(`/hunting/retrospective/${s}`).then(t=>t.data)},K={critical:{bg:"bg-red-500/20",text:"text-red-400"},high:{bg:"bg-orange-500/20",text:"text-orange-400"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400"},low:{bg:"bg-blue-500/20",text:"text-blue-400"},informational:{bg:"bg-gray-500/20",text:"text-gray-400"}},R={active:{bg:"bg-green-500/20",text:"text-green-400"},expired:{bg:"bg-gray-500/20",text:"text-gray-400"},false_positive:{bg:"bg-red-500/20",text:"text-red-400"},paused:{bg:"bg-yellow-500/20",text:"text-yellow-400"},completed:{bg:"bg-cyan-500/20",text:"text-cyan-400"},cancelled:{bg:"bg-gray-500/20",text:"text-gray-400"},pending:{bg:"bg-orange-500/20",text:"text-orange-400"},running:{bg:"bg-purple-500/20",text:"text-purple-400"}},ce={ip:e.jsx(le,{className:"w-4 h-4"}),domain:e.jsx(re,{className:"w-4 h-4"}),hash:e.jsx(ae,{className:"w-4 h-4"}),url:e.jsx(te,{className:"w-4 h-4"}),email:e.jsx(se,{className:"w-4 h-4"}),registry:e.jsx(C,{className:"w-4 h-4"})};function U({severity:s}){const t=K[s.toLowerCase()]||K.medium;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.bg} ${t.text}`,children:s.charAt(0).toUpperCase()+s.slice(1)})}function A({status:s}){const t=R[s.toLowerCase()]||R.active;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.bg} ${t.text}`,children:s.replace(/_/g," ").replace(/\b\w/g,o=>o.toUpperCase())})}const D=({isOpen:s,onClose:t,title:o,children:l,size:i="md"})=>{if(!s)return null;const x={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:t}),e.jsxs("div",{className:`relative bg-gray-800 border border-gray-700 rounded-lg shadow-xl w-full ${x[i]} max-h-[90vh] overflow-y-auto mx-4`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 sticky top-0 bg-gray-800 z-10",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:o}),e.jsx("button",{onClick:t,className:"p-1 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-white",children:e.jsx(ie,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4",children:l})]})]})},de=({onSubmit:s,onCancel:t,isLoading:o})=>{const[l,i]=y.useState({ioc_type:"ip",value:"",severity:"medium",source:"",tags:""}),x=d=>{d.preventDefault(),s({...l,tags:l.tags?l.tags.split(",").map(g=>g.trim()):[]})};return e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"IOC Type *"}),e.jsxs("select",{value:l.ioc_type,onChange:d=>i({...l,ioc_type:d.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"ip",children:"IP Address"}),e.jsx("option",{value:"domain",children:"Domain"}),e.jsx("option",{value:"hash",children:"File Hash"}),e.jsx("option",{value:"url",children:"URL"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"registry",children:"Registry Key"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Severity"}),e.jsxs("select",{value:l.severity,onChange:d=>i({...l,severity:d.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Value *"}),e.jsx("input",{type:"text",required:!0,value:l.value,onChange:d=>i({...l,value:d.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white font-mono focus:ring-2 focus:ring-cyan-500",placeholder:l.ioc_type==="ip"?"192.168.1.1":l.ioc_type==="domain"?"malicious.example.com":l.ioc_type==="hash"?"abc123def456...":l.ioc_type==="url"?"https://malicious.example.com/payload":l.ioc_type==="email"?"attacker@malicious.com":"HKLM\\Software\\Malicious"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Source"}),e.jsx("input",{type:"text",value:l.source,onChange:d=>i({...l,source:d.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Threat intel feed, incident, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Tags"}),e.jsx("input",{type:"text",value:l.tags,onChange:d=>i({...l,tags:d.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"apt29, ransomware, c2 (comma-separated)"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:t,disabled:o,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors disabled:opacity-50",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:o,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors disabled:opacity-50 flex items-center gap-2",children:[o&&e.jsx(v,{className:"w-4 h-4 animate-spin"}),"Add IOC"]})]})]})},xe=({playbooks:s,onSubmit:t,onCancel:o,isLoading:l})=>{const[i,x]=y.useState({name:"",description:"",playbook_id:"",hypothesis:"",data_sources:""}),d=n=>{n.preventDefault(),t({...i,playbook_id:i.playbook_id||void 0,data_sources:i.data_sources?i.data_sources.split(",").map(m=>m.trim()):[]})},g=n=>{if(x({...i,playbook_id:n}),n){const m=s.find(r=>r.id===n);m&&x(r=>({...r,playbook_id:n,hypothesis:m.hypothesis,data_sources:m.data_sources.join(", ")}))}};return e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Hunt Name *"}),e.jsx("input",{type:"text",required:!0,value:i.name,onChange:n=>x({...i,name:n.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Hunt session name..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Based on Playbook"}),e.jsxs("select",{value:i.playbook_id,onChange:n=>g(n.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"",children:"No playbook (custom hunt)"}),s.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Hypothesis *"}),e.jsx("textarea",{required:!0,value:i.hypothesis,onChange:n=>x({...i,hypothesis:n.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",rows:3,placeholder:"What are you looking for? What behavior suggests compromise?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:i.description,onChange:n=>x({...i,description:n.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",rows:2,placeholder:"Additional context for this hunt..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Data Sources"}),e.jsx("input",{type:"text",value:i.data_sources,onChange:n=>x({...i,data_sources:n.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"EDR, SIEM, DNS logs (comma-separated)"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:o,disabled:l,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors disabled:opacity-50",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors disabled:opacity-50 flex items-center gap-2",children:[l&&e.jsx(v,{className:"w-4 h-4 animate-spin"}),"Start Hunt"]})]})]})},me=({session:s,onClose:t})=>{const o=Q(),[l,i]=y.useState(""),[x,d]=y.useState("details"),{data:g}=N({queryKey:["session-findings",s.id],queryFn:()=>h.getSessionFindings(s.id)}),n=f({mutationFn:r=>h.addSessionNote(s.id,r),onSuccess:()=>{o.invalidateQueries({queryKey:["hunting-sessions"]}),i(""),u.success("Note added")},onError:()=>u.error("Failed to add note")}),m=f({mutationFn:r=>h.updateSession(s.id,{status:r}),onSuccess:()=>{o.invalidateQueries({queryKey:["hunting-sessions"]}),u.success("Session updated")},onError:()=>u.error("Failed to update session")});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(A,{status:s.status}),s.playbook_name&&e.jsxs("span",{className:"text-xs text-gray-500",children:["from: ",s.playbook_name]})]}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:s.name}),s.description&&e.jsx("p",{className:"text-gray-400 mt-1",children:s.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.status==="active"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>m.mutate("paused"),className:"px-3 py-1.5 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg text-sm",children:"Pause"}),e.jsx("button",{onClick:()=>m.mutate("completed"),className:"px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm",children:"Complete"})]}),s.status==="paused"&&e.jsx("button",{onClick:()=>m.mutate("active"),className:"px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg text-sm",children:"Resume"})]})]}),e.jsxs("div",{className:"p-4 bg-gray-900 rounded-lg border-l-4 border-cyan-500",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Hypothesis"}),e.jsx("p",{className:"text-gray-300",children:s.hypothesis})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:["details","findings","notes"].map(r=>e.jsxs("button",{onClick:()=>d(r),className:`px-3 py-2 border-b-2 transition-colors text-sm ${x===r?"border-cyan-500 text-cyan-500":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[r.charAt(0).toUpperCase()+r.slice(1),r==="findings"&&e.jsxs("span",{className:"ml-1 text-gray-500",children:["(",s.findings_count,")"]}),r==="notes"&&e.jsxs("span",{className:"ml-1 text-gray-500",children:["(",s.notes.length,")"]})]},r))})}),e.jsxs("div",{className:"min-h-[200px]",children:[x==="details"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Started"}),e.jsx("p",{className:"text-white",children:new Date(s.start_time).toLocaleString()})]}),s.end_time&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Ended"}),e.jsx("p",{className:"text-white",children:new Date(s.end_time).toLocaleString()})]})]}),s.data_sources.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Data Sources"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.data_sources.map((r,p)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs",children:r},p))})]})]}),x==="findings"&&e.jsx("div",{className:"space-y-2",children:g&&g.length>0?g.map(r=>e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{severity:r.severity}),e.jsx("span",{className:"text-xs text-gray-500",children:r.finding_type})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(r.created_at).toLocaleString()})]}),e.jsx("h4",{className:"text-white font-medium",children:r.title}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:r.description}),r.iocs_found.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:r.iocs_found.map((p,S)=>e.jsx("span",{className:"px-2 py-0.5 bg-red-500/20 text-red-400 rounded text-xs font-mono",children:p},S))})]},r.id)):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ne,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No findings yet"})]})}),x==="notes"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:l,onChange:r=>i(r.target.value),className:"flex-1 px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"Add a note..."}),e.jsx("button",{onClick:()=>{l.trim()&&n.mutate(l)},disabled:!l.trim()||n.isPending,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:"Add"})]}),e.jsx("div",{className:"space-y-2",children:s.notes.length>0?s.notes.map((r,p)=>e.jsx("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-3",children:e.jsx("p",{className:"text-gray-300",children:r})},p)):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(T,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No notes yet"})]})})]})]})]})};function be(){var H,$;const s=Q(),[t,o]=y.useState("iocs"),[l,i]=y.useState(!1),[x,d]=y.useState(!1),[g,n]=y.useState(null),[m,r]=y.useState(""),[p,S]=y.useState(""),{data:j}=N({queryKey:["ioc-stats"],queryFn:()=>h.getIocStats(),enabled:t==="iocs"}),{data:k,isLoading:z}=N({queryKey:["iocs",m,p],queryFn:()=>{const a={};return m&&(a.ioc_type=m),p&&(a.status=p),h.listIocs(a)},enabled:t==="iocs"}),{data:w,isLoading:B}=N({queryKey:["hunting-playbooks"],queryFn:()=>h.listPlaybooks(),enabled:t==="playbooks"||t==="sessions"}),{data:_,isLoading:G}=N({queryKey:["hunting-sessions"],queryFn:()=>h.listSessions(),enabled:t==="sessions"}),{data:I,isLoading:V}=N({queryKey:["mitre-coverage"],queryFn:()=>h.getMitreCoverage(),enabled:t==="mitre"}),M=f({mutationFn:h.createIoc,onSuccess:()=>{s.invalidateQueries({queryKey:["iocs"]}),s.invalidateQueries({queryKey:["ioc-stats"]}),i(!1),u.success("IOC added")},onError:()=>u.error("Failed to add IOC")}),P=f({mutationFn:h.createSession,onSuccess:()=>{s.invalidateQueries({queryKey:["hunting-sessions"]}),d(!1),u.success("Hunt session started")},onError:()=>u.error("Failed to start session")}),W=f({mutationFn:h.deleteIoc,onSuccess:()=>{s.invalidateQueries({queryKey:["iocs"]}),s.invalidateQueries({queryKey:["ioc-stats"]}),u.success("IOC deleted")},onError:()=>u.error("Failed to delete IOC")}),X=[{id:"iocs",label:"IOCs",icon:e.jsx(C,{className:"w-4 h-4"})},{id:"playbooks",label:"Playbooks",icon:e.jsx(T,{className:"w-4 h-4"})},{id:"sessions",label:"Hunt Sessions",icon:e.jsx(F,{className:"w-4 h-4"})},{id:"mitre",label:"MITRE Coverage",icon:e.jsx(O,{className:"w-4 h-4"})},{id:"retrospective",label:"Retrospective",icon:e.jsx(q,{className:"w-4 h-4"})}];return e.jsx(oe,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(F,{className:"w-8 h-8 text-purple-500"}),"Threat Hunting"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Proactively hunt for threats and manage IOCs"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:[e.jsx(L,{className:"w-4 h-4"}),"Add IOC"]}),e.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(E,{className:"w-4 h-4"}),"Start Hunt"]})]})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:X.map(a=>e.jsxs("button",{onClick:()=>o(a.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${t===a.id?"border-cyan-500 text-cyan-500":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[a.icon,a.label]},a.id))})}),e.jsxs("div",{children:[t==="iocs"&&e.jsxs("div",{className:"space-y-4",children:[j&&e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:j.total}),e.jsx("p",{className:"text-xs text-gray-400",children:"Total IOCs"})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:j.active}),e.jsx("p",{className:"text-xs text-gray-400",children:"Active"})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:j.added_today}),e.jsx("p",{className:"text-xs text-gray-400",children:"Added Today"})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-400",children:j.expired_today}),e.jsx("p",{className:"text-xs text-gray-400",children:"Expired Today"})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:((H=j.by_type)==null?void 0:H.ip)||0}),e.jsx("p",{className:"text-xs text-gray-400",children:"IPs"})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:(($=j.by_type)==null?void 0:$.domain)||0}),e.jsx("p",{className:"text-xs text-gray-400",children:"Domains"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:m,onChange:a=>r(a.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"ip",children:"IP Address"}),e.jsx("option",{value:"domain",children:"Domain"}),e.jsx("option",{value:"hash",children:"File Hash"}),e.jsx("option",{value:"url",children:"URL"}),e.jsx("option",{value:"email",children:"Email"})]}),e.jsxs("select",{value:p,onChange:a=>S(a.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"expired",children:"Expired"}),e.jsx("option",{value:"false_positive",children:"False Positive"})]}),e.jsx("div",{className:"flex-1"}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm",children:[e.jsx(Y,{className:"w-4 h-4"}),"Import"]}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm",children:[e.jsx(J,{className:"w-4 h-4"}),"Export"]})]}),z?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(v,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):k&&k.length>0?e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Type"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Value"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Severity"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Source"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Added"}),e.jsx("th",{className:"text-right p-4 text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:k.map(a=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[ce[a.ioc_type]||e.jsx(C,{className:"w-4 h-4"}),e.jsx("span",{className:"text-gray-400 text-sm",children:a.ioc_type.toUpperCase()})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-white font-mono text-sm truncate max-w-xs",children:a.value}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(a.value),u.success("Copied to clipboard")},className:"p-1 hover:bg-gray-600 rounded text-gray-400 hover:text-white",children:e.jsx(Z,{className:"w-3 h-3"})})]})}),e.jsx("td",{className:"p-4",children:e.jsx(U,{severity:a.severity})}),e.jsx("td",{className:"p-4",children:e.jsx(A,{status:a.status})}),e.jsx("td",{className:"p-4 text-gray-400 text-sm",children:a.source||"-"}),e.jsx("td",{className:"p-4 text-gray-500 text-sm",children:new Date(a.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("button",{onClick:()=>W.mutate(a.id),className:"p-2 hover:bg-red-500/20 rounded-lg text-gray-400 hover:text-red-400",children:e.jsx(ee,{className:"w-4 h-4"})})})]},a.id))})]})}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(C,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No IOCs"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Add indicators of compromise to track threats"}),e.jsxs("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(L,{className:"w-4 h-4 inline mr-2"}),"Add IOC"]})]})]}),t==="playbooks"&&e.jsx("div",{className:"space-y-4",children:B?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(v,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):w&&w.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:w.map(a=>e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-400 rounded text-xs",children:a.category}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${a.is_active?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:a.is_active?"Active":"Inactive"})]}),e.jsx("h3",{className:"text-lg font-medium text-white",children:a.name})]})}),a.description&&e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:a.description}),e.jsxs("div",{className:"p-3 bg-gray-900 rounded-lg mb-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Hypothesis"}),e.jsx("p",{className:"text-gray-300 text-sm",children:a.hypothesis})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[e.jsxs("span",{children:[a.queries.length," queries"]}),e.jsxs("span",{children:[a.data_sources.length," data sources"]}),a.mitre_techniques.length>0&&e.jsxs("span",{children:[a.mitre_techniques.length," techniques"]})]})]},a.id))}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(T,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Playbooks"}),e.jsx("p",{className:"text-gray-400",children:"Create hunting playbooks to standardize your hunts"})]})}),t==="sessions"&&e.jsx("div",{className:"space-y-4",children:G?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(v,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):_&&_.length>0?e.jsx("div",{className:"space-y-3",children:_.map(a=>e.jsx("div",{onClick:()=>n(a),className:"bg-gray-800 border border-gray-700 rounded-lg p-4 hover:border-gray-600 cursor-pointer transition-colors",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(A,{status:a.status}),a.playbook_name&&e.jsxs("span",{className:"text-xs text-gray-500",children:["from: ",a.playbook_name]})]}),e.jsx("h3",{className:"text-lg font-medium text-white",children:a.name}),a.description&&e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:a.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"w-3 h-3"}),new Date(a.start_time).toLocaleString()]}),e.jsxs("span",{children:[a.findings_count," findings"]})]})]})})},a.id))}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(F,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Hunt Sessions"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Start a new threat hunting session"}),e.jsxs("button",{onClick:()=>d(!0),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(E,{className:"w-4 h-4 inline mr-2"}),"Start Hunt"]})]})}),t==="mitre"&&e.jsx("div",{className:"space-y-4",children:V?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(v,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):I&&I.length>0?e.jsx("div",{className:"space-y-4",children:I.map(a=>e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:a.tactic_name}),e.jsxs("span",{className:"text-sm text-gray-400",children:[a.techniques.filter(b=>b.playbook_count>0).length," / ",a.techniques.length," covered"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:a.techniques.map(b=>e.jsxs("div",{className:`p-2 rounded-lg text-sm ${b.playbook_count>0?"bg-green-500/20 border border-green-500/30":"bg-gray-900 border border-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:b.playbook_count>0?"text-green-400":"text-gray-400",children:b.id}),b.playbook_count>0&&e.jsx("span",{className:"text-xs text-green-400",children:b.playbook_count})]}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:b.name})]},b.id))})]},a.tactic))}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(O,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Coverage Data"}),e.jsx("p",{className:"text-gray-400",children:"Create playbooks with MITRE mappings to see coverage"})]})}),t==="retrospective"&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(q,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"Retrospective Search"}),e.jsx("p",{className:"text-gray-400",children:"Search historical data for newly discovered IOCs"})]})]}),e.jsx(D,{isOpen:l,onClose:()=>i(!1),title:"Add Indicator of Compromise",children:e.jsx(de,{onSubmit:a=>M.mutate(a),onCancel:()=>i(!1),isLoading:M.isPending})}),e.jsx(D,{isOpen:x,onClose:()=>d(!1),title:"Start Hunt Session",children:e.jsx(xe,{playbooks:w||[],onSubmit:a=>P.mutate(a),onCancel:()=>d(!1),isLoading:P.isPending})}),e.jsx(D,{isOpen:!!g,onClose:()=>n(null),title:"Hunt Session Details",size:"lg",children:g&&e.jsx(me,{session:g,onClose:()=>n(null)})})]})})}export{be as default};
