import{j as e}from"./vendor-state-DdX3IZQk.js";import{r as l}from"./vendor-react-Da1CiaFS.js";import{B as I,_ as p,ac as L,aQ as D,m as O,aC as u,ad as j,bY as T,j as E,N as R,A as z,p as U}from"./vendor-ui-Cfxa9o3E.js";import{d as B}from"./index-CxqB437X.js";import"./vendor-charts-ed8SE4MW.js";const M=[{level:5,name:"Enterprise Network",color:"bg-blue-600"},{level:4,name:"Business Network",color:"bg-blue-500"},{level:3.5,name:"DMZ",color:"bg-purple-600"},{level:3,name:"Site Operations",color:"bg-yellow-600"},{level:2,name:"Area Control",color:"bg-orange-600"},{level:1,name:"Basic Control",color:"bg-red-500"},{level:0,name:"Process",color:"bg-red-700"}],y={getAssets:async()=>[{id:"1",name:"Siemens S7-1500 PLC",asset_type:"plc",vendor:"Siemens",model:"S7-1500",firmware_version:"2.9.4",ip_address:"10.10.1.10",protocols:["s7","modbus"],purdue_level:1,zone:"Production Line 1",criticality:"critical",risk_score:75,vulnerabilities:["CVE-2023-28489"],last_seen:new Date().toISOString()},{id:"2",name:"Allen-Bradley HMI",asset_type:"hmi",vendor:"Rockwell",model:"PanelView Plus 7",firmware_version:"12.011",ip_address:"10.10.1.20",protocols:["ethernetip","cip"],purdue_level:2,zone:"Production Line 1",criticality:"high",risk_score:45,vulnerabilities:[],last_seen:new Date().toISOString()},{id:"3",name:"Schneider SCADA",asset_type:"scada",vendor:"Schneider Electric",model:"ClearSCADA",ip_address:"10.10.2.10",protocols:["dnp3","modbus"],purdue_level:3,zone:"Control Room",criticality:"critical",risk_score:60,vulnerabilities:["CVE-2022-45789"],last_seen:new Date().toISOString()},{id:"4",name:"Historian Server",asset_type:"historian",vendor:"OSIsoft",model:"PI Server",ip_address:"10.10.3.10",protocols:["pi-sdk"],purdue_level:3,zone:"Control Room",criticality:"high",risk_score:30,vulnerabilities:[],last_seen:new Date().toISOString()},{id:"5",name:"RTU-001",asset_type:"rtu",vendor:"ABB",model:"RTU560",firmware_version:"13.5.2",ip_address:"10.10.4.10",protocols:["dnp3","iec104"],purdue_level:1,zone:"Remote Site 1",criticality:"high",risk_score:55,vulnerabilities:[],last_seen:new Date().toISOString()}],getScans:async()=>[{id:"1",name:"Weekly Discovery",scan_type:"discovery",target_range:"10.10.0.0/16",protocols_enabled:["modbus","s7","dnp3"],status:"completed",assets_discovered:23,vulnerabilities_found:5,started_at:new Date().toISOString(),completed_at:new Date().toISOString()},{id:"2",name:"Protocol Analysis",scan_type:"protocol",target_range:"10.10.1.0/24",protocols_enabled:["modbus"],status:"running",assets_discovered:8,vulnerabilities_found:2,started_at:new Date().toISOString()}],startScan:async c=>{await new Promise(o=>setTimeout(o,500))}},Q=()=>{const[c,o]=l.useState("assets"),[i,v]=l.useState([]),[h,N]=l.useState([]),[b,g]=l.useState(!0),[n,w]=l.useState(""),[a,d]=l.useState(null),[$,f]=l.useState(!1);l.useEffect(()=>{_()},[]);const _=async()=>{try{g(!0);const[s,t]=await Promise.all([y.getAssets(),y.getScans()]);v(s),N(t)}catch{I.error("Failed to load OT/ICS data")}finally{g(!1)}},x=s=>{switch(s){case"plc":return e.jsx(U,{className:"h-5 w-5"});case"hmi":return e.jsx(z,{className:"h-5 w-5"});case"scada":return e.jsx(R,{className:"h-5 w-5"});case"rtu":return e.jsx(p,{className:"h-5 w-5"});case"historian":return e.jsx(j,{className:"h-5 w-5"});default:return e.jsx(E,{className:"h-5 w-5"})}},S=s=>{switch(s){case"critical":return"bg-red-600";case"high":return"bg-orange-600";case"medium":return"bg-yellow-600";case"low":return"bg-green-600";default:return"bg-gray-600"}},C=s=>s>=70?"text-red-400":s>=40?"text-yellow-400":"text-green-400",m=s=>({modbus:"bg-blue-600",s7:"bg-purple-600",dnp3:"bg-orange-600",ethernetip:"bg-green-600",bacnet:"bg-cyan-600",opcua:"bg-yellow-600"})[s.toLowerCase()]||"bg-gray-600",A=i.filter(s=>{var t,r;return s.name.toLowerCase().includes(n.toLowerCase())||((t=s.vendor)==null?void 0:t.toLowerCase().includes(n.toLowerCase()))||((r=s.ip_address)==null?void 0:r.includes(n))}),k=M.map(s=>({...s,assets:i.filter(t=>t.purdue_level===s.level)}));return e.jsx(B,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{className:"h-8 w-8 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"OT/ICS Security"}),e.jsx("p",{className:"text-gray-400",children:"Industrial Control Systems monitoring and security"})]})]}),e.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-500",children:[e.jsx(L,{className:"h-4 w-4"}),"Start OT Scan"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:i.length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"OT Assets"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:i.filter(s=>s.criticality==="critical").length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Critical Assets"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:i.reduce((s,t)=>s+t.vulnerabilities.length,0)}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Vulnerabilities"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-cyan-400",children:new Set(i.flatMap(s=>s.protocols)).size}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Protocols"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:h.filter(s=>s.status==="running").length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Active Scans"})]})]}),e.jsx("div",{className:"flex gap-1 mb-6 border-b border-gray-700",children:["assets","purdue","protocols","scans"].map(s=>e.jsx("button",{onClick:()=>o(s),className:`px-4 py-2 font-medium capitalize ${c===s?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:s==="purdue"?"Purdue Model":s},s))}),b?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(D,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs(e.Fragment,{children:[c==="assets"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-4 mb-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(O,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search assets...",value:n,onChange:s=>w(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white"})]})}),e.jsx("div",{className:"grid gap-4",children:A.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 cursor-pointer hover:bg-gray-750",onClick:()=>d(s),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-gray-700 rounded-lg text-cyan-400",children:x(s.asset_type)}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-white font-medium flex items-center gap-2",children:[s.name,e.jsx("span",{className:`px-2 py-0.5 text-xs rounded text-white ${S(s.criticality)}`,children:s.criticality})]}),e.jsxs("div",{className:"text-gray-400 text-sm",children:[s.vendor," ",s.model," • ",s.ip_address]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"flex gap-1",children:s.protocols.map(t=>e.jsx("span",{className:`px-2 py-1 text-xs text-white rounded ${m(t)}`,children:t.toUpperCase()},t))}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-lg font-bold ${C(s.risk_score)}`,children:s.risk_score}),e.jsx("div",{className:"text-gray-400 text-xs",children:"Risk Score"})]}),s.vulnerabilities.length>0&&e.jsxs("div",{className:"flex items-center gap-1 text-red-400",children:[e.jsx(u,{className:"h-4 w-4"}),e.jsx("span",{children:s.vulnerabilities.length})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"h-3 w-3"}),"Level ",s.purdue_level]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"h-3 w-3"}),s.zone||"Unknown"]}),s.firmware_version&&e.jsxs("span",{children:["FW: ",s.firmware_version]})]})]},s.id))})]}),c==="purdue"&&e.jsx("div",{className:"space-y-4",children:k.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:`${s.color} px-4 py-3 flex items-center justify-between`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-white font-bold",children:["Level ",s.level]}),e.jsx("span",{className:"text-white/80",children:s.name})]}),e.jsxs("span",{className:"text-white/80",children:[s.assets.length," assets"]})]}),s.assets.length>0&&e.jsx("div",{className:"p-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:s.assets.map(t=>e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3 cursor-pointer hover:bg-gray-600",onClick:()=>d(t),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-cyan-400",children:x(t.asset_type)}),e.jsx("span",{className:"text-white text-sm font-medium truncate",children:t.name})]}),e.jsx("div",{className:"text-gray-400 text-xs",children:t.ip_address}),e.jsx("div",{className:"flex gap-1 mt-2",children:t.protocols.slice(0,2).map(r=>e.jsx("span",{className:"text-xs text-gray-300 bg-gray-600 px-1 rounded",children:r},r))})]},t.id))}),s.assets.length===0&&e.jsx("div",{className:"p-4 text-gray-500 text-center text-sm",children:"No assets at this level"})]},s.level))}),c==="protocols"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:["Modbus","S7","DNP3","EtherNet/IP","BACnet","OPC-UA","IEC 61850","IEC 104"].map(s=>{const t=i.filter(r=>r.protocols.some(P=>P.toLowerCase()===s.toLowerCase().replace("/","").replace(" ","")));return e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-white font-medium",children:s}),e.jsxs("span",{className:"text-gray-400 text-sm",children:[t.length," devices"]})]}),e.jsxs("div",{className:"space-y-2",children:[t.slice(0,3).map(r=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:r.name}),e.jsx("span",{className:"text-gray-500",children:r.ip_address})]},r.id)),t.length>3&&e.jsxs("div",{className:"text-cyan-400 text-sm",children:["+",t.length-3," more"]})]})]},s)})}),c==="scans"&&e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Target"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Protocols"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Results"})]})}),e.jsx("tbody",{children:h.map(s=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-white",children:s.name}),e.jsx("td",{className:"px-4 py-3 text-gray-300 capitalize",children:s.scan_type}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("code",{className:"text-gray-300 bg-gray-700 px-2 py-1 rounded text-sm",children:s.target_range})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex gap-1",children:s.protocols_enabled.map(t=>e.jsx("span",{className:`px-2 py-0.5 text-xs text-white rounded ${m(t)}`,children:t},t))})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.status==="completed"?"bg-green-600 text-white":s.status==="running"?"bg-cyan-600 text-white":"bg-gray-600 text-gray-300"}`,children:s.status})}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[e.jsxs("span",{className:"text-white",children:[s.assets_discovered," assets"]}),s.vulnerabilities_found>0&&e.jsxs("span",{className:"text-red-400 ml-2",children:[s.vulnerabilities_found," vulns"]})]})]},s.id))})]})})]}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>d(null),children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-700 rounded-lg text-cyan-400",children:x(a.asset_type)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:a.name}),e.jsxs("p",{className:"text-gray-400",children:[a.vendor," ",a.model]})]})]}),e.jsx("button",{onClick:()=>d(null),className:"text-gray-400 hover:text-white",children:"×"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"IP Address"}),e.jsx("div",{className:"text-white",children:a.ip_address})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Firmware"}),e.jsx("div",{className:"text-white",children:a.firmware_version||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Purdue Level"}),e.jsxs("div",{className:"text-white",children:["Level ",a.purdue_level]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Zone"}),e.jsx("div",{className:"text-white",children:a.zone||"Unknown"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-2",children:"Protocols"}),e.jsx("div",{className:"flex gap-2",children:a.protocols.map(s=>e.jsx("span",{className:`px-3 py-1 text-white rounded ${m(s)}`,children:s.toUpperCase()},s))})]}),a.vulnerabilities.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm mb-2",children:"Vulnerabilities"}),e.jsx("div",{className:"space-y-2",children:a.vulnerabilities.map(s=>e.jsxs("div",{className:"flex items-center gap-2 bg-red-600/20 border border-red-600/40 rounded p-2",children:[e.jsx(u,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-red-400",children:s})]},s))})]})]})})]})})};export{Q as default};
