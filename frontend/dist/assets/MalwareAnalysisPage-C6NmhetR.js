import{b as ve,u as b,d as T,j as e}from"./vendor-state-BXNPjUwt.js";import{r as x,R as Se}from"./vendor-react-5KxtEOLM.js";import{B as o,au as ae,aY as I,ar as H,O as J,S as K,af as re,y as Ce,a9 as Y,L as S,p as _e,g as ne,m as ke,Z as V,aI as ee,ab as le,ap as Fe,K as Ae,aW as qe,M as Te,G as se,X as G,bd as ie,i as De,I as te,F as Le,N as Me,bY as Ke}from"./vendor-ui-DGSzT-Xm.js";import{ak as N,al as F}from"./index-t7VPhhr8.js";import{L as Re}from"./Layout-BlRtLSTJ.js";import{u as Pe,E as $e}from"./useRequireEngagement-9lfinMdP.js";import"./vendor-utils-DfRopTPV.js";import"./vendor-markdown-RN55YrVy.js";const k=({title:t,value:a,icon:u,color:g})=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:t}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:a})]}),e.jsx("div",{className:`p-3 rounded-lg ${g}`,children:u})]})}),Ie=t=>t?t>=80?"text-red-400":t>=60?"text-orange-400":t>=40?"text-yellow-400":t>=20?"text-blue-400":"text-green-400":"text-gray-400",ce=t=>t?t>=80?"bg-red-500/20 text-red-400":t>=60?"bg-orange-500/20 text-orange-400":t>=40?"bg-yellow-500/20 text-yellow-400":t>=20?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400",xe=t=>{switch(t.toLowerCase()){case"pe":return e.jsx(Ke,{className:"w-5 h-5"});case"elf":return e.jsx(ie,{className:"w-5 h-5"});case"script":return e.jsx(Me,{className:"w-5 h-5"});case"pdf":return e.jsx(Le,{className:"w-5 h-5"});case"apk":return e.jsx(K,{className:"w-5 h-5"});default:return e.jsx(ae,{className:"w-5 h-5"})}},de=t=>{switch(t.toLowerCase()){case"ip":return e.jsx(re,{className:"w-4 h-4"});case"domain":return e.jsx(se,{className:"w-4 h-4"});case"url":return e.jsx(se,{className:"w-4 h-4"});case"email":return e.jsx(Te,{className:"w-4 h-4"});case"hash":return e.jsx(qe,{className:"w-4 h-4"});case"bitcoin":return e.jsx(Ae,{className:"w-4 h-4"});default:return e.jsx(H,{className:"w-4 h-4"})}},X=t=>t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(2)} MB`,O=t=>{const a=new Date(t);return a.toLocaleDateString()+" "+a.toLocaleTimeString()},Ue=({sample:t,onSelect:a,onAnalyze:u,onDelete:g})=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50 cursor-pointer transition-colors",onClick:a,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-cyan-500",children:xe(t.file_type)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium truncate max-w-xs",children:t.original_filename}),e.jsxs("p",{className:"text-gray-500 text-xs font-mono",children:[t.sha256.substring(0,16),"..."]})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-gray-700 text-gray-300",children:t.file_type.toUpperCase()})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:X(t.file_size)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${ce(t.threat_score)}`,children:t.threat_score??"-"})}),e.jsx("td",{className:"px-4 py-3",children:t.classification?e.jsx("span",{className:"text-sm text-gray-300",children:t.classification}):e.jsx("span",{className:"text-sm text-gray-500",children:"-"})}),e.jsxs("td",{className:"px-4 py-3",children:[t.is_malicious===!0&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-red-500/20 text-red-400",children:"Malicious"}),t.is_malicious===!1&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-green-500/20 text-green-400",children:"Clean"}),t.is_malicious===void 0&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-gray-500/20 text-gray-400",children:"Unknown"})]}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",onClick:c=>c.stopPropagation(),children:[e.jsx("button",{onClick:u,className:"p-1.5 text-cyan-400 hover:bg-cyan-500/20 rounded transition-colors",title:"Analyze",children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx("button",{onClick:g,className:"p-1.5 text-red-400 hover:bg-red-500/20 rounded transition-colors",title:"Delete",children:e.jsx(le,{className:"w-4 h-4"})})]})})]}),Ee=({isOpen:t,onClose:a,onUpload:u,isUploading:g})=>{const[c,h]=x.useState(null),[m,y]=x.useState(""),[f,p]=x.useState(""),[C,r]=x.useState(!1),l=x.useCallback(i=>{i.preventDefault(),i.stopPropagation(),i.type==="dragenter"||i.type==="dragover"?r(!0):i.type==="dragleave"&&r(!1)},[]),w=x.useCallback(i=>{i.preventDefault(),i.stopPropagation(),r(!1),i.dataTransfer.files&&i.dataTransfer.files[0]&&h(i.dataTransfer.files[0])},[]),j=()=>{if(c){const i=m.split(",").map(A=>A.trim()).filter(A=>A);u(c,i,f)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center",children:[e.jsx(I,{className:"w-5 h-5 mr-2 text-cyan-500"}),"Upload Sample"]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white",children:e.jsx(G,{className:"w-5 h-5"})})]}),e.jsx("div",{className:`border-2 border-dashed rounded-lg p-8 text-center mb-4 transition-colors ${C?"border-cyan-500 bg-cyan-500/10":"border-gray-600 hover:border-gray-500"}`,onDragEnter:l,onDragLeave:l,onDragOver:l,onDrop:w,children:c?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(ie,{className:"w-8 h-8 text-cyan-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:c.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:X(c.size)})]}),e.jsx("button",{onClick:()=>h(null),className:"text-gray-400 hover:text-white",children:e.jsx(De,{className:"w-5 h-5"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-12 h-12 text-gray-500 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-300",children:"Drag and drop a file here, or"}),e.jsxs("label",{className:"mt-2 inline-block",children:[e.jsx("input",{type:"file",className:"hidden",onChange:i=>i.target.files&&h(i.target.files[0])}),e.jsx("span",{className:"px-4 py-2 bg-cyan-600 text-white rounded cursor-pointer hover:bg-cyan-500 transition-colors",children:"Browse Files"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:m,onChange:i=>y(i.target.value),placeholder:"e.g., ransomware, suspicious, campaign-123",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Notes"}),e.jsx("textarea",{value:f,onChange:i=>p(i.target.value),placeholder:"Optional notes about this sample...",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white h-20"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-300 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{onClick:j,disabled:!c||g,className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:g?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Upload & Analyze"]})})]})]})}):null},ze=({sample:t,isOpen:a,onClose:u,onAnalyze:g})=>{const[c,h]=x.useState("overview"),{data:m}=b({queryKey:["sample-strings",t==null?void 0:t.id],queryFn:()=>t!=null&&t.id?N.getSampleStrings(t.id).then(r=>r.data):Promise.resolve([]),enabled:a&&!!(t!=null&&t.id)&&c==="strings"}),{data:y}=b({queryKey:["sample-imports",t==null?void 0:t.id],queryFn:()=>t!=null&&t.id?N.getSampleImports(t.id).then(r=>r.data):Promise.resolve([]),enabled:a&&!!(t!=null&&t.id)&&c==="imports"}),{data:f}=b({queryKey:["sample-iocs",t==null?void 0:t.id],queryFn:()=>t!=null&&t.id?N.getSampleIocs(t.id).then(r=>r.data):Promise.resolve([]),enabled:a&&!!(t!=null&&t.id)&&c==="iocs"}),{data:p}=b({queryKey:["sample-yara",t==null?void 0:t.id],queryFn:()=>t!=null&&t.id?N.getYaraMatches(t.id).then(r=>r.data):Promise.resolve([]),enabled:a&&!!(t!=null&&t.id)&&c==="yara"});if(!a||!t)return null;const C=r=>{navigator.clipboard.writeText(r),o.success("Copied to clipboard")};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-cyan-500",children:xe(t.file_type)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:t.original_filename}),e.jsxs("p",{className:"text-gray-400 text-sm font-mono",children:[t.sha256.substring(0,32),"..."]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`px-3 py-1 rounded font-bold ${ce(t.threat_score)}`,children:["Threat Score: ",t.threat_score??"N/A"]}),e.jsx("button",{onClick:u,className:"text-gray-400 hover:text-white",children:e.jsx(G,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"flex border-b border-gray-700",children:["overview","strings","imports","iocs","yara"].map(r=>e.jsx("button",{onClick:()=>h(r),className:`px-4 py-2 text-sm font-medium transition-colors ${c===r?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:r.charAt(0).toUpperCase()+r.slice(1)},r))}),e.jsxs("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:[c==="overview"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"File Info"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"File Type:"}),e.jsx("span",{className:"text-white",children:t.file_type.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"File Size:"}),e.jsx("span",{className:"text-white",children:X(t.file_size)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Entropy:"}),e.jsx("span",{className:`text-white ${t.entropy>7.5?"text-red-400":""}`,children:t.entropy.toFixed(4)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Source:"}),e.jsx("span",{className:"text-white",children:t.source})]})]}),e.jsx("h3",{className:"text-lg font-semibold text-white mt-4",children:"Hashes"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 p-2 rounded",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"MD5:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-white font-mono text-sm",children:t.md5}),e.jsx("button",{onClick:()=>C(t.md5),className:"text-gray-400 hover:text-white",children:e.jsx(te,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 p-2 rounded",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"SHA256:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-white font-mono text-sm truncate max-w-xs",children:t.sha256}),e.jsx("button",{onClick:()=>C(t.sha256),className:"text-gray-400 hover:text-white",children:e.jsx(te,{className:"w-4 h-4"})})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Classification"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Classification:"}),e.jsx("span",{className:"text-white",children:t.classification||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Family:"}),e.jsx("span",{className:"text-white",children:t.family||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),t.is_malicious===!0&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-red-500/20 text-red-400",children:"Malicious"}),t.is_malicious===!1&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-green-500/20 text-green-400",children:"Clean"}),t.is_malicious===void 0&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-gray-500/20 text-gray-400",children:"Unknown"})]})]}),e.jsx("h3",{className:"text-lg font-semibold text-white mt-4",children:"Timeline"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"First Seen:"}),e.jsx("span",{className:"text-white",children:O(t.first_seen)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Last Analyzed:"}),e.jsx("span",{className:"text-white",children:t.last_analyzed?O(t.last_analyzed):"Never"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Analysis Count:"}),e.jsx("span",{className:"text-white",children:t.analysis_count})]})]}),t.tags&&t.tags.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mt-4",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((r,l)=>e.jsx("span",{className:"px-2 py-1 bg-gray-700 rounded text-sm text-gray-300",children:r},l))})]})]})]}),c==="strings"&&e.jsx("div",{className:"space-y-2",children:m&&m.length>0?e.jsx("div",{className:"space-y-1 font-mono text-sm",children:m.slice(0,100).map((r,l)=>e.jsxs("div",{className:"flex items-start space-x-2 p-2 bg-gray-900 rounded",children:[e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-400",children:r.category}),e.jsx("span",{className:"text-white break-all",children:r.value})]},l))}):e.jsx("p",{className:"text-gray-400",children:"No interesting strings found."})}),c==="imports"&&e.jsx("div",{className:"space-y-4",children:y&&y.length>0?y.map((r,l)=>e.jsxs("div",{className:"bg-gray-900 rounded p-3",children:[e.jsx("h4",{className:"text-cyan-400 font-medium mb-2",children:r.library}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r.functions.map((w,j)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-300 font-mono",children:w},j))})]},l)):e.jsx("p",{className:"text-gray-400",children:"No imports found."})}),c==="iocs"&&e.jsx("div",{className:"space-y-2",children:f&&f.length>0?f.map((r,l)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 rounded p-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-cyan-500",children:de(r.ioc_type)}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-mono",children:r.value}),e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-400",children:r.ioc_type})]})]}),e.jsxs("span",{className:"text-gray-400 text-sm",children:[(r.confidence*100).toFixed(0),"% confidence"]})]},l)):e.jsx("p",{className:"text-gray-400",children:"No IOCs extracted."})}),c==="yara"&&e.jsx("div",{className:"space-y-2",children:p&&p.length>0?p.map((r,l)=>{var w;return e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 rounded p-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(K,{className:"w-5 h-5 text-orange-400"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-medium",children:r.rule_name}),e.jsx("div",{className:"flex gap-1 mt-1",children:(w=r.tags)==null?void 0:w.map((j,i)=>e.jsx("span",{className:"px-2 py-0.5 bg-orange-500/20 rounded text-xs text-orange-400",children:j},i))})]})]}),e.jsx("span",{className:"text-gray-400 text-sm",children:O(r.matched_at)})]},l)}):e.jsx("p",{className:"text-gray-400",children:"No YARA matches."})})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 border-t border-gray-700",children:[e.jsxs("button",{onClick:g,className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors flex items-center",children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Re-analyze"]}),e.jsx("button",{onClick:u,className:"px-4 py-2 text-gray-300 hover:text-white transition-colors",children:"Close"})]})]})})},Qe=({isOpen:t,config:a,onClose:u,onSave:g})=>{const[c,h]=x.useState(""),[m,y]=x.useState("cuckoo"),[f,p]=x.useState(""),[C,r]=x.useState(""),[l,w]=x.useState(300),[j,i]=x.useState(!1),[A,q]=x.useState(!0),[R,D]=x.useState(!1);Se.useEffect(()=>{a?(h(a.name),y(a.sandbox_type),p(a.api_url),r(""),w(a.timeout_seconds),i(a.is_default),q(a.is_active)):(h(""),y("cuckoo"),p(""),r(""),w(300),i(!1),q(!0))},[a]);const U=async d=>{d.preventDefault(),D(!0);try{const M={name:c,sandbox_type:m,api_url:f,api_key:C||void 0,timeout_seconds:l,is_default:j,is_active:A};a?(await F.updateConfig(a.id,M),o.success("Sandbox configuration updated")):(await F.createConfig(M),o.success("Sandbox configuration created")),g()}catch{o.error("Failed to save sandbox configuration")}finally{D(!1)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 w-full max-w-lg",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:a?"Edit Sandbox Configuration":"Add Sandbox Configuration"}),e.jsx("button",{onClick:u,className:"text-gray-400 hover:text-white",children:e.jsx(G,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:U,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:c,onChange:d=>h(d.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"My Cuckoo Sandbox",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Sandbox Type"}),e.jsxs("select",{value:m,onChange:d=>y(d.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"cuckoo",children:"Cuckoo Sandbox"}),e.jsx("option",{value:"anyrun",children:"Any.Run"}),e.jsx("option",{value:"hybrid_analysis",children:"Hybrid Analysis"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"API URL"}),e.jsx("input",{type:"url",value:f,onChange:d=>p(d.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"https://sandbox.example.com/api",required:!0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[m==="cuckoo"&&"e.g., http://localhost:8090",m==="anyrun"&&"e.g., https://api.any.run",m==="hybrid_analysis"&&"e.g., https://www.hybrid-analysis.com/api/v2"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["API Key ",a&&e.jsx("span",{className:"text-gray-500",children:"(leave empty to keep existing)"})]}),e.jsx("input",{type:"password",value:C,onChange:d=>r(d.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"••••••••••••••••",required:!a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Timeout (seconds)"}),e.jsx("input",{type:"number",value:l,onChange:d=>w(parseInt(d.target.value)||300),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded text-white focus:outline-none focus:border-cyan-500",min:60,max:1800})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:A,onChange:d=>q(d.target.checked),className:"form-checkbox h-4 w-4 text-cyan-500 bg-gray-900 border-gray-700 rounded focus:ring-0"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Active"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:j,onChange:d=>i(d.target.checked),className:"form-checkbox h-4 w-4 text-cyan-500 bg-gray-900 border-gray-700 rounded focus:ring-0"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Default Sandbox"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:u,className:"px-4 py-2 text-gray-300 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:R,className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors flex items-center disabled:opacity-50",children:R?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"w-4 h-4 mr-2"}),a?"Update":"Create"]})})]})]})]})}):null},ss=()=>{const t=ve(),[a,u]=x.useState("samples"),[g,c]=x.useState(!1),[h,m]=x.useState(null),[y,f]=x.useState(""),[p,C]=x.useState(""),{hasEngagement:r}=Pe(),{data:l,isLoading:w}=b({queryKey:["malware-stats"],queryFn:()=>N.getStats().then(s=>s.data)}),{data:j,isLoading:i,refetch:A}=b({queryKey:["malware-samples",y,p],queryFn:()=>N.listSamples({search:y||void 0,file_type:p||void 0,limit:100}).then(s=>s.data)}),{data:q,isLoading:R}=b({queryKey:["yara-rules"],queryFn:()=>N.listYaraRules({include_builtin:!0}).then(s=>s.data),enabled:a==="yara"}),{data:D,isLoading:U}=b({queryKey:["malware-iocs"],queryFn:()=>N.listIocs({limit:100}).then(s=>s.data),enabled:a==="iocs"}),{data:d,isLoading:M}=b({queryKey:["malware-queue"],queryFn:()=>N.listQueue().then(s=>s.data),enabled:a==="queue"}),{data:E,isLoading:oe,refetch:me}=b({queryKey:["sandbox-configs"],queryFn:()=>F.listConfigs().then(s=>s.data),enabled:a==="sandbox"}),{data:z,isLoading:he,refetch:ue}=b({queryKey:["sandbox-submissions"],queryFn:()=>F.listSubmissions({limit:50}).then(s=>s.data),enabled:a==="sandbox"}),{data:v,isLoading:Be}=b({queryKey:["sandbox-stats"],queryFn:()=>F.getStats().then(s=>s.data),enabled:a==="sandbox"}),L=v?{total_submissions:v.reduce((s,n)=>s+n.total_submissions,0),pending_submissions:v.reduce((s,n)=>s+n.pending,0),running_submissions:v.reduce((s,n)=>s+n.running,0),completed_submissions:v.reduce((s,n)=>s+n.completed,0),failed_submissions:v.reduce((s,n)=>s+n.failed,0),malicious_count:v.reduce((s,n)=>s+n.malicious,0),suspicious_count:v.reduce((s,n)=>s+n.suspicious,0),clean_count:v.reduce((s,n)=>s+n.clean,0),by_type:v}:void 0,Z=T({mutationFn:s=>{const n=new FormData;return n.append("file",s.file),n.append("tags",s.tags.join(",")),n.append("notes",s.notes),N.uploadSample(n)},onSuccess:()=>{o.success("Sample uploaded and queued for analysis"),c(!1),t.invalidateQueries({queryKey:["malware-samples"]}),t.invalidateQueries({queryKey:["malware-stats"]}),t.invalidateQueries({queryKey:["malware-queue"]})},onError:s=>{var n,_;o.error(((_=(n=s.response)==null?void 0:n.data)==null?void 0:_.error)||"Failed to upload sample")}}),W=T({mutationFn:s=>N.analyzeSample(s),onSuccess:s=>{o.success(`Analysis complete. Threat score: ${s.data.threat_score}`),t.invalidateQueries({queryKey:["malware-samples"]}),t.invalidateQueries({queryKey:["malware-stats"]}),h&&m(null)},onError:()=>{o.error("Failed to analyze sample")}}),ye=T({mutationFn:s=>N.deleteSample(s),onSuccess:()=>{o.success("Sample deleted"),t.invalidateQueries({queryKey:["malware-samples"]}),t.invalidateQueries({queryKey:["malware-stats"]})},onError:()=>{o.error("Failed to delete sample")}}),[pe,P]=x.useState(!1),[ge,$]=x.useState(null),[Ye,je]=x.useState(!1),[Oe,be]=x.useState(null),Q=T({mutationFn:s=>F.testConnection(s),onSuccess:s=>{s.data.success?o.success(`Connection successful: ${s.data.message}`):o.error(`Connection failed: ${s.data.message}`)},onError:()=>{o.error("Failed to test sandbox connection")}});T({mutationFn:s=>F.submitSample(s),onSuccess:()=>{o.success("Sample submitted to sandbox for analysis"),je(!1),be(null),t.invalidateQueries({queryKey:["sandbox-submissions"]}),t.invalidateQueries({queryKey:["sandbox-stats"]})},onError:s=>{var n,_;o.error(((_=(n=s.response)==null?void 0:n.data)==null?void 0:_.error)||"Failed to submit to sandbox")}});const Ne=T({mutationFn:s=>F.deleteConfig(s),onSuccess:()=>{o.success("Sandbox configuration deleted"),t.invalidateQueries({queryKey:["sandbox-configs"]})},onError:()=>{o.error("Failed to delete sandbox configuration")}}),B=T({mutationFn:s=>F.getStatus(s),onSuccess:s=>{o.success(`Status: ${s.data.status}${s.data.message?` - ${s.data.message}`:""}`),t.invalidateQueries({queryKey:["sandbox-submissions"]})},onError:()=>{o.error("Failed to poll submission status")}}),fe=s=>{switch(s==null?void 0:s.toLowerCase()){case"malicious":return"bg-red-500/20 text-red-400";case"suspicious":return"bg-orange-500/20 text-orange-400";case"clean":return"bg-green-500/20 text-green-400";default:return"bg-gray-500/20 text-gray-400"}},we=s=>{switch(s.toLowerCase()){case"completed":return"bg-green-500/20 text-green-400";case"running":return"bg-blue-500/20 text-blue-400";case"pending":return"bg-yellow-500/20 text-yellow-400";case"failed":return"bg-red-500/20 text-red-400";case"timeout":return"bg-orange-500/20 text-orange-400";default:return"bg-gray-500/20 text-gray-400"}};return e.jsxs(Re,{children:[e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center",children:[e.jsx(ae,{className:"w-7 h-7 mr-2 text-red-500"}),"Malware Analysis"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Upload and analyze malware samples with static analysis and YARA matching"})]}),e.jsxs("button",{onClick:()=>c(!0),disabled:!r,className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Upload Sample"]})]}),e.jsx($e,{toolName:"Malware Analysis",className:"mb-6"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(k,{title:"Total Samples",value:(l==null?void 0:l.total_samples)??0,icon:e.jsx(H,{className:"w-6 h-6 text-white"}),color:"bg-cyan-500/20"}),e.jsx(k,{title:"Malicious",value:(l==null?void 0:l.samples_malicious)??0,icon:e.jsx(J,{className:"w-6 h-6 text-white"}),color:"bg-red-500/20"}),e.jsx(k,{title:"YARA Rules",value:(l==null?void 0:l.total_yara_rules)??0,icon:e.jsx(K,{className:"w-6 h-6 text-white"}),color:"bg-orange-500/20"}),e.jsx(k,{title:"IOCs Extracted",value:(l==null?void 0:l.total_iocs)??0,icon:e.jsx(re,{className:"w-6 h-6 text-white"}),color:"bg-purple-500/20"})]}),e.jsx("div",{className:"flex border-b border-gray-700",children:["samples","yara","iocs","queue","sandbox"].map(s=>e.jsxs("button",{onClick:()=>u(s),className:`px-6 py-3 text-sm font-medium transition-colors ${a===s?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:[s==="samples"&&"Samples",s==="yara"&&"YARA Rules",s==="iocs"&&"IOCs",s==="queue"&&"Analysis Queue",s==="sandbox"&&"Sandbox"]},s))}),a==="samples"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Ce,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by filename, hash, or notes...",value:y,onChange:s=>f(s.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded pl-10 pr-4 py-2 text-white"})]}),e.jsxs("select",{value:p,onChange:s=>C(s.target.value),className:"bg-gray-800 border border-gray-700 rounded px-4 py-2 text-white",children:[e.jsx("option",{value:"",children:"All File Types"}),e.jsx("option",{value:"pe",children:"PE"}),e.jsx("option",{value:"elf",children:"ELF"}),e.jsx("option",{value:"script",children:"Script"}),e.jsx("option",{value:"pdf",children:"PDF"}),e.jsx("option",{value:"apk",children:"APK"})]}),e.jsx("button",{onClick:()=>A(),className:"px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600 transition-colors",children:e.jsx(Y,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Sample"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Size"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Threat"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Classification"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:i?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(S,{className:"w-6 h-6 animate-spin mx-auto"})})}):j&&j.length>0?j.map(s=>e.jsx(Ue,{sample:s,onSelect:()=>m(s),onAnalyze:()=>W.mutate(s.id),onDelete:()=>{confirm("Are you sure you want to delete this sample?")&&ye.mutate(s.id)}},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-400",children:"No samples found. Upload a sample to get started."})})})]})})]}),a==="yara"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Rule Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Matches"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Status"})]})}),e.jsx("tbody",{children:R?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(S,{className:"w-6 h-6 animate-spin mx-auto"})})}):q&&q.length>0?q.map(s=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{className:"w-4 h-4 text-orange-400"}),e.jsx("span",{className:"text-white font-medium",children:s.name})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.category}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.severity==="critical"?"bg-red-500/20 text-red-400":s.severity==="high"?"bg-orange-500/20 text-orange-400":s.severity==="medium"?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400"}`,children:s.severity})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.is_builtin?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400"}`,children:s.is_builtin?"Built-in":"Custom"})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.match_count}),e.jsx("td",{className:"px-4 py-3",children:s.is_enabled?e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-green-500/20 text-green-400",children:"Enabled"}):e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-gray-500/20 text-gray-400",children:"Disabled"})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:"No YARA rules found."})})})]})})}),a==="iocs"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"IOC Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Value"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Sample"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Confidence"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Date"})]})}),e.jsx("tbody",{children:U?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(S,{className:"w-6 h-6 animate-spin mx-auto"})})}):D&&D.length>0?D.map(s=>{var n;return e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[de(s.ioc_type),e.jsx("span",{className:"text-gray-300",children:s.ioc_type})]})}),e.jsx("td",{className:"px-4 py-3 text-white font-mono text-sm",children:s.value}),e.jsx("td",{className:"px-4 py-3 text-gray-300 text-sm",children:s.sample_filename||((n=s.sample_sha256)==null?void 0:n.substring(0,16))+"..."}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`px-2 py-1 rounded text-xs ${s.confidence>=.8?"bg-green-500/20 text-green-400":s.confidence>=.5?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400"}`,children:[(s.confidence*100).toFixed(0),"%"]})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(s.created_at).toLocaleDateString()})]},s.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-400",children:"No IOCs extracted yet."})})})]})})}),a==="queue"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Sample"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Analysis Types"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Priority"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Attempts"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Created"})]})}),e.jsx("tbody",{children:M?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(S,{className:"w-6 h-6 animate-spin mx-auto"})})}):d&&d.length>0?d.map(s=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.sample_filename}),e.jsxs("p",{className:"text-gray-500 text-xs font-mono",children:[s.sample_sha256.substring(0,16),"..."]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.analysis_types.split(",").map((n,_)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-300",children:n.trim()},_))})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.priority}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.status==="pending"?"bg-yellow-500/20 text-yellow-400":s.status==="running"?"bg-blue-500/20 text-blue-400":s.status==="completed"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:s.status})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.attempts}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(s.created_at).toLocaleDateString()})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:"No items in queue."})})})]})})}),a==="sandbox"&&e.jsxs("div",{className:"space-y-6",children:[L&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx(k,{title:"Total Submissions",value:L.total_submissions,icon:e.jsx(H,{className:"w-6 h-6 text-white"}),color:"bg-cyan-500/20"}),e.jsx(k,{title:"Pending",value:L.pending_submissions,icon:e.jsx(_e,{className:"w-6 h-6 text-white"}),color:"bg-yellow-500/20"}),e.jsx(k,{title:"Running",value:L.running_submissions,icon:e.jsx(S,{className:"w-6 h-6 text-white animate-spin"}),color:"bg-blue-500/20"}),e.jsx(k,{title:"Completed",value:L.completed_submissions,icon:e.jsx(ne,{className:"w-6 h-6 text-white"}),color:"bg-green-500/20"}),e.jsx(k,{title:"Malicious",value:L.malicious_count,icon:e.jsx(J,{className:"w-6 h-6 text-white"}),color:"bg-red-500/20"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center",children:[e.jsx(K,{className:"w-5 h-5 mr-2 text-cyan-500"}),"Sandbox Configurations"]}),e.jsxs("button",{onClick:()=>{$(null),P(!0)},className:"px-3 py-1.5 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors flex items-center text-sm",children:[e.jsx(ke,{className:"w-4 h-4 mr-1"}),"Add Sandbox"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"API URL"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Timeout"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:oe?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:[e.jsx(S,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Loading configurations..."]})}):E&&E.length>0?E.map(s=>e.jsxs("tr",{className:"hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-white font-medium",children:s.name}),s.is_default&&e.jsx("span",{className:"px-2 py-0.5 bg-cyan-500/20 text-cyan-400 rounded text-xs",children:"Default"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 bg-gray-700 rounded text-xs text-gray-300 uppercase",children:s.sandbox_type})}),e.jsx("td",{className:"px-4 py-3 text-gray-300 text-sm font-mono truncate max-w-xs",children:s.api_url}),e.jsxs("td",{className:"px-4 py-3 text-gray-300",children:[s.timeout_seconds,"s"]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.is_active?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:s.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>Q.mutate(s.id),className:"p-1.5 text-gray-400 hover:text-cyan-400 transition-colors",title:"Test Connection",disabled:Q.isPending,children:Q.isPending?e.jsx(S,{className:"w-4 h-4 animate-spin"}):e.jsx(V,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{$(s),P(!0)},className:"p-1.5 text-gray-400 hover:text-white transition-colors",title:"Edit",children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{confirm("Delete this sandbox configuration?")&&Ne.mutate(s.id)},className:"p-1.5 text-gray-400 hover:text-red-400 transition-colors",title:"Delete",children:e.jsx(le,{className:"w-4 h-4"})})]})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:"No sandbox configurations. Add one to start analyzing samples in sandboxes."})})})]})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center",children:[e.jsx(Fe,{className:"w-5 h-5 mr-2 text-cyan-500"}),"Recent Sandbox Submissions"]}),e.jsx("button",{onClick:()=>ue(),className:"p-2 text-gray-400 hover:text-white transition-colors",title:"Refresh",children:e.jsx(Y,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Sample"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Sandbox"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Verdict"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Threat Score"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Submitted"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:he?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-400",children:[e.jsx(S,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Loading submissions..."]})}):z&&z.length>0?z.map(s=>{var n;return e.jsxs("tr",{className:"hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium truncate max-w-xs",children:s.sample_filename||"Unknown"}),e.jsxs("p",{className:"text-gray-500 text-xs font-mono",children:[(n=s.sample_sha256)==null?void 0:n.substring(0,16),"..."]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 bg-gray-700 rounded text-xs text-gray-300 uppercase",children:s.sandbox_type})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${we(s.status)}`,children:s.status})}),e.jsx("td",{className:"px-4 py-3",children:s.verdict?e.jsx("span",{className:`px-2 py-1 rounded text-xs ${fe(s.verdict)}`,children:s.verdict}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:s.threat_score!==void 0&&s.threat_score!==null?e.jsx("span",{className:`font-bold ${Ie(s.threat_score)}`,children:s.threat_score}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(s.submitted_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[(s.status==="pending"||s.status==="running")&&e.jsx("button",{onClick:()=>B.mutate(s.id),className:"p-1.5 text-gray-400 hover:text-cyan-400 transition-colors",title:"Poll Status",disabled:B.isPending,children:e.jsx(Y,{className:`w-4 h-4 ${B.isPending?"animate-spin":""}`})}),s.status==="completed"&&s.report_url&&e.jsx("a",{href:s.report_url,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-gray-400 hover:text-cyan-400 transition-colors",title:"View Report",children:e.jsx(ee,{className:"w-4 h-4"})})]})})]},s.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-400",children:"No sandbox submissions. Submit samples to sandboxes from the Samples tab."})})})]})})]})]})]}),e.jsx(Ee,{isOpen:g,onClose:()=>c(!1),onUpload:(s,n,_)=>Z.mutate({file:s,tags:n,notes:_}),isUploading:Z.isPending}),e.jsx(ze,{sample:h,isOpen:!!h,onClose:()=>m(null),onAnalyze:()=>{h&&W.mutate(h.id)}}),e.jsx(Qe,{isOpen:pe,config:ge,onClose:()=>{P(!1),$(null)},onSave:()=>{me(),P(!1),$(null)}})]})};export{ss as default};
