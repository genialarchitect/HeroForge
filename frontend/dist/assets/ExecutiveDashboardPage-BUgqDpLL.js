import{j as e}from"./vendor-state-BXNPjUwt.js";import{u as D,r as a,L as r}from"./vendor-react-5KxtEOLM.js";import{L as F}from"./Layout-BlRtLSTJ.js";import{c as T,V as E}from"./index-t7VPhhr8.js";import{B as I,ap as n,S as b,_ as i,O as K,p as v,f as M,V as B,aw as y,v as z,ad as P,i as O,av as V,al as H}from"./vendor-ui-DGSzT-Xm.js";import{R as c,A as W,u as x,X as m,Y as h,T as g,x as $,B as X,h as Y,v as G,L as U,w as l}from"./vendor-charts-CaL4i8-H.js";import"./vendor-markdown-RN55YrVy.js";import"./vendor-utils-DfRopTPV.js";const u={critical:"#ef4444",high:"#f97316",medium:"#eab308"},re=()=>{const N=D(),[f,p]=a.useState(!0),[k,w]=a.useState([]),[d,_]=a.useState(""),[o,C]=a.useState(6),[s,S]=a.useState(null);a.useEffect(()=>{R(),j()},[]),a.useEffect(()=>{j()},[d,o]);const R=async()=>{try{const t=await T.customers.getAll();w(t.data)}catch(t){console.error("Failed to load customers:",t)}},j=async()=>{p(!0);try{const t=await E.getExecutiveDashboard(d||void 0,o);S(t.data)}catch(t){console.error("Failed to load dashboard:",t),I.error("Failed to load executive dashboard")}finally{p(!1)}},L=t=>{switch(t){case"Improving":return e.jsx(y,{className:"h-5 w-5 text-green-400"});case"Declining":return e.jsx(H,{className:"h-5 w-5 text-red-400"});default:return e.jsx(V,{className:"h-5 w-5 text-yellow-400"})}},A=t=>{switch(t){case"Critical":return"text-red-400 bg-red-500/20";case"High":return"text-orange-400 bg-orange-500/20";case"Medium":return"text-yellow-400 bg-yellow-500/20";default:return"text-green-400 bg-green-500/20"}};return e.jsx(F,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(n,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Executive Dashboard"})]}),e.jsx("p",{className:"text-slate-400",children:"Security posture trends, remediation metrics, and testing coverage"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:d,onChange:t=>_(t.target.value),className:"px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"All Customers"}),k.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:o,onChange:t=>C(Number(t.target.value)),className:"px-3 py-2 bg-dark-surface border border-dark-border rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:3,children:"Last 3 Months"}),e.jsx("option",{value:6,children:"Last 6 Months"}),e.jsx("option",{value:12,children:"Last 12 Months"})]})]})]}),f?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s?e.jsxs("div",{className:"space-y-6",children:[s.summary&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(r,{to:"/compliance",className:"bg-dark-surface rounded-lg border border-dark-border p-4 group hover:border-primary hover:shadow-xl transition-all duration-200 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-slate-400 text-sm",children:"Risk Rating"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5 text-primary"}),e.jsx(i,{className:"h-4 w-4 text-slate-500 group-hover:text-primary transition-colors"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`text-2xl font-bold px-3 py-1 rounded ${A(s.summary.risk_rating)}`,children:s.summary.risk_rating}),L(s.summary.trend_direction)]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:s.summary.trend_direction})]}),e.jsxs(r,{to:"/vulnerabilities",className:"bg-dark-surface rounded-lg border border-dark-border p-4 group hover:border-primary hover:shadow-xl transition-all duration-200 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-slate-400 text-sm",children:"Open Vulnerabilities"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-yellow-400"}),e.jsx(i,{className:"h-4 w-4 text-slate-500 group-hover:text-primary transition-colors"})]})]}),e.jsx("div",{className:"text-3xl font-bold text-white",children:s.summary.open_vulnerabilities}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs",children:[e.jsxs("span",{className:"text-red-400",children:[s.summary.critical_open," Critical"]}),e.jsxs("span",{className:"text-orange-400",children:[s.summary.high_open," High"]})]})]}),e.jsxs(r,{to:"/remediation",className:"bg-dark-surface rounded-lg border border-dark-border p-4 group hover:border-primary hover:shadow-xl transition-all duration-200 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-slate-400 text-sm",children:"Avg Remediation"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-5 w-5 text-cyan-400"}),e.jsx(i,{className:"h-4 w-4 text-slate-500 group-hover:text-primary transition-colors"})]})]}),e.jsxs("div",{className:"text-3xl font-bold text-white",children:[s.summary.avg_remediation_days.toFixed(1),e.jsx("span",{className:"text-lg text-slate-400 ml-1",children:"days"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Time to resolve issues"})]}),e.jsxs(r,{to:"/crm/engagements",className:"bg-dark-surface rounded-lg border border-dark-border p-4 group hover:border-primary hover:shadow-xl transition-all duration-200 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-slate-400 text-sm",children:"Engagements"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5 text-purple-400"}),e.jsx(i,{className:"h-4 w-4 text-slate-500 group-hover:text-primary transition-colors"})]})]}),e.jsxs("div",{className:"text-3xl font-bold text-white",children:[s.summary.active_engagements,e.jsxs("span",{className:"text-lg text-slate-400 ml-1",children:["/ ",s.summary.total_engagements]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Active / Total"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.risk_trends.length>0&&e.jsxs("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5 text-primary"}),"Risk Score Trend"]}),e.jsx(c,{width:"100%",height:250,children:e.jsxs(W,{data:s.risk_trends,children:[e.jsx(x,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(m,{dataKey:"date",tick:{fill:"#94a3b8",fontSize:12},tickFormatter:t=>new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx(h,{tick:{fill:"#94a3b8",fontSize:12}}),e.jsx(g,{contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"8px"}}),e.jsx($,{type:"monotone",dataKey:"risk_score",stroke:"#06b6d4",fill:"#06b6d4",fillOpacity:.2,name:"Risk Score"})]})})]}),s.remediation_velocity&&s.remediation_velocity.velocity_trend.length>0&&e.jsxs("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5 text-green-400"}),"Remediation Velocity"]}),e.jsx(c,{width:"100%",height:250,children:e.jsxs(X,{data:s.remediation_velocity.velocity_trend,children:[e.jsx(x,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(m,{dataKey:"week",tick:{fill:"#94a3b8",fontSize:12}}),e.jsx(h,{tick:{fill:"#94a3b8",fontSize:12}}),e.jsx(g,{contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"8px"}}),e.jsx(Y,{dataKey:"resolved_count",fill:"#22c55e",name:"Resolved",radius:[4,4,0,0]})]})})]})]}),s.security_trends&&s.security_trends.months.length>0&&e.jsxs("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5 text-primary"}),"Security Posture - ",s.security_trends.customer_name]}),s.security_trends.improvement_percent!==0&&e.jsxs("span",{className:`px-3 py-1 rounded text-sm font-medium ${s.security_trends.improvement_percent>0?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:[s.security_trends.improvement_percent>0?"+":"",s.security_trends.improvement_percent.toFixed(1),"%"]})]}),e.jsx(c,{width:"100%",height:300,children:e.jsxs(G,{data:s.security_trends.months,children:[e.jsx(x,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(m,{dataKey:"month",tick:{fill:"#94a3b8",fontSize:12}}),e.jsx(h,{tick:{fill:"#94a3b8",fontSize:12}}),e.jsx(g,{contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"8px"}}),e.jsx(U,{}),e.jsx(l,{type:"monotone",dataKey:"critical",stroke:u.critical,name:"Critical",strokeWidth:2}),e.jsx(l,{type:"monotone",dataKey:"high",stroke:u.high,name:"High",strokeWidth:2}),e.jsx(l,{type:"monotone",dataKey:"medium",stroke:u.medium,name:"Medium",strokeWidth:2}),e.jsx(l,{type:"monotone",dataKey:"resolved",stroke:"#22c55e",name:"Resolved",strokeWidth:2,strokeDasharray:"5 5"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.remediation_velocity&&e.jsxs("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(v,{className:"h-5 w-5 text-cyan-400"}),"Remediation by Severity"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-dark-hover rounded-lg",children:[e.jsx("div",{className:"text-xs text-red-400 mb-1",children:"Critical"}),e.jsxs("div",{className:"text-xl font-bold text-white",children:[s.remediation_velocity.avg_days_critical.toFixed(1),e.jsx("span",{className:"text-sm text-slate-400 ml-1",children:"days"})]})]}),e.jsxs("div",{className:"p-3 bg-dark-hover rounded-lg",children:[e.jsx("div",{className:"text-xs text-orange-400 mb-1",children:"High"}),e.jsxs("div",{className:"text-xl font-bold text-white",children:[s.remediation_velocity.avg_days_high.toFixed(1),e.jsx("span",{className:"text-sm text-slate-400 ml-1",children:"days"})]})]}),e.jsxs("div",{className:"p-3 bg-dark-hover rounded-lg",children:[e.jsx("div",{className:"text-xs text-yellow-400 mb-1",children:"Medium"}),e.jsxs("div",{className:"text-xl font-bold text-white",children:[s.remediation_velocity.avg_days_medium.toFixed(1),e.jsx("span",{className:"text-sm text-slate-400 ml-1",children:"days"})]})]}),e.jsxs("div",{className:"p-3 bg-dark-hover rounded-lg",children:[e.jsx("div",{className:"text-xs text-green-400 mb-1",children:"Low"}),e.jsxs("div",{className:"text-xl font-bold text-white",children:[s.remediation_velocity.avg_days_low.toFixed(1),e.jsx("span",{className:"text-sm text-slate-400 ml-1",children:"days"})]})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-400 text-sm",children:"Remediation Rate"}),e.jsxs("span",{className:"text-lg font-bold text-green-400",children:[s.remediation_velocity.remediation_rate.toFixed(1),"%"]})]}),e.jsx("div",{className:"mt-2 h-2 bg-dark-hover rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 rounded-full transition-all",style:{width:`${Math.min(s.remediation_velocity.remediation_rate,100)}%`}})})]})]}),s.methodology_coverage&&e.jsxs("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5 text-purple-400"}),"Testing Coverage"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"p-3 bg-dark-hover rounded-lg text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-white",children:[s.methodology_coverage.completed_checklists,e.jsx("span",{className:"text-lg text-slate-400 mx-1",children:"/"}),s.methodology_coverage.total_checklists]}),e.jsx("div",{className:"text-xs text-slate-400",children:"Checklists Completed"})]}),e.jsxs("div",{className:"p-3 bg-dark-hover rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:s.methodology_coverage.total_items_tested}),e.jsx("div",{className:"text-xs text-slate-400",children:"Items Tested"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4 text-green-400"}),"Passed"]}),e.jsx("span",{className:"text-green-400",children:s.methodology_coverage.passed_items})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-red-400"}),"Failed"]}),e.jsx("span",{className:"text-red-400",children:s.methodology_coverage.failed_items})]})]}),s.methodology_coverage.coverage_by_framework.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-border",children:[e.jsx("div",{className:"text-sm text-slate-400 mb-2",children:"By Framework"}),e.jsx("div",{className:"space-y-2",children:s.methodology_coverage.coverage_by_framework.map(t=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-white",children:t.framework_name}),e.jsxs("span",{className:"text-slate-400",children:[t.coverage_percent.toFixed(0),"%"]})]}),e.jsx("div",{className:"h-1.5 bg-dark-hover rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary rounded-full transition-all",style:{width:`${t.coverage_percent}%`}})})]},t.framework_name))})]})]})]}),!s.summary&&s.risk_trends.length===0&&!s.remediation_velocity&&!s.methodology_coverage&&e.jsxs("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-8 text-center",children:[e.jsx(n,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"No Analytics Data"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"Start scanning and tracking vulnerabilities to see analytics here."}),e.jsx("button",{onClick:()=>N("/dashboard"),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors",children:"Go to Scans"})]})]}):e.jsxs("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-8 text-center",children:[e.jsx(n,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Failed to Load Dashboard"}),e.jsx("p",{className:"text-slate-400",children:"Please try refreshing the page or check your connection."})]})]})})};export{re as default};
