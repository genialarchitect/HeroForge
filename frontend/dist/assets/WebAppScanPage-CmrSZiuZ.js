import{j as e}from"./vendor-state-BeiY7NuG.js";import{r as n}from"./vendor-react-B7quoyFx.js";import{S as C,q as T,G as M,B as g,az as I,y as P,w as D,aB as R}from"./vendor-ui-CIfVO3s3.js";import{C as b,I as w,o as h,B as H,L as F,w as U}from"./index-CLUXwptY.js";import"./vendor-charts-Bc9tqyL6.js";const A=({onSuccess:d})=>{const[c,m]=n.useState(""),[r,u]=n.useState(3),[j,N]=n.useState(100),[y,v]=n.useState(!0),[o,S]=n.useState({headers:!0,forms:!0,sqli:!0,xss:!0,info_disclosure:!0}),[l,i]=n.useState(!1),t=s=>{S(x=>({...x,[s]:!x[s]}))},a=async s=>{var x,k;if(s.preventDefault(),!c.trim()){g.error("Please enter a target URL");return}try{const p=new URL(c);if(!["http:","https:"].includes(p.protocol)){g.error("URL must start with http:// or https://");return}}catch{g.error("Please enter a valid URL (e.g., https://example.com)");return}i(!0);try{const p=Object.entries(o).filter(([L,_])=>_).map(([L,_])=>L),f=await U.startScan({target_url:c.trim(),max_depth:r,max_pages:j,respect_robots_txt:y,checks_enabled:p});g.success(`Web application scan started for ${c}`),d&&f.data.scan_id&&d(f.data.scan_id)}catch(p){const f=((k=(x=p.response)==null?void 0:x.data)==null?void 0:k.error)||"Failed to start web application scan";g.error(f)}finally{i(!1)}};return e.jsx(b,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(C,{className:"w-6 h-6 text-purple-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Web Application Security Scan"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Scan web applications for common vulnerabilities and misconfigurations"})]})]}),e.jsxs("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg flex items-start gap-3",children:[e.jsx(T,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Security Notice:"})," Only scan web applications you own or have explicit permission to test. Unauthorized scanning may be illegal."]})]}),e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"targetUrl",className:"block text-sm font-medium text-gray-700 mb-1",children:"Target URL *"}),e.jsx(w,{id:"targetUrl",type:"text",placeholder:"https://example.com",value:c,onChange:s=>m(s.target.value),disabled:l}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Full URL including http:// or https://"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"maxDepth",className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Crawl Depth"}),e.jsx(w,{id:"maxDepth",type:"number",min:"1",max:"10",value:r,onChange:s=>u(parseInt(s.target.value)||3),disabled:l}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How many levels deep to crawl (1-10)"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"maxPages",className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Pages"}),e.jsx(w,{id:"maxPages",type:"number",min:"10",max:"1000",value:j,onChange:s=>N(parseInt(s.target.value)||100),disabled:l}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum pages to crawl (10-1000)"})]})]}),e.jsxs("div",{children:[e.jsx(h,{id:"respectRobotsTxt",checked:y,onChange:s=>v(s.target.checked),label:"Respect robots.txt",disabled:l}),e.jsx("p",{className:"text-xs text-gray-500 ml-6 mt-1",children:"Skip URLs disallowed in robots.txt"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Security Checks"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{id:"check_headers",checked:o.headers,onChange:()=>t("headers"),label:"Security Headers",disabled:l}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Check for missing or insecure HTTP security headers"}),e.jsx(h,{id:"check_forms",checked:o.forms,onChange:()=>t("forms"),label:"Form Analysis",disabled:l}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Detect forms and check for insecure configurations"}),e.jsx(h,{id:"check_sqli",checked:o.sqli,onChange:()=>t("sqli"),label:"SQL Injection Testing",disabled:l}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Test for SQL injection vulnerabilities (error-based)"}),e.jsx(h,{id:"check_xss",checked:o.xss,onChange:()=>t("xss"),label:"Cross-Site Scripting (XSS)",disabled:l}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Test for reflected XSS vulnerabilities"}),e.jsx(h,{id:"check_info_disclosure",checked:o.info_disclosure,onChange:()=>t("info_disclosure"),label:"Information Disclosure",disabled:l}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Check for sensitive information in responses"})]})]}),e.jsx("div",{className:"flex gap-3 pt-2",children:e.jsx(H,{type:"submit",disabled:l,className:"flex items-center gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx(F,{size:"sm"}),"Starting Scan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-4 h-4"}),"Start Web App Scan"]})})})]})]})})},W=({scanId:d})=>{const[c,m]=n.useState(!0),[r,u]=n.useState(null),[j,N]=n.useState("running");n.useEffect(()=>{const t=async()=>{try{const a=await U.getScan(d);N(a.data.status),a.data.result?(u(a.data.result),m(!1)):a.data.status==="running"&&setTimeout(t,2e3)}catch{g.error("Failed to fetch scan results"),m(!1)}};t()},[d]);const y=t=>{switch(t){case"Critical":return"text-red-700 bg-red-100";case"High":return"text-orange-700 bg-orange-100";case"Medium":return"text-yellow-700 bg-yellow-100";case"Low":return"text-blue-700 bg-blue-100";default:return"text-gray-700 bg-gray-100"}},v=t=>{switch(t){case"Critical":case"High":return e.jsx(I,{className:"w-5 h-5"});case"Medium":return e.jsx(T,{className:"w-5 h-5"});case"Low":return e.jsx(R,{className:"w-5 h-5"});default:return e.jsx(R,{className:"w-5 h-5"})}},o=t=>({MissingSecurityHeader:"Missing Security Header",InsecureHeader:"Insecure Header Configuration",SqlInjection:"SQL Injection",CrossSiteScripting:"Cross-Site Scripting (XSS)",SensitiveInfoDisclosure:"Information Disclosure",InsecureForm:"Insecure Form",WeakCryptography:"Weak Cryptography",DirectoryListing:"Directory Listing",Other:"Other Security Issue"})[t]||t,S=t=>{const a={};return t.forEach(s=>{a[s.finding_type]||(a[s.finding_type]=[]),a[s.finding_type].push(s)}),a};if(c||j==="running")return e.jsx(b,{children:e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(F,{size:"lg",className:"mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Scanning Web Application..."}),e.jsx("p",{className:"text-gray-600",children:"This may take several minutes depending on the size of the application."})]})});if(!r)return e.jsx(b,{children:e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(I,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No results available"})]})});const l=S(r.findings),i=r.findings.reduce((t,a)=>(t[a.severity]=(t[a.severity]||0)+1,t),{});return e.jsxs("div",{className:"space-y-6",children:[e.jsx(b,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(C,{className:"w-6 h-6 text-purple-500"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Scan Summary"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Target URL"}),e.jsxs("div",{className:"font-semibold text-gray-900 break-all flex items-center gap-2",children:[r.url,e.jsx("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700",children:e.jsx(P,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Pages Crawled"}),e.jsx("div",{className:"font-semibold text-gray-900",children:r.pages_crawled})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Findings"}),e.jsx("div",{className:"font-semibold text-gray-900",children:r.findings.length})]})]}),r.findings.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.Critical&&e.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium text-red-700 bg-red-100",children:[i.Critical," Critical"]}),i.High&&e.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium text-orange-700 bg-orange-100",children:[i.High," High"]}),i.Medium&&e.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium text-yellow-700 bg-yellow-100",children:[i.Medium," Medium"]}),i.Low&&e.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium text-blue-700 bg-blue-100",children:[i.Low," Low"]})]}),r.findings.length===0&&e.jsxs("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-3",children:[e.jsx(D,{className:"w-5 h-5 text-green-600"}),e.jsx("p",{className:"text-green-800",children:"No security issues found! The application appears to be well-configured."})]})]})}),Object.entries(l).map(([t,a])=>e.jsx(b,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:[o(t)," (",a.length,")"]}),e.jsx("div",{className:"space-y-4",children:a.map((s,x)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"flex items-start gap-3 mb-3",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1 ${y(s.severity)}`,children:[v(s.severity),s.severity]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"URL:"}),e.jsx("div",{className:"text-sm text-gray-900 break-all font-mono bg-gray-50 p-2 rounded",children:s.url})]}),s.parameter&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Parameter:"}),e.jsx("div",{className:"text-sm text-gray-900 font-mono bg-gray-50 p-2 rounded",children:s.parameter})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Evidence:"}),e.jsx("div",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded font-mono",children:s.evidence})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Remediation:"}),e.jsx("div",{className:"text-sm text-gray-900 bg-blue-50 p-3 rounded border border-blue-200",children:s.remediation})]})]})]},x))})]})},t))]})},Q=()=>{const[d,c]=n.useState(null),m=u=>{c(u)},r=()=>{c(null)};return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(C,{className:"w-8 h-8 text-purple-600"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Web Application Scanner"})]}),e.jsx("p",{className:"text-gray-600",children:"Perform comprehensive security testing on web applications"})]}),d?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:r,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"New Scan"})}),e.jsx(W,{scanId:d})]}):e.jsx(A,{onSuccess:m})]})})};export{Q as default};
