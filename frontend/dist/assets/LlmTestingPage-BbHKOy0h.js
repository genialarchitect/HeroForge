import{b as M,u as b,d as E,j as e}from"./vendor-state-DdX3IZQk.js";import{r as p}from"./vendor-react-Da1CiaFS.js";import{B as u,ah as w,aR as y,F as C,m as T,aD as _,aH as k,T as S,ae as A,aA as O,aN as $,z,J,p as K,a as Q,at as G,aG as V}from"./vendor-ui-B6SJ_7kK.js";import{d as H,b as h,C as i,B as j,L as U}from"./index-CHBEgFD4.js";import"./vendor-charts-gFVtv0RJ.js";const se=()=>{const[c,N]=p.useState("dashboard"),[r,P]=p.useState(null),[n,L]=p.useState([]),g=M(),o=[{name:"Prompt Injection",icon:e.jsx(z,{className:"h-5 w-5"}),color:"text-red-500",description:"Test for malicious prompt injection attacks",testCount:25,passRate:82},{name:"Jailbreak Attempts",icon:e.jsx(J,{className:"h-5 w-5"}),color:"text-orange-500",description:"Bypass safety guardrails and content filters",testCount:18,passRate:91},{name:"Data Extraction",icon:e.jsx(_,{className:"h-5 w-5"}),color:"text-yellow-500",description:"Attempt to extract training data or sensitive information",testCount:12,passRate:94},{name:"Context Manipulation",icon:e.jsx(K,{className:"h-5 w-5"}),color:"text-purple-500",description:"Manipulate conversation context for unintended behavior",testCount:9,passRate:88},{name:"Encoding Attacks",icon:e.jsx(Q,{className:"h-5 w-5"}),color:"text-blue-500",description:"Use encoding techniques to bypass filters",testCount:7,passRate:96}],{data:d,isLoading:D}=b({queryKey:["llm-targets"],queryFn:async()=>[{id:"1",name:"Production Chat API",endpoint:"https://api.example.com/chat",model_type:"GPT-4",created_at:new Date().toISOString()},{id:"2",name:"Internal Assistant",endpoint:"https://internal.example.com/ai",model_type:"Claude",created_at:new Date().toISOString()}]}),{data:t}=b({queryKey:["llm-test-runs"],queryFn:async()=>[{id:"1",target_id:"1",target_name:"Production Chat API",total_tests:71,passed:65,failed:6,vulnerabilities_found:3,status:"completed",started_at:new Date(Date.now()-36e5).toISOString(),completed_at:new Date().toISOString()}]}),{data:m}=b({queryKey:["llm-test-results",r],queryFn:async()=>[{id:"1",test_name:"Prompt Injection - Admin Access",category:"Prompt Injection",status:"failed",severity:"high",vulnerability_found:!0,response:"Successfully bypassed restrictions to access admin functionality",execution_time:1.2,timestamp:new Date().toISOString()},{id:"2",test_name:"Jailbreak - Content Policy",category:"Jailbreak Attempts",status:"passed",severity:"medium",vulnerability_found:!1,response:"Content policy maintained, request rejected appropriately",execution_time:.8,timestamp:new Date().toISOString()}],enabled:!!r}),v=E({mutationFn:async s=>(await new Promise(a=>setTimeout(a,2e3)),{run_id:"new-run-"+Date.now(),total_tests:n.reduce((a,l)=>{const x=o.find(B=>B.name===l);return a+((x==null?void 0:x.testCount)||0)},0)}),onSuccess:s=>{g.invalidateQueries({queryKey:["llm-test-runs"]}),u.success(`Test run started: ${s.total_tests} tests queued`),N("results")},onError:()=>{u.error("Failed to start test run")}}),I=()=>{if(!r){u.error("Please select a target");return}if(n.length===0){u.error("Please select at least one test category");return}v.mutate({target_id:r,categories:n})},R=s=>{L(a=>a.includes(s)?a.filter(l=>l!==s):[...a,s])},f=s=>{switch(s){case"passed":return e.jsx(k,{className:"h-4 w-4 text-green-400"});case"failed":return e.jsx(V,{className:"h-4 w-4 text-red-400"});case"running":return e.jsx(y,{className:"h-4 w-4 text-blue-400 animate-spin"});default:return e.jsx(G,{className:"h-4 w-4 text-slate-400"})}},F=o.reduce((s,a)=>s+a.testCount,0),q=(t==null?void 0:t.reduce((s,a)=>s+a.total_tests,0))||0;return e.jsx(H,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[e.jsx(w,{className:"h-8 w-8 text-primary"}),"LLM Security Testing"]}),e.jsx("p",{className:"text-slate-400 mt-2",children:"Test AI and LLM applications for security vulnerabilities"})]}),e.jsxs(h,{variant:"primary",onClick:()=>g.invalidateQueries(),children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(i,{className:"bg-gradient-to-br from-purple-500/10 to-purple-600/10 border-purple-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Built-in Tests"}),e.jsx(C,{className:"h-4 w-4 text-purple-400"})]}),e.jsx("div",{className:"text-3xl font-bold text-white",children:F}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Across 5 categories"})]}),e.jsxs(i,{className:"bg-gradient-to-br from-blue-500/10 to-blue-600/10 border-blue-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Tests Run"}),e.jsx(T,{className:"h-4 w-4 text-blue-400"})]}),e.jsx("div",{className:"text-3xl font-bold text-white",children:q}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[(t==null?void 0:t.length)||0," test runs"]})]}),e.jsxs(i,{className:"bg-gradient-to-br from-red-500/10 to-red-600/10 border-red-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Vulnerabilities"}),e.jsx(_,{className:"h-4 w-4 text-red-400"})]}),e.jsx("div",{className:"text-3xl font-bold text-white",children:(t==null?void 0:t.reduce((s,a)=>s+a.vulnerabilities_found,0))||0}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Found in testing"})]}),e.jsxs(i,{className:"bg-gradient-to-br from-green-500/10 to-green-600/10 border-green-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Pass Rate"}),e.jsx(k,{className:"h-4 w-4 text-green-400"})]}),e.jsxs("div",{className:"text-3xl font-bold text-white",children:[t&&t.length>0?Math.round(t.reduce((s,a)=>s+a.passed,0)/t.reduce((s,a)=>s+a.total_tests,0)*100):0,"%"]}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Average across all runs"})]})]}),e.jsx("div",{className:"flex items-center gap-2 border-b border-dark-border",children:[{id:"dashboard",label:"Dashboard",icon:e.jsx(T,{className:"h-4 w-4"})},{id:"targets",label:"Targets",icon:e.jsx(S,{className:"h-4 w-4"})},{id:"run-test",label:"Run Tests",icon:e.jsx(A,{className:"h-4 w-4"})},{id:"results",label:"Results",icon:e.jsx(C,{className:"h-4 w-4"})}].map(s=>e.jsxs("button",{onClick:()=>N(s.id),className:`flex items-center gap-2 px-4 py-3 font-medium transition-colors border-b-2 ${c===s.id?"text-primary border-primary":"text-slate-400 border-transparent hover:text-white hover:border-slate-600"}`,children:[s.icon,s.label]},s.id))}),c==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(i,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Test Categories"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(s=>e.jsxs("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-5 hover:border-primary transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:`${s.color}`,children:s.icon}),e.jsxs("span",{className:"text-xs font-medium px-2 py-1 bg-slate-700 text-slate-300 rounded",children:[s.testCount," tests"]})]}),e.jsx("h4",{className:"font-semibold text-white mb-2",children:s.name}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:s.description}),s.passRate!==void 0&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500",children:"Pass Rate:"}),e.jsxs("span",{className:"font-medium text-green-400",children:[s.passRate,"%"]})]})]},s.name))})]}),e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Recent Test Runs"}),e.jsxs(j,{variant:"info",children:[(t==null?void 0:t.length)||0," runs"]})]}),e.jsxs("div",{className:"space-y-3",children:[t==null?void 0:t.map(s=>e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[f(s.status),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:s.target_name}),e.jsx("div",{className:"text-sm text-slate-400",children:new Date(s.started_at).toLocaleString()})]})]}),e.jsx(j,{variant:s.status==="completed"?"success":"info",children:s.status})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Total Tests"}),e.jsx("div",{className:"text-white font-medium",children:s.total_tests})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Passed"}),e.jsx("div",{className:"text-green-400 font-medium",children:s.passed})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Failed"}),e.jsx("div",{className:"text-red-400 font-medium",children:s.failed})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Vulnerabilities"}),e.jsx("div",{className:"text-orange-400 font-medium",children:s.vulnerabilities_found})]})]})]},s.id)),(!t||t.length===0)&&e.jsx("div",{className:"text-center py-8 text-slate-500",children:'No test runs yet. Go to "Run Tests" to start testing.'})]})]})]}),c==="targets"&&e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"LLM Targets"}),e.jsxs(h,{variant:"primary",size:"sm",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Add Target"]})]}),D?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(U,{})}):e.jsx("div",{className:"space-y-3",children:d==null?void 0:d.map(s=>e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{className:"h-5 w-5 text-primary"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:s.name}),e.jsx("div",{className:"text-sm text-slate-400",children:s.endpoint})]})]}),e.jsx(j,{variant:"info",children:s.model_type})]}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Added: ",new Date(s.created_at).toLocaleString()]})]},s.id))})]}),c==="run-test"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Select Target"}),e.jsx("div",{className:"space-y-2",children:d==null?void 0:d.map(s=>e.jsxs("button",{onClick:()=>P(s.id),className:`w-full p-4 rounded-lg border transition-colors text-left ${r===s.id?"bg-primary/20 border-primary text-white":"bg-dark-bg border-dark-border text-slate-300 hover:border-primary"}`,children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-slate-400",children:s.endpoint})]},s.id))})]}),e.jsxs(i,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Select Test Categories"}),e.jsx("div",{className:"space-y-2 mb-6",children:o.map(s=>e.jsxs("button",{onClick:()=>R(s.name),className:`w-full p-4 rounded-lg border transition-colors text-left ${n.includes(s.name)?"bg-primary/20 border-primary":"bg-dark-bg border-dark-border hover:border-primary"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:s.color,children:s.icon}),e.jsx("span",{className:"font-medium text-white",children:s.name})]}),e.jsxs("span",{className:"text-xs text-slate-400",children:[s.testCount," tests"]})]}),e.jsx("p",{className:"text-sm text-slate-400",children:s.description})]},s.name))}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border mb-4",children:[e.jsx("div",{className:"text-sm text-slate-400 mb-2",children:"Tests to run:"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:n.reduce((s,a)=>{const l=o.find(x=>x.name===a);return s+((l==null?void 0:l.testCount)||0)},0)})]}),e.jsxs(h,{variant:"primary",className:"w-full",onClick:I,loading:v.isPending,disabled:!r||n.length===0,children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Run Tests"]})]})]}),c==="results"&&e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Test Results"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(h,{variant:"secondary",size:"sm",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Filter"]}),e.jsxs(h,{variant:"secondary",size:"sm",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Export"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[m==null?void 0:m.map(s=>e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[f(s.status),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:s.test_name}),e.jsx("div",{className:"text-sm text-slate-400",children:s.category})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{variant:s.vulnerability_found?"danger":"success",children:s.vulnerability_found?"Vulnerable":"Secure"}),e.jsx(j,{variant:"warning",children:s.severity})]})]}),e.jsxs("div",{className:"p-3 bg-dark-surface rounded border border-dark-border mb-2",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Response:"}),e.jsx("div",{className:"text-sm text-slate-300",children:s.response})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[e.jsxs("span",{children:["Execution time: ",s.execution_time.toFixed(2),"s"]}),e.jsx("span",{children:new Date(s.timestamp).toLocaleString()})]})]},s.id)),(!m||m.length===0)&&!r&&e.jsx("div",{className:"text-center py-12 text-slate-500",children:"Select a target to view test results"})]})]})]})})};export{se as default};
