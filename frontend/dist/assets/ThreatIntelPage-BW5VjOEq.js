import{j as e,u as v,b as _,d as f}from"./vendor-state-DdX3IZQk.js";import{r as p}from"./vendor-react-Da1CiaFS.js";import{S as V,k as G,J as D,v as P,F as k,j as R,V as H,ch as q,O as X,b4 as O,ci as F,Z as K,aP as w,bm as J,G as Z,A as $,T as W,B as b,P as I,E,aO as A,bo as Y,l as Q,c4 as B,aG as ee,aF as z,aE as se,ar as te,ao as S,ac as ae,b as re,aD as le,aL as ie}from"./vendor-ui-DSYmGUHq.js";import{d as ne,ah as j}from"./index-DZQk2Cot.js";import"./vendor-charts-Ci07V6_i.js";function Fe(){const[s,h]=p.useState("dashboard"),t=[{id:"dashboard",label:"Dashboard",icon:G},{id:"misp",label:"MISP",icon:D},{id:"taxii",label:"TAXII",icon:P},{id:"stix",label:"STIX Objects",icon:k},{id:"actors",label:"Threat Actors",icon:R},{id:"campaigns",label:"Campaigns",icon:H},{id:"diamond",label:"Diamond Model",icon:q},{id:"killchain",label:"Kill Chain",icon:X},{id:"requirements",label:"Intel Reqs",icon:O},{id:"briefings",label:"Briefings",icon:F},{id:"correlate",label:"IOC Correlation",icon:K}];return e.jsx(ne,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(V,{className:"h-7 w-7 text-cyan-400"}),"Threat Intelligence"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage MISP, TAXII feeds, STIX objects, and threat actor intelligence"})]})}),e.jsx("div",{className:"flex space-x-1 mb-6 bg-gray-800 rounded-lg p-1 w-fit",children:t.map(a=>e.jsxs("button",{onClick:()=>h(a.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${s===a.id?"bg-cyan-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:[e.jsx(a.icon,{className:"h-4 w-4"}),a.label]},a.id))}),s==="dashboard"&&e.jsx(ce,{}),s==="misp"&&e.jsx(de,{}),s==="taxii"&&e.jsx(me,{}),s==="stix"&&e.jsx(ue,{}),s==="actors"&&e.jsx(je,{}),s==="campaigns"&&e.jsx(Ne,{}),s==="diamond"&&e.jsx(we,{}),s==="killchain"&&e.jsx(Se,{}),s==="requirements"&&e.jsx(Ce,{}),s==="briefings"&&e.jsx(Ie,{}),s==="correlate"&&e.jsx(be,{})]})})}function ce(){var a,d,r,c,o,i,x,m,l;const{data:s,isLoading:h}=v({queryKey:["threat-intel-stats"],queryFn:()=>j.getStats()});if(h)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(w,{className:"h-8 w-8 text-cyan-400 animate-spin"})});const t=[{label:"MISP Servers",value:((a=s==null?void 0:s.data)==null?void 0:a.misp_servers)||0,icon:D,color:"cyan"},{label:"MISP Events",value:((d=s==null?void 0:s.data)==null?void 0:d.misp_events)||0,icon:k,color:"blue"},{label:"MISP Attributes",value:((r=s==null?void 0:s.data)==null?void 0:r.misp_attributes)||0,icon:J,color:"purple"},{label:"TAXII Servers",value:((c=s==null?void 0:s.data)==null?void 0:c.taxii_servers)||0,icon:P,color:"green"},{label:"TAXII Collections",value:((o=s==null?void 0:s.data)==null?void 0:o.taxii_collections)||0,icon:Z,color:"yellow"},{label:"STIX Bundles",value:((i=s==null?void 0:s.data)==null?void 0:i.stix_bundles)||0,icon:k,color:"orange"},{label:"STIX Objects",value:((x=s==null?void 0:s.data)==null?void 0:x.stix_objects)||0,icon:$,color:"red"},{label:"Threat Actors",value:((m=s==null?void 0:s.data)==null?void 0:m.threat_actors)||0,icon:R,color:"pink"},{label:"Campaigns",value:((l=s==null?void 0:s.data)==null?void 0:l.campaigns)||0,icon:W,color:"indigo"}];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:t.map(n=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(n.icon,{className:`h-5 w-5 text-${n.color}-400`}),e.jsx("span",{className:"text-2xl font-bold text-white",children:n.value})]}),e.jsx("p",{className:"text-sm text-gray-400",children:n.label})]},n.label))})}function de(){var C,N;const s=_(),[h,t]=p.useState(!1),[a,d]=p.useState(null),[r,c]=p.useState(null),{data:o,isLoading:i}=v({queryKey:["misp-servers"],queryFn:()=>j.listMispServers()}),{data:x,isLoading:m}=v({queryKey:["misp-events"],queryFn:()=>j.listMispEvents({limit:50})}),l=f({mutationFn:u=>j.addMispServer(u),onSuccess:()=>{s.invalidateQueries({queryKey:["misp-servers"]}),t(!1),b.success("MISP server added successfully")},onError:()=>b.error("Failed to add MISP server")}),n=f({mutationFn:u=>j.deleteMispServer(u),onSuccess:()=>{s.invalidateQueries({queryKey:["misp-servers"]}),b.success("MISP server deleted")},onError:()=>b.error("Failed to delete MISP server")}),g=f({mutationFn:u=>j.testMispServer(u),onSuccess:u=>{u.data.success?b.success("Connection successful"):b.error(u.data.message||"Connection failed")},onError:()=>b.error("Connection test failed")}),y=f({mutationFn:u=>j.syncMispServer(u),onSuccess:u=>{s.invalidateQueries({queryKey:["misp-servers"]}),s.invalidateQueries({queryKey:["misp-events"]}),u.data.success?b.success(`Synced ${u.data.events_synced||0} events`):b.error(u.data.message||"Sync failed")},onError:()=>b.error("Sync failed")});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5 text-cyan-400"}),"MISP Servers"]}),e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg text-sm",children:[e.jsx(I,{className:"h-4 w-4"}),"Add Server"]})]}),e.jsx("div",{className:"p-4",children:i?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(C=o==null?void 0:o.data)!=null&&C.length?e.jsx("div",{className:"space-y-3",children:o.data.map(u=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${u.enabled?"bg-green-400":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:u.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:u.url})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("p",{className:"text-gray-400",children:["Events: ",u.events_synced]}),u.last_sync_at&&e.jsxs("p",{className:"text-gray-500 text-xs",children:["Last sync: ",new Date(u.last_sync_at).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>g.mutate(u.id),className:"p-1.5 text-gray-400 hover:text-cyan-400",title:"Test Connection",children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>y.mutate(u.id),className:"p-1.5 text-gray-400 hover:text-green-400",title:"Sync Events",children:e.jsx(w,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>d(u),className:"p-1.5 text-gray-400 hover:text-blue-400",title:"View Details",children:e.jsx(E,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>n.mutate(u.id),className:"p-1.5 text-gray-400 hover:text-red-400",title:"Delete",children:e.jsx(A,{className:"h-4 w-4"})})]})]})]},u.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No MISP servers configured"})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5 text-cyan-400"}),"Recent MISP Events"]})}),e.jsx("div",{className:"overflow-x-auto",children:m?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(N=x==null?void 0:x.data)!=null&&N.length?e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-400 text-sm border-b border-gray-700",children:[e.jsx("th",{className:"p-3",children:"Event"}),e.jsx("th",{className:"p-3",children:"Organization"}),e.jsx("th",{className:"p-3",children:"Threat Level"}),e.jsx("th",{className:"p-3",children:"Attributes"}),e.jsx("th",{className:"p-3",children:"Date"}),e.jsx("th",{className:"p-3",children:"Actions"})]})}),e.jsx("tbody",{children:x.data.map(u=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"p-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium truncate max-w-md",children:u.info}),e.jsx("p",{className:"text-gray-500 text-xs",children:u.misp_uuid})]})}),e.jsx("td",{className:"p-3 text-gray-300",children:u.org_name}),e.jsx("td",{className:"p-3",children:e.jsx(L,{level:u.threat_level})}),e.jsx("td",{className:"p-3 text-gray-300",children:u.attribute_count}),e.jsx("td",{className:"p-3 text-gray-400 text-sm",children:u.date}),e.jsx("td",{className:"p-3",children:e.jsx("button",{onClick:()=>c(u),className:"p-1.5 text-gray-400 hover:text-cyan-400",children:e.jsx(E,{className:"h-4 w-4"})})})]},u.id))})]}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No events synced yet"})})]}),h&&e.jsx(xe,{onClose:()=>t(!1),onSubmit:u=>l.mutate(u),isLoading:l.isPending}),r&&e.jsx(oe,{event:r,onClose:()=>c(null)})]})}function L({level:s}){const h={1:"bg-red-900 text-red-300",2:"bg-orange-900 text-orange-300",3:"bg-yellow-900 text-yellow-300",4:"bg-gray-700 text-gray-300"},t={1:"High",2:"Medium",3:"Low",4:"Undefined"};return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h[s]||h[4]}`,children:t[s]||"Unknown"})}function xe({onClose:s,onSubmit:h,isLoading:t}){const[a,d]=p.useState(""),[r,c]=p.useState(""),[o,i]=p.useState("");return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-md border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Add MISP Server"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Server Name"}),e.jsx("input",{type:"text",value:a,onChange:x=>d(x.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"My MISP Server"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"URL"}),e.jsx("input",{type:"url",value:r,onChange:x=>c(x.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"https://misp.example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"API Key"}),e.jsx("input",{type:"password",value:o,onChange:x=>i(x.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"MISP API Key"})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-400 hover:text-white",children:"Cancel"}),e.jsx("button",{onClick:()=>h({name:a,url:r,api_key:o}),disabled:t||!a||!r||!o,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:t?"Adding...":"Add Server"})]})]})})}function oe({event:s,onClose:h}){var a;const{data:t}=v({queryKey:["misp-event-attributes",s.id],queryFn:()=>j.getMispEventAttributes(s.id)});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-4xl max-h-[80vh] overflow-hidden border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.info}),e.jsx("p",{className:"text-gray-400 text-sm",children:s.misp_uuid})]}),e.jsx("button",{onClick:h,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Organization"}),e.jsx("p",{className:"text-white",children:s.org_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Date"}),e.jsx("p",{className:"text-white",children:s.date})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Threat Level"}),e.jsx(L,{level:s.threat_level})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Published"}),e.jsx("p",{className:"text-white",children:s.published?"Yes":"No"})]})]}),s.tags.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map((d,r)=>e.jsx("span",{className:"px-2 py-1 bg-gray-700 rounded text-xs text-gray-300",children:d},r))})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-400 text-sm mb-2",children:["Attributes (",s.attribute_count,")"]}),(a=t==null?void 0:t.data)!=null&&a.length?e.jsxs("div",{className:"space-y-2",children:[t.data.slice(0,20).map(d=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-900 rounded",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:d.attr_type}),e.jsx("span",{className:"text-gray-300 font-mono text-sm truncate",children:d.value}),d.to_ids&&e.jsx("span",{className:"px-2 py-0.5 bg-red-900 text-red-300 rounded text-xs",children:"IDS"})]},d.id)),t.data.length>20&&e.jsxs("p",{className:"text-gray-500 text-sm text-center",children:["And ",t.data.length-20," more..."]})]}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Loading attributes..."})]})]})]})})}function me(){var m;const s=_(),[h,t]=p.useState(!1),[a,d]=p.useState(null),{data:r,isLoading:c}=v({queryKey:["taxii-servers"],queryFn:()=>j.listTaxiiServers()}),o=f({mutationFn:l=>j.addTaxiiServer(l),onSuccess:()=>{s.invalidateQueries({queryKey:["taxii-servers"]}),t(!1),b.success("TAXII server added successfully")},onError:()=>b.error("Failed to add TAXII server")}),i=f({mutationFn:l=>j.deleteTaxiiServer(l),onSuccess:()=>{s.invalidateQueries({queryKey:["taxii-servers"]}),b.success("TAXII server deleted")},onError:()=>b.error("Failed to delete TAXII server")}),x=f({mutationFn:l=>j.discoverTaxiiCollections(l),onSuccess:(l,n)=>{s.invalidateQueries({queryKey:["taxii-collections",n]}),l.data.success?b.success(`Discovered ${l.data.collections_found||0} collections`):b.error("Discovery failed")},onError:()=>b.error("Discovery failed")});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-cyan-400"}),"TAXII Servers"]}),e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg text-sm",children:[e.jsx(I,{className:"h-4 w-4"}),"Add Server"]})]}),e.jsx("div",{className:"p-4",children:c?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(m=r==null?void 0:r.data)!=null&&m.length?e.jsx("div",{className:"space-y-3",children:r.data.map(l=>e.jsx(he,{server:l,expanded:a===l.id,onToggle:()=>d(a===l.id?null:l.id),onDiscover:()=>x.mutate(l.id),onDelete:()=>i.mutate(l.id)},l.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No TAXII servers configured"})})]}),h&&e.jsx(ge,{onClose:()=>t(!1),onSubmit:l=>o.mutate(l),isLoading:o.isPending})]})}function he({server:s,expanded:h,onToggle:t,onDiscover:a,onDelete:d}){var i;const r=_(),{data:c}=v({queryKey:["taxii-collections",s.id],queryFn:()=>j.listTaxiiCollections(s.id),enabled:h}),o=f({mutationFn:x=>j.pollTaxiiCollection(s.id,x),onSuccess:x=>{r.invalidateQueries({queryKey:["taxii-collections",s.id]}),x.data.success&&b.success(`Retrieved ${x.data.objects_retrieved||0} objects`)},onError:()=>b.error("Poll failed")});return e.jsxs("div",{className:"bg-gray-900 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 cursor-pointer hover:bg-gray-800",onClick:t,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[h?e.jsx(re,{className:"h-4 w-4 text-gray-400"}):e.jsx(le,{className:"h-4 w-4 text-gray-400"}),e.jsx("div",{className:`w-3 h-3 rounded-full ${s.enabled?"bg-green-400":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:s.url})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-xs text-gray-500 bg-gray-700 px-2 py-1 rounded",children:["TAXII ",s.version]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Objects: ",s.objects_synced]}),e.jsxs("div",{className:"flex items-center gap-2",onClick:x=>x.stopPropagation(),children:[e.jsx("button",{onClick:a,className:"p-1.5 text-gray-400 hover:text-cyan-400",title:"Discover Collections",children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx("button",{onClick:d,className:"p-1.5 text-gray-400 hover:text-red-400",title:"Delete",children:e.jsx(A,{className:"h-4 w-4"})})]})]})]}),h&&e.jsxs("div",{className:"border-t border-gray-700 p-3",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Collections"}),(i=c==null?void 0:c.data)!=null&&i.length?e.jsx("div",{className:"space-y-2",children:c.data.map(x=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-800 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm",children:x.title}),e.jsx("p",{className:"text-gray-500 text-xs",children:x.collection_id})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-gray-400 text-xs",children:[x.objects_count," objects"]}),x.can_read&&e.jsx("button",{onClick:()=>o.mutate(x.collection_id),className:"p-1.5 text-gray-400 hover:text-green-400",title:"Poll Collection",children:e.jsx(ie,{className:"h-4 w-4"})})]})]},x.id))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No collections found. Click discover to fetch."})]})]})}function ge({onClose:s,onSubmit:h,isLoading:t}){const[a,d]=p.useState(""),[r,c]=p.useState(""),[o,i]=p.useState(""),[x,m]=p.useState(""),[l,n]=p.useState("2.1");return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-md border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Add TAXII Server"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Server Name"}),e.jsx("input",{type:"text",value:a,onChange:g=>d(g.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"CIRCL TAXII"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"URL"}),e.jsx("input",{type:"url",value:r,onChange:g=>c(g.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"https://limo.anomali.com/api/v1/taxii2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Version"}),e.jsxs("select",{value:l,onChange:g=>n(g.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"2.1",children:"TAXII 2.1"}),e.jsx("option",{value:"2.0",children:"TAXII 2.0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Username (optional)"}),e.jsx("input",{type:"text",value:o,onChange:g=>i(g.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Password (optional)"}),e.jsx("input",{type:"password",value:x,onChange:g=>m(g.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white"})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-400 hover:text-white",children:"Cancel"}),e.jsx("button",{onClick:()=>h({name:a,url:r,username:o||void 0,password:x||void 0,version:l}),disabled:t||!a||!r,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:t?"Adding...":"Add Server"})]})]})})}function ue(){var l,n;const s=_(),[h,t]=p.useState(!1),[a,d]=p.useState(null),[r,c]=p.useState(""),{data:o,isLoading:i}=v({queryKey:["stix-bundles"],queryFn:()=>j.listStixBundles({limit:50})}),{data:x}=v({queryKey:["stix-objects",r],queryFn:()=>j.listStixObjects({type:r||void 0,limit:100})}),m=["indicator","malware","threat-actor","attack-pattern","campaign","identity","tool","vulnerability"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5 text-cyan-400"}),"STIX Bundles"]}),e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg text-sm",children:[e.jsx(Y,{className:"h-4 w-4"}),"Import Bundle"]})]}),e.jsx("div",{className:"p-4",children:i?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(l=o==null?void 0:o.data)!=null&&l.length?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.data.map(g=>e.jsxs("div",{className:"p-4 bg-gray-900 rounded-lg cursor-pointer hover:bg-gray-700",onClick:()=>d(g),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"text-white font-medium",children:g.name}),e.jsx("span",{className:"text-xs text-gray-500",children:g.spec_version})]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Source: ",g.source]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[g.objects_count," objects"]}),e.jsx("p",{className:"text-gray-500 text-xs mt-2",children:new Date(g.created_at).toLocaleDateString()})]},g.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No STIX bundles imported"})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5 text-cyan-400"}),"STIX Objects"]}),e.jsxs("select",{value:r,onChange:g=>c(g.target.value),className:"bg-gray-900 border border-gray-600 rounded-lg px-3 py-1.5 text-white text-sm",children:[e.jsx("option",{value:"",children:"All Types"}),m.map(g=>e.jsx("option",{value:g,children:g},g))]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-400 text-sm border-b border-gray-700",children:[e.jsx("th",{className:"p-3",children:"Type"}),e.jsx("th",{className:"p-3",children:"Name"}),e.jsx("th",{className:"p-3",children:"STIX ID"}),e.jsx("th",{className:"p-3",children:"Created"})]})}),e.jsx("tbody",{children:(n=x==null?void 0:x.data)==null?void 0:n.map(g=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"p-3",children:e.jsx("span",{className:"px-2 py-1 bg-cyan-900 text-cyan-300 rounded text-xs",children:g.stix_type})}),e.jsx("td",{className:"p-3 text-white",children:g.name||"-"}),e.jsx("td",{className:"p-3 text-gray-400 font-mono text-xs truncate max-w-xs",children:g.stix_id}),e.jsx("td",{className:"p-3 text-gray-400 text-sm",children:new Date(g.created).toLocaleDateString()})]},g.id))})]})})]}),h&&e.jsx(pe,{onClose:()=>t(!1),onSuccess:()=>{s.invalidateQueries({queryKey:["stix-bundles"]}),s.invalidateQueries({queryKey:["stix-objects"]})}}),a&&e.jsx(ye,{bundle:a,onClose:()=>d(null)})]})}function pe({onClose:s,onSuccess:h}){const[t,a]=p.useState(""),[d,r]=p.useState(""),c=f({mutationFn:o=>j.importStixBundle(o),onSuccess:o=>{o.data.success?(b.success(`Imported ${o.data.objects_imported||0} objects`),h(),s()):b.error("Import failed")},onError:()=>b.error("Import failed")});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-2xl border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Import STIX Bundle"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Bundle Name"}),e.jsx("input",{type:"text",value:t,onChange:o=>a(o.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"My STIX Bundle"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"STIX 2.1 JSON"}),e.jsx("textarea",{value:d,onChange:o=>r(o.target.value),className:"w-full h-64 bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white font-mono text-sm",placeholder:'{"type": "bundle", "id": "bundle--...", "objects": [...]}'})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-400 hover:text-white",children:"Cancel"}),e.jsx("button",{onClick:()=>c.mutate({name:t,content:d}),disabled:c.isPending||!t||!d,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:c.isPending?"Importing...":"Import"})]})]})})}function ye({bundle:s,onClose:h}){var d,r;const{data:t}=v({queryKey:["stix-bundle-objects",s.id],queryFn:()=>j.getStixBundleObjects(s.id,{limit:100})}),a=(d=t==null?void 0:t.data)==null?void 0:d.reduce((c,o)=>(c[o.stix_type]=(c[o.stix_type]||0)+1,c),{});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-4xl max-h-[80vh] overflow-hidden border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[s.objects_count," objects | STIX ",s.spec_version]})]}),e.jsx("button",{onClick:h,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:[a&&e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"Object Types"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(a).map(([c,o])=>e.jsxs("span",{className:"px-3 py-1 bg-gray-700 rounded-full text-sm text-gray-300",children:[c,": ",o]},c))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"Objects"}),e.jsx("div",{className:"space-y-2",children:(r=t==null?void 0:t.data)==null?void 0:r.slice(0,50).map(c=>e.jsxs("div",{className:"p-3 bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:c.stix_type}),e.jsx("span",{className:"text-gray-500 text-xs",children:c.stix_id})]}),c.name&&e.jsx("p",{className:"text-white",children:c.name}),c.description&&e.jsx("p",{className:"text-gray-400 text-sm mt-1 line-clamp-2",children:c.description})]},c.id))})]})]})]})})}function je(){var l;const[s,h]=p.useState(""),[t,a]=p.useState(null),[d,r]=p.useState({actor_type:"",motivation:"",active_only:!1}),{data:c,isLoading:o}=v({queryKey:["threat-actors",d,s],queryFn:()=>j.listThreatActors({...d,name:s||void 0,limit:50})}),{data:i}=v({queryKey:["threat-actor",t],queryFn:()=>j.getThreatActor(t),enabled:!!t}),x=["espionage","financial","destruction","hacktivism","unknown"],m=["nation-state","crime-syndicate","hacktivist","insider","terrorist"];return e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-1 bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("div",{className:"flex items-center gap-4 mb-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:s,onChange:n=>h(n.target.value),placeholder:"Search threat actors...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg pl-10 pr-3 py-2 text-white"})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:d.actor_type,onChange:n=>r({...d,actor_type:n.target.value}),className:"bg-gray-900 border border-gray-600 rounded-lg px-3 py-1.5 text-white text-sm",children:[e.jsx("option",{value:"",children:"All Types"}),m.map(n=>e.jsx("option",{value:n,children:n},n))]}),e.jsxs("select",{value:d.motivation,onChange:n=>r({...d,motivation:n.target.value}),className:"bg-gray-900 border border-gray-600 rounded-lg px-3 py-1.5 text-white text-sm",children:[e.jsx("option",{value:"",children:"All Motivations"}),x.map(n=>e.jsx("option",{value:n,children:n},n))]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx("input",{type:"checkbox",checked:d.active_only,onChange:n=>r({...d,active_only:n.target.checked}),className:"rounded border-gray-600"}),"Active only"]})]})]}),e.jsx("div",{className:"overflow-y-auto max-h-[600px]",children:o?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(l=c==null?void 0:c.data)!=null&&l.length?e.jsx("div",{className:"divide-y divide-gray-700",children:c.data.map(n=>e.jsxs("div",{className:`p-4 cursor-pointer hover:bg-gray-700/50 ${t===n.id?"bg-gray-700":""}`,onClick:()=>a(n.id),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-white font-medium",children:n.name}),n.active&&e.jsx("span",{className:"px-1.5 py-0.5 bg-green-900 text-green-300 rounded text-xs",children:"Active"})]}),n.aliases.length>0&&e.jsxs("p",{className:"text-gray-500 text-sm",children:["AKA: ",n.aliases.slice(0,3).join(", ")]})]}),e.jsx(M,{level:n.sophistication})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[e.jsx("span",{className:"text-gray-400",children:n.actor_type}),n.country&&e.jsxs("span",{className:"flex items-center gap-1 text-gray-400",children:[e.jsx(B,{className:"h-3 w-3"}),n.country]}),e.jsx("span",{className:"text-gray-400",children:n.motivation})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:n.target_sectors.slice(0,4).map((g,y)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-300",children:g},y))})]},n.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No threat actors found"})})]}),t&&(i==null?void 0:i.data)&&e.jsxs("div",{className:"w-96 bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:i.data.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:i.data.actor_type}),i.data.country&&e.jsxs("span",{className:"flex items-center gap-1 text-gray-400 text-sm",children:[e.jsx(B,{className:"h-3 w-3"}),i.data.country]})]})]}),e.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto max-h-[500px]",children:[i.data.description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Description"}),e.jsx("p",{className:"text-gray-300 text-sm",children:i.data.description})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Motivation"}),e.jsx("p",{className:"text-white",children:i.data.motivation})]}),i.data.aliases.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Aliases"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:i.data.aliases.map((n,g)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-300",children:n},g))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Sophistication"}),e.jsx(M,{level:i.data.sophistication})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Resource Level"}),e.jsx(M,{level:i.data.resource_level})]})]}),i.data.first_seen&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"First Seen"}),e.jsx("p",{className:"text-white text-sm",children:i.data.first_seen})]}),i.data.last_seen&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Last Seen"}),e.jsx("p",{className:"text-white text-sm",children:i.data.last_seen})]})]}),i.data.target_sectors.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Target Sectors"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:i.data.target_sectors.map((n,g)=>e.jsx("span",{className:"px-2 py-0.5 bg-red-900 text-red-300 rounded text-xs",children:n},g))})]}),i.data.ttps.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"TTPs (MITRE ATT&CK)"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:i.data.ttps.slice(0,10).map((n,g)=>e.jsx("span",{className:"px-2 py-0.5 bg-purple-900 text-purple-300 rounded text-xs font-mono",children:n},g))})]}),i.data.tools.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Tools"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:i.data.tools.map((n,g)=>e.jsx("span",{className:"px-2 py-0.5 bg-blue-900 text-blue-300 rounded text-xs",children:n},g))})]}),i.data.malware.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Malware"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:i.data.malware.map((n,g)=>e.jsx("span",{className:"px-2 py-0.5 bg-orange-900 text-orange-300 rounded text-xs",children:n},g))})]}),i.data.external_references.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"References"}),e.jsx("div",{className:"space-y-1",children:i.data.external_references.slice(0,5).map((n,g)=>e.jsxs("a",{href:n.url||"#",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-cyan-400 text-sm hover:underline",children:[e.jsx(ee,{className:"h-3 w-3"}),n.source]},g))})]})]})]})]})}function M({level:s}){const h=["bg-gray-700 text-gray-300","bg-green-900 text-green-300","bg-yellow-900 text-yellow-300","bg-orange-900 text-orange-300","bg-red-900 text-red-300"],t=["Minimal","Low","Intermediate","Advanced","Expert"],a=Math.min(Math.max(0,s),4);return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h[a]}`,children:t[a]})}function be(){var C;const[s,h]=p.useState("manual"),[t,a]=p.useState([]),[d,r]=p.useState("ip"),[c,o]=p.useState(""),[i,x]=p.useState(""),m=f({mutationFn:N=>j.correlateIocs(N),onSuccess:()=>{b.success("Correlation complete")},onError:()=>b.error("Correlation failed")}),l=()=>{c&&(a([...t,{ioc_type:d,value:c}]),o(""))},n=N=>{a(t.filter((u,U)=>U!==N))},g=()=>{s==="manual"&&t.length>0?m.mutate({iocs:t}):s==="scan"&&i&&m.mutate({scan_id:i})},y=["ip","domain","hash","url","email"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-cyan-400"}),"IOC Correlation"]}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>h("manual"),className:`px-4 py-2 rounded-lg ${s==="manual"?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Manual IOCs"}),e.jsx("button",{onClick:()=>h("scan"),className:`px-4 py-2 rounded-lg ${s==="scan"?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"From Scan"})]}),s==="manual"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("select",{value:d,onChange:N=>r(N.target.value),className:"bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",children:y.map(N=>e.jsx("option",{value:N,children:N.toUpperCase()},N))}),e.jsx("input",{type:"text",value:c,onChange:N=>o(N.target.value),placeholder:"Enter IOC value...",className:"flex-1 bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",onKeyDown:N=>N.key==="Enter"&&l()}),e.jsx("button",{onClick:l,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg",children:e.jsx(I,{className:"h-4 w-4"})})]}),t.length>0&&e.jsx("div",{className:"space-y-2",children:t.map((N,u)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:N.ioc_type}),e.jsx("span",{className:"text-white font-mono text-sm",children:N.value})]}),e.jsx("button",{onClick:()=>n(u),className:"text-gray-400 hover:text-red-400",children:e.jsx(S,{className:"h-4 w-4"})})]},u))})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Scan ID"}),e.jsx("input",{type:"text",value:i,onChange:N=>x(N.target.value),placeholder:"Enter scan ID to correlate IOCs from...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white"})]}),e.jsx("button",{onClick:g,disabled:m.isPending||s==="manual"&&t.length===0||s==="scan"&&!i,className:"mt-6 flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:m.isPending?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"h-4 w-4 animate-spin"}),"Correlating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-4 w-4"}),"Run Correlation"]})})]}),((C=m.data)==null?void 0:C.data)&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4",children:["Results: ",m.data.data.correlations_found," correlations found"]}),m.data.data.correlations.length===0?e.jsx("p",{className:"text-gray-400",children:"No correlations found in threat intelligence sources."}):e.jsx("div",{className:"space-y-3",children:m.data.data.correlations.map((N,u)=>e.jsxs("div",{className:"p-3 bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:N.ioc_type}),e.jsx("span",{className:"text-white font-mono text-sm",children:N.ioc_value})]}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["Confidence: ",(N.confidence*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-gray-400",children:["Source: ",e.jsx("span",{className:"text-white",children:N.source_type})]}),e.jsxs("span",{className:"text-gray-400",children:["Reference: ",e.jsx("span",{className:"text-white",children:N.source_name})]}),N.threat_level&&e.jsx(L,{level:N.threat_level})]})]},u))})]})]})}function Ne(){var x;const s=_(),[h,t]=p.useState(!1),[a,d]=p.useState(null),{data:r,isLoading:c}=v({queryKey:["threat-campaigns"],queryFn:()=>j.listCampaigns()}),o=f({mutationFn:m=>j.deleteCampaign(m),onSuccess:()=>{s.invalidateQueries({queryKey:["threat-campaigns"]}),b.success("Campaign deleted")},onError:()=>b.error("Failed to delete campaign")}),i=m=>({active:"bg-red-900 text-red-300",suspected:"bg-yellow-900 text-yellow-300",historical:"bg-gray-700 text-gray-300",attributed:"bg-blue-900 text-blue-300"})[m]||"bg-gray-700 text-gray-300";return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(w,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Threat Campaigns"}),e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700",children:[e.jsx(I,{className:"h-4 w-4"}),"Add Campaign"]})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Name"}),e.jsx("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Actor"}),e.jsx("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-gray-400 font-medium",children:"First Seen"}),e.jsx("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Last Seen"}),e.jsx("th",{className:"text-right p-4 text-gray-400 font-medium",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700",children:[(x=r==null?void 0:r.data)==null?void 0:x.map(m=>e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"p-4",children:e.jsx("button",{onClick:()=>d(m),className:"text-cyan-400 hover:text-cyan-300 font-medium",children:m.name})}),e.jsx("td",{className:"p-4 text-gray-300",children:m.threat_actor_id||"-"}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${i(m.status)}`,children:m.status})}),e.jsx("td",{className:"p-4 text-gray-400 text-sm",children:m.first_seen?new Date(m.first_seen).toLocaleDateString():"-"}),e.jsx("td",{className:"p-4 text-gray-400 text-sm",children:m.last_seen?new Date(m.last_seen).toLocaleDateString():"-"}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("button",{onClick:()=>o.mutate(m.id),className:"p-2 text-gray-400 hover:text-red-400",children:e.jsx(A,{className:"h-4 w-4"})})})]},m.id)),(!(r!=null&&r.data)||r.data.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-8 text-center text-gray-400",children:"No campaigns found. Add your first campaign to start tracking threat activity."})})]})]})}),h&&e.jsx(ve,{onClose:()=>t(!1),onSuccess:()=>{s.invalidateQueries({queryKey:["threat-campaigns"]}),t(!1)}}),a&&e.jsx(fe,{campaign:a,onClose:()=>d(null)})]})}function ve({onClose:s,onSuccess:h}){const[t,a]=p.useState(""),[d,r]=p.useState(""),[c,o]=p.useState("suspected"),i=f({mutationFn:()=>j.createCampaign({name:t,description:d,status:c}),onSuccess:()=>{b.success("Campaign created"),h()},onError:()=>b.error("Failed to create campaign")});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-lg border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Add Campaign"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:t,onChange:x=>a(x.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",placeholder:"Campaign name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("textarea",{value:d,onChange:x=>r(x.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white h-24",placeholder:"Campaign description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Status"}),e.jsxs("select",{value:c,onChange:x=>o(x.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"suspected",children:"Suspected"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"historical",children:"Historical"}),e.jsx("option",{value:"attributed",children:"Attributed"})]})]}),e.jsx("button",{onClick:()=>i.mutate(),disabled:!t||i.isPending,className:"w-full bg-cyan-600 text-white py-2 rounded-lg hover:bg-cyan-700 disabled:opacity-50",children:i.isPending?"Creating...":"Create Campaign"})]})]})})}function fe({campaign:s,onClose:h}){var d,r,c,o,i,x;const{data:t,isLoading:a}=v({queryKey:["campaign-detail",s.id],queryFn:()=>j.getCampaign(s.id)});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-3xl border border-gray-700 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.name}),e.jsx("button",{onClick:h,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),a?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("p",{className:"text-white",children:((d=t==null?void 0:t.data)==null?void 0:d.description)||"No description"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Status"}),e.jsx("p",{className:"text-white capitalize",children:(r=t==null?void 0:t.data)==null?void 0:r.status})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Confidence"}),e.jsxs("p",{className:"text-white",children:[((c=t==null?void 0:t.data)==null?void 0:c.confidence)||0,"%"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-1",children:"Threat Actor"}),e.jsx("p",{className:"text-white",children:((o=t==null?void 0:t.data)==null?void 0:o.threat_actor_name)||"Unknown"})]})]}),((i=t==null?void 0:t.data)==null?void 0:i.ttps)&&t.data.ttps.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-2",children:"TTPs"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.data.ttps.map(m=>e.jsx("span",{className:"px-2 py-1 bg-purple-900 text-purple-300 rounded text-sm",children:m},m))})]}),((x=t==null?void 0:t.data)==null?void 0:x.iocs)&&t.data.iocs.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm text-gray-400 mb-2",children:["IOCs (",t.data.iocs.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:t.data.iocs.map((m,l)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:m.ioc_type}),e.jsx("span",{className:"text-white font-mono",children:m.value})]},l))})]})]})]})})}function we(){var d;_();const[s,h]=p.useState(!1),{data:t,isLoading:a}=v({queryKey:["diamond-events"],queryFn:()=>j.listDiamondEvents({limit:50})});return a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(w,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Diamond Model Events"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Analyze intrusions using Adversary, Capability, Infrastructure, and Victim vertices"})]}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700",children:[e.jsx(I,{className:"h-4 w-4"}),"Add Event"]})]}),e.jsxs("div",{className:"grid gap-4",children:[(d=t==null?void 0:t.data)==null?void 0:d.map(r=>e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:"h-5 w-5 text-cyan-400"}),e.jsxs("span",{className:"text-white font-medium",children:["Event ",r.id.slice(0,8)]}),r.phase&&e.jsx("span",{className:"px-2 py-0.5 bg-purple-900 text-purple-300 rounded text-xs",children:r.phase})]}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["Confidence: ",r.confidence,"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(T,{label:"Adversary",vertex:r.adversary,color:"red"}),e.jsx(T,{label:"Capability",vertex:r.capability,color:"yellow"}),e.jsx(T,{label:"Infrastructure",vertex:r.infrastructure,color:"blue"}),e.jsx(T,{label:"Victim",vertex:r.victim,color:"green"})]}),r.notes&&e.jsx("p",{className:"mt-3 text-sm text-gray-400",children:r.notes})]},r.id)),(!(t!=null&&t.data)||t.data.length===0)&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-8 text-center",children:[e.jsx(q,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No Diamond Model events recorded yet."}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create your first event to start analyzing intrusions."})]})]})]})}function T({label:s,vertex:h,color:t}){const a={red:"border-red-500 bg-red-900/20",yellow:"border-yellow-500 bg-yellow-900/20",blue:"border-blue-500 bg-blue-900/20",green:"border-green-500 bg-green-900/20"};return e.jsxs("div",{className:`p-3 rounded-lg border ${a[t]}`,children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:s}),e.jsx("div",{className:"text-white font-medium",children:h.name||"Unknown"}),h.vertex_type&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:h.vertex_type})]})}function Se(){var o,i,x,m,l,n,g;const[s,h]=p.useState(""),{data:t}=v({queryKey:["threat-campaigns"],queryFn:()=>j.listCampaigns()}),{data:a,isLoading:d}=v({queryKey:["kill-chain",s],queryFn:()=>j.getKillChainAnalysis(s),enabled:!!s}),{data:r}=v({queryKey:["kill-chain-phases"],queryFn:()=>j.getKillChainPhases()}),c={recon:"bg-blue-600",weaponization:"bg-purple-600",delivery:"bg-yellow-600",exploitation:"bg-orange-600",installation:"bg-red-600",c2:"bg-pink-600",actions:"bg-gray-600"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Cyber Kill Chain Analysis"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Visualize attack progression through Lockheed Martin's Cyber Kill Chain"})]}),e.jsxs("select",{value:s,onChange:y=>h(y.target.value),className:"bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"",children:"Select a campaign"}),(o=t==null?void 0:t.data)==null?void 0:o.map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))]})]}),s?d?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-white font-medium",children:(i=a==null?void 0:a.data)==null?void 0:i.campaign_name}),e.jsxs("div",{className:"text-cyan-400 text-lg font-bold",children:[(m=(x=a==null?void 0:a.data)==null?void 0:x.coverage)==null?void 0:m.toFixed(0),"% Coverage"]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-cyan-500 h-2 rounded-full",style:{width:`${((l=a==null?void 0:a.data)==null?void 0:l.coverage)||0}%`}})})]}),e.jsx("div",{className:"flex gap-1",children:(g=(n=a==null?void 0:a.data)==null?void 0:n.phases)==null?void 0:g.map(y=>e.jsxs("div",{className:`flex-1 rounded-lg p-4 ${c[y.phase]||"bg-gray-600"} bg-opacity-30 border border-gray-700`,children:[e.jsxs("div",{className:"text-xs text-gray-400 mb-1",children:["Phase ",y.order]}),e.jsx("div",{className:"text-white font-medium mb-2",children:y.phase_name}),e.jsx("div",{className:"text-sm",children:y.techniques.length>0?e.jsxs("div",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(z,{className:"h-4 w-4"}),y.techniques.length," detected"]}):e.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx(se,{className:"h-4 w-4"}),"No activity"]})})]},y.phase))})]}):e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-8 text-center",children:[e.jsx(X,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Select a campaign to view its Kill Chain analysis"})]})]})}function Ce(){var m;const s=_(),[h,t]=p.useState(!1),[a,d]=p.useState("all"),{data:r,isLoading:c}=v({queryKey:["intel-requirements",a],queryFn:()=>j.listIntelRequirements(a!=="all"?{status:a}:void 0)}),o=f({mutationFn:l=>j.deleteIntelRequirement(l),onSuccess:()=>{s.invalidateQueries({queryKey:["intel-requirements"]}),b.success("Requirement deleted")}}),i=l=>({critical:"bg-red-900 text-red-300",high:"bg-orange-900 text-orange-300",medium:"bg-yellow-900 text-yellow-300",low:"bg-blue-900 text-blue-300"})[l]||"bg-gray-700 text-gray-300",x=l=>({open:"bg-blue-900 text-blue-300",in_progress:"bg-yellow-900 text-yellow-300",answered:"bg-green-900 text-green-300",closed:"bg-gray-700 text-gray-300"})[l]||"bg-gray-700 text-gray-300";return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(w,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Intelligence Requirements"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Track strategic, operational, and tactical intelligence needs"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:a,onChange:l=>d(l.target.value),className:"bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"answered",children:"Answered"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700",children:[e.jsx(I,{className:"h-4 w-4"}),"Add Requirement"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[(m=r==null?void 0:r.data)==null?void 0:m.map(l=>e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${i(l.priority)}`,children:l.priority}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${x(l.status)}`,children:l.status.replace("_"," ")}),e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs capitalize",children:l.category})]}),e.jsx("button",{onClick:()=>o.mutate(l.id),className:"p-1 text-gray-400 hover:text-red-400",children:e.jsx(A,{className:"h-4 w-4"})})]}),e.jsx("h3",{className:"text-white font-medium mb-1",children:l.title}),l.description&&e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:l.description}),l.deadline&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[e.jsx(te,{className:"h-4 w-4"}),"Due: ",new Date(l.deadline).toLocaleDateString()]}),l.answer&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-900 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Answer"}),e.jsx("p",{className:"text-white text-sm",children:l.answer})]})]},l.id)),(!(r!=null&&r.data)||r.data.length===0)&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-8 text-center",children:[e.jsx(O,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No intelligence requirements found."})]})]}),h&&e.jsx(_e,{onClose:()=>t(!1),onSuccess:()=>{s.invalidateQueries({queryKey:["intel-requirements"]}),t(!1)}})]})}function _e({onClose:s,onSuccess:h}){const[t,a]=p.useState(""),[d,r]=p.useState(""),[c,o]=p.useState("medium"),[i,x]=p.useState("operational"),m=f({mutationFn:()=>j.createIntelRequirement({title:t,description:d,priority:c,category:i}),onSuccess:()=>{b.success("Requirement created"),h()},onError:()=>b.error("Failed to create requirement")});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-lg border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Add Intelligence Requirement"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:t,onChange:l=>a(l.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",placeholder:"What do you need to know?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("textarea",{value:d,onChange:l=>r(l.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white h-24",placeholder:"Additional context..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Priority"}),e.jsxs("select",{value:c,onChange:l=>o(l.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Category"}),e.jsxs("select",{value:i,onChange:l=>x(l.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"strategic",children:"Strategic"}),e.jsx("option",{value:"operational",children:"Operational"}),e.jsx("option",{value:"tactical",children:"Tactical"})]})]})]}),e.jsx("button",{onClick:()=>m.mutate(),disabled:!t||m.isPending,className:"w-full bg-cyan-600 text-white py-2 rounded-lg hover:bg-cyan-700 disabled:opacity-50",children:m.isPending?"Creating...":"Create Requirement"})]})]})})}function Ie(){var o,i,x,m,l,n,g;const s=_(),[h,t]=p.useState(30),{data:a,isLoading:d}=v({queryKey:["latest-briefing"],queryFn:()=>j.getLatestBriefing()}),r=f({mutationFn:()=>j.generateThreatBriefing({period_days:h}),onSuccess:()=>{s.invalidateQueries({queryKey:["latest-briefing"]}),b.success("Briefing generated successfully")},onError:()=>b.error("Failed to generate briefing")}),c=y=>({critical:"text-red-400",high:"text-orange-400",medium:"text-yellow-400",low:"text-green-400"})[y]||"text-gray-400";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Threat Briefings"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Generate executive-level threat intelligence briefings"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:h,onChange:y=>t(Number(y.target.value)),className:"bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:7,children:"Last 7 days"}),e.jsx("option",{value:30,children:"Last 30 days"}),e.jsx("option",{value:90,children:"Last 90 days"})]}),e.jsxs("button",{onClick:()=>r.mutate(),disabled:r.isPending,className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 disabled:opacity-50",children:[r.isPending?e.jsx(w,{className:"h-4 w-4 animate-spin"}):e.jsx(F,{className:"h-4 w-4"}),"Generate Briefing"]})]})]}),d?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(w,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):a!=null&&a.data?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:a.data.title}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Period: ",new Date(a.data.period_start).toLocaleDateString()," - ",new Date(a.data.period_end).toLocaleDateString()]})]}),e.jsxs("div",{className:`text-lg font-bold ${c(((o=a.data.risk_assessment)==null?void 0:o.overall_risk)||"medium")}`,children:[(x=(i=a.data.risk_assessment)==null?void 0:i.overall_risk)==null?void 0:x.toUpperCase()," RISK"]})]}),e.jsx("div",{className:"prose prose-invert max-w-none",children:e.jsx("p",{className:"text-gray-300",children:a.data.executive_summary})})]}),a.data.threat_landscape&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Threat Landscape"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[((m=a.data.threat_landscape.trending_ttps)==null?void 0:m.length)>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Trending TTPs"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.data.threat_landscape.trending_ttps.map(y=>e.jsx("span",{className:"px-2 py-1 bg-purple-900 text-purple-300 rounded text-sm",children:y},y))})]}),((l=a.data.threat_landscape.geographic_focus)==null?void 0:l.length)>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Geographic Focus"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.data.threat_landscape.geographic_focus.map(y=>e.jsx("span",{className:"px-2 py-1 bg-blue-900 text-blue-300 rounded text-sm",children:y},y))})]})]})]}),((n=a.data.top_actors)==null?void 0:n.length)>0&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Top Threat Actors"}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.data.top_actors.map(y=>e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white font-medium",children:y.name}),e.jsx("span",{className:`text-sm ${c(y.threat_level)}`,children:y.threat_level})]}),e.jsx("p",{className:"text-sm text-gray-400",children:y.motivation})]},y.id))})]}),((g=a.data.recommendations)==null?void 0:g.length)>0&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Recommendations"}),e.jsx("ul",{className:"space-y-2",children:a.data.recommendations.map((y,C)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(z,{className:"h-5 w-5 text-cyan-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300",children:y})]},C))})]})]}):e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-8 text-center",children:[e.jsx(F,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No briefings generated yet."}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:'Click "Generate Briefing" to create your first threat intelligence briefing.'})]})]})}export{Fe as default};
