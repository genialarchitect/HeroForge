import{b as F,u as P,d as l,j as e}from"./vendor-state-BXNPjUwt.js";import{r as c}from"./vendor-react-5KxtEOLM.js";import{at as n}from"./index-t7VPhhr8.js";import"./vendor-ui-DGSzT-Xm.js";import"./vendor-utils-DfRopTPV.js";const E=()=>{const p=F(),[u,w]=c.useState("models"),[i,t]=c.useState(null),[a,o]=c.useState({severity_score:.5,has_cve:!1,has_exploit:!1,age_days:30,affected_hosts:1}),[d,_]=c.useState(null),[r,y]=c.useState({severity:"high",complexity:"medium",team_size:3}),[j,T]=c.useState(null),{data:f,isLoading:C}=P({queryKey:["ml-models"],queryFn:async()=>(await n.listModels()).data}),m=l({mutationFn:async()=>(t("threat_classifier"),(await n.trainThreatClassifier()).data),onSuccess:()=>{p.invalidateQueries({queryKey:["ml-models"]}),t(null)},onError:()=>{t(null)}}),x=l({mutationFn:async()=>(t("asset_fingerprinter"),(await n.trainAssetFingerprinter()).data),onSuccess:()=>{p.invalidateQueries({queryKey:["ml-models"]}),t(null)},onError:()=>{t(null)}}),g=l({mutationFn:async()=>(t("attack_pattern_detector"),(await n.trainAttackDetector()).data),onSuccess:()=>{p.invalidateQueries({queryKey:["ml-models"]}),t(null)},onError:()=>{t(null)}}),b=l({mutationFn:async()=>(t("remediation_predictor"),(await n.trainRemediationPredictor()).data),onSuccess:()=>{p.invalidateQueries({queryKey:["ml-models"]}),t(null)},onError:()=>{t(null)}}),v=l({mutationFn:async()=>(await n.predictThreat({features:a})).data,onSuccess:s=>{_(s)}}),N=l({mutationFn:async()=>(await n.predictRemediationTime(r)).data,onSuccess:s=>{T(s)}}),k=s=>{switch(s.toLowerCase()){case"critical":return"text-red-700 bg-red-100";case"high":return"text-orange-700 bg-orange-100";case"medium":return"text-yellow-700 bg-yellow-100";case"low":return"text-blue-700 bg-blue-100";default:return"text-gray-700 bg-gray-100"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"ML Model Management"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Train custom machine learning models on your security data for threat classification, asset fingerprinting, and more"})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>w("models"),className:`${u==="models"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm`,children:"Model Training"}),e.jsx("button",{onClick:()=>w("predict"),className:`${u==="predict"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm`,children:"Predictions"})]})}),u==="models"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Trained Models"}),C?e.jsx("p",{className:"text-gray-500",children:"Loading models..."}):f&&f.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Model Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Version"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trained At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.name.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase())}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["v",s.version]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.trained_at).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:s.status})})]},`${s.name}-${s.version}`))})]})}):e.jsx("p",{className:"text-gray-500",children:"No models trained yet. Train your first model below!"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"ðŸŽ¯ Threat Classifier"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Classifies threats based on severity, CVE presence, exploit availability, and affected hosts."}),e.jsx("button",{onClick:()=>m.mutate(),disabled:i==="threat_classifier",className:"w-full px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300",children:i==="threat_classifier"?"Training...":"Train Model"}),m.data&&e.jsxs("div",{className:"mt-4 p-3 bg-green-50 rounded text-sm",children:[e.jsx("p",{className:"font-semibold text-green-800",children:"Training Complete!"}),e.jsxs("p",{children:["Accuracy: ",(m.data.metrics.accuracy*100).toFixed(1),"%"]}),e.jsxs("p",{children:["Samples: ",m.data.metrics.training_samples]}),e.jsxs("p",{children:["Time: ",m.data.metrics.training_time_seconds.toFixed(2),"s"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"ðŸ–¥ï¸ Asset Fingerprinter"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"ML-based OS and service detection with higher accuracy than signature-based methods."}),e.jsx("button",{onClick:()=>x.mutate(),disabled:i==="asset_fingerprinter",className:"w-full px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300",children:i==="asset_fingerprinter"?"Training...":"Train Model"}),x.data&&e.jsxs("div",{className:"mt-4 p-3 bg-green-50 rounded text-sm",children:[e.jsx("p",{className:"font-semibold text-green-800",children:"Training Complete!"}),e.jsxs("p",{children:["Accuracy: ",(x.data.metrics.accuracy*100).toFixed(1),"%"]}),e.jsxs("p",{children:["Samples: ",x.data.metrics.training_samples]}),e.jsxs("p",{children:["Time: ",x.data.metrics.training_time_seconds.toFixed(2),"s"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"ðŸ” Attack Pattern Detector"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Detects attack patterns and maps them to MITRE ATT&CK framework techniques."}),e.jsx("button",{onClick:()=>g.mutate(),disabled:i==="attack_pattern_detector",className:"w-full px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300",children:i==="attack_pattern_detector"?"Training...":"Train Model"}),g.data&&e.jsxs("div",{className:"mt-4 p-3 bg-green-50 rounded text-sm",children:[e.jsx("p",{className:"font-semibold text-green-800",children:"Training Complete!"}),e.jsxs("p",{children:["Accuracy: ",(g.data.metrics.accuracy*100).toFixed(1),"%"]}),e.jsxs("p",{children:["Samples: ",g.data.metrics.training_samples]}),e.jsxs("p",{children:["Time: ",g.data.metrics.training_time_seconds.toFixed(2),"s"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"â±ï¸ Remediation Predictor"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Predicts how long vulnerabilities will take to remediate based on historical data."}),e.jsx("button",{onClick:()=>b.mutate(),disabled:i==="remediation_predictor",className:"w-full px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300",children:i==="remediation_predictor"?"Training...":"Train Model"}),b.data&&e.jsxs("div",{className:"mt-4 p-3 bg-green-50 rounded text-sm",children:[e.jsx("p",{className:"font-semibold text-green-800",children:"Training Complete!"}),e.jsxs("p",{children:["Samples: ",b.data.metrics.training_samples]}),e.jsxs("p",{children:["Time: ",b.data.metrics.training_time_seconds.toFixed(2),"s"]})]})]})]})]}),u==="predict"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"ðŸŽ¯ Predict Threat Level"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Severity Score (0.0 - 1.0)"}),e.jsx("input",{type:"number",min:"0",max:"1",step:"0.1",value:a.severity_score,onChange:s=>o({...a,severity_score:parseFloat(s.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Age (days)"}),e.jsx("input",{type:"number",min:"0",value:a.age_days,onChange:s=>o({...a,age_days:parseInt(s.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Affected Hosts"}),e.jsx("input",{type:"number",min:"1",value:a.affected_hosts,onChange:s=>o({...a,affected_hosts:parseInt(s.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:a.has_cve,onChange:s=>o({...a,has_cve:s.target.checked}),className:"mr-2"}),"Has CVE"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:a.has_exploit,onChange:s=>o({...a,has_exploit:s.target.checked}),className:"mr-2"}),"Exploit Available"]})]})]}),e.jsx("button",{onClick:()=>v.mutate(),disabled:v.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300",children:v.isPending?"Predicting...":"Predict Threat Level"}),d&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Prediction Result"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Threat Level:"})," ",e.jsx("span",{className:`px-2 py-1 rounded text-sm font-semibold ${k(d.threat_level)}`,children:d.threat_level.toUpperCase()})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Confidence:"})," ",(d.confidence*100).toFixed(1),"%"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Recommendation:"})," ",d.recommendation]}),e.jsx("p",{children:e.jsx("strong",{children:"Contributing Factors:"})}),e.jsx("ul",{className:"list-disc pl-5 text-sm",children:d.factors.map((s,h)=>e.jsx("li",{children:s},h))})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"â±ï¸ Predict Remediation Time"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Severity"}),e.jsxs("select",{value:r.severity,onChange:s=>y({...r,severity:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Complexity"}),e.jsxs("select",{value:r.complexity,onChange:s=>y({...r,complexity:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team Size"}),e.jsx("input",{type:"number",min:"1",max:"20",value:r.team_size,onChange:s=>y({...r,team_size:parseInt(s.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),e.jsx("button",{onClick:()=>N.mutate(),disabled:N.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300",children:N.isPending?"Predicting...":"Predict Remediation Time"}),j&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Prediction Result"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-2xl font-bold text-indigo-600",children:[j.estimated_days.toFixed(1)," days"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Based on historical remediation data and your team configuration"}),e.jsx("p",{children:e.jsx("strong",{children:"Contributing Factors:"})}),e.jsx("ul",{className:"list-disc pl-5 text-sm",children:j.factors.map((s,h)=>e.jsx("li",{children:s},h))})]})]})]})]})]})};export{E as default};
