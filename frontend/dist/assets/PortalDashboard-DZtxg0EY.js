import{j as e}from"./vendor-state-GQ86PG8z.js";import{r as a,L as d}from"./vendor-react-5KxtEOLM.js";import{P as l}from"./PortalLayout-DaLf70HK.js";import{at as b}from"./index-DXyI7EZp.js";import{bj as h,a4 as g,F as u,O as p,p as k,at as v}from"./vendor-ui-B4zQTbMA.js";import"./vendor-utils-DfRopTPV.js";function D(){const[r,n]=a.useState(null),[o,c]=a.useState(!0),[i,x]=a.useState(null);if(a.useEffect(()=>{(async()=>{try{const s=await b.getDashboard();n(s.data)}catch(s){console.error("Failed to fetch dashboard:",s),x("Failed to load dashboard data")}finally{c(!1)}})()},[]),o)return e.jsx(l,{children:e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})})});if(i||!r)return e.jsx(l,{children:e.jsx("div",{className:"rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 p-4 text-red-700 dark:text-red-300",children:i||"Failed to load dashboard"})});const m=[{name:"Active Engagements",value:r.active_engagements,total:r.total_engagements,icon:h,color:"text-blue-600 dark:text-blue-400 bg-blue-100 dark:bg-blue-900/30",href:"/portal/engagements"},{name:"Open Vulnerabilities",value:r.open_vulnerabilities,subtext:`${r.critical_vulnerabilities} critical, ${r.high_vulnerabilities} high`,icon:g,color:r.critical_vulnerabilities>0?"text-red-600 dark:text-red-400 bg-red-100 dark:bg-red-900/30":"text-yellow-600 dark:text-yellow-400 bg-yellow-100 dark:bg-yellow-900/30",href:"/portal/vulnerabilities"},{name:"Available Reports",value:r.available_reports,icon:u,color:"text-green-600 dark:text-green-400 bg-green-100 dark:bg-green-900/30",href:"/portal/reports"}];return e.jsx(l,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:["Welcome back, ",r.customer_name]}),e.jsx("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:"Here's an overview of your security posture"})]}),r.critical_vulnerabilities>0&&e.jsx("div",{className:"rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{className:"h-6 w-6 text-red-600 dark:text-red-400 mr-3 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Critical Vulnerabilities Detected"}),e.jsxs("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:["You have ",r.critical_vulnerabilities," critical vulnerabilit",r.critical_vulnerabilities===1?"y":"ies"," that require immediate attention."]})]}),e.jsx(d,{to:"/portal/vulnerabilities?severity=critical",className:"ml-4 rounded-lg bg-red-600 hover:bg-red-700 px-4 py-2 text-sm font-medium text-white transition-colors",children:"View Details"})]})}),e.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3",children:m.map(t=>{const s=t.icon;return e.jsx(d,{to:t.href,className:"relative overflow-hidden rounded-lg bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border px-6 py-5 hover:border-primary/50 transition-colors",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex h-12 w-12 items-center justify-center rounded-lg ${t.color}`,children:e.jsx(s,{className:"h-6 w-6"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:t.name}),e.jsxs("div",{className:"flex items-baseline",children:[e.jsx("p",{className:"text-2xl font-semibold text-slate-900 dark:text-white",children:t.value}),t.total!==void 0&&e.jsxs("p",{className:"ml-2 text-sm text-slate-500 dark:text-slate-400",children:["of ",t.total]})]}),t.subtext&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:t.subtext})]})]})},t.name)})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-lg bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border overflow-hidden",children:[e.jsx("div",{className:"border-b border-light-border dark:border-dark-border px-6 py-4",children:e.jsx("h2",{className:"text-lg font-medium text-slate-900 dark:text-white",children:"Recent Scans"})}),e.jsx("div",{className:"divide-y divide-light-border dark:divide-dark-border",children:r.recent_scans.length===0?e.jsx("div",{className:"px-6 py-8 text-center text-sm text-slate-500 dark:text-slate-400",children:"No recent scans"}):r.recent_scans.map(t=>e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:t.name}),e.jsxs("div",{className:"flex items-center mt-1 text-xs text-slate-500 dark:text-slate-400",children:[e.jsx(k,{className:"mr-1 h-3 w-3"}),new Date(t.created_at).toLocaleDateString()]})]}),e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${t.status==="completed"?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300":t.status==="running"?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300":"bg-slate-100 dark:bg-slate-700 text-slate-800 dark:text-slate-300"}`,children:t.status})]})},t.id))})]}),e.jsxs("div",{className:"rounded-lg bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border overflow-hidden",children:[e.jsx("div",{className:"border-b border-light-border dark:border-dark-border px-6 py-4",children:e.jsx("h2",{className:"text-lg font-medium text-slate-900 dark:text-white",children:"Upcoming Milestones"})}),e.jsx("div",{className:"divide-y divide-light-border dark:divide-dark-border",children:r.upcoming_milestones.length===0?e.jsx("div",{className:"px-6 py-8 text-center text-sm text-slate-500 dark:text-slate-400",children:"No upcoming milestones"}):r.upcoming_milestones.map(t=>e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:t.name}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:t.engagement_name})]}),e.jsxs("div",{className:"text-right",children:[t.due_date&&e.jsxs("div",{className:"flex items-center text-xs text-slate-500 dark:text-slate-400",children:[e.jsx(v,{className:"mr-1 h-3 w-3"}),new Date(t.due_date).toLocaleDateString()]}),e.jsx("span",{className:`mt-1 inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${t.status==="completed"?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300":t.status==="in_progress"?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300":t.status==="overdue"?"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300":"bg-slate-100 dark:bg-slate-700 text-slate-800 dark:text-slate-300"}`,children:t.status})]})]})},t.id))}),r.upcoming_milestones.length>0&&e.jsx("div",{className:"border-t border-light-border dark:border-dark-border px-6 py-3",children:e.jsx(d,{to:"/portal/engagements",className:"text-sm font-medium text-primary hover:text-primary-dark",children:"View all engagements"})})]})]})]})})}export{D as PortalDashboard,D as default};
