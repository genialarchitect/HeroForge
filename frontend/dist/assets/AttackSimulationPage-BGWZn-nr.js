import{j as e,e as W,u as w,f as U}from"./vendor-state-oFDmcCcB.js";import{r as x}from"./vendor-react-5KxtEOLM.js";import{d as Q,a0 as de,q as ne,l as ce,G as je,a as fe,ap as Ne,a1 as ke,S as V,B as v,X as ve,m as Z,s as we,L as T,aZ as oe,V as A,g as ee,A as Se,aO as ae,w as L,i as z,p as xe,Y as K,bp as Ce,E as _e,k as qe,bV as Te,ax as Ae,aa as le,ac as Ee,$ as Fe}from"./vendor-ui-7EurIAWU.js";import{a8 as p,B as j}from"./index-MDkiA-RQ.js";import{L as X}from"./Layout-B2BPZquP.js";import{u as Le,E as De}from"./useRequireEngagement-Cwc_DHa_.js";import"./vendor-utils-DfRopTPV.js";import"./vendor-markdown-BwTKtS0m.js";const me=({technique:r,isSelected:i=!1,onToggleSelect:t,expanded:n=!1,onToggleExpand:o})=>{const m=c=>({reconnaissance:"bg-blue-500/20 text-blue-400 border-blue-500/30","resource-development":"bg-purple-500/20 text-purple-400 border-purple-500/30","initial-access":"bg-red-500/20 text-red-400 border-red-500/30",execution:"bg-orange-500/20 text-orange-400 border-orange-500/30",persistence:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30","privilege-escalation":"bg-pink-500/20 text-pink-400 border-pink-500/30","defense-evasion":"bg-indigo-500/20 text-indigo-400 border-indigo-500/30","credential-access":"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",discovery:"bg-teal-500/20 text-teal-400 border-teal-500/30","lateral-movement":"bg-emerald-500/20 text-emerald-400 border-emerald-500/30",collection:"bg-lime-500/20 text-lime-400 border-lime-500/30","command-and-control":"bg-amber-500/20 text-amber-400 border-amber-500/30",exfiltration:"bg-rose-500/20 text-rose-400 border-rose-500/30",impact:"bg-red-600/20 text-red-500 border-red-600/30"})[c.toLowerCase()]||"bg-gray-500/20 text-gray-400 border-gray-500/30";return e.jsxs("div",{className:`bg-light-surface dark:bg-dark-surface border rounded-lg transition-all ${i?"border-primary ring-2 ring-primary/20":"border-light-border dark:border-dark-border hover:border-primary/50"}`,children:[e.jsx("div",{className:`p-4 ${o?"cursor-pointer":""}`,onClick:o,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[t&&e.jsx("button",{onClick:c=>{c.stopPropagation(),t(r.id)},className:`mt-1 w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${i?"bg-primary border-primary text-white":"border-gray-400 dark:border-gray-600 hover:border-primary"}`,children:i&&e.jsx(Q,{className:"w-3 h-3"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-mono text-gray-500 dark:text-gray-400",children:r.id}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded border ${m(r.tactic)}`,children:r.tactic_name})]}),e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:r.name}),!n&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-2 mt-1",children:r.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("a",{href:r.mitre_url,target:"_blank",rel:"noopener noreferrer",onClick:c=>c.stopPropagation(),className:"p-1.5 text-gray-400 hover:text-primary transition-colors",title:"View on MITRE ATT&CK",children:e.jsx(de,{className:"w-4 h-4"})}),o&&e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-gray-200 transition-colors",children:n?e.jsx(ne,{className:"w-4 h-4"}):e.jsx(ce,{className:"w-4 h-4"})})]})]})}),n&&e.jsxs("div",{className:"px-4 pb-4 border-t border-light-border dark:border-dark-border pt-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:r.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[r.platforms.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Platforms"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r.platforms.map(c=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded",children:c},c))})]}),r.permissions_required.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(fe,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Permissions Required"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r.permissions_required.map(c=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-yellow-500/20 text-yellow-400 rounded",children:c},c))})]}),r.data_sources.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(Ne,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Data Sources"})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[r.data_sources.slice(0,5).map(c=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-cyan-500/20 text-cyan-400 rounded",children:c},c)),r.data_sources.length>5&&e.jsxs("span",{className:"px-2 py-0.5 text-xs text-gray-400",children:["+",r.data_sources.length-5," more"]})]})]}),r.payloads.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(ke,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Payloads Available"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r.payloads.map(c=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-500/20 text-green-400 rounded",children:c},c))})]})]}),r.detection&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Detection Guidance"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 line-clamp-4",children:r.detection})]})]})]})},Re=({onScenarioCreated:r,onCancel:i})=>{const t=W(),[n,o]=x.useState(""),[m,c]=x.useState(""),[u,f]=x.useState("dry_run"),[s,y]=x.useState([]),[N,S]=x.useState(300),[q,D]=x.useState(!1),[E,d]=x.useState(!0),[g,b]=x.useState([]),[C,R]=x.useState(""),[M,O]=x.useState(!1),[h,H]=x.useState("all"),[F,I]=x.useState(""),{data:$,isLoading:l}=w({queryKey:["bas-techniques"],queryFn:async()=>(await p.listTechniques()).data}),{data:_}=w({queryKey:["bas-tactics"],queryFn:async()=>(await p.listTactics()).data}),Y=U({mutationFn:async a=>(await p.createScenario(a)).data,onSuccess:a=>{v.success("Scenario created successfully"),t.invalidateQueries({queryKey:["bas-scenarios"]}),r==null||r(a.id)},onError:a=>{v.error(a.message||"Failed to create scenario")}}),ge=($==null?void 0:$.techniques)||[],ue=(_==null?void 0:_.tactics)||[],re=ge.filter(a=>{if(h!=="all"&&a.tactic!==h)return!1;if(F){const k=F.toLowerCase();return a.name.toLowerCase().includes(k)||a.id.toLowerCase().includes(k)||a.description.toLowerCase().includes(k)}return!0}),he=a=>{y(k=>k.includes(a)?k.filter(ye=>ye!==a):[...k,a])},se=()=>{C&&!g.includes(C)&&(b([...g,C]),R(""))},be=a=>{b(g.filter(k=>k!==a))},pe=()=>{if(!n.trim()){v.error("Please enter a scenario name");return}if(s.length===0){v.error("Please select at least one technique");return}Y.mutate({name:n.trim(),description:m.trim(),execution_mode:u,technique_ids:s,targets:[],timeout_secs:N,parallel_execution:q,continue_on_failure:E,tags:g})},te=a=>{switch(a){case"dry_run":return{label:"Dry Run",description:"Simulate techniques without actual execution. Safe for testing.",color:"text-green-400",icon:e.jsx(ee,{className:"w-4 h-4"})};case"safe":return{label:"Safe Mode",description:"Execute techniques with safety limits. Some artifacts may be created.",color:"text-yellow-400",icon:e.jsx(A,{className:"w-4 h-4"})};case"full":return{label:"Full Execution",description:"Execute techniques fully. Use with caution in controlled environments.",color:"text-red-400",icon:e.jsx(A,{className:"w-4 h-4"})}}};return e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg",children:[e.jsxs("div",{className:"p-4 border-b border-light-border dark:border-dark-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Create Attack Scenario"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Build a simulation scenario by selecting MITRE ATT&CK techniques"})]}),e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Scenario Name *"}),e.jsx("input",{type:"text",value:n,onChange:a=>o(a.target.value),placeholder:"e.g., Initial Access Validation",className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Execution Mode"}),e.jsxs("select",{value:u,onChange:a=>f(a.target.value),className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"dry_run",children:"Dry Run (Safe)"}),e.jsx("option",{value:"safe",children:"Safe Mode"}),e.jsx("option",{value:"full",children:"Full Execution"})]}),e.jsx("p",{className:`text-xs mt-1 ${te(u).color}`,children:te(u).description})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:m,onChange:a=>c(a.target.value),placeholder:"Describe the purpose of this simulation scenario...",rows:2,className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:g.map(a=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-primary/20 text-primary rounded",children:[a,e.jsx("button",{onClick:()=>be(a),className:"hover:text-red-400",children:e.jsx(ve,{className:"w-3 h-3"})})]},a))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:C,onChange:a=>R(a.target.value),onKeyDown:a=>a.key==="Enter"&&se(),placeholder:"Add a tag...",className:"flex-1 px-3 py-2 text-sm bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"}),e.jsx(j,{variant:"outline",size:"sm",onClick:se,children:e.jsx(Z,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>O(!M),className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200",children:[e.jsx(we,{className:"w-4 h-4"}),"Advanced Options",M?e.jsx(ne,{className:"w-4 h-4"}):e.jsx(ce,{className:"w-4 h-4"})]}),M&&e.jsxs("div",{className:"mt-4 p-4 bg-light-bg dark:bg-dark-bg rounded-lg space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Timeout (seconds)"}),e.jsx("input",{type:"number",value:N,onChange:a=>S(parseInt(a.target.value)||300),min:60,max:3600,className:"w-32 px-3 py-2 bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:q,onChange:a=>D(a.target.checked),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Execute techniques in parallel"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:E,onChange:a=>d(a.target.checked),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Continue on failure"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white",children:["Select Techniques (",s.length," selected)"]})}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx("input",{type:"text",value:F,onChange:a=>I(a.target.value),placeholder:"Search techniques...",className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"})}),e.jsxs("select",{value:h,onChange:a=>H(a.target.value),className:"px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Tactics"}),ue.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),l?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(T,{className:"w-8 h-8 text-primary animate-spin"})}):e.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[re.map(a=>e.jsx(me,{technique:a,isSelected:s.includes(a.id),onToggleSelect:he},a.id)),re.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No techniques match your filters"})]})]})]}),e.jsxs("div",{className:"p-4 border-t border-light-border dark:border-dark-border flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[s.length," technique",s.length!==1?"s":""," selected"]}),e.jsxs("div",{className:"flex gap-3",children:[i&&e.jsx(j,{variant:"outline",onClick:i,children:"Cancel"}),e.jsxs(j,{onClick:pe,disabled:Y.isPending||s.length===0,children:[Y.isPending?e.jsx(T,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Create Scenario"]})]})]})]})},Me=({simulationId:r,onBack:i})=>{const{data:t,isLoading:n}=w({queryKey:["bas-simulation",r],queryFn:async()=>(await p.getSimulation(r)).data});if(n)return e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(T,{className:"w-8 h-8 text-primary animate-spin"})});if(!t)return e.jsx("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"Simulation not found"});const o=s=>{switch(s.toLowerCase()){case"completed":return e.jsx(ee,{className:"w-5 h-5 text-green-400"});case"failed":return e.jsx(z,{className:"w-5 h-5 text-red-400"});case"running":return e.jsx(K,{className:"w-5 h-5 text-cyan-400 animate-pulse"});default:return e.jsx(xe,{className:"w-5 h-5 text-yellow-400"})}},m=s=>s.error?e.jsx(z,{className:"w-4 h-4 text-red-400"}):s.detection_observed?e.jsx(ae,{className:"w-4 h-4 text-green-400"}):s.status==="skipped"?e.jsx(Ce,{className:"w-4 h-4 text-gray-400"}):e.jsx(_e,{className:"w-4 h-4 text-yellow-400"}),c=s=>s>=80?"text-green-400":s>=60?"text-yellow-400":s>=40?"text-orange-400":"text-red-400",u=s=>s>=80?"bg-green-500/20 border-green-500/30":s>=60?"bg-yellow-500/20 border-yellow-500/30":s>=40?"bg-orange-500/20 border-orange-500/30":"bg-red-500/20 border-red-500/30",f=s=>s?s<1e3?`${s}ms`:`${(s/1e3).toFixed(1)}s`:"--";return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(j,{variant:"outline",size:"sm",onClick:i,children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Back"]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[o(t.status),e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Simulation Results"})]}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[t.execution_mode.replace("_"," ").toUpperCase()," mode |"," ","Started: ",new Date(t.started_at).toLocaleString()]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:`p-4 rounded-lg border ${u(t.summary.security_score)}`,children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Security Score"})]}),e.jsxs("div",{className:`text-3xl font-bold ${c(t.summary.security_score)}`,children:[t.summary.security_score,"%"]})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-light-surface dark:bg-dark-surface border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Detection Rate"})]}),e.jsxs("div",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:[(t.summary.detection_rate*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-light-surface dark:bg-dark-surface border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Techniques Tested"})]}),e.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:t.summary.total_techniques})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-light-surface dark:bg-dark-surface border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Detection Gaps"})]}),e.jsx("div",{className:`text-3xl font-bold ${t.detection_gaps.length>0?"text-red-400":"text-green-400"}`,children:t.detection_gaps.length})]})]}),e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-4",children:"Execution Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx(B,{label:"Succeeded",value:t.summary.succeeded,color:"text-green-400"}),e.jsx(B,{label:"Detected",value:t.summary.detected,color:"text-cyan-400"}),e.jsx(B,{label:"Blocked",value:t.summary.blocked,color:"text-blue-400"}),e.jsx(B,{label:"Failed",value:t.summary.failed,color:"text-red-400"}),e.jsx(B,{label:"Skipped",value:t.summary.skipped,color:"text-gray-400"})]})]}),t.detection_gaps.length>0&&e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg",children:[e.jsxs("div",{className:"p-4 border-b border-light-border dark:border-dark-border",children:[e.jsxs("h3",{className:"font-medium text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-yellow-400"}),"Detection Gaps (",t.detection_gaps.length,")"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"These techniques were not detected by your security controls"})]}),e.jsx("div",{className:"divide-y divide-light-border dark:divide-dark-border",children:t.detection_gaps.map(s=>e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-mono text-xs text-gray-500 dark:text-gray-400",children:s.technique_id}),e.jsx($e,{severity:s.severity})]}),e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:s.technique_name}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:s.tactics.map(y=>e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded",children:y},y))}),s.reason&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:s.reason}),s.recommendations.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Recommendations:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600 dark:text-gray-300",children:s.recommendations.map((y,N)=>e.jsx("li",{children:y},N))})]})]}),e.jsx("div",{children:s.acknowledged?e.jsx("span",{className:"text-xs px-2 py-1 bg-green-500/20 text-green-400 rounded",children:"Acknowledged"}):e.jsx("span",{className:"text-xs px-2 py-1 bg-yellow-500/20 text-yellow-400 rounded",children:"Pending Review"})})]})},s.id))})]}),e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg",children:[e.jsx("div",{className:"p-4 border-b border-light-border dark:border-dark-border",children:e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Technique Execution Log"})}),e.jsx("div",{className:"divide-y divide-light-border dark:divide-dark-border",children:t.executions.map(s=>e.jsxs("div",{className:"p-4 flex items-center gap-4",children:[m(s),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-xs text-gray-500 dark:text-gray-400",children:s.technique_id}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${s.detection_observed?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:s.detection_observed?"Detected":"Not Detected"})]}),s.detection_details&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate mt-1",children:s.detection_details}),s.error&&e.jsx("p",{className:"text-sm text-red-400 truncate mt-1",children:s.error})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"text-sm text-gray-400",children:f(s.duration_ms)})})]},s.id))})]}),t.error&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-400 mb-2",children:[e.jsx(z,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Simulation Error"})]}),e.jsx("p",{className:"text-sm text-red-300",children:t.error})]})]})},B=({label:r,value:i,color:t})=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-2xl font-bold ${t}`,children:i}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:r})]}),$e=({severity:r})=>{const t=(n=>n>=5?{label:"Critical",color:"bg-red-500/20 text-red-400"}:n>=4?{label:"High",color:"bg-orange-500/20 text-orange-400"}:n>=3?{label:"Medium",color:"bg-yellow-500/20 text-yellow-400"}:{label:"Low",color:"bg-blue-500/20 text-blue-400"})(r);return e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${t.color}`,children:t.label})},Be=({gaps:r,showFilters:i=!0})=>{const t=W(),[n,o]=x.useState("all"),[m,c]=x.useState(null),[u,f]=x.useState(""),{data:s,isLoading:y}=w({queryKey:["bas-unacknowledged-gaps"],queryFn:async()=>(await p.getUnacknowledgedGaps()).data,enabled:!r}),N=U({mutationFn:async({gapId:d,notes:g})=>(await p.acknowledgeGap(d,{notes:g})).data,onSuccess:()=>{v.success("Detection gap acknowledged"),t.invalidateQueries({queryKey:["bas-unacknowledged-gaps"]}),t.invalidateQueries({queryKey:["bas-stats"]}),c(null),f("")},onError:d=>{v.error(d.message||"Failed to acknowledge gap")}}),S=r||s||[],q=S.filter(d=>{var b;return n==="all"?!0:(b={critical:[5],high:[4],medium:[3],low:[1,2]}[n])==null?void 0:b.includes(d.severity)}),D=d=>d>=5?{label:"Critical",color:"bg-red-500/20 text-red-400 border-red-500/30",icon:"text-red-400"}:d>=4?{label:"High",color:"bg-orange-500/20 text-orange-400 border-orange-500/30",icon:"text-orange-400"}:d>=3?{label:"Medium",color:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",icon:"text-yellow-400"}:{label:"Low",color:"bg-blue-500/20 text-blue-400 border-blue-500/30",icon:"text-blue-400"},E=d=>`https://attack.mitre.org/techniques/${d.replace(".","/")}/`;return y?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(T,{className:"w-8 h-8 text-primary animate-spin"})}):S.length===0?e.jsxs("div",{className:"text-center py-12 bg-light-surface dark:bg-dark-surface rounded-lg border border-light-border dark:border-dark-border",children:[e.jsx(V,{className:"w-12 h-12 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No Detection Gaps"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"All tested techniques were detected by your security controls."})]}):e.jsxs("div",{children:[i&&e.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[e.jsxs("select",{value:n,onChange:d=>o(d.target.value),className:"px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Showing ",q.length," of ",S.length," gaps"]})]}),e.jsx("div",{className:"space-y-4",children:q.map(d=>{const g=D(d.severity);return e.jsx("div",{className:`bg-light-surface dark:bg-dark-surface border rounded-lg p-4 ${d.acknowledged?"border-green-500/30":"border-light-border dark:border-dark-border"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(A,{className:`w-5 h-5 ${g.icon}`}),e.jsx("span",{className:"font-mono text-sm text-gray-500 dark:text-gray-400",children:d.technique_id}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded border ${g.color}`,children:g.label}),d.acknowledged&&e.jsxs("span",{className:"text-xs px-2 py-0.5 bg-green-500/20 text-green-400 rounded flex items-center gap-1",children:[e.jsx(Q,{className:"w-3 h-3"}),"Acknowledged"]})]}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:d.technique_name}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:d.tactics.map(b=>e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded",children:b},b))}),d.reason&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:d.reason}),d.recommendations.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-light-bg dark:bg-dark-bg rounded-lg",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2 flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4"}),"Recommendations"]}),e.jsx("ul",{className:"space-y-1",children:d.recommendations.map((b,C)=>e.jsxs("li",{className:"text-sm text-gray-600 dark:text-gray-300 flex items-start gap-2",children:[e.jsx("span",{className:"text-primary mt-1",children:"-"}),b]},C))})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("a",{href:E(d.technique_id),target:"_blank",rel:"noopener noreferrer",className:"p-2 text-gray-400 hover:text-primary transition-colors",title:"View on MITRE ATT&CK",children:e.jsx(de,{className:"w-4 h-4"})}),!d.acknowledged&&e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>c(d),children:[e.jsx(Q,{className:"w-4 h-4 mr-1"}),"Acknowledge"]})]})]})},d.id)})}),m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface rounded-lg shadow-xl max-w-md w-full mx-4",children:[e.jsx("div",{className:"p-4 border-b border-light-border dark:border-dark-border",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Acknowledge Detection Gap"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2",children:"Acknowledging this gap indicates you have reviewed it and have a plan to address the detection coverage."}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-light-bg dark:bg-dark-bg rounded-lg",children:[e.jsx("span",{className:"font-mono text-sm text-gray-500 dark:text-gray-400",children:m.technique_id}),e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:m.technique_name})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"w-4 h-4"}),"Notes (optional)"]})}),e.jsx("textarea",{value:u,onChange:d=>f(d.target.value),placeholder:"e.g., Tracking in JIRA-1234, remediation planned for Q2",rows:3,className:"w-full px-3 py-2 bg-light-bg dark:bg-dark-bg border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{className:"p-4 border-t border-light-border dark:border-dark-border flex justify-end gap-3",children:[e.jsx(j,{variant:"outline",onClick:()=>{c(null),f("")},children:"Cancel"}),e.jsxs(j,{onClick:()=>N.mutate({gapId:m.id,notes:u||void 0}),disabled:N.isPending,children:[N.isPending?e.jsx(T,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Acknowledge"]})]})]})})]})},Ye=()=>{const r=W(),[i,t]=x.useState("scenarios"),{hasEngagement:n}=Le(),[o,m]=x.useState(!1),[c,u]=x.useState(null),[f,s]=x.useState("all"),[y,N]=x.useState(""),[S,q]=x.useState(null),{data:D=[],isLoading:E}=w({queryKey:["bas-techniques"],queryFn:async()=>(await p.listTechniques()).data.techniques,enabled:i==="techniques"}),{data:d=[]}=w({queryKey:["bas-tactics"],queryFn:async()=>(await p.listTactics()).data.tactics}),{data:g=[],isLoading:b,refetch:C}=w({queryKey:["bas-scenarios"],queryFn:async()=>(await p.listScenarios()).data.scenarios,enabled:i==="scenarios"}),{data:R=[],isLoading:M,refetch:O}=w({queryKey:["bas-simulations"],queryFn:async()=>(await p.listSimulations()).data.simulations,enabled:i==="simulations"}),{data:h}=w({queryKey:["bas-stats"],queryFn:async()=>(await p.getStats()).data}),H=U({mutationFn:async l=>{await p.deleteScenario(l)},onSuccess:()=>{v.success("Scenario deleted"),r.invalidateQueries({queryKey:["bas-scenarios"]})},onError:l=>{v.error(l.message||"Failed to delete scenario")}}),F=U({mutationFn:async l=>(await p.startSimulation({scenario_id:l})).data,onSuccess:l=>{v.success("Simulation started"),r.invalidateQueries({queryKey:["bas-simulations"]}),t("simulations"),u(l.id)},onError:l=>{v.error(l.message||"Failed to start simulation")}}),I=D.filter(l=>{if(f!=="all"&&l.tactic!==f)return!1;if(y){const _=y.toLowerCase();return l.name.toLowerCase().includes(_)||l.id.toLowerCase().includes(_)||l.description.toLowerCase().includes(_)}return!0}),$=l=>l>=80?"text-green-400":l>=60?"text-yellow-400":l>=40?"text-orange-400":"text-red-400";return c?e.jsx(X,{children:e.jsx(Me,{simulationId:c,onBack:()=>u(null)})}):o?e.jsx(X,{children:e.jsx(Re,{onScenarioCreated:()=>{m(!1),t("scenarios")},onCancel:()=>m(!1)})}):e.jsx(X,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[e.jsx(Te,{className:"w-7 h-7 text-primary"}),"Breach & Attack Simulation"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Test your security controls against MITRE ATT&CK techniques"})]}),e.jsxs(j,{onClick:()=>m(!0),disabled:!n,children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"New Scenario"]})]})}),e.jsx(De,{toolName:"Breach & Attack Simulation",className:"mb-6"}),h&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(G,{icon:e.jsx(L,{className:"w-5 h-5"}),label:"Scenarios",value:h.total_scenarios}),e.jsx(G,{icon:e.jsx(K,{className:"w-5 h-5"}),label:"Simulations",value:h.total_simulations}),e.jsx(G,{icon:e.jsx(V,{className:"w-5 h-5"}),label:"Avg Detection Rate",value:`${(h.avg_detection_rate*100).toFixed(0)}%`,valueColor:$(h.avg_detection_rate*100)}),e.jsx(G,{icon:e.jsx(A,{className:"w-5 h-5"}),label:"Unacked Gaps",value:h.unacknowledged_gaps,valueColor:h.unacknowledged_gaps>0?"text-yellow-400":"text-green-400"})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-6 border-b border-light-border dark:border-dark-border",children:[e.jsx(P,{active:i==="scenarios",onClick:()=>t("scenarios"),icon:e.jsx(L,{className:"w-4 h-4"}),label:"Scenarios"}),e.jsx(P,{active:i==="simulations",onClick:()=>t("simulations"),icon:e.jsx(K,{className:"w-4 h-4"}),label:"Simulations"}),e.jsx(P,{active:i==="techniques",onClick:()=>t("techniques"),icon:e.jsx(Ae,{className:"w-4 h-4"}),label:"Techniques"}),e.jsx(P,{active:i==="gaps",onClick:()=>t("gaps"),icon:e.jsx(A,{className:"w-4 h-4"}),label:"Detection Gaps",badge:h==null?void 0:h.unacknowledged_gaps})]}),i==="scenarios"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Attack Scenarios"}),e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>C(),children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),b?e.jsx(J,{}):g.length===0?e.jsx(ie,{icon:e.jsx(L,{className:"w-12 h-12 text-gray-400"}),title:"No Scenarios Yet",description:"Create your first attack scenario to test your security controls.",action:e.jsxs(j,{onClick:()=>m(!0),children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Create Scenario"]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:g.map(l=>e.jsx(Ke,{scenario:l,onRun:()=>F.mutate(l.id),onDelete:()=>H.mutate(l.id),isRunning:F.isPending},l.id))})]}),i==="simulations"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Simulation History"}),e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>O(),children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),M?e.jsx(J,{}):R.length===0?e.jsx(ie,{icon:e.jsx(K,{className:"w-12 h-12 text-gray-400"}),title:"No Simulations Yet",description:"Run a scenario to see simulation results here."}):e.jsx("div",{className:"space-y-4",children:R.map(l=>e.jsx(Ie,{simulation:l,onView:()=>u(l.id)},l.id))})]}),i==="techniques"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx("input",{type:"text",value:y,onChange:l=>N(l.target.value),placeholder:"Search techniques...",className:"w-full px-3 py-2 bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"})}),e.jsxs("select",{value:f,onChange:l=>s(l.target.value),className:"px-3 py-2 bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Tactics"}),d.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 self-center",children:[I.length," techniques"]})]}),E?e.jsx(J,{}):e.jsx("div",{className:"space-y-3",children:I.map(l=>e.jsx(me,{technique:l,expanded:S===l.id,onToggleExpand:()=>q(S===l.id?null:l.id)},l.id))})]}),i==="gaps"&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Unacknowledged Detection Gaps"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Review and acknowledge gaps in your detection coverage"})]}),e.jsx(Be,{})]})]})})},P=({active:r,onClick:i,icon:t,label:n,badge:o})=>e.jsxs("button",{onClick:i,className:`pb-3 px-1 border-b-2 transition-colors flex items-center gap-2 ${r?"border-primary text-primary":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[t,e.jsx("span",{children:n}),o!==void 0&&o>0&&e.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-yellow-500/20 text-yellow-400 rounded-full",children:o})]}),G=({icon:r,label:i,value:t,valueColor:n="text-gray-900 dark:text-white"})=>e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-2",children:[r,e.jsx("span",{className:"text-sm font-medium",children:i})]}),e.jsx("div",{className:`text-2xl font-bold ${n}`,children:t})]}),Ke=({scenario:r,onRun:i,onDelete:t,isRunning:n})=>e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(L,{className:"w-5 h-5 text-primary"}),e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white truncate",children:r.name}),r.status==="builtin"&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded",children:"Built-in"})]}),r.description&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-2 mb-3",children:r.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:[r.technique_count," techniques"]}),e.jsx("span",{className:"capitalize",children:r.execution_mode.replace("_"," ")})]}),r.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:r.tags.map(o=>e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded",children:o},o))})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:i,disabled:n,children:n?e.jsx(T,{className:"w-4 h-4 animate-spin"}):e.jsx(oe,{className:"w-4 h-4"})}),r.status!=="builtin"&&e.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-red-400 transition-colors",title:"Delete scenario",children:e.jsx(Ee,{className:"w-4 h-4"})})]})]})}),Ie=({simulation:r,onView:i})=>{const t=o=>{switch(o.toLowerCase()){case"completed":return e.jsx(ee,{className:"w-4 h-4 text-green-400"});case"failed":return e.jsx(z,{className:"w-4 h-4 text-red-400"});case"running":return e.jsx(K,{className:"w-4 h-4 text-cyan-400 animate-pulse"});default:return e.jsx(xe,{className:"w-4 h-4 text-yellow-400"})}},n=o=>o>=80?"text-green-400":o>=60?"text-yellow-400":o>=40?"text-orange-400":"text-red-400";return e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[t(r.status),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["Simulation ",r.id.slice(0,8)]}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 capitalize",children:["(",r.execution_mode.replace("_"," "),")"]})]}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(r.started_at).toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-lg font-bold ${n(r.security_score)}`,children:[r.security_score,"%"]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Score"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[(r.detection_rate*100).toFixed(0),"%"]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Detection"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:r.total_techniques}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Techniques"})]}),e.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-primary transition-colors",title:"View details",children:e.jsx(Fe,{className:"w-5 h-5"})})]})]})})},J=()=>e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(T,{className:"w-8 h-8 text-primary animate-spin"})}),ie=({icon:r,title:i,description:t,action:n})=>e.jsxs("div",{className:"text-center py-12 bg-light-surface dark:bg-dark-surface rounded-lg border border-light-border dark:border-dark-border",children:[e.jsx("div",{className:"mb-4 flex justify-center",children:r}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:i}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:t}),n]});export{Ye as default};
