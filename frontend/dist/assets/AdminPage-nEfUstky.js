import{j as e}from"./vendor-state-Dv52s5nL.js";import{r as i}from"./vendor-react-BdkUp9lr.js";import{a as b,C as u,L as A,B as L,b as $,c as I}from"./index-mgRulVfg.js";import{B as h,l as _,ak as Q,al as M,Q as U,S as R,U as F,a8 as D,O as T,T as P,g as E,m as z,am as B,h as V,A as O}from"./vendor-ui-BqjU7FU2.js";import"./vendor-charts-LMABhejW.js";const J=()=>{const[r,N]=i.useState([]),[y,o]=i.useState(!0),[n,f]=i.useState(""),[x,w]=i.useState(null),[v,g]=i.useState(!1);i.useEffect(()=>{p()},[]);const p=async()=>{o(!0);try{const a=await b.getUsers();N(a.data)}catch(a){h.error("Failed to load users"),console.error(a)}finally{o(!1)}},S=async(a,m)=>{var c,j;if(confirm(`Are you sure you want to delete user "${m}"? This action cannot be undone.`))try{await b.deleteUser(a),h.success("User deleted successfully"),p()}catch(C){h.error(((j=(c=C.response)==null?void 0:c.data)==null?void 0:j.error)||"Failed to delete user")}},s=async a=>{var m,c;try{await b.updateUser(a.id,{is_active:!a.is_active}),h.success(`User ${a.is_active?"deactivated":"activated"} successfully`),p()}catch(j){h.error(((c=(m=j.response)==null?void 0:m.data)==null?void 0:c.error)||"Failed to update user")}},t=async(a,m)=>{var c,j;try{await b.assignRole(a,m),h.success("Role assigned successfully"),p(),g(!1)}catch(C){h.error(((j=(c=C.response)==null?void 0:c.data)==null?void 0:j.error)||"Failed to assign role")}},l=async(a,m)=>{var c,j;try{await b.removeRole(a,m),h.success("Role removed successfully"),p()}catch(C){h.error(((j=(c=C.response)==null?void 0:c.data)==null?void 0:j.error)||"Failed to remove role")}},d=r.filter(a=>a.username.toLowerCase().includes(n.toLowerCase())||a.email.toLowerCase().includes(n.toLowerCase())),k=a=>{switch(a){case"admin":return"bg-red-500/20 text-red-400 border-red-500/30";case"auditor":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"user":return"bg-green-500/20 text-green-400 border-green-500/30";case"viewer":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return y?e.jsx(u,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(A,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search users by username or email...",value:n,onChange:a=>f(a.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs(L,{variant:"primary",disabled:!0,children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Add User (Coming Soon)"]})]})}),e.jsxs(u,{children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:["Users (",d.length,")"]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-border",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Username"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Email"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Roles"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Created"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-slate-400",children:"Actions"})]})}),e.jsx("tbody",{children:d.map(a=>{var m;return e.jsxs("tr",{className:"border-b border-dark-border hover:bg-dark-hover",children:[e.jsx("td",{className:"py-3 px-4 text-white font-medium",children:a.username}),e.jsx("td",{className:"py-3 px-4 text-slate-300",children:a.email}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[(m=a.roles)==null?void 0:m.map(c=>e.jsx("div",{className:"group relative",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded border ${k(c)}`,children:[c,a.roles&&a.roles.length>1&&e.jsx("button",{onClick:()=>l(a.id,c),className:"hover:text-red-400 ml-1",children:"Ã—"})]})},c)),e.jsx("button",{onClick:()=>{w(a),g(!0)},className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded border border-dashed border-slate-600 text-slate-400 hover:text-white hover:border-primary",children:"+ Add Role"})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx($,{variant:"status",type:a.is_active?"completed":"failed",children:a.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"py-3 px-4 text-slate-400 text-sm",children:a.created_at?new Date(a.created_at).toLocaleDateString():"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>s(a),className:"p-2 text-slate-400 hover:text-primary transition-colors",title:a.is_active?"Deactivate user":"Activate user",children:e.jsx(M,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>S(a.id,a.username),className:"p-2 text-slate-400 hover:text-red-400 transition-colors",title:"Delete user",children:e.jsx(U,{className:"h-4 w-4"})})]})})]},a.id)})})]}),d.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No users found matching your search"})]})]}),v&&x&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40",onClick:()=>g(!1)}),e.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50 bg-dark-surface border border-dark-border rounded-lg shadow-2xl p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5 text-primary"}),"Assign Role to ",x.username]}),e.jsx("button",{onClick:()=>g(!1),className:"text-slate-400 hover:text-white transition-colors",children:"Ã—"})]}),e.jsx("div",{className:"space-y-2",children:["admin","user","auditor","viewer"].map(a=>{var c;const m=(c=x.roles)==null?void 0:c.includes(a);return e.jsx("button",{onClick:()=>!m&&t(x.id,a),disabled:m,className:`w-full text-left px-4 py-3 rounded border transition-colors ${m?"bg-dark-bg border-dark-border text-slate-500 cursor-not-allowed":"bg-dark-bg border-dark-border text-white hover:border-primary hover:bg-dark-hover"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium capitalize",children:a}),e.jsxs("div",{className:"text-xs text-slate-400",children:[a==="admin"&&"Full system access",a==="user"&&"Standard user access",a==="auditor"&&"Read-only access to all scans and logs",a==="viewer"&&"View-only access to own scans"]})]}),m&&e.jsx("span",{className:"text-xs text-green-400",children:"Already assigned"})]})},a)})})]})]})]})},W=()=>{const[r,N]=i.useState([]),[y,o]=i.useState(!0),[n,f]=i.useState(""),[x,w]=i.useState("all");i.useEffect(()=>{v()},[]);const v=async()=>{o(!0);try{const s=await b.getAllScans();N(s.data)}catch(s){h.error("Failed to load scans"),console.error(s)}finally{o(!1)}},g=async(s,t)=>{var l,d;if(confirm(`Are you sure you want to delete scan "${t}"? This action cannot be undone.`))try{await b.deleteScan(s),h.success("Scan deleted successfully"),v()}catch(k){h.error(((d=(l=k.response)==null?void 0:l.data)==null?void 0:d.error)||"Failed to delete scan")}},p=r.filter(s=>{const t=s.name.toLowerCase().includes(n.toLowerCase())||s.targets.toLowerCase().includes(n.toLowerCase()),l=x==="all"||s.status===x;return t&&l}),S=s=>{switch(s){case"completed":return"bg-green-500/20 text-green-400 border-green-500/30";case"running":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"failed":return"bg-red-500/20 text-red-400 border-red-500/30";case"pending":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return y?e.jsx(u,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(A,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search scans by name or target...",value:n,onChange:s=>f(s.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("select",{value:x,onChange:s=>w(s.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"running",children:"Running"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"})]})]})}),e.jsxs(u,{children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:["All Scans (",p.length,")"]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-border",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Scan Name"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Targets"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"User ID"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Created"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-slate-400",children:"Actions"})]})}),e.jsx("tbody",{children:p.map(s=>e.jsxs("tr",{className:"border-b border-dark-border hover:bg-dark-hover",children:[e.jsx("td",{className:"py-3 px-4 text-white font-medium",children:s.name}),e.jsx("td",{className:"py-3 px-4 text-slate-300 font-mono text-sm",children:s.targets.length>50?`${s.targets.substring(0,50)}...`:s.targets}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded border ${S(s.status)}`,children:s.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm",children:[e.jsx(F,{className:"h-3 w-3"}),s.user_id.substring(0,8),"..."]})}),e.jsx("td",{className:"py-3 px-4 text-slate-400 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-3 w-3"}),new Date(s.created_at).toLocaleString()]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx("button",{onClick:()=>g(s.id,s.name),className:"p-2 text-slate-400 hover:text-red-400 transition-colors",title:"Delete scan",children:e.jsx(U,{className:"h-4 w-4"})})})})]},s.id))})]}),p.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No scans found matching your filters"})]})]}),e.jsxs(u,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:r.filter(s=>s.status==="completed").length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Completed"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:r.filter(s=>s.status==="running").length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Running"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:r.filter(s=>s.status==="pending").length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Pending"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:r.filter(s=>s.status==="failed").length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Failed"})]})]})]})]})},q=()=>{const[r,N]=i.useState([]),[y,o]=i.useState(!0),[n,f]=i.useState(""),[x,w]=i.useState("all");i.useEffect(()=>{v()},[]);const v=async()=>{o(!0);try{const s=await b.getAuditLogs(100,0);N(s.data)}catch(s){h.error("Failed to load audit logs"),console.error(s)}finally{o(!1)}},g=r.filter(s=>{var d;const t=s.action.toLowerCase().includes(n.toLowerCase())||s.user_id.toLowerCase().includes(n.toLowerCase())||((d=s.target_id)==null?void 0:d.toLowerCase().includes(n.toLowerCase())),l=x==="all"||s.action.startsWith(x);return t&&l}),p=s=>s.includes("create")||s.includes("assign")?"bg-green-500/20 text-green-400 border-green-500/30":s.includes("delete")||s.includes("remove")?"bg-red-500/20 text-red-400 border-red-500/30":s.includes("update")?"bg-yellow-500/20 text-yellow-400 border-yellow-500/30":"bg-blue-500/20 text-blue-400 border-blue-500/30",S=s=>s.includes("user")?"ðŸ‘¤":s.includes("scan")?"ðŸ”":s.includes("role")?"ðŸ›¡ï¸":s.includes("setting")?"âš™ï¸":"ðŸ“";return y?e.jsx(u,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(A,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search logs by action, user ID, or target...",value:n,onChange:s=>f(s.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("select",{value:x,onChange:s=>w(s.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Actions"}),e.jsx("option",{value:"user",children:"User Actions"}),e.jsx("option",{value:"scan",children:"Scan Actions"}),e.jsx("option",{value:"role",children:"Role Actions"}),e.jsx("option",{value:"setting",children:"Setting Actions"})]})]})}),e.jsxs(u,{children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:[e.jsx(T,{className:"inline h-5 w-5 mr-2"}),"Audit Logs (",g.length,")"]}),e.jsxs("div",{className:"space-y-2",children:[g.map(s=>e.jsx("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-4 hover:border-primary/30 transition-colors",children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:S(s.action)}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded border ${p(s.action)}`,children:s.action})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{className:"text-slate-500",children:"User:"}),e.jsxs("span",{className:"font-mono text-slate-300",children:[s.user_id.substring(0,8),"..."]})]}),s.target_type&&s.target_id&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx("span",{className:"text-slate-500",children:"Target:"}),e.jsxs("span",{className:"font-mono text-slate-300",children:[s.target_type,":",s.target_id.substring(0,8),"..."]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("span",{className:"text-slate-300",children:new Date(s.created_at).toLocaleString()})]})]}),s.details&&e.jsx("div",{className:"mt-2 pt-2 border-t border-dark-border",children:e.jsxs("details",{className:"text-xs",children:[e.jsx("summary",{className:"cursor-pointer text-slate-500 hover:text-slate-400",children:"View details"}),e.jsx("pre",{className:"mt-2 p-2 bg-dark-surface rounded text-slate-400 overflow-x-auto",children:JSON.stringify(JSON.parse(s.details),null,2)})]})})]})})},s.id)),g.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No audit logs found matching your filters"})]})]}),e.jsxs(u,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Action Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:r.filter(s=>s.action.includes("create")||s.action.includes("assign")).length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Created/Assigned"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:r.filter(s=>s.action.includes("update")).length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Updated"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:r.filter(s=>s.action.includes("delete")||s.action.includes("remove")).length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Deleted/Removed"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:r.length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Total Actions"})]})]})]})]})},G=()=>{const[r,N]=i.useState([]),[y,o]=i.useState(!0),[n,f]=i.useState({}),[x,w]=i.useState({});i.useEffect(()=>{v()},[]);const v=async()=>{o(!0);try{const t=await b.getSettings();N(t.data);const l={};t.data.forEach(d=>{l[d.key]=d.value}),f(l)}catch(t){h.error("Failed to load settings"),console.error(t)}finally{o(!1)}},g=async t=>{var l,d;w({...x,[t]:!0});try{await b.updateSetting(t,n[t]),h.success(`Setting "${t}" updated successfully`),v()}catch(k){h.error(((d=(l=k.response)==null?void 0:l.data)==null?void 0:d.error)||"Failed to update setting")}finally{w({...x,[t]:!1})}},p=t=>{const l=r.find(d=>d.key===t);l&&f({...n,[t]:l.value})},S=t=>{const l=r.find(d=>d.key===t);return l&&n[t]!==l.value},s=t=>t.includes("scan")?"ðŸ”":t.includes("user")?"ðŸ‘¤":t.includes("retention")?"ðŸ—“ï¸":t.includes("registration")?"ðŸ“":"âš™ï¸";return y?e.jsx(u,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(A,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(u,{children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:[e.jsx(E,{className:"inline h-5 w-5 mr-2"}),"System Settings (",r.length,")"]}),e.jsxs("div",{className:"space-y-4",children:[r.map(t=>e.jsx("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:s(t.key)}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:t.key}),t.description&&e.jsx("p",{className:"text-sm text-slate-400",children:t.description})]})]}),e.jsx("div",{className:"mt-3",children:t.key==="allow_registration"?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n[t.key]==="true",onChange:l=>f({...n,[t.key]:l.target.checked?"true":"false"}),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-dark-surface peer-focus:ring-2 peer-focus:ring-primary rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"})]}),e.jsx("span",{className:"text-sm text-slate-400",children:n[t.key]==="true"?"Enabled":"Disabled"})]}):e.jsx("input",{type:t.key.includes("days")?"number":"text",value:n[t.key]||"",onChange:l=>f({...n,[t.key]:l.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})}),e.jsxs("div",{className:"mt-3 flex items-center gap-4 text-xs text-slate-500",children:[t.updated_by&&e.jsxs("span",{children:["Last updated by: ",e.jsxs("span",{className:"font-mono",children:[t.updated_by.substring(0,8),"..."]})]}),t.updated_at&&e.jsx("span",{children:new Date(t.updated_at).toLocaleString()})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(L,{onClick:()=>g(t.key),disabled:!S(t.key)||x[t.key],variant:"primary",size:"sm",children:[e.jsx(z,{className:"h-4 w-4 mr-1"}),x[t.key]?"Saving...":"Save"]}),S(t.key)&&e.jsxs(L,{onClick:()=>p(t.key),variant:"secondary",size:"sm",children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"Reset"]})]})]})},t.key)),r.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No system settings configured"})]})]}),e.jsxs(u,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"â„¹ï¸ Information"}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-400",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-white",children:"max_scans_per_user:"})," Maximum number of scans each user can create. Set to 0 for unlimited."]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-white",children:"scan_retention_days:"})," Automatically delete scans older than this many days. Set to 0 to disable auto-deletion."]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-white",children:"allow_registration:"})," Whether new users can register accounts. Disable this to restrict new registrations."]})]})]})]})},ee=()=>{const[r,N]=i.useState("users"),y=[{value:"users",label:"Users",icon:V},{value:"scans",label:"Scans",icon:O},{value:"audit",label:"Audit Logs",icon:T},{value:"settings",label:"Settings",icon:E}];return e.jsx(I,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Admin Console"}),e.jsx("p",{className:"text-slate-400",children:"Manage users, scans, and system settings"})]})]}),e.jsx("div",{className:"border-b border-dark-border",children:e.jsx("div",{className:"flex gap-1",children:y.map(o=>{const n=o.icon;return e.jsxs("button",{onClick:()=>N(o.value),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${r===o.value?"border-primary text-primary font-medium":"border-transparent text-slate-400 hover:text-white hover:border-slate-600"}`,children:[e.jsx(n,{className:"h-4 w-4"}),o.label]},o.value)})})}),e.jsxs("div",{className:"animate-fadeIn",children:[r==="users"&&e.jsx(J,{}),r==="scans"&&e.jsx(W,{}),r==="audit"&&e.jsx(q,{}),r==="settings"&&e.jsx(G,{})]})]})})};export{ee as default};
