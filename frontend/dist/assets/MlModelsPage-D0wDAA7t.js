import{b as E,u as q,d,j as e}from"./vendor-state-BjT_zREg.js";import{r as c}from"./vendor-react-5KxtEOLM.js";import{au as n,B as o}from"./index-BwCSAD78.js";import{L as B}from"./Layout-KYMPsh8G.js";import{C as l}from"./Card-CV6m9jT5.js";import{B as m}from"./Badge-Bi3Nk-Vg.js";import{au as C,w as K,g as Q,O as U,v as T,am as D,y as I,p as F}from"./vendor-ui-CaTPr3iI.js";import"./vendor-utils-DfRopTPV.js";import"./vendor-markdown-BGP8SuZQ.js";const Y=()=>{const j=E(),[N,S]=c.useState("models"),[r,t]=c.useState(null),[a,x]=c.useState({severity_score:.5,has_cve:!1,has_exploit:!1,age_days:30,affected_hosts:1}),[p,P]=c.useState(null),[i,v]=c.useState({severity:"high",complexity:"medium",team_size:3}),[y,M]=c.useState(null),{data:w,isLoading:A}=q({queryKey:["ml-models"],queryFn:async()=>(await n.listModels()).data}),h=d({mutationFn:async()=>(t("threat_classifier"),(await n.trainThreatClassifier()).data),onSuccess:()=>{j.invalidateQueries({queryKey:["ml-models"]}),t(null)},onError:()=>{t(null)}}),u=d({mutationFn:async()=>(t("asset_fingerprinter"),(await n.trainAssetFingerprinter()).data),onSuccess:()=>{j.invalidateQueries({queryKey:["ml-models"]}),t(null)},onError:()=>{t(null)}}),g=d({mutationFn:async()=>(t("attack_pattern_detector"),(await n.trainAttackDetector()).data),onSuccess:()=>{j.invalidateQueries({queryKey:["ml-models"]}),t(null)},onError:()=>{t(null)}}),f=d({mutationFn:async()=>(t("remediation_predictor"),(await n.trainRemediationPredictor()).data),onSuccess:()=>{j.invalidateQueries({queryKey:["ml-models"]}),t(null)},onError:()=>{t(null)}}),k=d({mutationFn:async()=>(await n.predictThreat({features:a})).data,onSuccess:s=>{P(s)}}),_=d({mutationFn:async()=>(await n.predictRemediationTime(i)).data,onSuccess:s=>{M(s)}}),R=s=>{switch(s.toLowerCase()){case"critical":return e.jsx(m,{variant:"danger",children:s.toUpperCase()});case"high":return e.jsx(m,{variant:"warning",children:s.toUpperCase()});case"medium":return e.jsx(m,{variant:"default",children:s.toUpperCase()});case"low":return e.jsx(m,{variant:"info",children:s.toUpperCase()});default:return e.jsx(m,{variant:"default",children:s.toUpperCase()})}},L=[{id:"models",label:"Model Training",icon:K},{id:"predict",label:"Predictions",icon:C}];return e.jsx(B,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[e.jsx(C,{className:"h-8 w-8 text-primary"}),"ML Model Management"]}),e.jsx("p",{className:"text-slate-400 mt-2",children:"Train custom machine learning models on your security data for threat classification, asset fingerprinting, and more"})]}),e.jsx("div",{className:"flex items-center gap-2 border-b border-dark-border",children:L.map(s=>e.jsxs("button",{onClick:()=>S(s.id),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors border-b-2 -mb-px ${N===s.id?"border-primary text-primary":"border-transparent text-slate-400 hover:text-white hover:border-slate-600"}`,children:[e.jsx(s.icon,{className:"h-4 w-4"}),s.label]},s.id))}),N==="models"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(l,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5 text-green-400"}),"Trained Models"]}),A?e.jsx("p",{className:"text-slate-400",children:"Loading models..."}):w&&w.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-border",children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Model Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Version"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Trained At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-dark-border",children:w.map(s=>e.jsxs("tr",{className:"hover:bg-dark-bg/50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-white",children:s.name.replace(/_/g," ").replace(/\b\w/g,b=>b.toUpperCase())}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-300",children:["v",s.version]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-300",children:new Date(s.trained_at).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(m,{variant:"success",children:s.status})})]},`${s.name}-${s.version}`))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(U,{className:"h-12 w-12 text-slate-500 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-400",children:"No models trained yet. Train your first model below!"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(l,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg",children:e.jsx(T,{className:"h-6 w-6 text-red-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Threat Classifier"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"Classifies threats based on severity, CVE presence, exploit availability, and affected hosts."}),e.jsx(o,{onClick:()=>h.mutate(),disabled:r==="threat_classifier",className:"w-full",children:r==="threat_classifier"?"Training...":"Train Model"}),h.data&&e.jsxs("div",{className:"mt-4 p-3 bg-green-500/10 border border-green-500/20 rounded-lg text-sm",children:[e.jsx("p",{className:"font-semibold text-green-400",children:"Training Complete!"}),e.jsxs("p",{className:"text-slate-300",children:["Accuracy: ",(h.data.metrics.accuracy*100).toFixed(1),"%"]}),e.jsxs("p",{className:"text-slate-300",children:["Samples: ",h.data.metrics.training_samples]}),e.jsxs("p",{className:"text-slate-300",children:["Time: ",h.data.metrics.training_time_seconds.toFixed(2),"s"]})]})]})}),e.jsx(l,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(D,{className:"h-6 w-6 text-blue-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Asset Fingerprinter"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"ML-based OS and service detection with higher accuracy than signature-based methods."}),e.jsx(o,{onClick:()=>u.mutate(),disabled:r==="asset_fingerprinter",className:"w-full",children:r==="asset_fingerprinter"?"Training...":"Train Model"}),u.data&&e.jsxs("div",{className:"mt-4 p-3 bg-green-500/10 border border-green-500/20 rounded-lg text-sm",children:[e.jsx("p",{className:"font-semibold text-green-400",children:"Training Complete!"}),e.jsxs("p",{className:"text-slate-300",children:["Accuracy: ",(u.data.metrics.accuracy*100).toFixed(1),"%"]}),e.jsxs("p",{className:"text-slate-300",children:["Samples: ",u.data.metrics.training_samples]}),e.jsxs("p",{className:"text-slate-300",children:["Time: ",u.data.metrics.training_time_seconds.toFixed(2),"s"]})]})]})}),e.jsx(l,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/10 rounded-lg",children:e.jsx(I,{className:"h-6 w-6 text-purple-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Attack Pattern Detector"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"Detects attack patterns and maps them to MITRE ATT&CK framework techniques."}),e.jsx(o,{onClick:()=>g.mutate(),disabled:r==="attack_pattern_detector",className:"w-full",children:r==="attack_pattern_detector"?"Training...":"Train Model"}),g.data&&e.jsxs("div",{className:"mt-4 p-3 bg-green-500/10 border border-green-500/20 rounded-lg text-sm",children:[e.jsx("p",{className:"font-semibold text-green-400",children:"Training Complete!"}),e.jsxs("p",{className:"text-slate-300",children:["Accuracy: ",(g.data.metrics.accuracy*100).toFixed(1),"%"]}),e.jsxs("p",{className:"text-slate-300",children:["Samples: ",g.data.metrics.training_samples]}),e.jsxs("p",{className:"text-slate-300",children:["Time: ",g.data.metrics.training_time_seconds.toFixed(2),"s"]})]})]})}),e.jsx(l,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-cyan-500/10 rounded-lg",children:e.jsx(F,{className:"h-6 w-6 text-cyan-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Remediation Predictor"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"Predicts how long vulnerabilities will take to remediate based on historical data."}),e.jsx(o,{onClick:()=>f.mutate(),disabled:r==="remediation_predictor",className:"w-full",children:r==="remediation_predictor"?"Training...":"Train Model"}),f.data&&e.jsxs("div",{className:"mt-4 p-3 bg-green-500/10 border border-green-500/20 rounded-lg text-sm",children:[e.jsx("p",{className:"font-semibold text-green-400",children:"Training Complete!"}),e.jsxs("p",{className:"text-slate-300",children:["Samples: ",f.data.metrics.training_samples]}),e.jsxs("p",{className:"text-slate-300",children:["Time: ",f.data.metrics.training_time_seconds.toFixed(2),"s"]})]})]})})]})]}),N==="predict"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(l,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg",children:e.jsx(T,{className:"h-6 w-6 text-red-400"})}),e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Predict Threat Level"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Severity Score (0.0 - 1.0)"}),e.jsx("input",{type:"number",min:"0",max:"1",step:"0.1",value:a.severity_score,onChange:s=>x({...a,severity_score:parseFloat(s.target.value)}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-md text-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Age (days)"}),e.jsx("input",{type:"number",min:"0",value:a.age_days,onChange:s=>x({...a,age_days:parseInt(s.target.value)}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-md text-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Affected Hosts"}),e.jsx("input",{type:"number",min:"1",value:a.affected_hosts,onChange:s=>x({...a,affected_hosts:parseInt(s.target.value)}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-md text-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{className:"space-y-3 pt-6",children:[e.jsxs("label",{className:"flex items-center gap-2 text-slate-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.has_cve,onChange:s=>x({...a,has_cve:s.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary focus:ring-offset-dark-surface"}),"Has CVE"]}),e.jsxs("label",{className:"flex items-center gap-2 text-slate-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.has_exploit,onChange:s=>x({...a,has_exploit:s.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary focus:ring-offset-dark-surface"}),"Exploit Available"]})]})]}),e.jsx(o,{onClick:()=>k.mutate(),disabled:k.isPending,children:k.isPending?"Predicting...":"Predict Threat Level"}),p&&e.jsxs("div",{className:"mt-4 p-4 bg-dark-bg border border-dark-border rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-white mb-3",children:"Prediction Result"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-400",children:"Threat Level:"}),R(p.threat_level)]}),e.jsxs("p",{className:"text-slate-300",children:[e.jsx("span",{className:"text-slate-400",children:"Confidence:"})," ",(p.confidence*100).toFixed(1),"%"]}),e.jsxs("p",{className:"text-slate-300",children:[e.jsx("span",{className:"text-slate-400",children:"Recommendation:"})," ",p.recommendation]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Contributing Factors:"}),e.jsx("ul",{className:"list-disc pl-5 text-sm text-slate-300 mt-1",children:p.factors.map((s,b)=>e.jsx("li",{children:s},b))})]})]})]})]})}),e.jsx(l,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-cyan-500/10 rounded-lg",children:e.jsx(F,{className:"h-6 w-6 text-cyan-400"})}),e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Predict Remediation Time"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Severity"}),e.jsxs("select",{value:i.severity,onChange:s=>v({...i,severity:s.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-md text-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Complexity"}),e.jsxs("select",{value:i.complexity,onChange:s=>v({...i,complexity:s.target.value}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-md text-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Team Size"}),e.jsx("input",{type:"number",min:"1",max:"20",value:i.team_size,onChange:s=>v({...i,team_size:parseInt(s.target.value)}),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-md text-white focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsx(o,{onClick:()=>_.mutate(),disabled:_.isPending,children:_.isPending?"Predicting...":"Predict Remediation Time"}),y&&e.jsxs("div",{className:"mt-4 p-4 bg-dark-bg border border-dark-border rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-white mb-3",children:"Prediction Result"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-3xl font-bold text-primary",children:[y.estimated_days.toFixed(1)," days"]}),e.jsx("p",{className:"text-sm text-slate-400",children:"Based on historical remediation data and your team configuration"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Contributing Factors:"}),e.jsx("ul",{className:"list-disc pl-5 text-sm text-slate-300 mt-1",children:y.factors.map((s,b)=>e.jsx("li",{children:s},b))})]})]})]})]})})]})]})})};export{Y as default};
