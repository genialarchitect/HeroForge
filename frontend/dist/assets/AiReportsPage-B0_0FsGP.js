import{u as te,d as m,j as e}from"./vendor-state-BjT_zREg.js";import{r as t}from"./vendor-react-5KxtEOLM.js";import{L as le}from"./Layout-DQwy8A8G.js";import{C as x}from"./Card-CV6m9jT5.js";import{at as n,B as p,b as re}from"./index-RI0GBk2h.js";import{B as ie}from"./Badge-Bi3Nk-Vg.js";import{be as c,F as M,v as F,p as I,O as G,N as z,a1 as L,bB as D}from"./vendor-ui-C4nf_tR6.js";import"./vendor-markdown-BGP8SuZQ.js";import"./vendor-utils-DfRopTPV.js";const be=()=>{const[r,O]=t.useState("reports"),[h,V]=t.useState(""),[b,k]=t.useState("executive"),[l,q]=t.useState(null),[j,B]=t.useState(""),[g,K]=t.useState(""),[o,W]=t.useState(null),[y,H]=t.useState(""),[S,Q]=t.useState(""),[i,U]=t.useState(null),[C,$]=t.useState("VulnerabilityManagement"),[N,J]=t.useState(""),[P,X]=t.useState(""),[u,Y]=t.useState(null),[v,Z]=t.useState(""),[f,ee]=t.useState(""),[d,se]=t.useState(null),{data:w}=te({queryKey:["scans"],queryFn:async()=>(await re.getAll()).data}),R=m({mutationFn:async()=>(b==="executive"?await n.generateExecutiveReport(h):await n.generateTechnicalReport(h)).data,onSuccess:s=>{q(s)}}),A=m({mutationFn:async()=>(await n.planScan({targets:j.split(`
`).filter(a=>a.trim()),objectives:g.split(`
`).filter(a=>a.trim())})).data,onSuccess:s=>{W(s)}}),T=m({mutationFn:async()=>(await n.analyzeExploit({code:y,context:S||void 0})).data,onSuccess:s=>{U(s)}}),_=m({mutationFn:async()=>(await n.generatePolicy({policy_type:C,organization:N,compliance_frameworks:P.split(",").map(a=>a.trim()).filter(a=>a)})).data,onSuccess:s=>{Y(s)}}),E=m({mutationFn:async()=>(await n.getRemediationGuidance({vulnerability:v,context:f})).data,onSuccess:s=>{se(s)}}),ae=[{id:"reports",label:"AI Reports",icon:e.jsx(M,{className:"h-4 w-4"})},{id:"scan-plan",label:"Scan Planning",icon:e.jsx(F,{className:"h-4 w-4"})},{id:"exploit",label:"Exploit Analysis",icon:e.jsx(z,{className:"h-4 w-4"})},{id:"policy",label:"Policy Generator",icon:e.jsx(L,{className:"h-4 w-4"})},{id:"remediation",label:"Remediation",icon:e.jsx(D,{className:"h-4 w-4"})}];return e.jsx(le,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[e.jsx(c,{className:"h-8 w-8 text-primary"}),"AI-Powered Security Operations"]}),e.jsx("p",{className:"text-slate-400 mt-2",children:"Use LLM capabilities for automated report generation, scan planning, and security analysis"})]})}),e.jsx("div",{className:"flex items-center gap-2 border-b border-dark-border",children:ae.map(s=>e.jsxs("button",{onClick:()=>O(s.id),className:`flex items-center gap-2 px-4 py-3 font-medium transition-colors border-b-2 ${r===s.id?"text-primary border-primary":"text-slate-400 border-transparent hover:text-white hover:border-slate-600"}`,children:[s.icon,s.label]},s.id))}),r==="reports"&&e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(M,{className:"h-6 w-6 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Generate AI Reports"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Select Scan"}),e.jsxs("select",{value:h,onChange:s=>V(s.target.value),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"",children:"Choose a scan..."}),w==null?void 0:w.map(s=>e.jsxs("option",{value:s.id,children:[s.name||s.targets," - ",new Date(s.created_at).toLocaleDateString()]},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Report Type"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"executive",checked:b==="executive",onChange:s=>k(s.target.value),className:"text-primary focus:ring-primary"}),e.jsx("span",{className:"text-slate-300",children:"Executive Summary (C-level)"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"technical",checked:b==="technical",onChange:s=>k(s.target.value),className:"text-primary focus:ring-primary"}),e.jsx("span",{className:"text-slate-300",children:"Technical Report (Engineers)"})]})]})]}),e.jsxs(p,{variant:"primary",onClick:()=>R.mutate(),disabled:!h,loading:R.isPending,children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),"Generate Report"]}),l&&e.jsxs("div",{className:"mt-6 p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("h3",{className:"font-semibold text-white mb-4",children:"Generated Report"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-400",children:"Risk Score:"}),e.jsxs(ie,{variant:l.risk_score>7?"danger":l.risk_score>4?"warning":"success",children:[l.risk_score,"/10"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"Summary:"}),e.jsx("p",{className:"text-slate-300 whitespace-pre-wrap",children:l.summary||l.technical_summary})]}),l.key_findings&&e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"Key Findings:"}),e.jsx("ul",{className:"list-disc pl-5 text-slate-300 space-y-1",children:l.key_findings.map((s,a)=>e.jsx("li",{children:s},a))})]}),l.recommendations&&e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"Recommendations:"}),e.jsx("ul",{className:"list-disc pl-5 text-slate-300 space-y-1",children:l.recommendations.map((s,a)=>e.jsx("li",{children:s},a))})]})]})]})]})]}),r==="scan-plan"&&e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(F,{className:"h-6 w-6 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Intelligent Scan Planning"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Targets (one per line)"}),e.jsx("textarea",{value:j,onChange:s=>B(s.target.value),placeholder:`app.example.com
192.168.1.0/24
api.company.com`,className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-slate-500 h-24 focus:outline-none focus:border-primary resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Objectives (one per line)"}),e.jsx("textarea",{value:g,onChange:s=>K(s.target.value),placeholder:`Web vulnerability assessment
Network mapping
SSL/TLS analysis`,className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-slate-500 h-24 focus:outline-none focus:border-primary resize-none"})]}),e.jsxs(p,{variant:"primary",onClick:()=>A.mutate(),disabled:!j||!g,loading:A.isPending,children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),"Generate Scan Plan"]}),o&&e.jsxs("div",{className:"mt-6 p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("h3",{className:"font-semibold text-white mb-4",children:"Recommended Scan Plan"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{className:"text-slate-400",children:"Estimated Duration:"}),e.jsx("span",{className:"text-white",children:o.estimated_duration})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-2",children:"Recommended Scans:"}),e.jsx("ol",{className:"list-decimal pl-5 text-slate-300 space-y-1",children:o.recommended_scans.map((s,a)=>e.jsx("li",{children:s},a))})]}),o.risk_factors.length>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-slate-400 mb-2 flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4 text-yellow-500"}),"Risk Factors:"]}),e.jsx("ul",{className:"list-disc pl-5 text-yellow-400 space-y-1",children:o.risk_factors.map((s,a)=>e.jsx("li",{children:s},a))})]})]})]})]})]}),r==="exploit"&&e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(z,{className:"h-6 w-6 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Exploit Code Analysis"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Exploit Code"}),e.jsx("textarea",{value:y,onChange:s=>H(s.target.value),placeholder:"Paste exploit code here...",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-slate-500 h-32 font-mono text-sm focus:outline-none focus:border-primary resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Context (optional)"}),e.jsx("input",{type:"text",value:S,onChange:s=>Q(s.target.value),placeholder:"e.g., WordPress plugin, PHP file upload vulnerability",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-primary"})]}),e.jsxs(p,{variant:"primary",onClick:()=>T.mutate(),disabled:!y,loading:T.isPending,children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),"Analyze Exploit"]}),i&&e.jsxs("div",{className:"mt-6 p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("h3",{className:"font-semibold text-white mb-4",children:"Analysis Results"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Vulnerability:"}),e.jsx("span",{className:"text-white ml-2",children:i.vulnerability_id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Impact:"}),e.jsx("span",{className:"text-red-400 ml-2",children:i.impact_assessment})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"Attack Flow:"}),e.jsx("p",{className:"text-slate-300 whitespace-pre-wrap bg-dark-surface p-3 rounded",children:i.attack_flow})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"MITRE ATT&CK Techniques:"}),e.jsx("ul",{className:"list-disc pl-5 text-slate-300 space-y-1",children:i.mitre_techniques.map((s,a)=>e.jsx("li",{children:s},a))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-1",children:"Mitigations:"}),e.jsx("ul",{className:"list-disc pl-5 text-green-400 space-y-1",children:i.mitigations.map((s,a)=>e.jsx("li",{children:s},a))})]})]})]})]})]}),r==="policy"&&e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(L,{className:"h-6 w-6 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Security Policy Generator"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Policy Type"}),e.jsxs("select",{value:C,onChange:s=>$(s.target.value),className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"AccessControl",children:"Access Control"}),e.jsx("option",{value:"DataProtection",children:"Data Protection"}),e.jsx("option",{value:"IncidentResponse",children:"Incident Response"}),e.jsx("option",{value:"ChangeManagement",children:"Change Management"}),e.jsx("option",{value:"AssetManagement",children:"Asset Management"}),e.jsx("option",{value:"VulnerabilityManagement",children:"Vulnerability Management"}),e.jsx("option",{value:"NetworkSecurity",children:"Network Security"}),e.jsx("option",{value:"CloudSecurity",children:"Cloud Security"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Organization Name"}),e.jsx("input",{type:"text",value:N,onChange:s=>J(s.target.value),placeholder:"Acme Corporation",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Compliance Frameworks (comma-separated)"}),e.jsx("input",{type:"text",value:P,onChange:s=>X(s.target.value),placeholder:"PCI-DSS, SOC 2, NIST CSF, HIPAA",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-primary"})]}),e.jsxs(p,{variant:"primary",onClick:()=>_.mutate(),disabled:!N,loading:_.isPending,children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),"Generate Policy"]}),u&&e.jsxs("div",{className:"mt-6 p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("h3",{className:"font-semibold text-white mb-2",children:u.title}),e.jsxs("p",{className:"text-sm text-slate-400 mb-4",children:["Review Schedule: ",u.review_schedule]}),e.jsx("div",{className:"bg-dark-surface p-4 rounded text-slate-300 whitespace-pre-wrap max-h-96 overflow-y-auto",children:u.content})]})]})]}),r==="remediation"&&e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(D,{className:"h-6 w-6 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Remediation Guidance"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Vulnerability Description"}),e.jsx("input",{type:"text",value:v,onChange:s=>Z(s.target.value),placeholder:"e.g., SQL Injection in login form",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Context"}),e.jsx("textarea",{value:f,onChange:s=>ee(s.target.value),placeholder:"Additional context: affected system, technology stack, environment details...",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-slate-500 h-24 focus:outline-none focus:border-primary resize-none"})]}),e.jsxs(p,{variant:"primary",onClick:()=>E.mutate(),disabled:!v||!f,loading:E.isPending,children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),"Get Guidance"]}),d&&e.jsxs("div",{className:"mt-6 p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("h3",{className:"font-semibold text-white mb-4",children:"Remediation Plan"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-yellow-400 font-medium flex items-center gap-2 mb-2",children:[e.jsx(G,{className:"h-4 w-4"}),"Immediate Actions:"]}),e.jsx("ul",{className:"list-disc pl-5 text-slate-300 space-y-1",children:d.immediate_actions.map((s,a)=>e.jsx("li",{children:s},a))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 font-medium mb-2",children:"Detailed Steps:"}),e.jsx("ol",{className:"list-decimal pl-5 text-slate-300 space-y-1",children:d.detailed_steps.map((s,a)=>e.jsx("li",{children:s},a))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 font-medium mb-2",children:"Tools Required:"}),e.jsx("ul",{className:"list-disc pl-5 text-slate-300 space-y-1",children:d.tools_required.map((s,a)=>e.jsx("li",{children:s},a))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{className:"text-slate-400",children:"Estimated Time:"}),e.jsx("span",{className:"text-white",children:d.estimated_time})]})]})]})]})]})]})})};export{be as default};
