import{j as e}from"./vendor-state-DdX3IZQk.js";import{r as l}from"./vendor-react-Da1CiaFS.js";import{i as o,d as ge}from"./index-hrzMRAZZ.js";import{B as i,F as B,bl as me,aN as pe,P as he,as as ue,n as ye,aA as be,aq as S,S as Q,aB as z,bb as H,aQ as fe,i as je}from"./vendor-ui-wM19Qo8C.js";import"./vendor-charts-CCbxmwBt.js";const _={critical:"bg-red-500/20 text-red-400 border-red-500/30",high:"bg-orange-500/20 text-orange-400 border-orange-500/30",medium:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",low:"bg-blue-500/20 text-blue-400 border-blue-500/30",info:"bg-gray-500/20 text-gray-400 border-gray-500/30"},K=[{id:"A01:2021",name:"Broken Access Control"},{id:"A02:2021",name:"Cryptographic Failures"},{id:"A03:2021",name:"Injection"},{id:"A04:2021",name:"Insecure Design"},{id:"A05:2021",name:"Security Misconfiguration"},{id:"A06:2021",name:"Vulnerable Components"},{id:"A07:2021",name:"Authentication Failures"},{id:"A08:2021",name:"Software and Data Integrity Failures"},{id:"A09:2021",name:"Security Logging and Monitoring Failures"},{id:"A10:2021",name:"Server-Side Request Forgery"}],_e=()=>{const[k,T]=l.useState([]),[X,G]=l.useState([]),[F,Y]=l.useState([]),[A,p]=l.useState(!1),[h,E]=l.useState(""),[d,O]=l.useState(""),[x,P]=l.useState(""),[g,I]=l.useState(""),[v,Z]=l.useState(!1),[t,u]=l.useState(null),[$,y]=l.useState(!1),[ee,N]=l.useState(!1),[b,D]=l.useState([]),[se,J]=l.useState(!1),[r,c]=l.useState(null),[w,L]=l.useState(!1);l.useEffect(()=>{f()},[]),l.useEffect(()=>{const s=setTimeout(()=>{h||d||x||g?ae():R()},300);return()=>clearTimeout(s)},[h,d,x,g]);const f=async()=>{p(!0);try{await Promise.all([R(),te(),re()])}finally{p(!1)}},R=async()=>{try{const s=await o.list({include_system:!0});T(s.data)}catch(s){console.error("Failed to load templates:",s),i.error("Failed to load finding templates")}},te=async()=>{try{const s=await o.getCategories();G(s.data)}catch(s){console.error("Failed to load categories:",s)}},re=async()=>{try{const s=await o.getPopular(5);Y(s.data)}catch(s){console.error("Failed to load popular templates:",s)}},ae=async()=>{p(!0);try{const s=await o.search({query:h||void 0,category:d||void 0,severity:x||void 0,owasp:g||void 0});T(s.data)}catch(s){console.error("Failed to search templates:",s),i.error("Failed to search templates")}finally{p(!1)}},M=()=>{c({category:"",title:"",severity:"medium",description:"",impact:"",remediation:"",references:[],cwe_ids:[],tags:[]}),L(!1),y(!0)},V=s=>{c({category:s.category,title:s.title,severity:s.severity,description:s.description,impact:s.impact||"",remediation:s.remediation||"",references:s.references?JSON.parse(s.references):[],cwe_ids:s.cwe_ids?JSON.parse(s.cwe_ids):[],cvss_vector:s.cvss_vector||"",cvss_score:s.cvss_score||void 0,tags:s.tags?JSON.parse(s.tags):[],testing_steps:s.testing_steps||"",owasp_category:s.owasp_category||"",mitre_attack_ids:s.mitre_attack_ids?JSON.parse(s.mitre_attack_ids):[]}),u(s),L(!0),y(!0)},le=async()=>{if(!(r!=null&&r.title)||!(r!=null&&r.category)||!(r!=null&&r.description)){i.error("Please fill in required fields: Title, Category, and Description");return}p(!0);try{w&&t?(await o.update(t.id,r),i.success("Template updated successfully")):(await o.create(r),i.success("Template created successfully")),y(!1),c(null),u(null),await f()}catch(s){console.error("Failed to save template:",s),i.error("Failed to save template")}finally{p(!1)}},ie=async s=>{if(s.is_system){i.error("Cannot delete system templates");return}if(confirm(`Are you sure you want to delete "${s.title}"?`))try{await o.delete(s.id),i.success("Template deleted successfully"),await f()}catch(a){console.error("Failed to delete template:",a),i.error("Failed to delete template")}},U=async s=>{try{await o.clone(s.id,{new_title:`${s.title} (Copy)`}),i.success("Template cloned successfully"),await f()}catch(a){console.error("Failed to clone template:",a),i.error("Failed to clone template")}},ce=async()=>{J(!0);try{const s=await o.exportTemplates(b.length>0?b:void 0),a=new Blob([JSON.stringify(s.data,null,2)],{type:"application/json"}),n=URL.createObjectURL(a),m=document.createElement("a");m.href=n,m.download=`finding-templates-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(n),i.success("Templates exported successfully"),D([])}catch(s){console.error("Failed to export templates:",s),i.error("Failed to export templates")}finally{J(!1)}},ne=async s=>{var n;const a=(n=s.target.files)==null?void 0:n[0];if(a)try{const m=await a.text(),C=JSON.parse(m),j=await o.importTemplates({templates:Array.isArray(C)?C:[C],overwrite_existing:!1});i.success(`Imported ${j.data.imported} templates (${j.data.skipped} skipped)`),j.data.errors.length>0&&j.data.errors.forEach(xe=>i.warning(xe)),N(!1),await f()}catch(m){console.error("Failed to import templates:",m),i.error("Failed to import templates. Please check the file format.")}},oe=s=>{D(a=>a.includes(s)?a.filter(n=>n!==s):[...a,s])},de=()=>{E(""),O(""),P(""),I("")},W=s=>{if(!s.evidence_placeholders)return[];try{return JSON.parse(s.evidence_placeholders)}catch{return[]}},q=s=>{if(!s.compliance_mappings)return{};try{return JSON.parse(s.compliance_mappings)}catch{return{}}};return e.jsx(ge,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(B,{className:"h-6 w-6 text-cyan-400"}),"Finding Templates"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Reusable vulnerability templates with evidence placeholders and compliance mappings"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>N(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:[e.jsx(me,{className:"h-4 w-4"}),"Import"]}),e.jsxs("button",{onClick:ce,disabled:se,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50",children:[e.jsx(pe,{className:"h-4 w-4"}),"Export",b.length>0?` (${b.length})`:""]}),e.jsxs("button",{onClick:M,className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-500",children:[e.jsx(he,{className:"h-4 w-4"}),"New Template"]})]})]}),F.length>0&&!h&&!d&&!x&&!g&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("h2",{className:"text-sm font-medium text-gray-400 mb-3 flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4 text-yellow-400"}),"Popular Templates"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:F.map(s=>e.jsxs("button",{onClick:()=>u(s),className:"flex items-center gap-2 px-3 py-1.5 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 text-sm",children:[e.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${s.severity==="critical"?"bg-red-500":s.severity==="high"?"bg-orange-500":s.severity==="medium"?"bg-yellow-500":s.severity==="low"?"bg-blue-500":"bg-gray-500"}`}),s.title,e.jsxs("span",{className:"text-gray-500 text-xs",children:["(",s.use_count||0,")"]})]},s.id))})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ye,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-500"}),e.jsx("input",{type:"text",placeholder:"Search templates...",value:h,onChange:s=>E(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),e.jsxs("button",{onClick:()=>Z(!v),className:`flex items-center gap-2 px-4 py-2 rounded-lg border ${v||d||x||g?"bg-cyan-600/20 text-cyan-400 border-cyan-500/30":"bg-gray-700 text-gray-300 border-gray-600"}`,children:[e.jsx(be,{className:"h-4 w-4"}),"Filters",(d||x||g)&&e.jsx("span",{className:"bg-cyan-500 text-white text-xs px-1.5 py-0.5 rounded-full",children:[d,x,g].filter(Boolean).length})]})]}),v&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 pt-4 border-t border-gray-700",children:[e.jsxs("select",{value:d,onChange:s=>O(s.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"",children:"All Categories"}),X.map(s=>e.jsxs("option",{value:s.category,children:[s.category," (",s.count,")"]},s.category))]}),e.jsxs("select",{value:x,onChange:s=>P(s.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"info",children:"Info"})]}),e.jsxs("select",{value:g,onChange:s=>I(s.target.value),className:"px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"",children:"All OWASP Categories"}),K.map(s=>e.jsxs("option",{value:s.id,children:[s.id," - ",s.name]},s.id))]}),(d||x||g)&&e.jsxs("button",{onClick:de,className:"flex items-center gap-1 px-3 py-2 text-gray-400 hover:text-white",children:[e.jsx(S,{className:"h-4 w-4"}),"Clear"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:A?e.jsx("div",{className:"col-span-full flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-400"})}):k.length===0?e.jsxs("div",{className:"col-span-full text-center py-12 bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx(B,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No templates found"}),e.jsx("button",{onClick:M,className:"mt-4 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-500",children:"Create your first template"})]}):k.map(s=>e.jsx("div",{className:`bg-gray-800 rounded-lg border ${(t==null?void 0:t.id)===s.id?"border-cyan-500":"border-gray-700"} hover:border-gray-600 transition-colors cursor-pointer`,onClick:()=>u(s),children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.is_system&&e.jsx("span",{title:"System Template",children:e.jsx(Q,{className:"h-4 w-4 text-cyan-400"})}),e.jsx("h3",{className:"font-medium text-white truncate",children:s.title})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.category})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full border ${_[s.severity]||_.info}`,children:s.severity})]}),e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2 mb-3",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[s.owasp_category&&e.jsx("span",{className:"px-2 py-0.5 text-xs bg-purple-500/20 text-purple-400 rounded",children:s.owasp_category}),s.cwe_ids&&JSON.parse(s.cwe_ids).slice(0,2).map(a=>e.jsxs("span",{className:"px-2 py-0.5 text-xs bg-blue-500/20 text-blue-400 rounded",children:["CWE-",a]},a))]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:b.includes(s.id),onChange:a=>{a.stopPropagation(),oe(s.id)},className:"rounded border-gray-600 bg-gray-700 text-cyan-600 focus:ring-cyan-500"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Used ",s.use_count||0," times"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),U(s)},className:"p-1.5 text-gray-400 hover:text-cyan-400",title:"Clone",children:e.jsx(z,{className:"h-4 w-4"})}),!s.is_system&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),V(s)},className:"p-1.5 text-gray-400 hover:text-cyan-400",title:"Edit",children:e.jsx(H,{className:"h-4 w-4"})}),e.jsx("button",{onClick:a=>{a.stopPropagation(),ie(s)},className:"p-1.5 text-gray-400 hover:text-red-400",title:"Delete",children:e.jsx(fe,{className:"h-4 w-4"})})]})]})]})]})},s.id))}),t&&!$&&e.jsxs("div",{className:"fixed inset-y-0 right-0 w-full max-w-xl bg-gray-900 border-l border-gray-700 shadow-xl z-50 overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-900 p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:t.title}),e.jsx("button",{onClick:()=>u(null),className:"p-2 text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-3 py-1 text-sm rounded-full border ${_[t.severity]}`,children:t.severity}),e.jsx("span",{className:"text-gray-400",children:t.category}),t.is_system&&e.jsxs("span",{className:"flex items-center gap-1 text-cyan-400 text-sm",children:[e.jsx(Q,{className:"h-4 w-4"}),"System Template"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Description"}),e.jsx("p",{className:"text-white whitespace-pre-wrap",children:t.description})]}),t.impact&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Impact"}),e.jsx("p",{className:"text-white whitespace-pre-wrap",children:t.impact})]}),t.remediation&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Remediation"}),e.jsx("p",{className:"text-white whitespace-pre-wrap",children:t.remediation})]}),t.testing_steps&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Testing Steps"}),e.jsx("p",{className:"text-white whitespace-pre-wrap",children:t.testing_steps})]}),W(t).length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Evidence Placeholders"}),e.jsx("div",{className:"space-y-2",children:W(t).map(s=>e.jsxs("div",{className:"bg-gray-800 rounded p-3 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-white",children:s.label}),e.jsx("span",{className:"text-xs text-gray-400",children:s.placeholder_type})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.description}),s.required&&e.jsx("span",{className:"text-xs text-red-400",children:"Required"})]},s.id))})]}),t.cvss_score&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400",children:"CVSS Score"}),e.jsx("span",{className:`text-2xl font-bold ${t.cvss_score>=9?"text-red-400":t.cvss_score>=7?"text-orange-400":t.cvss_score>=4?"text-yellow-400":"text-green-400"}`,children:t.cvss_score})]}),t.cvss_vector&&e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400",children:"CVSS Vector"}),e.jsx("code",{className:"text-xs text-gray-300 bg-gray-800 px-2 py-1 rounded",children:t.cvss_vector})]})]}),Object.keys(q(t)).length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Compliance Mappings"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(q(t)).map(([s,a])=>e.jsxs("div",{className:"bg-gray-800 rounded px-3 py-2 border border-gray-700",children:[e.jsx("span",{className:"text-xs text-gray-400 uppercase",children:s.replace("_"," ")}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:a.map(n=>e.jsx("span",{className:"text-xs text-cyan-400",children:n},n))})]},s))})]}),t.cwe_ids&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"CWE References"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:JSON.parse(t.cwe_ids).map(s=>e.jsxs("a",{href:`https://cwe.mitre.org/data/definitions/${s}.html`,target:"_blank",rel:"noopener noreferrer",className:"px-2 py-1 text-sm bg-blue-500/20 text-blue-400 rounded hover:bg-blue-500/30",children:["CWE-",s]},s))})]}),t.mitre_attack_ids&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"MITRE ATT&CK Techniques"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:JSON.parse(t.mitre_attack_ids).map(s=>e.jsx("a",{href:`https://attack.mitre.org/techniques/${s.replace(".","/")}/`,target:"_blank",rel:"noopener noreferrer",className:"px-2 py-1 text-sm bg-red-500/20 text-red-400 rounded hover:bg-red-500/30",children:s},s))})]}),t.references&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"References"}),e.jsx("ul",{className:"space-y-1",children:JSON.parse(t.references).map((s,a)=>e.jsx("li",{children:e.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-cyan-400 hover:underline text-sm break-all",children:s})},a))})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-700",children:[e.jsxs("button",{onClick:()=>U(t),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:[e.jsx(z,{className:"h-4 w-4"}),"Clone Template"]}),!t.is_system&&e.jsxs("button",{onClick:()=>V(t),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-500",children:[e.jsx(H,{className:"h-4 w-4"}),"Edit Template"]})]})]})]}),$&&r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-900 p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:w?"Edit Template":"Create Template"}),e.jsx("button",{onClick:()=>{y(!1),c(null)},className:"p-2 text-gray-400 hover:text-white",children:e.jsx(S,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:r.title||"",onChange:s=>c({...r,title:s.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"e.g., SQL Injection in Login Form"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Category *"}),e.jsx("input",{type:"text",value:r.category||"",onChange:s=>c({...r,category:s.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"e.g., Web Application"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Severity *"}),e.jsxs("select",{value:r.severity||"medium",onChange:s=>c({...r,severity:s.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"info",children:"Info"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"OWASP Category"}),e.jsxs("select",{value:r.owasp_category||"",onChange:s=>c({...r,owasp_category:s.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"",children:"Select OWASP Category"}),K.map(s=>e.jsxs("option",{value:s.id,children:[s.id," - ",s.name]},s.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Description *"}),e.jsx("textarea",{value:r.description||"",onChange:s=>c({...r,description:s.target.value}),rows:4,className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Detailed description of the vulnerability..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Impact"}),e.jsx("textarea",{value:r.impact||"",onChange:s=>c({...r,impact:s.target.value}),rows:3,className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"What is the potential impact of this vulnerability..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Remediation"}),e.jsx("textarea",{value:r.remediation||"",onChange:s=>c({...r,remediation:s.target.value}),rows:3,className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Steps to fix this vulnerability..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Testing Steps"}),e.jsx("textarea",{value:r.testing_steps||"",onChange:s=>c({...r,testing_steps:s.target.value}),rows:3,className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Step-by-step testing methodology..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"CVSS Vector"}),e.jsx("input",{type:"text",value:r.cvss_vector||"",onChange:s=>c({...r,cvss_vector:s.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"CVSS:3.1/AV:N/AC:L/..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"CVSS Score"}),e.jsx("input",{type:"number",min:"0",max:"10",step:"0.1",value:r.cvss_score||"",onChange:s=>c({...r,cvss_score:parseFloat(s.target.value)||void 0}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"0.0 - 10.0"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{onClick:()=>{y(!1),c(null)},className:"px-4 py-2 text-gray-400 hover:text-white",children:"Cancel"}),e.jsxs("button",{onClick:le,disabled:A,className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-500 disabled:opacity-50",children:[e.jsx(je,{className:"h-4 w-4"}),w?"Update Template":"Create Template"]})]})]})]})}),ee&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 w-full max-w-md p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Import Templates"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Upload a JSON file containing finding templates to import."}),e.jsx("input",{type:"file",accept:".json",onChange:ne,className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500"}),e.jsx("div",{className:"flex justify-end gap-3 mt-4",children:e.jsx("button",{onClick:()=>N(!1),className:"px-4 py-2 text-gray-400 hover:text-white",children:"Cancel"})})]})})]})})};export{_e as default};
