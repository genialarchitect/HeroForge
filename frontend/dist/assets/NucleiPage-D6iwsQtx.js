import{b as $,u as T,d as F,j as e}from"./vendor-state-DdX3IZQk.js";import{r as u}from"./vendor-react-Da1CiaFS.js";import{Z as q,aD as P,ac as A,aR as w,aQ as E,aF as I,B as j,b_ as M,aN as R,j as B,ae as H,at as z,aG as D,aH as O,n as Z,ar as G}from"./vendor-ui-B6SJ_7kK.js";import{d as K,b as L,a5 as g}from"./index-CEs23Zco.js";import"./vendor-charts-gFVtv0RJ.js";const Q=a=>{switch(a.toLowerCase()){case"completed":return e.jsx(O,{className:"w-4 h-4 text-green-400"});case"failed":return e.jsx(D,{className:"w-4 h-4 text-red-400"});case"running":return e.jsx(w,{className:"w-4 h-4 text-cyan-400 animate-spin"});case"cancelled":return e.jsx(M,{className:"w-4 h-4 text-orange-400"});default:return e.jsx(z,{className:"w-4 h-4 text-yellow-400"})}},k=a=>{switch(a.toLowerCase()){case"critical":return"bg-red-500/20 text-red-400 border-red-500/30";case"high":return"bg-orange-500/20 text-orange-400 border-orange-500/30";case"medium":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"low":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"info":return"bg-gray-500/20 text-gray-400 border-gray-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},y={getStatus:()=>g.get("/api/nuclei/status"),listScans:()=>g.get("/api/nuclei/scans"),getScan:a=>g.get(`/api/nuclei/scans/${a}`),createScan:a=>g.post("/api/nuclei/scans",a),deleteScan:a=>g.delete(`/api/nuclei/scans/${a}`),cancelScan:a=>g.post(`/api/nuclei/scans/${a}/cancel`),listTemplates:a=>g.get("/api/nuclei/templates",{params:a}),getTemplateStats:()=>g.get("/api/nuclei/templates/stats"),updateTemplates:()=>g.post("/api/nuclei/templates/update"),listTags:()=>g.get("/api/nuclei/templates/tags")};function U({onScanCreated:a}){const[b,r]=u.useState(""),[h,p]=u.useState(""),[x,i]=u.useState([]),[d,S]=u.useState(["critical","high","medium"]),[o,n]=u.useState(150),[m,l]=u.useState(!1),C=$(),N=F({mutationFn:y.createScan,onSuccess:s=>{j.success("Nuclei scan started"),a(s.data.id),C.invalidateQueries({queryKey:["nuclei-scans"]}),r(""),p("")},onError:s=>{var f,_;j.error(((_=(f=s.response)==null?void 0:f.data)==null?void 0:_.error)||"Failed to start scan")}}),c=s=>{s.preventDefault();const f=b.split(`
`).map(_=>_.trim()).filter(_=>_);if(f.length===0){j.error("Please enter at least one target");return}N.mutate({name:h||void 0,targets:f,template_tags:x,severity:d,rate_limit:o})},t=["cve","rce","sqli","xss","lfi","ssrf","misconfig","exposure","auth-bypass"],v=["critical","high","medium","low","info"];return e.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 text-cyan-400"}),"New Nuclei Scan"]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Scan Name (optional)"}),e.jsx("input",{type:"text",value:h,onChange:s=>p(s.target.value),placeholder:"My Nuclei Scan",className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Targets (one per line)"}),e.jsx("textarea",{value:b,onChange:s=>r(s.target.value),placeholder:`https://example.com
192.168.1.1
example.org`,rows:4,className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Severity Filter"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:v.map(s=>e.jsx("button",{type:"button",onClick:()=>{S(d.includes(s)?d.filter(f=>f!==s):[...d,s])},className:`px-3 py-1.5 rounded-lg text-sm font-medium border transition-colors ${d.includes(s)?k(s):"bg-slate-700 text-slate-400 border-slate-600 hover:border-slate-500"}`,children:s},s))})]}),e.jsxs("button",{type:"button",onClick:()=>l(!m),className:"text-sm text-cyan-400 hover:text-cyan-300 flex items-center gap-1",children:[e.jsx(B,{className:"w-4 h-4"}),m?"Hide":"Show"," Advanced Options"]}),m&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Template Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(s=>e.jsx("button",{type:"button",onClick:()=>{i(x.includes(s)?x.filter(f=>f!==s):[...x,s])},className:`px-2 py-1 rounded text-xs font-medium transition-colors ${x.includes(s)?"bg-cyan-500/20 text-cyan-400 border border-cyan-500/30":"bg-slate-700 text-slate-400 border border-slate-600 hover:border-slate-500"}`,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Rate Limit (req/s)"}),e.jsx("input",{type:"number",value:o,onChange:s=>n(parseInt(s.target.value)||150),min:1,max:1e3,className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500"})]})]}),e.jsx(L,{type:"submit",disabled:N.isPending,className:"w-full",children:N.isPending?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-4 h-4 animate-spin mr-2"}),"Starting Scan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Start Scan"]})})]})]})}function X({scanId:a,onBack:b}){var d,S,o;const{data:r,isLoading:h,refetch:p}=T({queryKey:["nuclei-scan",a],queryFn:()=>y.getScan(a),refetchInterval:n=>{var l;const m=(l=n.state.data)==null?void 0:l.data;return(m==null?void 0:m.status)==="running"?3e3:!1}}),x=F({mutationFn:()=>y.cancelScan(a),onSuccess:()=>{j.success("Scan cancelled"),p()},onError:()=>j.error("Failed to cancel scan")});if(h)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(w,{className:"w-8 h-8 text-cyan-400 animate-spin"})});const i=r==null?void 0:r.data;return i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:b,className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(I,{className:"w-5 h-5 text-slate-400 rotate-180"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:i.name||"Nuclei Scan"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[Q(i.status),e.jsx("span",{className:"capitalize",children:i.status}),e.jsx("span",{children:"|"}),e.jsxs("span",{children:[((d=i.targets)==null?void 0:d.length)||0," target(s)"]}),e.jsx("span",{children:"|"}),e.jsxs("span",{children:[i.results_count," result(s)"]})]})]})]}),i.status==="running"&&e.jsxs(L,{variant:"danger",onClick:()=>x.mutate(),disabled:x.isPending,children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Cancel Scan"]})]}),e.jsx("div",{className:"grid grid-cols-5 gap-4",children:[{label:"Critical",count:i.critical_count,color:"bg-red-500"},{label:"High",count:i.high_count,color:"bg-orange-500"},{label:"Medium",count:i.medium_count,color:"bg-yellow-500"},{label:"Low",count:i.low_count,color:"bg-blue-500"},{label:"Info",count:i.info_count,color:"bg-slate-500"}].map(n=>e.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${n.color} mb-2`}),e.jsx("div",{className:"text-2xl font-bold text-white",children:n.count}),e.jsx("div",{className:"text-sm text-slate-400",children:n.label})]},n.label))}),e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700",children:[e.jsx("div",{className:"p-4 border-b border-slate-700",children:e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Findings"})}),e.jsx("div",{className:"divide-y divide-slate-700",children:((S=i.results)==null?void 0:S.length)===0?e.jsx("div",{className:"p-8 text-center text-slate-400",children:i.status==="running"?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(w,{className:"w-8 h-8 animate-spin text-cyan-400"}),e.jsx("span",{children:"Scanning in progress..."})]}):e.jsx("span",{children:"No vulnerabilities found"})}):(o=i.results)==null?void 0:o.map(n=>e.jsx("div",{className:"p-4 hover:bg-slate-700/50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium border ${k(n.severity)}`,children:n.severity}),e.jsx("span",{className:"text-white font-medium",children:n.template_name}),n.cve_id&&e.jsx("span",{className:"text-xs text-cyan-400 font-mono",children:n.cve_id})]}),e.jsx("div",{className:"text-sm text-slate-400 font-mono truncate",children:n.matched_at||n.host}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-slate-500",children:[e.jsx("span",{children:n.template_id}),e.jsx("span",{children:"|"}),e.jsx("span",{children:n.check_type})]})]}),n.curl_command&&e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(n.curl_command),j.success("Curl command copied to clipboard")},className:"p-2 hover:bg-slate-600 rounded-lg transition-colors",title:"Copy curl command",children:e.jsx(R,{className:"w-4 h-4 text-slate-400"})})]})},n.id))})]})]}):null}function J(){var N,c;const[a,b]=u.useState(""),[r,h]=u.useState([]),[p,x]=u.useState([]),i=$(),{data:d,isLoading:S}=T({queryKey:["nuclei-template-stats"],queryFn:()=>y.getTemplateStats()}),{data:o,isLoading:n}=T({queryKey:["nuclei-templates",a,r,p],queryFn:()=>y.listTemplates({query:a||void 0,tags:r.length>0?r.join(","):void 0,severity:p.length>0?p.join(","):void 0,limit:50})}),m=F({mutationFn:y.updateTemplates,onSuccess:()=>{j.success("Templates updated successfully"),i.invalidateQueries({queryKey:["nuclei-template-stats"]}),i.invalidateQueries({queryKey:["nuclei-templates"]})},onError:t=>{var v,s;j.error(((s=(v=t.response)==null?void 0:v.data)==null?void 0:s.error)||"Failed to update templates")}}),l=d==null?void 0:d.data,C=((N=o==null?void 0:o.data)==null?void 0:N.templates)||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:(l==null?void 0:l.total)||0}),e.jsx("div",{className:"text-sm text-slate-400",children:"Total Templates"})]}),["critical","high","medium","low","info"].map(t=>e.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:(l==null?void 0:l[t])||0}),e.jsx("div",{className:`text-sm capitalize ${k(t).split(" ")[1]}`,children:t})]},t))]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"text",value:a,onChange:t=>b(t.target.value),placeholder:"Search templates...",className:"w-full pl-10 pr-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs(L,{onClick:()=>m.mutate(),disabled:m.isPending,variant:"secondary",children:[m.isPending?e.jsx(w,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(R,{className:"w-4 h-4 mr-2"}),"Update Templates"]})]}),(l==null?void 0:l.tags)&&l.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:l.tags.slice(0,15).map(([t,v])=>e.jsxs("button",{onClick:()=>{h(r.includes(t)?r.filter(s=>s!==t):[...r,t])},className:`px-2 py-1 rounded text-xs font-medium transition-colors flex items-center gap-1 ${r.includes(t)?"bg-cyan-500/20 text-cyan-400 border border-cyan-500/30":"bg-slate-700 text-slate-400 border border-slate-600 hover:border-slate-500"}`,children:[e.jsx(G,{className:"w-3 h-3"}),t,e.jsxs("span",{className:"text-slate-500",children:["(",v,")"]})]},t))}),e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Templates"}),e.jsxs("span",{className:"text-sm text-slate-400",children:[((c=o==null?void 0:o.data)==null?void 0:c.total)||0," templates found"]})]}),e.jsx("div",{className:"divide-y divide-slate-700 max-h-[500px] overflow-y-auto",children:n?e.jsx("div",{className:"p-8 text-center",children:e.jsx(w,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto"})}):C.length===0?e.jsx("div",{className:"p-8 text-center text-slate-400",children:"No templates found"}):C.map(t=>e.jsx("div",{className:"p-4 hover:bg-slate-700/50 transition-colors",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium border ${k(t.severity)}`,children:t.severity}),e.jsx("span",{className:"text-white font-medium",children:t.name}),t.cve_id&&e.jsx("span",{className:"text-xs text-cyan-400 font-mono",children:t.cve_id})]}),e.jsx("div",{className:"text-sm text-slate-500 font-mono",children:t.id}),t.description&&e.jsx("div",{className:"text-sm text-slate-400 mt-1 line-clamp-2",children:t.description}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:t.tags.slice(0,5).map(v=>e.jsx("span",{className:"px-1.5 py-0.5 bg-slate-700 text-slate-400 rounded text-xs",children:v},v))})]})})},t.id))})]})]})}function te(){var N;const[a,b]=u.useState("scans"),[r,h]=u.useState(null),p=$(),{data:x,isLoading:i}=T({queryKey:["nuclei-status"],queryFn:()=>y.getStatus()}),{data:d,isLoading:S,refetch:o}=T({queryKey:["nuclei-scans"],queryFn:()=>y.listScans()}),n=F({mutationFn:y.deleteScan,onSuccess:()=>{j.success("Scan deleted"),p.invalidateQueries({queryKey:["nuclei-scans"]})},onError:()=>j.error("Failed to delete scan")}),m=c=>{o(),h(c)},l=x==null?void 0:x.data,C=((N=d==null?void 0:d.data)==null?void 0:N.scans)||[];return r?e.jsx(K,{children:e.jsx(X,{scanId:r,onBack:()=>h(null)})}):e.jsxs(K,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[e.jsx(q,{className:"w-7 h-7 text-cyan-400"}),"Nuclei Scanner"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:"Fast vulnerability scanner using Nuclei templates"})]}),l&&!l.installed&&e.jsxs("div",{className:"mb-6 bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(P,{className:"w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-yellow-400",children:"Nuclei Not Installed"}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:["Install Nuclei to use this feature:",e.jsx("code",{className:"ml-2 px-2 py-0.5 bg-slate-700 rounded text-xs",children:"go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest"})]})]})]}),l&&l.installed&&!l.templates_available&&e.jsxs("div",{className:"mb-6 bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(P,{className:"w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-yellow-400",children:"Templates Not Found"}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:["Download templates by running:",e.jsx("code",{className:"ml-2 px-2 py-0.5 bg-slate-700 rounded text-xs",children:"nuclei -ut"})]})]})]}),(l==null?void 0:l.installed)&&e.jsxs("div",{className:"mb-6 flex items-center gap-4 text-sm text-slate-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsxs("span",{children:["Nuclei ",l.version]})]}),e.jsxs("div",{children:["Templates: ",l.templates_path]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-6 border-b border-slate-700",children:[e.jsx("button",{onClick:()=>b("scans"),className:`pb-3 px-1 border-b-2 transition-colors ${a==="scans"?"border-cyan-500 text-cyan-400":"border-transparent text-slate-400 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:"Scans"})]})}),e.jsx("button",{onClick:()=>b("templates"),className:`pb-3 px-1 border-b-2 transition-colors ${a==="templates"?"border-cyan-500 text-cyan-400":"border-transparent text-slate-400 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{children:"Templates"})]})})]}),a==="scans"?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(U,{onScanCreated:m})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Recent Scans"}),e.jsx(L,{variant:"secondary",size:"sm",onClick:()=>o(),children:e.jsx(w,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"divide-y divide-slate-700",children:S?e.jsx("div",{className:"p-8 text-center",children:e.jsx(w,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto"})}):C.length===0?e.jsx("div",{className:"p-8 text-center text-slate-400",children:"No scans yet. Start your first Nuclei scan!"}):C.map(c=>e.jsx("div",{className:"p-4 hover:bg-slate-700/50 transition-colors cursor-pointer",onClick:()=>h(c.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[Q(c.status),e.jsx("span",{className:"text-white font-medium",children:c.name||"Nuclei Scan"}),e.jsxs("span",{className:"text-sm text-slate-500",children:["(",c.targets_count," target",c.targets_count!==1?"s":"",")"]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-slate-500",children:[e.jsx("span",{children:new Date(c.created_at).toLocaleString()}),c.results_count>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"|"}),e.jsxs("span",{className:"flex items-center gap-1",children:[c.critical_count>0&&e.jsxs("span",{className:"text-red-400",children:[c.critical_count,"C"]}),c.high_count>0&&e.jsxs("span",{className:"text-orange-400",children:[c.high_count,"H"]}),c.medium_count>0&&e.jsxs("span",{className:"text-yellow-400",children:[c.medium_count,"M"]}),c.low_count>0&&e.jsxs("span",{className:"text-blue-400",children:[c.low_count,"L"]})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),confirm("Delete this scan?")&&n.mutate(c.id)},className:"p-2 hover:bg-slate-600 rounded-lg transition-colors",children:e.jsx(E,{className:"w-4 h-4 text-slate-400 hover:text-red-400"})}),e.jsx(I,{className:"w-5 h-5 text-slate-400"})]})]})},c.id))})]})})]}):e.jsx(J,{})]})}export{te as default};
