import{j as e}from"./vendor-state-BeiY7NuG.js";import{r as c}from"./vendor-react-B7quoyFx.js";import{d as ne,C as N,L as R,I as D,B as b,a as B,b as V,t as te,s as ee,f as He,n as K,e as Ie,g as Ve,u as ze,h as re,m as le,i as me,j as se,k as W,c as Ge}from"./index-DGfn9VKX.js";import{B as r,U as ue,S as G,a7 as ye,am as pe,k as ae,a as ve,q,g as Be,s as Ee,u as Fe,an as Ye,ao as We,P as X,ap as Qe,m as Q,T as Ne,af as $,X as de,F as Xe,ak as oe,aq as Ze,ar as es,as as Te,at as xe,w as O,au as ss,av as ge,A as ts,aw as Y,M as ce,N as _e,d as je,J as be,H as as,R as rs,j as ls,ax as ns,x as fe,ay as ke,D as cs,K as ie,f as Re,y as Le,a5 as Me,az as Se,aA as is,aB as Ce}from"./vendor-ui-uQETzrHq.js";import"./vendor-charts-CTMN5Tqk.js";const ds=()=>{var a;const[i,I]=c.useState(null),[F,x]=c.useState(!0),[j,_]=c.useState(!1),[y,C]=c.useState(!1),[m,v]=c.useState(""),[d,f]=c.useState(!1),[w,E]=c.useState(""),[h,P]=c.useState(""),[p,g]=c.useState("");c.useEffect(()=>{A()},[]);const A=async()=>{x(!0);try{const s=await ne.me();I(s.data),v(s.data.email||"")}catch(s){r.error("Failed to load profile"),console.error(s)}finally{x(!1)}},l=async s=>{var u,t;if(s.preventDefault(),!m.trim()){r.error("Email is required");return}_(!0);try{const o=await ne.updateProfile({email:m.trim()});I(o.data),r.success("Profile updated successfully")}catch(o){r.error(((t=(u=o.response)==null?void 0:u.data)==null?void 0:t.error)||"Failed to update profile")}finally{_(!1)}},k=async s=>{var u,t;if(s.preventDefault(),!w||!h){r.error("All password fields are required");return}if(h.length<6){r.error("New password must be at least 6 characters");return}if(h!==p){r.error("Passwords do not match");return}C(!0);try{await ne.changePassword({current_password:w,new_password:h}),r.success("Password changed successfully"),f(!1),E(""),P(""),g("")}catch(o){r.error(((t=(u=o.response)==null?void 0:u.data)==null?void 0:t.error)||"Failed to change password")}finally{C(!1)}},n=s=>s?new Date(s).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"N/A";return F?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ue,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Profile Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(ue,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Username"}),e.jsx("p",{className:"text-white font-medium",children:i==null?void 0:i.username})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(G,{className:"h-5 w-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Roles"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:((a=i==null?void 0:i.roles)==null?void 0:a.map(s=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-primary/20 text-primary rounded capitalize",children:s},s)))||e.jsx("span",{className:"text-slate-400",children:"No roles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(ye,{className:"h-5 w-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Member Since"}),e.jsx("p",{className:"text-white",children:n(i==null?void 0:i.created_at)})]})]})]}),e.jsx("form",{onSubmit:l,className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"Email Address"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(D,{type:"email",value:m,onChange:s=>v(s.target.value),placeholder:"your@email.com",className:"flex-1"}),e.jsxs(b,{type:"submit",variant:"primary",loading:j,disabled:j||m===(i==null?void 0:i.email),children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Save"]})]})]})})]}),e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{className:"h-6 w-6 text-yellow-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Security"})]}),!d&&e.jsx(b,{variant:"secondary",onClick:()=>f(!0),children:"Change Password"})]}),d?e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsx(D,{label:"Current Password",type:"password",value:w,onChange:s=>E(s.target.value),placeholder:"Enter current password"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(D,{label:"New Password",type:"password",value:h,onChange:s=>P(s.target.value),placeholder:"Enter new password"}),e.jsx(D,{label:"Confirm New Password",type:"password",value:p,onChange:s=>g(s.target.value),placeholder:"Confirm new password"})]}),h&&p&&h!==p&&e.jsx("p",{className:"text-sm text-red-400",children:"Passwords do not match"}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(b,{type:"button",variant:"secondary",onClick:()=>{f(!1),E(""),P(""),g("")},children:"Cancel"}),e.jsx(b,{type:"submit",variant:"primary",loading:y,disabled:y||!w||!h||h!==p,children:"Update Password"})]})]}):e.jsx("p",{className:"text-slate-400",children:"Keep your account secure by using a strong, unique password."})]}),e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(G,{className:"h-6 w-6 text-green-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Account Status"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${(i==null?void 0:i.is_active)!==!1?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-white",children:(i==null?void 0:i.is_active)!==!1?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Your account is in good standing."})]})]})},os=[{id:"admin",name:"Admin",description:"Full system access"},{id:"user",name:"User",description:"Standard user access"},{id:"auditor",name:"Auditor",description:"Read-only access to all scans"},{id:"viewer",name:"Viewer",description:"Limited view access"}],ms=()=>{const[i,I]=c.useState([]),[F,x]=c.useState([]),[j,_]=c.useState(!0),[y,C]=c.useState(!1),[m,v]=c.useState(new Set),[d,f]=c.useState(!1),[w,E]=c.useState(!0);c.useEffect(()=>{h()},[]);const h=async()=>{var s;_(!0);try{const u=await B.getUsers();I(u.data),E(!0)}catch(u){((s=u.response)==null?void 0:s.status)===403?E(!1):r.error("Failed to load users"),console.error(u)}finally{_(!1)}},P=async()=>{C(!0);try{const s=await B.getAuditLogs(50);x(s.data)}catch(s){r.error("Failed to load audit logs"),console.error(s)}finally{C(!1)}},p=s=>{const u=new Set(m);u.has(s)?u.delete(s):u.add(s),v(u)},g=async s=>{var u,t;try{await B.updateUser(s.id,{is_active:!s.is_active}),r.success(`User ${s.is_active?"deactivated":"activated"}`),h()}catch(o){r.error(((t=(u=o.response)==null?void 0:u.data)==null?void 0:t.error)||"Failed to update user")}},A=async s=>{var u,t;if(confirm(`Are you sure you want to delete user "${s.username}"? This cannot be undone.`))try{await B.deleteUser(s.id),r.success("User deleted"),h()}catch(o){r.error(((t=(u=o.response)==null?void 0:u.data)==null?void 0:t.error)||"Failed to delete user")}},l=async(s,u)=>{var t,o;try{await B.assignRole(s,u),r.success("Role assigned"),h()}catch(S){r.error(((o=(t=S.response)==null?void 0:t.data)==null?void 0:o.error)||"Failed to assign role")}},k=async(s,u)=>{var t,o;try{await B.removeRole(s,u),r.success("Role removed"),h()}catch(S){r.error(((o=(t=S.response)==null?void 0:t.data)==null?void 0:o.error)||"Failed to remove role")}},n=s=>new Date(s).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),a=s=>{switch(s){case"admin":return"bg-red-500/20 text-red-400 border-red-500/30";case"user":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"auditor":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"viewer":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return j?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):w?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Be,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"User Management"})]}),e.jsxs(V,{variant:"status",type:"completed",children:[i.length," users"]})]}),e.jsx("div",{className:"space-y-3",children:i.map(s=>{const u=m.has(s.id),t=s.roles||[];return e.jsxs("div",{className:"bg-dark-bg rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>p(s.id),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"text-slate-400",children:u?e.jsx(Ee,{className:"h-4 w-4"}):e.jsx(Fe,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${s.is_active!==!1?"bg-green-400":"bg-red-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:s.username}),e.jsx("p",{className:"text-sm text-slate-400",children:s.email})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex gap-1",children:t.map(o=>e.jsx("span",{className:`px-2 py-0.5 text-xs rounded border capitalize ${a(o)}`,children:o},o))}),e.jsx("span",{className:"text-xs text-slate-500",children:s.created_at?n(s.created_at):"N/A"})]})]}),u&&e.jsxs("div",{className:"border-t border-dark-border p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),"Manage Roles"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:os.map(o=>{const S=t.includes(o.id);return e.jsxs("button",{onClick:U=>{U.stopPropagation(),S?k(s.id,o.id):l(s.id,o.id)},className:`p-3 rounded-lg border text-left transition-colors ${S?"bg-primary/20 border-primary/50 text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-primary/30"}`,children:[e.jsx("p",{className:"font-medium text-sm capitalize",children:o.name}),e.jsx("p",{className:"text-xs opacity-75",children:o.description})]},o.id)})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-dark-border",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx(b,{variant:s.is_active!==!1?"secondary":"primary",size:"sm",onClick:o=>{o.stopPropagation(),g(s)},children:s.is_active!==!1?e.jsxs(e.Fragment,{children:[e.jsx(Ye,{className:"h-4 w-4 mr-1"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"h-4 w-4 mr-1"}),"Activate"]})})}),e.jsxs(b,{variant:"secondary",size:"sm",onClick:o=>{o.stopPropagation(),A(s)},className:"text-red-400 hover:text-red-300 hover:bg-red-500/10",children:[e.jsx(X,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})]},s.id)})})]}),e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qe,{className:"h-6 w-6 text-purple-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Audit Logs"})]}),e.jsx(b,{variant:"secondary",onClick:()=>{f(!d),!d&&F.length===0&&P()},children:d?"Hide Logs":"Show Logs"})]}),d&&e.jsx(e.Fragment,{children:y?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(R,{})}):F.length===0?e.jsx("p",{className:"text-slate-400 text-center py-8",children:"No audit logs found"}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:F.map(s=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-dark-bg rounded-lg text-sm",children:[e.jsx(Q,{className:"h-4 w-4 text-slate-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium text-white",children:s.action}),s.target_type&&e.jsxs("span",{className:"text-slate-400",children:["on ",s.target_type]}),s.target_id&&e.jsx("span",{className:"text-xs text-slate-500 font-mono truncate max-w-32",children:s.target_id})]}),s.details&&e.jsx("p",{className:"text-xs text-slate-500 mt-1 truncate",children:s.details})]}),e.jsx("span",{className:"text-xs text-slate-500 whitespace-nowrap",children:n(s.created_at)})]},s.id))})}),!d&&e.jsx("p",{className:"text-slate-400",children:"View a log of administrative actions performed in the system."})]})]}):e.jsx(N,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(q,{className:"h-12 w-12 text-yellow-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-slate-400",children:"You don't have permission to access the administration panel."}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Contact an administrator if you need elevated access."})]})})},he=["#ef4444","#f97316","#eab308","#22c55e","#14b8a6","#3b82f6","#8b5cf6","#ec4899","#6366f1","#64748b"],xs=()=>{const[i,I]=c.useState([]),[F,x]=c.useState(!0),[j,_]=c.useState(!1),[y,C]=c.useState(null),[m,v]=c.useState({name:"",description:"",targets:"",color:he[0]});c.useEffect(()=>{d()},[]);const d=async()=>{x(!0);try{const p=await te.getAll();I(p.data)}catch(p){r.error("Failed to load target groups"),console.error(p)}finally{x(!1)}},f=()=>{v({name:"",description:"",targets:"",color:he[0]}),C(null),_(!1)},w=p=>{const g=JSON.parse(p.targets||"[]");v({name:p.name,description:p.description||"",targets:g.join(`
`),color:p.color}),C(p.id),_(!0)},E=async p=>{var A,l;p.preventDefault();const g=m.targets.split(`
`).map(k=>k.trim()).filter(k=>k.length>0);if(!m.name.trim()){r.error("Name is required");return}if(g.length===0){r.error("At least one target is required");return}try{y?(await te.update(y,{name:m.name,description:m.description||void 0,targets:g,color:m.color}),r.success("Target group updated")):(await te.create({name:m.name,description:m.description||void 0,targets:g,color:m.color}),r.success("Target group created")),f(),d()}catch(k){r.error(((l=(A=k.response)==null?void 0:A.data)==null?void 0:l.error)||"Failed to save target group")}},h=async(p,g)=>{var A,l;if(confirm(`Delete target group "${g}"?`))try{await te.delete(p),r.success("Target group deleted"),d()}catch(k){r.error(((l=(A=k.response)==null?void 0:A.data)==null?void 0:l.error)||"Failed to delete")}},P=p=>{try{return JSON.parse(p||"[]")}catch{return[]}};return F?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Target Groups"})]}),!j&&e.jsxs(b,{variant:"primary",onClick:()=>_(!0),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"New Group"]})]})}),j&&e.jsx(N,{children:e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:y?"Edit Target Group":"Create Target Group"}),e.jsx("button",{type:"button",onClick:f,className:"text-slate-400 hover:text-white",children:e.jsx(de,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:m.name,onChange:p=>v({...m,name:p.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Production Servers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Color"}),e.jsx("div",{className:"flex gap-2",children:he.map(p=>e.jsx("button",{type:"button",onClick:()=>v({...m,color:p}),className:`w-8 h-8 rounded-full border-2 transition-all ${m.color===p?"border-white scale-110":"border-transparent"}`,style:{backgroundColor:p}},p))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:m.description,onChange:p=>v({...m,description:p.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Targets (one per line)"}),e.jsx("textarea",{value:m.targets,onChange:p=>v({...m,targets:p.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:5,placeholder:`192.168.1.0/24
10.0.0.1
example.com`})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{type:"button",variant:"secondary",onClick:f,children:"Cancel"}),e.jsxs(b,{type:"submit",variant:"primary",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),y?"Update":"Create"]})]})]})}),i.length===0&&!j?e.jsx(N,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Xe,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No target groups yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create groups to organize your scan targets"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(p=>{const g=P(p.targets);return e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:p.color}}),e.jsx("h4",{className:"font-medium text-white",children:p.name})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>w(p),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",children:e.jsx(oe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>h(p.id,p.name),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",children:e.jsx(X,{className:"h-4 w-4"})})]})]}),p.description&&e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:p.description}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:[g.length," target",g.length!==1?"s":""]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[g.slice(0,5).map((A,l)=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-300 font-mono",children:A},l)),g.length>5&&e.jsxs("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-500",children:["+",g.length-5," more"]})]})]})]},p.id)})})]})},Ae={name:"",description:"",schedule_type:"daily",schedule_value:"02:00",targets:"",port_range_start:1,port_range_end:1e3,threads:100,enable_os_detection:!0,enable_service_detection:!0,enable_vuln_scan:!0,enable_enumeration:!1},Pe=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],hs=()=>{const[i,I]=c.useState([]),[F,x]=c.useState([]),[j,_]=c.useState(!0),[y,C]=c.useState(!1),[m,v]=c.useState(null),[d,f]=c.useState(Ae),[w,E]=c.useState(0),[h,P]=c.useState(1);c.useEffect(()=>{p()},[]);const p=async()=>{_(!0);try{const[t,o]=await Promise.all([ee.getAll(),te.getAll()]);I(t.data),x(o.data)}catch(t){r.error("Failed to load scheduled scans"),console.error(t)}finally{_(!1)}},g=()=>{f(Ae),v(null),C(!1),E(0),P(1)},A=t=>{const o=JSON.parse(t.config);if(f({name:t.name,description:t.description||"",schedule_type:t.schedule_type,schedule_value:t.schedule_value,targets:o.targets.join(`
`),port_range_start:o.port_range[0],port_range_end:o.port_range[1],threads:o.threads,enable_os_detection:o.enable_os_detection,enable_service_detection:o.enable_service_detection,enable_vuln_scan:o.enable_vuln_scan,enable_enumeration:o.enable_enumeration}),t.schedule_type==="weekly"){const S=t.schedule_value.split(" ");S.length>=2&&E(parseInt(S[1])||0)}else if(t.schedule_type==="monthly"){const S=t.schedule_value.split(" ");S.length>=2&&P(parseInt(S[1])||1)}v(t.id),C(!0)},l=()=>{const t=d.schedule_value.includes(":")?d.schedule_value:"02:00";switch(d.schedule_type){case"daily":return t;case"weekly":return`${t} ${w}`;case"monthly":return`${t} ${h}`;default:return t}},k=async t=>{var J,Z;t.preventDefault();const o=d.targets.split(`
`).map(H=>H.trim()).filter(H=>H.length>0);if(!d.name.trim()){r.error("Name is required");return}if(o.length===0){r.error("At least one target is required");return}const S={targets:o,port_range:[d.port_range_start,d.port_range_end],threads:d.threads,enable_os_detection:d.enable_os_detection,enable_service_detection:d.enable_service_detection,enable_vuln_scan:d.enable_vuln_scan,enable_enumeration:d.enable_enumeration},U=l();try{m?(await ee.update(m,{name:d.name,description:d.description||void 0,config:S,schedule_type:d.schedule_type,schedule_value:U}),r.success("Scheduled scan updated")):(await ee.create({name:d.name,description:d.description||void 0,config:S,schedule_type:d.schedule_type,schedule_value:U}),r.success("Scheduled scan created")),g(),p()}catch(H){r.error(((Z=(J=H.response)==null?void 0:J.data)==null?void 0:Z.error)||"Failed to save scheduled scan")}},n=async t=>{var o,S;try{await ee.update(t.id,{is_active:!t.is_active}),r.success(`Scheduled scan ${t.is_active?"paused":"activated"}`),p()}catch(U){r.error(((S=(o=U.response)==null?void 0:o.data)==null?void 0:S.error)||"Failed to update")}},a=async(t,o)=>{var S,U;if(confirm(`Delete scheduled scan "${o}"?`))try{await ee.delete(t),r.success("Scheduled scan deleted"),p()}catch(J){r.error(((U=(S=J.response)==null?void 0:S.data)==null?void 0:U.error)||"Failed to delete")}},s=t=>{const o=JSON.parse(t.targets||"[]");f(S=>({...S,targets:o.join(`
`)}))},u=t=>{const o=t.schedule_value.split(" "),S=o[0];switch(t.schedule_type){case"daily":return`Daily at ${S}`;case"weekly":return`Every ${Pe[parseInt(o[1])||0]} at ${S}`;case"monthly":return`Monthly on day ${o[1]||1} at ${S}`;default:return t.schedule_value}};return j?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scheduled Scans"})]}),!y&&e.jsxs(b,{variant:"primary",onClick:()=>C(!0),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"New Schedule"]})]})}),y&&e.jsx(N,{children:e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:m?"Edit Scheduled Scan":"Create Scheduled Scan"}),e.jsx("button",{type:"button",onClick:g,className:"text-slate-400 hover:text-white",children:e.jsx(de,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:d.name,onChange:t=>f({...d,name:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Daily Network Scan"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:d.description,onChange:t=>f({...d,description:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4"})," Schedule"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Frequency"}),e.jsxs("select",{value:d.schedule_type,onChange:t=>f({...d,schedule_type:t.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),d.schedule_type==="weekly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Week"}),e.jsx("select",{value:w,onChange:t=>E(parseInt(t.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Pe.map((t,o)=>e.jsx("option",{value:o,children:t},t))})]}),d.schedule_type==="monthly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Month"}),e.jsx("select",{value:h,onChange:t=>P(parseInt(t.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Array.from({length:28},(t,o)=>o+1).map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Time (UTC)"}),e.jsx("input",{type:"time",value:d.schedule_value.split(" ")[0],onChange:t=>f({...d,schedule_value:t.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Targets (one per line)"}),F.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Use group:"}),F.slice(0,3).map(t=>e.jsx("button",{type:"button",onClick:()=>s(t),className:"px-2 py-0.5 text-xs rounded border border-dark-border text-slate-400 hover:text-white hover:border-primary",style:{borderLeftColor:t.color,borderLeftWidth:3},children:t.name},t.id))]})]}),e.jsx("textarea",{value:d.targets,onChange:t=>f({...d,targets:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:4,placeholder:`192.168.1.0/24
10.0.0.1`})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port Start"}),e.jsx("input",{type:"number",value:d.port_range_start,onChange:t=>f({...d,port_range_start:parseInt(t.target.value)||1}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port End"}),e.jsx("input",{type:"number",value:d.port_range_end,onChange:t=>f({...d,port_range_end:parseInt(t.target.value)||1e3}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Threads"}),e.jsx("input",{type:"number",value:d.threads,onChange:t=>f({...d,threads:parseInt(t.target.value)||100}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:1e3})]})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:[{key:"enable_os_detection",label:"OS Detection"},{key:"enable_service_detection",label:"Service Detection"},{key:"enable_vuln_scan",label:"Vulnerability Scan"},{key:"enable_enumeration",label:"Enumeration"}].map(({key:t,label:o})=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d[t],onChange:S=>f({...d,[t]:S.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-slate-300",children:o})]},t))}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{type:"button",variant:"secondary",onClick:g,children:"Cancel"}),e.jsxs(b,{type:"submit",variant:"primary",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),m?"Update":"Create"]})]})]})}),i.length===0&&!y?e.jsx(N,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Q,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scheduled scans"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create automated recurring scans"})]})}):e.jsx("div",{className:"space-y-3",children:i.map(t=>{const o=JSON.parse(t.config);return e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${t.is_active?"bg-green-500/20":"bg-slate-500/20"}`,children:e.jsx(Q,{className:`h-5 w-5 ${t.is_active?"text-green-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-white",children:t.name}),e.jsx(V,{variant:"status",type:t.is_active?"completed":"pending",children:t.is_active?"Active":"Paused"})]}),e.jsx("p",{className:"text-sm text-slate-400",children:u(t)}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[o.targets.length," target",o.targets.length!==1?"s":""," | Ports ",o.port_range[0],"-",o.port_range[1]," |",t.run_count," runs",t.last_run_at&&e.jsxs(e.Fragment,{children:[" | Last run ",He(new Date(t.last_run_at))," ago"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>n(t),className:`p-2 rounded transition-colors ${t.is_active?"text-yellow-400 hover:bg-yellow-500/20":"text-green-400 hover:bg-green-500/20"}`,title:t.is_active?"Pause":"Activate",children:t.is_active?e.jsx(Ze,{className:"h-4 w-4"}):e.jsx(es,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>A(t),className:"p-2 text-slate-400 hover:text-primary transition-colors",children:e.jsx(oe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>a(t.id,t.name),className:"p-2 text-slate-400 hover:text-red-400 transition-colors",children:e.jsx(X,{className:"h-4 w-4"})})]})]})},t.id)})})]})},us=()=>{const[i,I]=c.useState(null),[F,x]=c.useState(!0),[j,_]=c.useState(!1),[y,C]=c.useState(!1),[m,v]=c.useState(!1),[d,f]=c.useState(!1),[w,E]=c.useState(null),[h,P]=c.useState({email_on_scan_complete:!1,email_on_critical_vuln:!0,email_address:"",slack_webhook_url:"",teams_webhook_url:""});c.useEffect(()=>{p(),g()},[]);const p=async()=>{var a;x(!0);try{const s=await K.getSettings();I(s.data),P({email_on_scan_complete:s.data.email_on_scan_complete,email_on_critical_vuln:s.data.email_on_critical_vuln,email_address:s.data.email_address||"",slack_webhook_url:s.data.slack_webhook_url||"",teams_webhook_url:s.data.teams_webhook_url||""})}catch(s){((a=s.response)==null?void 0:a.status)!==404&&(r.error("Failed to load notification settings"),console.error(s))}finally{x(!1)}},g=async()=>{try{const a=await K.checkSmtpStatus();E(a.data.configured)}catch(a){console.error("Failed to check SMTP status:",a),E(!1)}},A=async a=>{var s,u;if(a.preventDefault(),(h.email_on_scan_complete||h.email_on_critical_vuln)&&!h.email_address){r.error("Email address is required when notifications are enabled");return}_(!0);try{const t=await K.updateSettings(h);I(t.data),r.success("Notification settings saved")}catch(t){r.error(((u=(s=t.response)==null?void 0:s.data)==null?void 0:u.error)||"Failed to save settings")}finally{_(!1)}},l=async()=>{var a,s;if(!h.slack_webhook_url){r.error("Please enter a Slack webhook URL first");return}C(!0);try{h.slack_webhook_url!==(i==null?void 0:i.slack_webhook_url)&&await K.updateSettings({slack_webhook_url:h.slack_webhook_url});const u=await K.testSlack();r.success(u.data.message)}catch(u){r.error(((s=(a=u.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to send test message")}finally{C(!1)}},k=async()=>{var a,s;if(!h.teams_webhook_url){r.error("Please enter a Teams webhook URL first");return}v(!0);try{h.teams_webhook_url!==(i==null?void 0:i.teams_webhook_url)&&await K.updateSettings({teams_webhook_url:h.teams_webhook_url});const u=await K.testTeams();r.success(u.data.message)}catch(u){r.error(((s=(a=u.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to send test message")}finally{v(!1)}},n=async()=>{var a,s;if(!h.email_address){r.error("Please enter an email address first");return}if(!w){r.error("SMTP is not configured on the server. Contact your administrator.");return}f(!0);try{h.email_address!==(i==null?void 0:i.email_address)&&await K.updateSettings({email_address:h.email_address});const u=await K.testEmail();r.success(u.data.message)}catch(u){r.error(((s=(a=u.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to send test email")}finally{f(!1)}};return F?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Te,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Notification Settings"})]}),e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Notification Email Address"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"email",value:h.email_address,onChange:a=>P({...h,email_address:a.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"your@email.com"})]}),e.jsx(b,{type:"button",variant:"secondary",onClick:n,disabled:!h.email_address||d||!w,title:w?"Send test email":"SMTP not configured on server",children:d?e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-2",children:"Sending..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Email address where notifications will be sent"}),w!==null&&e.jsx("span",{className:`text-xs flex items-center gap-1 ${w?"text-green-400":"text-amber-400"}`,children:w?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-3 w-3"}),"SMTP configured"]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-3 w-3"}),"SMTP not configured"]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Email Notifications"}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:h.email_on_scan_complete,onChange:a=>P({...h,email_on_scan_complete:a.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"font-medium text-white",children:"Scan Completion"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Receive an email when any of your scans complete, including a summary of findings"})]})]}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:h.email_on_critical_vuln,onChange:a=>P({...h,email_on_critical_vuln:a.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"font-medium text-white",children:"Critical Vulnerabilities"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Get immediate alerts when critical or high severity vulnerabilities are discovered"})]})]})]}),w===!1?e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(q,{className:"h-5 w-5 text-amber-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-200",children:"SMTP is not configured on this server. Email notifications are disabled."}),e.jsx("p",{className:"text-xs text-amber-300/70 mt-1",children:"Contact your administrator to configure SMTP settings (SMTP_HOST, SMTP_USER, etc.)"})]})]})}):e.jsx("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(pe,{className:"h-5 w-5 text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-200",children:w?"Email notifications are ready. Use the Test button to verify delivery.":"Checking SMTP configuration..."}),e.jsx("p",{className:"text-xs text-blue-300/70 mt-1",children:"Contact your administrator if you're not receiving emails."})]})]})}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-dark-border",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(ss,{className:"h-4 w-4"}),"Webhook Integrations"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Slack Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:h.slack_webhook_url,onChange:a=>P({...h,slack_webhook_url:a.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://hooks.slack.com/services/YOUR/WEBHOOK/URL"}),e.jsx(b,{type:"button",variant:"secondary",onClick:l,disabled:!h.slack_webhook_url||y,children:y?e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Send scan notifications to a Slack channel. Create a webhook at"," ",e.jsx("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Slack Incoming Webhooks"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Microsoft Teams Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:h.teams_webhook_url,onChange:a=>P({...h,teams_webhook_url:a.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://outlook.office.com/webhook/YOUR/WEBHOOK/URL"}),e.jsx(b,{type:"button",variant:"secondary",onClick:k,disabled:!h.teams_webhook_url||m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Send scan notifications to a Teams channel. Create a webhook in your Teams channel connectors."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(b,{type:"submit",variant:"primary",disabled:j,children:j?e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Save Settings"]})})})]})]}),i&&e.jsxs(N,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"Current Status"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Scan Complete Emails:"}),e.jsx("span",{className:`ml-2 ${i.email_on_scan_complete?"text-green-400":"text-slate-400"}`,children:i.email_on_scan_complete?"Enabled":"Disabled"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Critical Vuln Alerts:"}),e.jsx("span",{className:`ml-2 ${i.email_on_critical_vuln?"text-green-400":"text-slate-400"}`,children:i.email_on_critical_vuln?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-slate-500",children:"Last Updated:"}),e.jsx("span",{className:"ml-2 text-slate-300",children:new Date(i.updated_at).toLocaleString()})]})]})]})]})},ps=()=>{const[i,I]=c.useState([]),[F,x]=c.useState(!0),[j,_]=c.useState(""),[y,C]=c.useState(""),[m,v]=c.useState(!1),[d,f]=c.useState(null),[w,E]=c.useState(new Set);c.useEffect(()=>{h()},[]);const h=async()=>{x(!0);try{const k=(await Ie.getAll()).data.filter(n=>n.status==="completed");I(k)}catch(l){r.error("Failed to load scans"),console.error(l)}finally{x(!1)}},P=async()=>{var l,k;if(!j||!y){r.error("Please select two scans to compare");return}if(j===y){r.error("Please select two different scans");return}v(!0);try{const n=await Ve.compare(j,y);f(n.data),r.success("Comparison completed")}catch(n){r.error(((k=(l=n.response)==null?void 0:l.data)==null?void 0:k.error)||"Failed to compare scans"),console.error(n)}finally{v(!1)}},p=l=>{const k=new Set(w);k.has(l)?k.delete(l):k.add(l),E(k)},g=l=>{switch(l){case"NewService":return e.jsx($,{className:"h-3 w-3 text-green-400"});case"ServiceRemoved":return e.jsx(Y,{className:"h-3 w-3 text-red-400"});case"ServiceChanged":case"VersionChanged":return e.jsx(ce,{className:"h-3 w-3 text-yellow-400"});default:return null}},A=l=>{switch(l){case"NewService":return"New Service";case"ServiceRemoved":return"Service Removed";case"ServiceChanged":return"Service Changed";case"VersionChanged":return"Version Changed";default:return l}};return F?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ge,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Compare Scans"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"Select two completed scans to compare their results and identify changes in hosts, ports, services, and vulnerabilities."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Baseline Scan (Older)"}),e.jsxs("select",{value:j,onChange:l=>_(l.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a scan..."}),i.map(l=>e.jsxs("option",{value:l.id,children:[l.name," - ",new Date(l.created_at).toLocaleString()]},l.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Comparison Scan (Newer)"}),e.jsxs("select",{value:y,onChange:l=>C(l.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a scan..."}),i.map(l=>e.jsxs("option",{value:l.id,children:[l.name," - ",new Date(l.created_at).toLocaleString()]},l.id))]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(b,{variant:"primary",onClick:P,loading:m,disabled:!j||!y||j===y,children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Compare Scans"]})})]}),d&&e.jsxs(e.Fragment,{children:[e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ts,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Comparison Summary"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx($,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"New Hosts"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:d.diff.summary.total_new_hosts})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Y,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Removed"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:d.diff.summary.total_removed_hosts})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-yellow-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ce,{className:"h-4 w-4 text-yellow-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Changed"})]}),e.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:d.diff.summary.total_hosts_changed})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(_e,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"New Ports"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:d.diff.summary.total_new_ports})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(_e,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Closed"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:d.diff.summary.total_closed_ports})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(q,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"New Vulns"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:d.diff.summary.total_new_vulnerabilities})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(O,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Resolved"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:d.diff.summary.total_resolved_vulnerabilities})]})]})]}),d.diff.new_hosts.length>0&&e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx($,{className:"h-5 w-5 text-green-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["New Hosts (",d.diff.new_hosts.length,")"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.diff.new_hosts.map(l=>e.jsx("span",{className:"px-3 py-1.5 bg-green-500/20 border border-green-500/30 rounded-lg text-green-400 font-mono text-sm",children:l},l))})]}),d.diff.removed_hosts.length>0&&e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Y,{className:"h-5 w-5 text-red-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Removed Hosts (",d.diff.removed_hosts.length,")"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.diff.removed_hosts.map(l=>e.jsx("span",{className:"px-3 py-1.5 bg-red-500/20 border border-red-500/30 rounded-lg text-red-400 font-mono text-sm",children:l},l))})]}),d.diff.host_changes.length>0&&e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(je,{className:"h-5 w-5 text-yellow-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Host Changes (",d.diff.host_changes.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:d.diff.host_changes.map(l=>{const k=w.has(l.ip);return l.new_ports.length>0||l.closed_ports.length>0||l.new_vulnerabilities.length>0||l.resolved_vulnerabilities.length>0||l.service_changes.length>0||l.os_change!==null?e.jsxs("div",{className:"bg-dark-bg rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("button",{onClick:()=>p(l.ip),className:"w-full flex items-center justify-between p-4 hover:bg-dark-hover transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[k?e.jsx(Ee,{className:"h-4 w-4 text-slate-400"}):e.jsx(Fe,{className:"h-4 w-4 text-slate-400"}),e.jsx(je,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"font-mono text-white",children:l.ip}),l.hostname&&e.jsxs("span",{className:"text-sm text-slate-400",children:["(",l.hostname,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l.new_ports.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-green-500/20 border border-green-500/30 rounded text-xs text-green-400",children:["+",l.new_ports.length," ports"]}),l.closed_ports.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 border border-red-500/30 rounded text-xs text-red-400",children:["-",l.closed_ports.length," ports"]}),l.new_vulnerabilities.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 border border-red-500/30 rounded text-xs text-red-400",children:["+",l.new_vulnerabilities.length," vulns"]}),l.resolved_vulnerabilities.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-green-500/20 border border-green-500/30 rounded text-xs text-green-400",children:["-",l.resolved_vulnerabilities.length," vulns"]})]})]}),k&&e.jsxs("div",{className:"border-t border-dark-border p-4 space-y-4",children:[l.os_change&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-2",children:"Operating System Change"}),e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-3 w-3 text-red-400"}),e.jsxs("span",{className:"text-sm text-red-400",children:[l.os_change.old_os," (",l.os_change.old_confidence,"% confidence)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-3 w-3 text-green-400"}),e.jsxs("span",{className:"text-sm text-green-400",children:[l.os_change.new_os," (",l.os_change.new_confidence,"% confidence)"]})]})]})]}),l.new_ports.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4 text-green-400"}),"New Open Ports (",l.new_ports.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:l.new_ports.map(a=>e.jsxs("div",{className:"bg-dark-surface rounded p-2 flex items-center justify-between",children:[e.jsxs("span",{className:"font-mono text-sm text-green-400",children:[a.port,"/",a.protocol]}),a.service&&e.jsxs("span",{className:"text-xs text-slate-400",children:[a.service.name,a.service.version&&` ${a.service.version}`]})]},a.port))})]}),l.closed_ports.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-red-400"}),"Closed Ports (",l.closed_ports.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:l.closed_ports.map(a=>e.jsxs("div",{className:"bg-dark-surface rounded p-2 flex items-center justify-between",children:[e.jsxs("span",{className:"font-mono text-sm text-red-400",children:[a.port,"/",a.protocol]}),a.service&&e.jsxs("span",{className:"text-xs text-slate-400",children:[a.service.name,a.service.version&&` ${a.service.version}`]})]},a.port))})]}),l.service_changes.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-yellow-400"}),"Service Changes (",l.service_changes.length,")"]}),e.jsx("div",{className:"space-y-2",children:l.service_changes.map((a,s)=>e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-mono text-sm text-white",children:[a.port,"/",a.protocol]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g(a.change_type),e.jsx("span",{className:"text-xs text-yellow-400",children:A(a.change_type)})]})]}),a.old_service&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Y,{className:"h-3 w-3 text-red-400"}),e.jsxs("span",{className:"text-red-400",children:[a.old_service,a.old_version&&` ${a.old_version}`]})]}),a.new_service&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx($,{className:"h-3 w-3 text-green-400"}),e.jsxs("span",{className:"text-green-400",children:[a.new_service,a.new_version&&` ${a.new_version}`]})]})]},s))})]}),l.new_vulnerabilities.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-red-400"}),"New Vulnerabilities (",l.new_vulnerabilities.length,")"]}),e.jsx("div",{className:"space-y-2",children:l.new_vulnerabilities.map((a,s)=>e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-white",children:a.cve_id||a.title}),e.jsx(V,{variant:"severity",type:a.severity.toLowerCase(),children:a.severity})]}),e.jsx("p",{className:"text-xs text-slate-400",children:a.description}),a.affected_service&&e.jsxs("span",{className:"text-xs text-slate-500",children:["Service: ",a.affected_service]})]},s))})]}),l.resolved_vulnerabilities.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-green-400"}),"Resolved Vulnerabilities (",l.resolved_vulnerabilities.length,")"]}),e.jsx("div",{className:"space-y-2",children:l.resolved_vulnerabilities.map((a,s)=>e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1 opacity-75",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-green-400 line-through",children:a.cve_id||a.title}),e.jsx(V,{variant:"severity",type:a.severity.toLowerCase(),children:a.severity})]}),e.jsx("p",{className:"text-xs text-slate-500",children:a.description})]},s))})]})]})]},l.ip):null})})]}),d.diff.new_hosts.length===0&&d.diff.removed_hosts.length===0&&d.diff.host_changes.length===0&&e.jsx(N,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(O,{className:"h-12 w-12 text-green-400 mx-auto mb-4"}),e.jsx("p",{className:"text-lg text-white font-medium mb-2",children:"No Changes Detected"}),e.jsx("p",{className:"text-sm text-slate-400",children:"The selected scans have identical results"})]})})]}),!d&&i.length===0&&e.jsx(N,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(G,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No completed scans available"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Complete at least two scans to use the comparison feature"})]})})]})},gs=()=>{const[i,I]=c.useState([]),[F,x]=c.useState(!0),[j,_]=c.useState(!1),[y,C]=c.useState(null),[m,v]=c.useState({name:"",description:""}),[d,f]=c.useState(new Set),{addScan:w}=ze();c.useEffect(()=>{E()},[]);const E=async()=>{x(!0);try{const n=await re.getAll();I(n.data)}catch(n){r.error("Failed to load templates"),console.error(n)}finally{x(!1)}},h=()=>{v({name:"",description:""}),C(null),_(!1)},P=n=>{v({name:n.name,description:n.description||""}),C(n.id),_(!0)},p=async n=>{var a,s;if(n.preventDefault(),!m.name.trim()){r.error("Name is required");return}if(!y){r.error('Cannot create templates from this form. Use "Save as Template" in the scan form.');return}try{await re.update(y,{name:m.name,description:m.description||void 0}),r.success("Template updated"),h(),E()}catch(u){r.error(((s=(a=u.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to update template")}},g=async(n,a)=>{var s,u;if(confirm(`Delete template "${a}"?`))try{await re.delete(n),r.success("Template deleted"),E()}catch(t){r.error(((u=(s=t.response)==null?void 0:s.data)==null?void 0:u.error)||"Failed to delete")}},A=async(n,a)=>{var u,t;const s=prompt(`Enter name for new scan (based on "${a}"):`,`${a} - ${new Date().toLocaleDateString()}`);if(s){f(new Set([...d,n]));try{const o=await re.createScan(n,s);w(o.data),r.success("Scan started from template!")}catch(o){r.error(((t=(u=o.response)==null?void 0:u.data)==null?void 0:t.error)||"Failed to create scan")}finally{f(o=>{const S=new Set(o);return S.delete(n),S})}}},l=n=>{try{return JSON.parse(n)}catch{return null}},k=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return F?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scan Templates"})]}),e.jsx("div",{className:"text-sm text-slate-400",children:"Save scan configurations for quick reuse"})]})}),j&&e.jsx(N,{children:e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Edit Template"}),e.jsx("button",{type:"button",onClick:h,className:"text-slate-400 hover:text-white",children:e.jsx(de,{className:"h-5 w-5"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:m.name,onChange:n=>v({...m,name:n.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Production Network Template"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("textarea",{value:m.description,onChange:n=>v({...m,description:n.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",rows:3,placeholder:"Optional description"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{type:"button",variant:"secondary",onClick:h,children:"Cancel"}),e.jsxs(b,{type:"submit",variant:"primary",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Update"]})]})]})}),i.length===0&&!j?e.jsx(N,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(be,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scan templates yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:'Save scan configurations using "Save as Template" when creating a scan'})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:i.map(n=>{const a=l(n.config),s=d.has(n.id);return e.jsx(N,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white text-lg",children:n.name}),n.description&&e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:n.description})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>P(n),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit template",children:e.jsx(oe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>g(n.id,n.name),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete template",children:e.jsx(X,{className:"h-4 w-4"})})]})]}),a&&e.jsxs("div",{className:"space-y-2 border-t border-dark-border pt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:[a.targets.length," target",a.targets.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(as,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Ports: ",a.port_range[0],"-",a.port_range[1]]})]}),a.scan_type&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-slate-400 capitalize",children:a.scan_type.replace("_"," ")})]}),a.enable_enumeration&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Enumeration: ",a.enum_depth||"light"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[a.enable_os_detection&&e.jsx(V,{variant:"status",type:"completed",children:"OS Detection"}),a.enable_service_detection&&e.jsx(V,{variant:"status",type:"completed",children:"Services"}),a.enable_vuln_scan&&e.jsx(V,{variant:"status",type:"running",children:"Vuln Scan"}),a.enable_enumeration&&e.jsx(V,{variant:"status",type:"pending",children:"Enumeration"})]})]}),e.jsxs("div",{className:"flex items-center justify-between border-t border-dark-border pt-4",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:["Created ",k(n.created_at)]}),e.jsxs(b,{variant:"primary",size:"sm",onClick:()=>A(n.id,n.name),loading:s,disabled:s,children:[e.jsx(ns,{className:"h-4 w-4 mr-1.5"}),"Create Scan"]})]})]})},n.id)})})]})},js=()=>{const[i,I]=c.useState(!1),[F,x]=c.useState(!0),[j,_]=c.useState("idle"),[y,C]=c.useState(""),[m,v]=c.useState(""),[d,f]=c.useState([]),[w,E]=c.useState(""),[h,P]=c.useState(!1),[p,g]=c.useState(!1),[A,l]=c.useState(""),[k,n]=c.useState(""),[a,s]=c.useState(!1),[u,t]=c.useState(!1),[o,S]=c.useState(""),[U,J]=c.useState(""),[Z,H]=c.useState(!1);c.useEffect(()=>{De()},[]);const De=async()=>{x(!0);try{const T=await ne.me();I(T.data.mfa_enabled||!1)}catch(T){console.error("Failed to check MFA status:",T)}finally{x(!1)}},Ue=async()=>{var T,M;try{const L=await le.setup();C(L.data.secret),v(L.data.qr_code_url),f(L.data.recovery_codes),_("scan-qr")}catch(L){r.error(((M=(T=L.response)==null?void 0:T.data)==null?void 0:M.error)||"Failed to initialize MFA setup")}},$e=async T=>{var M,L;if(T.preventDefault(),!w||w.length!==6){r.error("Please enter a valid 6-digit code");return}P(!0);try{await le.verifySetup({totp_code:w}),r.success("MFA enabled successfully!"),_("show-recovery"),I(!0)}catch(z){r.error(((L=(M=z.response)==null?void 0:M.data)==null?void 0:L.error)||"Invalid verification code")}finally{P(!1)}},Oe=()=>{_("idle"),C(""),v(""),f([]),E("")},Je=async T=>{var M,L;if(T.preventDefault(),!A||!k){r.error("Password and TOTP code are required");return}s(!0);try{await le.disable({password:A,totp_code:k}),r.success("MFA disabled successfully"),I(!1),g(!1),l(""),n("")}catch(z){r.error(((L=(M=z.response)==null?void 0:M.data)==null?void 0:L.error)||"Failed to disable MFA")}finally{s(!1)}},Ke=async T=>{var M,L;if(T.preventDefault(),!o||!U){r.error("Password and TOTP code are required");return}H(!0);try{const z=await le.regenerateRecoveryCodes({password:o,totp_code:U});f(z.data.recovery_codes),r.success("Recovery codes regenerated successfully"),t(!1),S(""),J(""),_("show-recovery")}catch(z){r.error(((L=(M=z.response)==null?void 0:M.data)==null?void 0:L.error)||"Failed to regenerate recovery codes")}finally{H(!1)}},we=T=>{navigator.clipboard.writeText(T),r.success("Copied to clipboard")},qe=()=>{const T=new Blob([d.join(`
`)],{type:"text/plain"}),M=URL.createObjectURL(T),L=document.createElement("a");L.href=M,L.download="heroforge-recovery-codes.txt",document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(M),r.success("Recovery codes downloaded")};return F?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):j!=="idle"?e.jsx("div",{className:"space-y-6",children:e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Enable Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{className:j==="scan-qr"?"text-primary":"",children:"1. Scan QR"}),e.jsx("span",{children:""}),e.jsx("span",{className:j==="verify-code"?"text-primary":"",children:"2. Verify"}),e.jsx("span",{children:""}),e.jsx("span",{className:j==="show-recovery"?"text-primary":"",children:"3. Save Codes"})]})]}),j==="scan-qr"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 1: Scan QR Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Use an authenticator app like Google Authenticator, Authy, or 1Password to scan this QR code:"}),m&&e.jsx("div",{className:"bg-white p-4 rounded-lg mb-4",children:e.jsx("img",{src:m,alt:"MFA QR Code",className:"w-64 h-64"})}),e.jsxs("div",{className:"mt-4 w-full max-w-md",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Or enter this secret manually:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{type:"text",value:y,readOnly:!0,className:"font-mono text-sm flex-1"}),e.jsx(b,{variant:"secondary",onClick:()=>we(y),children:e.jsx(fe,{className:"h-4 w-4"})})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(b,{variant:"primary",onClick:()=>_("verify-code"),children:"Next: Verify Code"})})]}),j==="verify-code"&&e.jsxs("form",{onSubmit:$e,className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(ke,{className:"h-12 w-12 text-primary mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 2: Verify Your Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Enter the 6-digit code from your authenticator app to confirm setup:"}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsx(D,{type:"text",value:w,onChange:T=>E(T.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center text-2xl tracking-widest font-mono",maxLength:6,autoFocus:!0})})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(b,{type:"button",variant:"secondary",onClick:()=>_("scan-qr"),children:"Back"}),e.jsx(b,{type:"submit",variant:"primary",loading:h,disabled:h||w.length!==6,children:"Verify & Enable MFA"})]})]}),j==="show-recovery"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(q,{className:"h-6 w-6 text-yellow-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-yellow-400 mb-2",children:"Save Your Recovery Codes"}),e.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Store these recovery codes in a safe place. Each code can be used once to access your account if you lose your authenticator device."}),e.jsx("div",{className:"grid grid-cols-2 gap-2 bg-dark-bg rounded-lg p-4 font-mono text-sm mb-4",children:d.map((T,M)=>e.jsxs("div",{className:"text-white",children:[M+1,". ",T]},M))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{variant:"secondary",onClick:()=>we(d.join(`
`)),children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Copy Codes"]}),e.jsxs(b,{variant:"secondary",onClick:qe,children:[e.jsx(cs,{className:"h-4 w-4 mr-2"}),"Download Codes"]})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(b,{variant:"primary",onClick:Oe,children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Finish Setup"]})})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(G,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-start justify-between mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[i?e.jsx(O,{className:"h-6 w-6 text-green-400 flex-shrink-0"}):e.jsx(q,{className:"h-6 w-6 text-yellow-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white mb-1",children:i?"MFA Enabled":"MFA Disabled"}),e.jsx("p",{className:"text-sm text-slate-400",children:i?"Your account is protected with two-factor authentication.":"Enable MFA to add an extra layer of security to your account."})]})]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${i?"bg-green-400":"bg-yellow-400"}`})]}),i?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ie,{className:"h-5 w-5 text-primary"}),e.jsx("h5",{className:"font-medium text-white",children:"Recovery Codes"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Generate new recovery codes if you've lost the originals or used them."}),e.jsx(b,{variant:"secondary",size:"sm",onClick:()=>t(!0),children:"Regenerate Codes"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ve,{className:"h-5 w-5 text-red-400"}),e.jsx("h5",{className:"font-medium text-white",children:"Disable MFA"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Turn off two-factor authentication for your account."}),e.jsx(b,{variant:"danger",size:"sm",onClick:()=>g(!0),children:"Disable MFA"})]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h5",{className:"text-white font-medium mb-2",children:"Why enable MFA?"}),e.jsxs("ul",{className:"text-sm text-slate-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Adds an extra layer of security beyond your password"}),e.jsx("li",{children:"Prevents unauthorized access even if your password is compromised"}),e.jsx("li",{children:"Uses time-based codes from your smartphone"}),e.jsx("li",{children:"Industry standard for securing sensitive accounts"})]})]}),e.jsxs(b,{variant:"primary",onClick:Ue,children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Enable Two-Factor Authentication"]})]})]}),p&&e.jsx(N,{children:e.jsxs("form",{onSubmit:Je,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Disable Two-Factor Authentication"}),e.jsxs("button",{type:"button",onClick:()=>{g(!1),l(""),n("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"Disabling MFA will make your account less secure. You'll need to provide your password and a TOTP code to confirm."})}),e.jsx(D,{label:"Password",type:"password",value:A,onChange:T=>l(T.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(D,{label:"TOTP Code",type:"text",value:k,onChange:T=>n(T.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{type:"button",variant:"secondary",onClick:()=>{g(!1),l(""),n("")},children:"Cancel"}),e.jsx(b,{type:"submit",variant:"danger",loading:a,disabled:a||!A||k.length!==6,children:"Disable MFA"})]})]})}),u&&e.jsx(N,{children:e.jsxs("form",{onSubmit:Ke,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Regenerate Recovery Codes"}),e.jsxs("button",{type:"button",onClick:()=>{t(!1),S(""),J("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"This will invalidate all existing recovery codes. Make sure to save the new codes in a safe place."})}),e.jsx(D,{label:"Password",type:"password",value:o,onChange:T=>S(T.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(D,{label:"TOTP Code",type:"text",value:U,onChange:T=>J(T.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{type:"button",variant:"secondary",onClick:()=>{t(!1),S(""),J("")},children:"Cancel"}),e.jsx(b,{type:"submit",variant:"primary",loading:Z,disabled:Z||!o||U.length!==6,children:"Generate New Codes"})]})]})})]})},bs=()=>{const[i,I]=c.useState([]),[F,x]=c.useState(!0),[j,_]=c.useState(!1),[y,C]=c.useState(""),[m,v]=c.useState(!1),[d,f]=c.useState(null);c.useEffect(()=>{w()},[]);const w=async()=>{x(!0);try{const g=await me.getAll();I(g.data)}catch(g){r.error("Failed to load API keys"),console.error(g)}finally{x(!1)}},E=async()=>{var g,A;if(!y.trim()){r.error("Please enter a name for the API key");return}v(!0);try{const l=await me.create({name:y.trim()});f(l.data),C(""),await w(),r.success("API key created successfully")}catch(l){r.error(((A=(g=l.response)==null?void 0:g.data)==null?void 0:A.error)||"Failed to create API key")}finally{v(!1)}},h=async(g,A)=>{var l,k;if(confirm(`Are you sure you want to revoke the API key "${A}"? This action cannot be undone.`))try{await me.delete(g),await w(),r.success("API key revoked successfully")}catch(n){r.error(((k=(l=n.response)==null?void 0:l.data)==null?void 0:k.error)||"Failed to revoke API key")}},P=g=>{navigator.clipboard.writeText(g),r.success("API key copied to clipboard")},p=()=>{f(null),_(!1)};return F?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Keys"})]}),e.jsxs(b,{variant:"primary",onClick:()=>_(!0),className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"Create API Key"]})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"API keys allow programmatic access to HeroForge. Keep your keys secure and never share them publicly."}),i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ie,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No API keys yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Create your first API key to get started"})]}):e.jsx("div",{className:"space-y-3",children:i.map(g=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary/30 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-medium text-white",children:g.name}),e.jsxs("code",{className:"px-2 py-1 bg-dark-surface rounded text-xs text-slate-400 font-mono",children:[g.prefix,"..."]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"h-3 w-3"}),"Created ",new Date(g.created_at).toLocaleDateString()]}),g.last_used_at&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"h-3 w-3"}),"Last used ",new Date(g.last_used_at).toLocaleDateString()]}),!g.last_used_at&&e.jsx("span",{className:"text-amber-500",children:"Never used"})]})]}),e.jsxs(b,{variant:"danger",size:"sm",onClick:()=>h(g.id,g.name),className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"Revoke"]})]},g.id))})]}),j&&!d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Create API Key"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Key Name"}),e.jsx("input",{type:"text",value:y,onChange:g=>C(g.target.value),placeholder:"e.g., Production Server, CI/CD Pipeline",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",autoFocus:!0}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Give your API key a descriptive name to remember where it's used"})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4",children:[e.jsx(b,{variant:"secondary",onClick:()=>{_(!1),C("")},children:"Cancel"}),e.jsx(b,{variant:"primary",onClick:E,disabled:m||!y.trim(),children:m?e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-2",children:"Creating..."})]}):"Create Key"})]})]})]})}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-2xl w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(O,{className:"h-6 w-6 text-green-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Key Created Successfully"})]}),e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-amber-200 font-medium mb-2",children:"Important: Save your API key now!"}),e.jsx("p",{className:"text-xs text-amber-300/70",children:"This is the only time you'll see the full key. If you lose it, you'll need to create a new one."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"API Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("code",{className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-3 text-white font-mono text-sm break-all",children:d.key}),e.jsxs(b,{variant:"secondary",onClick:()=>P(d.key),className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4"}),"Copy"]})]})]}),e.jsxs("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-200 mb-2",children:"Using your API key"}),e.jsx("p",{className:"text-xs text-blue-300/70 mb-3",children:"Include your API key in the X-API-Key header:"}),e.jsxs("code",{className:"block bg-dark-bg border border-dark-border rounded px-3 py-2 text-xs text-slate-300 font-mono",children:['curl -H "X-API-Key: ',d.key,'" https://heroforge.example.com/api/scans']})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(b,{variant:"primary",onClick:p,children:"Done"})})]})]})})]})},fs=()=>{const[i,I]=c.useState(!0),[F,x]=c.useState(!1),[j,_]=c.useState(!1),[y,C]=c.useState(!1),[m,v]=c.useState({jira_url:"",username:"",api_token:"",project_key:"",issue_type:"Task",default_assignee:"",enabled:!0}),[d,f]=c.useState([]),[w,E]=c.useState([]),[h,P]=c.useState(!1);c.useEffect(()=>{p()},[]);const p=async()=>{var n;I(!0);try{const a=await se.getSettings();v(a.data),C(!0)}catch(a){((n=a.response)==null?void 0:n.status)===404?C(!1):console.error("Failed to load JIRA settings:",a)}finally{I(!1)}},g=async()=>{var n,a;if(!m.jira_url||!m.username||!m.api_token||!m.project_key){r.error("Please fill in all required fields");return}x(!0);try{await se.updateSettings(m),r.success("JIRA settings saved successfully"),C(!0)}catch(s){console.error("Failed to save JIRA settings:",s),r.error(((a=(n=s.response)==null?void 0:n.data)==null?void 0:a.error)||"Failed to save JIRA settings")}finally{x(!1)}},A=async()=>{var n,a;if(!y){r.error("Please save your settings first");return}_(!0);try{await se.testConnection(),r.success("JIRA connection successful!")}catch(s){console.error("JIRA connection failed:",s),r.error(((a=(n=s.response)==null?void 0:n.data)==null?void 0:a.error)||"JIRA connection failed")}finally{_(!1)}},l=async()=>{var n,a;if(!y){r.error("Please save your settings first");return}P(!0);try{const s=await se.listProjects();f(s.data),r.success(`Loaded ${s.data.length} projects`)}catch(s){console.error("Failed to load projects:",s),r.error(((a=(n=s.response)==null?void 0:n.data)==null?void 0:a.error)||"Failed to load projects")}finally{P(!1)}},k=async()=>{var n,a;if(!y||!m.project_key){r.error("Please save your settings and select a project first");return}P(!0);try{const s=await se.listIssueTypes();E(s.data),r.success(`Loaded ${s.data.length} issue types`)}catch(s){console.error("Failed to load issue types:",s),r.error(((a=(n=s.response)==null?void 0:n.data)==null?void 0:a.error)||"Failed to load issue types")}finally{P(!1)}};return i?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Re,{className:"h-6 w-6 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"JIRA Integration"})]}),e.jsxs("div",{className:"space-y-4",children:[!y&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(q,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"JIRA Integration Not Configured"}),e.jsx("p",{children:"Configure your JIRA instance to automatically create tickets from vulnerabilities."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["JIRA URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{type:"url",placeholder:"https://your-domain.atlassian.net",value:m.jira_url,onChange:n=>v({...m,jira_url:n.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your JIRA instance URL (e.g., https://company.atlassian.net)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Username/Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{type:"text",placeholder:"user@example.com",value:m.username,onChange:n=>v({...m,username:n.target.value})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["API Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{type:"password",placeholder:"Your JIRA API token",value:m.api_token,onChange:n=>v({...m,api_token:n.target.value})}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Generate an API token at"," ",e.jsxs("a",{href:"https://id.atlassian.com/manage-profile/security/api-tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 inline-flex items-center gap-1",children:["Atlassian Account Settings ",e.jsx(Le,{className:"h-3 w-3"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Key ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:d.length>0?e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:m.project_key,onChange:n=>v({...m,project_key:n.target.value}),children:[e.jsx("option",{value:"",children:"Select a project"}),d.map(n=>e.jsxs("option",{value:n.key,children:[n.name," (",n.key,")"]},n.key))]}):e.jsx(D,{type:"text",placeholder:"PROJECT",value:m.project_key,onChange:n=>v({...m,project_key:n.target.value})})}),e.jsx(b,{onClick:l,disabled:!y||h,variant:"secondary",children:h?"Loading...":"Load Projects"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Issue Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:w.length>0?e.jsx("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:m.issue_type,onChange:n=>v({...m,issue_type:n.target.value}),children:w.map(n=>e.jsx("option",{value:n.name,children:n.name},n.id))}):e.jsx(D,{type:"text",placeholder:"Task",value:m.issue_type,onChange:n=>v({...m,issue_type:n.target.value})})}),e.jsx(b,{onClick:k,disabled:!y||!m.project_key||h,variant:"secondary",children:h?"Loading...":"Load Types"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Assignee (optional)"}),e.jsx(D,{type:"text",placeholder:"username",value:m.default_assignee||"",onChange:n=>v({...m,default_assignee:n.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Leave empty for unassigned or enter a JIRA username"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"jira-enabled",checked:m.enabled,onChange:n=>v({...m,enabled:n.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"jira-enabled",className:"text-sm font-medium text-gray-700",children:"Enable JIRA integration"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(b,{onClick:g,disabled:F,children:F?"Saving...":"Save Settings"}),e.jsx(b,{onClick:A,disabled:!y||j,variant:"secondary",children:j?"Testing...":"Test Connection"})]}),y&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(O,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("p",{className:"font-medium",children:"JIRA Integration Configured"}),e.jsx("p",{children:"You can now create JIRA tickets from vulnerabilities."})]})]})]})]}),e.jsxs(N,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"How to Use JIRA Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Configure your JIRA instance settings above and test the connection."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Navigate to any vulnerability in your scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"3"})}),e.jsx("p",{children:'Click the "Create JIRA Ticket" button to automatically create an issue with vulnerability details.'})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"The vulnerability will be linked to the JIRA ticket, and you can track it in your JIRA project."})]})]})]})]})},ys=()=>{const[i,I]=c.useState([]),[F,x]=c.useState(!0),[j,_]=c.useState(!1),[y,C]=c.useState(null),[m,v]=c.useState(null),[d,f]=c.useState([]),[w,E]=c.useState(!1),[h,P]=c.useState(""),[p,g]=c.useState(!1);c.useEffect(()=>{A(),n()},[]);const A=async()=>{x(!0);try{const s=await W.getSettings();I(s.data)}catch(s){r.error("Failed to load SIEM settings"),console.error(s)}finally{x(!1)}},l=async s=>{var u,t;v(s);try{const o=await W.testConnection(s);o.data.success?r.success("Connection test successful!"):r.error(`Connection test failed: ${o.data.message}`)}catch(o){r.error(((t=(u=o.response)==null?void 0:u.data)==null?void 0:t.error)||"Connection test failed")}finally{v(null)}},k=async s=>{var u,t;if(confirm("Are you sure you want to delete this SIEM integration?"))try{await W.deleteSettings(s),r.success("SIEM integration deleted"),A()}catch(o){r.error(((t=(u=o.response)==null?void 0:u.data)==null?void 0:t.error)||"Failed to delete SIEM integration")}},n=async()=>{E(!0);try{const s=await Ie.getAll();f(s.data.filter(u=>u.status==="completed"))}catch(s){console.error("Failed to load scans:",s)}finally{E(!1)}},a=async()=>{var u,t;if(!h){r.error("Please select a scan to export");return}if(i.filter(o=>o.enabled).length===0){r.error("No enabled SIEM integrations found. Please enable at least one integration.");return}g(!0);try{const o=await W.exportScan(h);o.data.success?(r.success(`Scan exported to ${o.data.exported_to} SIEM integration(s). ${o.data.events_count} events sent.`),o.data.errors&&o.data.errors.length>0&&o.data.errors.forEach(S=>r.warning(S))):r.error("Export failed. Check SIEM configuration.")}catch(o){r.error(((t=(u=o.response)==null?void 0:u.data)==null?void 0:t.error)||"Failed to export scan to SIEM")}finally{g(!1)}};return F?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"SIEM Integrations"})]}),e.jsxs(b,{variant:"primary",onClick:()=>_(!0),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Add Integration"]})]}),i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(je,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"No SIEM integrations configured"}),e.jsxs(b,{variant:"primary",onClick:()=>_(!0),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Add Your First Integration"]})]}):e.jsx("div",{className:"space-y-4",children:i.map(s=>e.jsx("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-primary/20 text-primary rounded-md text-sm font-medium uppercase",children:s.siem_type}),s.enabled?e.jsxs("span",{className:"flex items-center gap-1 text-green-400 text-sm",children:[e.jsx(O,{className:"h-4 w-4"}),"Enabled"]}):e.jsxs("span",{className:"flex items-center gap-1 text-slate-500 text-sm",children:[e.jsx(Se,{className:"h-4 w-4"}),"Disabled"]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Endpoint:"}),e.jsx("span",{className:"text-white font-mono",children:s.endpoint_url})]}),s.protocol&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Protocol:"}),e.jsx("span",{className:"text-white uppercase",children:s.protocol})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.export_on_scan_complete,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export on scan complete"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.export_on_critical_vuln,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export critical vulnerabilities"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>l(s.id),disabled:m===s.id,children:m===s.id?e.jsx(R,{}):e.jsx(is,{className:"h-4 w-4"})}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>C(s),children:e.jsx(oe,{className:"h-4 w-4"})}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>k(s.id),children:e.jsx(X,{className:"h-4 w-4 text-red-400"})})]})]})},s.id))})]}),e.jsxs(N,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Manual Export"})]}),e.jsx(b,{variant:"outline",size:"sm",onClick:n,disabled:w,children:w?e.jsx(R,{}):e.jsx(ce,{className:"h-4 w-4"})})]}),i.filter(s=>s.enabled).length===0?e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(Se,{className:"h-5 w-5 text-amber-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-200",children:[e.jsx("p",{className:"font-medium mb-1",children:"No Enabled Integrations"}),e.jsx("p",{children:"Enable at least one SIEM integration above before exporting scan results."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Manually export scan results to all enabled SIEM integrations."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:h,onChange:s=>P(s.target.value),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",disabled:w||p,children:[e.jsx("option",{value:"",children:"Select a completed scan..."}),d.map(s=>e.jsxs("option",{value:s.id,children:[s.name," - ",new Date(s.created_at).toLocaleDateString()," ",new Date(s.created_at).toLocaleTimeString()]},s.id))]}),e.jsx(b,{variant:"primary",onClick:a,disabled:!h||p||w,children:p?e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-2",children:"Exporting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Export to SIEM"]})})]}),d.length===0&&!w&&e.jsx("p",{className:"text-sm text-slate-500",children:"No completed scans available for export."}),e.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["Export will send data to: ",i.filter(s=>s.enabled).map(s=>s.siem_type.toUpperCase()).join(", ")]})]})]}),e.jsxs(N,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"About SIEM Integration"}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-400",children:[e.jsx("p",{children:"SIEM (Security Information and Event Management) integration allows HeroForge to automatically export scan results and vulnerability findings to your security monitoring platform."}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Syslog:"})," RFC 5424 compliant syslog over TCP/UDP"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Splunk:"})," Splunk HTTP Event Collector (HEC)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Elasticsearch:"})," Direct indexing via Bulk API"]})]})]})]}),(j||y)&&e.jsx(vs,{settings:y,onClose:()=>{_(!1),C(null)},onSave:()=>{_(!1),C(null),A()}})]})},vs=({settings:i,onClose:I,onSave:F})=>{const[x,j]=c.useState({siem_type:(i==null?void 0:i.siem_type)||"syslog",endpoint_url:(i==null?void 0:i.endpoint_url)||"",api_key:(i==null?void 0:i.api_key)||"",protocol:(i==null?void 0:i.protocol)||"tcp",enabled:(i==null?void 0:i.enabled)??!0,export_on_scan_complete:(i==null?void 0:i.export_on_scan_complete)??!1,export_on_critical_vuln:(i==null?void 0:i.export_on_critical_vuln)??!0}),[_,y]=c.useState(!1),C=async m=>{var v,d;if(m.preventDefault(),!x.endpoint_url){r.error("Endpoint URL is required");return}if(x.siem_type==="splunk"&&!x.api_key){r.error("API key is required for Splunk HEC");return}y(!0);try{if(i){const f={endpoint_url:x.endpoint_url,enabled:x.enabled,export_on_scan_complete:x.export_on_scan_complete,export_on_critical_vuln:x.export_on_critical_vuln};x.api_key&&(f.api_key=x.api_key),x.siem_type==="syslog"&&(f.protocol=x.protocol),await W.updateSettings(i.id,f),r.success("SIEM integration updated")}else{const f={siem_type:x.siem_type,endpoint_url:x.endpoint_url,enabled:x.enabled,export_on_scan_complete:x.export_on_scan_complete,export_on_critical_vuln:x.export_on_critical_vuln};x.api_key&&(f.api_key=x.api_key),x.siem_type==="syslog"&&(f.protocol=x.protocol),await W.createSettings(f),r.success("SIEM integration created")}F()}catch(f){r.error(((d=(v=f.response)==null?void 0:v.data)==null?void 0:d.error)||"Failed to save SIEM integration")}finally{y(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white",children:[i?"Edit":"Add"," SIEM Integration"]}),e.jsx("button",{onClick:I,className:"text-slate-400 hover:text-white",children:e.jsx(de,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:C,className:"p-6 space-y-6",children:[!i&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"SIEM Type"}),e.jsxs("select",{value:x.siem_type,onChange:m=>j({...x,siem_type:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"syslog",children:"Syslog (RFC 5424)"}),e.jsx("option",{value:"splunk",children:"Splunk HEC"}),e.jsx("option",{value:"elasticsearch",children:"Elasticsearch"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Endpoint URL"}),e.jsx("input",{type:"text",value:x.endpoint_url,onChange:m=>j({...x,endpoint_url:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:x.siem_type==="syslog"?"192.168.1.100:514":x.siem_type==="splunk"?"https://splunk.example.com:8088":"https://elasticsearch.example.com:9200"})]}),x.siem_type==="syslog"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Protocol"}),e.jsxs("select",{value:x.protocol,onChange:m=>j({...x,protocol:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"})]})]}),(x.siem_type==="splunk"||x.siem_type==="elasticsearch")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:[x.siem_type==="splunk"?"HEC Token":"API Key"," ",x.siem_type==="splunk"&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"password",value:x.api_key,onChange:m=>j({...x,api_key:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:i?"(leave blank to keep current)":""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x.enabled,onChange:m=>j({...x,enabled:m.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Enable this integration"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x.export_on_scan_complete,onChange:m=>j({...x,export_on_scan_complete:m.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export when scans complete"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x.export_on_critical_vuln,onChange:m=>j({...x,export_on_critical_vuln:m.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export critical vulnerabilities immediately"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(b,{type:"button",variant:"outline",onClick:I,children:"Cancel"}),e.jsx(b,{type:"submit",variant:"primary",disabled:_,children:_?e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs("span",{children:[i?"Update":"Create"," Integration"]})})]})]})]})})},Cs=()=>{const[i,I]=c.useState("profile"),F=[{id:"profile",label:"Profile",icon:e.jsx(ue,{className:"h-4 w-4"}),component:e.jsx(ds,{})},{id:"security",label:"Security",icon:e.jsx(ve,{className:"h-4 w-4"}),component:e.jsx(js,{})},{id:"api-keys",label:"API Keys",icon:e.jsx(ie,{className:"h-4 w-4"}),component:e.jsx(bs,{})},{id:"administration",label:"Administration",icon:e.jsx(G,{className:"h-4 w-4"}),component:e.jsx(ms,{})},{id:"target-groups",label:"Target Groups",icon:e.jsx(Ne,{className:"h-4 w-4"}),component:e.jsx(xs,{})},{id:"scheduled-scans",label:"Scheduled Scans",icon:e.jsx(Q,{className:"h-4 w-4"}),component:e.jsx(hs,{})},{id:"templates",label:"Scan Templates",icon:e.jsx(be,{className:"h-4 w-4"}),component:e.jsx(gs,{})},{id:"notifications",label:"Notifications",icon:e.jsx(Te,{className:"h-4 w-4"}),component:e.jsx(us,{})},{id:"jira-integration",label:"JIRA Integration",icon:e.jsx(Le,{className:"h-4 w-4"}),component:e.jsx(fs,{})},{id:"siem-integration",label:"SIEM Integration",icon:e.jsx(Me,{className:"h-4 w-4"}),component:e.jsx(ys,{})},{id:"compare-scans",label:"Compare Scans",icon:e.jsx(ge,{className:"h-4 w-4"}),component:e.jsx(ps,{})}],x=F.find(j=>j.id===i);return e.jsx(Ge,{children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Re,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Settings"})]}),e.jsx("p",{className:"text-slate-400",children:"Manage your profile, security, users, target groups, scheduled scans, templates, and notifications"})]}),e.jsx("div",{className:"flex gap-2 mb-6 border-b border-dark-border pb-2",children:F.map(j=>e.jsxs("button",{onClick:()=>I(j.id),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg text-sm font-medium transition-colors ${i===j.id?"bg-dark-surface text-primary border-b-2 border-primary":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[j.icon,j.label]},j.id))}),e.jsx("div",{children:x==null?void 0:x.component})]})})};export{Cs as default};
