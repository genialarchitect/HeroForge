import{j as e}from"./vendor-state-BjT_zREg.js";import{u as P,r as n}from"./vendor-react-5KxtEOLM.js";import{F as g,m as $,p as f,h as b,g as w,i as v,y as R,a9 as N,aN as E,a_ as T,a6 as U,ab as A,B as l}from"./vendor-ui-CaTPr3iI.js";import{g as B,a as I,d as o}from"./legal-CwbboPqQ.js";import"./vendor-utils-DfRopTPV.js";const O=({status:i})=>{switch(i){case"fully_signed":return e.jsx(w,{className:"w-4 h-4 text-green-500"});case"partially_signed":return e.jsx(b,{className:"w-4 h-4 text-blue-500"});case"pending_signature":return e.jsx(f,{className:"w-4 h-4 text-yellow-500"});case"voided":return e.jsx(v,{className:"w-4 h-4 text-red-500"});default:return e.jsx(g,{className:"w-4 h-4 text-gray-500"})}},z=()=>{const i=P(),[C,_]=n.useState([]),[r,S]=n.useState(null),[u,h]=n.useState(!0),[x,k]=n.useState(""),[s,c]=n.useState("all"),m=async()=>{h(!0);try{const[t,a]=await Promise.all([o.list(s==="all"?void 0:s),o.getStats()]);_(t),S(a)}catch(t){l.error("Failed to load documents"),console.error(t)}finally{h(!1)}};n.useEffect(()=>{m()},[s]);const p=C.filter(t=>t.name.toLowerCase().includes(x.toLowerCase())||t.customer_name.toLowerCase().includes(x.toLowerCase())||t.engagement_name.toLowerCase().includes(x.toLowerCase())),D=async t=>{try{await o.sendForSignature(t),l.success("Document sent for signature"),m()}catch{l.error("Failed to send document")}},L=async(t,a)=>{try{const y=await o.downloadPdf(t),j=URL.createObjectURL(y),d=document.createElement("a");d.href=j,d.download=`${a}.pdf`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(j)}catch{l.error("Failed to download PDF")}},F=async t=>{if(confirm("Are you sure you want to delete this document?"))try{await o.delete(t),l.success("Document deleted"),m()}catch{l.error("Failed to delete document")}};return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Legal Documents"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage pre-engagement documents and signatures"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>i("/legal/templates"),className:"px-4 py-2 text-gray-300 hover:text-white border border-gray-600 hover:border-gray-500 rounded-lg transition-colors",children:[e.jsx(g,{className:"w-4 h-4 inline mr-2"}),"Templates"]}),e.jsxs("button",{onClick:()=>i("/legal/documents/new"),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white font-medium rounded-lg transition-colors",children:[e.jsx($,{className:"w-4 h-4"}),"New Document"]})]})]}),r&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:`bg-gray-800 border border-gray-700 rounded-lg p-4 cursor-pointer transition-colors ${s==="draft"?"ring-2 ring-cyan-500":"hover:border-gray-600"}`,onClick:()=>c(s==="draft"?"all":"draft"),children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 mb-1",children:[e.jsx(g,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Draft"})]}),e.jsx("p",{className:"text-2xl font-bold text-white",children:r.draft})]}),e.jsxs("div",{className:`bg-gray-800 border border-gray-700 rounded-lg p-4 cursor-pointer transition-colors ${s==="pending_signature"?"ring-2 ring-cyan-500":"hover:border-gray-600"}`,onClick:()=>c(s==="pending_signature"?"all":"pending_signature"),children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-400 mb-1",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Pending"})]}),e.jsx("p",{className:"text-2xl font-bold text-white",children:r.pending_signature})]}),e.jsxs("div",{className:`bg-gray-800 border border-gray-700 rounded-lg p-4 cursor-pointer transition-colors ${s==="partially_signed"?"ring-2 ring-cyan-500":"hover:border-gray-600"}`,onClick:()=>c(s==="partially_signed"?"all":"partially_signed"),children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-400 mb-1",children:[e.jsx(b,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Partial"})]}),e.jsx("p",{className:"text-2xl font-bold text-white",children:r.partially_signed})]}),e.jsxs("div",{className:`bg-gray-800 border border-gray-700 rounded-lg p-4 cursor-pointer transition-colors ${s==="fully_signed"?"ring-2 ring-cyan-500":"hover:border-gray-600"}`,onClick:()=>c(s==="fully_signed"?"all":"fully_signed"),children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-400 mb-1",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Signed"})]}),e.jsx("p",{className:"text-2xl font-bold text-white",children:r.fully_signed})]}),e.jsxs("div",{className:`bg-gray-800 border border-gray-700 rounded-lg p-4 cursor-pointer transition-colors ${s==="voided"?"ring-2 ring-cyan-500":"hover:border-gray-600"}`,onClick:()=>c(s==="voided"?"all":"voided"),children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-400 mb-1",children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Voided"})]}),e.jsx("p",{className:"text-2xl font-bold text-white",children:r.voided})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:x,onChange:t=>k(t.target.value),placeholder:"Search documents...",className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500"})]}),e.jsx("button",{onClick:m,className:"p-2 text-gray-400 hover:text-white border border-gray-700 rounded-lg hover:border-gray-600 transition-colors",title:"Refresh",children:e.jsx(N,{className:`w-4 h-4 ${u?"animate-spin":""}`})})]}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900/50",children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Document"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Signatures"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Updated"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:u?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-400",children:[e.jsx(N,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Loading documents..."]})}):p.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-400",children:[e.jsx(g,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"font-medium",children:"No documents found"}),e.jsx("p",{className:"text-sm mt-1",children:"Create a new document to get started"})]})}):p.map(t=>{const a=B(t.status);return e.jsxs("tr",{className:"hover:bg-gray-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:t.engagement_name})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-gray-300 text-sm",children:I(t.document_type)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-gray-300 text-sm",children:t.customer_name})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{status:t.status}),e.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded ${a.color}`,children:a.label})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"text-gray-300 text-sm",children:[t.signed_count,"/",t.signature_count]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-gray-400 text-sm",children:new Date(t.updated_at).toLocaleDateString()})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>i(`/legal/documents/${t.id}`),className:"p-2 text-gray-400 hover:text-white transition-colors",title:"View",children:e.jsx(E,{className:"w-4 h-4"})}),t.status==="draft"&&t.signature_count>0&&e.jsx("button",{onClick:()=>D(t.id),className:"p-2 text-cyan-400 hover:text-cyan-300 transition-colors",title:"Send for Signature",children:e.jsx(T,{className:"w-4 h-4"})}),t.status==="fully_signed"&&e.jsx("button",{onClick:()=>L(t.id,t.name),className:"p-2 text-green-400 hover:text-green-300 transition-colors",title:"Download PDF",children:e.jsx(U,{className:"w-4 h-4"})}),t.status==="draft"&&e.jsx("button",{onClick:()=>F(t.id),className:"p-2 text-gray-400 hover:text-red-400 transition-colors",title:"Delete",children:e.jsx(A,{className:"w-4 h-4"})})]})})]},t.id)})})]})})]})};export{z as default};
