import{j as e,u as we}from"./vendor-state-BjT_zREg.js";import{r as n}from"./vendor-react-5KxtEOLM.js";import{L as ke}from"./Layout-hU69iu7X.js";import{B as b,y as K,l as Se,_ as pe,aL as J,a as _e,aq as Ce,aM as Le,ab as Y,S as T,f as Ae,e as Q,p as ge,aN as Re,aO as De,aP as Ue,aQ as Ee,w as Fe,a4 as W,aR as Te,aS as qe,K as ze,U as be,ay as Z,X as Ie,a9 as ee,a6 as Oe,F as se,v as $e,G as te,am as Pe,aT as Be,s as je,z as Me,at as Ke,O as re,V as fe,ar as Qe}from"./vendor-ui-CaTPr3iI.js";import{n as w,o as We,B as D}from"./index--6GUYD2o.js";import{C as k}from"./Card-CV6m9jT5.js";import{B as Ge}from"./Badge-Bi3Nk-Vg.js";import{L as G}from"./LoadingSpinner-DiN0bg1Z.js";import{R as le,p as Ve,o as ne,X as ie,Y as ce,T as de,L as oe,q as xe,B as He,g as me}from"./vendor-charts-Cw33pWBR.js";import{f as Xe,b as he}from"./vendor-utils-DfRopTPV.js";import"./vendor-markdown-BGP8SuZQ.js";const Je=()=>{const[c,j]=n.useState([]),[u,m]=n.useState(!0),[o,g]=n.useState(""),[h,S]=n.useState({}),[p,v]=n.useState(null),[y,l]=n.useState(!1),[r,a]=n.useState([]);n.useEffect(()=>{i(),d()},[]);const i=async()=>{m(!0);try{const t=await w.getUsers();j(t.data)}catch(t){b.error("Failed to load users"),console.error(t)}finally{m(!1)}},d=async()=>{try{const t=await We.listRoleTemplates();a(t.data)}catch(t){console.error("Failed to load role templates:",t)}},N=async(t,x)=>{var _,C;if(confirm(`Are you sure you want to delete user "${x}"? This action cannot be undone.`))try{await w.deleteUser(t),b.success("User deleted successfully"),i()}catch(U){const O=U;b.error(((C=(_=O.response)==null?void 0:_.data)==null?void 0:C.error)||"Failed to delete user")}},R=async t=>{var x,_;try{await w.updateUser(t.id,{is_active:!t.is_active}),b.success(`User ${t.is_active?"deactivated":"activated"} successfully`),i()}catch(C){const U=C;b.error(((_=(x=U.response)==null?void 0:x.data)==null?void 0:_.error)||"Failed to update user")}},L=async t=>{var x,_;try{await w.unlockUser(t),b.success("Account unlocked successfully"),i()}catch(C){const U=C;b.error(((_=(x=U.response)==null?void 0:x.data)==null?void 0:_.error)||"Failed to unlock account")}},B=async(t,x)=>{var _,C;if(confirm("Are you sure you want to remove this role assignment?"))try{await w.removeRoleAssignment(t,x),b.success("Role assignment removed"),i()}catch(U){const O=U;b.error(((C=(_=O.response)==null?void 0:_.data)==null?void 0:C.error)||"Failed to remove role")}},V=t=>{S(x=>({...x,[t]:!x[t]}))},z=c.filter(t=>t.username.toLowerCase().includes(o.toLowerCase())||t.email.toLowerCase().includes(o.toLowerCase())),H=t=>{switch(t.toLowerCase()){case"admin":return e.jsx(J,{className:"h-4 w-4"});case"analyst":return e.jsx(K,{className:"h-4 w-4"});case"engineer":return e.jsx(ze,{className:"h-4 w-4"});case"viewer":return e.jsx(T,{className:"h-4 w-4"});case"auditor":return e.jsx(qe,{className:"h-4 w-4"});case"red_team":return e.jsx(Te,{className:"h-4 w-4"});case"blue_team":return e.jsx(W,{className:"h-4 w-4"});case"yellow_team":return e.jsx(Fe,{className:"h-4 w-4"});case"white_team":return e.jsx(Ee,{className:"h-4 w-4"});case"orange_team":return e.jsx(Ue,{className:"h-4 w-4"});case"green_team":return e.jsx(De,{className:"h-4 w-4"});case"purple_team":return e.jsx(Re,{className:"h-4 w-4"});default:return e.jsx(T,{className:"h-4 w-4"})}},X=t=>{switch(t.toLowerCase()){case"admin":return"text-red-400 bg-red-500/10 border-red-500/30";case"analyst":return"text-blue-400 bg-blue-500/10 border-blue-500/30";case"engineer":return"text-purple-400 bg-purple-500/10 border-purple-500/30";case"manager":return"text-amber-400 bg-amber-500/10 border-amber-500/30";case"auditor":return"text-cyan-400 bg-cyan-500/10 border-cyan-500/30";case"viewer":return"text-slate-400 bg-slate-500/10 border-slate-500/30";case"red_team":return"text-red-400 bg-red-500/10 border-red-500/30";case"blue_team":return"text-blue-400 bg-blue-500/10 border-blue-500/30";case"yellow_team":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/30";case"white_team":return"text-slate-300 bg-slate-500/10 border-slate-500/30";case"orange_team":return"text-orange-400 bg-orange-500/10 border-orange-500/30";case"green_team":return"text-green-400 bg-green-500/10 border-green-500/30";case"purple_team":return"text-purple-400 bg-purple-500/10 border-purple-500/30";default:return"text-green-400 bg-green-500/10 border-green-500/30"}},I=t=>!t.scope_type||t.scope_type==="Organization"?t.organization_name||"System-wide":`${t.scope_name||t.scope_id} (${t.scope_type})`,q=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return u?e.jsx(k,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(G,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(k,{children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search users by username or email...",value:o,onChange:t=>g(t.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})})}),e.jsxs(k,{children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:["Users (",z.length,")"]}),e.jsxs("div",{className:"space-y-2",children:[z.map(t=>e.jsxs("div",{className:"border border-dark-border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-dark-surface hover:bg-dark-hover cursor-pointer",onClick:()=>V(t.id),children:[e.jsx("div",{className:"text-slate-400",children:h[t.id]?e.jsx(Se,{className:"h-5 w-5"}):e.jsx(pe,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-medium text-white",children:t.username}),t.mfa_enabled&&e.jsxs("span",{className:"text-xs text-green-400 flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),"MFA"]}),t.is_locked&&e.jsxs("span",{className:"text-xs text-red-400 flex items-center gap-1",children:[e.jsx(_e,{className:"h-3 w-3"}),"Locked"]})]}),e.jsx("div",{className:"text-sm text-slate-400",children:t.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.permissions_summary.has_admin_role&&e.jsxs("span",{className:"px-2 py-1 text-xs rounded border text-red-400 bg-red-500/10 border-red-500/30 flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),"Admin"]}),e.jsxs("span",{className:"text-sm text-slate-400",children:[t.permissions_summary.role_count," role",t.permissions_summary.role_count!==1?"s":"",t.permissions_summary.organization_count>0&&e.jsxs(e.Fragment,{children:[" in ",t.permissions_summary.organization_count," org",t.permissions_summary.organization_count!==1?"s":""]})]})]}),e.jsx("div",{className:"w-20",children:e.jsx(Ge,{variant:"status",type:t.is_active?"completed":"failed",children:t.is_active?"Active":"Inactive"})}),e.jsxs("div",{className:"flex items-center gap-2",onClick:x=>x.stopPropagation(),children:[t.is_locked&&e.jsx("button",{onClick:()=>L(t.id),className:"p-2 text-amber-400 hover:text-amber-300 transition-colors",title:"Unlock account",children:e.jsx(Ce,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>R(t),className:"p-2 text-slate-400 hover:text-primary transition-colors",title:t.is_active?"Deactivate user":"Activate user",children:e.jsx(Le,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>N(t.id,t.username),className:"p-2 text-slate-400 hover:text-red-400 transition-colors",title:"Delete user",children:e.jsx(Y,{className:"h-4 w-4"})})]})]}),h[t.id]&&e.jsxs("div",{className:"border-t border-dark-border bg-dark-bg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4 text-primary"}),"Role Assignments"]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>{v(t),l(!0)},children:"+ Assign Role"})]}),t.role_assignments.length===0?e.jsx("div",{className:"text-center py-4 text-slate-500",children:"No role assignments. User has no permissions."}):e.jsx("div",{className:"space-y-2",children:t.role_assignments.map(x=>e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-dark-surface rounded-lg border border-dark-border",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded border ${X(x.role_name)}`,children:[H(x.role_name),e.jsx("span",{className:"font-medium",children:x.role_display_name})]}),e.jsx("div",{className:"flex-1 flex items-center gap-2 text-sm text-slate-400",children:x.organization_name?e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:I(x)})]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx("span",{children:"System-wide"})]})}),x.expires_at&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-amber-400",children:[e.jsx(ge,{className:"h-3 w-3"}),"Expires ",q(x.expires_at)]}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Assigned ",q(x.assigned_at),x.assigned_by&&` by ${x.assigned_by}`]}),e.jsx("button",{onClick:()=>B(t.id,x.id),className:"p-1.5 text-slate-500 hover:text-red-400 transition-colors",title:"Remove role assignment",children:e.jsx(Y,{className:"h-4 w-4"})})]},x.id))}),e.jsx("div",{className:"mt-4 pt-4 border-t border-dark-border",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Created:"}),e.jsx("span",{className:"ml-2 text-slate-300",children:q(t.created_at)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"MFA:"}),e.jsx("span",{className:`ml-2 ${t.mfa_enabled?"text-green-400":"text-slate-400"}`,children:t.mfa_enabled?"Enabled":"Disabled"})]}),t.is_locked&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Locked until:"}),e.jsx("span",{className:"ml-2 text-red-400",children:t.locked_until?q(t.locked_until):"Unknown"}),e.jsxs("span",{className:"ml-2 text-slate-500",children:["(",t.failed_attempts," failed attempts)"]})]})]})})]})]},t.id)),z.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No users found matching your search"})]})]}),y&&p&&e.jsx(Ye,{user:p,roleTemplates:r,onClose:()=>{l(!1),v(null)},onAssign:i})]})},Ye=({user:c,roleTemplates:j,onClose:u,onAssign:m})=>{var i;const[o,g]=n.useState(""),[h,S]=n.useState("system"),[p,v]=n.useState(""),[y,l]=n.useState(!1),r=async()=>{var d,N;if(!o){b.error("Please select a role template");return}l(!0);try{await w.assignRoleWithScope(c.id,{role_type:"template",role_id:o,organization_id:h==="system"?"":h,expires_at:p||void 0}),b.success("Role assigned successfully"),m(),u()}catch(R){const L=R;b.error(((N=(d=L.response)==null?void 0:d.data)==null?void 0:N.error)||"Failed to assign role")}finally{l(!1)}},a=j.find(d=>d.id===o);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40",onClick:u}),e.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50 bg-dark-surface border border-dark-border rounded-lg shadow-2xl p-6 w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5 text-primary"}),"Assign Role to ",c.username]}),e.jsx("button",{onClick:u,className:"text-slate-400 hover:text-white transition-colors text-2xl",children:"Ã—"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Role Template"}),e.jsxs("select",{value:o,onChange:d=>g(d.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a role..."}),j.map(d=>e.jsx("option",{value:d.id,children:d.display_name},d.id))]})]}),a&&e.jsxs("div",{className:"p-3 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("div",{className:"text-sm text-slate-300 mb-2",children:a.description||"No description available"}),e.jsxs("div",{className:"text-xs text-slate-500",children:[((i=a.permissions)==null?void 0:i.length)??0," permissions"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Scope"}),e.jsx("select",{value:h,onChange:d=>S(d.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:e.jsx("option",{value:"system",children:"System-wide (all organizations)"})}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Organization-scoped assignments require selecting an organization first"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Expires (optional)"}),e.jsx("input",{type:"date",value:p,onChange:d=>v(d.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Leave empty for permanent assignment"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(D,{variant:"ghost",onClick:u,children:"Cancel"}),e.jsx(D,{variant:"primary",onClick:r,disabled:!o||y,children:y?"Assigning...":"Assign Role"})]})]})]})},Ze=()=>{const[c,j]=n.useState([]),[u,m]=n.useState(!0),[o,g]=n.useState(""),[h,S]=n.useState("all");n.useEffect(()=>{p()},[]);const p=async()=>{m(!0);try{const r=await w.getAllScans();j(r.data)}catch(r){b.error("Failed to load scans"),console.error(r)}finally{m(!1)}},v=async(r,a)=>{var i,d;if(confirm(`Are you sure you want to delete scan "${a}"? This action cannot be undone.`))try{await w.deleteScan(r),b.success("Scan deleted successfully"),p()}catch(N){const R=N;b.error(((d=(i=R.response)==null?void 0:i.data)==null?void 0:d.error)||"Failed to delete scan")}},y=c.filter(r=>{const a=r.name.toLowerCase().includes(o.toLowerCase())||r.targets.toLowerCase().includes(o.toLowerCase()),i=h==="all"||r.status===h;return a&&i}),l=r=>{switch(r){case"completed":return"bg-green-500/20 text-green-400 border-green-500/30";case"running":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"failed":return"bg-red-500/20 text-red-400 border-red-500/30";case"pending":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return u?e.jsx(k,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(G,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(k,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search scans by name or target...",value:o,onChange:r=>g(r.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("select",{value:h,onChange:r=>S(r.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"running",children:"Running"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"})]})]})}),e.jsxs(k,{children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:["All Scans (",y.length,")"]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-border",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Scan Name"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Targets"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"User ID"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Created"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-slate-400",children:"Actions"})]})}),e.jsx("tbody",{children:y.map(r=>e.jsxs("tr",{className:"border-b border-dark-border hover:bg-dark-hover",children:[e.jsx("td",{className:"py-3 px-4 text-white font-medium",children:r.name}),e.jsx("td",{className:"py-3 px-4 text-slate-300 font-mono text-sm",children:r.targets.length>50?`${r.targets.substring(0,50)}...`:r.targets}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded border ${l(r.status)}`,children:r.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm",children:[e.jsx(be,{className:"h-3 w-3"}),r.user_id.substring(0,8),"..."]})}),e.jsx("td",{className:"py-3 px-4 text-slate-400 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-3 w-3"}),new Date(r.created_at).toLocaleString()]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx("button",{onClick:()=>v(r.id,r.name),className:"p-2 text-slate-400 hover:text-red-400 transition-colors",title:"Delete scan",children:e.jsx(Y,{className:"h-4 w-4"})})})})]},r.id))})]}),y.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No scans found matching your filters"})]})]}),e.jsxs(k,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:c.filter(r=>r.status==="completed").length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Completed"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:c.filter(r=>r.status==="running").length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Running"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:c.filter(r=>r.status==="pending").length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Pending"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:c.filter(r=>r.status==="failed").length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Failed"})]})]})]})]})},F=50,es=()=>{const[c,j]=n.useState([]),[u,m]=n.useState(!0),[o,g]=n.useState(!1),[h,S]=n.useState(0),[p,v]=n.useState(0),[y,l]=n.useState(""),[r,a]=n.useState(""),[i,d]=n.useState(""),[N,R]=n.useState(""),[L,B]=n.useState(""),[V,z]=n.useState([]),[H,X]=n.useState([]),[I,q]=n.useState(null);n.useEffect(()=>{(async()=>{try{const[f,A]=await Promise.all([w.getAuditActionTypes(),w.getAuditUsers()]);z(f.data.actions||[]),X(A.data.users||[])}catch(f){console.error("Failed to load filter options:",f)}})()},[]);const t=n.useCallback(async()=>{m(!0);try{const s={limit:F,offset:p};if(r&&(s.action=r),i&&(s.user_id=i),N&&(s.start_date=new Date(N).toISOString()),L){const A=new Date(L);A.setHours(23,59,59,999),s.end_date=A.toISOString()}const f=await w.getAuditLogs(s);j(f.data.logs),S(f.data.total)}catch(s){b.error("Failed to load audit logs"),console.error(s)}finally{m(!1)}},[r,i,N,L,p]);n.useEffect(()=>{t()},[t]),n.useEffect(()=>{v(0)},[r,i,N,L]);const x=async()=>{g(!0);try{const s={};if(r&&(s.action=r),i&&(s.user_id=i),N&&(s.start_date=new Date(N).toISOString()),L){const P=new Date(L);P.setHours(23,59,59,999),s.end_date=P.toISOString()}const f=await w.exportAuditLogs(s),A=new Blob([f.data],{type:"text/csv"}),$=window.URL.createObjectURL(A),E=document.createElement("a");E.href=$,E.download=`audit_logs_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(E),E.click(),document.body.removeChild(E),window.URL.revokeObjectURL($),b.success("Audit logs exported successfully")}catch(s){b.error("Failed to export audit logs"),console.error(s)}finally{g(!1)}},_=()=>{a(""),d(""),R(""),B(""),l(""),v(0)},C=c.filter(s=>{var A,$,E,P;if(!y)return!0;const f=y.toLowerCase();return s.action.toLowerCase().includes(f)||((A=s.username)==null?void 0:A.toLowerCase().includes(f))||s.user_id.toLowerCase().includes(f)||(($=s.target_id)==null?void 0:$.toLowerCase().includes(f))||((E=s.target_type)==null?void 0:E.toLowerCase().includes(f))||((P=s.ip_address)==null?void 0:P.toLowerCase().includes(f))}),U=s=>s.includes("create")||s.includes("assigned")||s.includes("enabled")?"bg-green-500/20 text-green-400 border-green-500/30":s.includes("delete")||s.includes("remove")||s.includes("disabled")?"bg-red-500/20 text-red-400 border-red-500/30":s.includes("update")||s.includes("change")?"bg-yellow-500/20 text-yellow-400 border-yellow-500/30":s.includes("login")||s.includes("logout")||s.includes("auth")?"bg-blue-500/20 text-blue-400 border-blue-500/30":s.includes("export")||s.includes("download")?"bg-purple-500/20 text-purple-400 border-purple-500/30":"bg-slate-500/20 text-slate-400 border-slate-500/30",O=s=>{switch(s.split(".")[0]){case"auth":return"ðŸ”";case"user":return"ðŸ‘¤";case"role":return"ðŸ›¡ï¸";case"scan":return"ðŸ”";case"vulnerability":return"âš ï¸";case"report":return"ðŸ“„";case"template":return"ðŸ“‹";case"settings":return"âš™ï¸";case"api_key":return"ðŸ”‘";case"integration":return"ðŸ”—";case"compliance":return"âœ…";case"vpn":return"ðŸ”’";case"mfa":return"ðŸ“±";case"account":return"ðŸ‘¤";default:return"ðŸ“"}},Ne=s=>s.split(".").map(f=>f.split("_").map(A=>A.charAt(0).toUpperCase()+A.slice(1)).join(" ")).join(" - "),ae=Math.ceil(h/F),ye=Math.floor(p/F)+1,ve=r||i||N||L;return u&&c.length===0?e.jsx(k,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(G,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(k,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-[200px] relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search within results...",value:y,onChange:s=>l(s.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("select",{value:r,onChange:s=>a(s.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent min-w-[150px]",children:[e.jsx("option",{value:"",children:"All Actions"}),V.map(s=>e.jsx("option",{value:s,children:s.charAt(0).toUpperCase()+s.slice(1).replace("_"," ")},s))]}),e.jsxs("select",{value:i,onChange:s=>d(s.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent min-w-[150px]",children:[e.jsx("option",{value:"",children:"All Users"}),H.map(s=>e.jsx("option",{value:s.id,children:s.username},s.id))]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-slate-400"}),e.jsx("input",{type:"date",value:N,onChange:s=>R(s.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Start Date"}),e.jsx("span",{className:"text-slate-400",children:"to"}),e.jsx("input",{type:"date",value:L,onChange:s=>B(s.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"End Date"})]}),e.jsx("div",{className:"flex-1"}),ve&&e.jsxs(D,{variant:"ghost",size:"sm",onClick:_,children:[e.jsx(Ie,{className:"h-4 w-4 mr-1"}),"Clear Filters"]}),e.jsxs(D,{variant:"ghost",size:"sm",onClick:t,disabled:u,children:[e.jsx(ee,{className:`h-4 w-4 mr-1 ${u?"animate-spin":""}`}),"Refresh"]}),e.jsxs(D,{variant:"secondary",size:"sm",onClick:x,disabled:o||h===0,children:[e.jsx(Oe,{className:"h-4 w-4 mr-1"}),o?"Exporting...":"Export CSV"]})]})]})}),e.jsxs(k,{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h3",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5"}),"Audit Logs",e.jsxs("span",{className:"text-sm font-normal text-slate-400",children:["(",C.length," of ",h," total)"]})]})}),e.jsxs("div",{className:"space-y-2",children:[C.map(s=>e.jsxs("div",{className:`bg-dark-bg border rounded-lg transition-all ${I===s.id?"border-primary/50":"border-dark-border hover:border-primary/30"}`,children:[e.jsx("div",{className:"p-4 cursor-pointer",onClick:()=>q(I===s.id?null:s.id),children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-lg",children:O(s.action)}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded border ${U(s.action)}`,children:Ne(s.action)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(be,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"text-slate-500",children:"User:"}),e.jsx("span",{className:"font-medium text-slate-300 truncate",children:s.username||s.user_id.substring(0,8)+"..."})]}),s.target_type&&s.target_id&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx($e,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"text-slate-500",children:"Target:"}),e.jsxs("span",{className:"font-mono text-slate-300 truncate",children:[s.target_type,":",s.target_id.substring(0,8),"..."]})]}),s.ip_address&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(te,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"text-slate-500",children:"IP:"}),e.jsx("span",{className:"font-mono text-slate-300",children:s.ip_address})]}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(Z,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"text-slate-300",children:new Date(s.created_at).toLocaleString()})]})]})]})})}),I===s.id&&e.jsx("div",{className:"px-4 pb-4 pt-0 border-t border-dark-border mt-2",children:e.jsxs("div",{className:"mt-3 space-y-3",children:[s.user_agent&&e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(Pe,{className:"h-4 w-4 text-slate-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"User Agent:"}),e.jsx("p",{className:"text-slate-400 text-xs mt-1 break-all",children:s.user_agent})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"User ID:"}),e.jsx("p",{className:"font-mono text-slate-400 text-xs mt-1",children:s.user_id})]}),s.target_id&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Resource ID:"}),e.jsx("p",{className:"font-mono text-slate-400 text-xs mt-1",children:s.target_id})]})]}),s.details&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 text-sm",children:"Details:"}),e.jsx("pre",{className:"mt-2 p-3 bg-dark-surface rounded text-slate-400 text-xs overflow-x-auto max-h-48",children:(()=>{try{return JSON.stringify(JSON.parse(s.details),null,2)}catch{return s.details}})()})]})]})})]},s.id)),C.length===0&&!u&&e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx(se,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No audit logs found matching your filters"})]})]}),ae>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-dark-border",children:[e.jsxs("div",{className:"text-sm text-slate-400",children:["Showing ",p+1,"-",Math.min(p+F,h)," of ",h," entries"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(D,{variant:"ghost",size:"sm",onClick:()=>v(Math.max(0,p-F)),disabled:p===0||u,children:[e.jsx(Be,{className:"h-4 w-4"}),"Previous"]}),e.jsxs("span",{className:"text-sm text-slate-400",children:["Page ",ye," of ",ae]}),e.jsxs(D,{variant:"ghost",size:"sm",onClick:()=>v(p+F),disabled:p+F>=h||u,children:["Next",e.jsx(pe,{className:"h-4 w-4"})]})]})]})]}),e.jsxs(k,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Quick Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:c.filter(s=>s.action.startsWith("auth.")).length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Auth Events"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:c.filter(s=>s.action.includes("create")||s.action.includes("assigned")).length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Created/Assigned"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:c.filter(s=>s.action.includes("update")||s.action.includes("change")).length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Updated"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:c.filter(s=>s.action.includes("delete")||s.action.includes("remove")).length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Deleted/Removed"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:h}),e.jsx("div",{className:"text-sm text-slate-400",children:"Total Actions"})]})]})]})]})},ss=()=>{const[c,j]=n.useState([]),[u,m]=n.useState(!0),[o,g]=n.useState({}),[h,S]=n.useState({});n.useEffect(()=>{p()},[]);const p=async()=>{m(!0);try{const a=await w.getSettings();j(a.data);const i={};a.data.forEach(d=>{i[d.key]=d.value}),g(i)}catch(a){b.error("Failed to load settings"),console.error(a)}finally{m(!1)}},v=async a=>{var i,d;S({...h,[a]:!0});try{await w.updateSetting(a,o[a]),b.success(`Setting "${a}" updated successfully`),p()}catch(N){const R=N;b.error(((d=(i=R.response)==null?void 0:i.data)==null?void 0:d.error)||"Failed to update setting")}finally{S({...h,[a]:!1})}},y=a=>{const i=c.find(d=>d.key===a);i&&g({...o,[a]:i.value})},l=a=>{const i=c.find(d=>d.key===a);return i&&o[a]!==i.value},r=a=>a.includes("scan")?"ðŸ”":a.includes("user")?"ðŸ‘¤":a.includes("retention")?"ðŸ—“ï¸":a.includes("registration")?"ðŸ“":"âš™ï¸";return u?e.jsx(k,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(G,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(k,{children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:[e.jsx(je,{className:"inline h-5 w-5 mr-2"}),"System Settings (",c.length,")"]}),e.jsxs("div",{className:"space-y-4",children:[c.map(a=>e.jsx("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:r(a.key)}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:a.key}),a.description&&e.jsx("p",{className:"text-sm text-slate-400",children:a.description})]})]}),e.jsx("div",{className:"mt-3",children:a.key==="allow_registration"?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o[a.key]==="true",onChange:i=>g({...o,[a.key]:i.target.checked?"true":"false"}),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-dark-surface peer-focus:ring-2 peer-focus:ring-primary rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"})]}),e.jsx("span",{className:"text-sm text-slate-400",children:o[a.key]==="true"?"Enabled":"Disabled"})]}):e.jsx("input",{type:a.key.includes("days")?"number":"text",value:o[a.key]||"",onChange:i=>g({...o,[a.key]:i.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})}),e.jsxs("div",{className:"mt-3 flex items-center gap-4 text-xs text-slate-500",children:[a.updated_by&&e.jsxs("span",{children:["Last updated by: ",e.jsxs("span",{className:"font-mono",children:[a.updated_by.substring(0,8),"..."]})]}),a.updated_at&&e.jsx("span",{children:new Date(a.updated_at).toLocaleString()})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(D,{onClick:()=>v(a.key),disabled:!l(a.key)||h[a.key],variant:"primary",size:"sm",children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),h[a.key]?"Saving...":"Save"]}),l(a.key)&&e.jsxs(D,{onClick:()=>y(a.key),variant:"secondary",size:"sm",children:[e.jsx(Ke,{className:"h-4 w-4 mr-1"}),"Reset"]})]})]})},a.key)),c.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No system settings configured"})]})]}),e.jsxs(k,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"â„¹ï¸ Information"}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-400",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-white",children:"max_scans_per_user:"})," Maximum number of scans each user can create. Set to 0 for unlimited."]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-white",children:"scan_retention_days:"})," Automatically delete scans older than this many days. Set to 0 to disable auto-deletion."]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-white",children:"allow_registration:"})," Whether new users can register accounts. Disable this to restrict new registrations."]})]})]})]})},ts=()=>{const{data:c,isLoading:j,error:u,refetch:m}=we({queryKey:["rateLimitDashboard"],queryFn:async()=>(await w.getRateLimitDashboard()).data,refetchInterval:3e4});if(j)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(ee,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{children:"Loading rate limit data..."})]})});if(u)return e.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4 text-red-400",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5"}),e.jsx("span",{children:"Failed to load rate limit data"})]})});if(!c)return null;const{configs:o,summary:g,recent_events:h,top_ips:S,requests_over_time:p}=c,v=p.map(l=>({time:Xe(new Date(l.timestamp),"HH:mm"),total:l.total_requests,blocked:l.blocked_requests})),y=Object.entries(g.requests_by_category).map(([l,r])=>({category:l.charAt(0).toUpperCase()+l.slice(1),requests:r,blocked:g.blocked_by_category[l]||0}));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Rate Limit Dashboard"}),e.jsxs("span",{className:"flex items-center gap-1.5 px-2 py-0.5 text-xs font-medium text-green-400 bg-green-500/10 border border-green-500/30 rounded-full",children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-green-500"})]}),"Live"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Auto-refresh: 30s"}),e.jsxs("button",{onClick:()=>m(),className:`flex items-center gap-2 px-3 py-1.5 text-sm text-slate-400 hover:text-white
                       bg-dark-card border border-dark-border rounded-lg transition-colors hover:border-primary/50`,children:[e.jsx(ee,{className:"h-4 w-4"}),"Refresh"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(M,{icon:fe,label:"Total Requests (24h)",value:g.total_requests_24h.toLocaleString(),color:"text-cyan-400"}),e.jsx(M,{icon:W,label:"Blocked Requests (24h)",value:g.blocked_requests_24h.toLocaleString(),color:"text-red-400"}),e.jsx(M,{icon:Qe,label:"Block Rate",value:`${g.block_rate_percent.toFixed(2)}%`,color:g.block_rate_percent>5?"text-yellow-400":"text-green-400"}),e.jsx(M,{icon:Q,label:"Unique IPs (24h)",value:g.unique_ips_24h.toLocaleString(),color:"text-purple-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-400 mb-4",children:"Requests Over Time (24h)"}),e.jsx("div",{className:"h-64",children:e.jsx(le,{width:"100%",height:"100%",children:e.jsxs(Ve,{data:v,children:[e.jsx(ne,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(ie,{dataKey:"time",stroke:"#9ca3af",fontSize:12,tickLine:!1}),e.jsx(ce,{stroke:"#9ca3af",fontSize:12,tickLine:!1}),e.jsx(de,{contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"8px"},labelStyle:{color:"#fff"}}),e.jsx(oe,{}),e.jsx(xe,{type:"monotone",dataKey:"total",name:"Total Requests",stroke:"#06b6d4",strokeWidth:2,dot:!1}),e.jsx(xe,{type:"monotone",dataKey:"blocked",name:"Blocked",stroke:"#ef4444",strokeWidth:2,dot:!1})]})})})]}),e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-400 mb-4",children:"Requests by Category"}),e.jsx("div",{className:"h-64",children:e.jsx(le,{width:"100%",height:"100%",children:e.jsxs(He,{data:y,children:[e.jsx(ne,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(ie,{dataKey:"category",stroke:"#9ca3af",fontSize:12,tickLine:!1}),e.jsx(ce,{stroke:"#9ca3af",fontSize:12,tickLine:!1}),e.jsx(de,{contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"8px"},labelStyle:{color:"#fff"}}),e.jsx(oe,{}),e.jsx(me,{dataKey:"requests",name:"Total Requests",fill:"#06b6d4"}),e.jsx(me,{dataKey:"blocked",name:"Blocked",fill:"#ef4444"})]})})})]})]}),e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg p-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-400 mb-4 flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),"Rate Limit Rules"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-border",children:[e.jsx("th",{className:"px-4 py-2 text-left text-slate-400 font-medium",children:"Category"}),e.jsx("th",{className:"px-4 py-2 text-left text-slate-400 font-medium",children:"Limit"}),e.jsx("th",{className:"px-4 py-2 text-left text-slate-400 font-medium",children:"Burst Size"}),e.jsx("th",{className:"px-4 py-2 text-left text-slate-400 font-medium",children:"Description"})]})}),e.jsx("tbody",{children:o.map(l=>e.jsxs("tr",{className:"border-b border-dark-border/50 hover:bg-dark-bg/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ue,{category:l.category}),e.jsx("span",{className:"text-white font-medium",children:l.name})]})}),e.jsxs("td",{className:"px-4 py-3 text-slate-300",children:[l.requests_per_period," / ",l.period]}),e.jsx("td",{className:"px-4 py-3 text-slate-300",children:l.burst_size}),e.jsx("td",{className:"px-4 py-3 text-slate-400",children:l.description})]},l.category))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg p-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-400 mb-4 flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4 text-red-400"}),"Recent Blocked Requests"]}),h.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-500",children:[e.jsx(T,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No blocked requests in the last 24 hours"})]}):e.jsx("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:h.slice(0,20).map(l=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-dark-bg rounded border border-dark-border/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{category:l.category,size:"sm"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-3 w-3 text-slate-500"}),e.jsx("span",{className:"text-white font-mono text-sm",children:l.ip})]}),e.jsx("div",{className:"text-xs text-slate-500 truncate max-w-[200px]",children:l.endpoint})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-xs text-slate-400 flex items-center gap-1",children:[e.jsx(ge,{className:"h-3 w-3"}),he(new Date(l.timestamp),{addSuffix:!0})]})})]},l.id))})]}),e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg p-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-400 mb-4 flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"Top Requesting IPs (24h)"]}),S.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-500",children:[e.jsx(te,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No request data available"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-border",children:[e.jsx("th",{className:"px-3 py-2 text-left text-slate-400 font-medium",children:"IP Address"}),e.jsx("th",{className:"px-3 py-2 text-right text-slate-400 font-medium",children:"Requests"}),e.jsx("th",{className:"px-3 py-2 text-right text-slate-400 font-medium",children:"Blocked"}),e.jsx("th",{className:"px-3 py-2 text-right text-slate-400 font-medium",children:"Last Seen"})]})}),e.jsx("tbody",{children:S.slice(0,10).map(l=>e.jsxs("tr",{className:"border-b border-dark-border/50 hover:bg-dark-bg/50",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:"font-mono text-white",children:l.ip})}),e.jsx("td",{className:"px-3 py-2 text-right text-slate-300",children:l.total_requests.toLocaleString()}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx("span",{className:l.blocked_requests>0?"text-red-400":"text-slate-500",children:l.blocked_requests.toLocaleString()})}),e.jsx("td",{className:"px-3 py-2 text-right text-slate-400 text-xs",children:he(new Date(l.last_seen),{addSuffix:!0})})]},l.ip))})]})})]})]})]})},M=({icon:c,label:j,value:u,color:m})=>e.jsx("div",{className:"bg-dark-card border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-dark-bg ${m}`,children:e.jsx(c,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-400",children:j}),e.jsx("p",{className:`text-xl font-bold ${m}`,children:u})]})]})}),ue=({category:c,size:j="md"})=>{const u={auth:"bg-purple-500/20 text-purple-400 border-purple-500/30",api:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30",scan:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30"},m=j==="sm"?"px-1.5 py-0.5 text-xs":"px-2 py-1 text-xs";return e.jsx("span",{className:`inline-flex items-center rounded border font-medium uppercase ${u[c]||"bg-slate-500/20 text-slate-400 border-slate-500/30"} ${m}`,children:c})},us=()=>{const[c,j]=n.useState("users"),u=[{value:"users",label:"Users",icon:Q},{value:"scans",label:"Scans",icon:fe},{value:"audit",label:"Audit Logs",icon:se},{value:"rate-limits",label:"Rate Limits",icon:W},{value:"settings",label:"Settings",icon:je}];return e.jsx(ke,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(T,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Admin Console"}),e.jsx("p",{className:"text-slate-400",children:"Manage users, scans, and system settings"})]})]}),e.jsx("div",{className:"border-b border-dark-border",children:e.jsx("div",{className:"flex gap-1",children:u.map(m=>{const o=m.icon;return e.jsxs("button",{onClick:()=>j(m.value),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${c===m.value?"border-primary text-primary font-medium":"border-transparent text-slate-400 hover:text-white hover:border-slate-600"}`,children:[e.jsx(o,{className:"h-4 w-4"}),m.label]},m.value)})})}),e.jsxs("div",{className:"animate-fadeIn",children:[c==="users"&&e.jsx(Je,{}),c==="scans"&&e.jsx(Ze,{}),c==="audit"&&e.jsx(es,{}),c==="rate-limits"&&e.jsx(ts,{}),c==="settings"&&e.jsx(ss,{})]})]})})};export{us as default};
