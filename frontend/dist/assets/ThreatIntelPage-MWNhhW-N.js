import{j as e,u as N,b as T,d as v}from"./vendor-state-DdX3IZQk.js";import{r as y}from"./vendor-react-Da1CiaFS.js";import{S as O,ab as Q,H as k,v as M,a8 as I,l as D,Z as A,aJ as f,bd as R,G as $,V as K,T as U,B as u,P as q,E as F,aI as X,bf as z,m as L,bU as E,aA as V,ai as w,bb as H,d as G,ax as J,aF as Z}from"./vendor-ui-Bpofv04e.js";import{d as Y,ah as b}from"./index-CQBi_zXi.js";import"./vendor-charts-DIEgeIZG.js";function ye(){const[s,g]=y.useState("dashboard"),a=[{id:"dashboard",label:"Dashboard",icon:Q},{id:"misp",label:"MISP",icon:k},{id:"taxii",label:"TAXII",icon:M},{id:"stix",label:"STIX Objects",icon:I},{id:"actors",label:"Threat Actors",icon:D},{id:"correlate",label:"IOC Correlation",icon:A}];return e.jsx(Y,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(O,{className:"h-7 w-7 text-cyan-400"}),"Threat Intelligence"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage MISP, TAXII feeds, STIX objects, and threat actor intelligence"})]})}),e.jsx("div",{className:"flex space-x-1 mb-6 bg-gray-800 rounded-lg p-1 w-fit",children:a.map(d=>e.jsxs("button",{onClick:()=>g(d.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${s===d.id?"bg-cyan-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:[e.jsx(d.icon,{className:"h-4 w-4"}),d.label]},d.id))}),s==="dashboard"&&e.jsx(W,{}),s==="misp"&&e.jsx(ee,{}),s==="taxii"&&e.jsx(ae,{}),s==="stix"&&e.jsx(ie,{}),s==="actors"&&e.jsx(de,{}),s==="correlate"&&e.jsx(xe,{})]})})}function W(){var d,x,m,i,n,r,o,j,h;const{data:s,isLoading:g}=N({queryKey:["threat-intel-stats"],queryFn:()=>b.getStats()});if(g)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(f,{className:"h-8 w-8 text-cyan-400 animate-spin"})});const a=[{label:"MISP Servers",value:((d=s==null?void 0:s.data)==null?void 0:d.misp_servers)||0,icon:k,color:"cyan"},{label:"MISP Events",value:((x=s==null?void 0:s.data)==null?void 0:x.misp_events)||0,icon:I,color:"blue"},{label:"MISP Attributes",value:((m=s==null?void 0:s.data)==null?void 0:m.misp_attributes)||0,icon:R,color:"purple"},{label:"TAXII Servers",value:((i=s==null?void 0:s.data)==null?void 0:i.taxii_servers)||0,icon:M,color:"green"},{label:"TAXII Collections",value:((n=s==null?void 0:s.data)==null?void 0:n.taxii_collections)||0,icon:$,color:"yellow"},{label:"STIX Bundles",value:((r=s==null?void 0:s.data)==null?void 0:r.stix_bundles)||0,icon:I,color:"orange"},{label:"STIX Objects",value:((o=s==null?void 0:s.data)==null?void 0:o.stix_objects)||0,icon:K,color:"red"},{label:"Threat Actors",value:((j=s==null?void 0:s.data)==null?void 0:j.threat_actors)||0,icon:D,color:"pink"},{label:"Campaigns",value:((h=s==null?void 0:s.data)==null?void 0:h.campaigns)||0,icon:U,color:"indigo"}];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:a.map(t=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(t.icon,{className:`h-5 w-5 text-${t.color}-400`}),e.jsx("span",{className:"text-2xl font-bold text-white",children:t.value})]}),e.jsx("p",{className:"text-sm text-gray-400",children:t.label})]},t.label))})}function ee(){var C,p;const s=T(),[g,a]=y.useState(!1),[d,x]=y.useState(null),[m,i]=y.useState(null),{data:n,isLoading:r}=N({queryKey:["misp-servers"],queryFn:()=>b.listMispServers()}),{data:o,isLoading:j}=N({queryKey:["misp-events"],queryFn:()=>b.listMispEvents({limit:50})}),h=v({mutationFn:c=>b.addMispServer(c),onSuccess:()=>{s.invalidateQueries({queryKey:["misp-servers"]}),a(!1),u.success("MISP server added successfully")},onError:()=>u.error("Failed to add MISP server")}),t=v({mutationFn:c=>b.deleteMispServer(c),onSuccess:()=>{s.invalidateQueries({queryKey:["misp-servers"]}),u.success("MISP server deleted")},onError:()=>u.error("Failed to delete MISP server")}),l=v({mutationFn:c=>b.testMispServer(c),onSuccess:c=>{c.data.success?u.success("Connection successful"):u.error(c.data.message||"Connection failed")},onError:()=>u.error("Connection test failed")}),S=v({mutationFn:c=>b.syncMispServer(c),onSuccess:c=>{s.invalidateQueries({queryKey:["misp-servers"]}),s.invalidateQueries({queryKey:["misp-events"]}),c.data.success?u.success(`Synced ${c.data.events_synced||0} events`):u.error(c.data.message||"Sync failed")},onError:()=>u.error("Sync failed")});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5 text-cyan-400"}),"MISP Servers"]}),e.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg text-sm",children:[e.jsx(q,{className:"h-4 w-4"}),"Add Server"]})]}),e.jsx("div",{className:"p-4",children:r?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(f,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(C=n==null?void 0:n.data)!=null&&C.length?e.jsx("div",{className:"space-y-3",children:n.data.map(c=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${c.enabled?"bg-green-400":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:c.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:c.url})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("p",{className:"text-gray-400",children:["Events: ",c.events_synced]}),c.last_sync_at&&e.jsxs("p",{className:"text-gray-500 text-xs",children:["Last sync: ",new Date(c.last_sync_at).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>l.mutate(c.id),className:"p-1.5 text-gray-400 hover:text-cyan-400",title:"Test Connection",children:e.jsx(A,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>S.mutate(c.id),className:"p-1.5 text-gray-400 hover:text-green-400",title:"Sync Events",children:e.jsx(f,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>x(c),className:"p-1.5 text-gray-400 hover:text-blue-400",title:"View Details",children:e.jsx(F,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>t.mutate(c.id),className:"p-1.5 text-gray-400 hover:text-red-400",title:"Delete",children:e.jsx(X,{className:"h-4 w-4"})})]})]})]},c.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No MISP servers configured"})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5 text-cyan-400"}),"Recent MISP Events"]})}),e.jsx("div",{className:"overflow-x-auto",children:j?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(f,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(p=o==null?void 0:o.data)!=null&&p.length?e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-400 text-sm border-b border-gray-700",children:[e.jsx("th",{className:"p-3",children:"Event"}),e.jsx("th",{className:"p-3",children:"Organization"}),e.jsx("th",{className:"p-3",children:"Threat Level"}),e.jsx("th",{className:"p-3",children:"Attributes"}),e.jsx("th",{className:"p-3",children:"Date"}),e.jsx("th",{className:"p-3",children:"Actions"})]})}),e.jsx("tbody",{children:o.data.map(c=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"p-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium truncate max-w-md",children:c.info}),e.jsx("p",{className:"text-gray-500 text-xs",children:c.misp_uuid})]})}),e.jsx("td",{className:"p-3 text-gray-300",children:c.org_name}),e.jsx("td",{className:"p-3",children:e.jsx(P,{level:c.threat_level})}),e.jsx("td",{className:"p-3 text-gray-300",children:c.attribute_count}),e.jsx("td",{className:"p-3 text-gray-400 text-sm",children:c.date}),e.jsx("td",{className:"p-3",children:e.jsx("button",{onClick:()=>i(c),className:"p-1.5 text-gray-400 hover:text-cyan-400",children:e.jsx(F,{className:"h-4 w-4"})})})]},c.id))})]}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No events synced yet"})})]}),g&&e.jsx(se,{onClose:()=>a(!1),onSubmit:c=>h.mutate(c),isLoading:h.isPending}),m&&e.jsx(te,{event:m,onClose:()=>i(null)})]})}function P({level:s}){const g={1:"bg-red-900 text-red-300",2:"bg-orange-900 text-orange-300",3:"bg-yellow-900 text-yellow-300",4:"bg-gray-700 text-gray-300"},a={1:"High",2:"Medium",3:"Low",4:"Undefined"};return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${g[s]||g[4]}`,children:a[s]||"Unknown"})}function se({onClose:s,onSubmit:g,isLoading:a}){const[d,x]=y.useState(""),[m,i]=y.useState(""),[n,r]=y.useState("");return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-md border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Add MISP Server"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(w,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Server Name"}),e.jsx("input",{type:"text",value:d,onChange:o=>x(o.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"My MISP Server"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"URL"}),e.jsx("input",{type:"url",value:m,onChange:o=>i(o.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"https://misp.example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"API Key"}),e.jsx("input",{type:"password",value:n,onChange:o=>r(o.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"MISP API Key"})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-400 hover:text-white",children:"Cancel"}),e.jsx("button",{onClick:()=>g({name:d,url:m,api_key:n}),disabled:a||!d||!m||!n,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:a?"Adding...":"Add Server"})]})]})})}function te({event:s,onClose:g}){var d;const{data:a}=N({queryKey:["misp-event-attributes",s.id],queryFn:()=>b.getMispEventAttributes(s.id)});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-4xl max-h-[80vh] overflow-hidden border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.info}),e.jsx("p",{className:"text-gray-400 text-sm",children:s.misp_uuid})]}),e.jsx("button",{onClick:g,className:"text-gray-400 hover:text-white",children:e.jsx(w,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Organization"}),e.jsx("p",{className:"text-white",children:s.org_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Date"}),e.jsx("p",{className:"text-white",children:s.date})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Threat Level"}),e.jsx(P,{level:s.threat_level})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Published"}),e.jsx("p",{className:"text-white",children:s.published?"Yes":"No"})]})]}),s.tags.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map((x,m)=>e.jsx("span",{className:"px-2 py-1 bg-gray-700 rounded text-xs text-gray-300",children:x},m))})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-400 text-sm mb-2",children:["Attributes (",s.attribute_count,")"]}),(d=a==null?void 0:a.data)!=null&&d.length?e.jsxs("div",{className:"space-y-2",children:[a.data.slice(0,20).map(x=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-900 rounded",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:x.attr_type}),e.jsx("span",{className:"text-gray-300 font-mono text-sm truncate",children:x.value}),x.to_ids&&e.jsx("span",{className:"px-2 py-0.5 bg-red-900 text-red-300 rounded text-xs",children:"IDS"})]},x.id)),a.data.length>20&&e.jsxs("p",{className:"text-gray-500 text-sm text-center",children:["And ",a.data.length-20," more..."]})]}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Loading attributes..."})]})]})]})})}function ae(){var j;const s=T(),[g,a]=y.useState(!1),[d,x]=y.useState(null),{data:m,isLoading:i}=N({queryKey:["taxii-servers"],queryFn:()=>b.listTaxiiServers()}),n=v({mutationFn:h=>b.addTaxiiServer(h),onSuccess:()=>{s.invalidateQueries({queryKey:["taxii-servers"]}),a(!1),u.success("TAXII server added successfully")},onError:()=>u.error("Failed to add TAXII server")}),r=v({mutationFn:h=>b.deleteTaxiiServer(h),onSuccess:()=>{s.invalidateQueries({queryKey:["taxii-servers"]}),u.success("TAXII server deleted")},onError:()=>u.error("Failed to delete TAXII server")}),o=v({mutationFn:h=>b.discoverTaxiiCollections(h),onSuccess:(h,t)=>{s.invalidateQueries({queryKey:["taxii-collections",t]}),h.data.success?u.success(`Discovered ${h.data.collections_found||0} collections`):u.error("Discovery failed")},onError:()=>u.error("Discovery failed")});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5 text-cyan-400"}),"TAXII Servers"]}),e.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg text-sm",children:[e.jsx(q,{className:"h-4 w-4"}),"Add Server"]})]}),e.jsx("div",{className:"p-4",children:i?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(f,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(j=m==null?void 0:m.data)!=null&&j.length?e.jsx("div",{className:"space-y-3",children:m.data.map(h=>e.jsx(re,{server:h,expanded:d===h.id,onToggle:()=>x(d===h.id?null:h.id),onDiscover:()=>o.mutate(h.id),onDelete:()=>r.mutate(h.id)},h.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No TAXII servers configured"})})]}),g&&e.jsx(le,{onClose:()=>a(!1),onSubmit:h=>n.mutate(h),isLoading:n.isPending})]})}function re({server:s,expanded:g,onToggle:a,onDiscover:d,onDelete:x}){var r;const m=T(),{data:i}=N({queryKey:["taxii-collections",s.id],queryFn:()=>b.listTaxiiCollections(s.id),enabled:g}),n=v({mutationFn:o=>b.pollTaxiiCollection(s.id,o),onSuccess:o=>{m.invalidateQueries({queryKey:["taxii-collections",s.id]}),o.data.success&&u.success(`Retrieved ${o.data.objects_retrieved||0} objects`)},onError:()=>u.error("Poll failed")});return e.jsxs("div",{className:"bg-gray-900 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 cursor-pointer hover:bg-gray-800",onClick:a,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[g?e.jsx(G,{className:"h-4 w-4 text-gray-400"}):e.jsx(J,{className:"h-4 w-4 text-gray-400"}),e.jsx("div",{className:`w-3 h-3 rounded-full ${s.enabled?"bg-green-400":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:s.url})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-xs text-gray-500 bg-gray-700 px-2 py-1 rounded",children:["TAXII ",s.version]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Objects: ",s.objects_synced]}),e.jsxs("div",{className:"flex items-center gap-2",onClick:o=>o.stopPropagation(),children:[e.jsx("button",{onClick:d,className:"p-1.5 text-gray-400 hover:text-cyan-400",title:"Discover Collections",children:e.jsx(L,{className:"h-4 w-4"})}),e.jsx("button",{onClick:x,className:"p-1.5 text-gray-400 hover:text-red-400",title:"Delete",children:e.jsx(X,{className:"h-4 w-4"})})]})]})]}),g&&e.jsxs("div",{className:"border-t border-gray-700 p-3",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Collections"}),(r=i==null?void 0:i.data)!=null&&r.length?e.jsx("div",{className:"space-y-2",children:i.data.map(o=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-800 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm",children:o.title}),e.jsx("p",{className:"text-gray-500 text-xs",children:o.collection_id})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-gray-400 text-xs",children:[o.objects_count," objects"]}),o.can_read&&e.jsx("button",{onClick:()=>n.mutate(o.collection_id),className:"p-1.5 text-gray-400 hover:text-green-400",title:"Poll Collection",children:e.jsx(Z,{className:"h-4 w-4"})})]})]},o.id))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No collections found. Click discover to fetch."})]})]})}function le({onClose:s,onSubmit:g,isLoading:a}){const[d,x]=y.useState(""),[m,i]=y.useState(""),[n,r]=y.useState(""),[o,j]=y.useState(""),[h,t]=y.useState("2.1");return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-md border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Add TAXII Server"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(w,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Server Name"}),e.jsx("input",{type:"text",value:d,onChange:l=>x(l.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"CIRCL TAXII"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"URL"}),e.jsx("input",{type:"url",value:m,onChange:l=>i(l.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"https://limo.anomali.com/api/v1/taxii2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Version"}),e.jsxs("select",{value:h,onChange:l=>t(l.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"2.1",children:"TAXII 2.1"}),e.jsx("option",{value:"2.0",children:"TAXII 2.0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Username (optional)"}),e.jsx("input",{type:"text",value:n,onChange:l=>r(l.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Password (optional)"}),e.jsx("input",{type:"password",value:o,onChange:l=>j(l.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white"})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-400 hover:text-white",children:"Cancel"}),e.jsx("button",{onClick:()=>g({name:d,url:m,username:n||void 0,password:o||void 0,version:h}),disabled:a||!d||!m,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:a?"Adding...":"Add Server"})]})]})})}function ie(){var h,t;const s=T(),[g,a]=y.useState(!1),[d,x]=y.useState(null),[m,i]=y.useState(""),{data:n,isLoading:r}=N({queryKey:["stix-bundles"],queryFn:()=>b.listStixBundles({limit:50})}),{data:o}=N({queryKey:["stix-objects",m],queryFn:()=>b.listStixObjects({type:m||void 0,limit:100})}),j=["indicator","malware","threat-actor","attack-pattern","campaign","identity","tool","vulnerability"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5 text-cyan-400"}),"STIX Bundles"]}),e.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg text-sm",children:[e.jsx(z,{className:"h-4 w-4"}),"Import Bundle"]})]}),e.jsx("div",{className:"p-4",children:r?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(f,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(h=n==null?void 0:n.data)!=null&&h.length?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.data.map(l=>e.jsxs("div",{className:"p-4 bg-gray-900 rounded-lg cursor-pointer hover:bg-gray-700",onClick:()=>x(l),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"text-white font-medium",children:l.name}),e.jsx("span",{className:"text-xs text-gray-500",children:l.spec_version})]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Source: ",l.source]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[l.objects_count," objects"]}),e.jsx("p",{className:"text-gray-500 text-xs mt-2",children:new Date(l.created_at).toLocaleDateString()})]},l.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No STIX bundles imported"})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-cyan-400"}),"STIX Objects"]}),e.jsxs("select",{value:m,onChange:l=>i(l.target.value),className:"bg-gray-900 border border-gray-600 rounded-lg px-3 py-1.5 text-white text-sm",children:[e.jsx("option",{value:"",children:"All Types"}),j.map(l=>e.jsx("option",{value:l,children:l},l))]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-400 text-sm border-b border-gray-700",children:[e.jsx("th",{className:"p-3",children:"Type"}),e.jsx("th",{className:"p-3",children:"Name"}),e.jsx("th",{className:"p-3",children:"STIX ID"}),e.jsx("th",{className:"p-3",children:"Created"})]})}),e.jsx("tbody",{children:(t=o==null?void 0:o.data)==null?void 0:t.map(l=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"p-3",children:e.jsx("span",{className:"px-2 py-1 bg-cyan-900 text-cyan-300 rounded text-xs",children:l.stix_type})}),e.jsx("td",{className:"p-3 text-white",children:l.name||"-"}),e.jsx("td",{className:"p-3 text-gray-400 font-mono text-xs truncate max-w-xs",children:l.stix_id}),e.jsx("td",{className:"p-3 text-gray-400 text-sm",children:new Date(l.created).toLocaleDateString()})]},l.id))})]})})]}),g&&e.jsx(ne,{onClose:()=>a(!1),onSuccess:()=>{s.invalidateQueries({queryKey:["stix-bundles"]}),s.invalidateQueries({queryKey:["stix-objects"]})}}),d&&e.jsx(ce,{bundle:d,onClose:()=>x(null)})]})}function ne({onClose:s,onSuccess:g}){const[a,d]=y.useState(""),[x,m]=y.useState(""),i=v({mutationFn:n=>b.importStixBundle(n),onSuccess:n=>{n.data.success?(u.success(`Imported ${n.data.objects_imported||0} objects`),g(),s()):u.error("Import failed")},onError:()=>u.error("Import failed")});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-2xl border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Import STIX Bundle"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(w,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Bundle Name"}),e.jsx("input",{type:"text",value:a,onChange:n=>d(n.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"My STIX Bundle"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"STIX 2.1 JSON"}),e.jsx("textarea",{value:x,onChange:n=>m(n.target.value),className:"w-full h-64 bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white font-mono text-sm",placeholder:'{"type": "bundle", "id": "bundle--...", "objects": [...]}'})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-400 hover:text-white",children:"Cancel"}),e.jsx("button",{onClick:()=>i.mutate({name:a,content:x}),disabled:i.isPending||!a||!x,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:i.isPending?"Importing...":"Import"})]})]})})}function ce({bundle:s,onClose:g}){var x,m;const{data:a}=N({queryKey:["stix-bundle-objects",s.id],queryFn:()=>b.getStixBundleObjects(s.id,{limit:100})}),d=(x=a==null?void 0:a.data)==null?void 0:x.reduce((i,n)=>(i[n.stix_type]=(i[n.stix_type]||0)+1,i),{});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-4xl max-h-[80vh] overflow-hidden border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[s.objects_count," objects | STIX ",s.spec_version]})]}),e.jsx("button",{onClick:g,className:"text-gray-400 hover:text-white",children:e.jsx(w,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:[d&&e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"Object Types"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(d).map(([i,n])=>e.jsxs("span",{className:"px-3 py-1 bg-gray-700 rounded-full text-sm text-gray-300",children:[i,": ",n]},i))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"Objects"}),e.jsx("div",{className:"space-y-2",children:(m=a==null?void 0:a.data)==null?void 0:m.slice(0,50).map(i=>e.jsxs("div",{className:"p-3 bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:i.stix_type}),e.jsx("span",{className:"text-gray-500 text-xs",children:i.stix_id})]}),i.name&&e.jsx("p",{className:"text-white",children:i.name}),i.description&&e.jsx("p",{className:"text-gray-400 text-sm mt-1 line-clamp-2",children:i.description})]},i.id))})]})]})]})})}function de(){var h;const[s,g]=y.useState(""),[a,d]=y.useState(null),[x,m]=y.useState({actor_type:"",motivation:"",active_only:!1}),{data:i,isLoading:n}=N({queryKey:["threat-actors",x,s],queryFn:()=>b.listThreatActors({...x,name:s||void 0,limit:50})}),{data:r}=N({queryKey:["threat-actor",a],queryFn:()=>b.getThreatActor(a),enabled:!!a}),o=["espionage","financial","destruction","hacktivism","unknown"],j=["nation-state","crime-syndicate","hacktivist","insider","terrorist"];return e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-1 bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("div",{className:"flex items-center gap-4 mb-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:s,onChange:t=>g(t.target.value),placeholder:"Search threat actors...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg pl-10 pr-3 py-2 text-white"})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:x.actor_type,onChange:t=>m({...x,actor_type:t.target.value}),className:"bg-gray-900 border border-gray-600 rounded-lg px-3 py-1.5 text-white text-sm",children:[e.jsx("option",{value:"",children:"All Types"}),j.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:x.motivation,onChange:t=>m({...x,motivation:t.target.value}),className:"bg-gray-900 border border-gray-600 rounded-lg px-3 py-1.5 text-white text-sm",children:[e.jsx("option",{value:"",children:"All Motivations"}),o.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx("input",{type:"checkbox",checked:x.active_only,onChange:t=>m({...x,active_only:t.target.checked}),className:"rounded border-gray-600"}),"Active only"]})]})]}),e.jsx("div",{className:"overflow-y-auto max-h-[600px]",children:n?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(f,{className:"h-6 w-6 text-cyan-400 animate-spin"})}):(h=i==null?void 0:i.data)!=null&&h.length?e.jsx("div",{className:"divide-y divide-gray-700",children:i.data.map(t=>e.jsxs("div",{className:`p-4 cursor-pointer hover:bg-gray-700/50 ${a===t.id?"bg-gray-700":""}`,onClick:()=>d(t.id),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-white font-medium",children:t.name}),t.active&&e.jsx("span",{className:"px-1.5 py-0.5 bg-green-900 text-green-300 rounded text-xs",children:"Active"})]}),t.aliases.length>0&&e.jsxs("p",{className:"text-gray-500 text-sm",children:["AKA: ",t.aliases.slice(0,3).join(", ")]})]}),e.jsx(_,{level:t.sophistication})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[e.jsx("span",{className:"text-gray-400",children:t.actor_type}),t.country&&e.jsxs("span",{className:"flex items-center gap-1 text-gray-400",children:[e.jsx(E,{className:"h-3 w-3"}),t.country]}),e.jsx("span",{className:"text-gray-400",children:t.motivation})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:t.target_sectors.slice(0,4).map((l,S)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-300",children:l},S))})]},t.id))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No threat actors found"})})]}),a&&(r==null?void 0:r.data)&&e.jsxs("div",{className:"w-96 bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:r.data.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:r.data.actor_type}),r.data.country&&e.jsxs("span",{className:"flex items-center gap-1 text-gray-400 text-sm",children:[e.jsx(E,{className:"h-3 w-3"}),r.data.country]})]})]}),e.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto max-h-[500px]",children:[r.data.description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Description"}),e.jsx("p",{className:"text-gray-300 text-sm",children:r.data.description})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Motivation"}),e.jsx("p",{className:"text-white",children:r.data.motivation})]}),r.data.aliases.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Aliases"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r.data.aliases.map((t,l)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-300",children:t},l))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Sophistication"}),e.jsx(_,{level:r.data.sophistication})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Resource Level"}),e.jsx(_,{level:r.data.resource_level})]})]}),r.data.first_seen&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"First Seen"}),e.jsx("p",{className:"text-white text-sm",children:r.data.first_seen})]}),r.data.last_seen&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Last Seen"}),e.jsx("p",{className:"text-white text-sm",children:r.data.last_seen})]})]}),r.data.target_sectors.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Target Sectors"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r.data.target_sectors.map((t,l)=>e.jsx("span",{className:"px-2 py-0.5 bg-red-900 text-red-300 rounded text-xs",children:t},l))})]}),r.data.ttps.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"TTPs (MITRE ATT&CK)"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r.data.ttps.slice(0,10).map((t,l)=>e.jsx("span",{className:"px-2 py-0.5 bg-purple-900 text-purple-300 rounded text-xs font-mono",children:t},l))})]}),r.data.tools.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Tools"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r.data.tools.map((t,l)=>e.jsx("span",{className:"px-2 py-0.5 bg-blue-900 text-blue-300 rounded text-xs",children:t},l))})]}),r.data.malware.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Malware"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r.data.malware.map((t,l)=>e.jsx("span",{className:"px-2 py-0.5 bg-orange-900 text-orange-300 rounded text-xs",children:t},l))})]}),r.data.external_references.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"References"}),e.jsx("div",{className:"space-y-1",children:r.data.external_references.slice(0,5).map((t,l)=>e.jsxs("a",{href:t.url||"#",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-cyan-400 text-sm hover:underline",children:[e.jsx(V,{className:"h-3 w-3"}),t.source]},l))})]})]})]})]})}function _({level:s}){const g=["bg-gray-700 text-gray-300","bg-green-900 text-green-300","bg-yellow-900 text-yellow-300","bg-orange-900 text-orange-300","bg-red-900 text-red-300"],a=["Minimal","Low","Intermediate","Advanced","Expert"],d=Math.min(Math.max(0,s),4);return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${g[d]}`,children:a[d]})}function xe(){var C;const[s,g]=y.useState("manual"),[a,d]=y.useState([]),[x,m]=y.useState("ip"),[i,n]=y.useState(""),[r,o]=y.useState(""),j=v({mutationFn:p=>b.correlateIocs(p),onSuccess:()=>{u.success("Correlation complete")},onError:()=>u.error("Correlation failed")}),h=()=>{i&&(d([...a,{ioc_type:x,value:i}]),n(""))},t=p=>{d(a.filter((c,B)=>B!==p))},l=()=>{s==="manual"&&a.length>0?j.mutate({iocs:a}):s==="scan"&&r&&j.mutate({scan_id:r})},S=["ip","domain","hash","url","email"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5 text-cyan-400"}),"IOC Correlation"]}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("button",{onClick:()=>g("manual"),className:`px-4 py-2 rounded-lg ${s==="manual"?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Manual IOCs"}),e.jsx("button",{onClick:()=>g("scan"),className:`px-4 py-2 rounded-lg ${s==="scan"?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"From Scan"})]}),s==="manual"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("select",{value:x,onChange:p=>m(p.target.value),className:"bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",children:S.map(p=>e.jsx("option",{value:p,children:p.toUpperCase()},p))}),e.jsx("input",{type:"text",value:i,onChange:p=>n(p.target.value),placeholder:"Enter IOC value...",className:"flex-1 bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white",onKeyDown:p=>p.key==="Enter"&&h()}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg",children:e.jsx(q,{className:"h-4 w-4"})})]}),a.length>0&&e.jsx("div",{className:"space-y-2",children:a.map((p,c)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:p.ioc_type}),e.jsx("span",{className:"text-white font-mono text-sm",children:p.value})]}),e.jsx("button",{onClick:()=>t(c),className:"text-gray-400 hover:text-red-400",children:e.jsx(w,{className:"h-4 w-4"})})]},c))})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Scan ID"}),e.jsx("input",{type:"text",value:r,onChange:p=>o(p.target.value),placeholder:"Enter scan ID to correlate IOCs from...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-2 text-white"})]}),e.jsx("button",{onClick:l,disabled:j.isPending||s==="manual"&&a.length===0||s==="scan"&&!r,className:"mt-6 flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:j.isPending?e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"h-4 w-4 animate-spin"}),"Correlating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-4 w-4"}),"Run Correlation"]})})]}),((C=j.data)==null?void 0:C.data)&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4",children:["Results: ",j.data.data.correlations_found," correlations found"]}),j.data.data.correlations.length===0?e.jsx("p",{className:"text-gray-400",children:"No correlations found in threat intelligence sources."}):e.jsx("div",{className:"space-y-3",children:j.data.data.correlations.map((p,c)=>e.jsxs("div",{className:"p-3 bg-gray-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"px-2 py-0.5 bg-cyan-900 text-cyan-300 rounded text-xs",children:p.ioc_type}),e.jsx("span",{className:"text-white font-mono text-sm",children:p.ioc_value})]}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["Confidence: ",(p.confidence*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-gray-400",children:["Source: ",e.jsx("span",{className:"text-white",children:p.source_type})]}),e.jsxs("span",{className:"text-gray-400",children:["Reference: ",e.jsx("span",{className:"text-white",children:p.source_name})]}),p.threat_level&&e.jsx(P,{level:p.threat_level})]})]},c))})]})]})}export{ye as default};
