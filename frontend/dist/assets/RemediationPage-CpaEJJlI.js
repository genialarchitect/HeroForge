import{j as e}from"./vendor-state-Dv52s5nL.js";import{r as l}from"./vendor-react-BdkUp9lr.js";import{x as S,l as Z,g as U,c as ee}from"./index-mgRulVfg.js";import{B as y}from"./vendor-ui-BqjU7FU2.js";import"./vendor-charts-LMABhejW.js";const te=({scanId:m,onVulnerabilityClick:f})=>{const[o,i]=l.useState([]),[C,v]=l.useState(!0),[d,x]=l.useState(null),[u,g]=l.useState(!1),$=[{id:"open",title:"Open",color:"bg-red-900/20 border-red-700"},{id:"in_progress",title:"In Progress",color:"bg-yellow-900/20 border-yellow-700"},{id:"pending_verification",title:"Pending Verification",color:"bg-blue-900/20 border-blue-700"},{id:"resolved",title:"Resolved",color:"bg-green-900/20 border-green-700"}];l.useEffect(()=>{h()},[m]);const h=async()=>{try{if(v(!0),!m){i([]);return}const a=await S.list({scan_id:m});i(a.data)}catch(a){console.error("Failed to load vulnerabilities:",a)}finally{v(!1)}},j=(a,s)=>{x(s),a.dataTransfer.effectAllowed="move"},N=a=>{a.preventDefault(),a.dataTransfer.dropEffect="move"},w=async(a,s)=>{if(a.preventDefault(),!(!d||d.status===s||u))try{g(!0),await S.update(d.id,{status:s}),await h(),x(null)}catch(_){console.error("Failed to update vulnerability status:",_)}finally{g(!1)}},c=()=>{x(null)},b=a=>o.filter(s=>s.status===a),k=a=>{switch(a.toLowerCase()){case"critical":return"border-l-4 border-red-500";case"high":return"border-l-4 border-orange-500";case"medium":return"border-l-4 border-yellow-500";case"low":return"border-l-4 border-blue-500";default:return"border-l-4 border-gray-500"}},E=a=>{if(!a)return null;const s={critical:"bg-red-600 text-white",high:"bg-orange-600 text-white",medium:"bg-yellow-600 text-white",low:"bg-blue-600 text-white"};return e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${s[a.toLowerCase()]||"bg-gray-600 text-white"}`,children:a.charAt(0).toUpperCase()})};return C?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):m?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Remediation Board"}),e.jsx("button",{onClick:h,className:"px-3 py-1 text-sm bg-gray-700 text-gray-300 rounded hover:bg-gray-600",children:"Refresh"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:$.map(a=>e.jsxs("div",{className:`rounded-lg border-2 ${a.color} p-4 min-h-[400px] transition-colors ${d&&d.status!==a.id?"ring-2 ring-blue-500/50":""}`,onDragOver:N,onDrop:s=>w(s,a.id),children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 text-white flex justify-between items-center",children:[e.jsx("span",{children:a.title}),e.jsx("span",{className:"text-sm font-normal text-gray-400 bg-gray-800 px-2 py-0.5 rounded",children:b(a.id).length})]}),e.jsxs("div",{className:"space-y-2",children:[b(a.id).map(s=>e.jsxs("div",{draggable:!u,onDragStart:_=>j(_,s),onDragEnd:c,onClick:()=>f==null?void 0:f(s.id),className:`bg-gray-800 p-3 rounded shadow cursor-move hover:shadow-lg hover:bg-gray-750 transition-all ${k(s.severity)} ${(d==null?void 0:d.id)===s.id?"opacity-50":""} ${u?"cursor-not-allowed":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsx("div",{className:"font-medium text-sm text-white truncate flex-1",children:s.vulnerability_id}),E(s.priority)]}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:s.host_ip}),s.port&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Port: ",s.port]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${s.severity==="critical"?"bg-red-900/50 text-red-300":s.severity==="high"?"bg-orange-900/50 text-orange-300":s.severity==="medium"?"bg-yellow-900/50 text-yellow-300":"bg-blue-900/50 text-blue-300"}`,children:s.severity}),s.assignee_id&&e.jsx("span",{className:"text-xs text-gray-500",children:"Assigned"})]}),s.due_date&&e.jsxs("div",{className:`text-xs mt-1 ${new Date(s.due_date)<new Date?"text-red-400":"text-gray-500"}`,children:["Due: ",new Date(s.due_date).toLocaleDateString()]}),s.estimated_effort&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Est: ",s.estimated_effort,"h",s.actual_effort?` / Actual: ${s.actual_effort}h`:""]})]},s.id)),b(a.id).length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500 text-sm",children:"No vulnerabilities"})]})]},a.id))}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-400 pt-4 border-t border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),e.jsx("span",{children:"Critical"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded"}),e.jsx("span",{children:"High"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded"}),e.jsx("span",{children:"Medium"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),e.jsx("span",{children:"Low"})]})]})]}):e.jsx("div",{className:"text-center py-12 text-gray-400",children:"Select a scan to view the remediation board"})},se=({vulnerabilityId:m,onClose:f,onUpdate:o})=>{const[i,C]=l.useState(null),[v,d]=l.useState(!0),[x,u]=l.useState(!1),[g,$]=l.useState("info"),[h,j]=l.useState(""),[N,w]=l.useState(""),[c,b]=l.useState(""),[k,E]=l.useState(""),[a,s]=l.useState(""),[_,P]=l.useState(""),[F,T]=l.useState(""),[p,D]=l.useState(!1),[V,I]=l.useState(!1);l.useEffect(()=>{R()},[m]);const R=async()=>{try{d(!0);const t=await S.get(m);C(t.data),j(t.data.vulnerability.status),w(t.data.vulnerability.priority||"medium"),b(t.data.vulnerability.notes||""),E(t.data.vulnerability.remediation_steps||""),s(t.data.vulnerability.estimated_effort||""),P(t.data.vulnerability.actual_effort||"")}catch(t){console.error("Failed to load vulnerability detail:",t)}finally{d(!1)}},B=async()=>{if(i)try{D(!0),await S.update(m,{status:h!==i.vulnerability.status?h:void 0,priority:N!==(i.vulnerability.priority||"medium")?N:void 0,notes:c!==(i.vulnerability.notes||"")?c:void 0,remediation_steps:k!==(i.vulnerability.remediation_steps||"")?k:void 0,estimated_effort:typeof a=="number"?a:void 0,actual_effort:typeof _=="number"?_:void 0}),y.success("Vulnerability updated successfully"),await R(),u(!1),o==null||o()}catch(t){console.error("Failed to update vulnerability:",t),y.error("Failed to update vulnerability")}finally{D(!1)}},z=async()=>{try{D(!0),await S.markForVerification(m,{}),y.success("Vulnerability marked for verification"),await R(),o==null||o()}catch(t){console.error("Failed to mark for verification:",t),y.error("Failed to mark for verification")}finally{D(!1)}},W=async t=>{if(t.preventDefault(),!!F.trim())try{D(!0),await S.addComment(m,F),T(""),y.success("Comment added"),await R()}catch(n){console.error("Failed to add comment:",n),y.error("Failed to add comment")}finally{D(!1)}},K=async()=>{var t,n;if(i){I(!0);try{const L=await Z.createTicket(m);y.success(`JIRA ticket ${L.data.jira_ticket_key} created successfully!`),await R(),o==null||o()}catch(L){console.error("Failed to create JIRA ticket:",L),y.error(((n=(t=L.response)==null?void 0:t.data)==null?void 0:n.error)||"Failed to create JIRA ticket")}finally{I(!1)}}},J=()=>{i&&(u(!1),j(i.vulnerability.status),w(i.vulnerability.priority||"medium"),b(i.vulnerability.notes||""),E(i.vulnerability.remediation_steps||""),s(i.vulnerability.estimated_effort||""),P(i.vulnerability.actual_effort||""))},q=t=>{const n="px-3 py-1 text-sm font-semibold rounded-full";switch(t.toLowerCase()){case"critical":return`${n} bg-red-900/50 text-red-300`;case"high":return`${n} bg-orange-900/50 text-orange-300`;case"medium":return`${n} bg-yellow-900/50 text-yellow-300`;case"low":return`${n} bg-blue-900/50 text-blue-300`;default:return`${n} bg-gray-700 text-gray-300`}},G=t=>{const n="px-3 py-1 text-sm font-semibold rounded-full";switch(t){case"open":return`${n} bg-red-900/50 text-red-300`;case"in_progress":return`${n} bg-yellow-900/50 text-yellow-300`;case"pending_verification":return`${n} bg-blue-900/50 text-blue-300`;case"resolved":return`${n} bg-green-900/50 text-green-300`;case"false_positive":return`${n} bg-gray-700 text-gray-300`;case"accepted_risk":return`${n} bg-purple-900/50 text-purple-300`;default:return`${n} bg-gray-700 text-gray-300`}},Q=t=>t.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()),A=t=>new Date(t).toLocaleString(),X=t=>t.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()),Y=()=>!i||!i.timeline||i.timeline.length===0?e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No timeline events"}):e.jsx("div",{className:"space-y-4",children:i.timeline.map(t=>e.jsxs("div",{className:"border-l-2 border-blue-600 pl-4 pb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("div",{className:"font-medium text-white",children:t.username}),e.jsx("div",{className:"text-xs text-gray-400",children:A(t.created_at)})]}),e.jsx("div",{className:"text-sm text-blue-400 mb-1",children:X(t.event_type)}),t.old_value&&t.new_value&&e.jsxs("div",{className:"text-xs text-gray-400",children:["Changed from"," ",e.jsx("span",{className:"font-mono bg-gray-800 px-1 rounded",children:t.old_value})," ","to"," ",e.jsx("span",{className:"font-mono bg-gray-800 px-1 rounded",children:t.new_value})]}),t.comment&&e.jsx("div",{className:"text-sm text-gray-300 mt-1",children:t.comment})]},t.id))});if(v)return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-gray-800 rounded-lg p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})})});if(!i)return null;const{vulnerability:r,comments:H,resolved_by_user:M,verified_by_user:O}=i;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg max-w-5xl w-full max-h-[90vh] overflow-y-auto border border-gray-700",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-900 border-b border-gray-700 px-6 py-4 z-10",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:r.vulnerability_id}),e.jsx("button",{onClick:f,className:"text-gray-400 hover:text-white text-2xl leading-none",children:"Ã—"})]}),e.jsx("div",{className:"flex gap-4 mt-4",children:[{id:"info",label:"Information"},{id:"remediation",label:"Remediation"},{id:"timeline",label:"Timeline"}].map(t=>e.jsx("button",{onClick:()=>$(t.id),className:`pb-2 px-1 border-b-2 transition-colors ${g===t.id?"border-blue-500 text-blue-400 font-semibold":"border-transparent text-gray-400 hover:text-gray-200"}`,children:t.label},t.id))})]}),e.jsxs("div",{className:"p-6",children:[g==="info"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Host"}),e.jsx("div",{className:"text-white",children:r.host_ip})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Port"}),e.jsx("div",{className:"text-white",children:r.port||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Severity"}),e.jsx("div",{children:e.jsx("span",{className:q(r.severity),children:r.severity.toUpperCase()})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Status"}),x?e.jsxs("select",{value:h,onChange:t=>j(t.target.value),className:"block w-full rounded-md bg-gray-800 border-gray-600 text-white shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"pending_verification",children:"Pending Verification"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"false_positive",children:"False Positive"}),e.jsx("option",{value:"accepted_risk",children:"Accepted Risk"})]}):e.jsx("span",{className:G(r.status),children:Q(r.status)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Priority"}),x?e.jsxs("select",{value:N,onChange:t=>w(t.target.value),className:"block w-full rounded-md bg-gray-800 border-gray-600 text-white shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}):e.jsx("div",{className:"text-white",children:(r.priority||"medium").toUpperCase()})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-500 mb-1",children:"Created"}),e.jsx("div",{className:"text-gray-300",children:A(r.created_at)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-500 mb-1",children:"Updated"}),e.jsx("div",{className:"text-gray-300",children:A(r.updated_at)})]}),r.resolved_at&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-500 mb-1",children:"Resolved At"}),e.jsx("div",{className:"text-gray-300",children:A(r.resolved_at)})]}),M&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-500 mb-1",children:"Resolved By"}),e.jsx("div",{className:"text-gray-300",children:M.username})]})]}),r.verified_at&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-500 mb-1",children:"Verified At"}),e.jsx("div",{className:"text-gray-300",children:A(r.verified_at)})]}),O&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-500 mb-1",children:"Verified By"}),e.jsx("div",{className:"text-gray-300",children:O.username})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Notes"}),x?e.jsx("textarea",{value:c,onChange:t=>b(t.target.value),rows:4,className:"block w-full rounded-md bg-gray-800 border-gray-600 text-white shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Add notes about this vulnerability..."}):e.jsx("div",{className:"text-gray-300 whitespace-pre-wrap bg-gray-800 p-3 rounded-md",children:r.notes||"No notes"})]}),(r.jira_ticket_id||r.jira_ticket_key)&&e.jsx("div",{className:"bg-blue-900/30 border border-blue-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-blue-300 mb-1",children:"JIRA Ticket"}),e.jsx("div",{className:"text-blue-200 font-semibold",children:r.jira_ticket_key})]}),r.jira_ticket_url&&e.jsxs("a",{href:r.jira_ticket_url,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 inline-flex items-center gap-2",children:["View in JIRA",e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:x?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:B,disabled:p,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-600",children:p?"Saving...":"Save Changes"}),e.jsx("button",{onClick:J,disabled:p,className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-md hover:bg-gray-600",children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Edit"}),r.status==="in_progress"&&e.jsx("button",{onClick:z,disabled:p,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-600",children:"Mark for Verification"}),!r.jira_ticket_id&&e.jsx("button",{onClick:K,disabled:V,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-gray-600 inline-flex items-center gap-2",children:V?"Creating...":"Create JIRA Ticket"})]})})]}),g==="remediation"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Estimated Effort (hours)"}),x?e.jsx("input",{type:"number",value:a,onChange:t=>s(t.target.value?parseInt(t.target.value):""),className:"block w-full rounded-md bg-gray-800 border-gray-600 text-white shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Hours",min:"0"}):e.jsx("div",{className:"text-white",children:r.estimated_effort?`${r.estimated_effort} hours`:"Not set"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Actual Effort (hours)"}),x?e.jsx("input",{type:"number",value:_,onChange:t=>P(t.target.value?parseInt(t.target.value):""),className:"block w-full rounded-md bg-gray-800 border-gray-600 text-white shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Hours",min:"0"}):e.jsx("div",{className:"text-white",children:r.actual_effort?`${r.actual_effort} hours`:"Not set"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Remediation Steps"}),x?e.jsx("textarea",{value:k,onChange:t=>E(t.target.value),rows:10,className:"block w-full rounded-md bg-gray-800 border-gray-600 text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 font-mono text-sm",placeholder:"Enter detailed remediation steps (markdown supported)..."}):e.jsx("div",{className:"bg-gray-800 p-4 rounded-md whitespace-pre-wrap text-gray-300",children:r.remediation_steps||"No remediation steps defined"})]}),x&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:B,disabled:p,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-600",children:p?"Saving...":"Save Changes"}),e.jsx("button",{onClick:J,disabled:p,className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-md hover:bg-gray-600",children:"Cancel"})]}),!x&&e.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Edit Remediation"})]}),g==="timeline"&&Y()]}),e.jsxs("div",{className:"border-t border-gray-700 p-6 bg-gray-800/50",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Comments"}),e.jsxs("form",{onSubmit:W,className:"mb-4",children:[e.jsx("textarea",{value:F,onChange:t=>T(t.target.value),rows:3,className:"block w-full rounded-md bg-gray-800 border-gray-600 text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 mb-2",placeholder:"Add a comment..."}),e.jsx("button",{type:"submit",disabled:p||!F.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-600",children:p?"Adding...":"Add Comment"})]}),e.jsx("div",{className:"space-y-4",children:H.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No comments yet"}):H.map(t=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"font-medium text-white",children:t.username}),e.jsx("div",{className:"text-sm text-gray-500",children:A(t.created_at)})]}),e.jsx("div",{className:"text-gray-300 whitespace-pre-wrap",children:t.comment})]},t.id))})]})]})})},ne=()=>{const[m,f]=l.useState([]),[o,i]=l.useState(),[C,v]=l.useState(null),[d,x]=l.useState(null),[u,g]=l.useState(!0);l.useEffect(()=>{$()},[]),l.useEffect(()=>{o&&h()},[o]);const $=async()=>{try{g(!0);const b=(await U.list()).data.filter(k=>k.status==="completed");f(b),b.length>0&&!o&&i(b[0].id)}catch(c){console.error("Failed to load scans:",c)}finally{g(!1)}},h=async()=>{if(o)try{const c=await S.getStats(o);x(c.data)}catch(c){console.error("Failed to load stats:",c)}},j=c=>{v(c)},N=()=>{v(null)},w=()=>{h()};return e.jsxs(ee,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Remediation Workflow"}),e.jsx("p",{className:"mt-2 text-slate-400",children:"Track and manage vulnerability remediation progress with a Kanban-style board"})]}),e.jsxs("div",{className:"bg-dark-surface rounded-lg p-6 border border-dark-border",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Select Scan"}),e.jsxs("select",{value:o||"",onChange:c=>i(c.target.value||void 0),className:"w-full md:w-96 rounded-md bg-dark-bg border-dark-border text-white shadow-sm focus:border-primary focus:ring-primary",disabled:u,children:[e.jsx("option",{value:"",children:"Select a scan..."}),m.map(c=>e.jsxs("option",{value:c.id,children:[c.name," - ",new Date(c.created_at).toLocaleDateString()]},c.id))]})]}),d&&e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg px-4 py-2 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:d.total}),e.jsx("div",{className:"text-xs text-slate-400",children:"Total"})]}),e.jsxs("div",{className:"bg-severity-critical/20 rounded-lg px-4 py-2 text-center border border-severity-critical/50",children:[e.jsx("div",{className:"text-2xl font-bold text-severity-critical",children:d.open}),e.jsx("div",{className:"text-xs text-slate-400",children:"Open"})]}),e.jsxs("div",{className:"bg-severity-medium/20 rounded-lg px-4 py-2 text-center border border-severity-medium/50",children:[e.jsx("div",{className:"text-2xl font-bold text-severity-medium",children:d.in_progress}),e.jsx("div",{className:"text-xs text-slate-400",children:"In Progress"})]}),e.jsxs("div",{className:"bg-status-completed/20 rounded-lg px-4 py-2 text-center border border-status-completed/50",children:[e.jsx("div",{className:"text-2xl font-bold text-status-completed",children:d.resolved}),e.jsx("div",{className:"text-xs text-slate-400",children:"Resolved"})]})]})]}),d&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-border",children:[e.jsx("div",{className:"text-sm text-slate-400 mb-2",children:"By Severity"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-severity-critical"}),e.jsxs("span",{className:"text-slate-300",children:["Critical: ",d.critical]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-severity-high"}),e.jsxs("span",{className:"text-slate-300",children:["High: ",d.high]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-severity-medium"}),e.jsxs("span",{className:"text-slate-300",children:["Medium: ",d.medium]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-severity-low"}),e.jsxs("span",{className:"text-slate-300",children:["Low: ",d.low]})]})]})]})]}),e.jsx("div",{className:"bg-dark-surface rounded-lg p-6 border border-dark-border",children:u?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):m.length===0?e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx("p",{className:"text-lg mb-2",children:"No completed scans found"}),e.jsx("p",{className:"text-sm",children:"Run a scan with vulnerability detection enabled to see results here"})]}):e.jsx(te,{scanId:o,onVulnerabilityClick:j})})]}),C&&e.jsx(se,{vulnerabilityId:C,onClose:N,onUpdate:w})]})};export{ne as default};
