import{j as e}from"./vendor-state-DrZ0R9WI.js";import{r as o,R as Z}from"./vendor-react-HUtzaQ-y.js";import{e as Ee,C as L,L as Q,I as X,B as D,a as me,b as le,g as de,t as ke,s as ve,c as Es,n as ae,u as Ps,h as Se,i as je,j as _e,m as Ce,k as Me,l as we,o as be,p as As,v as re,d as Is}from"./index-B50-Dbv4.js";import{B as n,U as Oe,S as ie,ak as Ke,aB as $e,v as pe,a as Re,H as ne,o as Ds,b as Ve,Q as Fs,aC as Rs,aD as Ts,aE as Ms,a9 as ce,aF as Ls,x as xe,s as Qe,P as ue,X as Ne,F as ls,ay as ge,aG as Us,aH as ns,aI as is,aJ as Le,Y as oe,aK as Os,a7 as Ae,aL as ze,R as $s,u as cs,ar as Vs,aM as os,y as zs,z as Ie,_ as Je,a1 as ds,r as ms,i as xs,h as Ye,N as Bs,aN as qe,a5 as Gs,K as De,n as us,ai as hs,aO as We,aP as Hs,aQ as Be,aa as Ks,W as ps,O as Xe,aR as Qs,aS as Ze,G as Js}from"./vendor-ui-MCXOk1Y_.js";import{S as Ys}from"./ScanComparison-CQ0tNr79.js";import"./vendor-charts-DGjHbZ-f.js";const qs=()=>{var h;const[l,y]=o.useState(null),[g,x]=o.useState(!0),[p,j]=o.useState(!1),[A,I]=o.useState(!1),[s,a]=o.useState(""),[t,r]=o.useState(!1),[d,w]=o.useState(""),[m,C]=o.useState(""),[_,U]=o.useState("");o.useEffect(()=>{M()},[]);const M=async()=>{x(!0);try{const f=await Ee.me();y(f.data),a(f.data.email||"")}catch(f){n.error("Failed to load profile"),console.error(f)}finally{x(!1)}},F=async f=>{var R,S;if(f.preventDefault(),!s.trim()){n.error("Email is required");return}j(!0);try{const P=await Ee.updateProfile({email:s.trim()});y(P.data),n.success("Profile updated successfully")}catch(P){const N=P;n.error(((S=(R=N.response)==null?void 0:R.data)==null?void 0:S.error)||"Failed to update profile")}finally{j(!1)}},b=async f=>{var R,S;if(f.preventDefault(),!d||!m){n.error("All password fields are required");return}if(m.length<6){n.error("New password must be at least 6 characters");return}if(m!==_){n.error("Passwords do not match");return}I(!0);try{await Ee.changePassword({current_password:d,new_password:m}),n.success("Password changed successfully"),r(!1),w(""),C(""),U("")}catch(P){const N=P;n.error(((S=(R=N.response)==null?void 0:R.data)==null?void 0:S.error)||"Failed to change password")}finally{I(!1)}},u=f=>f?new Date(f).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"N/A";return g?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Oe,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Profile Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(Oe,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Username"}),e.jsx("p",{className:"text-white font-medium",children:l==null?void 0:l.username})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(ie,{className:"h-5 w-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Roles"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:((h=l==null?void 0:l.roles)==null?void 0:h.map(f=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-primary/20 text-primary rounded capitalize",children:f},f)))||e.jsx("span",{className:"text-slate-400",children:"No roles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(Ke,{className:"h-5 w-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Member Since"}),e.jsx("p",{className:"text-white",children:u(l==null?void 0:l.created_at)})]})]})]}),e.jsx("form",{onSubmit:F,className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-2",children:[e.jsx($e,{className:"h-4 w-4"}),"Email Address"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(X,{type:"email",value:s,onChange:f=>a(f.target.value),placeholder:"your@email.com",className:"flex-1"}),e.jsxs(D,{type:"submit",variant:"primary",loading:p,disabled:p||s===(l==null?void 0:l.email),children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Save"]})]})]})})]}),e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Re,{className:"h-6 w-6 text-yellow-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Security"})]}),!t&&e.jsx(D,{variant:"secondary",onClick:()=>r(!0),children:"Change Password"})]}),t?e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsx(X,{label:"Current Password",type:"password",value:d,onChange:f=>w(f.target.value),placeholder:"Enter current password"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(X,{label:"New Password",type:"password",value:m,onChange:f=>C(f.target.value),placeholder:"Enter new password"}),e.jsx(X,{label:"Confirm New Password",type:"password",value:_,onChange:f=>U(f.target.value),placeholder:"Confirm new password"})]}),m&&_&&m!==_&&e.jsx("p",{className:"text-sm text-red-400",children:"Passwords do not match"}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(D,{type:"button",variant:"secondary",onClick:()=>{r(!1),w(""),C(""),U("")},children:"Cancel"}),e.jsx(D,{type:"submit",variant:"primary",loading:A,disabled:A||!d||!m||m!==_,children:"Update Password"})]})]}):e.jsx("p",{className:"text-slate-400",children:"Keep your account secure by using a strong, unique password."})]}),e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(ie,{className:"h-6 w-6 text-green-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Account Status"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${(l==null?void 0:l.is_active)!==!1?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-white",children:(l==null?void 0:l.is_active)!==!1?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Your account is in good standing."})]})]})},Ws=[{id:"admin",name:"Admin",description:"Full system access"},{id:"user",name:"User",description:"Standard user access"},{id:"auditor",name:"Auditor",description:"Read-only access to all scans"},{id:"viewer",name:"Viewer",description:"Limited view access"}],Xs=()=>{const[l,y]=o.useState([]),[g,x]=o.useState([]),[p,j]=o.useState(!0),[A,I]=o.useState(!1),[s,a]=o.useState(new Set),[t,r]=o.useState(!1),[d,w]=o.useState(!0),[m,C]=o.useState(null),[_,U]=o.useState(!1);o.useEffect(()=>{M()},[]);const M=async()=>{var k;j(!0);try{const i=await me.getUsers();y(i.data),w(!0)}catch(i){((k=i.response)==null?void 0:k.status)===403?w(!1):n.error("Failed to load users"),console.error(i)}finally{j(!1)}},F=async()=>{I(!0);try{const k=await me.getAuditLogs({limit:50,offset:0});x(k.data.logs)}catch(k){n.error("Failed to load audit logs"),console.error(k)}finally{I(!1)}},b=k=>{const i=new Set(s);i.has(k)?i.delete(k):i.add(k),a(i)},u=async k=>{var i,v;try{await me.updateUser(k.id,{is_active:!k.is_active}),n.success(`User ${k.is_active?"deactivated":"activated"}`),M()}catch(E){const K=E;n.error(((v=(i=K.response)==null?void 0:i.data)==null?void 0:v.error)||"Failed to update user")}},h=async()=>{var k,i;if(m){U(!0);try{await me.deleteUser(m.id),n.success(`User "${m.username}" deleted successfully`),M(),C(null)}catch(v){const E=v;n.error(((i=(k=E.response)==null?void 0:k.data)==null?void 0:i.error)||"Failed to delete user")}finally{U(!1)}}},f=async(k,i)=>{var v,E;try{await me.assignRole(k,i),n.success("Role assigned"),M()}catch(K){const J=K;n.error(((E=(v=J.response)==null?void 0:v.data)==null?void 0:E.error)||"Failed to assign role")}},R=async(k,i)=>{var v,E;try{await me.removeRole(k,i),n.success("Role removed"),M()}catch(K){const J=K;n.error(((E=(v=J.response)==null?void 0:v.data)==null?void 0:E.error)||"Failed to remove role")}},S=async k=>{var i,v;try{await me.unlockUser(k.id),n.success(`Account "${k.username}" unlocked`),M()}catch(E){const K=E;n.error(((v=(i=K.response)==null?void 0:i.data)==null?void 0:v.error)||"Failed to unlock account")}},P=k=>new Date(k).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),N=k=>{switch(k){case"admin":return"bg-red-500/20 text-red-400 border-red-500/30";case"user":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"auditor":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"viewer":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return p?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{})})}):d?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ds,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"User Management"})]}),e.jsxs(le,{variant:"status",type:"completed",children:[l.length," users"]})]}),e.jsx("div",{className:"space-y-3",children:l.map(k=>{const i=s.has(k.id),v=k.roles||[];return e.jsxs("div",{className:"bg-dark-bg rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>b(k.id),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"text-slate-400",children:i?e.jsx(Ve,{className:"h-4 w-4"}):e.jsx(Fs,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${k.is_active!==!1?"bg-green-400":"bg-red-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:k.username}),e.jsx("p",{className:"text-sm text-slate-400",children:k.email})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex gap-1",children:v.map(E=>e.jsx("span",{className:`px-2 py-0.5 text-xs rounded border capitalize ${N(E)}`,children:E},E))}),k.is_locked&&e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded border bg-red-500/20 text-red-400 border-red-500/30 flex items-center gap-1",children:[e.jsx(Re,{className:"h-3 w-3"}),"Locked"]}),e.jsx("span",{className:"text-xs text-slate-500",children:k.created_at?P(k.created_at):"N/A"})]})]}),i&&e.jsxs("div",{className:"border-t border-dark-border p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"Manage Roles"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:Ws.map(E=>{const K=v.includes(E.id);return e.jsxs("button",{onClick:J=>{J.stopPropagation(),K?R(k.id,E.id):f(k.id,E.id)},className:`p-3 rounded-lg border text-left transition-colors ${K?"bg-primary/20 border-primary/50 text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-primary/30"}`,children:[e.jsx("p",{className:"font-medium text-sm capitalize",children:E.name}),e.jsx("p",{className:"text-xs opacity-75",children:E.description})]},E.id)})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-dark-border",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{variant:k.is_active!==!1?"secondary":"primary",size:"sm",onClick:E=>{E.stopPropagation(),u(k)},children:k.is_active!==!1?e.jsxs(e.Fragment,{children:[e.jsx(Rs,{className:"h-4 w-4 mr-1"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"h-4 w-4 mr-1"}),"Activate"]})}),k.is_locked&&e.jsxs(D,{variant:"primary",size:"sm",onClick:E=>{E.stopPropagation(),S(k)},children:[e.jsx(Ms,{className:"h-4 w-4 mr-1"}),"Unlock Account"]})]}),e.jsxs(D,{variant:"secondary",size:"sm",onClick:E=>{E.stopPropagation(),C(k)},className:"text-red-400 hover:text-red-300 hover:bg-red-500/10","aria-label":`Delete user ${k.username}`,children:[e.jsx(ce,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})]},k.id)})})]}),e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ls,{className:"h-6 w-6 text-purple-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Audit Logs"})]}),e.jsx(D,{variant:"secondary",onClick:()=>{r(!t),!t&&g.length===0&&F()},children:t?"Hide Logs":"Show Logs"})]}),t&&e.jsx(e.Fragment,{children:A?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Q,{})}):g.length===0?e.jsx("p",{className:"text-slate-400 text-center py-8",children:"No audit logs found"}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:g.map(k=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-dark-bg rounded-lg text-sm",children:[e.jsx(xe,{className:"h-4 w-4 text-slate-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium text-white",children:k.action}),k.target_type&&e.jsxs("span",{className:"text-slate-400",children:["on ",k.target_type]}),k.target_id&&e.jsx("span",{className:"text-xs text-slate-500 font-mono truncate max-w-32",children:k.target_id})]}),k.details&&e.jsx("p",{className:"text-xs text-slate-500 mt-1 truncate",children:k.details})]}),e.jsx("span",{className:"text-xs text-slate-500 whitespace-nowrap",children:P(k.created_at)})]},k.id))})}),!t&&e.jsx("p",{className:"text-slate-400",children:"View a log of administrative actions performed in the system."})]}),e.jsx(de,{isOpen:!!m,onClose:()=>C(null),onConfirm:h,title:"Delete User",message:`Are you sure you want to delete user "${m==null?void 0:m.username}"? All their data, including scans and settings, will be permanently removed.`,confirmLabel:"Delete User",variant:"danger",loading:_})]}):e.jsx(L,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ne,{className:"h-12 w-12 text-yellow-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-slate-400",children:"You don't have permission to access the administration panel."}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Contact an administrator if you need elevated access."})]})})},Ue=["#ef4444","#f97316","#eab308","#22c55e","#14b8a6","#3b82f6","#8b5cf6","#ec4899","#6366f1","#64748b"],Zs=()=>{const[l,y]=o.useState([]),[g,x]=o.useState(!0),[p,j]=o.useState(!1),[A,I]=o.useState(null),[s,a]=o.useState({name:"",description:"",targets:"",color:Ue[0]}),[t,r]=o.useState(null),[d,w]=o.useState(!1);o.useEffect(()=>{m()},[]);const m=async()=>{x(!0);try{const b=await ke.getAll();y(b.data)}catch(b){n.error("Failed to load target groups"),console.error(b)}finally{x(!1)}},C=()=>{a({name:"",description:"",targets:"",color:Ue[0]}),I(null),j(!1)},_=b=>{const u=JSON.parse(b.targets||"[]");a({name:b.name,description:b.description||"",targets:u.join(`
`),color:b.color}),I(b.id),j(!0)},U=async b=>{var h,f;b.preventDefault();const u=s.targets.split(`
`).map(R=>R.trim()).filter(R=>R.length>0);if(!s.name.trim()){n.error("Name is required");return}if(u.length===0){n.error("At least one target is required");return}try{A?(await ke.update(A,{name:s.name,description:s.description||void 0,targets:u,color:s.color}),n.success("Target group updated")):(await ke.create({name:s.name,description:s.description||void 0,targets:u,color:s.color}),n.success("Target group created")),C(),m()}catch(R){const S=R;n.error(((f=(h=S.response)==null?void 0:h.data)==null?void 0:f.error)||"Failed to save target group")}},M=async()=>{var b,u;if(t){w(!0);try{await ke.delete(t.id),n.success(`Target group "${t.name}" deleted`),m(),r(null)}catch(h){const f=h;n.error(((u=(b=f.response)==null?void 0:b.data)==null?void 0:u.error)||"Failed to delete")}finally{w(!1)}}},F=b=>{try{return JSON.parse(b||"[]")}catch{return[]}};return g?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Target Groups"})]}),!p&&e.jsxs(D,{variant:"primary",onClick:()=>j(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"New Group"]})]})}),p&&e.jsx(L,{children:e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:A?"Edit Target Group":"Create Target Group"}),e.jsx("button",{type:"button",onClick:C,className:"text-slate-400 hover:text-white",children:e.jsx(Ne,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:b=>a({...s,name:b.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Production Servers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Color"}),e.jsx("div",{className:"flex gap-2",children:Ue.map(b=>e.jsx("button",{type:"button",onClick:()=>a({...s,color:b}),className:`w-8 h-8 rounded-full border-2 transition-all ${s.color===b?"border-white scale-110":"border-transparent"}`,style:{backgroundColor:b}},b))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:s.description,onChange:b=>a({...s,description:b.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Targets (one per line)"}),e.jsx("textarea",{value:s.targets,onChange:b=>a({...s,targets:b.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:5,placeholder:`192.168.1.0/24
10.0.0.1
example.com`})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(D,{type:"button",variant:"secondary",onClick:C,children:"Cancel"}),e.jsxs(D,{type:"submit",variant:"primary",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),A?"Update":"Create"]})]})]})}),l.length===0&&!p?e.jsx(L,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ls,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No target groups yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create groups to organize your scan targets"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(b=>{const u=F(b.targets);return e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:b.color}}),e.jsx("h4",{className:"font-medium text-white",children:b.name})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>_(b),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>r(b),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete target group ${b.name}`,children:e.jsx(ce,{className:"h-4 w-4"})})]})]}),b.description&&e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:b.description}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:[u.length," target",u.length!==1?"s":""]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[u.slice(0,5).map((h,f)=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-300 font-mono",children:h},f)),u.length>5&&e.jsxs("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-500",children:["+",u.length-5," more"]})]})]})]},b.id)})}),e.jsx(de,{isOpen:!!t,onClose:()=>r(null),onConfirm:M,title:"Delete Target Group",message:`Are you sure you want to delete the target group "${t==null?void 0:t.name}"? Scheduled scans using this group will need to be updated.`,confirmLabel:"Delete Group",variant:"danger",loading:d})]})},es={name:"",description:"",schedule_type:"daily",schedule_value:"02:00",targets:"",port_range_start:1,port_range_end:1e3,threads:100,enable_os_detection:!0,enable_service_detection:!0,enable_vuln_scan:!0,enable_enumeration:!1},ss=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],et=()=>{const[l,y]=o.useState([]),[g,x]=o.useState([]),[p,j]=o.useState(!0),[A,I]=o.useState(!1),[s,a]=o.useState(null),[t,r]=o.useState(es),[d,w]=o.useState(0),[m,C]=o.useState(1),[_,U]=o.useState(null),[M,F]=o.useState(!1);o.useEffect(()=>{b()},[]);const b=async()=>{j(!0);try{const[i,v]=await Promise.all([ve.getAll(),ke.getAll()]);y(i.data),x(v.data)}catch(i){n.error("Failed to load scheduled scans"),console.error(i)}finally{j(!1)}},u=()=>{r(es),a(null),I(!1),w(0),C(1)},h=i=>{const v=JSON.parse(i.config);if(r({name:i.name,description:i.description||"",schedule_type:i.schedule_type,schedule_value:i.schedule_value,targets:v.targets.join(`
`),port_range_start:v.port_range[0],port_range_end:v.port_range[1],threads:v.threads,enable_os_detection:v.enable_os_detection,enable_service_detection:v.enable_service_detection,enable_vuln_scan:v.enable_vuln_scan,enable_enumeration:v.enable_enumeration}),i.schedule_type==="weekly"){const E=i.schedule_value.split(" ");E.length>=2&&w(parseInt(E[1])||0)}else if(i.schedule_type==="monthly"){const E=i.schedule_value.split(" ");E.length>=2&&C(parseInt(E[1])||1)}a(i.id),I(!0)},f=()=>{const i=t.schedule_value.includes(":")?t.schedule_value:"02:00";switch(t.schedule_type){case"daily":return i;case"weekly":return`${i} ${d}`;case"monthly":return`${i} ${m}`;default:return i}},R=async i=>{var J,T;i.preventDefault();const v=t.targets.split(`
`).map(O=>O.trim()).filter(O=>O.length>0);if(!t.name.trim()){n.error("Name is required");return}if(v.length===0){n.error("At least one target is required");return}const E={targets:v,port_range:[t.port_range_start,t.port_range_end],threads:t.threads,enable_os_detection:t.enable_os_detection,enable_service_detection:t.enable_service_detection,enable_vuln_scan:t.enable_vuln_scan,enable_enumeration:t.enable_enumeration},K=f();try{s?(await ve.update(s,{name:t.name,description:t.description||void 0,config:E,schedule_type:t.schedule_type,schedule_value:K}),n.success("Scheduled scan updated")):(await ve.create({name:t.name,description:t.description||void 0,config:E,schedule_type:t.schedule_type,schedule_value:K}),n.success("Scheduled scan created")),u(),b()}catch(O){const G=O;n.error(((T=(J=G.response)==null?void 0:J.data)==null?void 0:T.error)||"Failed to save scheduled scan")}},S=async i=>{var v,E;try{await ve.update(i.id,{is_active:!i.is_active}),n.success(`Scheduled scan ${i.is_active?"paused":"activated"}`),b()}catch(K){const J=K;n.error(((E=(v=J.response)==null?void 0:v.data)==null?void 0:E.error)||"Failed to update")}},P=async()=>{var i,v;if(_){F(!0);try{await ve.delete(_.id),n.success(`Scheduled scan "${_.name}" deleted`),b(),U(null)}catch(E){const K=E;n.error(((v=(i=K.response)==null?void 0:i.data)==null?void 0:v.error)||"Failed to delete")}finally{F(!1)}}},N=i=>{const v=JSON.parse(i.targets||"[]");r(E=>({...E,targets:v.join(`
`)}))},k=i=>{const v=i.schedule_value.split(" "),E=v[0];switch(i.schedule_type){case"daily":return`Daily at ${E}`;case"weekly":return`Every ${ss[parseInt(v[1])||0]} at ${E}`;case"monthly":return`Monthly on day ${v[1]||1} at ${E}`;default:return i.schedule_value}};return p?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scheduled Scans"})]}),!A&&e.jsxs(D,{variant:"primary",onClick:()=>I(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"New Schedule"]})]})}),A&&e.jsx(L,{children:e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:s?"Edit Scheduled Scan":"Create Scheduled Scan"}),e.jsx("button",{type:"button",onClick:u,className:"text-slate-400 hover:text-white",children:e.jsx(Ne,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:t.name,onChange:i=>r({...t,name:i.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Daily Network Scan"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:t.description,onChange:i=>r({...t,description:i.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(Ke,{className:"h-4 w-4"})," Schedule"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Frequency"}),e.jsxs("select",{value:t.schedule_type,onChange:i=>r({...t,schedule_type:i.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),t.schedule_type==="weekly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Week"}),e.jsx("select",{value:d,onChange:i=>w(parseInt(i.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:ss.map((i,v)=>e.jsx("option",{value:v,children:i},i))})]}),t.schedule_type==="monthly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Month"}),e.jsx("select",{value:m,onChange:i=>C(parseInt(i.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Array.from({length:28},(i,v)=>v+1).map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Time (UTC)"}),e.jsx("input",{type:"time",value:t.schedule_value.split(" ")[0],onChange:i=>r({...t,schedule_value:i.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Targets (one per line)"}),g.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Use group:"}),g.slice(0,3).map(i=>e.jsx("button",{type:"button",onClick:()=>N(i),className:"px-2 py-0.5 text-xs rounded border border-dark-border text-slate-400 hover:text-white hover:border-primary",style:{borderLeftColor:i.color,borderLeftWidth:3},children:i.name},i.id))]})]}),e.jsx("textarea",{value:t.targets,onChange:i=>r({...t,targets:i.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:4,placeholder:`192.168.1.0/24
10.0.0.1`})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port Start"}),e.jsx("input",{type:"number",value:t.port_range_start,onChange:i=>r({...t,port_range_start:parseInt(i.target.value)||1}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port End"}),e.jsx("input",{type:"number",value:t.port_range_end,onChange:i=>r({...t,port_range_end:parseInt(i.target.value)||1e3}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Threads"}),e.jsx("input",{type:"number",value:t.threads,onChange:i=>r({...t,threads:parseInt(i.target.value)||100}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:1e3})]})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:[{key:"enable_os_detection",label:"OS Detection"},{key:"enable_service_detection",label:"Service Detection"},{key:"enable_vuln_scan",label:"Vulnerability Scan"},{key:"enable_enumeration",label:"Enumeration"}].map(({key:i,label:v})=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t[i],onChange:E=>r({...t,[i]:E.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-slate-300",children:v})]},i))}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(D,{type:"button",variant:"secondary",onClick:u,children:"Cancel"}),e.jsxs(D,{type:"submit",variant:"primary",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),s?"Update":"Create"]})]})]})}),l.length===0&&!A?e.jsx(L,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(xe,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scheduled scans"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create automated recurring scans"})]})}):e.jsx("div",{className:"space-y-3",children:l.map(i=>{const v=JSON.parse(i.config);return e.jsx(L,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${i.is_active?"bg-green-500/20":"bg-slate-500/20"}`,children:e.jsx(xe,{className:`h-5 w-5 ${i.is_active?"text-green-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-white",children:i.name}),e.jsx(le,{variant:"status",type:i.is_active?"completed":"pending",children:i.is_active?"Active":"Paused"})]}),e.jsx("p",{className:"text-sm text-slate-400",children:k(i)}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[v.targets.length," target",v.targets.length!==1?"s":""," | Ports ",v.port_range[0],"-",v.port_range[1]," |",i.run_count," runs",i.last_run_at&&e.jsxs(e.Fragment,{children:[" | Last run ",Es(new Date(i.last_run_at))," ago"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>S(i),className:`p-2 rounded transition-colors ${i.is_active?"text-yellow-400 hover:bg-yellow-500/20":"text-green-400 hover:bg-green-500/20"}`,title:i.is_active?"Pause":"Activate",children:i.is_active?e.jsx(Us,{className:"h-4 w-4"}):e.jsx(ns,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>h(i),className:"p-2 text-slate-400 hover:text-primary transition-colors",children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>U(i),className:"p-2 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete scheduled scan ${i.name}`,children:e.jsx(ce,{className:"h-4 w-4"})})]})]})},i.id)})}),e.jsx(de,{isOpen:!!_,onClose:()=>U(null),onConfirm:P,title:"Delete Scheduled Scan",message:`Are you sure you want to delete the scheduled scan "${_==null?void 0:_.name}"? Future automated scans will no longer run.`,confirmLabel:"Delete Schedule",variant:"warning",loading:M})]})},st=()=>{const[l,y]=o.useState(null),[g,x]=o.useState(!0),[p,j]=o.useState(!1),[A,I]=o.useState(!1),[s,a]=o.useState(!1),[t,r]=o.useState(!1),[d,w]=o.useState(null),[m,C]=o.useState({email_on_scan_complete:!1,email_on_critical_vuln:!0,email_address:"",slack_webhook_url:"",teams_webhook_url:""});o.useEffect(()=>{_(),U()},[]);const _=async()=>{var h;x(!0);try{const f=await ae.getSettings();y(f.data),C({email_on_scan_complete:f.data.email_on_scan_complete,email_on_critical_vuln:f.data.email_on_critical_vuln,email_address:f.data.email_address||"",slack_webhook_url:f.data.slack_webhook_url||"",teams_webhook_url:f.data.teams_webhook_url||""})}catch(f){((h=f.response)==null?void 0:h.status)!==404&&(n.error("Failed to load notification settings"),console.error(f))}finally{x(!1)}},U=async()=>{try{const h=await ae.checkSmtpStatus();w(h.data.configured)}catch(h){console.error("Failed to check SMTP status:",h),w(!1)}},M=async h=>{var f,R;if(h.preventDefault(),(m.email_on_scan_complete||m.email_on_critical_vuln)&&!m.email_address){n.error("Email address is required when notifications are enabled");return}j(!0);try{const S=await ae.updateSettings(m);y(S.data),n.success("Notification settings saved")}catch(S){const P=S;n.error(((R=(f=P.response)==null?void 0:f.data)==null?void 0:R.error)||"Failed to save settings")}finally{j(!1)}},F=async()=>{var h,f;if(!m.slack_webhook_url){n.error("Please enter a Slack webhook URL first");return}I(!0);try{m.slack_webhook_url!==(l==null?void 0:l.slack_webhook_url)&&await ae.updateSettings({slack_webhook_url:m.slack_webhook_url});const R=await ae.testSlack();n.success(R.data.message)}catch(R){const S=R;n.error(((f=(h=S.response)==null?void 0:h.data)==null?void 0:f.error)||"Failed to send test message")}finally{I(!1)}},b=async()=>{var h,f;if(!m.teams_webhook_url){n.error("Please enter a Teams webhook URL first");return}a(!0);try{m.teams_webhook_url!==(l==null?void 0:l.teams_webhook_url)&&await ae.updateSettings({teams_webhook_url:m.teams_webhook_url});const R=await ae.testTeams();n.success(R.data.message)}catch(R){const S=R;n.error(((f=(h=S.response)==null?void 0:h.data)==null?void 0:f.error)||"Failed to send test message")}finally{a(!1)}},u=async()=>{var h,f;if(!m.email_address){n.error("Please enter an email address first");return}if(!d){n.error("SMTP is not configured on the server. Contact your administrator.");return}r(!0);try{m.email_address!==(l==null?void 0:l.email_address)&&await ae.updateSettings({email_address:m.email_address});const R=await ae.testEmail();n.success(R.data.message)}catch(R){const S=R;n.error(((f=(h=S.response)==null?void 0:h.data)==null?void 0:f.error)||"Failed to send test email")}finally{r(!1)}};return g?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(is,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Notification Settings"})]}),e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Notification Email Address"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx($e,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"email",value:m.email_address,onChange:h=>C({...m,email_address:h.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"your@email.com"})]}),e.jsx(D,{type:"button",variant:"secondary",onClick:u,disabled:!m.email_address||t||!d,title:d?"Send test email":"SMTP not configured on server",children:t?e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx("span",{className:"ml-2",children:"Sending..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Email address where notifications will be sent"}),d!==null&&e.jsx("span",{className:`text-xs flex items-center gap-1 ${d?"text-green-400":"text-amber-400"}`,children:d?e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"h-3 w-3"}),"SMTP configured"]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"h-3 w-3"}),"SMTP not configured"]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Email Notifications"}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:m.email_on_scan_complete,onChange:h=>C({...m,email_on_scan_complete:h.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"font-medium text-white",children:"Scan Completion"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Receive an email when any of your scans complete, including a summary of findings"})]})]}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:m.email_on_critical_vuln,onChange:h=>C({...m,email_on_critical_vuln:h.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"font-medium text-white",children:"Critical Vulnerabilities"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Get immediate alerts when critical or high severity vulnerabilities are discovered"})]})]})]}),d===!1?e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ne,{className:"h-5 w-5 text-amber-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-200",children:"SMTP is not configured on this server. Email notifications are disabled."}),e.jsx("p",{className:"text-xs text-amber-300/70 mt-1",children:"Contact your administrator to configure SMTP settings (SMTP_HOST, SMTP_USER, etc.)"})]})]})}):e.jsx("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx($e,{className:"h-5 w-5 text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-200",children:d?"Email notifications are ready. Use the Test button to verify delivery.":"Checking SMTP configuration..."}),e.jsx("p",{className:"text-xs text-blue-300/70 mt-1",children:"Contact your administrator if you're not receiving emails."})]})]})}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-dark-border",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(Os,{className:"h-4 w-4"}),"Webhook Integrations"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Slack Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:m.slack_webhook_url,onChange:h=>C({...m,slack_webhook_url:h.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://hooks.slack.com/services/YOUR/WEBHOOK/URL"}),e.jsx(D,{type:"button",variant:"secondary",onClick:F,disabled:!m.slack_webhook_url||A,children:A?e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Send scan notifications to a Slack channel. Create a webhook at"," ",e.jsx("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Slack Incoming Webhooks"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Microsoft Teams Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:m.teams_webhook_url,onChange:h=>C({...m,teams_webhook_url:h.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://outlook.office.com/webhook/YOUR/WEBHOOK/URL"}),e.jsx(D,{type:"button",variant:"secondary",onClick:b,disabled:!m.teams_webhook_url||s,children:s?e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Send scan notifications to a Teams channel. Create a webhook in your Teams channel connectors."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(D,{type:"submit",variant:"primary",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Save Settings"]})})})]})]}),l&&e.jsxs(L,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"Current Status"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Scan Complete Emails:"}),e.jsx("span",{className:`ml-2 ${l.email_on_scan_complete?"text-green-400":"text-slate-400"}`,children:l.email_on_scan_complete?"Enabled":"Disabled"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Critical Vuln Alerts:"}),e.jsx("span",{className:`ml-2 ${l.email_on_critical_vuln?"text-green-400":"text-slate-400"}`,children:l.email_on_critical_vuln?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-slate-500",children:"Last Updated:"}),e.jsx("span",{className:"ml-2 text-slate-300",children:new Date(l.updated_at).toLocaleString()})]})]})]})]})},tt=()=>{const[l,y]=o.useState([]),[g,x]=o.useState(!0),[p,j]=o.useState(!1),[A,I]=o.useState(null),[s,a]=o.useState({name:"",description:""}),[t,r]=o.useState(new Set),[d,w]=o.useState(null),[m,C]=o.useState(!1),{addScan:_}=Ps();o.useEffect(()=>{U()},[]);const U=async()=>{x(!0);try{const S=await Se.getAll();y(S.data)}catch(S){n.error("Failed to load templates"),console.error(S)}finally{x(!1)}},M=()=>{a({name:"",description:""}),I(null),j(!1)},F=S=>{a({name:S.name,description:S.description||""}),I(S.id),j(!0)},b=async S=>{var P,N;if(S.preventDefault(),!s.name.trim()){n.error("Name is required");return}if(!A){n.error('Cannot create templates from this form. Use "Save as Template" in the scan form.');return}try{await Se.update(A,{name:s.name,description:s.description||void 0}),n.success("Template updated"),M(),U()}catch(k){const i=k;n.error(((N=(P=i.response)==null?void 0:P.data)==null?void 0:N.error)||"Failed to update template")}},u=async()=>{var S,P;if(d){C(!0);try{await Se.delete(d.id),n.success(`Template "${d.name}" deleted`),U(),w(null)}catch(N){const k=N;n.error(((P=(S=k.response)==null?void 0:S.data)==null?void 0:P.error)||"Failed to delete")}finally{C(!1)}}},h=async(S,P)=>{var k,i;const N=prompt(`Enter name for new scan (based on "${P}"):`,`${P} - ${new Date().toLocaleDateString()}`);if(N){r(new Set([...t,S]));try{const v=await Se.createScan(S,N);_(v.data),n.success("Scan started from template!")}catch(v){const E=v;n.error(((i=(k=E.response)==null?void 0:k.data)==null?void 0:i.error)||"Failed to create scan")}finally{r(v=>{const E=new Set(v);return E.delete(S),E})}}},f=S=>{try{return JSON.parse(S)}catch{return null}},R=S=>new Date(S).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return g?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scan Templates"})]}),e.jsx("div",{className:"text-sm text-slate-400",children:"Save scan configurations for quick reuse"})]})}),p&&e.jsx(L,{children:e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Edit Template"}),e.jsx("button",{type:"button",onClick:M,className:"text-slate-400 hover:text-white",children:e.jsx(Ne,{className:"h-5 w-5"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:S=>a({...s,name:S.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Production Network Template"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("textarea",{value:s.description,onChange:S=>a({...s,description:S.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",rows:3,placeholder:"Optional description"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(D,{type:"button",variant:"secondary",onClick:M,children:"Cancel"}),e.jsxs(D,{type:"submit",variant:"primary",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Update"]})]})]})}),l.length===0&&!p?e.jsx(L,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ae,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scan templates yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:'Save scan configurations using "Save as Template" when creating a scan'})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:l.map(S=>{const P=f(S.config),N=t.has(S.id);return e.jsx(L,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white text-lg",children:S.name}),S.description&&e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:S.description})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>F(S),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit template",children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>w(S),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete template","aria-label":`Delete template ${S.name}`,children:e.jsx(ce,{className:"h-4 w-4"})})]})]}),P&&e.jsxs("div",{className:"space-y-2 border-t border-dark-border pt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:[P.targets.length," target",P.targets.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Ports: ",P.port_range[0],"-",P.port_range[1]]})]}),P.scan_type&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-slate-400 capitalize",children:P.scan_type.replace("_"," ")})]}),P.enable_enumeration&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Enumeration: ",P.enum_depth||"light"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[P.enable_os_detection&&e.jsx(le,{variant:"status",type:"completed",children:"OS Detection"}),P.enable_service_detection&&e.jsx(le,{variant:"status",type:"completed",children:"Services"}),P.enable_vuln_scan&&e.jsx(le,{variant:"status",type:"running",children:"Vuln Scan"}),P.enable_enumeration&&e.jsx(le,{variant:"status",type:"pending",children:"Enumeration"})]})]}),e.jsxs("div",{className:"flex items-center justify-between border-t border-dark-border pt-4",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:["Created ",R(S.created_at)]}),e.jsxs(D,{variant:"primary",size:"sm",onClick:()=>h(S.id,S.name),loading:N,disabled:N,children:[e.jsx(Vs,{className:"h-4 w-4 mr-1.5"}),"Create Scan"]})]})]})},S.id)})}),e.jsx(de,{isOpen:!!d,onClose:()=>w(null),onConfirm:u,title:"Delete Template",message:`Are you sure you want to delete the template "${d==null?void 0:d.name}"? This will not affect any scans previously created from this template.`,confirmLabel:"Delete Template",variant:"danger",loading:m})]})},ts=["critical","high","medium","low","info"],at=["web","network","infrastructure","cloud","api","mobile","other"],rt=()=>{var ee,z,W;const[l,y]=o.useState([]),[g,x]=o.useState([]),[p,j]=o.useState(!0),[A,I]=o.useState(!1),[s,a]=o.useState(null),[t,r]=o.useState(null),[d,w]=o.useState(!1),[m,C]=o.useState(!1),[_,U]=o.useState(null),[M,F]=o.useState(""),[b,u]=o.useState(""),[h,f]=o.useState(""),[R,S]=o.useState(!0),[P,N]=o.useState({category:"web",title:"",severity:"medium",description:"",impact:"",remediation:"",references:[],cwe_ids:[],cvss_vector:"",cvss_score:void 0,tags:[]});o.useEffect(()=>{k(),i()},[b,h,M,R]);const k=async()=>{j(!0);try{const c=await je.list({category:b||void 0,severity:h||void 0,search:M||void 0,include_system:R});y(c.data)}catch(c){n.error("Failed to load finding templates"),console.error(c)}finally{j(!1)}},i=async()=>{try{const c=await je.getCategories();x(c.data)}catch(c){console.error("Failed to load categories:",c)}},v=()=>{N({category:"web",title:"",severity:"medium",description:"",impact:"",remediation:"",references:[],cwe_ids:[],cvss_vector:"",cvss_score:void 0,tags:[]}),a(null),I(!1)},E=c=>{N({category:c.category,title:c.title,severity:c.severity,description:c.description,impact:c.impact||"",remediation:c.remediation||"",references:c.references?JSON.parse(c.references):[],cwe_ids:c.cwe_ids?JSON.parse(c.cwe_ids):[],cvss_vector:c.cvss_vector||"",cvss_score:c.cvss_score||void 0,tags:c.tags?JSON.parse(c.tags):[]}),a(c),I(!0)},K=async c=>{var H,te;const B=prompt("Enter name for cloned template:",`${c.title} (Copy)`);if(B)try{await je.clone(c.id,{new_title:B}),n.success("Template cloned successfully"),k(),i()}catch(fe){const se=fe;n.error(((te=(H=se.response)==null?void 0:H.data)==null?void 0:te.error)||"Failed to clone template")}},J=async c=>{var B,H;if(c.preventDefault(),!P.title.trim()){n.error("Title is required");return}if(!P.description.trim()){n.error("Description is required");return}C(!0);try{s?(await je.update(s.id,P),n.success("Template updated successfully")):(await je.create(P),n.success("Template created successfully")),v(),k(),i()}catch(te){const fe=te;n.error(((H=(B=fe.response)==null?void 0:B.data)==null?void 0:H.error)||"Failed to save template")}finally{C(!1)}},T=async()=>{var c,B;if(t){w(!0);try{await je.delete(t.id),n.success(`Template "${t.title}" deleted`),k(),i(),r(null)}catch(H){const te=H;n.error(((B=(c=te.response)==null?void 0:c.data)==null?void 0:B.error)||"Failed to delete template")}finally{w(!1)}}},O=c=>{switch(c.toLowerCase()){case"critical":case"high":return e.jsx(ne,{className:"h-4 w-4"});case"medium":return e.jsx(ie,{className:"h-4 w-4"});default:return e.jsx(ds,{className:"h-4 w-4"})}},G=c=>{const B=c.toLowerCase();return B==="critical"?"critical":B==="high"?"high":B==="medium"?"medium":"low"},V=c=>{if(!c)return[];try{return JSON.parse(c)}catch{return[]}},Y=c=>new Date(c).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return p&&l.length===0?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(os,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Finding Templates"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-slate-400",children:[l.length," template",l.length!==1?"s":""]}),e.jsxs(D,{variant:"primary",size:"sm",onClick:()=>I(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-1.5"}),"New Template"]})]})]})}),e.jsx(L,{children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(cs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",value:M,onChange:c=>F(c.target.value),placeholder:"Search templates...",className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})}),e.jsxs("div",{className:"relative",children:[e.jsx(zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsxs("select",{value:b,onChange:c=>u(c.target.value),className:"bg-dark-bg border border-dark-border rounded-lg pl-10 pr-8 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"All Categories"}),g.map(c=>e.jsxs("option",{value:c.category,children:[c.category.charAt(0).toUpperCase()+c.category.slice(1)," (",c.count,")"]},c.category))]}),e.jsx(Ve,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:h,onChange:c=>f(c.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent appearance-none cursor-pointer pr-8",children:[e.jsx("option",{value:"",children:"All Severities"}),ts.map(c=>e.jsx("option",{value:c,children:c.charAt(0).toUpperCase()+c.slice(1)},c))]}),e.jsx(Ve,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:R,onChange:c=>S(c.target.checked),className:"rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),"Include system templates"]})]})}),A&&e.jsx(L,{children:e.jsxs("form",{onSubmit:J,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:s?"Edit Template":"New Template"}),e.jsx("button",{type:"button",onClick:v,className:"text-slate-400 hover:text-white",children:e.jsx(Ne,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Category"}),e.jsx("select",{value:P.category,onChange:c=>N({...P,category:c.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:at.map(c=>e.jsx("option",{value:c,children:c.charAt(0).toUpperCase()+c.slice(1)},c))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Severity"}),e.jsx("select",{value:P.severity,onChange:c=>N({...P,severity:c.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:ts.map(c=>e.jsx("option",{value:c,children:c.charAt(0).toUpperCase()+c.slice(1)},c))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CVSS Score"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"10",value:P.cvss_score||"",onChange:c=>N({...P,cvss_score:c.target.value?parseFloat(c.target.value):void 0}),placeholder:"0.0 - 10.0",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:P.title,onChange:c=>N({...P,title:c.target.value}),placeholder:"e.g., SQL Injection in Login Form",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description *"}),e.jsx("textarea",{value:P.description,onChange:c=>N({...P,description:c.target.value}),rows:4,placeholder:"Detailed description of the vulnerability...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Impact"}),e.jsx("textarea",{value:P.impact||"",onChange:c=>N({...P,impact:c.target.value}),rows:2,placeholder:"Potential impact if exploited...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Remediation"}),e.jsx("textarea",{value:P.remediation||"",onChange:c=>N({...P,remediation:c.target.value}),rows:3,placeholder:"Recommended steps to fix...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CVSS Vector"}),e.jsx("input",{type:"text",value:P.cvss_vector||"",onChange:c=>N({...P,cvss_vector:c.target.value}),placeholder:"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CWE IDs (comma-separated)"}),e.jsx("input",{type:"text",value:((ee=P.cwe_ids)==null?void 0:ee.join(", "))||"",onChange:c=>{const B=c.target.value.split(",").map(H=>parseInt(H.trim())).filter(H=>!isNaN(H));N({...P,cwe_ids:B})},placeholder:"e.g., 89, 564",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"References (one URL per line)"}),e.jsx("textarea",{value:((z=P.references)==null?void 0:z.join(`
`))||"",onChange:c=>{const B=c.target.value.split(`
`).map(H=>H.trim()).filter(H=>H);N({...P,references:B})},rows:2,placeholder:"https://owasp.org/...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:((W=P.tags)==null?void 0:W.join(", "))||"",onChange:c=>{const B=c.target.value.split(",").map(H=>H.trim()).filter(H=>H);N({...P,tags:B})},placeholder:"e.g., owasp, web, injection",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(D,{type:"button",variant:"secondary",onClick:v,children:"Cancel"}),e.jsxs(D,{type:"submit",variant:"primary",loading:m,disabled:m,children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),s?"Update":"Create"]})]})]})}),l.length===0&&!A?e.jsx(L,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ae,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No finding templates found"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:b||h||M?"Try adjusting your filters":"Create your first template or include system templates"})]})}):e.jsx("div",{className:"space-y-3",children:l.map(c=>{const B=_===c.id,H=V(c.references),te=V(c.cwe_ids),fe=V(c.tags);return e.jsx(L,{className:B?"ring-1 ring-primary":"",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>U(B?null:c.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(le,{variant:"severity",type:G(c.severity),children:[O(c.severity),e.jsx("span",{className:"ml-1",children:c.severity})]}),e.jsx(le,{variant:"status",type:"pending",children:c.category}),c.is_system&&e.jsx(le,{variant:"status",type:"completed",children:"System"})]}),e.jsx("h4",{className:"font-semibold text-white text-lg mt-2",children:c.title}),!B&&e.jsx("p",{className:"text-sm text-slate-400 mt-1 line-clamp-2",children:c.description})]}),e.jsxs("div",{className:"flex gap-1 ml-4",children:[e.jsx("button",{onClick:()=>K(c),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Clone template",children:e.jsx(Ie,{className:"h-4 w-4"})}),!c.is_system&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>E(c),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit template",children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>r(c),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete template",children:e.jsx(ce,{className:"h-4 w-4"})})]})]})]}),B&&e.jsxs("div",{className:"border-t border-dark-border pt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:c.description})]}),c.impact&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Impact"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:c.impact})]}),c.remediation&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Remediation"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:c.remediation})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[c.cvss_score!==null&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"CVSS:"})," ",e.jsx("span",{className:"text-white font-medium",children:c.cvss_score.toFixed(1)})]}),c.cvss_vector&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Vector:"})," ",e.jsx("code",{className:"text-slate-300 text-xs",children:c.cvss_vector})]}),te.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"CWE:"})," ",te.map((se,Te)=>e.jsxs("span",{children:[Te>0&&", ",e.jsxs("a",{href:`https://cwe.mitre.org/data/definitions/${se}.html`,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:["CWE-",se]})]},se))]})]}),H.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-2",children:"References"}),e.jsx("div",{className:"space-y-1",children:H.map((se,Te)=>e.jsxs("a",{href:se,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-primary hover:underline",children:[e.jsx(Je,{className:"h-3 w-3"}),se]},Te))})]}),fe.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5",children:fe.map(se=>e.jsx("span",{className:"px-2 py-0.5 bg-dark-border rounded text-xs text-slate-300",children:se},se))}),e.jsxs("div",{className:"text-xs text-slate-500 pt-2 border-t border-dark-border",children:["Created ",Y(c.created_at),c.updated_at!==c.created_at&&e.jsxs(e.Fragment,{children:["  Updated ",Y(c.updated_at)]})]})]})]})},c.id)})}),e.jsx(de,{isOpen:!!t,onClose:()=>r(null),onConfirm:T,title:"Delete Template",message:`Are you sure you want to delete the template "${t==null?void 0:t.title}"? This action cannot be undone.`,confirmLabel:"Delete Template",variant:"danger",loading:d})]})},Pe=[{id:"host",label:"Single Host",description:"Exclude a single IP address",placeholder:"192.168.1.1",icon:e.jsx(Ye,{className:"h-4 w-4"})},{id:"cidr",label:"CIDR Range",description:"Exclude a network range",placeholder:"192.168.1.0/24",icon:e.jsx(Bs,{className:"h-4 w-4"})},{id:"hostname",label:"Hostname Pattern",description:"Exclude by hostname (supports wildcards)",placeholder:"*.internal.example.com",icon:e.jsx(xs,{className:"h-4 w-4"})},{id:"port",label:"Single Port",description:"Exclude a specific port",placeholder:"22",icon:e.jsx(ze,{className:"h-4 w-4"})},{id:"port_range",label:"Port Range",description:"Exclude a range of ports",placeholder:"1-1000",icon:e.jsx(ze,{className:"h-4 w-4"})}],lt=()=>{const[l,y]=o.useState([]),[g,x]=o.useState(!0),[p,j]=o.useState(!1),[A,I]=o.useState(null),[s,a]=o.useState({name:"",description:"",exclusion_type:"host",value:"",is_global:!0}),[t,r]=o.useState(null),[d,w]=o.useState(!1);o.useEffect(()=>{m()},[]);const m=async()=>{x(!0);try{const h=await _e.getAll();y(h.data)}catch(h){n.error("Failed to load exclusions"),console.error(h)}finally{x(!1)}},C=()=>{a({name:"",description:"",exclusion_type:"host",value:"",is_global:!0}),I(null),j(!1)},_=h=>{a({name:h.name,description:h.description||"",exclusion_type:h.exclusion_type,value:h.value,is_global:h.is_global}),I(h.id),j(!0)},U=async h=>{var f,R;if(h.preventDefault(),!s.name.trim()){n.error("Name is required");return}if(!s.value.trim()){n.error("Value is required");return}try{const S={name:s.name.trim(),description:s.description.trim()||void 0,exclusion_type:s.exclusion_type,value:s.value.trim(),is_global:s.is_global};A?(await _e.update(A,S),n.success("Exclusion updated")):(await _e.create(S),n.success("Exclusion created")),C(),m()}catch(S){const P=S;n.error(((R=(f=P.response)==null?void 0:f.data)==null?void 0:R.error)||"Failed to save exclusion")}},M=async()=>{var h,f;if(t){w(!0);try{await _e.delete(t.id),n.success(`Exclusion "${t.name}" deleted`),m(),r(null)}catch(R){const S=R;n.error(((f=(h=S.response)==null?void 0:h.data)==null?void 0:f.error)||"Failed to delete")}finally{w(!1)}}},F=h=>Pe.find(f=>f.id===h)||Pe[0],b=l.filter(h=>h.is_global),u=l.filter(h=>!h.is_global);return g?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scan Exclusions"})]}),!p&&e.jsxs(D,{variant:"primary",onClick:()=>j(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"New Exclusion"]})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Configure hosts and ports to exclude from scans. Global exclusions apply to all scans automatically."})]}),p&&e.jsx(L,{children:e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:A?"Edit Exclusion":"Create Exclusion"}),e.jsx("button",{type:"button",onClick:C,className:"text-slate-400 hover:text-white",children:e.jsx(Ne,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:h=>a({...s,name:h.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Development Servers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Type"}),e.jsx("select",{value:s.exclusion_type,onChange:h=>a({...s,exclusion_type:h.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Pe.map(h=>e.jsx("option",{value:h.id,children:h.label},h.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Value"}),e.jsx("input",{type:"text",value:s.value,onChange:h=>a({...s,value:h.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono",placeholder:F(s.exclusion_type).placeholder}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:F(s.exclusion_type).description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description (optional)"}),e.jsx("input",{type:"text",value:s.description,onChange:h=>a({...s,description:h.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Why is this excluded?"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.is_global,onChange:h=>a({...s,is_global:h.target.checked}),className:"w-4 h-4 rounded bg-dark-bg border-dark-border text-primary focus:ring-primary focus:ring-offset-dark-bg"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Apply to all scans (global exclusion)"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(ds,{className:"h-3 w-3"}),e.jsx("span",{children:"Non-global exclusions can be selected per-scan"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(D,{type:"button",variant:"secondary",onClick:C,children:"Cancel"}),e.jsxs(D,{type:"submit",variant:"primary",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),A?"Update":"Create"]})]})]})}),l.length===0&&!p?e.jsx(L,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ls,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No exclusions configured"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create exclusions to skip specific hosts or ports during scans"})]})}):e.jsxs(e.Fragment,{children:[b.length>0&&e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xs,{className:"h-4 w-4 text-green-400"}),e.jsx("h4",{className:"font-medium text-white",children:"Global Exclusions"}),e.jsx("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-0.5 rounded",children:"Applied to all scans"})]}),e.jsx("div",{className:"space-y-2",children:b.map(h=>e.jsx(as,{exclusion:h,onEdit:_,onDelete:r},h.id))})]}),u.length>0&&e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ye,{className:"h-4 w-4 text-blue-400"}),e.jsx("h4",{className:"font-medium text-white",children:"Per-Scan Exclusions"}),e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded",children:"Select when creating scans"})]}),e.jsx("div",{className:"space-y-2",children:u.map(h=>e.jsx(as,{exclusion:h,onEdit:_,onDelete:r},h.id))})]})]}),e.jsx(de,{isOpen:!!t,onClose:()=>r(null),onConfirm:M,title:"Delete Exclusion",message:`Are you sure you want to delete the exclusion "${t==null?void 0:t.name}"? This cannot be undone.`,confirmLabel:"Delete Exclusion",variant:"danger",loading:d})]})},as=({exclusion:l,onEdit:y,onDelete:g})=>{const x=Pe.find(j=>j.id===l.exclusion_type),p=j=>{switch(j){case"host":case"cidr":return"bg-purple-500/20 text-purple-400";case"hostname":return"bg-cyan-500/20 text-cyan-400";case"port":case"port_range":return"bg-orange-500/20 text-orange-400";default:return"bg-slate-500/20 text-slate-400"}};return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"text-slate-400",children:x==null?void 0:x.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:l.name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${p(l.exclusion_type)}`,children:(x==null?void 0:x.label)||l.exclusion_type})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("code",{className:"text-sm font-mono text-slate-300 bg-dark-surface px-2 py-0.5 rounded",children:l.value}),l.description&&e.jsx("span",{className:"text-xs text-slate-500 truncate",children:l.description})]})]})]}),e.jsxs("div",{className:"flex gap-1 ml-4",children:[e.jsx("button",{onClick:()=>y(l),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit exclusion",children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>g(l),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete exclusion",children:e.jsx(ce,{className:"h-4 w-4"})})]})]})};var nt=Object.defineProperty,Fe=Object.getOwnPropertySymbols,gs=Object.prototype.hasOwnProperty,fs=Object.prototype.propertyIsEnumerable,rs=(l,y,g)=>y in l?nt(l,y,{enumerable:!0,configurable:!0,writable:!0,value:g}):l[y]=g,Ge=(l,y)=>{for(var g in y||(y={}))gs.call(y,g)&&rs(l,g,y[g]);if(Fe)for(var g of Fe(y))fs.call(y,g)&&rs(l,g,y[g]);return l},He=(l,y)=>{var g={};for(var x in l)gs.call(l,x)&&y.indexOf(x)<0&&(g[x]=l[x]);if(l!=null&&Fe)for(var x of Fe(l))y.indexOf(x)<0&&fs.call(l,x)&&(g[x]=l[x]);return g};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var he;(l=>{const y=class ${constructor(s,a,t,r){if(this.version=s,this.errorCorrectionLevel=a,this.modules=[],this.isFunction=[],s<$.MIN_VERSION||s>$.MAX_VERSION)throw new RangeError("Version value out of range");if(r<-1||r>7)throw new RangeError("Mask value out of range");this.size=s*4+17;let d=[];for(let m=0;m<this.size;m++)d.push(!1);for(let m=0;m<this.size;m++)this.modules.push(d.slice()),this.isFunction.push(d.slice());this.drawFunctionPatterns();const w=this.addEccAndInterleave(t);if(this.drawCodewords(w),r==-1){let m=1e9;for(let C=0;C<8;C++){this.applyMask(C),this.drawFormatBits(C);const _=this.getPenaltyScore();_<m&&(r=C,m=_),this.applyMask(C)}}p(0<=r&&r<=7),this.mask=r,this.applyMask(r),this.drawFormatBits(r),this.isFunction=[]}static encodeText(s,a){const t=l.QrSegment.makeSegments(s);return $.encodeSegments(t,a)}static encodeBinary(s,a){const t=l.QrSegment.makeBytes(s);return $.encodeSegments([t],a)}static encodeSegments(s,a,t=1,r=40,d=-1,w=!0){if(!($.MIN_VERSION<=t&&t<=r&&r<=$.MAX_VERSION)||d<-1||d>7)throw new RangeError("Invalid value");let m,C;for(m=t;;m++){const F=$.getNumDataCodewords(m,a)*8,b=A.getTotalBits(s,m);if(b<=F){C=b;break}if(m>=r)throw new RangeError("Data too long")}for(const F of[$.Ecc.MEDIUM,$.Ecc.QUARTILE,$.Ecc.HIGH])w&&C<=$.getNumDataCodewords(m,F)*8&&(a=F);let _=[];for(const F of s){g(F.mode.modeBits,4,_),g(F.numChars,F.mode.numCharCountBits(m),_);for(const b of F.getData())_.push(b)}p(_.length==C);const U=$.getNumDataCodewords(m,a)*8;p(_.length<=U),g(0,Math.min(4,U-_.length),_),g(0,(8-_.length%8)%8,_),p(_.length%8==0);for(let F=236;_.length<U;F^=253)g(F,8,_);let M=[];for(;M.length*8<_.length;)M.push(0);return _.forEach((F,b)=>M[b>>>3]|=F<<7-(b&7)),new $(m,a,M,d)}getModule(s,a){return 0<=s&&s<this.size&&0<=a&&a<this.size&&this.modules[a][s]}getModules(){return this.modules}drawFunctionPatterns(){for(let t=0;t<this.size;t++)this.setFunctionModule(6,t,t%2==0),this.setFunctionModule(t,6,t%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const s=this.getAlignmentPatternPositions(),a=s.length;for(let t=0;t<a;t++)for(let r=0;r<a;r++)t==0&&r==0||t==0&&r==a-1||t==a-1&&r==0||this.drawAlignmentPattern(s[t],s[r]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(s){const a=this.errorCorrectionLevel.formatBits<<3|s;let t=a;for(let d=0;d<10;d++)t=t<<1^(t>>>9)*1335;const r=(a<<10|t)^21522;p(r>>>15==0);for(let d=0;d<=5;d++)this.setFunctionModule(8,d,x(r,d));this.setFunctionModule(8,7,x(r,6)),this.setFunctionModule(8,8,x(r,7)),this.setFunctionModule(7,8,x(r,8));for(let d=9;d<15;d++)this.setFunctionModule(14-d,8,x(r,d));for(let d=0;d<8;d++)this.setFunctionModule(this.size-1-d,8,x(r,d));for(let d=8;d<15;d++)this.setFunctionModule(8,this.size-15+d,x(r,d));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let s=this.version;for(let t=0;t<12;t++)s=s<<1^(s>>>11)*7973;const a=this.version<<12|s;p(a>>>18==0);for(let t=0;t<18;t++){const r=x(a,t),d=this.size-11+t%3,w=Math.floor(t/3);this.setFunctionModule(d,w,r),this.setFunctionModule(w,d,r)}}drawFinderPattern(s,a){for(let t=-4;t<=4;t++)for(let r=-4;r<=4;r++){const d=Math.max(Math.abs(r),Math.abs(t)),w=s+r,m=a+t;0<=w&&w<this.size&&0<=m&&m<this.size&&this.setFunctionModule(w,m,d!=2&&d!=4)}}drawAlignmentPattern(s,a){for(let t=-2;t<=2;t++)for(let r=-2;r<=2;r++)this.setFunctionModule(s+r,a+t,Math.max(Math.abs(r),Math.abs(t))!=1)}setFunctionModule(s,a,t){this.modules[a][s]=t,this.isFunction[a][s]=!0}addEccAndInterleave(s){const a=this.version,t=this.errorCorrectionLevel;if(s.length!=$.getNumDataCodewords(a,t))throw new RangeError("Invalid argument");const r=$.NUM_ERROR_CORRECTION_BLOCKS[t.ordinal][a],d=$.ECC_CODEWORDS_PER_BLOCK[t.ordinal][a],w=Math.floor($.getNumRawDataModules(a)/8),m=r-w%r,C=Math.floor(w/r);let _=[];const U=$.reedSolomonComputeDivisor(d);for(let F=0,b=0;F<r;F++){let u=s.slice(b,b+C-d+(F<m?0:1));b+=u.length;const h=$.reedSolomonComputeRemainder(u,U);F<m&&u.push(0),_.push(u.concat(h))}let M=[];for(let F=0;F<_[0].length;F++)_.forEach((b,u)=>{(F!=C-d||u>=m)&&M.push(b[F])});return p(M.length==w),M}drawCodewords(s){if(s.length!=Math.floor($.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let a=0;for(let t=this.size-1;t>=1;t-=2){t==6&&(t=5);for(let r=0;r<this.size;r++)for(let d=0;d<2;d++){const w=t-d,C=(t+1&2)==0?this.size-1-r:r;!this.isFunction[C][w]&&a<s.length*8&&(this.modules[C][w]=x(s[a>>>3],7-(a&7)),a++)}}p(a==s.length*8)}applyMask(s){if(s<0||s>7)throw new RangeError("Mask value out of range");for(let a=0;a<this.size;a++)for(let t=0;t<this.size;t++){let r;switch(s){case 0:r=(t+a)%2==0;break;case 1:r=a%2==0;break;case 2:r=t%3==0;break;case 3:r=(t+a)%3==0;break;case 4:r=(Math.floor(t/3)+Math.floor(a/2))%2==0;break;case 5:r=t*a%2+t*a%3==0;break;case 6:r=(t*a%2+t*a%3)%2==0;break;case 7:r=((t+a)%2+t*a%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[a][t]&&r&&(this.modules[a][t]=!this.modules[a][t])}}getPenaltyScore(){let s=0;for(let d=0;d<this.size;d++){let w=!1,m=0,C=[0,0,0,0,0,0,0];for(let _=0;_<this.size;_++)this.modules[d][_]==w?(m++,m==5?s+=$.PENALTY_N1:m>5&&s++):(this.finderPenaltyAddHistory(m,C),w||(s+=this.finderPenaltyCountPatterns(C)*$.PENALTY_N3),w=this.modules[d][_],m=1);s+=this.finderPenaltyTerminateAndCount(w,m,C)*$.PENALTY_N3}for(let d=0;d<this.size;d++){let w=!1,m=0,C=[0,0,0,0,0,0,0];for(let _=0;_<this.size;_++)this.modules[_][d]==w?(m++,m==5?s+=$.PENALTY_N1:m>5&&s++):(this.finderPenaltyAddHistory(m,C),w||(s+=this.finderPenaltyCountPatterns(C)*$.PENALTY_N3),w=this.modules[_][d],m=1);s+=this.finderPenaltyTerminateAndCount(w,m,C)*$.PENALTY_N3}for(let d=0;d<this.size-1;d++)for(let w=0;w<this.size-1;w++){const m=this.modules[d][w];m==this.modules[d][w+1]&&m==this.modules[d+1][w]&&m==this.modules[d+1][w+1]&&(s+=$.PENALTY_N2)}let a=0;for(const d of this.modules)a=d.reduce((w,m)=>w+(m?1:0),a);const t=this.size*this.size,r=Math.ceil(Math.abs(a*20-t*10)/t)-1;return p(0<=r&&r<=9),s+=r*$.PENALTY_N4,p(0<=s&&s<=2568888),s}getAlignmentPatternPositions(){if(this.version==1)return[];{const s=Math.floor(this.version/7)+2,a=this.version==32?26:Math.ceil((this.version*4+4)/(s*2-2))*2;let t=[6];for(let r=this.size-7;t.length<s;r-=a)t.splice(1,0,r);return t}}static getNumRawDataModules(s){if(s<$.MIN_VERSION||s>$.MAX_VERSION)throw new RangeError("Version number out of range");let a=(16*s+128)*s+64;if(s>=2){const t=Math.floor(s/7)+2;a-=(25*t-10)*t-55,s>=7&&(a-=36)}return p(208<=a&&a<=29648),a}static getNumDataCodewords(s,a){return Math.floor($.getNumRawDataModules(s)/8)-$.ECC_CODEWORDS_PER_BLOCK[a.ordinal][s]*$.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][s]}static reedSolomonComputeDivisor(s){if(s<1||s>255)throw new RangeError("Degree out of range");let a=[];for(let r=0;r<s-1;r++)a.push(0);a.push(1);let t=1;for(let r=0;r<s;r++){for(let d=0;d<a.length;d++)a[d]=$.reedSolomonMultiply(a[d],t),d+1<a.length&&(a[d]^=a[d+1]);t=$.reedSolomonMultiply(t,2)}return a}static reedSolomonComputeRemainder(s,a){let t=a.map(r=>0);for(const r of s){const d=r^t.shift();t.push(0),a.forEach((w,m)=>t[m]^=$.reedSolomonMultiply(w,d))}return t}static reedSolomonMultiply(s,a){if(s>>>8||a>>>8)throw new RangeError("Byte out of range");let t=0;for(let r=7;r>=0;r--)t=t<<1^(t>>>7)*285,t^=(a>>>r&1)*s;return p(t>>>8==0),t}finderPenaltyCountPatterns(s){const a=s[1];p(a<=this.size*3);const t=a>0&&s[2]==a&&s[3]==a*3&&s[4]==a&&s[5]==a;return(t&&s[0]>=a*4&&s[6]>=a?1:0)+(t&&s[6]>=a*4&&s[0]>=a?1:0)}finderPenaltyTerminateAndCount(s,a,t){return s&&(this.finderPenaltyAddHistory(a,t),a=0),a+=this.size,this.finderPenaltyAddHistory(a,t),this.finderPenaltyCountPatterns(t)}finderPenaltyAddHistory(s,a){a[0]==0&&(s+=this.size),a.pop(),a.unshift(s)}};y.MIN_VERSION=1,y.MAX_VERSION=40,y.PENALTY_N1=3,y.PENALTY_N2=3,y.PENALTY_N3=40,y.PENALTY_N4=10,y.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],y.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],l.QrCode=y;function g(I,s,a){if(s<0||s>31||I>>>s)throw new RangeError("Value out of range");for(let t=s-1;t>=0;t--)a.push(I>>>t&1)}function x(I,s){return(I>>>s&1)!=0}function p(I){if(!I)throw new Error("Assertion error")}const j=class q{constructor(s,a,t){if(this.mode=s,this.numChars=a,this.bitData=t,a<0)throw new RangeError("Invalid argument");this.bitData=t.slice()}static makeBytes(s){let a=[];for(const t of s)g(t,8,a);return new q(q.Mode.BYTE,s.length,a)}static makeNumeric(s){if(!q.isNumeric(s))throw new RangeError("String contains non-numeric characters");let a=[];for(let t=0;t<s.length;){const r=Math.min(s.length-t,3);g(parseInt(s.substring(t,t+r),10),r*3+1,a),t+=r}return new q(q.Mode.NUMERIC,s.length,a)}static makeAlphanumeric(s){if(!q.isAlphanumeric(s))throw new RangeError("String contains unencodable characters in alphanumeric mode");let a=[],t;for(t=0;t+2<=s.length;t+=2){let r=q.ALPHANUMERIC_CHARSET.indexOf(s.charAt(t))*45;r+=q.ALPHANUMERIC_CHARSET.indexOf(s.charAt(t+1)),g(r,11,a)}return t<s.length&&g(q.ALPHANUMERIC_CHARSET.indexOf(s.charAt(t)),6,a),new q(q.Mode.ALPHANUMERIC,s.length,a)}static makeSegments(s){return s==""?[]:q.isNumeric(s)?[q.makeNumeric(s)]:q.isAlphanumeric(s)?[q.makeAlphanumeric(s)]:[q.makeBytes(q.toUtf8ByteArray(s))]}static makeEci(s){let a=[];if(s<0)throw new RangeError("ECI assignment value out of range");if(s<128)g(s,8,a);else if(s<16384)g(2,2,a),g(s,14,a);else if(s<1e6)g(6,3,a),g(s,21,a);else throw new RangeError("ECI assignment value out of range");return new q(q.Mode.ECI,0,a)}static isNumeric(s){return q.NUMERIC_REGEX.test(s)}static isAlphanumeric(s){return q.ALPHANUMERIC_REGEX.test(s)}getData(){return this.bitData.slice()}static getTotalBits(s,a){let t=0;for(const r of s){const d=r.mode.numCharCountBits(a);if(r.numChars>=1<<d)return 1/0;t+=4+d+r.bitData.length}return t}static toUtf8ByteArray(s){s=encodeURI(s);let a=[];for(let t=0;t<s.length;t++)s.charAt(t)!="%"?a.push(s.charCodeAt(t)):(a.push(parseInt(s.substring(t+1,t+3),16)),t+=2);return a}};j.NUMERIC_REGEX=/^[0-9]*$/,j.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,j.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let A=j;l.QrSegment=j})(he||(he={}));(l=>{(y=>{const g=class{constructor(p,j){this.ordinal=p,this.formatBits=j}};g.LOW=new g(0,1),g.MEDIUM=new g(1,0),g.QUARTILE=new g(2,3),g.HIGH=new g(3,2),y.Ecc=g})(l.QrCode||(l.QrCode={}))})(he||(he={}));(l=>{(y=>{const g=class{constructor(p,j){this.modeBits=p,this.numBitsCharCount=j}numCharCountBits(p){return this.numBitsCharCount[Math.floor((p+7)/17)]}};g.NUMERIC=new g(1,[10,12,14]),g.ALPHANUMERIC=new g(2,[9,11,13]),g.BYTE=new g(4,[8,16,16]),g.KANJI=new g(8,[8,10,12]),g.ECI=new g(7,[0,0,0]),y.Mode=g})(l.QrSegment||(l.QrSegment={}))})(he||(he={}));var ye=he;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var it={L:ye.QrCode.Ecc.LOW,M:ye.QrCode.Ecc.MEDIUM,Q:ye.QrCode.Ecc.QUARTILE,H:ye.QrCode.Ecc.HIGH},js=128,bs="L",ys="#FFFFFF",Ns="#000000",vs=!1,ws=1,ct=4,ot=0,dt=.1;function ks(l,y=0){const g=[];return l.forEach(function(x,p){let j=null;x.forEach(function(A,I){if(!A&&j!==null){g.push(`M${j+y} ${p+y}h${I-j}v1H${j+y}z`),j=null;return}if(I===x.length-1){if(!A)return;j===null?g.push(`M${I+y},${p+y} h1v1H${I+y}z`):g.push(`M${j+y},${p+y} h${I+1-j}v1H${j+y}z`);return}A&&j===null&&(j=I)})}),g.join("")}function Ss(l,y){return l.slice().map((g,x)=>x<y.y||x>=y.y+y.h?g:g.map((p,j)=>j<y.x||j>=y.x+y.w?p:!1))}function mt(l,y,g,x){if(x==null)return null;const p=l.length+g*2,j=Math.floor(y*dt),A=p/y,I=(x.width||j)*A,s=(x.height||j)*A,a=x.x==null?l.length/2-I/2:x.x*A,t=x.y==null?l.length/2-s/2:x.y*A,r=x.opacity==null?1:x.opacity;let d=null;if(x.excavate){let m=Math.floor(a),C=Math.floor(t),_=Math.ceil(I+a-m),U=Math.ceil(s+t-C);d={x:m,y:C,w:_,h:U}}const w=x.crossOrigin;return{x:a,y:t,h:s,w:I,excavation:d,opacity:r,crossOrigin:w}}function xt(l,y){return y!=null?Math.max(Math.floor(y),0):l?ct:ot}function _s({value:l,level:y,minVersion:g,includeMargin:x,marginSize:p,imageSettings:j,size:A,boostLevel:I}){let s=Z.useMemo(()=>{const m=(Array.isArray(l)?l:[l]).reduce((C,_)=>(C.push(...ye.QrSegment.makeSegments(_)),C),[]);return ye.QrCode.encodeSegments(m,it[y],g,void 0,void 0,I)},[l,y,g,I]);const{cells:a,margin:t,numCells:r,calculatedImageSettings:d}=Z.useMemo(()=>{let w=s.getModules();const m=xt(x,p),C=w.length+m*2,_=mt(w,A,m,j);return{cells:w,margin:m,numCells:C,calculatedImageSettings:_}},[s,A,j,x,p]);return{qrcode:s,margin:t,cells:a,numCells:r,calculatedImageSettings:d}}var ut=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),ht=Z.forwardRef(function(y,g){const x=y,{value:p,size:j=js,level:A=bs,bgColor:I=ys,fgColor:s=Ns,includeMargin:a=vs,minVersion:t=ws,boostLevel:r,marginSize:d,imageSettings:w}=x,C=He(x,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:_}=C,U=He(C,["style"]),M=w==null?void 0:w.src,F=Z.useRef(null),b=Z.useRef(null),u=Z.useCallback(v=>{F.current=v,typeof g=="function"?g(v):g&&(g.current=v)},[g]),[h,f]=Z.useState(!1),{margin:R,cells:S,numCells:P,calculatedImageSettings:N}=_s({value:p,level:A,minVersion:t,boostLevel:r,includeMargin:a,marginSize:d,imageSettings:w,size:j});Z.useEffect(()=>{if(F.current!=null){const v=F.current,E=v.getContext("2d");if(!E)return;let K=S;const J=b.current,T=N!=null&&J!==null&&J.complete&&J.naturalHeight!==0&&J.naturalWidth!==0;T&&N.excavation!=null&&(K=Ss(S,N.excavation));const O=window.devicePixelRatio||1;v.height=v.width=j*O;const G=j/P*O;E.scale(G,G),E.fillStyle=I,E.fillRect(0,0,P,P),E.fillStyle=s,ut?E.fill(new Path2D(ks(K,R))):S.forEach(function(V,Y){V.forEach(function(ee,z){ee&&E.fillRect(z+R,Y+R,1,1)})}),N&&(E.globalAlpha=N.opacity),T&&E.drawImage(J,N.x+R,N.y+R,N.w,N.h)}}),Z.useEffect(()=>{f(!1)},[M]);const k=Ge({height:j,width:j},_);let i=null;return M!=null&&(i=Z.createElement("img",{src:M,key:M,style:{display:"none"},onLoad:()=>{f(!0)},ref:b,crossOrigin:N==null?void 0:N.crossOrigin})),Z.createElement(Z.Fragment,null,Z.createElement("canvas",Ge({style:k,height:j,width:j,ref:u,role:"img"},U)),i)});ht.displayName="QRCodeCanvas";var Cs=Z.forwardRef(function(y,g){const x=y,{value:p,size:j=js,level:A=bs,bgColor:I=ys,fgColor:s=Ns,includeMargin:a=vs,minVersion:t=ws,boostLevel:r,title:d,marginSize:w,imageSettings:m}=x,C=He(x,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:_,cells:U,numCells:M,calculatedImageSettings:F}=_s({value:p,level:A,minVersion:t,boostLevel:r,includeMargin:a,marginSize:w,imageSettings:m,size:j});let b=U,u=null;m!=null&&F!=null&&(F.excavation!=null&&(b=Ss(U,F.excavation)),u=Z.createElement("image",{href:m.src,height:F.h,width:F.w,x:F.x+_,y:F.y+_,preserveAspectRatio:"none",opacity:F.opacity,crossOrigin:F.crossOrigin}));const h=ks(b,_);return Z.createElement("svg",Ge({height:j,width:j,viewBox:`0 0 ${M} ${M}`,ref:g,role:"img"},C),!!d&&Z.createElement("title",null,d),Z.createElement("path",{fill:I,d:`M0,0 h${M}v${M}H0z`,shapeRendering:"crispEdges"}),Z.createElement("path",{fill:s,d:h,shapeRendering:"crispEdges"}),u)});Cs.displayName="QRCodeSVG";const pt=()=>{const[l,y]=o.useState(!1),[g,x]=o.useState(!0),[p,j]=o.useState("idle"),[A,I]=o.useState(""),[s,a]=o.useState(""),[t,r]=o.useState([]),[d,w]=o.useState(""),[m,C]=o.useState(!1),[_,U]=o.useState(!1),[M,F]=o.useState(""),[b,u]=o.useState(""),[h,f]=o.useState(!1),[R,S]=o.useState(!1),[P,N]=o.useState(""),[k,i]=o.useState(""),[v,E]=o.useState(!1);o.useEffect(()=>{K()},[]);const K=async()=>{x(!0);try{const z=await Ee.me();y(z.data.mfa_enabled||!1)}catch(z){console.error("Failed to check MFA status:",z)}finally{x(!1)}},J=async()=>{var z,W;try{const c=await Ce.setup();I(c.data.secret),a(c.data.qr_code_url),r(c.data.recovery_codes),j("scan-qr")}catch(c){const B=c;n.error(((W=(z=B.response)==null?void 0:z.data)==null?void 0:W.error)||"Failed to initialize MFA setup")}},T=async z=>{var W,c;if(z.preventDefault(),!d||d.length!==6){n.error("Please enter a valid 6-digit code");return}C(!0);try{await Ce.verifySetup({totp_code:d}),n.success("MFA enabled successfully!"),j("show-recovery"),y(!0)}catch(B){const H=B;n.error(((c=(W=H.response)==null?void 0:W.data)==null?void 0:c.error)||"Invalid verification code")}finally{C(!1)}},O=()=>{j("idle"),I(""),a(""),r([]),w("")},G=async z=>{var W,c;if(z.preventDefault(),!M||!b){n.error("Password and TOTP code are required");return}f(!0);try{await Ce.disable({password:M,totp_code:b}),n.success("MFA disabled successfully"),y(!1),U(!1),F(""),u("")}catch(B){const H=B;n.error(((c=(W=H.response)==null?void 0:W.data)==null?void 0:c.error)||"Failed to disable MFA")}finally{f(!1)}},V=async z=>{var W,c;if(z.preventDefault(),!P||!k){n.error("Password and TOTP code are required");return}E(!0);try{const B=await Ce.regenerateRecoveryCodes({password:P,totp_code:k});r(B.data.recovery_codes),n.success("Recovery codes regenerated successfully"),S(!1),N(""),i(""),j("show-recovery")}catch(B){const H=B;n.error(((c=(W=H.response)==null?void 0:W.data)==null?void 0:c.error)||"Failed to regenerate recovery codes")}finally{E(!1)}},Y=z=>{navigator.clipboard.writeText(z),n.success("Copied to clipboard")},ee=()=>{const z=new Blob([t.join(`
`)],{type:"text/plain"}),W=URL.createObjectURL(z),c=document.createElement("a");c.href=W,c.download="heroforge-recovery-codes.txt",document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(W),n.success("Recovery codes downloaded")};return g?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{})})}):p!=="idle"?e.jsx("div",{className:"space-y-6",children:e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ie,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Enable Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{className:p==="scan-qr"?"text-primary":"",children:"1. Scan QR"}),e.jsx("span",{children:""}),e.jsx("span",{className:p==="verify-code"?"text-primary":"",children:"2. Verify"}),e.jsx("span",{children:""}),e.jsx("span",{className:p==="show-recovery"?"text-primary":"",children:"3. Save Codes"})]})]}),p==="scan-qr"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 1: Scan QR Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Use an authenticator app like Google Authenticator, Authy, or 1Password to scan this QR code:"}),s&&e.jsx("div",{className:"bg-white p-4 rounded-lg mb-4",children:e.jsx(Cs,{value:s,size:256,level:"M",marginSize:2})}),e.jsxs("div",{className:"mt-4 w-full max-w-md",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Or enter this secret manually:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(X,{type:"text",value:A,readOnly:!0,className:"font-mono text-sm flex-1"}),e.jsx(D,{variant:"secondary",onClick:()=>Y(A),children:e.jsx(Ie,{className:"h-4 w-4"})})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(D,{variant:"primary",onClick:()=>j("verify-code"),children:"Next: Verify Code"})})]}),p==="verify-code"&&e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(qe,{className:"h-12 w-12 text-primary mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 2: Verify Your Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Enter the 6-digit code from your authenticator app to confirm setup:"}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsx(X,{type:"text",value:d,onChange:z=>w(z.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center text-2xl tracking-widest font-mono",maxLength:6,autoFocus:!0})})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(D,{type:"button",variant:"secondary",onClick:()=>j("scan-qr"),children:"Back"}),e.jsx(D,{type:"submit",variant:"primary",loading:m,disabled:m||d.length!==6,children:"Verify & Enable MFA"})]})]}),p==="show-recovery"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ne,{className:"h-6 w-6 text-yellow-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-yellow-400 mb-2",children:"Save Your Recovery Codes"}),e.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Store these recovery codes in a safe place. Each code can be used once to access your account if you lose your authenticator device."}),e.jsx("div",{className:"grid grid-cols-2 gap-2 bg-dark-bg rounded-lg p-4 font-mono text-sm mb-4",children:t.map((z,W)=>e.jsxs("div",{className:"text-white",children:[W+1,". ",z]},W))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{variant:"secondary",onClick:()=>Y(t.join(`
`)),children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Copy Codes"]}),e.jsxs(D,{variant:"secondary",onClick:ee,children:[e.jsx(Gs,{className:"h-4 w-4 mr-2"}),"Download Codes"]})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(D,{variant:"primary",onClick:O,children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Finish Setup"]})})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ie,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-start justify-between mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[l?e.jsx(oe,{className:"h-6 w-6 text-green-400 flex-shrink-0"}):e.jsx(ne,{className:"h-6 w-6 text-yellow-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white mb-1",children:l?"MFA Enabled":"MFA Disabled"}),e.jsx("p",{className:"text-sm text-slate-400",children:l?"Your account is protected with two-factor authentication.":"Enable MFA to add an extra layer of security to your account."})]})]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${l?"bg-green-400":"bg-yellow-400"}`})]}),l?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(De,{className:"h-5 w-5 text-primary"}),e.jsx("h5",{className:"font-medium text-white",children:"Recovery Codes"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Generate new recovery codes if you've lost the originals or used them."}),e.jsx(D,{variant:"secondary",size:"sm",onClick:()=>S(!0),children:"Regenerate Codes"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Re,{className:"h-5 w-5 text-red-400"}),e.jsx("h5",{className:"font-medium text-white",children:"Disable MFA"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Turn off two-factor authentication for your account."}),e.jsx(D,{variant:"danger",size:"sm",onClick:()=>U(!0),children:"Disable MFA"})]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h5",{className:"text-white font-medium mb-2",children:"Why enable MFA?"}),e.jsxs("ul",{className:"text-sm text-slate-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Adds an extra layer of security beyond your password"}),e.jsx("li",{children:"Prevents unauthorized access even if your password is compromised"}),e.jsx("li",{children:"Uses time-based codes from your smartphone"}),e.jsx("li",{children:"Industry standard for securing sensitive accounts"})]})]}),e.jsxs(D,{variant:"primary",onClick:J,children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"Enable Two-Factor Authentication"]})]})]}),_&&e.jsx(L,{children:e.jsxs("form",{onSubmit:G,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Disable Two-Factor Authentication"}),e.jsxs("button",{type:"button",onClick:()=>{U(!1),F(""),u("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"Disabling MFA will make your account less secure. You'll need to provide your password and a TOTP code to confirm."})}),e.jsx(X,{label:"Password",type:"password",value:M,onChange:z=>F(z.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(X,{label:"TOTP Code",type:"text",value:b,onChange:z=>u(z.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(D,{type:"button",variant:"secondary",onClick:()=>{U(!1),F(""),u("")},children:"Cancel"}),e.jsx(D,{type:"submit",variant:"danger",loading:h,disabled:h||!M||b.length!==6,children:"Disable MFA"})]})]})}),R&&e.jsx(L,{children:e.jsxs("form",{onSubmit:V,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Regenerate Recovery Codes"}),e.jsxs("button",{type:"button",onClick:()=>{S(!1),N(""),i("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"This will invalidate all existing recovery codes. Make sure to save the new codes in a safe place."})}),e.jsx(X,{label:"Password",type:"password",value:P,onChange:z=>N(z.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(X,{label:"TOTP Code",type:"text",value:k,onChange:z=>i(z.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(D,{type:"button",variant:"secondary",onClick:()=>{S(!1),N(""),i("")},children:"Cancel"}),e.jsx(D,{type:"submit",variant:"primary",loading:v,disabled:v||!P||k.length!==6,children:"Generate New Codes"})]})]})})]})},gt=()=>{const[l,y]=o.useState([]),[g,x]=o.useState(!0),[p,j]=o.useState(!1),[A,I]=o.useState(""),[s,a]=o.useState(!1),[t,r]=o.useState(null),[d,w]=o.useState(null),[m,C]=o.useState(!1);o.useEffect(()=>{_()},[]);const _=async()=>{x(!0);try{const u=await Me.getAll();y(u.data)}catch(u){n.error("Failed to load API keys"),console.error(u)}finally{x(!1)}},U=async()=>{var u,h;if(!A.trim()){n.error("Please enter a name for the API key");return}a(!0);try{const f=await Me.create({name:A.trim()});r(f.data),I(""),await _(),n.success("API key created successfully")}catch(f){const R=f;n.error(((h=(u=R.response)==null?void 0:u.data)==null?void 0:h.error)||"Failed to create API key")}finally{a(!1)}},M=async()=>{var u,h;if(d){C(!0);try{await Me.delete(d.id),await _(),n.success(`API key "${d.name}" revoked successfully`),w(null)}catch(f){const R=f;n.error(((h=(u=R.response)==null?void 0:u.data)==null?void 0:h.error)||"Failed to revoke API key")}finally{C(!1)}}},F=u=>{navigator.clipboard.writeText(u),n.success("API key copied to clipboard")},b=()=>{r(null),j(!1)};return g?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Keys"})]}),e.jsxs(D,{variant:"primary",onClick:()=>j(!0),className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"Create API Key"]})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"API keys allow programmatic access to HeroForge. Keep your keys secure and never share them publicly."}),l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(De,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No API keys yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Create your first API key to get started"})]}):e.jsx("div",{className:"space-y-3",children:l.map(u=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary/30 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-medium text-white",children:u.name}),e.jsxs("code",{className:"px-2 py-1 bg-dark-surface rounded text-xs text-slate-400 font-mono",children:[u.prefix,"..."]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ke,{className:"h-3 w-3"}),"Created ",new Date(u.created_at).toLocaleDateString()]}),u.last_used_at&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),"Last used ",new Date(u.last_used_at).toLocaleDateString()]}),!u.last_used_at&&e.jsx("span",{className:"text-amber-500",children:"Never used"})]})]}),e.jsxs(D,{variant:"danger",size:"sm",onClick:()=>w(u),className:"flex items-center gap-2","aria-label":`Revoke API key ${u.name}`,children:[e.jsx(ce,{className:"h-4 w-4"}),"Revoke"]})]},u.id))})]}),p&&!t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Create API Key"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Key Name"}),e.jsx("input",{type:"text",value:A,onChange:u=>I(u.target.value),placeholder:"e.g., Production Server, CI/CD Pipeline",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",autoFocus:!0}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Give your API key a descriptive name to remember where it's used"})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4",children:[e.jsx(D,{variant:"secondary",onClick:()=>{j(!1),I("")},children:"Cancel"}),e.jsx(D,{variant:"primary",onClick:U,disabled:s||!A.trim(),children:s?e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx("span",{className:"ml-2",children:"Creating..."})]}):"Create Key"})]})]})]})}),t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-2xl w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(oe,{className:"h-6 w-6 text-green-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Key Created Successfully"})]}),e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-amber-200 font-medium mb-2",children:"Important: Save your API key now!"}),e.jsx("p",{className:"text-xs text-amber-300/70",children:"This is the only time you'll see the full key. If you lose it, you'll need to create a new one."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"API Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("code",{className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-3 text-white font-mono text-sm break-all",children:t.key}),e.jsxs(D,{variant:"secondary",onClick:()=>F(t.key),className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-4 w-4"}),"Copy"]})]})]}),e.jsxs("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-200 mb-2",children:"Using your API key"}),e.jsx("p",{className:"text-xs text-blue-300/70 mb-3",children:"Include your API key in the X-API-Key header:"}),e.jsxs("code",{className:"block bg-dark-bg border border-dark-border rounded px-3 py-2 text-xs text-slate-300 font-mono",children:['curl -H "X-API-Key: ',t.key,'" https://heroforge.example.com/api/scans']})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(D,{variant:"primary",onClick:b,children:"Done"})})]})]})}),e.jsx(de,{isOpen:!!d,onClose:()=>w(null),onConfirm:M,title:"Revoke API Key",message:`Are you sure you want to revoke the API key "${d==null?void 0:d.name}"? Any applications using this key will lose access immediately.`,confirmLabel:"Revoke Key",variant:"danger",loading:m})]})},ft=()=>{const[l,y]=o.useState(!0),[g,x]=o.useState(!1),[p,j]=o.useState(!1),[A,I]=o.useState(!1),[s,a]=o.useState({jira_url:"",username:"",api_token:"",project_key:"",issue_type:"Task",default_assignee:"",enabled:!0}),[t,r]=o.useState([]),[d,w]=o.useState([]),[m,C]=o.useState(!1);o.useEffect(()=>{_()},[]);const _=async()=>{var u;y(!0);try{const h=await we.getSettings();a(h.data),I(!0)}catch(h){((u=h.response)==null?void 0:u.status)===404?I(!1):console.error("Failed to load JIRA settings:",h)}finally{y(!1)}},U=async()=>{var u,h;if(!s.jira_url||!s.username||!s.api_token||!s.project_key){n.error("Please fill in all required fields");return}x(!0);try{await we.updateSettings(s),n.success("JIRA settings saved successfully"),I(!0)}catch(f){const R=f;console.error("Failed to save JIRA settings:",f),n.error(((h=(u=R.response)==null?void 0:u.data)==null?void 0:h.error)||"Failed to save JIRA settings")}finally{x(!1)}},M=async()=>{var u,h;if(!A){n.error("Please save your settings first");return}j(!0);try{await we.testConnection(),n.success("JIRA connection successful!")}catch(f){const R=f;console.error("JIRA connection failed:",f),n.error(((h=(u=R.response)==null?void 0:u.data)==null?void 0:h.error)||"JIRA connection failed")}finally{j(!1)}},F=async()=>{var u,h;if(!A){n.error("Please save your settings first");return}C(!0);try{const f=await we.listProjects();r(f.data),n.success(`Loaded ${f.data.length} projects`)}catch(f){const R=f;console.error("Failed to load projects:",f),n.error(((h=(u=R.response)==null?void 0:u.data)==null?void 0:h.error)||"Failed to load projects")}finally{C(!1)}},b=async()=>{var u,h;if(!A||!s.project_key){n.error("Please save your settings and select a project first");return}C(!0);try{const f=await we.listIssueTypes();w(f.data),n.success(`Loaded ${f.data.length} issue types`)}catch(f){const R=f;console.error("Failed to load issue types:",f),n.error(((h=(u=R.response)==null?void 0:u.data)==null?void 0:h.error)||"Failed to load issue types")}finally{C(!1)}};return l?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(us,{className:"h-6 w-6 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"JIRA Integration"})]}),e.jsxs("div",{className:"space-y-4",children:[!A&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(ne,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"JIRA Integration Not Configured"}),e.jsx("p",{children:"Configure your JIRA instance to automatically create tickets from vulnerabilities."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["JIRA URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(X,{type:"url",placeholder:"https://your-domain.atlassian.net",value:s.jira_url,onChange:u=>a({...s,jira_url:u.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your JIRA instance URL (e.g., https://company.atlassian.net)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Username/Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(X,{type:"text",placeholder:"user@example.com",value:s.username,onChange:u=>a({...s,username:u.target.value})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["API Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(X,{type:"password",placeholder:"Your JIRA API token",value:s.api_token,onChange:u=>a({...s,api_token:u.target.value})}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Generate an API token at"," ",e.jsxs("a",{href:"https://id.atlassian.com/manage-profile/security/api-tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 inline-flex items-center gap-1",children:["Atlassian Account Settings ",e.jsx(Je,{className:"h-3 w-3"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Key ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:t.length>0?e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:s.project_key,onChange:u=>a({...s,project_key:u.target.value}),children:[e.jsx("option",{value:"",children:"Select a project"}),t.map(u=>e.jsxs("option",{value:u.key,children:[u.name," (",u.key,")"]},u.key))]}):e.jsx(X,{type:"text",placeholder:"PROJECT",value:s.project_key,onChange:u=>a({...s,project_key:u.target.value})})}),e.jsx(D,{onClick:F,disabled:!A||m,variant:"secondary",children:m?"Loading...":"Load Projects"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Issue Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:d.length>0?e.jsx("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:s.issue_type,onChange:u=>a({...s,issue_type:u.target.value}),children:d.map(u=>e.jsx("option",{value:u.name,children:u.name},u.id))}):e.jsx(X,{type:"text",placeholder:"Task",value:s.issue_type,onChange:u=>a({...s,issue_type:u.target.value})})}),e.jsx(D,{onClick:b,disabled:!A||!s.project_key||m,variant:"secondary",children:m?"Loading...":"Load Types"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Assignee (optional)"}),e.jsx(X,{type:"text",placeholder:"username",value:s.default_assignee||"",onChange:u=>a({...s,default_assignee:u.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Leave empty for unassigned or enter a JIRA username"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"jira-enabled",checked:s.enabled,onChange:u=>a({...s,enabled:u.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"jira-enabled",className:"text-sm font-medium text-gray-700",children:"Enable JIRA integration"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(D,{onClick:U,disabled:g,children:g?"Saving...":"Save Settings"}),e.jsx(D,{onClick:M,disabled:!A||p,variant:"secondary",children:p?"Testing...":"Test Connection"})]}),A&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(oe,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("p",{className:"font-medium",children:"JIRA Integration Configured"}),e.jsx("p",{children:"You can now create JIRA tickets from vulnerabilities."})]})]})]})]}),e.jsxs(L,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"How to Use JIRA Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Configure your JIRA instance settings above and test the connection."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Navigate to any vulnerability in your scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"3"})}),e.jsx("p",{children:'Click the "Create JIRA Ticket" button to automatically create an issue with vulnerability details.'})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"The vulnerability will be linked to the JIRA ticket, and you can track it in your JIRA project."})]})]})]})]})},jt=()=>{const[l,y]=o.useState([]),[g,x]=o.useState(!0),[p,j]=o.useState(!1),[A,I]=o.useState(null),[s,a]=o.useState(null),[t,r]=o.useState(null),[d,w]=o.useState(!1),[m,C]=o.useState([]),[_,U]=o.useState(!1),[M,F]=o.useState(""),[b,u]=o.useState(!1);o.useEffect(()=>{h(),S()},[]);const h=async()=>{x(!0);try{const N=await be.getSettings();y(N.data)}catch(N){n.error("Failed to load SIEM settings"),console.error(N)}finally{x(!1)}},f=async N=>{var k,i;a(N);try{const v=await be.testConnection(N);v.data.success?n.success("Connection test successful!"):n.error(`Connection test failed: ${v.data.message}`)}catch(v){const E=v;n.error(((i=(k=E.response)==null?void 0:k.data)==null?void 0:i.error)||"Connection test failed")}finally{a(null)}},R=async()=>{var N,k;if(t){w(!0);try{await be.deleteSettings(t.id),n.success(`${t.siem_type.toUpperCase()} integration deleted`),h(),r(null)}catch(i){const v=i;n.error(((k=(N=v.response)==null?void 0:N.data)==null?void 0:k.error)||"Failed to delete SIEM integration")}finally{w(!1)}}},S=async()=>{U(!0);try{const N=await As.getAll();C(N.data.filter(k=>k.status==="completed"))}catch(N){console.error("Failed to load scans:",N)}finally{U(!1)}},P=async()=>{var k,i;if(!M){n.error("Please select a scan to export");return}if(l.filter(v=>v.enabled).length===0){n.error("No enabled SIEM integrations found. Please enable at least one integration.");return}u(!0);try{const v=await be.exportScan(M);v.data.success?(n.success(`Scan exported to ${v.data.exported_to} SIEM integration(s). ${v.data.events_count} events sent.`),v.data.errors&&v.data.errors.length>0&&v.data.errors.forEach(E=>n.warning(E))):n.error("Export failed. Check SIEM configuration.")}catch(v){const E=v;n.error(((i=(k=E.response)==null?void 0:k.data)==null?void 0:i.error)||"Failed to export scan to SIEM")}finally{u(!1)}};return g?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"SIEM Integrations"})]}),e.jsxs(D,{variant:"primary",onClick:()=>j(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Add Integration"]})]}),l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ye,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"No SIEM integrations configured"}),e.jsxs(D,{variant:"primary",onClick:()=>j(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Add Your First Integration"]})]}):e.jsx("div",{className:"space-y-4",children:l.map(N=>e.jsx("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-primary/20 text-primary rounded-md text-sm font-medium uppercase",children:N.siem_type}),N.enabled?e.jsxs("span",{className:"flex items-center gap-1 text-green-400 text-sm",children:[e.jsx(oe,{className:"h-4 w-4"}),"Enabled"]}):e.jsxs("span",{className:"flex items-center gap-1 text-slate-500 text-sm",children:[e.jsx(We,{className:"h-4 w-4"}),"Disabled"]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Endpoint:"}),e.jsx("span",{className:"text-white font-mono",children:N.endpoint_url})]}),N.protocol&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Protocol:"}),e.jsx("span",{className:"text-white uppercase",children:N.protocol})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:N.export_on_scan_complete,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export on scan complete"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:N.export_on_critical_vuln,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export critical vulnerabilities"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{variant:"outline",size:"sm",onClick:()=>f(N.id),disabled:s===N.id,children:s===N.id?e.jsx(Q,{}):e.jsx(Hs,{className:"h-4 w-4"})}),e.jsx(D,{variant:"outline",size:"sm",onClick:()=>I(N),children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx(D,{variant:"outline",size:"sm",onClick:()=>r(N),"aria-label":`Delete ${N.siem_type} integration`,children:e.jsx(ce,{className:"h-4 w-4 text-red-400"})})]})]})},N.id))})]}),e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Manual Export"})]}),e.jsx(D,{variant:"outline",size:"sm",onClick:S,disabled:_,children:_?e.jsx(Q,{}):e.jsx(Ks,{className:"h-4 w-4"})})]}),l.filter(N=>N.enabled).length===0?e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(We,{className:"h-5 w-5 text-amber-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-200",children:[e.jsx("p",{className:"font-medium mb-1",children:"No Enabled Integrations"}),e.jsx("p",{children:"Enable at least one SIEM integration above before exporting scan results."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Manually export scan results to all enabled SIEM integrations."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:M,onChange:N=>F(N.target.value),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",disabled:_||b,children:[e.jsx("option",{value:"",children:"Select a completed scan..."}),m.map(N=>e.jsxs("option",{value:N.id,children:[N.name," - ",new Date(N.created_at).toLocaleDateString()," ",new Date(N.created_at).toLocaleTimeString()]},N.id))]}),e.jsx(D,{variant:"primary",onClick:P,disabled:!M||b||_,children:b?e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx("span",{className:"ml-2",children:"Exporting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Export to SIEM"]})})]}),m.length===0&&!_&&e.jsx("p",{className:"text-sm text-slate-500",children:"No completed scans available for export."}),e.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["Export will send data to: ",l.filter(N=>N.enabled).map(N=>N.siem_type.toUpperCase()).join(", ")]})]})]}),e.jsxs(L,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"About SIEM Integration"}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-400",children:[e.jsx("p",{children:"SIEM (Security Information and Event Management) integration allows HeroForge to automatically export scan results and vulnerability findings to your security monitoring platform."}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Syslog:"})," RFC 5424 compliant syslog over TCP/UDP"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Splunk:"})," Splunk HTTP Event Collector (HEC)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Elasticsearch:"})," Direct indexing via Bulk API"]})]})]})]}),(p||A)&&e.jsx(bt,{settings:A,onClose:()=>{j(!1),I(null)},onSave:()=>{j(!1),I(null),h()}}),e.jsx(de,{isOpen:!!t,onClose:()=>r(null),onConfirm:R,title:"Delete SIEM Integration",message:`Are you sure you want to delete the ${t==null?void 0:t.siem_type.toUpperCase()} integration? Automatic exports to this endpoint will stop.`,confirmLabel:"Delete Integration",variant:"danger",loading:d})]})},bt=({settings:l,onClose:y,onSave:g})=>{const[x,p]=o.useState({siem_type:(l==null?void 0:l.siem_type)||"syslog",endpoint_url:(l==null?void 0:l.endpoint_url)||"",api_key:(l==null?void 0:l.api_key)||"",protocol:(l==null?void 0:l.protocol)||"tcp",enabled:(l==null?void 0:l.enabled)??!0,export_on_scan_complete:(l==null?void 0:l.export_on_scan_complete)??!1,export_on_critical_vuln:(l==null?void 0:l.export_on_critical_vuln)??!0}),[j,A]=o.useState(!1),I=async s=>{var a,t;if(s.preventDefault(),!x.endpoint_url){n.error("Endpoint URL is required");return}if(x.siem_type==="splunk"&&!x.api_key){n.error("API key is required for Splunk HEC");return}A(!0);try{if(l){const r={endpoint_url:x.endpoint_url,enabled:x.enabled,export_on_scan_complete:x.export_on_scan_complete,export_on_critical_vuln:x.export_on_critical_vuln};x.api_key&&(r.api_key=x.api_key),x.siem_type==="syslog"&&(r.protocol=x.protocol),await be.updateSettings(l.id,r),n.success("SIEM integration updated")}else{const r={siem_type:x.siem_type,endpoint_url:x.endpoint_url,enabled:x.enabled,export_on_scan_complete:x.export_on_scan_complete,export_on_critical_vuln:x.export_on_critical_vuln};x.api_key&&(r.api_key=x.api_key),x.siem_type==="syslog"&&(r.protocol=x.protocol),await be.createSettings(r),n.success("SIEM integration created")}g()}catch(r){const d=r;n.error(((t=(a=d.response)==null?void 0:a.data)==null?void 0:t.error)||"Failed to save SIEM integration")}finally{A(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white",children:[l?"Edit":"Add"," SIEM Integration"]}),e.jsx("button",{onClick:y,className:"text-slate-400 hover:text-white",children:e.jsx(Ne,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:I,className:"p-6 space-y-6",children:[!l&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"SIEM Type"}),e.jsxs("select",{value:x.siem_type,onChange:s=>p({...x,siem_type:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"syslog",children:"Syslog (RFC 5424)"}),e.jsx("option",{value:"splunk",children:"Splunk HEC"}),e.jsx("option",{value:"elasticsearch",children:"Elasticsearch"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Endpoint URL"}),e.jsx("input",{type:"text",value:x.endpoint_url,onChange:s=>p({...x,endpoint_url:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:x.siem_type==="syslog"?"192.168.1.100:514":x.siem_type==="splunk"?"https://splunk.example.com:8088":"https://elasticsearch.example.com:9200"})]}),x.siem_type==="syslog"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Protocol"}),e.jsxs("select",{value:x.protocol,onChange:s=>p({...x,protocol:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"})]})]}),(x.siem_type==="splunk"||x.siem_type==="elasticsearch")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:[x.siem_type==="splunk"?"HEC Token":"API Key"," ",x.siem_type==="splunk"&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"password",value:x.api_key,onChange:s=>p({...x,api_key:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:l?"(leave blank to keep current)":""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x.enabled,onChange:s=>p({...x,enabled:s.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Enable this integration"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x.export_on_scan_complete,onChange:s=>p({...x,export_on_scan_complete:s.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export when scans complete"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x.export_on_critical_vuln,onChange:s=>p({...x,export_on_critical_vuln:s.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export critical vulnerabilities immediately"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(D,{type:"button",variant:"outline",onClick:y,children:"Cancel"}),e.jsx(D,{type:"submit",variant:"primary",disabled:j,children:j?e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs("span",{children:[l?"Update":"Create"," Integration"]})})]})]})]})})},yt=()=>{const[l,y]=o.useState(!0),[g,x]=o.useState([]),[p,j]=o.useState(null),[A,I]=o.useState(!1),[s,a]=o.useState(!1),[t,r]=o.useState(null),[d,w]=o.useState(!1),[m,C]=o.useState(!1),[_,U]=o.useState(null),[M,F]=o.useState(""),b=o.useRef(null),[u,h]=o.useState({name:"",vpnType:"openvpn",username:"",password:""}),[f,R]=o.useState(null);o.useEffect(()=>{S()},[]);const S=async()=>{y(!0);try{const[T,O]=await Promise.all([re.getConfigs(),re.getStatus()]);x(T.data),j(O.data)}catch(T){console.error("Failed to load VPN data:",T),n.error("Failed to load VPN settings")}finally{y(!1)}},P=T=>{var Y,ee;const O=(Y=T.target.files)==null?void 0:Y[0];if(!O)return;const G=(ee=O.name.split(".").pop())==null?void 0:ee.toLowerCase();let V="openvpn";G==="conf"&&(V="wireguard"),R(O),h({...u,name:O.name.replace(/\.(ovpn|conf)$/i,""),vpnType:V}),I(!0)},N=async()=>{if(!f){n.error("Please select a VPN config file");return}if(!u.name.trim()){n.error("Please enter a name for the VPN config");return}a(!0);try{const T=new FileReader;T.onload=async()=>{var G,V;const O=T.result.split(",")[1];try{await re.uploadConfig({name:u.name.trim(),vpn_type:u.vpnType,config_data:O,filename:f.name,username:u.username||void 0,password:u.password||void 0,set_as_default:!1}),n.success("VPN config uploaded successfully"),I(!1),R(null),h({name:"",vpnType:"openvpn",username:"",password:""}),b.current&&(b.current.value=""),await S()}catch(Y){const ee=Y;console.error("Failed to upload VPN config:",Y),n.error(((V=(G=ee.response)==null?void 0:G.data)==null?void 0:V.error)||"Failed to upload VPN config")}},T.readAsDataURL(f)}finally{a(!1)}},k=async T=>{var O,G;if(window.confirm("Are you sure you want to delete this VPN config?"))try{await re.deleteConfig(T),n.success("VPN config deleted"),await S()}catch(V){const Y=V;console.error("Failed to delete VPN config:",V),n.error(((G=(O=Y.response)==null?void 0:O.data)==null?void 0:G.error)||"Failed to delete VPN config")}},i=async T=>{var O,G;r(T);try{const V=await re.testConfig(T);V.data.success?n.success(`Connection successful! IP: ${V.data.assigned_ip||"N/A"}`):n.error(V.data.message||"Connection test failed")}catch(V){const Y=V;console.error("Failed to test VPN config:",V),n.error(((G=(O=Y.response)==null?void 0:O.data)==null?void 0:G.error)||"Connection test failed")}finally{r(null)}},v=async T=>{var O,G;w(!0);try{await re.connect({config_id:T,connection_mode:"persistent"}),n.success("VPN connected"),await S()}catch(V){const Y=V;console.error("Failed to connect VPN:",V),n.error(((G=(O=Y.response)==null?void 0:O.data)==null?void 0:G.error)||"Failed to connect")}finally{w(!1)}},E=async()=>{var T,O;C(!0);try{await re.disconnect(),n.success("VPN disconnected"),await S()}catch(G){const V=G;console.error("Failed to disconnect VPN:",G),n.error(((O=(T=V.response)==null?void 0:T.data)==null?void 0:O.error)||"Failed to disconnect")}finally{C(!1)}},K=async T=>{var O,G;try{await re.updateConfig(T,{is_default:!0}),n.success("Default VPN config updated"),await S()}catch(V){const Y=V;console.error("Failed to set default:",V),n.error(((G=(O=Y.response)==null?void 0:O.data)==null?void 0:G.error)||"Failed to set default")}},J=async T=>{var O,G;if(!M.trim()){n.error("Name cannot be empty");return}try{await re.updateConfig(T,{name:M.trim()}),n.success("VPN config updated"),U(null),await S()}catch(V){const Y=V;console.error("Failed to update config:",V),n.error(((G=(O=Y.response)==null?void 0:O.data)==null?void 0:G.error)||"Failed to update")}};return l?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Q,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[p!=null&&p.connected?e.jsx(ps,{className:"h-6 w-6 text-green-500"}):e.jsx(Xe,{className:"h-6 w-6 text-slate-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"VPN Status"}),e.jsx("p",{className:"text-sm text-slate-400",children:p!=null&&p.connected?`Connected to ${p.config_name}`:"Not connected"})]})]}),(p==null?void 0:p.connected)&&e.jsxs(D,{onClick:E,disabled:m,variant:"danger",className:"flex items-center gap-2",children:[e.jsx(Qs,{className:"h-4 w-4"}),m?"Disconnecting...":"Disconnect"]})]}),(p==null?void 0:p.connected)&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-dark-hover rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Mode"}),e.jsx("p",{className:"text-sm text-white",children:p.connection_mode==="persistent"?"Persistent":"Per-Scan"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Assigned IP"}),e.jsx("p",{className:"text-sm text-white font-mono",children:p.assigned_ip||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Interface"}),e.jsx("p",{className:"text-sm text-white font-mono",children:p.interface_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Connected Since"}),e.jsx("p",{className:"text-sm text-white",children:p.connected_since?new Date(p.connected_since).toLocaleString():"N/A"})]})]})]}),e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ie,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"VPN Configurations"})]}),e.jsxs("div",{children:[e.jsx("input",{ref:b,type:"file",accept:".ovpn,.conf",onChange:P,className:"hidden"}),e.jsxs(D,{onClick:()=>{var T;return(T=b.current)==null?void 0:T.click()},className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4"}),"Upload Config"]})]})]}),A&&e.jsxs("div",{className:"mb-6 p-4 bg-dark-hover rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"Upload VPN Configuration"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{children:"File:"}),e.jsx("span",{className:"text-white font-mono",children:f==null?void 0:f.name}),e.jsx("span",{className:"px-2 py-0.5 bg-primary/20 text-primary rounded text-xs uppercase",children:u.vpnType})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Config Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(X,{type:"text",placeholder:"My VPN Connection",value:u.name,onChange:T=>h({...u,name:T.target.value})})]}),u.vpnType==="openvpn"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Username (optional)"}),e.jsx(X,{type:"text",placeholder:"VPN username",value:u.username,onChange:T=>h({...u,username:T.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Required if your VPN requires authentication"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Password (optional)"}),e.jsx(X,{type:"password",placeholder:"VPN password",value:u.password,onChange:T=>h({...u,password:T.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(D,{onClick:N,disabled:s,children:s?"Uploading...":"Upload"}),e.jsx(D,{onClick:()=>{I(!1),R(null),b.current&&(b.current.value="")},variant:"secondary",children:"Cancel"})]})]})]}),g.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(Xe,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No VPN configurations yet"}),e.jsx("p",{className:"text-sm",children:"Upload an OpenVPN (.ovpn) or WireGuard (.conf) file to get started"})]}):e.jsx("div",{className:"space-y-3",children:g.map(T=>e.jsxs("div",{className:"p-4 bg-dark-hover rounded-lg border border-dark-border flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${T.vpn_type==="openvpn"?"bg-orange-500/20 text-orange-400":"bg-blue-500/20 text-blue-400"}`,children:e.jsx(ie,{className:"h-5 w-5"})}),e.jsxs("div",{children:[_===T.id?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{type:"text",value:M,onChange:O=>F(O.target.value),className:"w-48",autoFocus:!0,onKeyDown:O=>{O.key==="Enter"&&J(T.id),O.key==="Escape"&&U(null)}}),e.jsx(D,{size:"sm",onClick:()=>J(T.id),children:"Save"}),e.jsx(D,{size:"sm",variant:"secondary",onClick:()=>U(null),children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium",children:T.name}),T.is_default&&e.jsx(Ze,{className:"h-4 w-4 text-yellow-400 fill-yellow-400"}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-700 text-slate-300 rounded text-xs uppercase",children:T.vpn_type}),(p==null?void 0:p.connected)&&p.config_id===T.id&&e.jsx("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 rounded text-xs",children:"Connected"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500 mt-1",children:[T.requires_credentials&&e.jsx("span",{className:T.has_credentials?"text-green-400":"text-yellow-400",children:T.has_credentials?"Credentials saved":"Credentials required"}),T.last_used_at&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),"Last used: ",new Date(T.last_used_at).toLocaleDateString()]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:_!==T.id&&e.jsxs(e.Fragment,{children:[!T.is_default&&e.jsx(D,{size:"sm",variant:"ghost",onClick:()=>K(T.id),title:"Set as default",children:e.jsx(Ze,{className:"h-4 w-4"})}),e.jsx(D,{size:"sm",variant:"ghost",onClick:()=>{U(T.id),F(T.name)},title:"Edit",children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx(D,{size:"sm",variant:"ghost",onClick:()=>i(T.id),disabled:t===T.id,title:"Test connection",children:t===T.id?e.jsx(Q,{size:"sm"}):e.jsx(oe,{className:"h-4 w-4"})}),!(p!=null&&p.connected)||p.config_id!==T.id?e.jsx(D,{size:"sm",variant:"secondary",onClick:()=>v(T.id),disabled:d||(p==null?void 0:p.connected),title:"Connect",children:e.jsx(ns,{className:"h-4 w-4"})}):null,e.jsx(D,{size:"sm",variant:"ghost",onClick:()=>k(T.id),className:"text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(ce,{className:"h-4 w-4"})})]})})]},T.id))})]}),e.jsxs(L,{children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"How to Use VPN Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-slate-400",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Upload your OpenVPN (.ovpn) or WireGuard (.conf) configuration file."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"If your VPN requires credentials, enter them during upload. They are stored encrypted."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"3"})}),e.jsx("p",{children:"Test your connection to verify it works before using it for scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"When creating a scan, select a VPN config to route the scan through that VPN. The VPN connects before the scan starts and disconnects when it completes."})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ne,{className:"h-5 w-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-200",children:[e.jsx("p",{className:"font-medium",children:"Security Note"}),e.jsx("p",{className:"text-yellow-300/80 mt-1",children:"VPN credentials are encrypted using AES-256-GCM. Config files containing dangerous options (scripts, hooks) are rejected. Only use VPN configurations from trusted sources."})]})]})})]})]})},Pt=()=>{const[l,y]=o.useState("profile"),g=[{name:"Account",tabs:[{id:"profile",label:"Profile",icon:e.jsx(Oe,{className:"h-4 w-4"}),component:e.jsx(qs,{})},{id:"security",label:"Security",icon:e.jsx(Re,{className:"h-4 w-4"}),component:e.jsx(pt,{})},{id:"api-keys",label:"API Keys",icon:e.jsx(De,{className:"h-4 w-4"}),component:e.jsx(gt,{})}]},{name:"Administration",tabs:[{id:"administration",label:"Users",icon:e.jsx(ie,{className:"h-4 w-4"}),component:e.jsx(Xs,{})}]},{name:"Scanning",tabs:[{id:"target-groups",label:"Target Groups",icon:e.jsx(Qe,{className:"h-4 w-4"}),component:e.jsx(Zs,{})},{id:"exclusions",label:"Exclusions",icon:e.jsx(ms,{className:"h-4 w-4"}),component:e.jsx(lt,{})},{id:"scheduled-scans",label:"Scheduled Scans",icon:e.jsx(xe,{className:"h-4 w-4"}),component:e.jsx(et,{})},{id:"templates",label:"Scan Templates",icon:e.jsx(Ae,{className:"h-4 w-4"}),component:e.jsx(tt,{})},{id:"finding-templates",label:"Finding Templates",icon:e.jsx(os,{className:"h-4 w-4"}),component:e.jsx(rt,{})},{id:"vpn",label:"VPN",icon:e.jsx(ps,{className:"h-4 w-4"}),component:e.jsx(yt,{})},{id:"compare-scans",label:"Compare",icon:e.jsx(Js,{className:"h-4 w-4"}),component:e.jsx(Ys,{})}]},{name:"Integrations",tabs:[{id:"notifications",label:"Notifications",icon:e.jsx(is,{className:"h-4 w-4"}),component:e.jsx(st,{})},{id:"jira-integration",label:"JIRA",icon:e.jsx(Je,{className:"h-4 w-4"}),component:e.jsx(ft,{})},{id:"siem-integration",label:"SIEM",icon:e.jsx(hs,{className:"h-4 w-4"}),component:e.jsx(jt,{})}]}],p=g.flatMap(j=>j.tabs).find(j=>j.id===l);return e.jsx(Is,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(us,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Settings"})]}),e.jsx("p",{className:"text-slate-400",children:"Manage your account, scanning configuration, and integrations"})]}),e.jsx("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:e.jsx("div",{className:"flex flex-wrap gap-6",children:g.map(j=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:j.name}),e.jsx("div",{className:"flex gap-1",children:j.tabs.map(A=>e.jsxs("button",{onClick:()=>y(A.id),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${l===A.id?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[A.icon,A.label]},A.id))})]},j.name))})}),e.jsx("div",{children:p==null?void 0:p.component})]})})};export{Pt as default};
