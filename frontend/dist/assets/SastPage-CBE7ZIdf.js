import{b as F,u as N,d as f,j as e}from"./vendor-state-DdX3IZQk.js";import{r as h}from"./vendor-react-Da1CiaFS.js";import{y as L,P as q,aQ as v,aG as T,E as O,aP as E,W as S,B as y,ac as W,a0 as M,Z as w,aE as V,x as $,a1 as R,d as G,aH as P,bu as Y,bk as H,m as J,as as Z,aC as K,a3 as X,ai as ee,j as te,O as se,S as ae,a as re,K as le}from"./vendor-ui-Cfxa9o3E.js";import{d as ne,ad as g}from"./index-CxqB437X.js";import"./vendor-charts-ed8SE4MW.js";function B({status:t}){const r={pending:"bg-yellow-900/50 text-yellow-300 border border-yellow-700",running:"bg-cyan-900/50 text-cyan-300 border border-cyan-700",completed:"bg-green-900/50 text-green-300 border border-green-700",failed:"bg-red-900/50 text-red-300 border border-red-700",open:"bg-blue-900/50 text-blue-300 border border-blue-700",confirmed:"bg-red-900/50 text-red-300 border border-red-700",false_positive:"bg-gray-700 text-gray-300 border border-gray-600",fixed:"bg-green-900/50 text-green-300 border border-green-700"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${r[t]||r.pending}`,children:t.replace("_"," ").charAt(0).toUpperCase()+t.replace("_"," ").slice(1)})}function A({severity:t}){const r={critical:"bg-red-900/50 text-red-300 border border-red-700",high:"bg-orange-900/50 text-orange-300 border border-orange-700",medium:"bg-yellow-900/50 text-yellow-300 border border-yellow-700",low:"bg-blue-900/50 text-blue-300 border border-blue-700",info:"bg-gray-700 text-gray-300 border border-gray-600"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${r[t]||r.info}`,children:t.charAt(0).toUpperCase()+t.slice(1)})}function Q({priority:t}){const r={high:"bg-red-900/50 text-red-300 border border-red-700",medium:"bg-yellow-900/50 text-yellow-300 border border-yellow-700",low:"bg-blue-900/50 text-blue-300 border border-blue-700"};return e.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${r[t]||"bg-gray-700 text-gray-300"}`,children:[t.charAt(0).toUpperCase()+t.slice(1)," Priority"]})}function ie({resolution:t}){const r={to_review:"bg-yellow-900/50 text-yellow-300",vulnerability:"bg-red-900/50 text-red-300",safe:"bg-green-900/50 text-green-300",acknowledged:"bg-blue-900/50 text-blue-300",fixed:"bg-green-900/50 text-green-300"},m={to_review:"To Review",vulnerability:"Vulnerability",safe:"Safe",acknowledged:"Acknowledged",fixed:"Fixed"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${r[t]||"bg-gray-700 text-gray-300"}`,children:m[t]||t})}function ce({category:t}){return{authentication:e.jsx(le,{className:"w-4 h-4"}),authorization:e.jsx(re,{className:"w-4 h-4"}),cryptography:e.jsx(ae,{className:"w-4 h-4"}),input_validation:e.jsx(K,{className:"w-4 h-4"}),injection_prevention:e.jsx($,{className:"w-4 h-4"}),sensitive_data:e.jsx(se,{className:"w-4 h-4"}),configuration:e.jsx(te,{className:"w-4 h-4"}),file_operations:e.jsx(ee,{className:"w-4 h-4"})}[t]||e.jsx(X,{className:"w-4 h-4"})}function de({isOpen:t,onClose:r,onCreate:m}){const[l,n]=h.useState(""),[c,d]=h.useState(""),[o,x]=h.useState("git"),[u,i]=h.useState("");if(!t)return null;const b=a=>{a.preventDefault(),m({project_name:l,language:c||void 0,source_type:o,source_path:u}),n(""),d(""),x("git"),i(""),r()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Start SAST Scan"}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Project Name *"}),e.jsx("input",{type:"text",value:l,onChange:a=>n(a.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"my-web-app"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Language"}),e.jsxs("select",{value:c,onChange:a=>d(a.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"",children:"Auto-detect"}),e.jsx("option",{value:"javascript",children:"JavaScript/TypeScript"}),e.jsx("option",{value:"python",children:"Python"}),e.jsx("option",{value:"java",children:"Java"}),e.jsx("option",{value:"go",children:"Go"}),e.jsx("option",{value:"rust",children:"Rust"}),e.jsx("option",{value:"kotlin",children:"Kotlin"}),e.jsx("option",{value:"scala",children:"Scala"}),e.jsx("option",{value:"swift",children:"Swift"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Source Type"}),e.jsxs("select",{value:o,onChange:a=>x(a.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"git",children:"Git Repository"}),e.jsx("option",{value:"path",children:"Local Path"}),e.jsx("option",{value:"upload",children:"Upload Archive"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:[o==="git"?"Repository URL":o==="path"?"Path":"Archive Path"," *"]}),e.jsx("input",{type:"text",value:u,onChange:a=>i(a.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:o==="git"?"https://github.com/org/repo":"/path/to/code"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:"Start Scan"})]})]})]})})}function oe({isOpen:t,onClose:r,onImport:m}){const[l,n]=h.useState("");if(!t)return null;const c=d=>{d.preventDefault(),m(l),n(""),r()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Import Semgrep Rules"}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Paste Semgrep YAML Rules"}),e.jsx("textarea",{value:l,onChange:d=>n(d.target.value),required:!0,rows:15,className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded text-white font-mono text-sm focus:outline-none focus:border-cyan-500",placeholder:`rules:
  - id: detect-sql-injection
    pattern: $QUERY = "SELECT * FROM users WHERE id = " + $INPUT
    message: Potential SQL injection vulnerability
    severity: ERROR
    languages: [python, javascript]`})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:"Import Rules"})]})]})]})})}function xe({hotspot:t,onClose:r,onUpdate:m}){const[l,n]=h.useState(t.resolution),[c,d]=h.useState(t.review_comment||""),o=x=>{x.preventDefault(),m(t.id,l,c),r()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl border border-gray-700 max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Review Security Hotspot"}),e.jsxs("div",{className:"mb-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{priority:t.priority}),e.jsx("span",{className:"text-gray-400 capitalize",children:t.category.replace("_"," ")})]}),e.jsx("h3",{className:"text-white font-medium",children:t.message}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx(R,{className:"w-4 h-4"}),t.file_path,":",t.line_number]})]}),t.code_snippet&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"Code"}),e.jsx("pre",{className:"text-sm bg-gray-900 p-3 rounded overflow-x-auto text-gray-300 font-mono",children:t.code_snippet})]}),e.jsxs("div",{className:"mb-4 p-3 bg-gray-900 rounded border border-gray-700",children:[e.jsx("h4",{className:"text-sm font-medium text-cyan-400 mb-2",children:"Security Context"}),e.jsx("p",{className:"text-sm text-gray-300",children:t.security_context})]}),e.jsxs("div",{className:"mb-4 p-3 bg-gray-900 rounded border border-gray-700",children:[e.jsx("h4",{className:"text-sm font-medium text-green-400 mb-2",children:"Review Guidance"}),e.jsx("p",{className:"text-sm text-gray-300",children:t.review_guidance})]}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Resolution"}),e.jsxs("select",{value:l,onChange:x=>n(x.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"to_review",children:"To Review"}),e.jsx("option",{value:"vulnerability",children:"Confirmed Vulnerability"}),e.jsx("option",{value:"safe",children:"Safe - Not a Vulnerability"}),e.jsx("option",{value:"acknowledged",children:"Acknowledged - Risk Accepted"}),e.jsx("option",{value:"fixed",children:"Fixed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Review Comment"}),e.jsx("textarea",{value:c,onChange:x=>d(x.target.value),rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"Add your review notes..."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:"Save Review"})]})]})]})})}function me({scanId:t,projectName:r,onBack:m}){const l=F(),[n,c]=h.useState("findings"),[d,o]=h.useState(null),[x,u]=h.useState("all"),[i,b]=h.useState(null),{data:a,isLoading:z}=N({queryKey:["sast-findings",t],queryFn:()=>g.getSastFindings(t).then(s=>s.data)}),{data:p,isLoading:D}=N({queryKey:["taint-flows",t],queryFn:()=>g.getTaintFlows(t).then(s=>s.data),enabled:n==="taint"}),{data:j,isLoading:I}=N({queryKey:["hotspots",t],queryFn:()=>g.getHotspots(t).then(s=>s.data),enabled:n==="hotspots"}),U=f({mutationFn:({id:s,resolution:_,comment:k})=>g.updateHotspot(s,{resolution:_,comment:k}),onSuccess:()=>{l.invalidateQueries({queryKey:["hotspots",t]}),y.success("Hotspot updated")},onError:()=>y.error("Failed to update hotspot")}),C=a==null?void 0:a.filter(s=>x==="all"||s.severity===x);return e.jsxs("div",{children:[e.jsxs("button",{onClick:m,className:"flex items-center gap-2 text-gray-400 hover:text-gray-200 mb-4",children:[e.jsx(V,{className:"w-4 h-4 rotate-180"}),"Back to Scans"]}),e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:r}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Scan Analysis Results"})]})}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>c("findings"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n==="findings"?"bg-cyan-600 text-white":"bg-gray-800 text-gray-400 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"Findings (",(a==null?void 0:a.length)||0,")"]})}),e.jsx("button",{onClick:()=>c("taint"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n==="taint"?"bg-cyan-600 text-white":"bg-gray-800 text-gray-400 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4"}),"Taint Flows (",(p==null?void 0:p.total)||0,")"]})}),e.jsx("button",{onClick:()=>c("hotspots"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n==="hotspots"?"bg-cyan-600 text-white":"bg-gray-800 text-gray-400 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-4 h-4"}),"Hotspots (",(j==null?void 0:j.total)||0,")"]})})]}),n==="findings"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs("select",{value:x,onChange:s=>u(s.target.value),className:"px-3 py-1.5 bg-gray-700 border border-gray-600 rounded text-white text-sm focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})}),z?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(v,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):C&&C.length>0?e.jsx("div",{className:"space-y-3",children:C.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-700/50",onClick:()=>o(d===s.id?null:s.id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(A,{severity:s.severity}),e.jsx("span",{className:"text-white font-medium",children:s.rule_id})]}),e.jsx("p",{className:"text-gray-300",children:s.message}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"w-4 h-4"}),s.file_path,":",s.line_number]}),e.jsx("span",{children:s.category})]})]}),e.jsx(G,{className:`w-5 h-5 text-gray-400 transition-transform ${d===s.id?"rotate-180":""}`})]})}),d===s.id&&e.jsxs("div",{className:"border-t border-gray-700 p-4 bg-gray-900",children:[s.code_snippet&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Code Snippet"}),e.jsx("pre",{className:"text-sm bg-gray-950 p-3 rounded overflow-x-auto text-gray-300 font-mono",children:s.code_snippet})]}),s.remediation&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Remediation"}),e.jsx("p",{className:"text-sm text-gray-300",children:s.remediation})]}),s.cwe_id&&e.jsx("div",{className:"mt-2",children:e.jsxs("a",{href:`https://cwe.mitre.org/data/definitions/${s.cwe_id}.html`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-cyan-400 hover:text-cyan-300 flex items-center gap-1",children:["CWE-",s.cwe_id,e.jsx(P,{className:"w-3 h-3"})]})})]})]},s.id))}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(T,{className:"w-16 h-16 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Findings"}),e.jsx("p",{className:"text-gray-400",children:"No security issues detected in this scan"})]})]}),n==="taint"&&e.jsx(e.Fragment,{children:D?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(v,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):p!=null&&p.flows&&p.flows.length>0?e.jsx("div",{className:"space-y-3",children:p.flows.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{severity:s.severity}),e.jsx(B,{status:s.status}),s.is_sanitized&&e.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-green-900/50 text-green-300",children:"Sanitized"})]}),e.jsx("span",{className:"text-sm text-gray-500",children:s.category})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsxs("div",{className:"flex-1 p-3 bg-red-900/20 border border-red-800/50 rounded",children:[e.jsx("div",{className:"text-xs text-red-400 mb-1",children:"Source"}),e.jsx("div",{className:"text-white font-medium",children:s.source.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.file_path,":",s.source_line]})]}),e.jsx(Y,{className:"w-6 h-6 text-gray-500 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 p-3 bg-orange-900/20 border border-orange-800/50 rounded",children:[e.jsx("div",{className:"text-xs text-orange-400 mb-1",children:"Sink"}),e.jsx("div",{className:"text-white font-medium",children:s.sink.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.file_path,":",s.sink_line]})]})]}),s.cwe_id&&e.jsxs("a",{href:`https://cwe.mitre.org/data/definitions/${s.cwe_id}.html`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-cyan-400 hover:text-cyan-300 flex items-center gap-1",children:["CWE-",s.cwe_id,e.jsx(P,{className:"w-3 h-3"})]})]},s.id))}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(S,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Taint Flows"}),e.jsx("p",{className:"text-gray-400",children:"No tainted data flows detected in this scan"})]})}),n==="hotspots"&&e.jsx(e.Fragment,{children:I?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(v,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):j!=null&&j.hotspots&&j.hotspots.length>0?e.jsx("div",{className:"space-y-3",children:j.hotspots.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700 hover:border-gray-600 cursor-pointer",onClick:()=>b(s),children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-gray-700 rounded",children:e.jsx(ce,{category:s.category})}),e.jsx(Q,{priority:s.priority}),e.jsx(ie,{resolution:s.resolution})]})}),e.jsx("h4",{className:"text-white font-medium mb-1",children:s.message}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"w-4 h-4"}),s.file_path,":",s.line_number]}),e.jsx("span",{className:"capitalize",children:s.category.replace("_"," ")})]})]},s.id))}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(w,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Security Hotspots"}),e.jsx("p",{className:"text-gray-400",children:"No security hotspots require review in this scan"})]})}),i&&e.jsx(xe,{hotspot:i,onClose:()=>b(null),onUpdate:(s,_,k)=>U.mutate({id:s,resolution:_,comment:k})})]})}function he(){const t=F(),[r,m]=h.useState(!1),[l,n]=h.useState(""),{data:c,isLoading:d}=N({queryKey:["semgrep-rules"],queryFn:()=>g.listSemgrepRules().then(i=>i.data)}),o=f({mutationFn:g.importSemgrepRules,onSuccess:i=>{t.invalidateQueries({queryKey:["semgrep-rules"]}),y.success(i.data.message)},onError:()=>y.error("Failed to import rules")}),x=f({mutationFn:g.deleteSemgrepRule,onSuccess:()=>{t.invalidateQueries({queryKey:["semgrep-rules"]}),y.success("Rule deleted")},onError:()=>y.error("Failed to delete rule")}),u=c==null?void 0:c.filter(i=>!l||i.name.toLowerCase().includes(l.toLowerCase())||i.rule_id.toLowerCase().includes(l.toLowerCase()));return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Semgrep Rules"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Import and manage custom Semgrep rules"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(H,{className:"w-4 h-4"}),"Import Rules"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:l,onChange:i=>n(i.target.value),placeholder:"Search rules...",className:"w-full pl-10 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500"})]}),d?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(v,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):u&&u.length>0?e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Rule ID"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Name"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Severity"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Languages"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Category"}),e.jsx("th",{className:"text-right p-4 text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:u.map(i=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"p-4 font-mono text-sm text-cyan-400",children:i.rule_id}),e.jsx("td",{className:"p-4 text-white",children:i.name}),e.jsx("td",{className:"p-4",children:e.jsx(A,{severity:i.severity})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[i.languages.slice(0,3).map(b=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-300",children:b},b)),i.languages.length>3&&e.jsxs("span",{className:"px-2 py-0.5 text-xs text-gray-500",children:["+",i.languages.length-3]})]})}),e.jsx("td",{className:"p-4 text-gray-300",children:i.category}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("button",{onClick:()=>x.mutate(i.id),className:"p-2 hover:bg-gray-700 rounded text-red-400 hover:text-red-300",children:e.jsx(E,{className:"w-4 h-4"})})})]},i.id))})]})}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(M,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Semgrep Rules"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Import Semgrep rules to enhance your SAST scanning"}),e.jsxs("button",{onClick:()=>m(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(H,{className:"w-4 h-4"}),"Import Rules"]})]}),e.jsx(oe,{isOpen:r,onClose:()=>m(!1),onImport:i=>o.mutate(i)})]})}function ge(){var m;const{data:t,isLoading:r}=N({queryKey:["hotspot-stats"],queryFn:()=>g.getHotspotStats().then(l=>l.data)});return r?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(v,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):t?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Security Hotspots Overview"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsx("div",{className:"p-2 bg-gray-700 rounded",children:e.jsx(w,{className:"w-5 h-5 text-yellow-400"})})}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Total Hotspots"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:t.total})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsx("div",{className:"p-2 bg-gray-700 rounded",children:e.jsx(Z,{className:"w-5 h-5 text-yellow-400"})})}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Pending Review"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:t.pending_review})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsx("div",{className:"p-2 bg-gray-700 rounded",children:e.jsx(T,{className:"w-5 h-5 text-green-400"})})}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Reviewed"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:t.reviewed})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsx("div",{className:"p-2 bg-gray-700 rounded",children:e.jsx(K,{className:"w-5 h-5 text-red-400"})})}),e.jsx("p",{className:"text-gray-400 text-sm",children:"High Priority"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:((m=t.by_priority)==null?void 0:m.high)||0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"text-white font-medium mb-4",children:"By Priority"}),e.jsx("div",{className:"space-y-3",children:["high","medium","low"].map(l=>{var o;const n=((o=t.by_priority)==null?void 0:o[l])||0,c=t.total>0?n/t.total*100:0,d={high:"bg-red-500",medium:"bg-yellow-500",low:"bg-blue-500"};return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-20 text-sm text-gray-400 capitalize",children:l}),e.jsx("div",{className:"flex-1 h-4 bg-gray-700 rounded overflow-hidden",children:e.jsx("div",{className:`h-full ${d[l]} transition-all duration-300`,style:{width:`${c}%`}})}),e.jsx("div",{className:"w-12 text-right text-sm font-medium text-white",children:n})]},l)})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"text-white font-medium mb-4",children:"By Resolution"}),e.jsx("div",{className:"space-y-3",children:["to_review","vulnerability","safe","acknowledged","fixed"].map(l=>{var x;const n=((x=t.by_resolution)==null?void 0:x[l])||0,c=t.total>0?n/t.total*100:0,d={to_review:"bg-yellow-500",vulnerability:"bg-red-500",safe:"bg-green-500",acknowledged:"bg-blue-500",fixed:"bg-green-500"},o={to_review:"To Review",vulnerability:"Vulnerability",safe:"Safe",acknowledged:"Acknowledged",fixed:"Fixed"};return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-24 text-sm text-gray-400",children:o[l]}),e.jsx("div",{className:"flex-1 h-4 bg-gray-700 rounded overflow-hidden",children:e.jsx("div",{className:`h-full ${d[l]} transition-all duration-300`,style:{width:`${c}%`}})}),e.jsx("div",{className:"w-12 text-right text-sm font-medium text-white",children:n})]},l)})})]})]})]})}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(w,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Hotspot Data"}),e.jsx("p",{className:"text-gray-400",children:"Run a SAST scan to detect security hotspots"})]})}function Ne(){const t=F(),[r,m]=h.useState("scans"),[l,n]=h.useState(!1),[c,d]=h.useState(null),{data:o,isLoading:x}=N({queryKey:["sast-scans"],queryFn:()=>g.listSastScans().then(a=>a.data),enabled:r==="scans"}),u=f({mutationFn:g.startSastScan,onSuccess:()=>{t.invalidateQueries({queryKey:["sast-scans"]}),y.success("SAST scan started")},onError:()=>y.error("Failed to start SAST scan")}),i=f({mutationFn:g.deleteSastScan,onSuccess:()=>{t.invalidateQueries({queryKey:["sast-scans"]}),y.success("Scan deleted")},onError:()=>y.error("Failed to delete scan")}),b=[{id:"scans",label:"Scans",icon:e.jsx(W,{className:"w-4 h-4"})},{id:"semgrep",label:"Semgrep Rules",icon:e.jsx(M,{className:"w-4 h-4"})},{id:"taint",label:"Taint Analysis",icon:e.jsx(S,{className:"w-4 h-4"})},{id:"hotspots",label:"Hotspots",icon:e.jsx(w,{className:"w-4 h-4"})}];return e.jsx(ne,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(L,{className:"h-8 w-8 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"SAST Scanner"}),e.jsx("p",{className:"text-gray-400",children:"Static Application Security Testing"})]})]})}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:b.map(a=>e.jsxs("button",{onClick:()=>{m(a.id),d(null)},className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${r===a.id?"border-cyan-500 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[a.icon,a.label]},a.id))})}),e.jsxs("div",{children:[r==="scans"&&e.jsx("div",{children:c?e.jsx(me,{scanId:c.id,projectName:c.name,onBack:()=>d(null)}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"SAST Scans"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Analyze source code for security vulnerabilities"})]}),e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(q,{className:"w-4 h-4"}),"Start Scan"]})]}),x?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(v,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):o&&o.length>0?e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Project"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Language"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Findings"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Date"}),e.jsx("th",{className:"text-right p-4 text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:o.map(a=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-medium text-white",children:a.project_name}),e.jsx("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:a.source_path})]}),e.jsx("td",{className:"p-4 text-gray-300",children:a.language||"Auto"}),e.jsx("td",{className:"p-4",children:e.jsx(B,{status:a.status})}),e.jsx("td",{className:"p-4",children:a.status==="completed"&&e.jsxs("div",{className:"flex items-center gap-2",children:[a.critical_count>0&&e.jsxs("span",{className:"text-red-400",children:[a.critical_count,"C"]}),a.high_count>0&&e.jsxs("span",{className:"text-orange-400",children:[a.high_count,"H"]}),a.medium_count>0&&e.jsxs("span",{className:"text-yellow-400",children:[a.medium_count,"M"]}),a.low_count>0&&e.jsxs("span",{className:"text-blue-400",children:[a.low_count,"L"]}),a.finding_count===0&&e.jsx(T,{className:"w-4 h-4 text-green-400"})]})}),e.jsx("td",{className:"p-4 text-gray-500 text-sm",children:new Date(a.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>d({id:a.id,name:a.project_name}),className:"p-2 hover:bg-gray-700 rounded text-gray-400 hover:text-white",children:e.jsx(O,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>i.mutate(a.id),className:"p-2 hover:bg-gray-700 rounded text-red-400 hover:text-red-300",children:e.jsx(E,{className:"w-4 h-4"})})]})})]},a.id))})]})}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(L,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No SAST Scans"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Start scanning your source code for security vulnerabilities"}),e.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(q,{className:"w-4 h-4"}),"Start First Scan"]})]})]})}),r==="semgrep"&&e.jsx(he,{}),r==="taint"&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 text-center border border-gray-700",children:[e.jsx(S,{className:"w-16 h-16 text-cyan-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Taint Analysis"}),e.jsx("p",{className:"text-gray-400 mb-4 max-w-md mx-auto",children:"Taint analysis tracks how untrusted data flows through your application to detect injection vulnerabilities."}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Run a SAST scan to view taint analysis results for that scan."})]}),r==="hotspots"&&e.jsx(ge,{})]}),e.jsx(de,{isOpen:l,onClose:()=>n(!1),onCreate:a=>u.mutate(a)})]})})}export{Ne as default};
