import{b as F,u as l,d as C,j as e}from"./vendor-state-DdX3IZQk.js";import{r as N}from"./vendor-react-Da1CiaFS.js";import{B as y,ag as o,aR as f,A,a4 as m,S as M,T as h,Z as j,m as w,aA as P,u as D,bh as I,ae as q,at as O,aG as B,aH as T}from"./vendor-ui-B6SJ_7kK.js";import{d as K,b as u,C as t,L as Q,B as g}from"./index-CEs23Zco.js";import"./vendor-charts-gFVtv0RJ.js";const Z=()=>{const[c,_]=N.useState("overview"),[S,R]=N.useState(null),b=F(),{data:r,isLoading:k}=l({queryKey:["ai-models"],queryFn:async()=>[{id:"1",name:"Alert Priority Model",type:"alert_prioritization",status:"ready",accuracy:94.2,last_trained:new Date().toISOString(),predictions_count:1247},{id:"2",name:"Anomaly Detector",type:"anomaly_detection",status:"ready",accuracy:89.5,last_trained:new Date().toISOString(),predictions_count:832},{id:"3",name:"False Positive Predictor",type:"false_positive_prediction",status:"training",accuracy:91.8,last_trained:new Date().toISOString(),predictions_count:0}]}),{data:a}=l({queryKey:["prioritized-alerts"],queryFn:async()=>[{id:"1",title:"Critical SQL Injection Attempt",description:"Multiple SQL injection attempts detected on admin panel",severity:"critical",ml_score:98.5,confidence:.96,factors:["Multiple attempts","Admin endpoint","Known attack pattern"],created_at:new Date().toISOString()},{id:"2",title:"Unusual Data Exfiltration Pattern",description:"Large data transfer to unknown IP address",severity:"high",ml_score:87.2,confidence:.89,factors:["Unusual volume","Non-business hours","Unknown destination"],created_at:new Date().toISOString()}]}),{data:n}=l({queryKey:["anomalies"],queryFn:async()=>[{id:"1",entity_type:"user",entity_id:"user_123",anomaly_type:"Unusual login time",severity:"medium",score:75.3,detected_at:new Date().toISOString(),resolved:!1},{id:"2",entity_type:"host",entity_id:"192.168.1.50",anomaly_type:"Spike in network traffic",severity:"high",score:89.1,detected_at:new Date().toISOString(),resolved:!1}]}),{data:i}=l({queryKey:["ai-metrics"],queryFn:async()=>({total_alerts_processed:15420,high_priority_detected:342,false_positives_prevented:1823,anomalies_detected:127,average_confidence:.91,model_accuracy:93.2})}),p=C({mutationFn:async s=>(await new Promise(x=>setTimeout(x,2e3)),{success:!0}),onSuccess:()=>{b.invalidateQueries({queryKey:["ai-models"]}),y.success("Model training started")},onError:()=>{y.error("Failed to start model training")}}),d=s=>{switch(s.toLowerCase()){case"critical":return"bg-red-500/20 text-red-400 border-red-500/30";case"high":return"bg-orange-500/20 text-orange-400 border-orange-500/30";case"medium":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"low":return"bg-blue-500/20 text-blue-400 border-blue-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}},v=s=>{switch(s){case"ready":return e.jsx(T,{className:"h-4 w-4 text-green-400"});case"training":return e.jsx(f,{className:"h-4 w-4 text-blue-400 animate-spin"});case"failed":return e.jsx(B,{className:"h-4 w-4 text-red-400"});default:return e.jsx(O,{className:"h-4 w-4 text-slate-400"})}};return e.jsx(K,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[e.jsx(o,{className:"h-8 w-8 text-primary"}),"AI/ML Security Operations"]}),e.jsx("p",{className:"text-slate-400 mt-2",children:"ML-based alert prioritization, anomaly detection, and intelligent security automation"})]}),e.jsxs(u,{variant:"primary",onClick:()=>b.invalidateQueries(),children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Refresh Data"]})]}),i&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsxs(t,{className:"bg-gradient-to-br from-blue-500/10 to-blue-600/10 border-blue-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Alerts Processed"}),e.jsx(A,{className:"h-4 w-4 text-blue-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:i.total_alerts_processed.toLocaleString()})]}),e.jsxs(t,{className:"bg-gradient-to-br from-red-500/10 to-red-600/10 border-red-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"High Priority"}),e.jsx(m,{className:"h-4 w-4 text-red-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:i.high_priority_detected.toLocaleString()})]}),e.jsxs(t,{className:"bg-gradient-to-br from-green-500/10 to-green-600/10 border-green-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"FP Prevented"}),e.jsx(M,{className:"h-4 w-4 text-green-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:i.false_positives_prevented.toLocaleString()})]}),e.jsxs(t,{className:"bg-gradient-to-br from-purple-500/10 to-purple-600/10 border-purple-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Anomalies"}),e.jsx(h,{className:"h-4 w-4 text-purple-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:i.anomalies_detected.toLocaleString()})]}),e.jsxs(t,{className:"bg-gradient-to-br from-cyan-500/10 to-cyan-600/10 border-cyan-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Avg Confidence"}),e.jsx(j,{className:"h-4 w-4 text-cyan-400"})]}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[(i.average_confidence*100).toFixed(1),"%"]})]}),e.jsxs(t,{className:"bg-gradient-to-br from-orange-500/10 to-orange-600/10 border-orange-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Model Accuracy"}),e.jsx(w,{className:"h-4 w-4 text-orange-400"})]}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[i.model_accuracy.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"flex items-center gap-2 border-b border-dark-border",children:[{id:"overview",label:"Overview",icon:e.jsx(w,{className:"h-4 w-4"})},{id:"alerts",label:"Prioritized Alerts",icon:e.jsx(m,{className:"h-4 w-4"})},{id:"anomalies",label:"Anomalies",icon:e.jsx(h,{className:"h-4 w-4"})},{id:"models",label:"ML Models",icon:e.jsx(o,{className:"h-4 w-4"})}].map(s=>e.jsxs("button",{onClick:()=>_(s.id),className:`flex items-center gap-2 px-4 py-3 font-medium transition-colors border-b-2 ${c===s.id?"text-primary border-primary":"text-slate-400 border-transparent hover:text-white hover:border-slate-600"}`,children:[s.icon,s.label]},s.id))}),c==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(t,{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5 text-primary"}),"Active AI Models"]})}),k?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Q,{})}):e.jsx("div",{className:"space-y-3",children:r==null?void 0:r.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[v(s.status),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:s.name}),e.jsxs("div",{className:"text-xs text-slate-400",children:[s.predictions_count.toLocaleString()," predictions"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium text-green-400",children:[s.accuracy.toFixed(1),"% accuracy"]}),e.jsx("div",{className:"text-xs text-slate-500",children:s.status})]})]},s.id))})]}),e.jsxs(t,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(m,{className:"h-5 w-5 text-red-400"}),"High-Priority Alerts"]}),e.jsxs(g,{variant:"danger",children:[(a==null?void 0:a.length)||0," active"]})]}),e.jsx("div",{className:"space-y-3",children:a==null?void 0:a.slice(0,3).map(s=>e.jsxs("div",{className:"p-3 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("div",{className:"font-medium text-white",children:s.title}),e.jsx("span",{className:`px-2 py-1 text-xs rounded border ${d(s.severity)}`,children:s.severity})]}),e.jsx("div",{className:"text-sm text-slate-400 mb-2",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-500",children:[e.jsx(j,{className:"h-3 w-3 text-primary"}),"ML Score: ",s.ml_score.toFixed(1)]}),e.jsxs("div",{className:"text-slate-500",children:[(s.confidence*100).toFixed(0),"% confident"]})]})]},s.id))})]})]}),c==="alerts"&&e.jsxs(t,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"ML-Prioritized Security Alerts"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(u,{variant:"secondary",size:"sm",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Filter"]})})]}),e.jsx("div",{className:"space-y-3",children:a==null?void 0:a.map(s=>e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white text-lg mb-1",children:s.title}),e.jsx("div",{className:"text-sm text-slate-400",children:s.description})]}),e.jsx("span",{className:`px-3 py-1.5 text-sm font-medium rounded-lg border ${d(s.severity)}`,children:s.severity})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-slate-300",children:"ML Score:"}),e.jsx("span",{className:"font-medium text-white",children:s.ml_score.toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-blue-400"}),e.jsx("span",{className:"text-slate-300",children:"Confidence:"}),e.jsxs("span",{className:"font-medium text-white",children:[(s.confidence*100).toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-border",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-2",children:"Contributing Factors:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.factors.map((x,L)=>e.jsx("span",{className:"px-2 py-1 text-xs bg-primary/20 text-primary rounded",children:x},L))})]})]},s.id))})]}),c==="anomalies"&&e.jsxs(t,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Detected Anomalies"}),e.jsxs(g,{variant:"warning",children:[(n==null?void 0:n.filter(s=>!s.resolved).length)||0," unresolved"]})]}),e.jsx("div",{className:"space-y-3",children:n==null?void 0:n.map(s=>e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h,{className:"h-5 w-5 text-purple-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:s.anomaly_type}),e.jsxs("div",{className:"text-sm text-slate-400",children:[s.entity_type,": ",s.entity_id]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded border ${d(s.severity)}`,children:s.severity}),s.resolved&&e.jsx(g,{variant:"success",children:"Resolved"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"text-slate-500",children:["Anomaly Score: ",e.jsx("span",{className:"font-medium text-white",children:s.score.toFixed(1)})]}),e.jsx("div",{className:"text-slate-500",children:new Date(s.detected_at).toLocaleString()})]})]},s.id))})]}),c==="models"&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:r==null?void 0:r.map(s=>e.jsxs(t,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[v(s.status),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.name}),e.jsx("p",{className:"text-sm text-slate-400",children:s.type.replace(/_/g," ")})]})]}),e.jsx(u,{variant:s.status==="training"?"secondary":"primary",size:"sm",onClick:()=>p.mutate(s.id),disabled:s.status==="training",loading:p.isPending&&S===s.id,children:s.status==="training"?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Training..."]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Retrain"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"p-3 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("div",{className:"text-sm text-slate-400 mb-1",children:"Accuracy"}),e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[s.accuracy.toFixed(1),"%"]})]}),e.jsxs("div",{className:"p-3 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("div",{className:"text-sm text-slate-400 mb-1",children:"Predictions"}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:s.predictions_count.toLocaleString()})]})]}),e.jsxs("div",{className:"text-sm text-slate-500",children:["Last trained: ",new Date(s.last_trained).toLocaleString()]})]},s.id))})]})})};export{Z as default};
