import{j as e}from"./vendor-state-BjT_zREg.js";import{r,R as le}from"./vendor-react-5KxtEOLM.js";import{L as bt}from"./Layout-DQwy8A8G.js";import{B as l,U as us,S as ue,ay as is,M as Te,z as Ce,a as es,O as fe,e as Ts,l as Ze,_ as yt,aU as vt,aV as Nt,aq as wt,ab as ne,aW as Rs,p as je,v as Ms,m as ce,X as be,u as Ls,aM as ye,aX as Os,aY as js,aZ as Us,a_ as as,g as de,k as _t,F as Ie,E as bs,G as ys,s as cs,Z as $s,o as ls,a$ as hs,R as kt,y as Gs,I as he,r as Ct,b0 as zs,H as St,$ as ss,a2 as Ve,t as Vs,b1 as ze,x as ge,af as ps,al as _s,a6 as Bs,K as Me,f as qs,ao as Hs,h as Be,b2 as vs,a9 as Re,W as Ws,Y as ks,b3 as Et,aN as Ks,V as Cs,d as At,n as os,w as It,i as ke,b4 as Js,b5 as Pt,q as Qs,b6 as Ys,b7 as Ft,ad as Dt,b8 as Xs,b9 as Ns,ba as Tt,ag as Zs,bb as Rt}from"./vendor-ui-C4nf_tR6.js";import{p as rs,I as J,B as E,n as Pe,a as Ye,q as qe,u as ve,t as Oe,w as Ue,e as He,x as ts,y as ds,z as We,A as Ke,j as $e,b as Mt,v as Ne,d as we,C as Fe,D as Ee,E as Ae,F as _e,G as Je}from"./index-RI0GBk2h.js";import{C as H}from"./Card-CV6m9jT5.js";import{L as ee}from"./LoadingSpinner-CV5u9ki8.js";import{B as te}from"./Badge-Bi3Nk-Vg.js";import{C as Se}from"./ConfirmationDialog-CBNrGowW.js";import{b as et}from"./vendor-utils-DfRopTPV.js";import{S as Lt}from"./ScanComparison-DE6rpBUi.js";import{C as De}from"./Checkbox-DniaXErv.js";import"./vendor-markdown-BGP8SuZQ.js";import"./vendor-charts-KBIe6Y3a.js";const Ot=()=>{var T;const[d,P]=r.useState(null),[_,f]=r.useState(!0),[v,y]=r.useState(!1),[g,M]=r.useState(!1),[t,a]=r.useState(""),[s,n]=r.useState(!1),[m,p]=r.useState(""),[i,D]=r.useState(""),[A,V]=r.useState("");r.useEffect(()=>{j()},[]);const j=async()=>{f(!0);try{const I=await rs.me();P(I.data),a(I.data.email||"")}catch(I){l.error("Failed to load profile"),console.error(I)}finally{f(!1)}},C=async I=>{var z,L;if(I.preventDefault(),!t.trim()){l.error("Email is required");return}y(!0);try{const O=await rs.updateProfile({email:t.trim()});P(O.data),l.success("Profile updated successfully")}catch(O){const w=O;l.error(((L=(z=w.response)==null?void 0:z.data)==null?void 0:L.error)||"Failed to update profile")}finally{y(!1)}},S=async I=>{var z,L;if(I.preventDefault(),!m||!i){l.error("All password fields are required");return}if(i.length<6){l.error("New password must be at least 6 characters");return}if(i!==A){l.error("Passwords do not match");return}M(!0);try{await rs.changePassword({current_password:m,new_password:i}),l.success("Password changed successfully"),n(!1),p(""),D(""),V("")}catch(O){const w=O;l.error(((L=(z=w.response)==null?void 0:z.data)==null?void 0:L.error)||"Failed to change password")}finally{M(!1)}},u=I=>I?new Date(I).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"N/A";return _?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(us,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Profile Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(us,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Username"}),e.jsx("p",{className:"text-white font-medium",children:d==null?void 0:d.username})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(ue,{className:"h-5 w-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Roles"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:((T=d==null?void 0:d.roles)==null?void 0:T.map(I=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-primary/20 text-primary rounded capitalize",children:I},I)))||e.jsx("span",{className:"text-slate-400",children:"No roles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(is,{className:"h-5 w-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Member Since"}),e.jsx("p",{className:"text-white",children:u(d==null?void 0:d.created_at)})]})]})]}),e.jsx("form",{onSubmit:C,className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-2",children:[e.jsx(Te,{className:"h-4 w-4"}),"Email Address"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(J,{type:"email",value:t,onChange:I=>a(I.target.value),placeholder:"your@email.com",className:"flex-1"}),e.jsxs(E,{type:"submit",variant:"primary",loading:v,disabled:v||t===(d==null?void 0:d.email),children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Save"]})]})]})})]}),e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(es,{className:"h-6 w-6 text-yellow-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Security"})]}),!s&&e.jsx(E,{variant:"secondary",onClick:()=>n(!0),children:"Change Password"})]}),s?e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsx(J,{label:"Current Password",type:"password",value:m,onChange:I=>p(I.target.value),placeholder:"Enter current password"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(J,{label:"New Password",type:"password",value:i,onChange:I=>D(I.target.value),placeholder:"Enter new password"}),e.jsx(J,{label:"Confirm New Password",type:"password",value:A,onChange:I=>V(I.target.value),placeholder:"Confirm new password"})]}),i&&A&&i!==A&&e.jsx("p",{className:"text-sm text-red-400",children:"Passwords do not match"}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:()=>{n(!1),p(""),D(""),V("")},children:"Cancel"}),e.jsx(E,{type:"submit",variant:"primary",loading:g,disabled:g||!m||!i||i!==A,children:"Update Password"})]})]}):e.jsx("p",{className:"text-slate-400",children:"Keep your account secure by using a strong, unique password."})]}),e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(ue,{className:"h-6 w-6 text-green-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Account Status"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${(d==null?void 0:d.is_active)!==!1?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-white",children:(d==null?void 0:d.is_active)!==!1?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Your account is in good standing."})]})]})},Ut=[{id:"admin",name:"Admin",description:"Full system access"},{id:"user",name:"User",description:"Standard user access"},{id:"auditor",name:"Auditor",description:"Read-only access to all scans"},{id:"viewer",name:"Viewer",description:"Limited view access"}],$t=()=>{const[d,P]=r.useState([]),[_,f]=r.useState([]),[v,y]=r.useState(!0),[g,M]=r.useState(!1),[t,a]=r.useState(new Set),[s,n]=r.useState(!1),[m,p]=r.useState(!0),[i,D]=r.useState(null),[A,V]=r.useState(!1);r.useEffect(()=>{j()},[]);const j=async()=>{var k;y(!0);try{const h=await Pe.getUsers();P(h.data),p(!0)}catch(h){((k=h.response)==null?void 0:k.status)===403?p(!1):l.error("Failed to load users"),console.error(h)}finally{y(!1)}},C=async()=>{M(!0);try{const k=await Pe.getAuditLogs({limit:50,offset:0});f(k.data.logs)}catch(k){l.error("Failed to load audit logs"),console.error(k)}finally{M(!1)}},S=k=>{const h=new Set(t);h.has(k)?h.delete(k):h.add(k),a(h)},u=async k=>{var h,R;try{await Pe.updateUser(k.id,{is_active:!k.is_active}),l.success(`User ${k.is_active?"deactivated":"activated"}`),j()}catch(b){const Q=b;l.error(((R=(h=Q.response)==null?void 0:h.data)==null?void 0:R.error)||"Failed to update user")}},T=async()=>{var k,h;if(i){V(!0);try{await Pe.deleteUser(i.id),l.success(`User "${i.username}" deleted successfully`),j(),D(null)}catch(R){const b=R;l.error(((h=(k=b.response)==null?void 0:k.data)==null?void 0:h.error)||"Failed to delete user")}finally{V(!1)}}},I=async(k,h)=>{var R,b;try{await Pe.assignRole(k,h),l.success("Role assigned"),j()}catch(Q){const X=Q;l.error(((b=(R=X.response)==null?void 0:R.data)==null?void 0:b.error)||"Failed to assign role")}},z=async(k,h)=>{var R,b;try{await Pe.removeRole(k,h),l.success("Role removed"),j()}catch(Q){const X=Q;l.error(((b=(R=X.response)==null?void 0:R.data)==null?void 0:b.error)||"Failed to remove role")}},L=async k=>{var h,R;try{await Pe.unlockUser(k.id),l.success(`Account "${k.username}" unlocked`),j()}catch(b){const Q=b;l.error(((R=(h=Q.response)==null?void 0:h.data)==null?void 0:R.error)||"Failed to unlock account")}},O=k=>new Date(k).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),w=k=>{switch(k){case"admin":return"bg-red-500/20 text-red-400 border-red-500/30";case"user":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"auditor":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"viewer":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return v?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):m?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ts,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"User Management"})]}),e.jsxs(te,{variant:"status",type:"completed",children:[d.length," users"]})]}),e.jsx("div",{className:"space-y-3",children:d.map(k=>{const h=t.has(k.id),R=k.roles||[];return e.jsxs("div",{className:"bg-dark-bg rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>S(k.id),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"text-slate-400",children:h?e.jsx(Ze,{className:"h-4 w-4"}):e.jsx(yt,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${k.is_active!==!1?"bg-green-400":"bg-red-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:k.username}),e.jsx("p",{className:"text-sm text-slate-400",children:k.email})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex gap-1",children:R.map(b=>e.jsx("span",{className:`px-2 py-0.5 text-xs rounded border capitalize ${w(b)}`,children:b},b))}),k.is_locked&&e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded border bg-red-500/20 text-red-400 border-red-500/30 flex items-center gap-1",children:[e.jsx(es,{className:"h-3 w-3"}),"Locked"]}),e.jsx("span",{className:"text-xs text-slate-500",children:k.created_at?O(k.created_at):"N/A"})]})]}),h&&e.jsxs("div",{className:"border-t border-dark-border p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"Manage Roles"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:Ut.map(b=>{const Q=R.includes(b.id);return e.jsxs("button",{onClick:X=>{X.stopPropagation(),Q?z(k.id,b.id):I(k.id,b.id)},className:`p-3 rounded-lg border text-left transition-colors ${Q?"bg-primary/20 border-primary/50 text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-primary/30"}`,children:[e.jsx("p",{className:"font-medium text-sm capitalize",children:b.name}),e.jsx("p",{className:"text-xs opacity-75",children:b.description})]},b.id)})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-dark-border",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{variant:k.is_active!==!1?"secondary":"primary",size:"sm",onClick:b=>{b.stopPropagation(),u(k)},children:k.is_active!==!1?e.jsxs(e.Fragment,{children:[e.jsx(vt,{className:"h-4 w-4 mr-1"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(Nt,{className:"h-4 w-4 mr-1"}),"Activate"]})}),k.is_locked&&e.jsxs(E,{variant:"primary",size:"sm",onClick:b=>{b.stopPropagation(),L(k)},children:[e.jsx(wt,{className:"h-4 w-4 mr-1"}),"Unlock Account"]})]}),e.jsxs(E,{variant:"secondary",size:"sm",onClick:b=>{b.stopPropagation(),D(k)},className:"text-red-400 hover:text-red-300 hover:bg-red-500/10","aria-label":`Delete user ${k.username}`,children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})]},k.id)})})]}),e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Rs,{className:"h-6 w-6 text-purple-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Audit Logs"})]}),e.jsx(E,{variant:"secondary",onClick:()=>{n(!s),!s&&_.length===0&&C()},children:s?"Hide Logs":"Show Logs"})]}),s&&e.jsx(e.Fragment,{children:g?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ee,{})}):_.length===0?e.jsx("p",{className:"text-slate-400 text-center py-8",children:"No audit logs found"}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:_.map(k=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-dark-bg rounded-lg text-sm",children:[e.jsx(je,{className:"h-4 w-4 text-slate-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium text-white",children:k.action}),k.target_type&&e.jsxs("span",{className:"text-slate-400",children:["on ",k.target_type]}),k.target_id&&e.jsx("span",{className:"text-xs text-slate-500 font-mono truncate max-w-32",children:k.target_id})]}),k.details&&e.jsx("p",{className:"text-xs text-slate-500 mt-1 truncate",children:k.details})]}),e.jsx("span",{className:"text-xs text-slate-500 whitespace-nowrap",children:O(k.created_at)})]},k.id))})}),!s&&e.jsx("p",{className:"text-slate-400",children:"View a log of administrative actions performed in the system."})]}),e.jsx(Se,{isOpen:!!i,onClose:()=>D(null),onConfirm:T,title:"Delete User",message:`Are you sure you want to delete user "${i==null?void 0:i.username}"? All their data, including scans and settings, will be permanently removed.`,confirmLabel:"Delete User",variant:"danger",loading:A})]}):e.jsx(H,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(fe,{className:"h-12 w-12 text-yellow-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-slate-400",children:"You don't have permission to access the administration panel."}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Contact an administrator if you need elevated access."})]})})},ms=["#ef4444","#f97316","#eab308","#22c55e","#14b8a6","#3b82f6","#8b5cf6","#ec4899","#6366f1","#64748b"],Gt=()=>{const[d,P]=r.useState([]),[_,f]=r.useState(!0),[v,y]=r.useState(!1),[g,M]=r.useState(null),[t,a]=r.useState({name:"",description:"",targets:"",color:ms[0]}),[s,n]=r.useState(null),[m,p]=r.useState(!1);r.useEffect(()=>{i()},[]);const i=async()=>{f(!0);try{const S=await Ye.getAll();P(S.data)}catch(S){l.error("Failed to load target groups"),console.error(S)}finally{f(!1)}},D=()=>{a({name:"",description:"",targets:"",color:ms[0]}),M(null),y(!1)},A=S=>{const u=JSON.parse(S.targets||"[]");a({name:S.name,description:S.description||"",targets:u.join(`
`),color:S.color}),M(S.id),y(!0)},V=async S=>{var T,I;S.preventDefault();const u=t.targets.split(`
`).map(z=>z.trim()).filter(z=>z.length>0);if(!t.name.trim()){l.error("Name is required");return}if(u.length===0){l.error("At least one target is required");return}try{g?(await Ye.update(g,{name:t.name,description:t.description||void 0,targets:u,color:t.color}),l.success("Target group updated")):(await Ye.create({name:t.name,description:t.description||void 0,targets:u,color:t.color}),l.success("Target group created")),D(),i()}catch(z){const L=z;l.error(((I=(T=L.response)==null?void 0:T.data)==null?void 0:I.error)||"Failed to save target group")}},j=async()=>{var S,u;if(s){p(!0);try{await Ye.delete(s.id),l.success(`Target group "${s.name}" deleted`),i(),n(null)}catch(T){const I=T;l.error(((u=(S=I.response)==null?void 0:S.data)==null?void 0:u.error)||"Failed to delete")}finally{p(!1)}}},C=S=>{try{return JSON.parse(S||"[]")}catch{return[]}};return _?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(H,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ms,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Target Groups"})]}),!v&&e.jsxs(E,{variant:"primary",onClick:()=>y(!0),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"New Group"]})]})}),v&&e.jsx(H,{children:e.jsxs("form",{onSubmit:V,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:g?"Edit Target Group":"Create Target Group"}),e.jsx("button",{type:"button",onClick:D,className:"text-slate-400 hover:text-white",children:e.jsx(be,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:t.name,onChange:S=>a({...t,name:S.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Production Servers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Color"}),e.jsx("div",{className:"flex gap-2",children:ms.map(S=>e.jsx("button",{type:"button",onClick:()=>a({...t,color:S}),className:`w-8 h-8 rounded-full border-2 transition-all ${t.color===S?"border-white scale-110":"border-transparent"}`,style:{backgroundColor:S}},S))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:t.description,onChange:S=>a({...t,description:S.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Targets (one per line)"}),e.jsx("textarea",{value:t.targets,onChange:S=>a({...t,targets:S.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:5,placeholder:`192.168.1.0/24
10.0.0.1
example.com`})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:D,children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"primary",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),g?"Update":"Create"]})]})]})}),d.length===0&&!v?e.jsx(H,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ls,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No target groups yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create groups to organize your scan targets"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(S=>{const u=C(S.targets);return e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:S.color}}),e.jsx("h4",{className:"font-medium text-white",children:S.name})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>A(S),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>n(S),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete target group ${S.name}`,children:e.jsx(ne,{className:"h-4 w-4"})})]})]}),S.description&&e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:S.description}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:[u.length," target",u.length!==1?"s":""]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[u.slice(0,5).map((T,I)=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-300 font-mono",children:T},I)),u.length>5&&e.jsxs("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-500",children:["+",u.length-5," more"]})]})]})]},S.id)})}),e.jsx(Se,{isOpen:!!s,onClose:()=>n(null),onConfirm:j,title:"Delete Target Group",message:`Are you sure you want to delete the target group "${s==null?void 0:s.name}"? Scheduled scans using this group will need to be updated.`,confirmLabel:"Delete Group",variant:"danger",loading:m})]})},Ss={name:"",description:"",schedule_type:"daily",schedule_value:"02:00",targets:"",port_range_start:1,port_range_end:1e3,threads:100,enable_os_detection:!0,enable_service_detection:!0,enable_vuln_scan:!0,enable_enumeration:!1},Es=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],zt=()=>{const[d,P]=r.useState([]),[_,f]=r.useState([]),[v,y]=r.useState(!0),[g,M]=r.useState(!1),[t,a]=r.useState(null),[s,n]=r.useState(Ss),[m,p]=r.useState(0),[i,D]=r.useState(1),[A,V]=r.useState(null),[j,C]=r.useState(!1);r.useEffect(()=>{S()},[]);const S=async()=>{y(!0);try{const[h,R]=await Promise.all([qe.getAll(),Ye.getAll()]);P(h.data),f(R.data)}catch(h){l.error("Failed to load scheduled scans"),console.error(h)}finally{y(!1)}},u=()=>{n(Ss),a(null),M(!1),p(0),D(1)},T=h=>{const R=JSON.parse(h.config);if(n({name:h.name,description:h.description||"",schedule_type:h.schedule_type,schedule_value:h.schedule_value,targets:R.targets.join(`
`),port_range_start:R.port_range[0],port_range_end:R.port_range[1],threads:R.threads,enable_os_detection:R.enable_os_detection,enable_service_detection:R.enable_service_detection,enable_vuln_scan:R.enable_vuln_scan,enable_enumeration:R.enable_enumeration}),h.schedule_type==="weekly"){const b=h.schedule_value.split(" ");b.length>=2&&p(parseInt(b[1])||0)}else if(h.schedule_type==="monthly"){const b=h.schedule_value.split(" ");b.length>=2&&D(parseInt(b[1])||1)}a(h.id),M(!0)},I=()=>{const h=s.schedule_value.includes(":")?s.schedule_value:"02:00";switch(s.schedule_type){case"daily":return h;case"weekly":return`${h} ${m}`;case"monthly":return`${h} ${i}`;default:return h}},z=async h=>{var X,c;h.preventDefault();const R=s.targets.split(`
`).map(G=>G.trim()).filter(G=>G.length>0);if(!s.name.trim()){l.error("Name is required");return}if(R.length===0){l.error("At least one target is required");return}const b={targets:R,port_range:[s.port_range_start,s.port_range_end],threads:s.threads,enable_os_detection:s.enable_os_detection,enable_service_detection:s.enable_service_detection,enable_vuln_scan:s.enable_vuln_scan,enable_enumeration:s.enable_enumeration},Q=I();try{t?(await qe.update(t,{name:s.name,description:s.description||void 0,config:b,schedule_type:s.schedule_type,schedule_value:Q}),l.success("Scheduled scan updated")):(await qe.create({name:s.name,description:s.description||void 0,config:b,schedule_type:s.schedule_type,schedule_value:Q}),l.success("Scheduled scan created")),u(),S()}catch(G){const B=G;l.error(((c=(X=B.response)==null?void 0:X.data)==null?void 0:c.error)||"Failed to save scheduled scan")}},L=async h=>{var R,b;try{await qe.update(h.id,{is_active:!h.is_active}),l.success(`Scheduled scan ${h.is_active?"paused":"activated"}`),S()}catch(Q){const X=Q;l.error(((b=(R=X.response)==null?void 0:R.data)==null?void 0:b.error)||"Failed to update")}},O=async()=>{var h,R;if(A){C(!0);try{await qe.delete(A.id),l.success(`Scheduled scan "${A.name}" deleted`),S(),V(null)}catch(b){const Q=b;l.error(((R=(h=Q.response)==null?void 0:h.data)==null?void 0:R.error)||"Failed to delete")}finally{C(!1)}}},w=h=>{const R=JSON.parse(h.targets||"[]");n(b=>({...b,targets:R.join(`
`)}))},k=h=>{const R=h.schedule_value.split(" "),b=R[0];switch(h.schedule_type){case"daily":return`Daily at ${b}`;case"weekly":return`Every ${Es[parseInt(R[1])||0]} at ${b}`;case"monthly":return`Monthly on day ${R[1]||1} at ${b}`;default:return h.schedule_value}};return v?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(H,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scheduled Scans"})]}),!g&&e.jsxs(E,{variant:"primary",onClick:()=>M(!0),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"New Schedule"]})]})}),g&&e.jsx(H,{children:e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:t?"Edit Scheduled Scan":"Create Scheduled Scan"}),e.jsx("button",{type:"button",onClick:u,className:"text-slate-400 hover:text-white",children:e.jsx(be,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:h=>n({...s,name:h.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Daily Network Scan"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:s.description,onChange:h=>n({...s,description:h.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(is,{className:"h-4 w-4"})," Schedule"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Frequency"}),e.jsxs("select",{value:s.schedule_type,onChange:h=>n({...s,schedule_type:h.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),s.schedule_type==="weekly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Week"}),e.jsx("select",{value:m,onChange:h=>p(parseInt(h.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Es.map((h,R)=>e.jsx("option",{value:R,children:h},h))})]}),s.schedule_type==="monthly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Month"}),e.jsx("select",{value:i,onChange:h=>D(parseInt(h.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Array.from({length:28},(h,R)=>R+1).map(h=>e.jsx("option",{value:h,children:h},h))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Time (UTC)"}),e.jsx("input",{type:"time",value:s.schedule_value.split(" ")[0],onChange:h=>n({...s,schedule_value:h.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Targets (one per line)"}),_.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Use group:"}),_.slice(0,3).map(h=>e.jsx("button",{type:"button",onClick:()=>w(h),className:"px-2 py-0.5 text-xs rounded border border-dark-border text-slate-400 hover:text-white hover:border-primary",style:{borderLeftColor:h.color,borderLeftWidth:3},children:h.name},h.id))]})]}),e.jsx("textarea",{value:s.targets,onChange:h=>n({...s,targets:h.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:4,placeholder:`192.168.1.0/24
10.0.0.1`})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port Start"}),e.jsx("input",{type:"number",value:s.port_range_start,onChange:h=>n({...s,port_range_start:parseInt(h.target.value)||1}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port End"}),e.jsx("input",{type:"number",value:s.port_range_end,onChange:h=>n({...s,port_range_end:parseInt(h.target.value)||1e3}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Threads"}),e.jsx("input",{type:"number",value:s.threads,onChange:h=>n({...s,threads:parseInt(h.target.value)||100}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:1e3})]})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:[{key:"enable_os_detection",label:"OS Detection"},{key:"enable_service_detection",label:"Service Detection"},{key:"enable_vuln_scan",label:"Vulnerability Scan"},{key:"enable_enumeration",label:"Enumeration"}].map(({key:h,label:R})=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s[h],onChange:b=>n({...s,[h]:b.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-slate-300",children:R})]},h))}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:u,children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"primary",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),t?"Update":"Create"]})]})]})}),d.length===0&&!g?e.jsx(H,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(je,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scheduled scans"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create automated recurring scans"})]})}):e.jsx("div",{className:"space-y-3",children:d.map(h=>{const R=JSON.parse(h.config);return e.jsx(H,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${h.is_active?"bg-green-500/20":"bg-slate-500/20"}`,children:e.jsx(je,{className:`h-5 w-5 ${h.is_active?"text-green-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-white",children:h.name}),e.jsx(te,{variant:"status",type:h.is_active?"completed":"pending",children:h.is_active?"Active":"Paused"})]}),e.jsx("p",{className:"text-sm text-slate-400",children:k(h)}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[R.targets.length," target",R.targets.length!==1?"s":""," | Ports ",R.port_range[0],"-",R.port_range[1]," |",h.run_count," runs",h.last_run_at&&e.jsxs(e.Fragment,{children:[" | Last run ",et(new Date(h.last_run_at))," ago"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>L(h),className:`p-2 rounded transition-colors ${h.is_active?"text-yellow-400 hover:bg-yellow-500/20":"text-green-400 hover:bg-green-500/20"}`,title:h.is_active?"Pause":"Activate",children:h.is_active?e.jsx(Os,{className:"h-4 w-4"}):e.jsx(js,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>T(h),className:"p-2 text-slate-400 hover:text-primary transition-colors",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>V(h),className:"p-2 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete scheduled scan ${h.name}`,children:e.jsx(ne,{className:"h-4 w-4"})})]})]})},h.id)})}),e.jsx(Se,{isOpen:!!A,onClose:()=>V(null),onConfirm:O,title:"Delete Scheduled Scan",message:`Are you sure you want to delete the scheduled scan "${A==null?void 0:A.name}"? Future automated scans will no longer run.`,confirmLabel:"Delete Schedule",variant:"warning",loading:j})]})},Vt=()=>{const[d,P]=r.useState(null),[_,f]=r.useState(!0),[v,y]=r.useState(!1),[g,M]=r.useState(!1),[t,a]=r.useState(!1),[s,n]=r.useState(!1),[m,p]=r.useState(null),[i,D]=r.useState({email_on_scan_complete:!1,email_on_critical_vuln:!0,email_address:"",slack_webhook_url:"",teams_webhook_url:""});r.useEffect(()=>{A(),V()},[]);const A=async()=>{var T;f(!0);try{const I=await ve.getSettings();P(I.data),D({email_on_scan_complete:I.data.email_on_scan_complete,email_on_critical_vuln:I.data.email_on_critical_vuln,email_address:I.data.email_address||"",slack_webhook_url:I.data.slack_webhook_url||"",teams_webhook_url:I.data.teams_webhook_url||""})}catch(I){((T=I.response)==null?void 0:T.status)!==404&&(l.error("Failed to load notification settings"),console.error(I))}finally{f(!1)}},V=async()=>{try{const T=await ve.checkSmtpStatus();p(T.data.configured)}catch(T){console.error("Failed to check SMTP status:",T),p(!1)}},j=async T=>{var I,z;if(T.preventDefault(),(i.email_on_scan_complete||i.email_on_critical_vuln)&&!i.email_address){l.error("Email address is required when notifications are enabled");return}y(!0);try{const L=await ve.updateSettings(i);P(L.data),l.success("Notification settings saved")}catch(L){const O=L;l.error(((z=(I=O.response)==null?void 0:I.data)==null?void 0:z.error)||"Failed to save settings")}finally{y(!1)}},C=async()=>{var T,I;if(!i.slack_webhook_url){l.error("Please enter a Slack webhook URL first");return}M(!0);try{i.slack_webhook_url!==(d==null?void 0:d.slack_webhook_url)&&await ve.updateSettings({slack_webhook_url:i.slack_webhook_url});const z=await ve.testSlack();l.success(z.data.message)}catch(z){const L=z;l.error(((I=(T=L.response)==null?void 0:T.data)==null?void 0:I.error)||"Failed to send test message")}finally{M(!1)}},S=async()=>{var T,I;if(!i.teams_webhook_url){l.error("Please enter a Teams webhook URL first");return}a(!0);try{i.teams_webhook_url!==(d==null?void 0:d.teams_webhook_url)&&await ve.updateSettings({teams_webhook_url:i.teams_webhook_url});const z=await ve.testTeams();l.success(z.data.message)}catch(z){const L=z;l.error(((I=(T=L.response)==null?void 0:T.data)==null?void 0:I.error)||"Failed to send test message")}finally{a(!1)}},u=async()=>{var T,I;if(!i.email_address){l.error("Please enter an email address first");return}if(!m){l.error("SMTP is not configured on the server. Contact your administrator.");return}n(!0);try{i.email_address!==(d==null?void 0:d.email_address)&&await ve.updateSettings({email_address:i.email_address});const z=await ve.testEmail();l.success(z.data.message)}catch(z){const L=z;l.error(((I=(T=L.response)==null?void 0:T.data)==null?void 0:I.error)||"Failed to send test email")}finally{n(!1)}};return _?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Us,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Notification Settings"})]}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Notification Email Address"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Te,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"email",value:i.email_address,onChange:T=>D({...i,email_address:T.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"your@email.com"})]}),e.jsx(E,{type:"button",variant:"secondary",onClick:u,disabled:!i.email_address||s||!m,title:m?"Send test email":"SMTP not configured on server",children:s?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Sending..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Email address where notifications will be sent"}),m!==null&&e.jsx("span",{className:`text-xs flex items-center gap-1 ${m?"text-green-400":"text-amber-400"}`,children:m?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"h-3 w-3"}),"SMTP configured"]}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"h-3 w-3"}),"SMTP not configured"]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Email Notifications"}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:i.email_on_scan_complete,onChange:T=>D({...i,email_on_scan_complete:T.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"font-medium text-white",children:"Scan Completion"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Receive an email when any of your scans complete, including a summary of findings"})]})]}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:i.email_on_critical_vuln,onChange:T=>D({...i,email_on_critical_vuln:T.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"font-medium text-white",children:"Critical Vulnerabilities"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Get immediate alerts when critical or high severity vulnerabilities are discovered"})]})]})]}),m===!1?e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(fe,{className:"h-5 w-5 text-amber-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-200",children:"SMTP is not configured on this server. Email notifications are disabled."}),e.jsx("p",{className:"text-xs text-amber-300/70 mt-1",children:"Contact your administrator to configure SMTP settings (SMTP_HOST, SMTP_USER, etc.)"})]})]})}):e.jsx("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Te,{className:"h-5 w-5 text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-200",children:m?"Email notifications are ready. Use the Test button to verify delivery.":"Checking SMTP configuration..."}),e.jsx("p",{className:"text-xs text-blue-300/70 mt-1",children:"Contact your administrator if you're not receiving emails."})]})]})}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-dark-border",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(_t,{className:"h-4 w-4"}),"Webhook Integrations"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Slack Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:i.slack_webhook_url,onChange:T=>D({...i,slack_webhook_url:T.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://hooks.slack.com/services/YOUR/WEBHOOK/URL"}),e.jsx(E,{type:"button",variant:"secondary",onClick:C,disabled:!i.slack_webhook_url||g,children:g?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Send scan notifications to a Slack channel. Create a webhook at"," ",e.jsx("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Slack Incoming Webhooks"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Microsoft Teams Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:i.teams_webhook_url,onChange:T=>D({...i,teams_webhook_url:T.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://outlook.office.com/webhook/YOUR/WEBHOOK/URL"}),e.jsx(E,{type:"button",variant:"secondary",onClick:S,disabled:!i.teams_webhook_url||t,children:t?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Send scan notifications to a Teams channel. Create a webhook in your Teams channel connectors."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(E,{type:"submit",variant:"primary",disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Save Settings"]})})})]})]}),d&&e.jsxs(H,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"Current Status"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Scan Complete Emails:"}),e.jsx("span",{className:`ml-2 ${d.email_on_scan_complete?"text-green-400":"text-slate-400"}`,children:d.email_on_scan_complete?"Enabled":"Disabled"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Critical Vuln Alerts:"}),e.jsx("span",{className:`ml-2 ${d.email_on_critical_vuln?"text-green-400":"text-slate-400"}`,children:d.email_on_critical_vuln?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-slate-500",children:"Last Updated:"}),e.jsx("span",{className:"ml-2 text-slate-300",children:new Date(d.updated_at).toLocaleString()})]})]})]})]})},Qe={quick:{label:"Quick",icon:$s,color:"text-yellow-400"},standard:{label:"Standard",icon:cs,color:"text-blue-400"},comprehensive:{label:"Comprehensive",icon:ue,color:"text-purple-400"},web:{label:"Web",icon:ys,color:"text-green-400"},stealth:{label:"Stealth",icon:bs,color:"text-slate-400"},custom:{label:"Custom",icon:Ie,color:"text-cyan-400"}},Bt=()=>{var B;const[d,P]=r.useState([]),[_,f]=r.useState(!0),[v,y]=r.useState(!1),[g,M]=r.useState(null),[t,a]=r.useState({name:"",description:"",category:"custom",estimated_duration_mins:""}),[s,n]=r.useState(new Set),[m,p]=r.useState(new Set),[i,D]=r.useState(null),[A,V]=r.useState(!1),[j,C]=r.useState(null),[S,u]=r.useState(null);r.useEffect(()=>{T()},[]);const T=async()=>{f(!0);try{const o=await Oe.getAll();P(o.data)}catch(o){l.error("Failed to load templates"),console.error(o)}finally{f(!1)}},I=r.useMemo(()=>{const o={};return d.forEach($=>{const W=$.category||"custom";o[W]||(o[W]=[]),o[W].push($)}),Object.keys(o).forEach($=>{o[$].sort((W,N)=>W.is_system!==N.is_system?W.is_system?-1:1:W.is_default!==N.is_default?W.is_default?-1:1:N.use_count-W.use_count)}),o},[d]),z=r.useMemo(()=>["quick","standard","comprehensive","web","stealth","custom"].filter($=>{var W;return((W=I[$])==null?void 0:W.length)>0}),[I]),L=r.useMemo(()=>j?I[j]||[]:d,[d,j,I]),O=()=>{a({name:"",description:"",category:"custom",estimated_duration_mins:""}),M(null),y(!1)},w=o=>{if(o.is_system){l.error("System templates cannot be edited. Clone it to create your own version.");return}a({name:o.name,description:o.description||"",category:o.category,estimated_duration_mins:o.estimated_duration_mins||""}),M(o.id),y(!0)},k=async o=>{var $,W;if(o.preventDefault(),!t.name.trim()){l.error("Name is required");return}if(!g){l.error('Cannot create templates from this form. Use "Save as Template" in the scan form.');return}try{await Oe.update(g,{name:t.name,description:t.description||void 0,category:t.category,estimated_duration_mins:t.estimated_duration_mins||void 0}),l.success("Template updated"),O(),T()}catch(N){const q=N;l.error(((W=($=q.response)==null?void 0:$.data)==null?void 0:W.error)||"Failed to update template")}},h=async()=>{var o,$;if(i){V(!0);try{await Oe.delete(i.id),l.success(`Template "${i.name}" deleted`),T(),D(null)}catch(W){const N=W;l.error((($=(o=N.response)==null?void 0:o.data)==null?void 0:$.error)||"Failed to delete")}finally{V(!1)}}},R=async o=>{var W,N;const $=prompt("Enter name for the cloned template:",`${o.name} (Copy)`);if($){p(q=>new Set([...q,o.id]));try{await Oe.clone(o.id,$),l.success("Template cloned successfully"),T()}catch(q){const x=q;l.error(((N=(W=x.response)==null?void 0:W.data)==null?void 0:N.error)||"Failed to clone template")}finally{p(q=>{const x=new Set(q);return x.delete(o.id),x})}}},b=async o=>{var $,W;u(o.id);try{await Oe.setDefault(o.id),l.success(`"${o.name}" set as default template`),T()}catch(N){const q=N;l.error(((W=($=q.response)==null?void 0:$.data)==null?void 0:W.error)||"Failed to set default")}finally{u(null)}},Q=async o=>{var q,x;const $=prompt(`Enter name for new scan (based on "${o.name}"):`,`${o.name} - ${new Date().toLocaleDateString()}`);if(!$)return;const W=prompt("Enter target(s) to scan (comma-separated IPs or hostnames):");if(!W)return;const N=W.split(",").map(K=>K.trim()).filter(Boolean);if(N.length===0){l.error("At least one target is required");return}n(new Set([...s,o.id]));try{await Oe.createScan(o.id,$,N),l.success("Scan started from template!")}catch(K){const Y=K;l.error(((x=(q=Y.response)==null?void 0:q.data)==null?void 0:x.error)||"Failed to create scan")}finally{n(K=>{const Y=new Set(K);return Y.delete(o.id),Y})}},X=o=>{if(!o)return"-";if(o<60)return`~${o}m`;const $=Math.floor(o/60),W=o%60;return W?`~${$}h ${W}m`:`~${$}h`},c=o=>new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),G=o=>e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[o.enable_os_detection&&e.jsx(te,{variant:"status",type:"completed",children:"OS"}),o.enable_service_detection&&e.jsx(te,{variant:"status",type:"completed",children:"Services"}),o.enable_vuln_scan&&e.jsx(te,{variant:"status",type:"running",children:"Vuln Scan"}),o.enable_enumeration&&e.jsx(te,{variant:"status",type:"pending",children:"Enum"})]});return _?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scan Templates"})]}),e.jsx("div",{className:"text-sm text-slate-400",children:"Reusable scan profiles for quick configuration"})]}),z.length>0&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>C(null),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${j===null?"bg-primary text-white":"bg-dark-bg text-slate-400 hover:text-white hover:bg-slate-700"}`,children:["All (",d.length,")"]}),z.map(o=>{var q;const $=Qe[o],W=$.icon,N=((q=I[o])==null?void 0:q.length)||0;return e.jsxs("button",{onClick:()=>C(o),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${j===o?"bg-primary text-white":"bg-dark-bg text-slate-400 hover:text-white hover:bg-slate-700"}`,children:[e.jsx(W,{className:`h-4 w-4 ${j===o?"text-white":$.color}`}),$.label," (",N,")"]},o)})]})]}),v&&e.jsx(H,{children:e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Edit Template"}),e.jsx("button",{type:"button",onClick:O,className:"text-slate-400 hover:text-white",children:e.jsx(be,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:t.name,onChange:o=>a({...t,name:o.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"My Custom Template"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Category"}),e.jsx("select",{value:t.category,onChange:o=>a({...t,category:o.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Object.entries(Qe).map(([o,$])=>e.jsx("option",{value:o,children:$.label},o))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("textarea",{value:t.description,onChange:o=>a({...t,description:o.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",rows:2,placeholder:"Optional description of the template"})]}),e.jsxs("div",{className:"w-48",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Est. Duration (mins)"}),e.jsx("input",{type:"number",value:t.estimated_duration_mins,onChange:o=>a({...t,estimated_duration_mins:o.target.value?parseInt(o.target.value):""}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"30",min:"1"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:O,children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"primary",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Update"]})]})]})}),L.length===0&&!v?e.jsx(H,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ie,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:j?`No ${((B=Qe[j])==null?void 0:B.label)||""} templates`:"No scan templates yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:'Save scan configurations using "Save as Template" when creating a scan'})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:L.map(o=>{const $=o.config,W=s.has(o.id),N=m.has(o.id),q=S===o.id,x=Qe[o.category]||Qe.custom,K=x.icon;return e.jsxs(H,{className:"relative",children:[o.is_system&&e.jsx("div",{className:"absolute top-2 right-2",title:"System template (read-only)",children:e.jsx(es,{className:"h-4 w-4 text-slate-500"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-dark-bg ${x.color}`,children:e.jsx(K,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-white truncate",children:o.name}),o.is_default&&e.jsx("span",{title:"Default template",children:e.jsx(ls,{className:"h-4 w-4 text-yellow-400 flex-shrink-0"})})]}),o.description&&e.jsx("p",{className:"text-sm text-slate-400 line-clamp-2 mt-0.5",children:o.description})]})]}),e.jsxs("div",{className:"space-y-2 border-t border-dark-border pt-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Ports: ",$.port_range[0],"-",$.port_range[1]]})]}),$.scan_type&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(kt,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-slate-400 capitalize",children:$.scan_type.replace("_"," ")})]}),$.enable_enumeration&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gs,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Enum: ",$.enum_depth||"light"]})]}),o.estimated_duration_mins&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-slate-400",children:X(o.estimated_duration_mins)})]})]}),G($)]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 border-t border-dark-border pt-3",children:[e.jsxs("span",{children:["Used ",o.use_count," times"]}),o.last_used_at?e.jsxs("span",{children:["Last: ",c(o.last_used_at)]}):e.jsxs("span",{children:["Created ",c(o.created_at)]})]}),e.jsxs("div",{className:"flex items-center justify-between border-t border-dark-border pt-3",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>R(o),disabled:N,className:"p-1.5 text-slate-400 hover:text-primary transition-colors disabled:opacity-50",title:"Clone template",children:e.jsx(he,{className:"h-4 w-4"})}),!o.is_system&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>w(o),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit template",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>D(o),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete template",children:e.jsx(ne,{className:"h-4 w-4"})})]}),!o.is_default&&e.jsx("button",{onClick:()=>b(o),disabled:q,className:"p-1.5 text-slate-400 hover:text-yellow-400 transition-colors disabled:opacity-50",title:"Set as default",children:e.jsx(ls,{className:"h-4 w-4"})})]}),e.jsxs(E,{variant:"primary",size:"sm",onClick:()=>Q(o),loading:W,disabled:W,children:[e.jsx(Ct,{className:"h-4 w-4 mr-1.5"}),"Use"]})]})]})]},o.id)})}),e.jsx(Se,{isOpen:!!i,onClose:()=>D(null),onConfirm:h,title:"Delete Template",message:`Are you sure you want to delete the template "${i==null?void 0:i.name}"? This will not affect any scans previously created from this template.`,confirmLabel:"Delete Template",variant:"danger",loading:A})]})},As=["critical","high","medium","low","info"],qt=["web","network","infrastructure","cloud","api","mobile","other"],Ht=()=>{var W,N,q;const[d,P]=r.useState([]),[_,f]=r.useState([]),[v,y]=r.useState(!0),[g,M]=r.useState(!1),[t,a]=r.useState(null),[s,n]=r.useState(null),[m,p]=r.useState(!1),[i,D]=r.useState(!1),[A,V]=r.useState(null),[j,C]=r.useState(""),[S,u]=r.useState(""),[T,I]=r.useState(""),[z,L]=r.useState(!0),[O,w]=r.useState({category:"web",title:"",severity:"medium",description:"",impact:"",remediation:"",references:[],cwe_ids:[],cvss_vector:"",cvss_score:void 0,tags:[]});r.useEffect(()=>{k(),h()},[S,T,j,z]);const k=async()=>{y(!0);try{const x=await Ue.list({category:S||void 0,severity:T||void 0,search:j||void 0,include_system:z});P(x.data)}catch(x){l.error("Failed to load finding templates"),console.error(x)}finally{y(!1)}},h=async()=>{try{const x=await Ue.getCategories();f(x.data)}catch(x){console.error("Failed to load categories:",x)}},R=()=>{w({category:"web",title:"",severity:"medium",description:"",impact:"",remediation:"",references:[],cwe_ids:[],cvss_vector:"",cvss_score:void 0,tags:[]}),a(null),M(!1)},b=x=>{w({category:x.category,title:x.title,severity:x.severity,description:x.description,impact:x.impact||"",remediation:x.remediation||"",references:x.references?JSON.parse(x.references):[],cwe_ids:x.cwe_ids?JSON.parse(x.cwe_ids):[],cvss_vector:x.cvss_vector||"",cvss_score:x.cvss_score||void 0,tags:x.tags?JSON.parse(x.tags):[]}),a(x),M(!0)},Q=async x=>{var Y,me;const K=prompt("Enter name for cloned template:",`${x.title} (Copy)`);if(K)try{await Ue.clone(x.id,{new_title:K}),l.success("Template cloned successfully"),k(),h()}catch(F){const re=F;l.error(((me=(Y=re.response)==null?void 0:Y.data)==null?void 0:me.error)||"Failed to clone template")}},X=async x=>{var K,Y;if(x.preventDefault(),!O.title.trim()){l.error("Title is required");return}if(!O.description.trim()){l.error("Description is required");return}D(!0);try{t?(await Ue.update(t.id,O),l.success("Template updated successfully")):(await Ue.create(O),l.success("Template created successfully")),R(),k(),h()}catch(me){const F=me;l.error(((Y=(K=F.response)==null?void 0:K.data)==null?void 0:Y.error)||"Failed to save template")}finally{D(!1)}},c=async()=>{var x,K;if(s){p(!0);try{await Ue.delete(s.id),l.success(`Template "${s.title}" deleted`),k(),h(),n(null)}catch(Y){const me=Y;l.error(((K=(x=me.response)==null?void 0:x.data)==null?void 0:K.error)||"Failed to delete template")}finally{p(!1)}}},G=x=>{switch(x.toLowerCase()){case"critical":case"high":return e.jsx(fe,{className:"h-4 w-4"});case"medium":return e.jsx(ue,{className:"h-4 w-4"});default:return e.jsx(Ve,{className:"h-4 w-4"})}},B=x=>{const K=x.toLowerCase();return K==="critical"?"critical":K==="high"?"high":K==="medium"?"medium":"low"},o=x=>{if(!x)return[];try{return JSON.parse(x)}catch{return[]}},$=x=>new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return v&&d.length===0?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(H,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Finding Templates"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-slate-400",children:[d.length," template",d.length!==1?"s":""]}),e.jsxs(E,{variant:"primary",size:"sm",onClick:()=>M(!0),children:[e.jsx(ce,{className:"h-4 w-4 mr-1.5"}),"New Template"]})]})]})}),e.jsx(H,{children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(Gs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",value:j,onChange:x=>C(x.target.value),placeholder:"Search templates...",className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})}),e.jsxs("div",{className:"relative",children:[e.jsx(St,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsxs("select",{value:S,onChange:x=>u(x.target.value),className:"bg-dark-bg border border-dark-border rounded-lg pl-10 pr-8 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"All Categories"}),_.map(x=>e.jsxs("option",{value:x.category,children:[x.category.charAt(0).toUpperCase()+x.category.slice(1)," (",x.count,")"]},x.category))]}),e.jsx(Ze,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:T,onChange:x=>I(x.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent appearance-none cursor-pointer pr-8",children:[e.jsx("option",{value:"",children:"All Severities"}),As.map(x=>e.jsx("option",{value:x,children:x.charAt(0).toUpperCase()+x.slice(1)},x))]}),e.jsx(Ze,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:z,onChange:x=>L(x.target.checked),className:"rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),"Include system templates"]})]})}),g&&e.jsx(H,{children:e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:t?"Edit Template":"New Template"}),e.jsx("button",{type:"button",onClick:R,className:"text-slate-400 hover:text-white",children:e.jsx(be,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Category"}),e.jsx("select",{value:O.category,onChange:x=>w({...O,category:x.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:qt.map(x=>e.jsx("option",{value:x,children:x.charAt(0).toUpperCase()+x.slice(1)},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Severity"}),e.jsx("select",{value:O.severity,onChange:x=>w({...O,severity:x.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:As.map(x=>e.jsx("option",{value:x,children:x.charAt(0).toUpperCase()+x.slice(1)},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CVSS Score"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"10",value:O.cvss_score||"",onChange:x=>w({...O,cvss_score:x.target.value?parseFloat(x.target.value):void 0}),placeholder:"0.0 - 10.0",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:O.title,onChange:x=>w({...O,title:x.target.value}),placeholder:"e.g., SQL Injection in Login Form",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description *"}),e.jsx("textarea",{value:O.description,onChange:x=>w({...O,description:x.target.value}),rows:4,placeholder:"Detailed description of the vulnerability...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Impact"}),e.jsx("textarea",{value:O.impact||"",onChange:x=>w({...O,impact:x.target.value}),rows:2,placeholder:"Potential impact if exploited...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Remediation"}),e.jsx("textarea",{value:O.remediation||"",onChange:x=>w({...O,remediation:x.target.value}),rows:3,placeholder:"Recommended steps to fix...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CVSS Vector"}),e.jsx("input",{type:"text",value:O.cvss_vector||"",onChange:x=>w({...O,cvss_vector:x.target.value}),placeholder:"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CWE IDs (comma-separated)"}),e.jsx("input",{type:"text",value:((W=O.cwe_ids)==null?void 0:W.join(", "))||"",onChange:x=>{const K=x.target.value.split(",").map(Y=>parseInt(Y.trim())).filter(Y=>!isNaN(Y));w({...O,cwe_ids:K})},placeholder:"e.g., 89, 564",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"References (one URL per line)"}),e.jsx("textarea",{value:((N=O.references)==null?void 0:N.join(`
`))||"",onChange:x=>{const K=x.target.value.split(`
`).map(Y=>Y.trim()).filter(Y=>Y);w({...O,references:K})},rows:2,placeholder:"https://owasp.org/...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:((q=O.tags)==null?void 0:q.join(", "))||"",onChange:x=>{const K=x.target.value.split(",").map(Y=>Y.trim()).filter(Y=>Y);w({...O,tags:K})},placeholder:"e.g., owasp, web, injection",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:R,children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"primary",loading:i,disabled:i,children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),t?"Update":"Create"]})]})]})}),d.length===0&&!g?e.jsx(H,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ie,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No finding templates found"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:S||T||j?"Try adjusting your filters":"Create your first template or include system templates"})]})}):e.jsx("div",{className:"space-y-3",children:d.map(x=>{const K=A===x.id,Y=o(x.references),me=o(x.cwe_ids),F=o(x.tags);return e.jsx(H,{className:K?"ring-1 ring-primary":"",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>V(K?null:x.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(te,{variant:"severity",type:B(x.severity),children:[G(x.severity),e.jsx("span",{className:"ml-1",children:x.severity})]}),e.jsx(te,{variant:"status",type:"pending",children:x.category}),x.is_system&&e.jsx(te,{variant:"status",type:"completed",children:"System"})]}),e.jsx("h4",{className:"font-semibold text-white text-lg mt-2",children:x.title}),!K&&e.jsx("p",{className:"text-sm text-slate-400 mt-1 line-clamp-2",children:x.description})]}),e.jsxs("div",{className:"flex gap-1 ml-4",children:[e.jsx("button",{onClick:()=>Q(x),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Clone template",children:e.jsx(he,{className:"h-4 w-4"})}),!x.is_system&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>b(x),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit template",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>n(x),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete template",children:e.jsx(ne,{className:"h-4 w-4"})})]})]})]}),K&&e.jsxs("div",{className:"border-t border-dark-border pt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:x.description})]}),x.impact&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Impact"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:x.impact})]}),x.remediation&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Remediation"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:x.remediation})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[x.cvss_score!==null&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"CVSS:"})," ",e.jsx("span",{className:"text-white font-medium",children:x.cvss_score.toFixed(1)})]}),x.cvss_vector&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Vector:"})," ",e.jsx("code",{className:"text-slate-300 text-xs",children:x.cvss_vector})]}),me.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"CWE:"})," ",me.map((re,pe)=>e.jsxs("span",{children:[pe>0&&", ",e.jsxs("a",{href:`https://cwe.mitre.org/data/definitions/${re}.html`,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:["CWE-",re]})]},re))]})]}),Y.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-2",children:"References"}),e.jsx("div",{className:"space-y-1",children:Y.map((re,pe)=>e.jsxs("a",{href:re,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-primary hover:underline",children:[e.jsx(ss,{className:"h-3 w-3"}),re]},pe))})]}),F.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5",children:F.map(re=>e.jsx("span",{className:"px-2 py-0.5 bg-dark-border rounded text-xs text-slate-300",children:re},re))}),e.jsxs("div",{className:"text-xs text-slate-500 pt-2 border-t border-dark-border",children:["Created ",$(x.created_at),x.updated_at!==x.created_at&&e.jsxs(e.Fragment,{children:["  Updated ",$(x.updated_at)]})]})]})]})},x.id)})}),e.jsx(Se,{isOpen:!!s,onClose:()=>n(null),onConfirm:c,title:"Delete Template",message:`Are you sure you want to delete the template "${s==null?void 0:s.title}"? This action cannot be undone.`,confirmLabel:"Delete Template",variant:"danger",loading:m})]})},Xe=[{id:"host",label:"Single Host",description:"Exclude a single IP address",placeholder:"192.168.1.1",icon:e.jsx(ge,{className:"h-4 w-4"})},{id:"cidr",label:"CIDR Range",description:"Exclude a network range",placeholder:"192.168.1.0/24",icon:e.jsx(ps,{className:"h-4 w-4"})},{id:"hostname",label:"Hostname Pattern",description:"Exclude by hostname (supports wildcards)",placeholder:"*.internal.example.com",icon:e.jsx(ys,{className:"h-4 w-4"})},{id:"port",label:"Single Port",description:"Exclude a specific port",placeholder:"22",icon:e.jsx(hs,{className:"h-4 w-4"})},{id:"port_range",label:"Port Range",description:"Exclude a range of ports",placeholder:"1-1000",icon:e.jsx(hs,{className:"h-4 w-4"})}],Wt=()=>{const[d,P]=r.useState([]),[_,f]=r.useState(!0),[v,y]=r.useState(!1),[g,M]=r.useState(!1),[t,a]=r.useState(null),[s,n]=r.useState({name:"",description:"",exclusion_type:"host",value:"",is_global:!0}),[m,p]=r.useState({exclusion_type:"host",values:"",is_global:!0,name_prefix:"Imported"}),[i,D]=r.useState(!1),[A,V]=r.useState(null),[j,C]=r.useState(!1);r.useEffect(()=>{S()},[]);const S=async()=>{f(!0);try{const b=await He.getAll();P(b.data)}catch(b){l.error("Failed to load exclusions"),console.error(b)}finally{f(!1)}},u=()=>{n({name:"",description:"",exclusion_type:"host",value:"",is_global:!0}),a(null),y(!1)},T=()=>{p({exclusion_type:"host",values:"",is_global:!0,name_prefix:"Imported"}),M(!1)},I=b=>{n({name:b.name,description:b.description||"",exclusion_type:b.exclusion_type,value:b.value,is_global:b.is_global}),a(b.id),y(!0)},z=async b=>{var Q,X;if(b.preventDefault(),!s.name.trim()){l.error("Name is required");return}if(!s.value.trim()){l.error("Value is required");return}try{const c={name:s.name.trim(),description:s.description.trim()||void 0,exclusion_type:s.exclusion_type,value:s.value.trim(),is_global:s.is_global};t?(await He.update(t,c),l.success("Exclusion updated")):(await He.create(c),l.success("Exclusion created")),u(),S()}catch(c){const G=c;l.error(((X=(Q=G.response)==null?void 0:Q.data)==null?void 0:X.error)||"Failed to save exclusion")}},L=async()=>{var b,Q;if(A){C(!0);try{await He.delete(A.id),l.success(`Exclusion "${A.name}" deleted`),S(),V(null)}catch(X){const c=X;l.error(((Q=(b=c.response)==null?void 0:b.data)==null?void 0:Q.error)||"Failed to delete")}finally{C(!1)}}},O=async b=>{var Q,X;if(b.preventDefault(),!m.values.trim()){l.error("Please enter values to import");return}if(!m.name_prefix.trim()){l.error("Please enter a name prefix");return}D(!0);try{const G=(await He.bulkImport({exclusion_type:m.exclusion_type,values:m.values,is_global:m.is_global,name_prefix:m.name_prefix.trim()})).data;G.imported>0&&l.success(`Imported ${G.imported} exclusion(s)`),G.failed>0&&(l.warning(`${G.failed} value(s) failed to import`),G.errors.slice(0,3).forEach(B=>{l.error(B,{autoClose:5e3})})),T(),S()}catch(c){const G=c;l.error(((X=(Q=G.response)==null?void 0:Q.data)==null?void 0:X.error)||"Failed to bulk import")}finally{D(!1)}},w=()=>m.values.trim()?m.values.split(/[,\n;]/).map(b=>b.trim()).filter(b=>b.length>0).length:0,k=b=>Xe.find(Q=>Q.id===b)||Xe[0],h=d.filter(b=>b.is_global),R=d.filter(b=>!b.is_global);return _?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scan Exclusions"})]}),!v&&!g&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(E,{variant:"secondary",onClick:()=>M(!0),children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Bulk Import"]}),e.jsxs(E,{variant:"primary",onClick:()=>y(!0),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"New Exclusion"]})]})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Configure hosts and ports to exclude from scans. Global exclusions apply to all scans automatically."})]}),v&&e.jsx(H,{children:e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:t?"Edit Exclusion":"Create Exclusion"}),e.jsx("button",{type:"button",onClick:u,className:"text-slate-400 hover:text-white",children:e.jsx(be,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:b=>n({...s,name:b.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Development Servers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Type"}),e.jsx("select",{value:s.exclusion_type,onChange:b=>n({...s,exclusion_type:b.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Xe.map(b=>e.jsx("option",{value:b.id,children:b.label},b.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Value"}),e.jsx("input",{type:"text",value:s.value,onChange:b=>n({...s,value:b.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono",placeholder:k(s.exclusion_type).placeholder}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:k(s.exclusion_type).description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description (optional)"}),e.jsx("input",{type:"text",value:s.description,onChange:b=>n({...s,description:b.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Why is this excluded?"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.is_global,onChange:b=>n({...s,is_global:b.target.checked}),className:"w-4 h-4 rounded bg-dark-bg border-dark-border text-primary focus:ring-primary focus:ring-offset-dark-bg"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Apply to all scans (global exclusion)"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(Ve,{className:"h-3 w-3"}),e.jsx("span",{children:"Non-global exclusions can be selected per-scan"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:u,children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"primary",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),t?"Update":"Create"]})]})]})}),g&&e.jsx(H,{children:e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-5 w-5 text-cyan-400"}),e.jsx("h4",{className:"text-lg font-medium text-white",children:"Bulk Import Exclusions"})]}),e.jsx("button",{type:"button",onClick:T,className:"text-slate-400 hover:text-white",children:e.jsx(be,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Exclusion Type"}),e.jsx("select",{value:m.exclusion_type,onChange:b=>p({...m,exclusion_type:b.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Xe.map(b=>e.jsx("option",{value:b.id,children:b.label},b.id))}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:k(m.exclusion_type).description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name Prefix"}),e.jsx("input",{type:"text",value:m.name_prefix,onChange:b=>p({...m,name_prefix:b.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Imported"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:['Exclusions will be named "',m.name_prefix||"Imported",' 1", "',m.name_prefix||"Imported",' 2", etc.']})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Values"}),e.jsxs("span",{className:"text-xs text-slate-500",children:[w()," value(s) detected"]})]}),e.jsx("textarea",{value:m.values,onChange:b=>p({...m,values:b.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:6,placeholder:`Paste values here, one per line or comma-separated.

Example for IPs:
192.168.1.1
192.168.1.2
10.0.0.0/8

Example for ports:
22, 23, 135, 139, 445`})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m.is_global,onChange:b=>p({...m,is_global:b.target.checked}),className:"w-4 h-4 rounded bg-dark-bg border-dark-border text-primary focus:ring-primary focus:ring-offset-dark-bg"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Apply to all scans (global exclusions)"})]})}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(Ve,{className:"h-3 w-3"}),e.jsx("span",{children:"Separate values with commas, newlines, or semicolons"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:T,children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"primary",loading:i,disabled:w()===0,children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Import ",w()>0?`(${w()})`:""]})]})]})]})}),d.length===0&&!v&&!g?e.jsx(H,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ls,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No exclusions configured"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create exclusions to skip specific hosts or ports during scans"})]})}):e.jsxs(e.Fragment,{children:[h.length>0&&e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ys,{className:"h-4 w-4 text-green-400"}),e.jsx("h4",{className:"font-medium text-white",children:"Global Exclusions"}),e.jsx("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-0.5 rounded",children:"Applied to all scans"})]}),e.jsx("div",{className:"space-y-2",children:h.map(b=>e.jsx(Is,{exclusion:b,onEdit:I,onDelete:V},b.id))})]}),R.length>0&&e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ge,{className:"h-4 w-4 text-blue-400"}),e.jsx("h4",{className:"font-medium text-white",children:"Per-Scan Exclusions"}),e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded",children:"Select when creating scans"})]}),e.jsx("div",{className:"space-y-2",children:R.map(b=>e.jsx(Is,{exclusion:b,onEdit:I,onDelete:V},b.id))})]})]}),e.jsx(Se,{isOpen:!!A,onClose:()=>V(null),onConfirm:L,title:"Delete Exclusion",message:`Are you sure you want to delete the exclusion "${A==null?void 0:A.name}"? This cannot be undone.`,confirmLabel:"Delete Exclusion",variant:"danger",loading:j})]})},Is=({exclusion:d,onEdit:P,onDelete:_})=>{const f=Xe.find(y=>y.id===d.exclusion_type),v=y=>{switch(y){case"host":case"cidr":return"bg-purple-500/20 text-purple-400";case"hostname":return"bg-cyan-500/20 text-cyan-400";case"port":case"port_range":return"bg-orange-500/20 text-orange-400";default:return"bg-slate-500/20 text-slate-400"}};return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"text-slate-400",children:f==null?void 0:f.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:d.name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${v(d.exclusion_type)}`,children:(f==null?void 0:f.label)||d.exclusion_type})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("code",{className:"text-sm font-mono text-slate-300 bg-dark-surface px-2 py-0.5 rounded",children:d.value}),d.description&&e.jsx("span",{className:"text-xs text-slate-500 truncate",children:d.description})]})]})]}),e.jsxs("div",{className:"flex gap-1 ml-4",children:[e.jsx("button",{onClick:()=>P(d),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit exclusion",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>_(d),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete exclusion",children:e.jsx(ne,{className:"h-4 w-4"})})]})]})};var Kt=Object.defineProperty,ns=Object.getOwnPropertySymbols,st=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable,Ps=(d,P,_)=>P in d?Kt(d,P,{enumerable:!0,configurable:!0,writable:!0,value:_}):d[P]=_,gs=(d,P)=>{for(var _ in P||(P={}))st.call(P,_)&&Ps(d,_,P[_]);if(ns)for(var _ of ns(P))tt.call(P,_)&&Ps(d,_,P[_]);return d},fs=(d,P)=>{var _={};for(var f in d)st.call(d,f)&&P.indexOf(f)<0&&(_[f]=d[f]);if(d!=null&&ns)for(var f of ns(d))P.indexOf(f)<0&&tt.call(d,f)&&(_[f]=d[f]);return _};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Le;(d=>{const P=class Z{constructor(t,a,s,n){if(this.version=t,this.errorCorrectionLevel=a,this.modules=[],this.isFunction=[],t<Z.MIN_VERSION||t>Z.MAX_VERSION)throw new RangeError("Version value out of range");if(n<-1||n>7)throw new RangeError("Mask value out of range");this.size=t*4+17;let m=[];for(let i=0;i<this.size;i++)m.push(!1);for(let i=0;i<this.size;i++)this.modules.push(m.slice()),this.isFunction.push(m.slice());this.drawFunctionPatterns();const p=this.addEccAndInterleave(s);if(this.drawCodewords(p),n==-1){let i=1e9;for(let D=0;D<8;D++){this.applyMask(D),this.drawFormatBits(D);const A=this.getPenaltyScore();A<i&&(n=D,i=A),this.applyMask(D)}}v(0<=n&&n<=7),this.mask=n,this.applyMask(n),this.drawFormatBits(n),this.isFunction=[]}static encodeText(t,a){const s=d.QrSegment.makeSegments(t);return Z.encodeSegments(s,a)}static encodeBinary(t,a){const s=d.QrSegment.makeBytes(t);return Z.encodeSegments([s],a)}static encodeSegments(t,a,s=1,n=40,m=-1,p=!0){if(!(Z.MIN_VERSION<=s&&s<=n&&n<=Z.MAX_VERSION)||m<-1||m>7)throw new RangeError("Invalid value");let i,D;for(i=s;;i++){const C=Z.getNumDataCodewords(i,a)*8,S=g.getTotalBits(t,i);if(S<=C){D=S;break}if(i>=n)throw new RangeError("Data too long")}for(const C of[Z.Ecc.MEDIUM,Z.Ecc.QUARTILE,Z.Ecc.HIGH])p&&D<=Z.getNumDataCodewords(i,C)*8&&(a=C);let A=[];for(const C of t){_(C.mode.modeBits,4,A),_(C.numChars,C.mode.numCharCountBits(i),A);for(const S of C.getData())A.push(S)}v(A.length==D);const V=Z.getNumDataCodewords(i,a)*8;v(A.length<=V),_(0,Math.min(4,V-A.length),A),_(0,(8-A.length%8)%8,A),v(A.length%8==0);for(let C=236;A.length<V;C^=253)_(C,8,A);let j=[];for(;j.length*8<A.length;)j.push(0);return A.forEach((C,S)=>j[S>>>3]|=C<<7-(S&7)),new Z(i,a,j,m)}getModule(t,a){return 0<=t&&t<this.size&&0<=a&&a<this.size&&this.modules[a][t]}getModules(){return this.modules}drawFunctionPatterns(){for(let s=0;s<this.size;s++)this.setFunctionModule(6,s,s%2==0),this.setFunctionModule(s,6,s%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const t=this.getAlignmentPatternPositions(),a=t.length;for(let s=0;s<a;s++)for(let n=0;n<a;n++)s==0&&n==0||s==0&&n==a-1||s==a-1&&n==0||this.drawAlignmentPattern(t[s],t[n]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){const a=this.errorCorrectionLevel.formatBits<<3|t;let s=a;for(let m=0;m<10;m++)s=s<<1^(s>>>9)*1335;const n=(a<<10|s)^21522;v(n>>>15==0);for(let m=0;m<=5;m++)this.setFunctionModule(8,m,f(n,m));this.setFunctionModule(8,7,f(n,6)),this.setFunctionModule(8,8,f(n,7)),this.setFunctionModule(7,8,f(n,8));for(let m=9;m<15;m++)this.setFunctionModule(14-m,8,f(n,m));for(let m=0;m<8;m++)this.setFunctionModule(this.size-1-m,8,f(n,m));for(let m=8;m<15;m++)this.setFunctionModule(8,this.size-15+m,f(n,m));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let s=0;s<12;s++)t=t<<1^(t>>>11)*7973;const a=this.version<<12|t;v(a>>>18==0);for(let s=0;s<18;s++){const n=f(a,s),m=this.size-11+s%3,p=Math.floor(s/3);this.setFunctionModule(m,p,n),this.setFunctionModule(p,m,n)}}drawFinderPattern(t,a){for(let s=-4;s<=4;s++)for(let n=-4;n<=4;n++){const m=Math.max(Math.abs(n),Math.abs(s)),p=t+n,i=a+s;0<=p&&p<this.size&&0<=i&&i<this.size&&this.setFunctionModule(p,i,m!=2&&m!=4)}}drawAlignmentPattern(t,a){for(let s=-2;s<=2;s++)for(let n=-2;n<=2;n++)this.setFunctionModule(t+n,a+s,Math.max(Math.abs(n),Math.abs(s))!=1)}setFunctionModule(t,a,s){this.modules[a][t]=s,this.isFunction[a][t]=!0}addEccAndInterleave(t){const a=this.version,s=this.errorCorrectionLevel;if(t.length!=Z.getNumDataCodewords(a,s))throw new RangeError("Invalid argument");const n=Z.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][a],m=Z.ECC_CODEWORDS_PER_BLOCK[s.ordinal][a],p=Math.floor(Z.getNumRawDataModules(a)/8),i=n-p%n,D=Math.floor(p/n);let A=[];const V=Z.reedSolomonComputeDivisor(m);for(let C=0,S=0;C<n;C++){let u=t.slice(S,S+D-m+(C<i?0:1));S+=u.length;const T=Z.reedSolomonComputeRemainder(u,V);C<i&&u.push(0),A.push(u.concat(T))}let j=[];for(let C=0;C<A[0].length;C++)A.forEach((S,u)=>{(C!=D-m||u>=i)&&j.push(S[C])});return v(j.length==p),j}drawCodewords(t){if(t.length!=Math.floor(Z.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let a=0;for(let s=this.size-1;s>=1;s-=2){s==6&&(s=5);for(let n=0;n<this.size;n++)for(let m=0;m<2;m++){const p=s-m,D=(s+1&2)==0?this.size-1-n:n;!this.isFunction[D][p]&&a<t.length*8&&(this.modules[D][p]=f(t[a>>>3],7-(a&7)),a++)}}v(a==t.length*8)}applyMask(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(let a=0;a<this.size;a++)for(let s=0;s<this.size;s++){let n;switch(t){case 0:n=(s+a)%2==0;break;case 1:n=a%2==0;break;case 2:n=s%3==0;break;case 3:n=(s+a)%3==0;break;case 4:n=(Math.floor(s/3)+Math.floor(a/2))%2==0;break;case 5:n=s*a%2+s*a%3==0;break;case 6:n=(s*a%2+s*a%3)%2==0;break;case 7:n=((s+a)%2+s*a%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[a][s]&&n&&(this.modules[a][s]=!this.modules[a][s])}}getPenaltyScore(){let t=0;for(let m=0;m<this.size;m++){let p=!1,i=0,D=[0,0,0,0,0,0,0];for(let A=0;A<this.size;A++)this.modules[m][A]==p?(i++,i==5?t+=Z.PENALTY_N1:i>5&&t++):(this.finderPenaltyAddHistory(i,D),p||(t+=this.finderPenaltyCountPatterns(D)*Z.PENALTY_N3),p=this.modules[m][A],i=1);t+=this.finderPenaltyTerminateAndCount(p,i,D)*Z.PENALTY_N3}for(let m=0;m<this.size;m++){let p=!1,i=0,D=[0,0,0,0,0,0,0];for(let A=0;A<this.size;A++)this.modules[A][m]==p?(i++,i==5?t+=Z.PENALTY_N1:i>5&&t++):(this.finderPenaltyAddHistory(i,D),p||(t+=this.finderPenaltyCountPatterns(D)*Z.PENALTY_N3),p=this.modules[A][m],i=1);t+=this.finderPenaltyTerminateAndCount(p,i,D)*Z.PENALTY_N3}for(let m=0;m<this.size-1;m++)for(let p=0;p<this.size-1;p++){const i=this.modules[m][p];i==this.modules[m][p+1]&&i==this.modules[m+1][p]&&i==this.modules[m+1][p+1]&&(t+=Z.PENALTY_N2)}let a=0;for(const m of this.modules)a=m.reduce((p,i)=>p+(i?1:0),a);const s=this.size*this.size,n=Math.ceil(Math.abs(a*20-s*10)/s)-1;return v(0<=n&&n<=9),t+=n*Z.PENALTY_N4,v(0<=t&&t<=2568888),t}getAlignmentPatternPositions(){if(this.version==1)return[];{const t=Math.floor(this.version/7)+2,a=this.version==32?26:Math.ceil((this.version*4+4)/(t*2-2))*2;let s=[6];for(let n=this.size-7;s.length<t;n-=a)s.splice(1,0,n);return s}}static getNumRawDataModules(t){if(t<Z.MIN_VERSION||t>Z.MAX_VERSION)throw new RangeError("Version number out of range");let a=(16*t+128)*t+64;if(t>=2){const s=Math.floor(t/7)+2;a-=(25*s-10)*s-55,t>=7&&(a-=36)}return v(208<=a&&a<=29648),a}static getNumDataCodewords(t,a){return Math.floor(Z.getNumRawDataModules(t)/8)-Z.ECC_CODEWORDS_PER_BLOCK[a.ordinal][t]*Z.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw new RangeError("Degree out of range");let a=[];for(let n=0;n<t-1;n++)a.push(0);a.push(1);let s=1;for(let n=0;n<t;n++){for(let m=0;m<a.length;m++)a[m]=Z.reedSolomonMultiply(a[m],s),m+1<a.length&&(a[m]^=a[m+1]);s=Z.reedSolomonMultiply(s,2)}return a}static reedSolomonComputeRemainder(t,a){let s=a.map(n=>0);for(const n of t){const m=n^s.shift();s.push(0),a.forEach((p,i)=>s[i]^=Z.reedSolomonMultiply(p,m))}return s}static reedSolomonMultiply(t,a){if(t>>>8||a>>>8)throw new RangeError("Byte out of range");let s=0;for(let n=7;n>=0;n--)s=s<<1^(s>>>7)*285,s^=(a>>>n&1)*t;return v(s>>>8==0),s}finderPenaltyCountPatterns(t){const a=t[1];v(a<=this.size*3);const s=a>0&&t[2]==a&&t[3]==a*3&&t[4]==a&&t[5]==a;return(s&&t[0]>=a*4&&t[6]>=a?1:0)+(s&&t[6]>=a*4&&t[0]>=a?1:0)}finderPenaltyTerminateAndCount(t,a,s){return t&&(this.finderPenaltyAddHistory(a,s),a=0),a+=this.size,this.finderPenaltyAddHistory(a,s),this.finderPenaltyCountPatterns(s)}finderPenaltyAddHistory(t,a){a[0]==0&&(t+=this.size),a.pop(),a.unshift(t)}};P.MIN_VERSION=1,P.MAX_VERSION=40,P.PENALTY_N1=3,P.PENALTY_N2=3,P.PENALTY_N3=40,P.PENALTY_N4=10,P.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],P.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],d.QrCode=P;function _(M,t,a){if(t<0||t>31||M>>>t)throw new RangeError("Value out of range");for(let s=t-1;s>=0;s--)a.push(M>>>s&1)}function f(M,t){return(M>>>t&1)!=0}function v(M){if(!M)throw new Error("Assertion error")}const y=class ae{constructor(t,a,s){if(this.mode=t,this.numChars=a,this.bitData=s,a<0)throw new RangeError("Invalid argument");this.bitData=s.slice()}static makeBytes(t){let a=[];for(const s of t)_(s,8,a);return new ae(ae.Mode.BYTE,t.length,a)}static makeNumeric(t){if(!ae.isNumeric(t))throw new RangeError("String contains non-numeric characters");let a=[];for(let s=0;s<t.length;){const n=Math.min(t.length-s,3);_(parseInt(t.substring(s,s+n),10),n*3+1,a),s+=n}return new ae(ae.Mode.NUMERIC,t.length,a)}static makeAlphanumeric(t){if(!ae.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");let a=[],s;for(s=0;s+2<=t.length;s+=2){let n=ae.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s))*45;n+=ae.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s+1)),_(n,11,a)}return s<t.length&&_(ae.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s)),6,a),new ae(ae.Mode.ALPHANUMERIC,t.length,a)}static makeSegments(t){return t==""?[]:ae.isNumeric(t)?[ae.makeNumeric(t)]:ae.isAlphanumeric(t)?[ae.makeAlphanumeric(t)]:[ae.makeBytes(ae.toUtf8ByteArray(t))]}static makeEci(t){let a=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)_(t,8,a);else if(t<16384)_(2,2,a),_(t,14,a);else if(t<1e6)_(6,3,a),_(t,21,a);else throw new RangeError("ECI assignment value out of range");return new ae(ae.Mode.ECI,0,a)}static isNumeric(t){return ae.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return ae.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(t,a){let s=0;for(const n of t){const m=n.mode.numCharCountBits(a);if(n.numChars>=1<<m)return 1/0;s+=4+m+n.bitData.length}return s}static toUtf8ByteArray(t){t=encodeURI(t);let a=[];for(let s=0;s<t.length;s++)t.charAt(s)!="%"?a.push(t.charCodeAt(s)):(a.push(parseInt(t.substring(s+1,s+3),16)),s+=2);return a}};y.NUMERIC_REGEX=/^[0-9]*$/,y.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,y.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let g=y;d.QrSegment=y})(Le||(Le={}));(d=>{(P=>{const _=class{constructor(v,y){this.ordinal=v,this.formatBits=y}};_.LOW=new _(0,1),_.MEDIUM=new _(1,0),_.QUARTILE=new _(2,3),_.HIGH=new _(3,2),P.Ecc=_})(d.QrCode||(d.QrCode={}))})(Le||(Le={}));(d=>{(P=>{const _=class{constructor(v,y){this.modeBits=v,this.numBitsCharCount=y}numCharCountBits(v){return this.numBitsCharCount[Math.floor((v+7)/17)]}};_.NUMERIC=new _(1,[10,12,14]),_.ALPHANUMERIC=new _(2,[9,11,13]),_.BYTE=new _(4,[8,16,16]),_.KANJI=new _(8,[8,10,12]),_.ECI=new _(7,[0,0,0]),P.Mode=_})(d.QrSegment||(d.QrSegment={}))})(Le||(Le={}));var Ge=Le;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Jt={L:Ge.QrCode.Ecc.LOW,M:Ge.QrCode.Ecc.MEDIUM,Q:Ge.QrCode.Ecc.QUARTILE,H:Ge.QrCode.Ecc.HIGH},at=128,rt="L",lt="#FFFFFF",nt="#000000",it=!1,ct=1,Qt=4,Yt=0,Xt=.1;function ot(d,P=0){const _=[];return d.forEach(function(f,v){let y=null;f.forEach(function(g,M){if(!g&&y!==null){_.push(`M${y+P} ${v+P}h${M-y}v1H${y+P}z`),y=null;return}if(M===f.length-1){if(!g)return;y===null?_.push(`M${M+P},${v+P} h1v1H${M+P}z`):_.push(`M${y+P},${v+P} h${M+1-y}v1H${y+P}z`);return}g&&y===null&&(y=M)})}),_.join("")}function dt(d,P){return d.slice().map((_,f)=>f<P.y||f>=P.y+P.h?_:_.map((v,y)=>y<P.x||y>=P.x+P.w?v:!1))}function Zt(d,P,_,f){if(f==null)return null;const v=d.length+_*2,y=Math.floor(P*Xt),g=v/P,M=(f.width||y)*g,t=(f.height||y)*g,a=f.x==null?d.length/2-M/2:f.x*g,s=f.y==null?d.length/2-t/2:f.y*g,n=f.opacity==null?1:f.opacity;let m=null;if(f.excavate){let i=Math.floor(a),D=Math.floor(s),A=Math.ceil(M+a-i),V=Math.ceil(t+s-D);m={x:i,y:D,w:A,h:V}}const p=f.crossOrigin;return{x:a,y:s,h:t,w:M,excavation:m,opacity:n,crossOrigin:p}}function ea(d,P){return P!=null?Math.max(Math.floor(P),0):d?Qt:Yt}function mt({value:d,level:P,minVersion:_,includeMargin:f,marginSize:v,imageSettings:y,size:g,boostLevel:M}){let t=le.useMemo(()=>{const i=(Array.isArray(d)?d:[d]).reduce((D,A)=>(D.push(...Ge.QrSegment.makeSegments(A)),D),[]);return Ge.QrCode.encodeSegments(i,Jt[P],_,void 0,void 0,M)},[d,P,_,M]);const{cells:a,margin:s,numCells:n,calculatedImageSettings:m}=le.useMemo(()=>{let p=t.getModules();const i=ea(f,v),D=p.length+i*2,A=Zt(p,g,i,y);return{cells:p,margin:i,numCells:D,calculatedImageSettings:A}},[t,g,y,f,v]);return{qrcode:t,margin:s,cells:a,numCells:n,calculatedImageSettings:m}}var sa=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),ta=le.forwardRef(function(P,_){const f=P,{value:v,size:y=at,level:g=rt,bgColor:M=lt,fgColor:t=nt,includeMargin:a=it,minVersion:s=ct,boostLevel:n,marginSize:m,imageSettings:p}=f,D=fs(f,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:A}=D,V=fs(D,["style"]),j=p==null?void 0:p.src,C=le.useRef(null),S=le.useRef(null),u=le.useCallback(R=>{C.current=R,typeof _=="function"?_(R):_&&(_.current=R)},[_]),[T,I]=le.useState(!1),{margin:z,cells:L,numCells:O,calculatedImageSettings:w}=mt({value:v,level:g,minVersion:s,boostLevel:n,includeMargin:a,marginSize:m,imageSettings:p,size:y});le.useEffect(()=>{if(C.current!=null){const R=C.current,b=R.getContext("2d");if(!b)return;let Q=L;const X=S.current,c=w!=null&&X!==null&&X.complete&&X.naturalHeight!==0&&X.naturalWidth!==0;c&&w.excavation!=null&&(Q=dt(L,w.excavation));const G=window.devicePixelRatio||1;R.height=R.width=y*G;const B=y/O*G;b.scale(B,B),b.fillStyle=M,b.fillRect(0,0,O,O),b.fillStyle=t,sa?b.fill(new Path2D(ot(Q,z))):L.forEach(function(o,$){o.forEach(function(W,N){W&&b.fillRect(N+z,$+z,1,1)})}),w&&(b.globalAlpha=w.opacity),c&&b.drawImage(X,w.x+z,w.y+z,w.w,w.h)}}),le.useEffect(()=>{I(!1)},[j]);const k=gs({height:y,width:y},A);let h=null;return j!=null&&(h=le.createElement("img",{src:j,key:j,style:{display:"none"},onLoad:()=>{I(!0)},ref:S,crossOrigin:w==null?void 0:w.crossOrigin})),le.createElement(le.Fragment,null,le.createElement("canvas",gs({style:k,height:y,width:y,ref:u,role:"img"},V)),h)});ta.displayName="QRCodeCanvas";var xt=le.forwardRef(function(P,_){const f=P,{value:v,size:y=at,level:g=rt,bgColor:M=lt,fgColor:t=nt,includeMargin:a=it,minVersion:s=ct,boostLevel:n,title:m,marginSize:p,imageSettings:i}=f,D=fs(f,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:A,cells:V,numCells:j,calculatedImageSettings:C}=mt({value:v,level:g,minVersion:s,boostLevel:n,includeMargin:a,marginSize:p,imageSettings:i,size:y});let S=V,u=null;i!=null&&C!=null&&(C.excavation!=null&&(S=dt(V,C.excavation)),u=le.createElement("image",{href:i.src,height:C.h,width:C.w,x:C.x+A,y:C.y+A,preserveAspectRatio:"none",opacity:C.opacity,crossOrigin:C.crossOrigin}));const T=ot(S,A);return le.createElement("svg",gs({height:y,width:y,viewBox:`0 0 ${j} ${j}`,ref:_,role:"img"},D),!!m&&le.createElement("title",null,m),le.createElement("path",{fill:M,d:`M0,0 h${j}v${j}H0z`,shapeRendering:"crispEdges"}),le.createElement("path",{fill:t,d:T,shapeRendering:"crispEdges"}),u)});xt.displayName="QRCodeSVG";const aa=()=>{const[d,P]=r.useState(!1),[_,f]=r.useState(!0),[v,y]=r.useState("idle"),[g,M]=r.useState(""),[t,a]=r.useState(""),[s,n]=r.useState([]),[m,p]=r.useState(""),[i,D]=r.useState(!1),[A,V]=r.useState(!1),[j,C]=r.useState(""),[S,u]=r.useState(""),[T,I]=r.useState(!1),[z,L]=r.useState(!1),[O,w]=r.useState(""),[k,h]=r.useState(""),[R,b]=r.useState(!1);r.useEffect(()=>{Q()},[]);const Q=async()=>{f(!0);try{const N=await rs.me();P(N.data.mfa_enabled||!1)}catch(N){console.error("Failed to check MFA status:",N)}finally{f(!1)}},X=async()=>{var N,q;try{const x=await ts.setup();M(x.data.secret),a(x.data.qr_code_url),n(x.data.recovery_codes),y("scan-qr")}catch(x){const K=x;l.error(((q=(N=K.response)==null?void 0:N.data)==null?void 0:q.error)||"Failed to initialize MFA setup")}},c=async N=>{var q,x;if(N.preventDefault(),!m||m.length!==6){l.error("Please enter a valid 6-digit code");return}D(!0);try{await ts.verifySetup({totp_code:m}),l.success("MFA enabled successfully!"),y("show-recovery"),P(!0)}catch(K){const Y=K;l.error(((x=(q=Y.response)==null?void 0:q.data)==null?void 0:x.error)||"Invalid verification code")}finally{D(!1)}},G=()=>{y("idle"),M(""),a(""),n([]),p("")},B=async N=>{var q,x;if(N.preventDefault(),!j||!S){l.error("Password and TOTP code are required");return}I(!0);try{await ts.disable({password:j,totp_code:S}),l.success("MFA disabled successfully"),P(!1),V(!1),C(""),u("")}catch(K){const Y=K;l.error(((x=(q=Y.response)==null?void 0:q.data)==null?void 0:x.error)||"Failed to disable MFA")}finally{I(!1)}},o=async N=>{var q,x;if(N.preventDefault(),!O||!k){l.error("Password and TOTP code are required");return}b(!0);try{const K=await ts.regenerateRecoveryCodes({password:O,totp_code:k});n(K.data.recovery_codes),l.success("Recovery codes regenerated successfully"),L(!1),w(""),h(""),y("show-recovery")}catch(K){const Y=K;l.error(((x=(q=Y.response)==null?void 0:q.data)==null?void 0:x.error)||"Failed to regenerate recovery codes")}finally{b(!1)}},$=N=>{navigator.clipboard.writeText(N),l.success("Copied to clipboard")},W=()=>{const N=new Blob([s.join(`
`)],{type:"text/plain"}),q=URL.createObjectURL(N),x=document.createElement("a");x.href=q,x.download="heroforge-recovery-codes.txt",document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(q),l.success("Recovery codes downloaded")};return _?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):v!=="idle"?e.jsx("div",{className:"space-y-6",children:e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Enable Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{className:v==="scan-qr"?"text-primary":"",children:"1. Scan QR"}),e.jsx("span",{children:""}),e.jsx("span",{className:v==="verify-code"?"text-primary":"",children:"2. Verify"}),e.jsx("span",{children:""}),e.jsx("span",{className:v==="show-recovery"?"text-primary":"",children:"3. Save Codes"})]})]}),v==="scan-qr"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 1: Scan QR Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Use an authenticator app like Google Authenticator, Authy, or 1Password to scan this QR code:"}),t&&e.jsx("div",{className:"bg-white p-4 rounded-lg mb-4",children:e.jsx(xt,{value:t,size:256,level:"M",marginSize:2})}),e.jsxs("div",{className:"mt-4 w-full max-w-md",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Or enter this secret manually:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(J,{type:"text",value:g,readOnly:!0,className:"font-mono text-sm flex-1"}),e.jsx(E,{variant:"secondary",onClick:()=>$(g),children:e.jsx(he,{className:"h-4 w-4"})})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(E,{variant:"primary",onClick:()=>y("verify-code"),children:"Next: Verify Code"})})]}),v==="verify-code"&&e.jsxs("form",{onSubmit:c,className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(_s,{className:"h-12 w-12 text-primary mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 2: Verify Your Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Enter the 6-digit code from your authenticator app to confirm setup:"}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsx(J,{type:"text",value:m,onChange:N=>p(N.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center text-2xl tracking-widest font-mono",maxLength:6,autoFocus:!0})})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:()=>y("scan-qr"),children:"Back"}),e.jsx(E,{type:"submit",variant:"primary",loading:i,disabled:i||m.length!==6,children:"Verify & Enable MFA"})]})]}),v==="show-recovery"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(fe,{className:"h-6 w-6 text-yellow-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-yellow-400 mb-2",children:"Save Your Recovery Codes"}),e.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Store these recovery codes in a safe place. Each code can be used once to access your account if you lose your authenticator device."}),e.jsx("div",{className:"grid grid-cols-2 gap-2 bg-dark-bg rounded-lg p-4 font-mono text-sm mb-4",children:s.map((N,q)=>e.jsxs("div",{className:"text-white",children:[q+1,". ",N]},q))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(E,{variant:"secondary",onClick:()=>$(s.join(`
`)),children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Copy Codes"]}),e.jsxs(E,{variant:"secondary",onClick:W,children:[e.jsx(Bs,{className:"h-4 w-4 mr-2"}),"Download Codes"]})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(E,{variant:"primary",onClick:G,children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Finish Setup"]})})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ue,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-start justify-between mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[d?e.jsx(de,{className:"h-6 w-6 text-green-400 flex-shrink-0"}):e.jsx(fe,{className:"h-6 w-6 text-yellow-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white mb-1",children:d?"MFA Enabled":"MFA Disabled"}),e.jsx("p",{className:"text-sm text-slate-400",children:d?"Your account is protected with two-factor authentication.":"Enable MFA to add an extra layer of security to your account."})]})]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${d?"bg-green-400":"bg-yellow-400"}`})]}),d?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Me,{className:"h-5 w-5 text-primary"}),e.jsx("h5",{className:"font-medium text-white",children:"Recovery Codes"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Generate new recovery codes if you've lost the originals or used them."}),e.jsx(E,{variant:"secondary",size:"sm",onClick:()=>L(!0),children:"Regenerate Codes"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(es,{className:"h-5 w-5 text-red-400"}),e.jsx("h5",{className:"font-medium text-white",children:"Disable MFA"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Turn off two-factor authentication for your account."}),e.jsx(E,{variant:"danger",size:"sm",onClick:()=>V(!0),children:"Disable MFA"})]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h5",{className:"text-white font-medium mb-2",children:"Why enable MFA?"}),e.jsxs("ul",{className:"text-sm text-slate-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Adds an extra layer of security beyond your password"}),e.jsx("li",{children:"Prevents unauthorized access even if your password is compromised"}),e.jsx("li",{children:"Uses time-based codes from your smartphone"}),e.jsx("li",{children:"Industry standard for securing sensitive accounts"})]})]}),e.jsxs(E,{variant:"primary",onClick:X,children:[e.jsx(_s,{className:"h-4 w-4 mr-2"}),"Enable Two-Factor Authentication"]})]})]}),A&&e.jsx(H,{children:e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Disable Two-Factor Authentication"}),e.jsxs("button",{type:"button",onClick:()=>{V(!1),C(""),u("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"Disabling MFA will make your account less secure. You'll need to provide your password and a TOTP code to confirm."})}),e.jsx(J,{label:"Password",type:"password",value:j,onChange:N=>C(N.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(J,{label:"TOTP Code",type:"text",value:S,onChange:N=>u(N.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:()=>{V(!1),C(""),u("")},children:"Cancel"}),e.jsx(E,{type:"submit",variant:"danger",loading:T,disabled:T||!j||S.length!==6,children:"Disable MFA"})]})]})}),z&&e.jsx(H,{children:e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Regenerate Recovery Codes"}),e.jsxs("button",{type:"button",onClick:()=>{L(!1),w(""),h("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"This will invalidate all existing recovery codes. Make sure to save the new codes in a safe place."})}),e.jsx(J,{label:"Password",type:"password",value:O,onChange:N=>w(N.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(J,{label:"TOTP Code",type:"text",value:k,onChange:N=>h(N.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:()=>{L(!1),w(""),h("")},children:"Cancel"}),e.jsx(E,{type:"submit",variant:"primary",loading:R,disabled:R||!O||k.length!==6,children:"Generate New Codes"})]})]})})]})},ra=()=>{const[d,P]=r.useState([]),[_,f]=r.useState(!0),[v,y]=r.useState(!1),[g,M]=r.useState(""),[t,a]=r.useState(!1),[s,n]=r.useState(null),[m,p]=r.useState(null),[i,D]=r.useState(!1);r.useEffect(()=>{A()},[]);const A=async()=>{f(!0);try{const u=await ds.getAll();P(u.data)}catch(u){l.error("Failed to load API keys"),console.error(u)}finally{f(!1)}},V=async()=>{var u,T;if(!g.trim()){l.error("Please enter a name for the API key");return}a(!0);try{const I=await ds.create({name:g.trim()});n(I.data),M(""),await A(),l.success("API key created successfully")}catch(I){const z=I;l.error(((T=(u=z.response)==null?void 0:u.data)==null?void 0:T.error)||"Failed to create API key")}finally{a(!1)}},j=async()=>{var u,T;if(m){D(!0);try{await ds.delete(m.id),await A(),l.success(`API key "${m.name}" revoked successfully`),p(null)}catch(I){const z=I;l.error(((T=(u=z.response)==null?void 0:u.data)==null?void 0:T.error)||"Failed to revoke API key")}finally{D(!1)}}},C=u=>{navigator.clipboard.writeText(u),l.success("API key copied to clipboard")},S=()=>{n(null),y(!1)};return _?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Keys"})]}),e.jsxs(E,{variant:"primary",onClick:()=>y(!0),className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Create API Key"]})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"API keys allow programmatic access to HeroForge. Keep your keys secure and never share them publicly."}),d.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Me,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No API keys yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Create your first API key to get started"})]}):e.jsx("div",{className:"space-y-3",children:d.map(u=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary/30 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-medium text-white",children:u.name}),e.jsxs("code",{className:"px-2 py-1 bg-dark-surface rounded text-xs text-slate-400 font-mono",children:[u.prefix,"..."]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(is,{className:"h-3 w-3"}),"Created ",new Date(u.created_at).toLocaleDateString()]}),u.last_used_at&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(je,{className:"h-3 w-3"}),"Last used ",new Date(u.last_used_at).toLocaleDateString()]}),!u.last_used_at&&e.jsx("span",{className:"text-amber-500",children:"Never used"})]})]}),e.jsxs(E,{variant:"danger",size:"sm",onClick:()=>p(u),className:"flex items-center gap-2","aria-label":`Revoke API key ${u.name}`,children:[e.jsx(ne,{className:"h-4 w-4"}),"Revoke"]})]},u.id))})]}),v&&!s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Create API Key"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Key Name"}),e.jsx("input",{type:"text",value:g,onChange:u=>M(u.target.value),placeholder:"e.g., Production Server, CI/CD Pipeline",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",autoFocus:!0}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Give your API key a descriptive name to remember where it's used"})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4",children:[e.jsx(E,{variant:"secondary",onClick:()=>{y(!1),M("")},children:"Cancel"}),e.jsx(E,{variant:"primary",onClick:V,disabled:t||!g.trim(),children:t?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Creating..."})]}):"Create Key"})]})]})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-2xl w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(de,{className:"h-6 w-6 text-green-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Key Created Successfully"})]}),e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-amber-200 font-medium mb-2",children:"Important: Save your API key now!"}),e.jsx("p",{className:"text-xs text-amber-300/70",children:"This is the only time you'll see the full key. If you lose it, you'll need to create a new one."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"API Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("code",{className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-3 text-white font-mono text-sm break-all",children:s.key}),e.jsxs(E,{variant:"secondary",onClick:()=>C(s.key),className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),"Copy"]})]})]}),e.jsxs("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-200 mb-2",children:"Using your API key"}),e.jsx("p",{className:"text-xs text-blue-300/70 mb-3",children:"Include your API key in the X-API-Key header:"}),e.jsxs("code",{className:"block bg-dark-bg border border-dark-border rounded px-3 py-2 text-xs text-slate-300 font-mono",children:['curl -H "X-API-Key: ',s.key,'" https://heroforge.example.com/api/scans']})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(E,{variant:"primary",onClick:S,children:"Done"})})]})]})}),e.jsx(Se,{isOpen:!!m,onClose:()=>p(null),onConfirm:j,title:"Revoke API Key",message:`Are you sure you want to revoke the API key "${m==null?void 0:m.name}"? Any applications using this key will lose access immediately.`,confirmLabel:"Revoke Key",variant:"danger",loading:i})]})},la=()=>{const[d,P]=r.useState(!0),[_,f]=r.useState(!1),[v,y]=r.useState(!1),[g,M]=r.useState(!1),[t,a]=r.useState({jira_url:"",username:"",api_token:"",project_key:"",issue_type:"Task",default_assignee:"",enabled:!0}),[s,n]=r.useState([]),[m,p]=r.useState([]),[i,D]=r.useState(!1);r.useEffect(()=>{A()},[]);const A=async()=>{var u;P(!0);try{const T=await We.getSettings();a(T.data),M(!0)}catch(T){((u=T.response)==null?void 0:u.status)===404?M(!1):console.error("Failed to load JIRA settings:",T)}finally{P(!1)}},V=async()=>{var u,T;if(!t.jira_url||!t.username||!t.api_token||!t.project_key){l.error("Please fill in all required fields");return}f(!0);try{await We.updateSettings(t),l.success("JIRA settings saved successfully"),M(!0)}catch(I){const z=I;console.error("Failed to save JIRA settings:",I),l.error(((T=(u=z.response)==null?void 0:u.data)==null?void 0:T.error)||"Failed to save JIRA settings")}finally{f(!1)}},j=async()=>{var u,T;if(!g){l.error("Please save your settings first");return}y(!0);try{await We.testConnection(),l.success("JIRA connection successful!")}catch(I){const z=I;console.error("JIRA connection failed:",I),l.error(((T=(u=z.response)==null?void 0:u.data)==null?void 0:T.error)||"JIRA connection failed")}finally{y(!1)}},C=async()=>{var u,T;if(!g){l.error("Please save your settings first");return}D(!0);try{const I=await We.listProjects();n(I.data),l.success(`Loaded ${I.data.length} projects`)}catch(I){const z=I;console.error("Failed to load projects:",I),l.error(((T=(u=z.response)==null?void 0:u.data)==null?void 0:T.error)||"Failed to load projects")}finally{D(!1)}},S=async()=>{var u,T;if(!g||!t.project_key){l.error("Please save your settings and select a project first");return}D(!0);try{const I=await We.listIssueTypes();p(I.data),l.success(`Loaded ${I.data.length} issue types`)}catch(I){const z=I;console.error("Failed to load issue types:",I),l.error(((T=(u=z.response)==null?void 0:u.data)==null?void 0:T.error)||"Failed to load issue types")}finally{D(!1)}};return d?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(cs,{className:"h-6 w-6 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"JIRA Integration"})]}),e.jsxs("div",{className:"space-y-4",children:[!g&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(fe,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"JIRA Integration Not Configured"}),e.jsx("p",{children:"Configure your JIRA instance to automatically create tickets from vulnerabilities."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["JIRA URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"url",placeholder:"https://your-domain.atlassian.net",value:t.jira_url,onChange:u=>a({...t,jira_url:u.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your JIRA instance URL (e.g., https://company.atlassian.net)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Username/Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"text",placeholder:"user@example.com",value:t.username,onChange:u=>a({...t,username:u.target.value})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["API Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"password",placeholder:"Your JIRA API token",value:t.api_token,onChange:u=>a({...t,api_token:u.target.value})}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Generate an API token at"," ",e.jsxs("a",{href:"https://id.atlassian.com/manage-profile/security/api-tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 inline-flex items-center gap-1",children:["Atlassian Account Settings ",e.jsx(ss,{className:"h-3 w-3"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Key ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:s.length>0?e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:t.project_key,onChange:u=>a({...t,project_key:u.target.value}),children:[e.jsx("option",{value:"",children:"Select a project"}),s.map(u=>e.jsxs("option",{value:u.key,children:[u.name," (",u.key,")"]},u.key))]}):e.jsx(J,{type:"text",placeholder:"PROJECT",value:t.project_key,onChange:u=>a({...t,project_key:u.target.value})})}),e.jsx(E,{onClick:C,disabled:!g||i,variant:"secondary",children:i?"Loading...":"Load Projects"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Issue Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:m.length>0?e.jsx("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:t.issue_type,onChange:u=>a({...t,issue_type:u.target.value}),children:m.map(u=>e.jsx("option",{value:u.name,children:u.name},u.id))}):e.jsx(J,{type:"text",placeholder:"Task",value:t.issue_type,onChange:u=>a({...t,issue_type:u.target.value})})}),e.jsx(E,{onClick:S,disabled:!g||!t.project_key||i,variant:"secondary",children:i?"Loading...":"Load Types"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Assignee (optional)"}),e.jsx(J,{type:"text",placeholder:"username",value:t.default_assignee||"",onChange:u=>a({...t,default_assignee:u.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Leave empty for unassigned or enter a JIRA username"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"jira-enabled",checked:t.enabled,onChange:u=>a({...t,enabled:u.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"jira-enabled",className:"text-sm font-medium text-gray-700",children:"Enable JIRA integration"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(E,{onClick:V,disabled:_,children:_?"Saving...":"Save Settings"}),e.jsx(E,{onClick:j,disabled:!g||v,variant:"secondary",children:v?"Testing...":"Test Connection"})]}),g&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(de,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("p",{className:"font-medium",children:"JIRA Integration Configured"}),e.jsx("p",{children:"You can now create JIRA tickets from vulnerabilities."})]})]})]})]}),e.jsxs(H,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"How to Use JIRA Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Configure your JIRA instance settings above and test the connection."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Navigate to any vulnerability in your scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"3"})}),e.jsx("p",{children:'Click the "Create JIRA Ticket" button to automatically create an issue with vulnerability details.'})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"The vulnerability will be linked to the JIRA ticket, and you can track it in your JIRA project."})]})]})]})]})},na=()=>{const[d,P]=r.useState(!0),[_,f]=r.useState(!1),[v,y]=r.useState(!1),[g,M]=r.useState(!1),[t,a]=r.useState({instance_url:"",username:"",password:"",default_assignment_group:"",default_category:"",default_impact:3,default_urgency:3,enabled:!0}),[s,n]=r.useState([]),[m,p]=r.useState([]),[i,D]=r.useState(!1),[A,V]=r.useState(!1);r.useEffect(()=>{j()},[]);const j=async()=>{var L;P(!0);try{const w=(await Ke.getSettings()).data;a({instance_url:w.instance_url||"",username:w.username||"",password:"",default_assignment_group:w.default_assignment_group||"",default_category:w.default_category||"",default_impact:w.default_impact||3,default_urgency:w.default_urgency||3,enabled:w.enabled}),M(!0)}catch(O){((L=O.response)==null?void 0:L.status)===404?M(!1):console.error("Failed to load ServiceNow settings:",O)}finally{P(!1)}},C=async()=>{var L,O;if(!t.instance_url||!t.username||!t.password){l.error("Please fill in all required fields");return}if(!t.instance_url.startsWith("https://")){l.error("Instance URL must start with https://");return}f(!0);try{await Ke.updateSettings({instance_url:t.instance_url,username:t.username,password:t.password,default_assignment_group:t.default_assignment_group||void 0,default_category:t.default_category||void 0,default_impact:t.default_impact,default_urgency:t.default_urgency,enabled:t.enabled}),l.success("ServiceNow settings saved successfully"),M(!0)}catch(w){const k=w;console.error("Failed to save ServiceNow settings:",w),l.error(((O=(L=k.response)==null?void 0:L.data)==null?void 0:O.error)||"Failed to save ServiceNow settings")}finally{f(!1)}},S=async()=>{var L,O;if(!g){l.error("Please save your settings first");return}y(!0);try{await Ke.testConnection(),l.success("ServiceNow connection successful!")}catch(w){const k=w;console.error("ServiceNow connection failed:",w),l.error(((O=(L=k.response)==null?void 0:L.data)==null?void 0:O.error)||"ServiceNow connection failed")}finally{y(!1)}},u=async()=>{var L,O;if(!g){l.error("Please save your settings first");return}D(!0);try{const w=await Ke.getAssignmentGroups();n(w.data),l.success(`Loaded ${w.data.length} assignment groups`)}catch(w){const k=w;console.error("Failed to load assignment groups:",w),l.error(((O=(L=k.response)==null?void 0:L.data)==null?void 0:O.error)||"Failed to load assignment groups")}finally{D(!1)}},T=async()=>{var L,O;if(!g){l.error("Please save your settings first");return}V(!0);try{const w=await Ke.getCategories();p(w.data),l.success(`Loaded ${w.data.length} categories`)}catch(w){const k=w;console.error("Failed to load categories:",w),l.error(((O=(L=k.response)==null?void 0:L.data)==null?void 0:O.error)||"Failed to load categories")}finally{V(!1)}},I=[{value:1,label:"1 - High"},{value:2,label:"2 - Medium"},{value:3,label:"3 - Low"}],z=[{value:1,label:"1 - High"},{value:2,label:"2 - Medium"},{value:3,label:"3 - Low"}];return d?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(qs,{className:"h-6 w-6 text-green-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"ServiceNow Integration"})]}),e.jsxs("div",{className:"space-y-4",children:[!g&&e.jsxs("div",{className:"bg-blue-900/30 border border-blue-700 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(fe,{className:"h-5 w-5 text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-300",children:[e.jsx("p",{className:"font-medium mb-1",children:"ServiceNow Integration Not Configured"}),e.jsx("p",{children:"Configure your ServiceNow instance to create incidents and change requests from vulnerabilities."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Instance URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"url",placeholder:"https://yourcompany.service-now.com",value:t.instance_url,onChange:L=>a({...t,instance_url:L.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your ServiceNow instance URL (e.g., https://company.service-now.com)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"text",placeholder:"username",value:t.username,onChange:L=>a({...t,username:L.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"ServiceNow user with API access permissions"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"password",placeholder:g?"********":"Enter password",value:t.password,onChange:L=>a({...t,password:L.target.value})}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Password for the ServiceNow user. Consider using a"," ",e.jsxs("a",{href:"https://docs.servicenow.com/bundle/tokyo-platform-security/page/administer/users/concept/c_OAuthApplications.html",target:"_blank",rel:"noopener noreferrer",className:"text-cyan-400 hover:text-cyan-300 inline-flex items-center gap-1",children:["OAuth token ",e.jsx(ss,{className:"h-3 w-3"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Assignment Group"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:s.length>0?e.jsxs("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:t.default_assignment_group,onChange:L=>a({...t,default_assignment_group:L.target.value}),children:[e.jsx("option",{value:"",children:"Select an assignment group"}),s.map(L=>e.jsx("option",{value:L.sys_id,children:L.name},L.sys_id))]}):e.jsx(J,{type:"text",placeholder:"Group sys_id or name",value:t.default_assignment_group,onChange:L=>a({...t,default_assignment_group:L.target.value})})}),e.jsx(E,{onClick:u,disabled:!g||i,variant:"secondary",children:i?"Loading...":"Load Groups"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Category"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:m.length>0?e.jsxs("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:t.default_category,onChange:L=>a({...t,default_category:L.target.value}),children:[e.jsx("option",{value:"",children:"Select a category"}),m.map(L=>e.jsx("option",{value:L.value,children:L.label},L.value))]}):e.jsx(J,{type:"text",placeholder:"security",value:t.default_category,onChange:L=>a({...t,default_category:L.target.value})})}),e.jsx(E,{onClick:T,disabled:!g||A,variant:"secondary",children:A?"Loading...":"Load Categories"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Impact"}),e.jsx("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:t.default_impact,onChange:L=>a({...t,default_impact:parseInt(L.target.value)}),children:I.map(L=>e.jsx("option",{value:L.value,children:L.label},L.value))}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Auto-calculated from severity when creating tickets"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Urgency"}),e.jsx("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:t.default_urgency,onChange:L=>a({...t,default_urgency:parseInt(L.target.value)}),children:z.map(L=>e.jsx("option",{value:L.value,children:L.label},L.value))}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Auto-calculated from severity when creating tickets"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"servicenow-enabled",checked:t.enabled,onChange:L=>a({...t,enabled:L.target.checked}),className:"h-4 w-4 text-cyan-500 focus:ring-cyan-500 border-gray-600 rounded bg-gray-700"}),e.jsx("label",{htmlFor:"servicenow-enabled",className:"text-sm font-medium text-gray-300",children:"Enable ServiceNow integration"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(E,{onClick:C,disabled:_,children:_?"Saving...":"Save Settings"}),e.jsx(E,{onClick:S,disabled:!g||v,variant:"secondary",children:v?"Testing...":"Test Connection"})]}),g&&e.jsxs("div",{className:"bg-green-900/30 border border-green-700 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(de,{className:"h-5 w-5 text-green-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-green-300",children:[e.jsx("p",{className:"font-medium",children:"ServiceNow Integration Configured"}),e.jsx("p",{children:"You can now create incidents and change requests from vulnerabilities."})]})]})]})]}),e.jsxs(H,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-100 mb-4",children:"How to Use ServiceNow Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Configure your ServiceNow instance settings above and test the connection."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Navigate to any vulnerability in your scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"3"})}),e.jsx("p",{children:"Use the ServiceNow dropdown to create an Incident or Change Request with vulnerability details."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"Tickets are linked to vulnerabilities and can be tracked in HeroForge."})]})]})]}),e.jsxs(H,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-100 mb-4",children:"ServiceNow Table API Reference"}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-2",children:[e.jsx("p",{children:"HeroForge uses the ServiceNow Table API to create tickets:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("code",{className:"text-cyan-400",children:"/api/now/table/incident"})," - Create incidents"]}),e.jsxs("li",{children:[e.jsx("code",{className:"text-cyan-400",children:"/api/now/table/change_request"})," - Create change requests"]}),e.jsxs("li",{children:[e.jsx("code",{className:"text-cyan-400",children:"/api/now/table/sys_user_group"})," - List assignment groups"]})]}),e.jsxs("p",{className:"mt-3",children:["Ensure your ServiceNow user has the following roles: ",e.jsx("code",{className:"text-cyan-400",children:"itil"})," or ",e.jsx("code",{className:"text-cyan-400",children:"rest_api_explorer"}),"."]})]})]})]})},ia=()=>{const[d,P]=r.useState([]),[_,f]=r.useState(!0),[v,y]=r.useState(!1),[g,M]=r.useState(null),[t,a]=r.useState(null),[s,n]=r.useState(null),[m,p]=r.useState(!1),[i,D]=r.useState([]),[A,V]=r.useState(!1),[j,C]=r.useState(""),[S,u]=r.useState(!1);r.useEffect(()=>{T(),L()},[]);const T=async()=>{f(!0);try{const w=await $e.getSettings();P(w.data)}catch(w){l.error("Failed to load SIEM settings"),console.error(w)}finally{f(!1)}},I=async w=>{var k,h;a(w);try{const R=await $e.testConnection(w);R.data.success?l.success("Connection test successful!"):l.error(`Connection test failed: ${R.data.message}`)}catch(R){const b=R;l.error(((h=(k=b.response)==null?void 0:k.data)==null?void 0:h.error)||"Connection test failed")}finally{a(null)}},z=async()=>{var w,k;if(s){p(!0);try{await $e.deleteSettings(s.id),l.success(`${s.siem_type.toUpperCase()} integration deleted`),T(),n(null)}catch(h){const R=h;l.error(((k=(w=R.response)==null?void 0:w.data)==null?void 0:k.error)||"Failed to delete SIEM integration")}finally{p(!1)}}},L=async()=>{V(!0);try{const w=await Mt.getAll();D(w.data.filter(k=>k.status==="completed"))}catch(w){console.error("Failed to load scans:",w)}finally{V(!1)}},O=async()=>{var k,h;if(!j){l.error("Please select a scan to export");return}if(d.filter(R=>R.enabled).length===0){l.error("No enabled SIEM integrations found. Please enable at least one integration.");return}u(!0);try{const R=await $e.exportScan(j);R.data.success?(l.success(`Scan exported to ${R.data.exported_to} SIEM integration(s). ${R.data.events_count} events sent.`),R.data.errors&&R.data.errors.length>0&&R.data.errors.forEach(b=>l.warning(b))):l.error("Export failed. Check SIEM configuration.")}catch(R){const b=R;l.error(((h=(k=b.response)==null?void 0:k.data)==null?void 0:h.error)||"Failed to export scan to SIEM")}finally{u(!1)}};return _?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"SIEM Integrations"})]}),e.jsxs(E,{variant:"primary",onClick:()=>y(!0),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Add Integration"]})]}),d.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ge,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"No SIEM integrations configured"}),e.jsxs(E,{variant:"primary",onClick:()=>y(!0),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Add Your First Integration"]})]}):e.jsx("div",{className:"space-y-4",children:d.map(w=>e.jsx("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-primary/20 text-primary rounded-md text-sm font-medium uppercase",children:w.siem_type}),w.enabled?e.jsxs("span",{className:"flex items-center gap-1 text-green-400 text-sm",children:[e.jsx(de,{className:"h-4 w-4"}),"Enabled"]}):e.jsxs("span",{className:"flex items-center gap-1 text-slate-500 text-sm",children:[e.jsx(Be,{className:"h-4 w-4"}),"Disabled"]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Endpoint:"}),e.jsx("span",{className:"text-white font-mono",children:w.endpoint_url})]}),w.protocol&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Protocol:"}),e.jsx("span",{className:"text-white uppercase",children:w.protocol})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:w.export_on_scan_complete,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export on scan complete"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:w.export_on_critical_vuln,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export critical vulnerabilities"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{variant:"outline",size:"sm",onClick:()=>I(w.id),disabled:t===w.id,children:t===w.id?e.jsx(ee,{}):e.jsx(vs,{className:"h-4 w-4"})}),e.jsx(E,{variant:"outline",size:"sm",onClick:()=>M(w),children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx(E,{variant:"outline",size:"sm",onClick:()=>n(w),"aria-label":`Delete ${w.siem_type} integration`,children:e.jsx(ne,{className:"h-4 w-4 text-red-400"})})]})]})},w.id))})]}),e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Manual Export"})]}),e.jsx(E,{variant:"outline",size:"sm",onClick:L,disabled:A,children:A?e.jsx(ee,{}):e.jsx(Re,{className:"h-4 w-4"})})]}),d.filter(w=>w.enabled).length===0?e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(Be,{className:"h-5 w-5 text-amber-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-200",children:[e.jsx("p",{className:"font-medium mb-1",children:"No Enabled Integrations"}),e.jsx("p",{children:"Enable at least one SIEM integration above before exporting scan results."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Manually export scan results to all enabled SIEM integrations."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:j,onChange:w=>C(w.target.value),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",disabled:A||S,children:[e.jsx("option",{value:"",children:"Select a completed scan..."}),i.map(w=>e.jsxs("option",{value:w.id,children:[w.name," - ",new Date(w.created_at).toLocaleDateString()," ",new Date(w.created_at).toLocaleTimeString()]},w.id))]}),e.jsx(E,{variant:"primary",onClick:O,disabled:!j||S||A,children:S?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Exporting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Export to SIEM"]})})]}),i.length===0&&!A&&e.jsx("p",{className:"text-sm text-slate-500",children:"No completed scans available for export."}),e.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["Export will send data to: ",d.filter(w=>w.enabled).map(w=>w.siem_type.toUpperCase()).join(", ")]})]})]}),e.jsxs(H,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"About SIEM Integration"}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-400",children:[e.jsx("p",{children:"SIEM (Security Information and Event Management) integration allows HeroForge to automatically export scan results and vulnerability findings to your security monitoring platform."}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Syslog:"})," RFC 5424 compliant syslog over TCP/UDP"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Splunk:"})," Splunk HTTP Event Collector (HEC)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Elasticsearch:"})," Direct indexing via Bulk API"]})]})]})]}),(v||g)&&e.jsx(ca,{settings:g,onClose:()=>{y(!1),M(null)},onSave:()=>{y(!1),M(null),T()}}),e.jsx(Se,{isOpen:!!s,onClose:()=>n(null),onConfirm:z,title:"Delete SIEM Integration",message:`Are you sure you want to delete the ${s==null?void 0:s.siem_type.toUpperCase()} integration? Automatic exports to this endpoint will stop.`,confirmLabel:"Delete Integration",variant:"danger",loading:m})]})},ca=({settings:d,onClose:P,onSave:_})=>{const[f,v]=r.useState({siem_type:(d==null?void 0:d.siem_type)||"syslog",endpoint_url:(d==null?void 0:d.endpoint_url)||"",api_key:(d==null?void 0:d.api_key)||"",protocol:(d==null?void 0:d.protocol)||"tcp",enabled:(d==null?void 0:d.enabled)??!0,export_on_scan_complete:(d==null?void 0:d.export_on_scan_complete)??!1,export_on_critical_vuln:(d==null?void 0:d.export_on_critical_vuln)??!0}),[y,g]=r.useState(!1),M=async t=>{var a,s;if(t.preventDefault(),!f.endpoint_url){l.error("Endpoint URL is required");return}if(f.siem_type==="splunk"&&!f.api_key){l.error("API key is required for Splunk HEC");return}g(!0);try{if(d){const n={endpoint_url:f.endpoint_url,enabled:f.enabled,export_on_scan_complete:f.export_on_scan_complete,export_on_critical_vuln:f.export_on_critical_vuln};f.api_key&&(n.api_key=f.api_key),f.siem_type==="syslog"&&(n.protocol=f.protocol),await $e.updateSettings(d.id,n),l.success("SIEM integration updated")}else{const n={siem_type:f.siem_type,endpoint_url:f.endpoint_url,enabled:f.enabled,export_on_scan_complete:f.export_on_scan_complete,export_on_critical_vuln:f.export_on_critical_vuln};f.api_key&&(n.api_key=f.api_key),f.siem_type==="syslog"&&(n.protocol=f.protocol),await $e.createSettings(n),l.success("SIEM integration created")}_()}catch(n){const m=n;l.error(((s=(a=m.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to save SIEM integration")}finally{g(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white",children:[d?"Edit":"Add"," SIEM Integration"]}),e.jsx("button",{onClick:P,className:"text-slate-400 hover:text-white",children:e.jsx(be,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:M,className:"p-6 space-y-6",children:[!d&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"SIEM Type"}),e.jsxs("select",{value:f.siem_type,onChange:t=>v({...f,siem_type:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"syslog",children:"Syslog (RFC 5424)"}),e.jsx("option",{value:"splunk",children:"Splunk HEC"}),e.jsx("option",{value:"elasticsearch",children:"Elasticsearch"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Endpoint URL"}),e.jsx("input",{type:"text",value:f.endpoint_url,onChange:t=>v({...f,endpoint_url:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:f.siem_type==="syslog"?"192.168.1.100:514":f.siem_type==="splunk"?"https://splunk.example.com:8088":"https://elasticsearch.example.com:9200"})]}),f.siem_type==="syslog"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Protocol"}),e.jsxs("select",{value:f.protocol,onChange:t=>v({...f,protocol:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"})]})]}),(f.siem_type==="splunk"||f.siem_type==="elasticsearch")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:[f.siem_type==="splunk"?"HEC Token":"API Key"," ",f.siem_type==="splunk"&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"password",value:f.api_key,onChange:t=>v({...f,api_key:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:d?"(leave blank to keep current)":""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:f.enabled,onChange:t=>v({...f,enabled:t.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Enable this integration"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:f.export_on_scan_complete,onChange:t=>v({...f,export_on_scan_complete:t.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export when scans complete"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:f.export_on_critical_vuln,onChange:t=>v({...f,export_on_critical_vuln:t.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export critical vulnerabilities immediately"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(E,{type:"button",variant:"outline",onClick:P,children:"Cancel"}),e.jsx(E,{type:"submit",variant:"primary",disabled:y,children:y?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs("span",{children:[d?"Update":"Create"," Integration"]})})]})]})]})})},oa=()=>{const[d,P]=r.useState(!0),[_,f]=r.useState([]),[v,y]=r.useState(null),[g,M]=r.useState(!1),[t,a]=r.useState(!1),[s,n]=r.useState(null),[m,p]=r.useState(!1),[i,D]=r.useState(!1),[A,V]=r.useState(null),[j,C]=r.useState(""),S=r.useRef(null),[u,T]=r.useState({name:"",vpnType:"openvpn",username:"",password:""}),[I,z]=r.useState(null);r.useEffect(()=>{L()},[]);const L=async()=>{P(!0);try{const[c,G]=await Promise.all([Ne.getConfigs(),Ne.getStatus()]);f(c.data),y(G.data)}catch(c){console.error("Failed to load VPN data:",c),l.error("Failed to load VPN settings")}finally{P(!1)}},O=c=>{var $,W;const G=($=c.target.files)==null?void 0:$[0];if(!G)return;const B=(W=G.name.split(".").pop())==null?void 0:W.toLowerCase();let o="openvpn";B==="conf"&&(o="wireguard"),z(G),T({...u,name:G.name.replace(/\.(ovpn|conf)$/i,""),vpnType:o}),M(!0)},w=async()=>{if(!I){l.error("Please select a VPN config file");return}if(!u.name.trim()){l.error("Please enter a name for the VPN config");return}a(!0);try{const c=new FileReader;c.onload=async()=>{var B,o;const G=c.result.split(",")[1];try{await Ne.uploadConfig({name:u.name.trim(),vpn_type:u.vpnType,config_data:G,filename:I.name,username:u.username||void 0,password:u.password||void 0,set_as_default:!1}),l.success("VPN config uploaded successfully"),M(!1),z(null),T({name:"",vpnType:"openvpn",username:"",password:""}),S.current&&(S.current.value=""),await L()}catch($){const W=$;console.error("Failed to upload VPN config:",$),l.error(((o=(B=W.response)==null?void 0:B.data)==null?void 0:o.error)||"Failed to upload VPN config")}},c.readAsDataURL(I)}finally{a(!1)}},k=async c=>{var G,B;if(window.confirm("Are you sure you want to delete this VPN config?"))try{await Ne.deleteConfig(c),l.success("VPN config deleted"),await L()}catch(o){const $=o;console.error("Failed to delete VPN config:",o),l.error(((B=(G=$.response)==null?void 0:G.data)==null?void 0:B.error)||"Failed to delete VPN config")}},h=async c=>{var G,B;n(c);try{const o=await Ne.testConfig(c);o.data.success?l.success(`Connection successful! IP: ${o.data.assigned_ip||"N/A"}`):l.error(o.data.message||"Connection test failed")}catch(o){const $=o;console.error("Failed to test VPN config:",o),l.error(((B=(G=$.response)==null?void 0:G.data)==null?void 0:B.error)||"Connection test failed")}finally{n(null)}},R=async c=>{var G,B;p(!0);try{await Ne.connect({config_id:c,connection_mode:"persistent"}),l.success("VPN connected"),await L()}catch(o){const $=o;console.error("Failed to connect VPN:",o),l.error(((B=(G=$.response)==null?void 0:G.data)==null?void 0:B.error)||"Failed to connect")}finally{p(!1)}},b=async()=>{var c,G;D(!0);try{await Ne.disconnect(),l.success("VPN disconnected"),await L()}catch(B){const o=B;console.error("Failed to disconnect VPN:",B),l.error(((G=(c=o.response)==null?void 0:c.data)==null?void 0:G.error)||"Failed to disconnect")}finally{D(!1)}},Q=async c=>{var G,B;try{await Ne.updateConfig(c,{is_default:!0}),l.success("Default VPN config updated"),await L()}catch(o){const $=o;console.error("Failed to set default:",o),l.error(((B=(G=$.response)==null?void 0:G.data)==null?void 0:B.error)||"Failed to set default")}},X=async c=>{var G,B;if(!j.trim()){l.error("Name cannot be empty");return}try{await Ne.updateConfig(c,{name:j.trim()}),l.success("VPN config updated"),V(null),await L()}catch(o){const $=o;console.error("Failed to update config:",o),l.error(((B=(G=$.response)==null?void 0:G.data)==null?void 0:B.error)||"Failed to update")}};return d?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[v!=null&&v.connected?e.jsx(Ws,{className:"h-6 w-6 text-green-500"}):e.jsx(ks,{className:"h-6 w-6 text-slate-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"VPN Status"}),e.jsx("p",{className:"text-sm text-slate-400",children:v!=null&&v.connected?`Connected to ${v.config_name}`:"Not connected"})]})]}),(v==null?void 0:v.connected)&&e.jsxs(E,{onClick:b,disabled:i,variant:"danger",className:"flex items-center gap-2",children:[e.jsx(Et,{className:"h-4 w-4"}),i?"Disconnecting...":"Disconnect"]})]}),(v==null?void 0:v.connected)&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-dark-hover rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Mode"}),e.jsx("p",{className:"text-sm text-white",children:v.connection_mode==="persistent"?"Persistent":"Per-Scan"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Assigned IP"}),e.jsx("p",{className:"text-sm text-white font-mono",children:v.assigned_ip||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Interface"}),e.jsx("p",{className:"text-sm text-white font-mono",children:v.interface_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Connected Since"}),e.jsx("p",{className:"text-sm text-white",children:v.connected_since?new Date(v.connected_since).toLocaleString():"N/A"})]})]})]}),e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"VPN Configurations"})]}),e.jsxs("div",{children:[e.jsx("input",{ref:S,type:"file",accept:".ovpn,.conf",onChange:O,className:"hidden"}),e.jsxs(E,{onClick:()=>{var c;return(c=S.current)==null?void 0:c.click()},className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-4 w-4"}),"Upload Config"]})]})]}),g&&e.jsxs("div",{className:"mb-6 p-4 bg-dark-hover rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"Upload VPN Configuration"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{children:"File:"}),e.jsx("span",{className:"text-white font-mono",children:I==null?void 0:I.name}),e.jsx("span",{className:"px-2 py-0.5 bg-primary/20 text-primary rounded text-xs uppercase",children:u.vpnType})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Config Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"text",placeholder:"My VPN Connection",value:u.name,onChange:c=>T({...u,name:c.target.value})})]}),u.vpnType==="openvpn"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Username (optional)"}),e.jsx(J,{type:"text",placeholder:"VPN username",value:u.username,onChange:c=>T({...u,username:c.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Required if your VPN requires authentication"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Password (optional)"}),e.jsx(J,{type:"password",placeholder:"VPN password",value:u.password,onChange:c=>T({...u,password:c.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(E,{onClick:w,disabled:t,children:t?"Uploading...":"Upload"}),e.jsx(E,{onClick:()=>{M(!1),z(null),S.current&&(S.current.value="")},variant:"secondary",children:"Cancel"})]})]})]}),_.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(ks,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No VPN configurations yet"}),e.jsx("p",{className:"text-sm",children:"Upload an OpenVPN (.ovpn) or WireGuard (.conf) file to get started"})]}):e.jsx("div",{className:"space-y-3",children:_.map(c=>e.jsxs("div",{className:"p-4 bg-dark-hover rounded-lg border border-dark-border flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${c.vpn_type==="openvpn"?"bg-orange-500/20 text-orange-400":"bg-blue-500/20 text-blue-400"}`,children:e.jsx(ue,{className:"h-5 w-5"})}),e.jsxs("div",{children:[A===c.id?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{type:"text",value:j,onChange:G=>C(G.target.value),className:"w-48",autoFocus:!0,onKeyDown:G=>{G.key==="Enter"&&X(c.id),G.key==="Escape"&&V(null)}}),e.jsx(E,{size:"sm",onClick:()=>X(c.id),children:"Save"}),e.jsx(E,{size:"sm",variant:"secondary",onClick:()=>V(null),children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium",children:c.name}),c.is_default&&e.jsx(ls,{className:"h-4 w-4 text-yellow-400 fill-yellow-400"}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-700 text-slate-300 rounded text-xs uppercase",children:c.vpn_type}),(v==null?void 0:v.connected)&&v.config_id===c.id&&e.jsx("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 rounded text-xs",children:"Connected"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500 mt-1",children:[c.requires_credentials&&e.jsx("span",{className:c.has_credentials?"text-green-400":"text-yellow-400",children:c.has_credentials?"Credentials saved":"Credentials required"}),c.last_used_at&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(je,{className:"h-3 w-3"}),"Last used: ",new Date(c.last_used_at).toLocaleDateString()]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:A!==c.id&&e.jsxs(e.Fragment,{children:[!c.is_default&&e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>Q(c.id),title:"Set as default",children:e.jsx(ls,{className:"h-4 w-4"})}),e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>{V(c.id),C(c.name)},title:"Edit",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>h(c.id),disabled:s===c.id,title:"Test connection",children:s===c.id?e.jsx(ee,{size:"sm"}):e.jsx(de,{className:"h-4 w-4"})}),!(v!=null&&v.connected)||v.config_id!==c.id?e.jsx(E,{size:"sm",variant:"secondary",onClick:()=>R(c.id),disabled:m||(v==null?void 0:v.connected),title:"Connect",children:e.jsx(js,{className:"h-4 w-4"})}):null,e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>k(c.id),className:"text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(ne,{className:"h-4 w-4"})})]})})]},c.id))})]}),e.jsxs(H,{children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"How to Use VPN Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-slate-400",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Upload your OpenVPN (.ovpn) or WireGuard (.conf) configuration file."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"If your VPN requires credentials, enter them during upload. They are stored encrypted."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"3"})}),e.jsx("p",{children:"Test your connection to verify it works before using it for scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"When creating a scan, select a VPN config to route the scan through that VPN. The VPN connects before the scan starts and disconnects when it completes."})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(fe,{className:"h-5 w-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-200",children:[e.jsx("p",{className:"font-medium",children:"Security Note"}),e.jsx("p",{className:"text-yellow-300/80 mt-1",children:"VPN credentials are encrypted using AES-256-GCM. Config files containing dangerous options (scripts, hooks) are rejected. Only use VPN configurations from trusted sources."})]})]})})]})]})},da=()=>{const[d,P]=r.useState(!0),[_,f]=r.useState([]),[v,y]=r.useState([]),[g,M]=r.useState(null),[t,a]=r.useState(!1),[s,n]=r.useState(!1),[m,p]=r.useState(!1),[i,D]=r.useState(!1),[A,V]=r.useState(null),[j,C]=r.useState(!1),[S,u]=r.useState(null),[T,I]=r.useState(""),[z,L]=r.useState("agents"),[O,w]=r.useState({name:"",description:"",network_zones:[],max_concurrent_tasks:1}),[k,h]=r.useState({name:"",description:"",network_ranges:"",color:"#06b6d4"});r.useEffect(()=>{R()},[]);const R=async()=>{P(!0);try{const[N,q,x]=await Promise.all([we.list(),we.groups.list(),we.getStats()]);f(N.data),y(q.data),M(x.data)}catch(N){console.error("Failed to load agent data:",N),l.error("Failed to load agent data")}finally{P(!1)}},b=async()=>{var N,q,x;if(!O.name.trim()){l.error("Agent name is required");return}p(!0);try{const K=await we.register({...O,network_zones:(N=O.network_zones)==null?void 0:N.filter(Y=>Y.trim())});V(K.data.token),l.success("Agent registered successfully"),a(!1),w({name:"",description:"",network_zones:[],max_concurrent_tasks:1}),await R()}catch(K){const Y=K;l.error(((x=(q=Y.response)==null?void 0:q.data)==null?void 0:x.error)||"Failed to register agent")}finally{p(!1)}},Q=async()=>{var N,q;if(!k.name.trim()){l.error("Group name is required");return}D(!0);try{await we.groups.create({name:k.name.trim(),description:k.description.trim()||void 0,network_ranges:k.network_ranges.split(",").map(x=>x.trim()).filter(Boolean),color:k.color}),l.success("Group created successfully"),n(!1),h({name:"",description:"",network_ranges:"",color:"#06b6d4"}),await R()}catch(x){const K=x;l.error(((q=(N=K.response)==null?void 0:N.data)==null?void 0:q.error)||"Failed to create group")}finally{D(!1)}},X=async N=>{var q,x;if(window.confirm("Are you sure you want to delete this agent?"))try{await we.delete(N),l.success("Agent deleted"),await R()}catch(K){const Y=K;l.error(((x=(q=Y.response)==null?void 0:q.data)==null?void 0:x.error)||"Failed to delete agent")}},c=async N=>{var q,x;if(window.confirm("Are you sure you want to delete this group?"))try{await we.groups.delete(N),l.success("Group deleted"),await R()}catch(K){const Y=K;l.error(((x=(q=Y.response)==null?void 0:q.data)==null?void 0:x.error)||"Failed to delete group")}},G=async N=>{var q,x;if(window.confirm("Are you sure? The current token will be invalidated."))try{const K=await we.regenerateToken(N);V(K.data.token),l.success("Token regenerated")}catch(K){const Y=K;l.error(((x=(q=Y.response)==null?void 0:q.data)==null?void 0:x.error)||"Failed to regenerate token")}},B=async N=>{var q,x;if(!T.trim()){l.error("Name cannot be empty");return}try{await we.update(N,{name:T.trim()}),l.success("Agent updated"),u(null),await R()}catch(K){const Y=K;l.error(((x=(q=Y.response)==null?void 0:q.data)==null?void 0:x.error)||"Failed to update agent")}},o=N=>{navigator.clipboard.writeText(N),l.success("Copied to clipboard")},$=N=>{switch(N){case"online":return e.jsx(de,{className:"h-4 w-4 text-green-400"});case"busy":return e.jsx(Cs,{className:"h-4 w-4 text-yellow-400 animate-pulse"});case"offline":return e.jsx(ke,{className:"h-4 w-4 text-red-400"});case"pending":return e.jsx(je,{className:"h-4 w-4 text-slate-400"});case"disabled":return e.jsx(be,{className:"h-4 w-4 text-slate-500"});default:return e.jsx(Be,{className:"h-4 w-4 text-slate-400"})}},W=N=>{switch(N){case"online":return"completed";case"busy":return"running";case"offline":case"disabled":return"failed";default:return"pending"}};return d?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[A&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-lg w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Be,{className:"h-6 w-6 text-yellow-400"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Agent Token"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"This token will only be shown once. Copy it now and configure it in your agent."}),e.jsxs("div",{className:"relative",children:[e.jsx(J,{type:j?"text":"password",value:A,readOnly:!0,className:"font-mono text-sm pr-24"}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex gap-1",children:[e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>C(!j),children:j?e.jsx(bs,{className:"h-4 w-4"}):e.jsx(Ks,{className:"h-4 w-4"})}),e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>o(A),children:e.jsx(he,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:e.jsx("p",{className:"text-sm text-yellow-200",children:"Store this token securely. You will need to regenerate it if lost."})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(E,{onClick:()=>V(null),children:"Done"})})]})}),g&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(ge,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:g.total_agents}),e.jsx("p",{className:"text-sm text-slate-400",children:"Total Agents"})]})]})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(de,{className:"h-5 w-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:g.online_agents}),e.jsx("p",{className:"text-sm text-slate-400",children:"Online"})]})]})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:e.jsx(Cs,{className:"h-5 w-5 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:g.busy_agents}),e.jsx("p",{className:"text-sm text-slate-400",children:"Busy"})]})]})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-500/20 rounded-lg",children:e.jsx(At,{className:"h-5 w-5 text-slate-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:g.total_tasks_completed}),e.jsx("p",{className:"text-sm text-slate-400",children:"Tasks Completed"})]})]})})]}),e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>L("agents"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium ${z==="agents"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(ge,{className:"h-4 w-4"}),"Agents (",_.length,")"]}),e.jsxs("button",{onClick:()=>L("groups"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium ${z==="groups"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(os,{className:"h-4 w-4"}),"Groups (",v.length,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(E,{onClick:()=>R(),variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-4 w-4"}),"Refresh"]}),z==="agents"?e.jsxs(E,{onClick:()=>a(!0),className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Register Agent"]}):e.jsxs(E,{onClick:()=>n(!0),className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Create Group"]})]})]}),t&&e.jsxs("div",{className:"mb-6 p-4 bg-dark-hover rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"Register New Agent"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"text",placeholder:"Production Agent 1",value:O.name,onChange:N=>w({...O,name:N.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Description"}),e.jsx(J,{type:"text",placeholder:"Agent for internal network scanning",value:O.description||"",onChange:N=>w({...O,description:N.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Max Concurrent Tasks"}),e.jsx(J,{type:"number",min:1,max:10,value:O.max_concurrent_tasks,onChange:N=>w({...O,max_concurrent_tasks:parseInt(N.target.value)||1})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Network Zones (comma-separated)"}),e.jsx(J,{type:"text",placeholder:"10.0.0.0/8, 192.168.0.0/16",value:(O.network_zones||[]).join(", "),onChange:N=>w({...O,network_zones:N.target.value.split(",").map(q=>q.trim())})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(E,{onClick:b,disabled:m,children:m?"Registering...":"Register"}),e.jsx(E,{variant:"secondary",onClick:()=>a(!1),children:"Cancel"})]})]})]}),s&&e.jsxs("div",{className:"mb-6 p-4 bg-dark-hover rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"Create Agent Group"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(J,{type:"text",placeholder:"Internal Network",value:k.name,onChange:N=>h({...k,name:N.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Color"}),e.jsx(J,{type:"color",value:k.color,onChange:N=>h({...k,color:N.target.value}),className:"h-10 p-1"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Description"}),e.jsx(J,{type:"text",placeholder:"Agents for internal network segments",value:k.description,onChange:N=>h({...k,description:N.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Network Ranges (comma-separated)"}),e.jsx(J,{type:"text",placeholder:"10.0.0.0/8, 192.168.0.0/16",value:k.network_ranges,onChange:N=>h({...k,network_ranges:N.target.value})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(E,{onClick:Q,disabled:i,children:i?"Creating...":"Create Group"}),e.jsx(E,{variant:"secondary",onClick:()=>n(!1),children:"Cancel"})]})]})]}),z==="agents"&&e.jsx("div",{className:"space-y-3",children:_.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(ge,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No agents registered yet"}),e.jsx("p",{className:"text-sm",children:"Register an agent to start distributed scanning"})]}):_.map(N=>e.jsx("div",{className:"p-4 bg-dark-hover rounded-lg border border-dark-border",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(ge,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[S===N.id?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{type:"text",value:T,onChange:q=>I(q.target.value),className:"w-48",autoFocus:!0,onKeyDown:q=>{q.key==="Enter"&&B(N.id),q.key==="Escape"&&u(null)}}),e.jsx(E,{size:"sm",onClick:()=>B(N.id),children:"Save"}),e.jsx(E,{size:"sm",variant:"secondary",onClick:()=>u(null),children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium",children:N.name}),$(N.status),e.jsx(te,{type:W(N.status),children:N.status})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-slate-400",children:[N.hostname&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(It,{className:"h-3 w-3"}),N.hostname]}),N.ip_address&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ps,{className:"h-3 w-3"}),N.ip_address]}),N.version&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(cs,{className:"h-3 w-3"}),"v",N.version]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-slate-500",children:[e.jsxs("span",{children:["Token: ",N.token_prefix,"..."]}),e.jsxs("span",{children:["Tasks: ",N.current_tasks,"/",N.max_concurrent_tasks]}),N.last_heartbeat_at&&e.jsxs("span",{children:["Last seen: ",new Date(N.last_heartbeat_at).toLocaleString()]})]}),N.groups.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Groups:"}),N.groups.map(q=>e.jsx("span",{className:"px-2 py-0.5 rounded text-xs",style:{backgroundColor:`${q.color}20`,color:q.color},children:q.name},q.id))]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:S!==N.id&&e.jsxs(e.Fragment,{children:[e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>{u(N.id),I(N.name)},title:"Edit",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>G(N.id),title:"Regenerate token",children:e.jsx(Re,{className:"h-4 w-4"})}),e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>X(N.id),className:"text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(ne,{className:"h-4 w-4"})})]})})]})},N.id))}),z==="groups"&&e.jsx("div",{className:"space-y-3",children:v.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(os,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No groups created yet"}),e.jsx("p",{className:"text-sm",children:"Create groups to organize agents by network zone"})]}):v.map(N=>e.jsx("div",{className:"p-4 bg-dark-hover rounded-lg border border-dark-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${N.color}20`},children:e.jsx(os,{className:"h-5 w-5",style:{color:N.color}})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium",children:N.name}),e.jsxs("span",{className:"text-sm text-slate-400",children:["(",N.agent_count," agent",N.agent_count!==1?"s":"",")"]})]}),N.description&&e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:N.description}),N.network_ranges&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(ps,{className:"h-3 w-3 text-slate-500"}),e.jsx("span",{className:"text-xs text-slate-500",children:JSON.parse(N.network_ranges).join(", ")})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>c(N.id),className:"text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(ne,{className:"h-4 w-4"})})})]})},N.id))})]}),e.jsxs(H,{children:[e.jsxs("h4",{className:"text-md font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(Ve,{className:"h-5 w-5 text-primary"}),"How to Deploy Agents"]}),e.jsxs("div",{className:"space-y-4 text-sm text-slate-400",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Register a new agent above to receive a unique token. This token authenticates the agent with the server."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Download and run the HeroForge agent on your target network. Configure it with the server URL and token."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"3"})}),e.jsx("p",{children:"Create groups to organize agents by network zone (e.g., DMZ, Internal, Cloud)."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"When creating scans, select an agent or group to route the scan through the appropriate network segment."})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-dark-hover rounded-lg",children:[e.jsx("p",{className:"text-sm text-slate-300 font-medium mb-2",children:"Agent Configuration Example"}),e.jsx("pre",{className:"text-xs text-slate-400 overflow-x-auto",children:`# heroforge-agent.yaml
server_url: https://heroforge.example.com
token: hfa_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
heartbeat_interval: 30
max_concurrent_tasks: 3`})]})]})]})},Fs={name:"",description:"",report_type:"vulnerability",format:"pdf",schedule:"0 8 * * *",recipients:[],filters:{days_back:30},include_charts:!0},xs=[{value:"vulnerability",label:"Vulnerability Report",description:"All discovered vulnerabilities with severity and remediation"},{value:"scan_summary",label:"Scan Summary",description:"Overview of completed scans and their results"},{value:"compliance",label:"Compliance Report",description:"Compliance framework analysis and control mappings"},{value:"executive",label:"Executive Summary",description:"High-level security posture overview"}],ma=[{value:"pdf",label:"PDF"},{value:"html",label:"HTML"},{value:"csv",label:"CSV"}],xa=[{value:"",label:"All Severities"},{value:"low",label:"Low and above"},{value:"medium",label:"Medium and above"},{value:"high",label:"High and above"},{value:"critical",label:"Critical only"}],ua=[{value:"cis",label:"CIS Benchmarks"},{value:"nist_800_53",label:"NIST 800-53"},{value:"nist_csf",label:"NIST CSF"},{value:"pci_dss",label:"PCI-DSS 4.0"},{value:"hipaa",label:"HIPAA"},{value:"ferpa",label:"FERPA"},{value:"soc2",label:"SOC 2"},{value:"owasp_top10",label:"OWASP Top 10"},{value:"hitrust_csf",label:"HITRUST CSF"},{value:"iso_27001",label:"ISO 27001:2022"},{value:"gdpr",label:"GDPR"},{value:"dod_stig",label:"DoD STIG"},{value:"fedramp",label:"FedRAMP"},{value:"cmmc",label:"CMMC 2.0"},{value:"fisma",label:"FISMA"},{value:"nist_800_171",label:"NIST 800-171"},{value:"nist_800_82",label:"NIST 800-82"},{value:"nist_800_61",label:"NIST 800-61"},{value:"stateramp",label:"StateRAMP"},{value:"itar",label:"ITAR"},{value:"ear",label:"EAR"},{value:"dfars",label:"DFARS 252.204-7012"},{value:"icd_503",label:"ICD 503"},{value:"cnssi_1253",label:"CNSSI 1253"},{value:"rmf",label:"Risk Management Framework"},{value:"disa_cloud_srg",label:"DISA Cloud SRG"},{value:"dod_zero_trust",label:"DoD Zero Trust"},{value:"nist_privacy",label:"NIST Privacy Framework"},{value:"csa_ccm",label:"CSA CCM"},{value:"nerc_cip",label:"NERC CIP"},{value:"iec_62443",label:"IEC 62443"},{value:"tsa_pipeline",label:"TSA Pipeline Security"},{value:"cisa_cpgs",label:"CISA CPGs"},{value:"eo_14028",label:"EO 14028"},{value:"sox",label:"SOX IT Controls"},{value:"glba",label:"GLBA"},{value:"cyber_essentials",label:"Cyber Essentials (UK)"},{value:"ism_australia",label:"Australian ISM"},{value:"irap",label:"IRAP"},{value:"nis2",label:"NIS2 Directive"},{value:"ens_spain",label:"ENS (Spain)"},{value:"bsi_grundschutz",label:"BSI IT-Grundschutz"},{value:"c5",label:"C5"},{value:"secnumcloud",label:"SecNumCloud"},{value:"nato_cyber",label:"NATO Cyber Defence"}],ha=()=>{var X;const[d,P]=r.useState([]),[_,f]=r.useState([]),[v,y]=r.useState(!0),[g,M]=r.useState(!1),[t,a]=r.useState(null),[s,n]=r.useState(Fs),[m,p]=r.useState(""),[i,D]=r.useState(null),[A,V]=r.useState(!1),[j,C]=r.useState(null),[S,u]=r.useState(!1);r.useEffect(()=>{T()},[]);const T=async()=>{y(!0);try{const[c,G]=await Promise.all([Fe.getAll(),Fe.getPresets()]);P(c.data),f(G.data)}catch(c){l.error("Failed to load scheduled reports"),console.error(c)}finally{y(!1)}},I=()=>{n(Fs),a(null),M(!1),p(""),u(!1)},z=c=>{const G=JSON.parse(c.recipients),B=c.filters?JSON.parse(c.filters):{};n({name:c.name,description:c.description||"",report_type:c.report_type,format:c.format,schedule:c.schedule,recipients:G,filters:B,include_charts:c.include_charts});const o=_.some($=>$.cron===c.schedule);u(!o),a(c.id),M(!0)},L=()=>{const c=m.trim().toLowerCase();if(!c)return;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c)){l.error("Please enter a valid email address");return}if(s.recipients.includes(c)){l.warning("Email already added");return}n(B=>({...B,recipients:[...B.recipients,c]})),p("")},O=c=>{n(G=>({...G,recipients:G.recipients.filter(B=>B!==c)}))},w=async c=>{var G,B;if(c.preventDefault(),!s.name.trim()){l.error("Name is required");return}if(s.recipients.length===0){l.error("At least one recipient is required");return}try{t?(await Fe.update(t,{name:s.name,description:s.description||void 0,report_type:s.report_type,format:s.format,schedule:s.schedule,recipients:s.recipients,filters:s.filters,include_charts:s.include_charts}),l.success("Scheduled report updated")):(await Fe.create({name:s.name,description:s.description||void 0,report_type:s.report_type,format:s.format,schedule:s.schedule,recipients:s.recipients,filters:s.filters,include_charts:s.include_charts}),l.success("Scheduled report created")),I(),T()}catch(o){const $=o;l.error(((B=(G=$.response)==null?void 0:G.data)==null?void 0:B.error)||"Failed to save scheduled report")}},k=async c=>{var G,B;try{await Fe.update(c.id,{is_active:!c.is_active}),l.success(`Scheduled report ${c.is_active?"paused":"activated"}`),T()}catch(o){const $=o;l.error(((B=(G=$.response)==null?void 0:G.data)==null?void 0:B.error)||"Failed to update")}},h=async c=>{var G,B;C(c.id);try{await Fe.runNow(c.id),l.success("Report generation started. You will receive it via email shortly.")}catch(o){const $=o;l.error(((B=(G=$.response)==null?void 0:G.data)==null?void 0:B.error)||"Failed to run report")}finally{C(null)}},R=async()=>{var c,G;if(i){V(!0);try{await Fe.delete(i.id),l.success(`Scheduled report "${i.name}" deleted`),T(),D(null)}catch(B){const o=B;l.error(((G=(c=o.response)==null?void 0:c.data)==null?void 0:G.error)||"Failed to delete")}finally{V(!1)}}},b=c=>{const G=_.find(o=>o.cron===c);if(G)return G.label;const B=c.split(" ");if(B.length===5){const[o,$]=B,W=`${$.padStart(2,"0")}:${o.padStart(2,"0")}`;if(B[4]==="*"&&B[3]==="*"&&B[2]==="*")return`Daily at ${W}`;if(B[4]!=="*")return`Weekly on ${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][parseInt(B[4])]} at ${W}`;if(B[2]!=="*")return`Monthly on day ${B[2]} at ${W}`}return c},Q=c=>{var G;return((G=xs.find(B=>B.value===c))==null?void 0:G.label)||c};return v?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scheduled Reports"})]}),!g&&e.jsxs(E,{variant:"primary",onClick:()=>M(!0),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"New Scheduled Report"]})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Automatically generate and email reports on a schedule"})]}),g&&e.jsx(H,{children:e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:t?"Edit Scheduled Report":"Create Scheduled Report"}),e.jsx("button",{type:"button",onClick:I,className:"text-slate-400 hover:text-white",children:e.jsx(be,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:c=>n({...s,name:c.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Weekly Vulnerability Report"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:s.description,onChange:c=>n({...s,description:c.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Report Type"}),e.jsx("select",{value:s.report_type,onChange:c=>n({...s,report_type:c.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",children:xs.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:(X=xs.find(c=>c.value===s.report_type))==null?void 0:X.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Format"}),e.jsx("div",{className:"flex gap-2",children:ma.map(c=>e.jsx("button",{type:"button",onClick:()=>n({...s,format:c.value}),className:`flex-1 px-4 py-2 rounded-lg border transition-colors ${s.format===c.value?"bg-primary/20 border-primary text-primary":"bg-dark-bg border-dark-border text-slate-400 hover:border-slate-500"}`,children:c.label},c.value))})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(is,{className:"h-4 w-4"})," Schedule"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[_.map(c=>e.jsx("button",{type:"button",onClick:()=>{n({...s,schedule:c.cron}),u(!1)},className:`px-3 py-1.5 rounded-lg border text-sm transition-colors ${s.schedule===c.cron&&!S?"bg-primary/20 border-primary text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-slate-500"}`,title:c.description,children:c.label},c.id)),e.jsx("button",{type:"button",onClick:()=>u(!0),className:`px-3 py-1.5 rounded-lg border text-sm transition-colors ${S?"bg-primary/20 border-primary text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-slate-500"}`,children:"Custom"})]}),S&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Cron Expression"}),e.jsx("input",{type:"text",value:s.schedule,onChange:c=>n({...s,schedule:c.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white font-mono text-sm",placeholder:"0 8 * * *"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:'Format: minute hour day-of-month month day-of-week (e.g., "0 8 * * *" for daily at 8am)'})]})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(Te,{className:"h-4 w-4"})," Recipients"]}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"email",value:m,onChange:c=>p(c.target.value),onKeyDown:c=>{c.key==="Enter"&&(c.preventDefault(),L())},className:"flex-1 bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",placeholder:"email@example.com"}),e.jsx(E,{type:"button",variant:"secondary",onClick:L,children:e.jsx(ce,{className:"h-4 w-4"})})]}),s.recipients.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:s.recipients.map(c=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-dark-surface rounded-lg text-sm text-slate-300",children:[e.jsx(Te,{className:"h-3 w-3"}),c,e.jsx("button",{type:"button",onClick:()=>O(c),className:"ml-1 text-slate-500 hover:text-red-400",children:e.jsx(be,{className:"h-3 w-3"})})]},c))}):e.jsx("p",{className:"text-sm text-slate-500",children:"No recipients added"})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-3",children:"Filters"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Time Period"}),e.jsxs("select",{value:s.filters.days_back||30,onChange:c=>n({...s,filters:{...s.filters,days_back:parseInt(c.target.value)}}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:7,children:"Last 7 days"}),e.jsx("option",{value:14,children:"Last 14 days"}),e.jsx("option",{value:30,children:"Last 30 days"}),e.jsx("option",{value:60,children:"Last 60 days"}),e.jsx("option",{value:90,children:"Last 90 days"})]})]}),s.report_type==="vulnerability"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Minimum Severity"}),e.jsx("select",{value:s.filters.min_severity||"",onChange:c=>n({...s,filters:{...s.filters,min_severity:c.target.value||void 0}}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:xa.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))})]}),s.report_type==="compliance"&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Frameworks"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ua.map(c=>{var G;return e.jsx("button",{type:"button",onClick:()=>{const B=s.filters.frameworks||[],o=B.includes(c.value)?B.filter($=>$!==c.value):[...B,c.value];n({...s,filters:{...s.filters,frameworks:o}})},className:`px-2 py-1 rounded text-xs border transition-colors ${(G=s.filters.frameworks)!=null&&G.includes(c.value)?"bg-primary/20 border-primary text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-slate-500"}`,children:c.label},c.value)})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"include_charts",checked:s.include_charts,onChange:c=>n({...s,include_charts:c.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),e.jsx("label",{htmlFor:"include_charts",className:"text-sm text-slate-300",children:"Include charts and visualizations"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(E,{type:"button",variant:"secondary",onClick:I,children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"primary",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),t?"Update":"Create"]})]})]})}),d.length===0&&!g?e.jsx(H,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ie,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scheduled reports"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create automated reports to receive regular updates via email"})]})}):e.jsx("div",{className:"space-y-3",children:d.map(c=>{const G=JSON.parse(c.recipients);return e.jsx(H,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${c.is_active?"bg-green-500/20":"bg-slate-500/20"}`,children:e.jsx(Ie,{className:`h-5 w-5 ${c.is_active?"text-green-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-white",children:c.name}),e.jsx(te,{variant:"status",type:c.is_active?"completed":"pending",children:c.is_active?"Active":"Paused"}),e.jsx(te,{variant:"primary",children:c.format.toUpperCase()})]}),e.jsxs("p",{className:"text-sm text-slate-400",children:[Q(c.report_type)," - ",b(c.schedule)]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Te,{className:"h-3 w-3"}),G.length," recipient",G.length!==1?"s":""]}),c.last_run_at&&e.jsxs("span",{className:"ml-3",children:[e.jsx(je,{className:"h-3 w-3 inline mr-1"}),"Last run ",et(new Date(c.last_run_at))," ago"]}),e.jsxs("span",{className:"ml-3",children:["Next: ",new Date(c.next_run_at).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>h(c),disabled:j===c.id,className:"p-2 text-cyan-400 hover:bg-cyan-500/20 rounded transition-colors disabled:opacity-50",title:"Run Now",children:j===c.id?e.jsx(ee,{size:"sm"}):e.jsx(as,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>k(c),className:`p-2 rounded transition-colors ${c.is_active?"text-yellow-400 hover:bg-yellow-500/20":"text-green-400 hover:bg-green-500/20"}`,title:c.is_active?"Pause":"Activate",children:c.is_active?e.jsx(Os,{className:"h-4 w-4"}):e.jsx(js,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>z(c),className:"p-2 text-slate-400 hover:text-primary transition-colors",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>D(c),className:"p-2 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete scheduled report ${c.name}`,children:e.jsx(ne,{className:"h-4 w-4"})})]})]})},c.id)})}),e.jsx(Se,{isOpen:!!i,onClose:()=>D(null),onConfirm:R,title:"Delete Scheduled Report",message:`Are you sure you want to delete the scheduled report "${i==null?void 0:i.name}"? Future reports will no longer be generated.`,confirmLabel:"Delete Report",variant:"warning",loading:A})]})},Ds={"scan.started":"Scan Started","scan.completed":"Scan Completed","scan.failed":"Scan Failed","vulnerability.found":"Vulnerability Found","vulnerability.critical":"Critical Vulnerability","vulnerability.resolved":"Vulnerability Resolved","asset.discovered":"Asset Discovered","compliance.violation":"Compliance Violation"};function pa(){const[d,P]=r.useState([]),[_,f]=r.useState([]),[v,y]=r.useState(!0),[g,M]=r.useState(!1),[t,a]=r.useState(null),[s,n]=r.useState(!1),[m,p]=r.useState(null),[i,D]=r.useState([]),[A,V]=r.useState(!1),[j,C]=r.useState(null),[S,u]=r.useState(null),[T,I]=r.useState(""),[z,L]=r.useState(""),[O,w]=r.useState(""),[k,h]=r.useState([]),[R,b]=r.useState([]),[Q,X]=r.useState(!0),[c,G]=r.useState(!1),[B,o]=r.useState(!1);r.useEffect(()=>{$(),W()},[]);const $=async()=>{try{const U=await Ee.list();P(U.data)}catch(U){console.error("Failed to load webhooks:",U),l.error("Failed to load webhooks")}finally{y(!1)}},W=async()=>{try{const U=await Ee.getEventTypes();f(U.data.event_types)}catch(U){console.error("Failed to load event types:",U)}},N=()=>{I(""),L(""),w(""),h([]),b([]),X(!0),G(!1),a(null)},q=()=>{N(),M(!0)},x=U=>{a(U),I(U.name),L(U.url),w(""),h([...U.events]),b(U.headers?Object.entries(U.headers).map(([se,oe])=>({key:se,value:oe})):[]),X(U.is_active),M(!0)},K=()=>{M(!1),N()},Y=async()=>{try{const U=await Ee.generateSecret();w(U.data.secret),G(!0),l.success("Secret generated")}catch{l.error("Failed to generate secret")}},me=()=>{O&&(navigator.clipboard.writeText(O),l.success("Secret copied to clipboard"))},F=()=>{b([...R,{key:"",value:""}])},re=U=>{b(R.filter((se,oe)=>oe!==U))},pe=(U,se,oe)=>{const xe=[...R];xe[U][se]=oe,b(xe)},ut=U=>{k.includes(U)?h(k.filter(se=>se!==U)):h([...k,U])},ht=async U=>{var se,oe;if(U.preventDefault(),!z.startsWith("http://")&&!z.startsWith("https://")){l.error("URL must start with http:// or https://");return}if(k.length===0){l.error("Please select at least one event");return}o(!0);try{const xe={};if(R.forEach(ie=>{ie.key.trim()&&ie.value.trim()&&(xe[ie.key.trim()]=ie.value.trim())}),t){const ie={name:T,url:z,events:k,headers:Object.keys(xe).length>0?xe:void 0,is_active:Q};O&&(ie.secret=O),await Ee.update(t.id,ie),l.success("Webhook updated")}else{const ie={name:T,url:z,events:k,headers:Object.keys(xe).length>0?xe:void 0,is_active:Q};O&&(ie.secret=O),await Ee.create(ie),l.success("Webhook created")}K(),$()}catch(xe){const ie=((oe=(se=xe.response)==null?void 0:se.data)==null?void 0:oe.error)||"Failed to save webhook";l.error(ie)}finally{o(!1)}},pt=async(U,se)=>{if(confirm(`Are you sure you want to delete the webhook "${se}"?`))try{await Ee.delete(U),l.success("Webhook deleted"),$()}catch{l.error("Failed to delete webhook")}},gt=async U=>{var se,oe;C(U);try{const ie=(await Ee.test(U)).data;ie.success?l.success(`Test successful (HTTP ${ie.status_code})`):l.error(`Test failed: ${ie.error||"Unknown error"}`)}catch(xe){const ie=((oe=(se=xe.response)==null?void 0:se.data)==null?void 0:oe.error)||"Failed to test webhook";l.error(ie)}finally{C(null)}},ft=async U=>{p(U),n(!0),V(!0);try{const se=await Ee.getDeliveries(U,50);D(se.data)}catch{l.error("Failed to load delivery history"),D([])}finally{V(!1)}},jt=U=>U.is_active?U.failure_count>=5?e.jsx(ke,{className:"w-5 h-5 text-red-500"}):U.last_status_code&&U.last_status_code>=200&&U.last_status_code<300?e.jsx(de,{className:"w-5 h-5 text-green-500"}):e.jsx(Be,{className:"w-5 h-5 text-yellow-500"}):e.jsx(Be,{className:"w-5 h-5 text-gray-500"}),ws=U=>U?new Date(U).toLocaleString():"Never";return v?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Re,{className:"w-6 h-6 animate-spin text-cyan-400"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"Webhooks"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Send HTTP notifications to external systems when events occur"})]}),e.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(ce,{className:"w-4 h-4"}),"Add Webhook"]})]}),d.length===0?e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-8 text-center",children:[e.jsx(Js,{className:"w-12 h-12 mx-auto text-gray-500 mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-300",children:"No webhooks configured"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Create a webhook to send notifications to external systems"})]}):e.jsx("div",{className:"space-y-4",children:d.map(U=>e.jsx("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[jt(U),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-100",children:U.name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 font-mono",children:U.url}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:U.events.map(se=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-700 text-gray-300 rounded",children:Ds[se]||se},se))}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-400",children:[e.jsxs("span",{children:["Last triggered: ",ws(U.last_triggered_at)]}),U.last_status_code&&e.jsxs("span",{className:U.last_status_code>=200&&U.last_status_code<300?"text-green-400":"text-red-400",children:["HTTP ",U.last_status_code]}),U.failure_count>0&&e.jsxs("span",{className:"text-red-400",children:[U.failure_count," failures"]}),U.has_secret&&e.jsx("span",{className:"text-cyan-400",children:"Signed"}),!U.is_active&&e.jsx("span",{className:"text-gray-500",children:"Disabled"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>gt(U.id),disabled:j===U.id,className:"p-2 text-gray-400 hover:text-cyan-400 transition-colors disabled:opacity-50",title:"Test webhook",children:j===U.id?e.jsx(Re,{className:"w-4 h-4 animate-spin"}):e.jsx(Pt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ft(U.id),className:"p-2 text-gray-400 hover:text-cyan-400 transition-colors",title:"View delivery history",children:e.jsx(Rs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>x(U),className:"p-2 text-gray-400 hover:text-cyan-400 transition-colors",title:"Edit webhook",children:e.jsx(ye,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>pt(U.id,U.name),className:"p-2 text-gray-400 hover:text-red-400 transition-colors",title:"Delete webhook",children:e.jsx(ne,{className:"w-4 h-4"})})]})]})},U.id))}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100 mb-4",children:t?"Edit Webhook":"Create Webhook"}),e.jsxs("form",{onSubmit:ht,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:T,onChange:U=>I(U.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"My Webhook"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"URL"}),e.jsx("input",{type:"url",value:z,onChange:U=>L(U.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent font-mono text-sm",placeholder:"https://example.com/webhook"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Secret Key (optional)"}),e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"If set, requests will include an X-Webhook-Signature header with HMAC-SHA256 signature"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:c?"text":"password",value:O,onChange:U=>w(U.target.value),className:"w-full px-3 py-2 pr-20 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent font-mono text-sm",placeholder:t!=null&&t.has_secret?"(unchanged)":"Enter or generate a secret"}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex gap-1",children:[e.jsx("button",{type:"button",onClick:()=>G(!c),className:"p-1 text-gray-400 hover:text-gray-200",children:c?e.jsx(bs,{className:"w-4 h-4"}):e.jsx(Ks,{className:"w-4 h-4"})}),O&&e.jsx("button",{type:"button",onClick:me,className:"p-1 text-gray-400 hover:text-gray-200",children:e.jsx(he,{className:"w-4 h-4"})})]})]}),e.jsx("button",{type:"button",onClick:Y,className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg transition-colors",children:"Generate"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Events"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:_.map(U=>e.jsxs("label",{className:"flex items-start gap-2 p-3 bg-gray-700/50 rounded-lg cursor-pointer hover:bg-gray-700",children:[e.jsx("input",{type:"checkbox",checked:k.includes(U.id),onChange:()=>ut(U.id),className:"mt-1 rounded border-gray-600 bg-gray-700 text-cyan-500 focus:ring-cyan-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-200",children:U.name}),e.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:U.description})]})]},U.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Custom Headers (optional)"}),e.jsx("button",{type:"button",onClick:F,className:"text-sm text-cyan-400 hover:text-cyan-300",children:"+ Add Header"})]}),R.length>0&&e.jsx("div",{className:"space-y-2",children:R.map((U,se)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:U.key,onChange:oe=>pe(se,"key",oe.target.value),placeholder:"Header name",className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 text-sm"}),e.jsx("input",{type:"text",value:U.value,onChange:oe=>pe(se,"value",oe.target.value),placeholder:"Header value",className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 text-sm"}),e.jsx("button",{type:"button",onClick:()=>re(se),className:"p-2 text-gray-400 hover:text-red-400",children:e.jsx(ne,{className:"w-4 h-4"})})]},se))})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:Q,onChange:U=>X(U.target.checked),className:"rounded border-gray-600 bg-gray-700 text-cyan-500 focus:ring-cyan-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Enable webhook"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:K,className:"px-4 py-2 text-gray-300 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:B,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors disabled:opacity-50",children:B?"Saving...":t?"Save Changes":"Create Webhook"})]})]})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"Delivery History"}),e.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-white",children:"Close"})]}),A?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Re,{className:"w-6 h-6 animate-spin text-cyan-400"})}):i.length===0?e.jsx("div",{className:"text-center py-12 text-gray-400",children:"No deliveries yet"}):e.jsx("div",{className:"space-y-3",children:i.map(U=>e.jsxs("div",{className:"bg-gray-700/50 rounded-lg border border-gray-600",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer",onClick:()=>u(S===U.id?null:U.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[U.response_status&&U.response_status>=200&&U.response_status<300?e.jsx(de,{className:"w-5 h-5 text-green-500"}):e.jsx(ke,{className:"w-5 h-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-200",children:Ds[U.event_type]||U.event_type}),e.jsx("span",{className:"text-sm text-gray-400 ml-3",children:ws(U.delivered_at)})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[U.response_status&&e.jsxs("span",{className:U.response_status>=200&&U.response_status<300?"text-green-400":"text-red-400",children:["HTTP ",U.response_status]}),U.error&&e.jsx("span",{className:"text-red-400 text-sm",children:U.error}),S===U.id?e.jsx(Qs,{className:"w-4 h-4 text-gray-400"}):e.jsx(Ze,{className:"w-4 h-4 text-gray-400"})]})]}),S===U.id&&e.jsxs("div",{className:"px-4 pb-4 border-t border-gray-600 pt-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-400 mb-2",children:"Request Payload"}),e.jsx("pre",{className:"bg-gray-900 p-3 rounded text-xs text-gray-300 overflow-x-auto",children:JSON.stringify(JSON.parse(U.payload||"{}"),null,2)})]}),U.response_body&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-400 mb-2",children:"Response Body"}),e.jsx("pre",{className:"bg-gray-900 p-3 rounded text-xs text-gray-300 overflow-x-auto max-h-48",children:U.response_body})]})]})]},U.id))})]})})]})}const ga=()=>{var me;const[d,P]=r.useState([]),[_,f]=r.useState(!0),[v,y]=r.useState(!1),[g,M]=r.useState({name:"",platform:"github_actions",permissions:{trigger_scans:!0,view_results:!0,download_reports:!0,view_quality_gates:!0},expires_in_days:90}),[t,a]=r.useState(null),[s,n]=r.useState(!1),[m,p]=r.useState([]),[i,D]=r.useState(!0),[A,V]=r.useState(!1),[j,C]=r.useState({name:"",description:"",fail_on_critical:!0,fail_on_high:!0,max_critical:0,max_high:0,max_medium:10,max_low:50,is_default:!1}),[S,u]=r.useState(!1),[T,I]=r.useState([]),[z,L]=r.useState(!0),[O,w]=r.useState("tokens"),[k,h]=r.useState("github"),[R,b]=r.useState(""),[Q,X]=r.useState(!1);r.useEffect(()=>{c(),G(),B()},[]),r.useEffect(()=>{O==="examples"&&o()},[k,O]);const c=async()=>{try{f(!0);const F=await Ae.tokens.list();P(F.data)}catch(F){console.error("Failed to load tokens:",F),l.error("Failed to load CI/CD tokens")}finally{f(!1)}},G=async()=>{try{D(!0);const F=await Ae.qualityGates.list();p(F.data)}catch(F){console.error("Failed to load quality gates:",F),l.error("Failed to load quality gates")}finally{D(!1)}},B=async()=>{try{L(!0);const F=await Ae.runs.list(20);I(F.data)}catch(F){console.error("Failed to load runs:",F),l.error("Failed to load CI/CD runs")}finally{L(!1)}},o=async()=>{try{X(!0);const F=await Ae.examples.get(k);b(F.data.content)}catch(F){console.error("Failed to load pipeline example:",F),l.error("Failed to load pipeline example")}finally{X(!1)}},$=async()=>{if(!g.name.trim()){l.error("Token name is required");return}try{n(!0);let F;if(g.expires_in_days){const pe=new Date;pe.setDate(pe.getDate()+g.expires_in_days),F=pe.toISOString()}const re=await Ae.tokens.create({name:g.name,platform:g.platform==="generic"?"github_actions":g.platform,permissions:g.permissions,expires_at:F});a(re.data.token),await c(),l.success("CI/CD token created successfully")}catch(F){console.error("Failed to create token:",F),l.error("Failed to create token")}finally{n(!1)}},W=async F=>{if(confirm("Are you sure you want to revoke this token?"))try{await Ae.tokens.delete(F),await c(),l.success("Token revoked successfully")}catch(re){console.error("Failed to delete token:",re),l.error("Failed to revoke token")}},N=async()=>{if(!j.name.trim()){l.error("Quality gate name is required");return}try{u(!0),await Ae.qualityGates.create({name:j.name,description:j.description||void 0,fail_on_critical:j.fail_on_critical,fail_on_high:j.fail_on_high,max_critical:j.max_critical,max_high:j.max_high,max_medium:j.max_medium,max_low:j.max_low,is_default:j.is_default}),await G(),V(!1),C({name:"",description:"",fail_on_critical:!0,fail_on_high:!0,max_critical:0,max_high:0,max_medium:10,max_low:50,is_default:!1}),l.success("Quality gate created successfully")}catch(F){console.error("Failed to create quality gate:",F),l.error("Failed to create quality gate")}finally{u(!1)}},q=async F=>{if(confirm("Are you sure you want to delete this quality gate?"))try{await Ae.qualityGates.delete(F),await G(),l.success("Quality gate deleted")}catch(re){console.error("Failed to delete quality gate:",re),l.error("Failed to delete quality gate")}},x=F=>{navigator.clipboard.writeText(F),l.success("Copied to clipboard")},K=F=>new Date(F).toLocaleString(),Y=F=>{switch(F){case"github_actions":return"GitHub Actions";case"jenkins":return"Jenkins";case"gitlab_ci":return"GitLab CI";default:return"Generic"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-2 border-b border-dark-border pb-2",children:[e.jsxs("button",{onClick:()=>w("tokens"),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg font-medium transition-colors ${O==="tokens"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(Me,{className:"h-4 w-4"}),"API Tokens"]}),e.jsxs("button",{onClick:()=>w("quality-gates"),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg font-medium transition-colors ${O==="quality-gates"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(ue,{className:"h-4 w-4"}),"Quality Gates"]}),e.jsxs("button",{onClick:()=>w("runs"),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg font-medium transition-colors ${O==="runs"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(Ys,{className:"h-4 w-4"}),"Recent Runs"]}),e.jsxs("button",{onClick:()=>w("examples"),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg font-medium transition-colors ${O==="examples"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(Ft,{className:"h-4 w-4"}),"Pipeline Examples"]})]}),O==="tokens"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"CI/CD API Tokens"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Create tokens for your CI/CD pipelines to trigger scans"})]}),e.jsxs(E,{onClick:()=>{y(!0),a(null)},children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"New Token"]})]}),v&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4 space-y-4",children:[e.jsx("h4",{className:"font-medium text-white",children:"Create New Token"}),t?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:[e.jsx("p",{className:"text-green-400 text-sm mb-2",children:"Token created successfully! Copy it now - it won't be shown again."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"bg-dark-bg px-3 py-2 rounded text-sm text-white flex-1 font-mono",children:t}),e.jsx(E,{onClick:()=>x(t),variant:"outline",size:"sm",children:e.jsx(he,{className:"h-4 w-4"})})]})]}),e.jsx(E,{onClick:()=>{y(!1),a(null)},variant:"outline",children:"Done"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(J,{label:"Token Name",value:g.name,onChange:F=>M({...g,name:F.target.value}),placeholder:"e.g., GitHub Actions Production"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Platform"}),e.jsxs("select",{value:g.platform,onChange:F=>M({...g,platform:F.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"github_actions",children:"GitHub Actions"}),e.jsx("option",{value:"jenkins",children:"Jenkins"}),e.jsx("option",{value:"gitlab_ci",children:"GitLab CI"}),e.jsx("option",{value:"generic",children:"Generic"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Permissions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(De,{checked:g.permissions.trigger_scans,onChange:F=>M({...g,permissions:{...g.permissions,trigger_scans:F}}),label:"Trigger scans"}),e.jsx(De,{checked:g.permissions.view_results,onChange:F=>M({...g,permissions:{...g.permissions,view_results:F}}),label:"View results"}),e.jsx(De,{checked:g.permissions.download_reports,onChange:F=>M({...g,permissions:{...g.permissions,download_reports:F}}),label:"Download reports"}),e.jsx(De,{checked:g.permissions.view_quality_gates,onChange:F=>M({...g,permissions:{...g.permissions,view_quality_gates:F}}),label:"View quality gates"})]})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Expiration (days)"}),e.jsx(J,{type:"number",value:((me=g.expires_in_days)==null?void 0:me.toString())||"",onChange:F=>M({...g,expires_in_days:F.target.value?parseInt(F.target.value):null}),placeholder:"Never expires if empty"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{onClick:$,loading:s,children:"Create Token"}),e.jsx(E,{onClick:()=>y(!1),variant:"outline",children:"Cancel"})]})]})]}),_?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"Loading tokens..."}):d.length===0?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No CI/CD tokens created yet. Create one to get started."}):e.jsx("div",{className:"space-y-2",children:d.map(F=>e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:F.name}),e.jsx("span",{className:"text-xs bg-primary/20 text-primary px-2 py-0.5 rounded",children:Y(F.platform)})]}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:[e.jsxs("code",{className:"bg-dark-bg px-2 py-0.5 rounded",children:[F.prefix,"..."]}),e.jsx("span",{className:"mx-2",children:"-"}),"Created ",K(F.created_at),F.last_used_at&&e.jsxs("span",{className:"ml-2",children:["- Last used ",K(F.last_used_at)]}),F.expires_at&&e.jsxs("span",{className:"ml-2",children:["- Expires ",K(F.expires_at)]})]})]}),e.jsx(E,{onClick:()=>W(F.id),variant:"outline",size:"sm",className:"text-red-400 hover:text-red-300",children:e.jsx(ne,{className:"h-4 w-4"})})]},F.id))})]}),O==="quality-gates"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Quality Gates"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Configure pass/fail thresholds for your CI/CD pipelines"})]}),e.jsxs(E,{onClick:()=>V(!0),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"New Quality Gate"]})]}),A&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4 space-y-4",children:[e.jsx("h4",{className:"font-medium text-white",children:"Create Quality Gate"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(J,{label:"Name",value:j.name,onChange:F=>C({...j,name:F.target.value}),placeholder:"e.g., Production Standards"}),e.jsx(J,{label:"Description",value:j.description,onChange:F=>C({...j,description:F.target.value}),placeholder:"Optional description"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(De,{checked:j.fail_on_critical,onChange:F=>C({...j,fail_on_critical:F}),label:"Fail on critical vulnerabilities"}),e.jsx(De,{checked:j.fail_on_high,onChange:F=>C({...j,fail_on_high:F}),label:"Fail on high vulnerabilities"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Max Critical"}),e.jsx(J,{type:"number",value:j.max_critical.toString(),onChange:F=>C({...j,max_critical:parseInt(F.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Max High"}),e.jsx(J,{type:"number",value:j.max_high.toString(),onChange:F=>C({...j,max_high:parseInt(F.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Max Medium"}),e.jsx(J,{type:"number",value:j.max_medium.toString(),onChange:F=>C({...j,max_medium:parseInt(F.target.value)||0}),placeholder:"10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Max Low"}),e.jsx(J,{type:"number",value:j.max_low.toString(),onChange:F=>C({...j,max_low:parseInt(F.target.value)||0}),placeholder:"50"})]})]}),e.jsx("div",{className:"flex gap-4",children:e.jsx(De,{checked:j.is_default,onChange:F=>C({...j,is_default:F}),label:"Set as default quality gate"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{onClick:N,loading:S,children:"Create Quality Gate"}),e.jsx(E,{onClick:()=>V(!1),variant:"outline",children:"Cancel"})]})]}),i?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"Loading quality gates..."}):m.length===0?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No quality gates configured. The default gate will block any critical vulnerabilities."}):e.jsx("div",{className:"space-y-2",children:m.map(F=>e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:F.name}),F.is_default&&e.jsx("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-0.5 rounded",children:"Default"}),!F.user_id&&e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded",children:"System"})]}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:[F.fail_on_critical&&"Fail on Critical",F.fail_on_high&&(F.fail_on_critical?", High":"Fail on High"),` - Max: Critical=${F.max_critical}, High=${F.max_high}, Medium=${F.max_medium}, Low=${F.max_low}`]}),F.description&&e.jsx("div",{className:"text-sm text-slate-500 mt-1",children:F.description})]}),F.user_id&&e.jsx(E,{onClick:()=>q(F.id),variant:"outline",size:"sm",className:"text-red-400 hover:text-red-300",children:e.jsx(ne,{className:"h-4 w-4"})})]},F.id))})]}),O==="runs"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Recent CI/CD Runs"}),e.jsx("p",{className:"text-sm text-slate-400",children:"View recent scans triggered from CI/CD pipelines"})]}),z?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"Loading runs..."}):T.length===0?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No CI/CD runs yet. Trigger a scan from your pipeline to see results here."}):e.jsx("div",{className:"space-y-2",children:T.map(F=>e.jsx("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[F.quality_gate_passed===!0?e.jsx(Dt,{className:"h-5 w-5 text-green-400"}):F.quality_gate_passed===!1?e.jsx(ke,{className:"h-5 w-5 text-red-400"}):e.jsx(Xs,{className:"h-5 w-5 text-slate-400 animate-spin"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:F.scan_id?`Scan ${F.scan_id.slice(0,8)}...`:"Pending Scan"}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${F.status==="completed"?"bg-green-500/20 text-green-400":F.status==="failed"?"bg-red-500/20 text-red-400":F.status==="running"?"bg-blue-500/20 text-blue-400":"bg-slate-500/20 text-slate-400"}`,children:F.status})]}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:[Y(F.platform),F.branch&&` - ${F.branch}`,F.commit_sha&&` (${F.commit_sha.slice(0,7)})`,e.jsxs("span",{className:"ml-2",children:["- ",K(F.started_at)]}),F.exit_code!==null&&e.jsxs("span",{className:"ml-2",children:["Exit code: ",F.exit_code]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:F.pipeline_url&&e.jsx("a",{href:F.pipeline_url,target:"_blank",rel:"noopener noreferrer",className:"text-slate-400 hover:text-white",children:e.jsx(ss,{className:"h-4 w-4"})})})]})},F.id))})]}),O==="examples"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Pipeline Configuration Examples"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Copy these examples to integrate HeroForge with your CI/CD platform"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>h("github"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${k==="github"?"bg-primary text-white":"bg-dark-surface text-slate-400 hover:text-white"}`,children:"GitHub Actions"}),e.jsx("button",{onClick:()=>h("jenkins"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${k==="jenkins"?"bg-primary text-white":"bg-dark-surface text-slate-400 hover:text-white"}`,children:"Jenkins"}),e.jsx("button",{onClick:()=>h("gitlab"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${k==="gitlab"?"bg-primary text-white":"bg-dark-surface text-slate-400 hover:text-white"}`,children:"GitLab CI"})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm text-slate-400",children:[k==="github"&&".github/workflows/security-scan.yml",k==="jenkins"&&"Jenkinsfile",k==="gitlab"&&".gitlab-ci.yml"]}),e.jsxs(E,{onClick:()=>x(R),variant:"outline",size:"sm",children:[e.jsx(he,{className:"h-4 w-4 mr-1"}),"Copy"]})]}),Q?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"Loading example..."}):e.jsx("pre",{className:"bg-dark-bg rounded-lg p-4 text-sm text-slate-300 overflow-x-auto max-h-[500px]",children:e.jsx("code",{children:R})})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-400 mb-2",children:"Setup Instructions"}),e.jsxs("ol",{className:"text-sm text-slate-300 space-y-2 list-decimal list-inside",children:[e.jsx("li",{children:'Create a CI/CD token in the "API Tokens" tab above'}),e.jsxs("li",{children:["Add the token as a secret in your CI/CD platform:",e.jsxs("ul",{className:"ml-6 mt-1 space-y-1",children:[e.jsx("li",{children:"GitHub: Settings > Secrets > HEROFORGE_CI_TOKEN"}),e.jsx("li",{children:"Jenkins: Credentials > Add > heroforge-ci-token"}),e.jsx("li",{children:"GitLab: Settings > CI/CD > Variables > HEROFORGE_CI_TOKEN"})]})]}),e.jsx("li",{children:"Copy the pipeline configuration above to your repository"}),e.jsx("li",{children:"Update the target IP addresses in the configuration"}),e.jsx("li",{children:"Configure a quality gate if needed (defaults will be used otherwise)"})]})]})]})]})},fa=()=>{const[d,P]=r.useState(!0),[_,f]=r.useState([]),[v,y]=r.useState([]),[g,M]=r.useState(null),[t,a]=r.useState(!1),[s,n]=r.useState(!1),[m,p]=r.useState(null);r.useEffect(()=>{i()},[]);const i=async()=>{P(!0);try{const[j,C]=await Promise.all([_e.admin.listProviders(),_e.admin.getPresets()]);f(j.data),y(C.data)}catch(j){console.error("Failed to load SSO data:",j),l.error("Failed to load SSO providers")}finally{P(!1)}},D=async j=>{p(j);try{const C=await _e.admin.testProvider(j);C.data.success?l.success(C.data.message):l.error(C.data.message)}catch(C){console.error("Test failed:",C),l.error("Connection test failed")}finally{p(null)}},A=async j=>{if(confirm("Are you sure you want to delete this SSO provider?"))try{await _e.admin.deleteProvider(j),l.success("SSO provider deleted"),i()}catch(C){console.error("Delete failed:",C),l.error("Failed to delete provider")}},V=async j=>{const C=j.status==="active"?"disabled":"active";try{await _e.admin.updateProvider(j.id,{status:C}),l.success(`Provider ${C==="active"?"enabled":"disabled"}`),i()}catch(S){console.error("Status toggle failed:",S),l.error("Failed to update provider status")}};return d?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx(ee,{})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"SSO Authentication"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Configure SAML 2.0 and OpenID Connect identity providers for enterprise single sign-on"})]}),e.jsxs(E,{onClick:()=>a(!0),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Add Provider"]})]}),_.length===0?e.jsxs(H,{className:"p-8 text-center",children:[e.jsx(Ns,{className:"h-12 w-12 text-gray-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"No SSO Providers Configured"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Add an identity provider to enable single sign-on for your users."}),e.jsxs(E,{onClick:()=>a(!0),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Add Your First Provider"]})]}):e.jsx("div",{className:"space-y-4",children:_.map(j=>e.jsx(ja,{provider:j,onEdit:()=>{M(j),n(!0)},onDelete:()=>A(j.id),onTest:()=>D(j.id),onToggleStatus:()=>V(j),testing:m===j.id},j.id))}),t&&e.jsx(ba,{presets:v,onClose:()=>a(!1),onSuccess:()=>{a(!1),i()}}),s&&g&&e.jsx(ya,{provider:g,onClose:()=>{n(!1),M(null)},onSuccess:()=>{n(!1),M(null),i()}})]})},ja=({provider:d,onEdit:P,onDelete:_,onTest:f,onToggleStatus:v,testing:y})=>{const[g,M]=r.useState(!1),[t,a]=r.useState(null),[s,n]=r.useState(!1),m=async()=>{if(!t){n(!0);try{const A=await _e.admin.getMetadata(d.id);a(A.data)}catch(A){console.error("Failed to load metadata:",A)}finally{n(!1)}}},p=()=>{g||m(),M(!g)},i=A=>{navigator.clipboard.writeText(A),l.success("Copied to clipboard")},D=async()=>{try{const A=await _e.admin.downloadMetadataXml(d.id),V=new Blob([A.data],{type:"application/xml"}),j=window.URL.createObjectURL(V),C=document.createElement("a");C.href=j,C.download=`sp-metadata-${d.name}.xml`,C.click(),window.URL.revokeObjectURL(j)}catch(A){console.error("Download failed:",A),l.error("Failed to download metadata")}};return e.jsxs(H,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-gray-700 rounded-lg",children:d.provider_type==="saml"?e.jsx(ue,{className:"h-6 w-6 text-cyan-400"}):e.jsx(Ns,{className:"h-6 w-6 text-cyan-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-white",children:d.display_name}),e.jsx(te,{className:d.provider_type==="saml"?"bg-purple-600":"bg-blue-600",children:d.provider_type.toUpperCase()}),d.status==="active"?e.jsx(te,{className:"bg-green-600",children:"Active"}):e.jsx(te,{className:"bg-gray-600",children:"Disabled"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:d.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(E,{variant:"secondary",size:"sm",onClick:f,disabled:y,children:[y?e.jsx(ee,{size:"sm"}):e.jsx(vs,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-1",children:"Test"})]}),e.jsx(E,{variant:"secondary",size:"sm",onClick:v,children:d.status==="active"?e.jsx(ke,{className:"h-4 w-4"}):e.jsx(de,{className:"h-4 w-4"})}),e.jsx(E,{variant:"secondary",size:"sm",onClick:P,children:e.jsx(Tt,{className:"h-4 w-4"})}),e.jsx(E,{variant:"danger",size:"sm",onClick:_,children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsx(E,{variant:"secondary",size:"sm",onClick:p,children:g?e.jsx(Qs,{className:"h-4 w-4"}):e.jsx(Ze,{className:"h-4 w-4"})})]})]}),g&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-700",children:s?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(ee,{})}):t?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300",children:"Service Provider Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Entity ID"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm text-cyan-400 bg-gray-800 px-2 py-1 rounded flex-1 truncate",children:t.entity_id}),e.jsx(E,{size:"sm",variant:"secondary",onClick:()=>i(t.entity_id),children:e.jsx(he,{className:"h-3 w-3"})})]})]}),t.acs_url&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"ACS URL"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm text-cyan-400 bg-gray-800 px-2 py-1 rounded flex-1 truncate",children:t.acs_url}),e.jsx(E,{size:"sm",variant:"secondary",onClick:()=>i(t.acs_url),children:e.jsx(he,{className:"h-3 w-3"})})]})]}),t.redirect_uri&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Redirect URI"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm text-cyan-400 bg-gray-800 px-2 py-1 rounded flex-1 truncate",children:t.redirect_uri}),e.jsx(E,{size:"sm",variant:"secondary",onClick:()=>i(t.redirect_uri),children:e.jsx(he,{className:"h-3 w-3"})})]})]})]}),d.provider_type==="saml"&&e.jsxs(E,{variant:"secondary",size:"sm",onClick:D,children:[e.jsx(Bs,{className:"h-4 w-4 mr-2"}),"Download SP Metadata XML"]}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(Ve,{className:"h-3 w-3"}),"Configure your Identity Provider with the above values"]})]}):e.jsx("p",{className:"text-gray-400 text-sm",children:"Failed to load metadata"})})]})},ba=({presets:d,onClose:P,onSuccess:_})=>{const[f,v]=r.useState("preset"),[y,g]=r.useState(null),[M,t]=r.useState(!1),[a,s]=r.useState({name:"",display_name:"",idp_entity_id:"",idp_sso_url:"",idp_slo_url:"",idp_certificate:"",issuer_url:"",client_id:"",client_secret:"",scopes:"openid email profile",jit_provisioning:!0,default_role:"user"}),n=p=>{g(p),s(i=>({...i,name:p.name.toLowerCase().replace(/\s+/g,"_"),display_name:p.name})),v("configure")},m=async()=>{var p,i;if(y){t(!0);try{let D;y.provider_type==="saml"?D={type:"saml",idp_entity_id:a.idp_entity_id,idp_sso_url:a.idp_sso_url,idp_slo_url:a.idp_slo_url||void 0,idp_certificate:a.idp_certificate,sign_requests:!0,require_signed_response:!0,require_signed_assertion:!0,encrypt_assertions:!1,force_authn:!1,allowed_clock_skew:60}:D={type:"oidc",issuer_url:a.issuer_url,client_id:a.client_id,client_secret:a.client_secret,scopes:a.scopes.split(/[,\s]+/).filter(Boolean),use_pkce:!0,response_type:"code"};const A={name:a.name,display_name:a.display_name,provider_type:y.provider_type,icon:y.icon,config:D,attribute_mappings:y.default_attribute_mappings,jit_provisioning:a.jit_provisioning,default_role:a.default_role};await _e.admin.createProvider(A),l.success("SSO provider created"),_()}catch(D){const A=D;console.error("Create failed:",D),l.error(((i=(p=A.response)==null?void 0:p.data)==null?void 0:i.error)||"Failed to create provider")}finally{t(!1)}}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Add SSO Provider"}),e.jsx("button",{onClick:P,className:"text-gray-400 hover:text-white",children:e.jsx(ke,{className:"h-6 w-6"})})]}),f==="preset"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-400 mb-4",children:"Select an identity provider:"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:d.map(p=>e.jsxs("button",{onClick:()=>n(p),className:"p-4 bg-gray-700 hover:bg-gray-600 rounded-lg text-left transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[p.provider_type==="saml"?e.jsx(ue,{className:"h-6 w-6 text-purple-400"}):e.jsx(Ns,{className:"h-6 w-6 text-blue-400"}),e.jsx("span",{className:"font-medium text-white",children:p.name})]}),e.jsx("p",{className:"text-sm text-gray-400",children:p.description}),e.jsx(te,{className:p.provider_type==="saml"?"bg-purple-600 mt-2":"bg-blue-600 mt-2",children:p.provider_type.toUpperCase()})]},p.id))})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("button",{onClick:()=>v("preset"),className:"text-cyan-400 hover:text-cyan-300",children:"Back"}),e.jsx("span",{className:"text-gray-500",children:"/"}),e.jsx("span",{className:"text-white",children:y==null?void 0:y.name})]}),(y==null?void 0:y.setup_instructions)&&e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg mb-4 text-sm text-gray-300",children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4"}),"Setup Instructions"]}),e.jsx("div",{className:"prose prose-invert prose-sm max-w-none whitespace-pre-wrap",children:y.setup_instructions})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Internal Name"}),e.jsx(J,{value:a.name,onChange:p=>s(i=>({...i,name:p.target.value})),placeholder:"my_idp"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Display Name"}),e.jsx(J,{value:a.display_name,onChange:p=>s(i=>({...i,display_name:p.target.value})),placeholder:"My Identity Provider"})]})]}),(y==null?void 0:y.provider_type)==="saml"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"IdP Entity ID"}),e.jsx(J,{value:a.idp_entity_id,onChange:p=>s(i=>({...i,idp_entity_id:p.target.value})),placeholder:"https://idp.example.com/metadata"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"IdP SSO URL"}),e.jsx(J,{value:a.idp_sso_url,onChange:p=>s(i=>({...i,idp_sso_url:p.target.value})),placeholder:"https://idp.example.com/sso/saml"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"IdP SLO URL (Optional)"}),e.jsx(J,{value:a.idp_slo_url,onChange:p=>s(i=>({...i,idp_slo_url:p.target.value})),placeholder:"https://idp.example.com/slo/saml"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"IdP Certificate (PEM)"}),e.jsx("textarea",{value:a.idp_certificate,onChange:p=>s(i=>({...i,idp_certificate:p.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 font-mono text-sm",rows:5,placeholder:`-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----`})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Issuer URL"}),e.jsx(J,{value:a.issuer_url,onChange:p=>s(i=>({...i,issuer_url:p.target.value})),placeholder:"https://login.microsoftonline.com/{tenant}/v2.0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Client ID"}),e.jsx(J,{value:a.client_id,onChange:p=>s(i=>({...i,client_id:p.target.value})),placeholder:"your-client-id"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Client Secret"}),e.jsx(J,{type:"password",value:a.client_secret,onChange:p=>s(i=>({...i,client_secret:p.target.value})),placeholder:"your-client-secret"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Scopes"}),e.jsx(J,{value:a.scopes,onChange:p=>s(i=>({...i,scopes:p.target.value})),placeholder:"openid email profile"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Default Role"}),e.jsxs("select",{value:a.default_role,onChange:p=>s(i=>({...i,default_role:p.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"auditor",children:"Auditor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsx("div",{className:"flex items-center pt-6",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.jit_provisioning,onChange:p=>s(i=>({...i,jit_provisioning:p.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Enable JIT User Provisioning"})]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(E,{variant:"secondary",onClick:P,children:"Cancel"}),e.jsx(E,{onClick:m,disabled:M,children:M?e.jsx(ee,{size:"sm"}):"Create Provider"})]})]})]})})},ya=({provider:d,onClose:P,onSuccess:_})=>{const[f,v]=r.useState(!1),[y,g]=r.useState("general"),[M,t]=r.useState({display_name:d.display_name,jit_provisioning:d.jit_provisioning,default_role:d.default_role,update_on_login:d.update_on_login}),[a,s]=r.useState(d.attribute_mappings||[]),[n,m]=r.useState(d.group_mappings||[]),p=async()=>{v(!0);try{const j={display_name:M.display_name,jit_provisioning:M.jit_provisioning,default_role:M.default_role,update_on_login:M.update_on_login,attribute_mappings:a,group_mappings:n};await _e.admin.updateProvider(d.id,j),l.success("SSO provider updated"),_()}catch(j){console.error("Update failed:",j),l.error("Failed to update provider")}finally{v(!1)}},i=()=>{s([...a,{source:"",target:"",required:!1}])},D=j=>{s(a.filter((C,S)=>S!==j))},A=()=>{m([...n,{group:"",role:"user",priority:0}])},V=j=>{m(n.filter((C,S)=>S!==j))};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-white",children:["Edit ",d.display_name]}),e.jsx("button",{onClick:P,className:"text-gray-400 hover:text-white",children:e.jsx(ke,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex border-b border-gray-700 mb-4",children:[e.jsx("button",{onClick:()=>g("general"),className:`px-4 py-2 text-sm font-medium ${y==="general"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:"General"}),e.jsx("button",{onClick:()=>g("mappings"),className:`px-4 py-2 text-sm font-medium ${y==="mappings"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:"Attribute Mappings"})]}),y==="general"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Display Name"}),e.jsx(J,{value:M.display_name,onChange:j=>t(C=>({...C,display_name:j.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Default Role"}),e.jsxs("select",{value:M.default_role,onChange:j=>t(C=>({...C,default_role:j.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"auditor",children:"Auditor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:M.jit_provisioning,onChange:j=>t(C=>({...C,jit_provisioning:j.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Enable JIT User Provisioning"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:M.update_on_login,onChange:j=>t(C=>({...C,update_on_login:j.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Update User Profile on Login"})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300",children:"Attribute Mappings"}),e.jsxs(E,{size:"sm",variant:"secondary",onClick:i,children:[e.jsx(ce,{className:"h-3 w-3 mr-1"}),"Add"]})]}),e.jsx("div",{className:"space-y-2",children:a.map((j,C)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{placeholder:"IdP Attribute",value:j.source,onChange:S=>{const u=[...a];u[C].source=S.target.value,s(u)},className:"flex-1"}),e.jsx("span",{className:"text-gray-500",children:"->"}),e.jsxs("select",{value:j.target,onChange:S=>{const u=[...a];u[C].target=S.target.value,s(u)},className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white",children:[e.jsx("option",{value:"",children:"Select field"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"username",children:"Username"}),e.jsx("option",{value:"display_name",children:"Display Name"}),e.jsx("option",{value:"first_name",children:"First Name"}),e.jsx("option",{value:"last_name",children:"Last Name"}),e.jsx("option",{value:"groups",children:"Groups"})]}),e.jsx(E,{size:"sm",variant:"danger",onClick:()=>D(C),children:e.jsx(ne,{className:"h-3 w-3"})})]},C))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300",children:"Group to Role Mappings"}),e.jsxs(E,{size:"sm",variant:"secondary",onClick:A,children:[e.jsx(ce,{className:"h-3 w-3 mr-1"}),"Add"]})]}),e.jsx("div",{className:"space-y-2",children:n.map((j,C)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{placeholder:"IdP Group",value:j.group,onChange:S=>{const u=[...n];u[C].group=S.target.value,m(u)},className:"flex-1"}),e.jsx("span",{className:"text-gray-500",children:"->"}),e.jsxs("select",{value:j.role,onChange:S=>{const u=[...n];u[C].role=S.target.value,m(u)},className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"auditor",children:"Auditor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]}),e.jsx(E,{size:"sm",variant:"danger",onClick:()=>V(C),children:e.jsx(ne,{className:"h-3 w-3"})})]},C))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(E,{variant:"secondary",onClick:P,children:"Cancel"}),e.jsx(E,{onClick:p,disabled:f,children:f?e.jsx(ee,{size:"sm"}):"Save Changes"})]})]})})},va=()=>{const[d,P]=r.useState(!0),[_,f]=r.useState(!1),[v,y]=r.useState(!1),[g,M]=r.useState(null),[t,a]=r.useState([]),[s,n]=r.useState(null),[m,p]=r.useState(null),[i,D]=r.useState("anthropic"),[A,V]=r.useState(""),[j,C]=r.useState(""),[S,u]=r.useState(""),[T,I]=r.useState(""),[z,L]=r.useState(""),[O,w]=r.useState(""),[k,h]=r.useState(!1),[R,b]=r.useState(!0);r.useEffect(()=>{Q()},[]);const Q=async()=>{P(!0);try{const[o,$,W]=await Promise.all([Je.getConfiguration(),Je.getProviders(),Je.getModels()]);M(o.data),a($.data),n(W.data),o.data&&(D(o.data.provider),V(o.data.model),I(o.data.ollama_base_url||""),w(o.data.fallback_provider||""),h(o.data.auto_reports),b(o.data.auto_remediation))}catch(o){l.error("Failed to load AI configuration"),console.error(o)}finally{P(!1)}},X=async o=>{var $,W;o.preventDefault(),f(!0),p(null);try{const N={provider:i,model:A||void 0,anthropic_api_key:j||void 0,openai_api_key:S||void 0,ollama_base_url:T||void 0,ollama_model:z||void 0,fallback_provider:O||void 0,auto_reports:k,auto_remediation:R},q=await Je.updateConfiguration(N);M(q.data),l.success("AI configuration saved successfully"),C(""),u("")}catch(N){const q=N;l.error(((W=($=q.response)==null?void 0:$.data)==null?void 0:W.error)||"Failed to save configuration")}finally{f(!1)}},c=async()=>{var o,$;y(!0),p(null);try{const W=await Je.testConnection();p({success:W.data.success,message:W.data.message,responseTime:W.data.response_time_ms||void 0}),W.data.success?l.success("Connection test successful!"):l.warning("Connection test failed")}catch(W){p({success:!1,message:(($=(o=W.response)==null?void 0:o.data)==null?void 0:$.error)||"Connection test failed"}),l.error("Connection test failed")}finally{y(!1)}},G=o=>{if(!s)return[];switch(o){case"anthropic":return s.anthropic;case"ollama":return s.ollama;case"openai":return s.openai;default:return[]}},B=o=>t.find($=>$.provider===o);return d?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Zs,{className:"w-6 h-6 text-cyan-400"}),e.jsx("h2",{className:"text-xl font-semibold text-white",children:"AI Configuration"})]}),e.jsxs(E,{variant:"secondary",onClick:Q,disabled:d,className:"flex items-center gap-2",children:[e.jsx(Re,{className:`w-4 h-4 ${d?"animate-spin":""}`}),"Refresh"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["anthropic","ollama","openai"].map(o=>{const $=B(o),W=i===o;return e.jsxs(H,{className:`cursor-pointer transition-all ${W?"ring-2 ring-cyan-500 bg-gray-800/80":"hover:bg-gray-800/60"}`,onClick:()=>{D(o),V("")},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5 text-cyan-400"}),e.jsx("span",{className:"font-medium text-white capitalize",children:o})]}),$!=null&&$.available?e.jsxs(te,{variant:"success",className:"flex items-center gap-1",children:[e.jsx(de,{className:"w-3 h-3"}),"Available"]}):e.jsxs(te,{variant:"danger",className:"flex items-center gap-1",children:[e.jsx(ke,{className:"w-3 h-3"}),"Not Configured"]})]}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-1",children:[e.jsxs("div",{children:["Model: ",($==null?void 0:$.model)||"Not set"]}),e.jsx("div",{className:"flex items-center gap-2",children:($==null?void 0:$.streaming)&&e.jsxs(te,{variant:"primary",className:"text-xs",children:[e.jsx($s,{className:"w-3 h-3 mr-1"}),"Streaming"]})})]}),W&&e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-700",children:e.jsx("span",{className:"text-xs text-cyan-400",children:"Selected"})})]},o)})}),e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Xs,{className:"w-5 h-5 text-cyan-400"}),e.jsx("h3",{className:"text-lg font-medium text-white",children:"Provider Settings"})]}),e.jsxs("form",{onSubmit:X,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Model"}),e.jsxs("select",{value:A,onChange:o=>V(o.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a model"}),G(i).map(o=>e.jsxs("option",{value:o.id,children:[o.name," ",o.description&&`- ${o.description}`]},o.id))]})]}),i==="anthropic"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[e.jsx(Me,{className:"w-4 h-4 inline mr-2"}),"Anthropic API Key",(g==null?void 0:g.has_anthropic_key)&&e.jsx(te,{variant:"success",className:"ml-2 text-xs",children:"Configured"})]}),e.jsx(J,{type:"password",value:j,onChange:o=>C(o.target.value),placeholder:g!=null&&g.has_anthropic_key?"":"sk-ant-...",className:"font-mono"}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Leave blank to keep existing key. Get your key from"," ",e.jsx("a",{href:"https://console.anthropic.com/",target:"_blank",rel:"noopener noreferrer",className:"text-cyan-400 hover:underline",children:"console.anthropic.com"})]})]}),i==="openai"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[e.jsx(Me,{className:"w-4 h-4 inline mr-2"}),"OpenAI API Key",(g==null?void 0:g.has_openai_key)&&e.jsx(te,{variant:"success",className:"ml-2 text-xs",children:"Configured"})]}),e.jsx(J,{type:"password",value:S,onChange:o=>u(o.target.value),placeholder:g!=null&&g.has_openai_key?"":"sk-...",className:"font-mono"}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Leave blank to keep existing key. Get your key from"," ",e.jsx("a",{href:"https://platform.openai.com/",target:"_blank",rel:"noopener noreferrer",className:"text-cyan-400 hover:underline",children:"platform.openai.com"})]})]}),i==="ollama"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[e.jsx(ge,{className:"w-4 h-4 inline mr-2"}),"Ollama Base URL"]}),e.jsx(J,{type:"url",value:T,onChange:o=>I(o.target.value),placeholder:"http://localhost:11434",className:"font-mono"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"The URL where your Ollama server is running (default: http://localhost:11434)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Custom Model Name (Optional)"}),e.jsx(J,{type:"text",value:z,onChange:o=>L(o.target.value),placeholder:"llama3:8b",className:"font-mono"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Override the model selection above with a custom Ollama model name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Fallback Provider (Optional)"}),e.jsxs("select",{value:O,onChange:o=>w(o.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"None"}),["anthropic","ollama","openai"].filter(o=>o!==i).map(o=>e.jsx("option",{value:o,children:o.charAt(0).toUpperCase()+o.slice(1)},o))]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Used when primary provider is unavailable"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"autoReports",checked:k,onChange:o=>h(o.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-cyan-500 focus:ring-cyan-500 focus:ring-offset-gray-800"}),e.jsx("label",{htmlFor:"autoReports",className:"text-sm text-gray-300",children:"Enable AI-generated executive reports"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"autoRemediation",checked:R,onChange:o=>b(o.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-cyan-500 focus:ring-cyan-500 focus:ring-offset-gray-800"}),e.jsx("label",{htmlFor:"autoRemediation",className:"text-sm text-gray-300",children:"Enable AI-assisted remediation guidance"})]})]}),m&&e.jsxs("div",{className:`p-4 rounded-lg ${m.success?"bg-green-900/30 border border-green-700":"bg-red-900/30 border border-red-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[m.success?e.jsx(de,{className:"w-5 h-5 text-green-400"}):e.jsx(ke,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:m.success?"text-green-400":"text-red-400",children:m.success?"Connection Successful":"Connection Failed"})]}),e.jsx("p",{className:"text-sm text-gray-400",children:m.message}),m.responseTime&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Response time: ",m.responseTime,"ms"]})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-700",children:[e.jsxs(E,{type:"submit",disabled:_,className:"flex items-center gap-2",children:[e.jsx(Ce,{className:`w-4 h-4 ${_?"animate-spin":""}`}),_?"Saving...":"Save Configuration"]}),e.jsxs(E,{type:"button",variant:"secondary",onClick:c,disabled:v,className:"flex items-center gap-2",children:[e.jsx(vs,{className:`w-4 h-4 ${v?"animate-pulse":""}`}),v?"Testing...":"Test Connection"]})]})]})]}),g&&e.jsxs(H,{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Current Configuration"}),e.jsxs("dl",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-400",children:"Active Provider"}),e.jsx("dd",{className:"text-white font-medium capitalize",children:g.provider})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-400",children:"Active Model"}),e.jsx("dd",{className:"text-white font-medium",children:g.model})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-400",children:"Anthropic Key"}),e.jsx("dd",{children:g.has_anthropic_key?e.jsx(te,{variant:"success",children:"Configured"}):e.jsx(te,{variant:"warning",children:"Not Set"})})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-400",children:"OpenAI Key"}),e.jsx("dd",{children:g.has_openai_key?e.jsx(te,{variant:"success",children:"Configured"}):e.jsx(te,{variant:"warning",children:"Not Set"})})]}),g.ollama_base_url&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("dt",{className:"text-gray-400",children:"Ollama URL"}),e.jsx("dd",{className:"text-white font-mono text-xs",children:g.ollama_base_url})]}),g.updated_at&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("dt",{className:"text-gray-400",children:"Last Updated"}),e.jsx("dd",{className:"text-white",children:new Date(g.updated_at).toLocaleString()})]})]})]})]})},Oa=()=>{const[d,P]=r.useState("profile"),_=[{name:"Account",tabs:[{id:"profile",label:"Profile",icon:e.jsx(us,{className:"h-4 w-4"}),component:e.jsx(Ot,{})},{id:"security",label:"Security",icon:e.jsx(es,{className:"h-4 w-4"}),component:e.jsx(aa,{})},{id:"api-keys",label:"API Keys",icon:e.jsx(Me,{className:"h-4 w-4"}),component:e.jsx(ra,{})}]},{name:"Administration",tabs:[{id:"administration",label:"Users",icon:e.jsx(ue,{className:"h-4 w-4"}),component:e.jsx($t,{})},{id:"sso",label:"SSO",icon:e.jsx(Ts,{className:"h-4 w-4"}),component:e.jsx(fa,{})},{id:"ai-configuration",label:"AI Settings",icon:e.jsx(Zs,{className:"h-4 w-4"}),component:e.jsx(va,{})}]},{name:"Scanning",tabs:[{id:"target-groups",label:"Target Groups",icon:e.jsx(Ms,{className:"h-4 w-4"}),component:e.jsx(Gt,{})},{id:"exclusions",label:"Exclusions",icon:e.jsx(Vs,{className:"h-4 w-4"}),component:e.jsx(Wt,{})},{id:"scheduled-scans",label:"Scheduled Scans",icon:e.jsx(je,{className:"h-4 w-4"}),component:e.jsx(zt,{})},{id:"scheduled-reports",label:"Scheduled Reports",icon:e.jsx(Te,{className:"h-4 w-4"}),component:e.jsx(ha,{})},{id:"templates",label:"Scan Templates",icon:e.jsx(Ie,{className:"h-4 w-4"}),component:e.jsx(Bt,{})},{id:"finding-templates",label:"Finding Templates",icon:e.jsx(zs,{className:"h-4 w-4"}),component:e.jsx(Ht,{})},{id:"vpn",label:"VPN",icon:e.jsx(Ws,{className:"h-4 w-4"}),component:e.jsx(oa,{})},{id:"agents",label:"Agents",icon:e.jsx(ge,{className:"h-4 w-4"}),component:e.jsx(da,{})},{id:"compare-scans",label:"Compare",icon:e.jsx(Rt,{className:"h-4 w-4"}),component:e.jsx(Lt,{})}]},{name:"Integrations",tabs:[{id:"notifications",label:"Notifications",icon:e.jsx(Us,{className:"h-4 w-4"}),component:e.jsx(Vt,{})},{id:"webhooks",label:"Webhooks",icon:e.jsx(Js,{className:"h-4 w-4"}),component:e.jsx(pa,{})},{id:"jira-integration",label:"JIRA",icon:e.jsx(ss,{className:"h-4 w-4"}),component:e.jsx(la,{})},{id:"servicenow-integration",label:"ServiceNow",icon:e.jsx(qs,{className:"h-4 w-4"}),component:e.jsx(na,{})},{id:"siem-integration",label:"SIEM",icon:e.jsx(Hs,{className:"h-4 w-4"}),component:e.jsx(ia,{})},{id:"cicd",label:"CI/CD",icon:e.jsx(Ys,{className:"h-4 w-4"}),component:e.jsx(ga,{})}]}],v=_.flatMap(y=>y.tabs).find(y=>y.id===d);return e.jsx(bt,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(cs,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Settings"})]}),e.jsx("p",{className:"text-slate-400",children:"Manage your account, scanning configuration, and integrations"})]}),e.jsx("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:e.jsx("div",{className:"flex flex-wrap gap-6",children:_.map(y=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:y.name}),e.jsx("div",{className:"flex gap-1",children:y.tabs.map(g=>e.jsxs("button",{onClick:()=>P(g.id),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${d===g.id?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[g.icon,g.label]},g.id))})]},y.name))})}),e.jsx("div",{children:v==null?void 0:v.component})]})})};export{Oa as default};
