import{j as e}from"./vendor-state-BeiY7NuG.js";import{u as _,r}from"./vendor-react-B7quoyFx.js";import{l as y,c as A}from"./index-CLUXwptY.js";import{d as x,j as L,n as C,a6 as D,A as F,u as O}from"./vendor-ui-CIfVO3s3.js";import"./vendor-charts-Bc9tqyL6.js";const I=()=>{_();const[p,u]=r.useState([]),[j,o]=r.useState(!0),[g,c]=r.useState(""),[m,b]=r.useState(""),[l,N]=r.useState(""),[s,v]=r.useState(null),[k,n]=r.useState(!1);r.useEffect(()=>{f()},[l]);const f=async()=>{var t,a;try{o(!0);const d=new URLSearchParams;l&&d.append("status",l);const i=await y.get(`/assets?${d.toString()}`);u(i.data),c("")}catch(d){c(((a=(t=d.response)==null?void 0:t.data)==null?void 0:a.error)||"Failed to fetch assets")}finally{o(!1)}},w=async t=>{var a,d;try{const i=await y.get(`/assets/${t}`);v(i.data),n(!0)}catch(i){c(((d=(a=i.response)==null?void 0:a.data)==null?void 0:d.error)||"Failed to fetch asset details")}},h=p.filter(t=>{const a=m.toLowerCase();return t.ip_address.includes(a)||t.hostname&&t.hostname.toLowerCase().includes(a)||t.os_family&&t.os_family.toLowerCase().includes(a)}),S=t=>{try{return JSON.parse(t)}catch{return[]}};return e.jsx(A,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center",children:[e.jsx(x,{className:"h-8 w-8 mr-3 text-blue-600"}),"Asset Inventory"]}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Track and manage discovered network assets across scans"})]}),g&&e.jsx("div",{className:"mb-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 px-4 py-3 rounded",children:g}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by IP, hostname, or OS...",value:m,onChange:t=>b(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5 text-gray-400"}),e.jsxs("select",{value:l,onChange:t=>N(t.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]})}),j?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Asset"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Operating System"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Last Seen"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Scans"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:h.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(x,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-lg",children:"No assets found"}),e.jsx("p",{className:"text-sm mt-2",children:"Run a scan to discover network assets"})]})}):h.map(t=>(S(t.tags),e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer",onClick:()=>w(t.id),children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(x,{className:"h-5 w-5 text-blue-600 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.ip_address}),t.hostname&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.hostname})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:t.os_family||"Unknown"}),t.os_version&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.os_version})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(D,{className:"h-4 w-4 mr-1"}),new Date(t.last_seen).toLocaleDateString()]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center text-sm text-gray-900 dark:text-white",children:[e.jsx(F,{className:"h-4 w-4 mr-1"}),t.scan_count]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.status==="active"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:e.jsx(O,{className:"h-5 w-5"})})})]},t.id)))})]})}),k&&s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.asset.ip_address}),s.asset.hostname&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:s.asset.hostname})]}),e.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Operating System"}),e.jsxs("p",{className:"text-gray-900 dark:text-white",children:[s.asset.os_family||"Unknown",s.asset.os_version&&` ${s.asset.os_version}`]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"MAC Address"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:s.asset.mac_address||"N/A"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"First Seen"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:new Date(s.asset.first_seen).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Last Seen"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:new Date(s.asset.last_seen).toLocaleString()})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Open Ports"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:s.ports.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No ports recorded"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:s.ports.map(t=>e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded p-3 border border-gray-200 dark:border-gray-600",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[t.port,"/",t.protocol]}),t.service_name&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.service_name}),t.service_version&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:t.service_version})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${t.current_state==="open"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}`,children:t.current_state})]})},t.id))})})]}),e.jsx("div",{className:"flex justify-end gap-3",children:e.jsx("button",{onClick:()=>n(!1),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Close"})})]})]})})]})})})};export{I as default};
