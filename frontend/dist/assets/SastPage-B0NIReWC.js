import{b as L,u as N,d as f,j as e}from"./vendor-state-BjT_zREg.js";import{r as m}from"./vendor-react-5KxtEOLM.js";import{N as P,m as E,a9 as v,g as q,aN as V,ab as $,aO as C,B as u,aY as W,c7 as M,Z as w,_ as Y,az as K,bg as F,l as G,$ as H,b as J,b1 as A,y as Z,h as B,p as X,O as z,bL as ee,s as te,ao as se,S as ae,a as re,K as le}from"./vendor-ui-CaTPr3iI.js";import{L as ne}from"./Layout-DF6EApG0.js";import{af as h}from"./index-BgPDfr41.js";import"./vendor-markdown-BGP8SuZQ.js";import"./vendor-utils-DfRopTPV.js";function Q({status:s}){const r={pending:"bg-yellow-900/50 text-yellow-300 border border-yellow-700",running:"bg-cyan-900/50 text-cyan-300 border border-cyan-700",completed:"bg-green-900/50 text-green-300 border border-green-700",failed:"bg-red-900/50 text-red-300 border border-red-700",open:"bg-blue-900/50 text-blue-300 border border-blue-700",confirmed:"bg-red-900/50 text-red-300 border border-red-700",false_positive:"bg-gray-700 text-gray-300 border border-gray-600",fixed:"bg-green-900/50 text-green-300 border border-green-700"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${r[s]||r.pending}`,children:s.replace("_"," ").charAt(0).toUpperCase()+s.replace("_"," ").slice(1)})}function T({severity:s}){const r={critical:"bg-red-900/50 text-red-300 border border-red-700",high:"bg-orange-900/50 text-orange-300 border border-orange-700",medium:"bg-yellow-900/50 text-yellow-300 border border-yellow-700",low:"bg-blue-900/50 text-blue-300 border border-blue-700",info:"bg-gray-700 text-gray-300 border border-gray-600"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${r[s]||r.info}`,children:s.charAt(0).toUpperCase()+s.slice(1)})}function D({priority:s}){const r={high:"bg-red-900/50 text-red-300 border border-red-700",medium:"bg-yellow-900/50 text-yellow-300 border border-yellow-700",low:"bg-blue-900/50 text-blue-300 border border-blue-700"};return e.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${r[s]||"bg-gray-700 text-gray-300"}`,children:[s.charAt(0).toUpperCase()+s.slice(1)," Priority"]})}function ie({resolution:s}){const r={to_review:"bg-yellow-900/50 text-yellow-300",vulnerability:"bg-red-900/50 text-red-300",safe:"bg-green-900/50 text-green-300",acknowledged:"bg-blue-900/50 text-blue-300",fixed:"bg-green-900/50 text-green-300"},x={to_review:"To Review",vulnerability:"Vulnerability",safe:"Safe",acknowledged:"Acknowledged",fixed:"Fixed"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${r[s]||"bg-gray-700 text-gray-300"}`,children:x[s]||s})}function ce({category:s}){return{authentication:e.jsx(le,{className:"w-4 h-4"}),authorization:e.jsx(re,{className:"w-4 h-4"}),cryptography:e.jsx(ae,{className:"w-4 h-4"}),input_validation:e.jsx(z,{className:"w-4 h-4"}),injection_prevention:e.jsx(K,{className:"w-4 h-4"}),sensitive_data:e.jsx(se,{className:"w-4 h-4"}),configuration:e.jsx(te,{className:"w-4 h-4"}),file_operations:e.jsx(ee,{className:"w-4 h-4"})}[s]||e.jsx(B,{className:"w-4 h-4"})}function de({isOpen:s,onClose:r,onCreate:x}){const[l,n]=m.useState(""),[i,c]=m.useState(""),[d,o]=m.useState("git"),[b,y]=m.useState("");if(!s)return null;const g=t=>{t.preventDefault(),x({project_name:l,language:i||void 0,source_type:d,source_path:b}),n(""),c(""),o("git"),y(""),r()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Start SAST Scan"}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Project Name *"}),e.jsx("input",{type:"text",value:l,onChange:t=>n(t.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"my-web-app"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Language"}),e.jsxs("select",{value:i,onChange:t=>c(t.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"",children:"Auto-detect"}),e.jsx("option",{value:"javascript",children:"JavaScript/TypeScript"}),e.jsx("option",{value:"python",children:"Python"}),e.jsx("option",{value:"java",children:"Java"}),e.jsx("option",{value:"go",children:"Go"}),e.jsx("option",{value:"rust",children:"Rust"}),e.jsx("option",{value:"kotlin",children:"Kotlin"}),e.jsx("option",{value:"scala",children:"Scala"}),e.jsx("option",{value:"swift",children:"Swift"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Source Type"}),e.jsxs("select",{value:d,onChange:t=>o(t.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"git",children:"Git Repository"}),e.jsx("option",{value:"path",children:"Local Path"}),e.jsx("option",{value:"upload",children:"Upload Archive"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:[d==="git"?"Repository URL":d==="path"?"Path":"Archive Path"," *"]}),e.jsx("input",{type:"text",value:b,onChange:t=>y(t.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:d==="git"?"https://github.com/org/repo":"/path/to/code"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:"Start Scan"})]})]})]})})}function oe({isOpen:s,onClose:r,onImport:x}){const[l,n]=m.useState("");if(!s)return null;const i=c=>{c.preventDefault(),x(l),n(""),r()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Import Semgrep Rules"}),e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Paste Semgrep YAML Rules"}),e.jsx("textarea",{value:l,onChange:c=>n(c.target.value),required:!0,rows:15,className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded text-white font-mono text-sm focus:outline-none focus:border-cyan-500",placeholder:`rules:
  - id: detect-sql-injection
    pattern: $QUERY = "SELECT * FROM users WHERE id = " + $INPUT
    message: Potential SQL injection vulnerability
    severity: ERROR
    languages: [python, javascript]`})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:"Import Rules"})]})]})]})})}function xe({hotspot:s,onClose:r,onUpdate:x}){const[l,n]=m.useState(s.resolution),[i,c]=m.useState(s.review_comment||""),d=o=>{o.preventDefault(),x(s.id,l,i),r()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl border border-gray-700 max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Review Security Hotspot"}),e.jsxs("div",{className:"mb-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{priority:s.priority}),e.jsx("span",{className:"text-gray-400 capitalize",children:s.category.replace("_"," ")})]}),e.jsx("h3",{className:"text-white font-medium",children:s.message}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx(F,{className:"w-4 h-4"}),s.file_path,":",s.line_number]})]}),s.code_snippet&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"Code"}),e.jsx("pre",{className:"text-sm bg-gray-900 p-3 rounded overflow-x-auto text-gray-300 font-mono",children:s.code_snippet})]}),e.jsxs("div",{className:"mb-4 p-3 bg-gray-900 rounded border border-gray-700",children:[e.jsx("h4",{className:"text-sm font-medium text-cyan-400 mb-2",children:"Security Context"}),e.jsx("p",{className:"text-sm text-gray-300",children:s.security_context})]}),e.jsxs("div",{className:"mb-4 p-3 bg-gray-900 rounded border border-gray-700",children:[e.jsx("h4",{className:"text-sm font-medium text-green-400 mb-2",children:"Review Guidance"}),e.jsx("p",{className:"text-sm text-gray-300",children:s.review_guidance})]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Resolution"}),e.jsxs("select",{value:l,onChange:o=>n(o.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"to_review",children:"To Review"}),e.jsx("option",{value:"vulnerability",children:"Confirmed Vulnerability"}),e.jsx("option",{value:"safe",children:"Safe - Not a Vulnerability"}),e.jsx("option",{value:"acknowledged",children:"Acknowledged - Risk Accepted"}),e.jsx("option",{value:"fixed",children:"Fixed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Review Comment"}),e.jsx("textarea",{value:i,onChange:o=>c(o.target.value),rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500",placeholder:"Add your review notes..."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:"Save Review"})]})]})]})})}function me({scanId:s,projectName:r,onBack:x}){const l=L(),[n,i]=m.useState("findings"),[c,d]=m.useState(null),[o,b]=m.useState("all"),[y,g]=m.useState(null),{data:t,isLoading:S}=N({queryKey:["sast-findings",s],queryFn:()=>h.getSastFindings(s).then(a=>a.data)}),{data:p,isLoading:I}=N({queryKey:["taint-flows",s],queryFn:()=>h.getTaintFlows(s).then(a=>a.data),enabled:n==="taint"}),{data:j,isLoading:U}=N({queryKey:["hotspots",s],queryFn:()=>h.getHotspots(s).then(a=>a.data),enabled:n==="hotspots"}),O=f({mutationFn:({id:a,resolution:k,comment:R})=>h.updateHotspot(a,{resolution:k,comment:R}),onSuccess:()=>{l.invalidateQueries({queryKey:["hotspots",s]}),u.success("Hotspot updated")},onError:()=>u.error("Failed to update hotspot")}),_=t==null?void 0:t.filter(a=>o==="all"||a.severity===o);return e.jsxs("div",{children:[e.jsxs("button",{onClick:x,className:"flex items-center gap-2 text-gray-400 hover:text-gray-200 mb-4",children:[e.jsx(Y,{className:"w-4 h-4 rotate-180"}),"Back to Scans"]}),e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:r}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Scan Analysis Results"})]})}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>i("findings"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n==="findings"?"bg-cyan-600 text-white":"bg-gray-800 text-gray-400 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"Findings (",(t==null?void 0:t.length)||0,")"]})}),e.jsx("button",{onClick:()=>i("taint"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n==="taint"?"bg-cyan-600 text-white":"bg-gray-800 text-gray-400 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"}),"Taint Flows (",(p==null?void 0:p.total)||0,")"]})}),e.jsx("button",{onClick:()=>i("hotspots"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n==="hotspots"?"bg-cyan-600 text-white":"bg-gray-800 text-gray-400 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-4 h-4"}),"Hotspots (",(j==null?void 0:j.total)||0,")"]})})]}),n==="findings"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs("select",{value:o,onChange:a=>b(a.target.value),className:"px-3 py-1.5 bg-gray-700 border border-gray-600 rounded text-white text-sm focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})}),S?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(v,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):_&&_.length>0?e.jsx("div",{className:"space-y-3",children:_.map(a=>e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-700/50",onClick:()=>d(c===a.id?null:a.id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(T,{severity:a.severity}),e.jsx("span",{className:"text-white font-medium",children:a.rule_id})]}),e.jsx("p",{className:"text-gray-300",children:a.message}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(F,{className:"w-4 h-4"}),a.file_path,":",a.line_number]}),e.jsx("span",{children:a.category})]})]}),e.jsx(G,{className:`w-5 h-5 text-gray-400 transition-transform ${c===a.id?"rotate-180":""}`})]})}),c===a.id&&e.jsxs("div",{className:"border-t border-gray-700 p-4 bg-gray-900",children:[a.code_snippet&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Code Snippet"}),e.jsx("pre",{className:"text-sm bg-gray-950 p-3 rounded overflow-x-auto text-gray-300 font-mono",children:a.code_snippet})]}),a.remediation&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Remediation"}),e.jsx("p",{className:"text-sm text-gray-300",children:a.remediation})]}),a.cwe_id&&e.jsx("div",{className:"mt-2",children:e.jsxs("a",{href:`https://cwe.mitre.org/data/definitions/${a.cwe_id}.html`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-cyan-400 hover:text-cyan-300 flex items-center gap-1",children:["CWE-",a.cwe_id,e.jsx(H,{className:"w-3 h-3"})]})})]})]},a.id))}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(q,{className:"w-16 h-16 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Findings"}),e.jsx("p",{className:"text-gray-400",children:"No security issues detected in this scan"})]})]}),n==="taint"&&e.jsx(e.Fragment,{children:I?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(v,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):p!=null&&p.flows&&p.flows.length>0?e.jsx("div",{className:"space-y-3",children:p.flows.map(a=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{severity:a.severity}),e.jsx(Q,{status:a.status}),a.is_sanitized&&e.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-green-900/50 text-green-300",children:"Sanitized"})]}),e.jsx("span",{className:"text-sm text-gray-500",children:a.category})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsxs("div",{className:"flex-1 p-3 bg-red-900/20 border border-red-800/50 rounded",children:[e.jsx("div",{className:"text-xs text-red-400 mb-1",children:"Source"}),e.jsx("div",{className:"text-white font-medium",children:a.source.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[a.file_path,":",a.source_line]})]}),e.jsx(J,{className:"w-6 h-6 text-gray-500 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 p-3 bg-orange-900/20 border border-orange-800/50 rounded",children:[e.jsx("div",{className:"text-xs text-orange-400 mb-1",children:"Sink"}),e.jsx("div",{className:"text-white font-medium",children:a.sink.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[a.file_path,":",a.sink_line]})]})]}),a.cwe_id&&e.jsxs("a",{href:`https://cwe.mitre.org/data/definitions/${a.cwe_id}.html`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-cyan-400 hover:text-cyan-300 flex items-center gap-1",children:["CWE-",a.cwe_id,e.jsx(H,{className:"w-3 h-3"})]})]},a.id))}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(C,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Taint Flows"}),e.jsx("p",{className:"text-gray-400",children:"No tainted data flows detected in this scan"})]})}),n==="hotspots"&&e.jsx(e.Fragment,{children:U?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(v,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):j!=null&&j.hotspots&&j.hotspots.length>0?e.jsx("div",{className:"space-y-3",children:j.hotspots.map(a=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700 hover:border-gray-600 cursor-pointer",onClick:()=>g(a),children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-gray-700 rounded",children:e.jsx(ce,{category:a.category})}),e.jsx(D,{priority:a.priority}),e.jsx(ie,{resolution:a.resolution})]})}),e.jsx("h4",{className:"text-white font-medium mb-1",children:a.message}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(F,{className:"w-4 h-4"}),a.file_path,":",a.line_number]}),e.jsx("span",{className:"capitalize",children:a.category.replace("_"," ")})]})]},a.id))}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(w,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Security Hotspots"}),e.jsx("p",{className:"text-gray-400",children:"No security hotspots require review in this scan"})]})}),y&&e.jsx(xe,{hotspot:y,onClose:()=>g(null),onUpdate:(a,k,R)=>O.mutate({id:a,resolution:k,comment:R})})]})}function he(){const s=L(),[r,x]=m.useState(!1),[l,n]=m.useState(""),{data:i,isLoading:c,isError:d,error:o}=N({queryKey:["semgrep-rules"],queryFn:()=>h.listSemgrepRules().then(t=>t.data)}),b=f({mutationFn:h.importSemgrepRules,onSuccess:t=>{s.invalidateQueries({queryKey:["semgrep-rules"]}),u.success(t.data.message)},onError:()=>u.error("Failed to import rules")}),y=f({mutationFn:h.deleteSemgrepRule,onSuccess:()=>{s.invalidateQueries({queryKey:["semgrep-rules"]}),u.success("Rule deleted")},onError:()=>u.error("Failed to delete rule")}),g=i==null?void 0:i.filter(t=>!l||t.name.toLowerCase().includes(l.toLowerCase())||t.rule_id.toLowerCase().includes(l.toLowerCase()));return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Semgrep Rules"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Import and manage custom Semgrep rules"})]}),e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(A,{className:"w-4 h-4"}),"Import Rules"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:l,onChange:t=>n(t.target.value),placeholder:"Search rules...",className:"w-full pl-10 pr-3 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:border-cyan-500"})]}),c?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(v,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):d?e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(B,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"Failed to Load Semgrep Rules"}),e.jsx("p",{className:"text-gray-400 mb-4",children:o instanceof Error?o.message:"An error occurred while fetching Semgrep rules"}),e.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(A,{className:"w-4 h-4"}),"Import Rules"]})]}):g&&g.length>0?e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Rule ID"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Name"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Severity"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Languages"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Category"}),e.jsx("th",{className:"text-right p-4 text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:g.map(t=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"p-4 font-mono text-sm text-cyan-400",children:t.rule_id}),e.jsx("td",{className:"p-4 text-white",children:t.name}),e.jsx("td",{className:"p-4",children:e.jsx(T,{severity:t.severity})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.languages.slice(0,3).map(S=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-300",children:S},S)),t.languages.length>3&&e.jsxs("span",{className:"px-2 py-0.5 text-xs text-gray-500",children:["+",t.languages.length-3]})]})}),e.jsx("td",{className:"p-4 text-gray-300",children:t.category}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("button",{onClick:()=>y.mutate(t.id),className:"p-2 hover:bg-gray-700 rounded text-red-400 hover:text-red-300",children:e.jsx($,{className:"w-4 h-4"})})})]},t.id))})]})}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(M,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Semgrep Rules"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Import Semgrep rules to enhance your SAST scanning"}),e.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(A,{className:"w-4 h-4"}),"Import Rules"]})]}),e.jsx(oe,{isOpen:r,onClose:()=>x(!1),onImport:t=>b.mutate(t)})]})}function ge(){var x;const{data:s,isLoading:r}=N({queryKey:["hotspot-stats"],queryFn:()=>h.getHotspotStats().then(l=>l.data)});return r?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(v,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):s?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Security Hotspots Overview"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsx("div",{className:"p-2 bg-gray-700 rounded",children:e.jsx(w,{className:"w-5 h-5 text-yellow-400"})})}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Total Hotspots"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:s.total})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsx("div",{className:"p-2 bg-gray-700 rounded",children:e.jsx(X,{className:"w-5 h-5 text-yellow-400"})})}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Pending Review"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:s.pending_review})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsx("div",{className:"p-2 bg-gray-700 rounded",children:e.jsx(q,{className:"w-5 h-5 text-green-400"})})}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Reviewed"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:s.reviewed})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsx("div",{className:"p-2 bg-gray-700 rounded",children:e.jsx(z,{className:"w-5 h-5 text-red-400"})})}),e.jsx("p",{className:"text-gray-400 text-sm",children:"High Priority"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:((x=s.by_priority)==null?void 0:x.high)||0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"text-white font-medium mb-4",children:"By Priority"}),e.jsx("div",{className:"space-y-3",children:["high","medium","low"].map(l=>{var d;const n=((d=s.by_priority)==null?void 0:d[l])||0,i=s.total>0?n/s.total*100:0,c={high:"bg-red-500",medium:"bg-yellow-500",low:"bg-blue-500"};return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-20 text-sm text-gray-400 capitalize",children:l}),e.jsx("div",{className:"flex-1 h-4 bg-gray-700 rounded overflow-hidden",children:e.jsx("div",{className:`h-full ${c[l]} transition-all duration-300`,style:{width:`${i}%`}})}),e.jsx("div",{className:"w-12 text-right text-sm font-medium text-white",children:n})]},l)})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"text-white font-medium mb-4",children:"By Resolution"}),e.jsx("div",{className:"space-y-3",children:["to_review","vulnerability","safe","acknowledged","fixed"].map(l=>{var o;const n=((o=s.by_resolution)==null?void 0:o[l])||0,i=s.total>0?n/s.total*100:0,c={to_review:"bg-yellow-500",vulnerability:"bg-red-500",safe:"bg-green-500",acknowledged:"bg-blue-500",fixed:"bg-green-500"},d={to_review:"To Review",vulnerability:"Vulnerability",safe:"Safe",acknowledged:"Acknowledged",fixed:"Fixed"};return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-24 text-sm text-gray-400",children:d[l]}),e.jsx("div",{className:"flex-1 h-4 bg-gray-700 rounded overflow-hidden",children:e.jsx("div",{className:`h-full ${c[l]} transition-all duration-300`,style:{width:`${i}%`}})}),e.jsx("div",{className:"w-12 text-right text-sm font-medium text-white",children:n})]},l)})})]})]})]})}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(w,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Hotspot Data"}),e.jsx("p",{className:"text-gray-400",children:"Run a SAST scan to detect security hotspots"})]})}function fe(){const s=L(),[r,x]=m.useState("scans"),[l,n]=m.useState(!1),[i,c]=m.useState(null),{data:d,isLoading:o}=N({queryKey:["sast-scans"],queryFn:()=>h.listSastScans().then(t=>t.data),enabled:r==="scans"}),b=f({mutationFn:h.startSastScan,onSuccess:()=>{s.invalidateQueries({queryKey:["sast-scans"]}),u.success("SAST scan started")},onError:()=>u.error("Failed to start SAST scan")}),y=f({mutationFn:h.deleteSastScan,onSuccess:()=>{s.invalidateQueries({queryKey:["sast-scans"]}),u.success("Scan deleted")},onError:()=>u.error("Failed to delete scan")}),g=[{id:"scans",label:"Scans",icon:e.jsx(W,{className:"w-4 h-4"})},{id:"semgrep",label:"Semgrep Rules",icon:e.jsx(M,{className:"w-4 h-4"})},{id:"taint",label:"Taint Analysis",icon:e.jsx(C,{className:"w-4 h-4"})},{id:"hotspots",label:"Hotspots",icon:e.jsx(w,{className:"w-4 h-4"})}];return e.jsx(ne,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"h-8 w-8 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"SAST Scanner"}),e.jsx("p",{className:"text-gray-400",children:"Static Application Security Testing"})]})]})}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:g.map(t=>e.jsxs("button",{onClick:()=>{x(t.id),c(null)},className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${r===t.id?"border-cyan-500 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[t.icon,t.label]},t.id))})}),e.jsxs("div",{children:[r==="scans"&&e.jsx("div",{children:i?e.jsx(me,{scanId:i.id,projectName:i.name,onBack:()=>c(null)}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"SAST Scans"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Analyze source code for security vulnerabilities"})]}),e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(E,{className:"w-4 h-4"}),"Start Scan"]})]}),o?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx(v,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):d&&d.length>0?e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Project"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Language"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Findings"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Date"}),e.jsx("th",{className:"text-right p-4 text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:d.map(t=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-medium text-white",children:t.project_name}),e.jsx("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:t.source_path})]}),e.jsx("td",{className:"p-4 text-gray-300",children:t.language||"Auto"}),e.jsx("td",{className:"p-4",children:e.jsx(Q,{status:t.status})}),e.jsx("td",{className:"p-4",children:t.status==="completed"&&e.jsxs("div",{className:"flex items-center gap-2",children:[t.critical_count>0&&e.jsxs("span",{className:"text-red-400",children:[t.critical_count,"C"]}),t.high_count>0&&e.jsxs("span",{className:"text-orange-400",children:[t.high_count,"H"]}),t.medium_count>0&&e.jsxs("span",{className:"text-yellow-400",children:[t.medium_count,"M"]}),t.low_count>0&&e.jsxs("span",{className:"text-blue-400",children:[t.low_count,"L"]}),t.finding_count===0&&e.jsx(q,{className:"w-4 h-4 text-green-400"})]})}),e.jsx("td",{className:"p-4 text-gray-500 text-sm",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>c({id:t.id,name:t.project_name}),className:"p-2 hover:bg-gray-700 rounded text-gray-400 hover:text-white",children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>y.mutate(t.id),className:"p-2 hover:bg-gray-700 rounded text-red-400 hover:text-red-300",children:e.jsx($,{className:"w-4 h-4"})})]})})]},t.id))})]})}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 text-center border border-gray-700",children:[e.jsx(P,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No SAST Scans"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Start scanning your source code for security vulnerabilities"}),e.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors",children:[e.jsx(E,{className:"w-4 h-4"}),"Start First Scan"]})]})]})}),r==="semgrep"&&e.jsx(he,{}),r==="taint"&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 text-center border border-gray-700",children:[e.jsx(C,{className:"w-16 h-16 text-cyan-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Taint Analysis"}),e.jsx("p",{className:"text-gray-400 mb-4 max-w-md mx-auto",children:"Taint analysis tracks how untrusted data flows through your application to detect injection vulnerabilities."}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Run a SAST scan to view taint analysis results for that scan."})]}),r==="hotspots"&&e.jsx(ge,{})]}),e.jsx(de,{isOpen:l,onClose:()=>n(!1),onCreate:t=>b.mutate(t)})]})})}export{fe as default};
