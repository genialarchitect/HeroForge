import{j as e}from"./vendor-state-DNqmiQl8.js";import{r}from"./vendor-react-CGkJ0Xct.js";import{p as j,c as S,B as _}from"./index-0dhaz_OO.js";import{d as x,l as A,p as C,a8 as L,A as D,w as F,X as $}from"./vendor-ui-DumwyYvD.js";import"./vendor-charts-XjGtNRJN.js";const T=()=>{const[u,f]=r.useState([]),[N,o]=r.useState(!0),[m,d]=r.useState(""),[h,v]=r.useState(""),[c,b]=r.useState(""),[t,g]=r.useState(null),[w,n]=r.useState(!1);r.useEffect(()=>{y()},[c]);const y=async()=>{var s,a;try{o(!0);const l=new URLSearchParams;c&&l.append("status",c);const i=await j.get(`/assets?${l.toString()}`);f(i.data),d("")}catch(l){d(((a=(s=l.response)==null?void 0:s.data)==null?void 0:a.error)||"Failed to fetch assets")}finally{o(!1)}},k=async s=>{var a,l;try{const i=await j.get(`/assets/${s}`);g(i.data),n(!0)}catch(i){d(((l=(a=i.response)==null?void 0:a.data)==null?void 0:l.error)||"Failed to fetch asset details")}},p=u.filter(s=>{const a=h.toLowerCase();return s.ip_address.includes(a)||s.hostname&&s.hostname.toLowerCase().includes(a)||s.os_family&&s.os_family.toLowerCase().includes(a)});return e.jsx(S,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center",children:[e.jsx(x,{className:"h-8 w-8 mr-3 text-primary"}),"Asset Inventory"]}),e.jsx("p",{className:"mt-2 text-slate-400",children:"Track and manage discovered network assets across scans"})]}),m&&e.jsx("div",{className:"bg-severity-critical/20 border border-severity-critical/50 text-severity-critical px-4 py-3 rounded-lg",children:m}),e.jsx("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search by IP, hostname, or OS...",value:h,onChange:s=>v(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-dark-border rounded-lg bg-dark-bg text-white placeholder-slate-500 focus:ring-2 focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5 text-slate-400"}),e.jsxs("select",{value:c,onChange:s=>b(s.target.value),className:"px-4 py-2 border border-dark-border rounded-lg bg-dark-bg text-white focus:ring-2 focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]})}),N?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):e.jsx("div",{className:"bg-dark-surface rounded-lg border border-dark-border overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-dark-border",children:[e.jsx("thead",{className:"bg-dark-bg",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Asset"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Operating System"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Last Seen"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Scans"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-dark-surface divide-y divide-dark-border",children:p.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center text-slate-400",children:[e.jsx(x,{className:"h-12 w-12 mx-auto mb-4 text-slate-500"}),e.jsx("p",{className:"text-lg",children:"No assets found"}),e.jsx("p",{className:"text-sm mt-2",children:"Run a scan to discover network assets"})]})}):p.map(s=>e.jsxs("tr",{className:"hover:bg-dark-hover cursor-pointer",onClick:()=>k(s.id),children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(x,{className:"h-5 w-5 text-primary mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:s.ip_address}),s.hostname&&e.jsx("div",{className:"text-sm text-slate-400",children:s.hostname})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-white",children:s.os_family||"Unknown"}),s.os_version&&e.jsx("div",{className:"text-sm text-slate-400",children:s.os_version})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center text-sm text-slate-400",children:[e.jsx(L,{className:"h-4 w-4 mr-1"}),new Date(s.last_seen).toLocaleDateString()]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center text-sm text-white",children:[e.jsx(D,{className:"h-4 w-4 mr-1"}),s.scan_count]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.status==="active"?"bg-status-completed/20 text-status-completed":"bg-dark-border text-slate-300"}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("button",{className:"text-primary hover:text-primary-light",children:e.jsx(F,{className:"h-5 w-5"})})})]},s.id))})]})}),w&&t&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-dark-border",children:[e.jsx("div",{className:"p-6 border-b border-dark-border",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:t.asset.ip_address}),t.asset.hostname&&e.jsx("p",{className:"text-slate-400 mt-1",children:t.asset.hostname})]}),e.jsx("button",{onClick:()=>n(!1),className:"text-slate-400 hover:text-white",children:e.jsx($,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-400 mb-2",children:"Operating System"}),e.jsxs("p",{className:"text-white",children:[t.asset.os_family||"Unknown",t.asset.os_version&&` ${t.asset.os_version}`]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-400 mb-2",children:"MAC Address"}),e.jsx("p",{className:"text-white",children:t.asset.mac_address||"N/A"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-400 mb-2",children:"First Seen"}),e.jsx("p",{className:"text-white",children:new Date(t.asset.first_seen).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-400 mb-2",children:"Last Seen"}),e.jsx("p",{className:"text-white",children:new Date(t.asset.last_seen).toLocaleString()})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Open Ports"}),e.jsx("div",{className:"bg-dark-bg rounded-lg p-4",children:t.ports.length===0?e.jsx("p",{className:"text-slate-400",children:"No ports recorded"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:t.ports.map(s=>e.jsx("div",{className:"bg-dark-surface rounded p-3 border border-dark-border",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-white",children:[s.port,"/",s.protocol]}),s.service_name&&e.jsx("p",{className:"text-sm text-slate-400",children:s.service_name}),s.service_version&&e.jsx("p",{className:"text-xs text-slate-500",children:s.service_version})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${s.current_state==="open"?"bg-port-open/20 text-port-open":"bg-dark-border text-slate-300"}`,children:s.current_state})]})},s.id))})})]}),e.jsx("div",{className:"flex justify-end gap-3",children:e.jsx(_,{variant:"secondary",onClick:()=>n(!1),children:"Close"})})]})]})})]})})};export{T as default};
