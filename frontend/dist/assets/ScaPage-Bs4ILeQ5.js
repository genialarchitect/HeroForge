import{j as e}from"./vendor-state-DdX3IZQk.js";import{r as i}from"./vendor-react-Da1CiaFS.js";import{B as n,a8 as O,aM as v,P as R,aQ as T,aC as E,r as M,ac as V,m as $,aH as U,Q as B}from"./vendor-ui-Cfxa9o3E.js";import{d as F}from"./index-C3P2Oms8.js";import"./vendor-charts-ed8SE4MW.js";const c={getStats:async()=>({total_projects:5,total_dependencies:342,vulnerable_dependencies:23,critical_vulns:2,high_vulns:8,medium_vulns:12,low_vulns:15,license_issues:4,updates_available:45}),getProjects:async()=>[{id:"1",name:"heroforge-backend",repository_url:"https://github.com/org/heroforge",ecosystem:"cargo",manifest_files:["Cargo.toml","Cargo.lock"],last_scan_at:new Date().toISOString(),total_dependencies:156,vulnerable_dependencies:8,license_issues:2,created_at:new Date().toISOString()},{id:"2",name:"heroforge-frontend",repository_url:"https://github.com/org/heroforge-frontend",ecosystem:"npm",manifest_files:["package.json","package-lock.json"],last_scan_at:new Date().toISOString(),total_dependencies:186,vulnerable_dependencies:15,license_issues:2,created_at:new Date().toISOString()}],getDependencies:async a=>[{id:"1",project_id:a,name:"serde",version:"1.0.188",ecosystem:"cargo",purl:"pkg:cargo/serde@1.0.188",is_direct:!0,depth:0,license:"MIT OR Apache-2.0",license_risk:"low",latest_version:"1.0.195",update_available:!0},{id:"2",project_id:a,name:"tokio",version:"1.32.0",ecosystem:"cargo",purl:"pkg:cargo/tokio@1.32.0",is_direct:!0,depth:0,license:"MIT",license_risk:"low",latest_version:"1.35.1",update_available:!0},{id:"3",project_id:a,name:"actix-web",version:"4.4.0",ecosystem:"cargo",purl:"pkg:cargo/actix-web@4.4.0",is_direct:!0,depth:0,license:"MIT OR Apache-2.0",license_risk:"low",latest_version:"4.4.1",update_available:!0}],getVulnerabilities:async a=>[{id:"1",dependency_id:"1",vuln_id:"GHSA-xxxx-yyyy-zzzz",source:"github",severity:"high",cvss_score:8.1,title:"Deserialization vulnerability",description:"A deserialization vulnerability allows remote code execution",fixed_version:"1.0.190",exploited_in_wild:!1,status:"new"},{id:"2",dependency_id:"2",vuln_id:"CVE-2023-12345",source:"nvd",severity:"medium",cvss_score:5.5,title:"Denial of service via resource exhaustion",description:"Resource exhaustion can cause denial of service",fixed_version:"1.33.0",exploited_in_wild:!1,status:"new"}],analyzeProject:async a=>{await new Promise(d=>setTimeout(d,1e3))},generateSbom:async(a,d)=>new Blob(["SBOM content"],{type:"application/json"})},Y=()=>{const[a,d]=i.useState("overview"),[l,b]=i.useState(null),[N,f]=i.useState([]),[t,w]=i.useState(null),[_,S]=i.useState([]),[g,C]=i.useState([]),[k,p]=i.useState(!0),[y,D]=i.useState(""),[H,P]=i.useState(!1),[G,Q]=i.useState(new Set);i.useEffect(()=>{A()},[]);const A=async()=>{try{p(!0);const[s,r]=await Promise.all([c.getStats(),c.getProjects()]);b(s),f(r),r.length>0&&await x(r[0])}catch{n.error("Failed to load SCA data")}finally{p(!1)}},x=async s=>{w(s);try{const[r,o]=await Promise.all([c.getDependencies(s.id),c.getVulnerabilities(s.id)]);S(r),C(o)}catch{n.error("Failed to load project details")}},L=async s=>{try{n.info(`Analyzing ${s.name}...`),await c.analyzeProject(s.id),n.success("Analysis complete!"),await x(s)}catch{n.error("Analysis failed")}},u=async s=>{if(t)try{const r=await c.generateSbom(t.id,s),o=URL.createObjectURL(r),h=document.createElement("a");h.href=o,h.download=`${t.name}-sbom.${s==="cyclonedx"?"json":"spdx.json"}`,h.click(),URL.revokeObjectURL(o),n.success(`SBOM exported as ${s.toUpperCase()}`)}catch{n.error("Failed to export SBOM")}},j=s=>{switch(s.toLowerCase()){case"critical":return"bg-purple-600";case"high":return"bg-red-600";case"medium":return"bg-yellow-600";case"low":return"bg-blue-600";default:return"bg-gray-600"}},z=s=>{switch(s==null?void 0:s.toLowerCase()){case"high":return"text-red-400";case"medium":return"text-yellow-400";case"low":return"text-green-400";default:return"text-gray-400"}},m=s=>{switch(s){case"cargo":return"ðŸ¦€";case"npm":return"ðŸ“¦";case"pypi":return"ðŸ";case"go":return"ðŸ¹";case"maven":return"â˜•";default:return"ðŸ“¦"}},I=_.filter(s=>s.name.toLowerCase().includes(y.toLowerCase()));return e.jsx(F,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(O,{className:"h-8 w-8 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Software Composition Analysis"}),e.jsx("p",{className:"text-gray-400",children:"Analyze dependencies and identify vulnerabilities"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>u("cyclonedx"),className:"flex items-center gap-2 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",disabled:!t,children:[e.jsx(v,{className:"h-4 w-4"}),"CycloneDX"]}),e.jsxs("button",{onClick:()=>u("spdx"),className:"flex items-center gap-2 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",disabled:!t,children:[e.jsx(v,{className:"h-4 w-4"}),"SPDX"]}),e.jsxs("button",{onClick:()=>P(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-500",children:[e.jsx(R,{className:"h-4 w-4"}),"Add Project"]})]})]}),l&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:l.total_projects}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Projects"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:l.total_dependencies}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Dependencies"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:l.vulnerable_dependencies}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Vulnerable"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400",children:l.critical_vulns}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Critical"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:l.high_vulns}),e.jsx("div",{className:"text-gray-400 text-sm",children:"High"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:l.medium_vulns}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Medium"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400",children:l.license_issues}),e.jsx("div",{className:"text-gray-400 text-sm",children:"License Issues"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-cyan-400",children:l.updates_available}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Updates"})]})]}),e.jsx("div",{className:"flex gap-1 mb-6 border-b border-gray-700",children:["overview","projects","dependencies","vulnerabilities"].map(s=>e.jsx("button",{onClick:()=>d(s),className:`px-4 py-2 font-medium capitalize ${a===s?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:s},s))}),k?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(T,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs(e.Fragment,{children:[a==="projects"&&e.jsx("div",{className:"grid gap-4",children:N.map(s=>e.jsx("div",{className:`bg-gray-800 rounded-lg p-4 cursor-pointer border-2 transition-colors ${(t==null?void 0:t.id)===s.id?"border-cyan-500":"border-transparent hover:border-gray-600"}`,onClick:()=>x(s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:m(s.ecosystem)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:s.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[s.ecosystem," â€¢ ",s.total_dependencies," dependencies"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[s.vulnerable_dependencies>0&&e.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.vulnerable_dependencies," vulnerable"]})]}),s.license_issues>0&&e.jsxs("div",{className:"flex items-center gap-2 text-yellow-400",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.license_issues," license issues"]})]}),e.jsx("button",{onClick:r=>{r.stopPropagation(),L(s)},className:"p-2 bg-cyan-600 rounded-lg hover:bg-cyan-500",children:e.jsx(V,{className:"h-4 w-4 text-white"})})]})]})},s.id))}),a==="dependencies"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-4 mb-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search dependencies...",value:y,onChange:s=>D(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white"})]})}),e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Package"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Version"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Latest"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"License"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{children:I.map(s=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:m(s.ecosystem)}),e.jsx("span",{className:"text-white",children:s.name})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.version}),e.jsx("td",{className:"px-4 py-3",children:s.update_available?e.jsx("span",{className:"text-cyan-400",children:s.latest_version}):e.jsx("span",{className:"text-green-400",children:s.version})}),e.jsx("td",{className:`px-4 py-3 ${z(s.license_risk)}`,children:s.license||"Unknown"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.is_direct?"bg-cyan-600 text-white":"bg-gray-600 text-gray-300"}`,children:s.is_direct?"Direct":"Transitive"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{className:"p-1 hover:bg-gray-700 rounded",children:e.jsx(U,{className:"h-4 w-4 text-gray-400"})})})]},s.id))})]})})]}),a==="vulnerabilities"&&e.jsx("div",{className:"space-y-4",children:g.map(s=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs text-white ${j(s.severity)}`,children:s.severity.toUpperCase()}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:s.vuln_id}),e.jsx("p",{className:"text-gray-300 mt-1",children:s.title}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:s.description}),s.fixed_version&&e.jsxs("p",{className:"text-green-400 text-sm mt-2",children:["Fixed in version: ",s.fixed_version]})]})]}),e.jsxs("div",{className:"text-right",children:[s.cvss_score&&e.jsxs("div",{className:"text-white font-bold",children:["CVSS: ",s.cvss_score]}),e.jsx("div",{className:"text-gray-400 text-sm",children:s.source}),s.exploited_in_wild&&e.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-red-600 text-white text-xs rounded",children:"Exploited in Wild"})]})]})},s.id))}),a==="overview"&&t&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Selected Project"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-3xl",children:m(t.ecosystem)}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold text-white",children:t.name}),e.jsx("p",{className:"text-gray-400",children:t.ecosystem})]})]}),t.repository_url&&e.jsxs("a",{href:t.repository_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-cyan-400 hover:underline",children:[e.jsx(B,{className:"h-4 w-4"}),t.repository_url]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{className:"bg-gray-700 rounded p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:t.total_dependencies}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Dependencies"})]}),e.jsxs("div",{className:"bg-gray-700 rounded p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:t.vulnerable_dependencies}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Vulnerable"})]}),e.jsxs("div",{className:"bg-gray-700 rounded p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:t.license_issues}),e.jsx("div",{className:"text-gray-400 text-sm",children:"License Issues"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Recent Vulnerabilities"}),e.jsx("div",{className:"space-y-3",children:g.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 rounded p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs text-white ${j(s.severity)}`,children:s.severity.toUpperCase()}),e.jsx("span",{className:"text-white",children:s.vuln_id})]}),s.cvss_score&&e.jsxs("span",{className:"text-gray-300",children:["CVSS: ",s.cvss_score]})]},s.id))})]})]})]})]})})};export{Y as default};
