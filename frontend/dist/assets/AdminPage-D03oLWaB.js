import{j as e}from"./vendor-state-DrZ0R9WI.js";import{r as l}from"./vendor-react-HUtzaQ-y.js";import{a as y,C as N,L as T,B as R,b as ae,c as re}from"./index-HWikd5b2.js";import{B as h,s as Q,at as le,au as ne,a7 as V,S as G,U as J,ai as M,X as ie,a8 as ce,a3 as de,a5 as z,q as oe,G as xe,e as me,av as ue,J as he,m as q,t as pe,aw as ge,n as fe,D as je}from"./vendor-ui-B0CnzN9V.js";import"./vendor-charts-B0X_RreH.js";const be=()=>{const[i,C]=l.useState([]),[j,p]=l.useState(!0),[o,k]=l.useState(""),[x,L]=l.useState(null),[g,v]=l.useState(!1);l.useEffect(()=>{f()},[]);const f=async()=>{p(!0);try{const a=await y.getUsers();C(a.data)}catch(a){h.error("Failed to load users"),console.error(a)}finally{p(!1)}},_=async(a,c)=>{var d,w;if(confirm(`Are you sure you want to delete user "${c}"? This action cannot be undone.`))try{await y.deleteUser(a),h.success("User deleted successfully"),f()}catch(A){const D=A;h.error(((w=(d=D.response)==null?void 0:d.data)==null?void 0:w.error)||"Failed to delete user")}},r=async a=>{var c,d;try{await y.updateUser(a.id,{is_active:!a.is_active}),h.success(`User ${a.is_active?"deactivated":"activated"} successfully`),f()}catch(w){const A=w;h.error(((d=(c=A.response)==null?void 0:c.data)==null?void 0:d.error)||"Failed to update user")}},t=async(a,c)=>{var d,w;try{await y.assignRole(a,c),h.success("Role assigned successfully"),f(),v(!1)}catch(A){const D=A;h.error(((w=(d=D.response)==null?void 0:d.data)==null?void 0:w.error)||"Failed to assign role")}},n=async(a,c)=>{var d,w;try{await y.removeRole(a,c),h.success("Role removed successfully"),f()}catch(A){const D=A;h.error(((w=(d=D.response)==null?void 0:d.data)==null?void 0:w.error)||"Failed to remove role")}},m=i.filter(a=>a.username.toLowerCase().includes(o.toLowerCase())||a.email.toLowerCase().includes(o.toLowerCase())),b=a=>{switch(a){case"admin":return"bg-red-500/20 text-red-400 border-red-500/30";case"auditor":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"user":return"bg-green-500/20 text-green-400 border-green-500/30";case"viewer":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return j?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(T,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search users by username or email...",value:o,onChange:a=>k(a.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs(R,{variant:"primary",disabled:!0,children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Add User (Coming Soon)"]})]})}),e.jsxs(N,{children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:["Users (",m.length,")"]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-border",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Username"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Email"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Roles"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Created"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-slate-400",children:"Actions"})]})}),e.jsx("tbody",{children:m.map(a=>{var c;return e.jsxs("tr",{className:"border-b border-dark-border hover:bg-dark-hover",children:[e.jsx("td",{className:"py-3 px-4 text-white font-medium",children:a.username}),e.jsx("td",{className:"py-3 px-4 text-slate-300",children:a.email}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[(c=a.roles)==null?void 0:c.map(d=>e.jsx("div",{className:"group relative",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded border ${b(d)}`,children:[d,a.roles&&a.roles.length>1&&e.jsx("button",{onClick:()=>n(a.id,d),className:"hover:text-red-400 ml-1",children:"Ã—"})]})},d)),e.jsx("button",{onClick:()=>{L(a),v(!0)},className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded border border-dashed border-slate-600 text-slate-400 hover:text-white hover:border-primary",children:"+ Add Role"})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(ae,{variant:"status",type:a.is_active?"completed":"failed",children:a.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"py-3 px-4 text-slate-400 text-sm",children:a.created_at?new Date(a.created_at).toLocaleDateString():"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>r(a),className:"p-2 text-slate-400 hover:text-primary transition-colors",title:a.is_active?"Deactivate user":"Activate user",children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>_(a.id,a.username),className:"p-2 text-slate-400 hover:text-red-400 transition-colors",title:"Delete user",children:e.jsx(V,{className:"h-4 w-4"})})]})})]},a.id)})})]}),m.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No users found matching your search"})]})]}),g&&x&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40",onClick:()=>v(!1)}),e.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50 bg-dark-surface border border-dark-border rounded-lg shadow-2xl p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5 text-primary"}),"Assign Role to ",x.username]}),e.jsx("button",{onClick:()=>v(!1),className:"text-slate-400 hover:text-white transition-colors",children:"Ã—"})]}),e.jsx("div",{className:"space-y-2",children:["admin","user","auditor","viewer"].map(a=>{var d;const c=(d=x.roles)==null?void 0:d.includes(a);return e.jsx("button",{onClick:()=>!c&&t(x.id,a),disabled:c,className:`w-full text-left px-4 py-3 rounded border transition-colors ${c?"bg-dark-bg border-dark-border text-slate-500 cursor-not-allowed":"bg-dark-bg border-dark-border text-white hover:border-primary hover:bg-dark-hover"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium capitalize",children:a}),e.jsxs("div",{className:"text-xs text-slate-400",children:[a==="admin"&&"Full system access",a==="user"&&"Standard user access",a==="auditor"&&"Read-only access to all scans and logs",a==="viewer"&&"View-only access to own scans"]})]}),c&&e.jsx("span",{className:"text-xs text-green-400",children:"Already assigned"})]})},a)})})]})]})]})},Ne=()=>{const[i,C]=l.useState([]),[j,p]=l.useState(!0),[o,k]=l.useState(""),[x,L]=l.useState("all");l.useEffect(()=>{g()},[]);const g=async()=>{p(!0);try{const r=await y.getAllScans();C(r.data)}catch(r){h.error("Failed to load scans"),console.error(r)}finally{p(!1)}},v=async(r,t)=>{var n,m;if(confirm(`Are you sure you want to delete scan "${t}"? This action cannot be undone.`))try{await y.deleteScan(r),h.success("Scan deleted successfully"),g()}catch(b){const a=b;h.error(((m=(n=a.response)==null?void 0:n.data)==null?void 0:m.error)||"Failed to delete scan")}},f=i.filter(r=>{const t=r.name.toLowerCase().includes(o.toLowerCase())||r.targets.toLowerCase().includes(o.toLowerCase()),n=x==="all"||r.status===x;return t&&n}),_=r=>{switch(r){case"completed":return"bg-green-500/20 text-green-400 border-green-500/30";case"running":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"failed":return"bg-red-500/20 text-red-400 border-red-500/30";case"pending":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return j?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(T,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search scans by name or target...",value:o,onChange:r=>k(r.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("select",{value:x,onChange:r=>L(r.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"running",children:"Running"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"})]})]})}),e.jsxs(N,{children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:["All Scans (",f.length,")"]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-border",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Scan Name"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Targets"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"User ID"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-slate-400",children:"Created"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-slate-400",children:"Actions"})]})}),e.jsx("tbody",{children:f.map(r=>e.jsxs("tr",{className:"border-b border-dark-border hover:bg-dark-hover",children:[e.jsx("td",{className:"py-3 px-4 text-white font-medium",children:r.name}),e.jsx("td",{className:"py-3 px-4 text-slate-300 font-mono text-sm",children:r.targets.length>50?`${r.targets.substring(0,50)}...`:r.targets}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded border ${_(r.status)}`,children:r.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm",children:[e.jsx(J,{className:"h-3 w-3"}),r.user_id.substring(0,8),"..."]})}),e.jsx("td",{className:"py-3 px-4 text-slate-400 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-3 w-3"}),new Date(r.created_at).toLocaleString()]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx("button",{onClick:()=>v(r.id,r.name),className:"p-2 text-slate-400 hover:text-red-400 transition-colors",title:"Delete scan",children:e.jsx(V,{className:"h-4 w-4"})})})})]},r.id))})]}),f.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No scans found matching your filters"})]})]}),e.jsxs(N,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:i.filter(r=>r.status==="completed").length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Completed"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:i.filter(r=>r.status==="running").length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Running"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:i.filter(r=>r.status==="pending").length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Pending"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:i.filter(r=>r.status==="failed").length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Failed"})]})]})]})]})},E=50,ve=()=>{const[i,C]=l.useState([]),[j,p]=l.useState(!0),[o,k]=l.useState(!1),[x,L]=l.useState(0),[g,v]=l.useState(0),[f,_]=l.useState(""),[r,t]=l.useState(""),[n,m]=l.useState(""),[b,a]=l.useState(""),[c,d]=l.useState(""),[w,A]=l.useState([]),[D,H]=l.useState([]),[P,W]=l.useState(null);l.useEffect(()=>{(async()=>{try{const[u,S]=await Promise.all([y.getAuditActionTypes(),y.getAuditUsers()]);A(u.data.actions||[]),H(S.data.users||[])}catch(u){console.error("Failed to load filter options:",u)}})()},[]);const $=l.useCallback(async()=>{p(!0);try{const s={limit:E,offset:g};if(r&&(s.action=r),n&&(s.user_id=n),b&&(s.start_date=new Date(b).toISOString()),c){const S=new Date(c);S.setHours(23,59,59,999),s.end_date=S.toISOString()}const u=await y.getAuditLogs(s);C(u.data.logs),L(u.data.total)}catch(s){h.error("Failed to load audit logs"),console.error(s)}finally{p(!1)}},[r,n,b,c,g]);l.useEffect(()=>{$()},[$]),l.useEffect(()=>{v(0)},[r,n,b,c]);const X=async()=>{k(!0);try{const s={};if(r&&(s.action=r),n&&(s.user_id=n),b&&(s.start_date=new Date(b).toISOString()),c){const I=new Date(c);I.setHours(23,59,59,999),s.end_date=I.toISOString()}const u=await y.exportAuditLogs(s),S=new Blob([u.data],{type:"text/csv"}),F=window.URL.createObjectURL(S),U=document.createElement("a");U.href=F,U.download=`audit_logs_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(U),U.click(),document.body.removeChild(U),window.URL.revokeObjectURL(F),h.success("Audit logs exported successfully")}catch(s){h.error("Failed to export audit logs"),console.error(s)}finally{k(!1)}},Z=()=>{t(""),m(""),a(""),d(""),_(""),v(0)},O=i.filter(s=>{var S,F,U,I;if(!f)return!0;const u=f.toLowerCase();return s.action.toLowerCase().includes(u)||((S=s.username)==null?void 0:S.toLowerCase().includes(u))||s.user_id.toLowerCase().includes(u)||((F=s.target_id)==null?void 0:F.toLowerCase().includes(u))||((U=s.target_type)==null?void 0:U.toLowerCase().includes(u))||((I=s.ip_address)==null?void 0:I.toLowerCase().includes(u))}),K=s=>s.includes("create")||s.includes("assigned")||s.includes("enabled")?"bg-green-500/20 text-green-400 border-green-500/30":s.includes("delete")||s.includes("remove")||s.includes("disabled")?"bg-red-500/20 text-red-400 border-red-500/30":s.includes("update")||s.includes("change")?"bg-yellow-500/20 text-yellow-400 border-yellow-500/30":s.includes("login")||s.includes("logout")||s.includes("auth")?"bg-blue-500/20 text-blue-400 border-blue-500/30":s.includes("export")||s.includes("download")?"bg-purple-500/20 text-purple-400 border-purple-500/30":"bg-slate-500/20 text-slate-400 border-slate-500/30",Y=s=>{switch(s.split(".")[0]){case"auth":return"ðŸ”";case"user":return"ðŸ‘¤";case"role":return"ðŸ›¡ï¸";case"scan":return"ðŸ”";case"vulnerability":return"âš ï¸";case"report":return"ðŸ“„";case"template":return"ðŸ“‹";case"settings":return"âš™ï¸";case"api_key":return"ðŸ”‘";case"integration":return"ðŸ”—";case"compliance":return"âœ…";case"vpn":return"ðŸ”’";case"mfa":return"ðŸ“±";case"account":return"ðŸ‘¤";default:return"ðŸ“"}},ee=s=>s.split(".").map(u=>u.split("_").map(S=>S.charAt(0).toUpperCase()+S.slice(1)).join(" ")).join(" - "),B=Math.ceil(x/E),se=Math.floor(g/E)+1,te=r||n||b||c;return j&&i.length===0?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(T,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-[200px] relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search within results...",value:f,onChange:s=>_(s.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("select",{value:r,onChange:s=>t(s.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent min-w-[150px]",children:[e.jsx("option",{value:"",children:"All Actions"}),w.map(s=>e.jsx("option",{value:s,children:s.charAt(0).toUpperCase()+s.slice(1).replace("_"," ")},s))]}),e.jsxs("select",{value:n,onChange:s=>m(s.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent min-w-[150px]",children:[e.jsx("option",{value:"",children:"All Users"}),D.map(s=>e.jsx("option",{value:s.id,children:s.username},s.id))]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4 text-slate-400"}),e.jsx("input",{type:"date",value:b,onChange:s=>a(s.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Start Date"}),e.jsx("span",{className:"text-slate-400",children:"to"}),e.jsx("input",{type:"date",value:c,onChange:s=>d(s.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"End Date"})]}),e.jsx("div",{className:"flex-1"}),te&&e.jsxs(R,{variant:"ghost",size:"sm",onClick:Z,children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Clear Filters"]}),e.jsxs(R,{variant:"ghost",size:"sm",onClick:$,disabled:j,children:[e.jsx(ce,{className:`h-4 w-4 mr-1 ${j?"animate-spin":""}`}),"Refresh"]}),e.jsxs(R,{variant:"secondary",size:"sm",onClick:X,disabled:o||x===0,children:[e.jsx(de,{className:"h-4 w-4 mr-1"}),o?"Exporting...":"Export CSV"]})]})]})}),e.jsxs(N,{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h3",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"Audit Logs",e.jsxs("span",{className:"text-sm font-normal text-slate-400",children:["(",O.length," of ",x," total)"]})]})}),e.jsxs("div",{className:"space-y-2",children:[O.map(s=>e.jsxs("div",{className:`bg-dark-bg border rounded-lg transition-all ${P===s.id?"border-primary/50":"border-dark-border hover:border-primary/30"}`,children:[e.jsx("div",{className:"p-4 cursor-pointer",onClick:()=>W(P===s.id?null:s.id),children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-lg",children:Y(s.action)}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded border ${K(s.action)}`,children:ee(s.action)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(J,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"text-slate-500",children:"User:"}),e.jsx("span",{className:"font-medium text-slate-300 truncate",children:s.username||s.user_id.substring(0,8)+"..."})]}),s.target_type&&s.target_id&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(oe,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"text-slate-500",children:"Target:"}),e.jsxs("span",{className:"font-mono text-slate-300 truncate",children:[s.target_type,":",s.target_id.substring(0,8),"..."]})]}),s.ip_address&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(xe,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"text-slate-500",children:"IP:"}),e.jsx("span",{className:"font-mono text-slate-300",children:s.ip_address})]}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(M,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"text-slate-300",children:new Date(s.created_at).toLocaleString()})]})]})]})})}),P===s.id&&e.jsx("div",{className:"px-4 pb-4 pt-0 border-t border-dark-border mt-2",children:e.jsxs("div",{className:"mt-3 space-y-3",children:[s.user_agent&&e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(me,{className:"h-4 w-4 text-slate-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"User Agent:"}),e.jsx("p",{className:"text-slate-400 text-xs mt-1 break-all",children:s.user_agent})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"User ID:"}),e.jsx("p",{className:"font-mono text-slate-400 text-xs mt-1",children:s.user_id})]}),s.target_id&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Resource ID:"}),e.jsx("p",{className:"font-mono text-slate-400 text-xs mt-1",children:s.target_id})]})]}),s.details&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 text-sm",children:"Details:"}),e.jsx("pre",{className:"mt-2 p-3 bg-dark-surface rounded text-slate-400 text-xs overflow-x-auto max-h-48",children:(()=>{try{return JSON.stringify(JSON.parse(s.details),null,2)}catch{return s.details}})()})]})]})})]},s.id)),O.length===0&&!j&&e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx(z,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No audit logs found matching your filters"})]})]}),B>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-dark-border",children:[e.jsxs("div",{className:"text-sm text-slate-400",children:["Showing ",g+1,"-",Math.min(g+E,x)," of ",x," entries"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(R,{variant:"ghost",size:"sm",onClick:()=>v(Math.max(0,g-E)),disabled:g===0||j,children:[e.jsx(ue,{className:"h-4 w-4"}),"Previous"]}),e.jsxs("span",{className:"text-sm text-slate-400",children:["Page ",se," of ",B]}),e.jsxs(R,{variant:"ghost",size:"sm",onClick:()=>v(g+E),disabled:g+E>=x||j,children:["Next",e.jsx(he,{className:"h-4 w-4"})]})]})]})]}),e.jsxs(N,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Quick Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:i.filter(s=>s.action.startsWith("auth.")).length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Auth Events"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:i.filter(s=>s.action.includes("create")||s.action.includes("assigned")).length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Created/Assigned"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:i.filter(s=>s.action.includes("update")||s.action.includes("change")).length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Updated"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:i.filter(s=>s.action.includes("delete")||s.action.includes("remove")).length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Deleted/Removed"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:x}),e.jsx("div",{className:"text-sm text-slate-400",children:"Total Actions"})]})]})]})]})},ye=()=>{const[i,C]=l.useState([]),[j,p]=l.useState(!0),[o,k]=l.useState({}),[x,L]=l.useState({});l.useEffect(()=>{g()},[]);const g=async()=>{p(!0);try{const t=await y.getSettings();C(t.data);const n={};t.data.forEach(m=>{n[m.key]=m.value}),k(n)}catch(t){h.error("Failed to load settings"),console.error(t)}finally{p(!1)}},v=async t=>{var n,m;L({...x,[t]:!0});try{await y.updateSetting(t,o[t]),h.success(`Setting "${t}" updated successfully`),g()}catch(b){const a=b;h.error(((m=(n=a.response)==null?void 0:n.data)==null?void 0:m.error)||"Failed to update setting")}finally{L({...x,[t]:!1})}},f=t=>{const n=i.find(m=>m.key===t);n&&k({...o,[t]:n.value})},_=t=>{const n=i.find(m=>m.key===t);return n&&o[t]!==n.value},r=t=>t.includes("scan")?"ðŸ”":t.includes("user")?"ðŸ‘¤":t.includes("retention")?"ðŸ—“ï¸":t.includes("registration")?"ðŸ“":"âš™ï¸";return j?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(T,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(N,{children:[e.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:[e.jsx(q,{className:"inline h-5 w-5 mr-2"}),"System Settings (",i.length,")"]}),e.jsxs("div",{className:"space-y-4",children:[i.map(t=>e.jsx("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:r(t.key)}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:t.key}),t.description&&e.jsx("p",{className:"text-sm text-slate-400",children:t.description})]})]}),e.jsx("div",{className:"mt-3",children:t.key==="allow_registration"?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o[t.key]==="true",onChange:n=>k({...o,[t.key]:n.target.checked?"true":"false"}),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-dark-surface peer-focus:ring-2 peer-focus:ring-primary rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"})]}),e.jsx("span",{className:"text-sm text-slate-400",children:o[t.key]==="true"?"Enabled":"Disabled"})]}):e.jsx("input",{type:t.key.includes("days")?"number":"text",value:o[t.key]||"",onChange:n=>k({...o,[t.key]:n.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})}),e.jsxs("div",{className:"mt-3 flex items-center gap-4 text-xs text-slate-500",children:[t.updated_by&&e.jsxs("span",{children:["Last updated by: ",e.jsxs("span",{className:"font-mono",children:[t.updated_by.substring(0,8),"..."]})]}),t.updated_at&&e.jsx("span",{children:new Date(t.updated_at).toLocaleString()})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(R,{onClick:()=>v(t.key),disabled:!_(t.key)||x[t.key],variant:"primary",size:"sm",children:[e.jsx(pe,{className:"h-4 w-4 mr-1"}),x[t.key]?"Saving...":"Save"]}),_(t.key)&&e.jsxs(R,{onClick:()=>f(t.key),variant:"secondary",size:"sm",children:[e.jsx(ge,{className:"h-4 w-4 mr-1"}),"Reset"]})]})]})},t.key)),i.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No system settings configured"})]})]}),e.jsxs(N,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"â„¹ï¸ Information"}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-400",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-white",children:"max_scans_per_user:"})," Maximum number of scans each user can create. Set to 0 for unlimited."]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-white",children:"scan_retention_days:"})," Automatically delete scans older than this many days. Set to 0 to disable auto-deletion."]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-white",children:"allow_registration:"})," Whether new users can register accounts. Disable this to restrict new registrations."]})]})]})]})},Ae=()=>{const[i,C]=l.useState("users"),j=[{value:"users",label:"Users",icon:fe},{value:"scans",label:"Scans",icon:je},{value:"audit",label:"Audit Logs",icon:z},{value:"settings",label:"Settings",icon:q}];return e.jsx(re,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Admin Console"}),e.jsx("p",{className:"text-slate-400",children:"Manage users, scans, and system settings"})]})]}),e.jsx("div",{className:"border-b border-dark-border",children:e.jsx("div",{className:"flex gap-1",children:j.map(p=>{const o=p.icon;return e.jsxs("button",{onClick:()=>C(p.value),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${i===p.value?"border-primary text-primary font-medium":"border-transparent text-slate-400 hover:text-white hover:border-slate-600"}`,children:[e.jsx(o,{className:"h-4 w-4"}),p.label]},p.value)})})}),e.jsxs("div",{className:"animate-fadeIn",children:[i==="users"&&e.jsx(be,{}),i==="scans"&&e.jsx(Ne,{}),i==="audit"&&e.jsx(ve,{}),i==="settings"&&e.jsx(ye,{})]})]})})};export{Ae as default};
