import{c as T,j as e,u as Ee}from"./vendor-state-oFDmcCcB.js";import{r as b,u as de,L as M,j as z}from"./vendor-react-5KxtEOLM.js";import{J as K,K as ze,L as $e,M as U,B as Le,H as me,T as he}from"./index-DU1ke8Sf.js";import{l as P,bI as xe,bJ as ue,an as be,m as J,f as R,d as De,s as pe,bK as Re,bL as ge,bM as fe,S as E,U as ye,bN as Te,aL as Pe,G as Y,y as We,w as F,ag as L,z as X,Z as B,bc as Fe,bg as _,O as ee,bA as Be,bO as _e,ai as He,bP as Ke,bQ as Ue,aA as Ge,bR as qe,bS as Qe,bT as Ve,K as Ze,as as Je,b7 as ve,R as te,W as Ye,bU as se,Y as ae,bV as Xe,bW as et,bX as tt,a5 as st,bY as at,bk as rt,bF as nt,H as ot,h as we,aj as it,aP as re,aZ as lt,n as ct,aM as ne,ad as oe,bZ as ie,b_ as dt,b$ as mt,c0 as ht,c1 as xt,aw as ut,F as je,a2 as bt,aO as pt,aQ as gt,e as le,c2 as ft,o as yt,av as vt,t as G,x as wt,$ as ke,ah as jt,L as kt,a$ as Nt,c3 as ce,au as Ct,aB as St,X as It}from"./vendor-ui-BlFJDRaq.js";import{M as Ot}from"./vendor-markdown-BwTKtS0m.js";const q=T()(K(s=>({sidebarCollapsed:!1,sidebarOpen:!1,expandedSections:["featured","recon"],toggleSidebar:()=>s(a=>({sidebarCollapsed:!a.sidebarCollapsed})),setSidebarCollapsed:a=>s({sidebarCollapsed:a}),setSidebarOpen:a=>s({sidebarOpen:a}),toggleSection:a=>s(t=>({expandedSections:t.expandedSections.includes(a)?t.expandedSections.filter(r=>r!==a):[...t.expandedSections,a]})),setExpandedSections:a=>s({expandedSections:a})}),{name:"heroforge-ui-storage",partialize:s=>({sidebarCollapsed:s.sidebarCollapsed,expandedSections:s.expandedSections})}));function At(s){const[a,t]=b.useState(()=>typeof window<"u"?window.matchMedia(s).matches:!1);return b.useEffect(()=>{if(typeof window>"u")return;const r=window.matchMedia(s),n=i=>t(i.matches);return t(r.matches),r.addEventListener("change",n),()=>r.removeEventListener("change",n)},[s]),a}function Q(){return At("(max-width: 1023px)")}const H=[{value:"light",label:"Light",icon:e.jsx(xe,{className:"h-4 w-4"})},{value:"dark",label:"Dark",icon:e.jsx(ue,{className:"h-4 w-4"})},{value:"system",label:"System",icon:e.jsx(be,{className:"h-4 w-4"})}],Mt=({className:s=""})=>{const{theme:a,setTheme:t,resolvedTheme:r}=ze(),[n,i]=b.useState(!1),o=b.useRef(null),h=H.find(d=>d.value===a)||H[2];b.useEffect(()=>{const d=g=>{o.current&&!o.current.contains(g.target)&&i(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]),b.useEffect(()=>{const d=g=>{g.key==="Escape"&&i(!1)};if(n)return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[n]);const c=d=>{t(d),i(!1)},u=()=>a==="system"?r==="dark"?e.jsx(ue,{className:"h-4 w-4"}):e.jsx(xe,{className:"h-4 w-4"}):h.icon;return e.jsxs("div",{className:`relative ${s}`,ref:o,children:[e.jsxs("button",{type:"button",onClick:()=>i(!n),className:`flex items-center gap-2 px-3 py-2 text-sm rounded-lg transition-colors
          text-slate-400 hover:text-slate-100 dark:text-slate-400 dark:hover:text-slate-100
          hover:bg-slate-700 dark:hover:bg-dark-hover
          bg-transparent`,"aria-haspopup":"listbox","aria-expanded":n,"aria-label":"Select theme",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[u(),e.jsx("span",{className:"hidden sm:inline",children:h.label})]}),e.jsx(P,{className:`h-3 w-3 transition-transform ${n?"rotate-180":""}`})]}),n&&e.jsx("div",{className:`absolute right-0 mt-2 w-36 rounded-lg shadow-lg z-50
            bg-white dark:bg-dark-surface
            border border-slate-200 dark:border-dark-border
            animate-fade-in`,role:"listbox","aria-label":"Theme options",children:e.jsx("div",{className:"py-1",children:H.map(d=>e.jsxs("button",{type:"button",role:"option","aria-selected":a===d.value,onClick:()=>c(d.value),className:`w-full flex items-center gap-3 px-4 py-2 text-sm transition-colors
                  ${a===d.value?"bg-primary/10 text-primary dark:text-primary-light":"text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-dark-hover"}`,children:[d.icon,e.jsx("span",{children:d.label}),a===d.value&&e.jsx("span",{className:"ml-auto text-primary dark:text-primary-light",children:e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},d.value))})})]})},Et=T()(K((s,a)=>({currentOrg:null,currentOrgId:null,organizations:[],isLoading:!1,setCurrentOrg:t=>{s({currentOrg:t,currentOrgId:(t==null?void 0:t.id)??null})},setCurrentOrgId:t=>{const n=a().organizations.find(i=>i.id===t)??null;s({currentOrgId:t,currentOrg:n})},setOrganizations:t=>{s({organizations:t});const r=a().currentOrg;!r&&t.length>0&&s({currentOrg:t[0],currentOrgId:t[0].id}),r&&!t.find(n=>n.id===r.id)&&(t.length>0?s({currentOrg:t[0],currentOrgId:t[0].id}):s({currentOrg:null,currentOrgId:null}))},setLoading:t=>s({isLoading:t}),clearOrgState:()=>{s({currentOrg:null,currentOrgId:null,organizations:[],isLoading:!1})},isOrgOwner:()=>{var t;return((t=a().currentOrg)==null?void 0:t.role)==="owner"},isOrgAdmin:()=>{var r;const t=(r=a().currentOrg)==null?void 0:r.role;return t==="owner"||t==="admin"},isOrgMember:()=>{var t;return((t=a().currentOrg)==null?void 0:t.role)==="member"},getCurrentOrgRole:()=>{var t;return((t=a().currentOrg)==null?void 0:t.role)??null},getOrgById:t=>a().organizations.find(r=>r.id===t),hasMultipleOrgs:()=>a().organizations.length>1}),{name:"org-storage",partialize:s=>({currentOrgId:s.currentOrgId})})),zt=()=>{const[s,a]=b.useState(!1),t=b.useRef(null),r=de(),{currentOrg:n,organizations:i,setCurrentOrg:o,setOrganizations:h}=Et(),{isLoading:c}=Ee({queryKey:["organizations"],queryFn:async()=>{const l=await $e.list();return h(l.data),l.data},staleTime:300*1e3});b.useEffect(()=>{const l=w=>{t.current&&!t.current.contains(w.target)&&a(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]);const u=l=>{o(l),a(!1)},d=()=>{a(!1),r("/organization/new")},g=()=>{a(!1),n&&r(`/organization/${n.id}`)},f=l=>{switch(l){case"owner":return"bg-amber-500/20 text-amber-400 border-amber-500/30";case"admin":return"bg-cyan-500/20 text-cyan-400 border-cyan-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return!c&&i.length===0?e.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover transition-colors",children:[e.jsx(J,{className:"h-4 w-4"}),"Create Organization"]}):e.jsxs("div",{className:"relative",ref:t,children:[e.jsxs("button",{onClick:()=>a(!s),disabled:c,className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover transition-colors border border-light-border dark:border-dark-border",children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx("span",{className:"max-w-[120px] truncate",children:c?"Loading...":(n==null?void 0:n.name)||"Select Organization"}),e.jsx(P,{className:`h-3 w-3 transition-transform ${s?"rotate-180":""}`})]}),s&&e.jsxs("div",{className:"absolute left-0 mt-1 w-64 bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg shadow-lg z-50 overflow-hidden",children:[e.jsx("div",{className:"max-h-64 overflow-y-auto py-1",children:i.map(l=>e.jsxs("button",{onClick:()=>u(l),className:`w-full flex items-center justify-between px-3 py-2 text-sm transition-colors ${(n==null?void 0:n.id)===l.id?"bg-primary/10 text-primary":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(R,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:l.name})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded border ${f(l.role)}`,children:l.role}),(n==null?void 0:n.id)===l.id&&e.jsx(De,{className:"h-4 w-4 text-primary"})]})]},l.id))}),e.jsx("div",{className:"border-t border-light-border dark:border-dark-border"}),e.jsxs("div",{className:"py-1",children:[n&&e.jsxs("button",{onClick:g,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover transition-colors",children:[e.jsx(pe,{className:"h-4 w-4"}),"Manage Organization"]}),e.jsxs("button",{onClick:d,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover transition-colors",children:[e.jsx(J,{className:"h-4 w-4"}),"Create Organization"]})]})]})]})},$t=()=>{const{user:s,logout:a}=U(),{sidebarCollapsed:t,toggleSidebar:r,setSidebarOpen:n}=q(),i=Q(),o=()=>{i?n(!0):r()};return e.jsx("header",{className:"bg-light-surface dark:bg-dark-surface border-b border-light-border dark:border-dark-border shadow-sm sticky top-0 z-30",children:e.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-14",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[s&&e.jsx("button",{onClick:o,className:"p-2 rounded-lg hover:bg-light-hover dark:hover:bg-dark-hover transition-colors","aria-label":i?"Open menu":t?"Expand sidebar":"Collapse sidebar",children:i?e.jsx(Re,{className:"h-5 w-5 text-slate-600 dark:text-slate-400"}):t?e.jsx(ge,{className:"h-5 w-5 text-slate-600 dark:text-slate-400"}):e.jsx(fe,{className:"h-5 w-5 text-slate-600 dark:text-slate-400"})}),(!s||i)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex items-center justify-center w-9 h-9 bg-primary rounded-lg",children:e.jsx(E,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"HeroForge"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 hidden sm:block",children:"Network Triage Dashboard"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden sm:block",children:e.jsx(zt,{})}),e.jsxs("div",{className:"hidden md:flex items-center space-x-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"h-4 w-4 text-slate-500 dark:text-slate-400"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:s.username})]}),s.roles&&s.roles.length>0&&e.jsx("div",{className:"flex gap-1",children:s.roles.slice(0,2).map(h=>e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 text-xs font-medium rounded border bg-slate-500/20 text-slate-700 dark:text-slate-300 border-slate-500/30 capitalize",children:h},h))})]})]}),e.jsx(Mt,{}),s&&e.jsxs(Le,{variant:"ghost",size:"sm",onClick:a,className:"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white",children:[e.jsx(Te,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline ml-2",children:"Logout"})]})]})]})})})},Lt=()=>e.jsx("footer",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Â© 2026 Genial Architect Cybersecurity Research Associates. All rights reserved."})]}),e.jsxs("nav",{className:"flex items-center gap-6 text-sm",children:[e.jsx(M,{to:"/legal/terms",className:"text-gray-500 dark:text-gray-400 hover:text-primary transition-colors",children:"Terms"}),e.jsx(M,{to:"/legal/privacy",className:"text-gray-500 dark:text-gray-400 hover:text-primary transition-colors",children:"Privacy"}),e.jsx(M,{to:"/legal/acceptable-use",className:"text-gray-500 dark:text-gray-400 hover:text-primary transition-colors",children:"Acceptable Use"}),e.jsx(M,{to:"/legal/cookies",className:"text-gray-500 dark:text-gray-400 hover:text-primary transition-colors",children:"Cookies"})]})]})})}),Dt={identify:[],assess:[],exploit:["red_team"],detect:["blue_team"],respond:["blue_team","green_team"],govern:["white_team"],collaborate:["purple_team","red_team","blue_team"]},V={blue:{active:"bg-blue-500/10 text-blue-600 dark:text-blue-400",hover:"hover:bg-blue-500/5 hover:text-blue-600 dark:hover:text-blue-400",border:"border-l-blue-500",dot:"bg-blue-500",bg:"bg-blue-500/5"},cyan:{active:"bg-cyan-500/10 text-cyan-600 dark:text-cyan-400",hover:"hover:bg-cyan-500/5 hover:text-cyan-600 dark:hover:text-cyan-400",border:"border-l-cyan-500",dot:"bg-cyan-500",bg:"bg-cyan-500/5"},rose:{active:"bg-rose-500/10 text-rose-600 dark:text-rose-400",hover:"hover:bg-rose-500/5 hover:text-rose-600 dark:hover:text-rose-400",border:"border-l-rose-500",dot:"bg-rose-500",bg:"bg-rose-500/5"},amber:{active:"bg-amber-500/10 text-amber-600 dark:text-amber-400",hover:"hover:bg-amber-500/5 hover:text-amber-600 dark:hover:text-amber-400",border:"border-l-amber-500",dot:"bg-amber-500",bg:"bg-amber-500/5"},orange:{active:"bg-orange-500/10 text-orange-600 dark:text-orange-400",hover:"hover:bg-orange-500/5 hover:text-orange-600 dark:hover:text-orange-400",border:"border-l-orange-500",dot:"bg-orange-500",bg:"bg-orange-500/5"},slate:{active:"bg-slate-500/10 text-slate-700 dark:text-slate-300",hover:"hover:bg-slate-500/5 hover:text-slate-700 dark:hover:text-slate-300",border:"border-l-slate-400",dot:"bg-slate-400",bg:"bg-slate-500/5"},purple:{active:"bg-purple-500/10 text-purple-600 dark:text-purple-400",hover:"hover:bg-purple-500/5 hover:text-purple-600 dark:hover:text-purple-400",border:"border-l-purple-500",dot:"bg-purple-500",bg:"bg-purple-500/5"},default:{active:"bg-primary/10 text-primary",hover:"hover:bg-light-hover dark:hover:bg-dark-hover hover:text-slate-900 dark:hover:text-white",border:"border-l-primary",dot:"bg-primary",bg:"bg-primary/5"}},W=({item:s,collapsed:a,categoryColor:t="default"})=>{const r=z(),n=r.pathname===s.to||s.to!=="/dashboard"&&r.pathname.startsWith(s.to)||s.to.includes("?")&&r.pathname+r.search===s.to,i=V[t],o=s.icon,h=e.jsxs(M,{to:s.to,className:`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors text-sm ${n?`${i.active} font-medium`:`text-slate-600 dark:text-slate-400 ${i.hover}`}`,children:[e.jsx(o,{className:"h-4 w-4 flex-shrink-0"}),!a&&e.jsx("span",{className:"truncate",children:s.label})]});return a?e.jsx(he,{content:s.label,position:"right",children:h}):h},Rt=({subsection:s,categoryColor:a,expanded:t,onToggle:r})=>{const n=V[a],i=z(),o=s.items.some(h=>i.pathname===h.to||i.pathname.startsWith(h.to));return e.jsxs("div",{className:"mt-1",children:[e.jsxs("button",{onClick:r,className:`w-full flex items-center gap-2 px-2 py-1.5 rounded-md transition-colors text-xs ${o?`${n.active} font-medium`:`text-slate-500 dark:text-slate-400 ${n.hover}`}`,children:[e.jsx("span",{className:"flex-1 text-left truncate",children:s.label}),t?e.jsx(P,{className:"h-3 w-3 flex-shrink-0"}):e.jsx(ke,{className:"h-3 w-3 flex-shrink-0"})]}),t&&e.jsx("div",{className:"ml-2 pl-2 border-l border-slate-200 dark:border-slate-700 mt-1 space-y-0.5",children:s.items.map(h=>e.jsx(W,{item:h,collapsed:!1,categoryColor:a},h.to))})]})},Tt=({section:s,collapsed:a,expandedSections:t,onToggleSection:r})=>{var d,g,f;const n=V[s.categoryColor],i=z(),o=s.icon,h=[...s.items||[],...((d=s.subsections)==null?void 0:d.flatMap(l=>l.items))||[]].some(l=>i.pathname===l.to||i.pathname.startsWith(l.to)),c=t.includes(s.id),u=e.jsxs("button",{onClick:()=>r(s.id),className:`w-full flex items-center gap-2 px-3 py-2 rounded-lg transition-colors text-sm ${h?`${n.active} font-medium`:`text-slate-600 dark:text-slate-400 ${n.hover}`}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full flex-shrink-0 ${n.dot}`}),!a&&e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"flex-1 text-left truncate",children:s.label}),c?e.jsx(P,{className:"h-3 w-3 flex-shrink-0"}):e.jsx(ke,{className:"h-3 w-3 flex-shrink-0"})]})]});return e.jsxs("div",{className:"mb-1",children:[a?e.jsx(he,{content:s.label,position:"right",children:u}):u,c&&!a&&e.jsxs("div",{className:`ml-3 pl-3 border-l-2 ${n.border} mt-1 space-y-0.5`,children:[(g=s.items)==null?void 0:g.map(l=>e.jsx(W,{item:l,collapsed:!1,categoryColor:s.categoryColor},l.to)),(f=s.subsections)==null?void 0:f.map(l=>e.jsx(Rt,{subsection:l,categoryColor:s.categoryColor,expanded:t.includes(`${s.id}-${l.id}`),onToggle:()=>r(`${s.id}-${l.id}`)},l.id))]})]})},Pt=({collapsed:s})=>{const a=[{to:"/dashboard?tab=topology",icon:L,label:"Network Topology"},{to:"/attack-paths",icon:ve,label:"Attack Paths"},{to:"/ai-security",icon:vt,label:"AI Security"},{to:"/llm-testing",icon:G,label:"LLM Testing"},{to:"/ai-reports",icon:je,label:"AI Reports"},{to:"/ml-models",icon:wt,label:"ML Models"}];return e.jsxs("div",{className:`mb-4 rounded-lg bg-gradient-to-br from-purple-500/10 via-cyan-500/10 to-blue-500/10 border border-purple-500/20 ${s?"p-2":"p-3"}`,children:[!s&&e.jsxs("div",{className:"flex items-center gap-2 mb-2 px-1",children:[e.jsx(yt,{className:"h-4 w-4 text-yellow-500"}),e.jsx("span",{className:"text-xs font-semibold text-slate-700 dark:text-slate-300 uppercase tracking-wide",children:"AI & Visualization"})]}),e.jsx("div",{className:"space-y-0.5",children:a.map(t=>e.jsx(W,{item:t,collapsed:s,categoryColor:"purple"},t.to))})]})},Wt=()=>{const{user:s}=U(),a=z(),t=Q(),{sidebarCollapsed:r,sidebarOpen:n,expandedSections:i,toggleSidebar:o,setSidebarOpen:h,toggleSection:c}=q(),u=me(p=>{var j;return((j=p.user)==null?void 0:j.roles)??[]}),d=u.includes("admin"),g=p=>p.some(j=>u.includes(j));if(b.useEffect(()=>{t&&h(!1)},[a.pathname,t,h]),!s)return null;const f=[{id:"identify",label:"Identify",icon:X,categoryColor:"blue",items:[{to:"/dashboard",icon:Pe,label:"Scans Dashboard"},{to:"/discovery",icon:Y,label:"Asset Discovery"},{to:"/assets",icon:We,label:"Asset Inventory"},{to:"/attack-surface",icon:F,label:"Attack Surface"},{to:"/dns-tools",icon:L,label:"DNS Tools"}]},{id:"assess",label:"Assess",icon:Ue,categoryColor:"cyan",subsections:[{id:"scanning",label:"Scanning",items:[{to:"/nuclei",icon:B,label:"Nuclei Scanner"},{to:"/webapp-scan",icon:X,label:"Web App Scan"},{to:"/compare",icon:Fe,label:"Scan Compare"}]},{id:"appsec",label:"Application Security",items:[{to:"/yellow-team",icon:_,label:"DevSecOps Dashboard"},{to:"/sast",icon:ee,label:"SAST Scanner"},{to:"/sca",icon:Be,label:"SCA (Dependencies)"},{to:"/cicd-integration",icon:_e,label:"CI/CD Integration"},{to:"/iac-security",icon:_,label:"IaC Security"},{to:"/container-security",icon:He,label:"Container Security"},{to:"/api-security",icon:Ke,label:"API Security"}]}]},{id:"exploit",label:"Exploit",icon:se,categoryColor:"rose",requiredRoles:["red_team"],subsections:[{id:"research",label:"Research",items:[{to:"/exploit-database",icon:Ge,label:"Exploit Database"},{to:"/poc-repository",icon:ee,label:"PoC Repository"},{to:"/research-workspaces",icon:qe,label:"Research Workspaces"},{to:"/binary-analysis",icon:Qe,label:"Binary Analysis"},{to:"/malware-analysis",icon:Ve,label:"Malware Analysis"}]},{id:"execution",label:"Execution",items:[{to:"/exploitation",icon:F,label:"Exploitation"},{to:"/fuzzing",icon:B,label:"Fuzzing"},{to:"/cracking",icon:Ze,label:"Password Cracking"},{to:"/privesc",icon:Je,label:"Privilege Escalation"},{to:"/bloodhound",icon:ve,label:"BloodHound AD"}]},{id:"operations",label:"Operations",items:[{to:"/phishing",icon:F,label:"Phishing Campaigns"},{to:"/c2",icon:te,label:"C2 Management"},{to:"/wireless",icon:Ye,label:"Wireless Attacks"},{to:"/attack-simulation",icon:se,label:"Attack Simulation"}]}]},{id:"detect",label:"Detect",icon:ot,categoryColor:"amber",requiredRoles:["blue_team"],subsections:[{id:"monitoring",label:"Monitoring",items:[{to:"/siem",icon:ae,label:"SIEM"},{to:"/ueba",icon:Xe,label:"UEBA"},{to:"/traffic-analysis",icon:L,label:"Traffic Analysis"},{to:"/netflow-analysis",icon:ae,label:"NetFlow Analysis"},{to:"/dns-analytics",icon:Y,label:"DNS Analytics"}]},{id:"hunting",label:"Threat Hunting",items:[{to:"/detection-engineering",icon:et,label:"Detection Engineering"},{to:"/threat-hunting",icon:tt,label:"Threat Hunting"},{to:"/threat-intel",icon:st,label:"Threat Intel"},{to:"/yara",icon:at,label:"YARA Rules"},{to:"/sigma-rules",icon:_,label:"Sigma Rules"}]},{id:"specialized",label:"Specialized",items:[{to:"/ot-ics-security",icon:rt,label:"OT/ICS Security"},{to:"/iot-security",icon:nt,label:"IoT Security"},{to:"/agents",icon:te,label:"Scan Agents"}]}]},{id:"respond",label:"Respond",icon:B,categoryColor:"orange",requiredRoles:["blue_team","green_team"],subsections:[{id:"incident",label:"Incident Management",items:[{to:"/incident-response",icon:we,label:"Incident Response"},{to:"/forensics",icon:it,label:"Forensics"}]},{id:"automation",label:"Automation",items:[{to:"/green-team",icon:re,label:"SOAR Dashboard"},{to:"/soar-playbooks",icon:lt,label:"Playbooks"},{to:"/workflows",icon:re,label:"Workflows"},{to:"/remediation",icon:ct,label:"Remediation"}]}]},{id:"govern",label:"Govern",icon:ie,categoryColor:"slate",requiredRoles:["white_team"],subsections:[{id:"compliance",label:"Compliance",items:[{to:"/white-team",icon:ne,label:"GRC Dashboard"},{to:"/compliance",icon:ne,label:"Compliance"},{to:"/client-compliance",icon:oe,label:"Client Checklists"},{to:"/legal/documents",icon:ie,label:"Legal Documents"},{to:"/evidence",icon:dt,label:"Evidence"},{to:"/manual-assessments",icon:oe,label:"Assessments"}]},{id:"authorization",label:"Authorization",items:[{to:"/ato-map",icon:mt,label:"ATO Map"},{to:"/cato-network-map",icon:L,label:"cATO Network Map"},{to:"/methodology",icon:ht,label:"Methodology"}]},{id:"reporting",label:"Reporting",items:[{to:"/finding-templates",icon:xt,label:"Finding Templates"},{to:"/executive-dashboard",icon:ut,label:"Executive Dashboard"},{to:"/reports",icon:je,label:"Reports"}]},{id:"acas",label:"ACAS / RMF",items:[{to:"/scap",icon:E,label:"SCAP Scanner"},{to:"/emass",icon:R,label:"eMASS Integration"},{to:"/windows-audit",icon:be,label:"Windows Audit"},{to:"/audit-files",icon:bt,label:"Audit Files"}]}]},{id:"collaborate",label:"Collaborate",icon:le,categoryColor:"purple",requiredRoles:["purple_team","red_team","blue_team"],items:[{to:"/purple-team",icon:pt,label:"Purple Team Dashboard"},{to:"/orange-team",icon:gt,label:"Security Awareness"}]}],l=[{to:"/crm",icon:R,label:"CRM Dashboard"},{to:"/admin",icon:le,label:"Admin"},{to:"/settings",icon:pe,label:"Settings"},{to:"/plugins",icon:ft,label:"Plugins"}],w=f.filter(p=>{if(d)return!0;const j=p.requiredRoles||Dt[p.id];return!j||j.length===0?!0:g(j)}),S=l.filter(p=>p.to==="/admin"?d:p.to==="/crm"?d||g(["white_team"]):!0),y=r?"w-16":"w-64";return e.jsxs(e.Fragment,{children:[t&&n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 transition-opacity",onClick:()=>h(!1)}),e.jsxs("aside",{className:`
          fixed top-0 left-0 h-full z-50
          bg-light-surface dark:bg-dark-surface
          border-r border-light-border dark:border-dark-border
          transition-all duration-300 ease-in-out
          flex flex-col
          ${t?`w-64 ${n?"translate-x-0":"-translate-x-full"}`:y}
        `,role:"navigation","aria-label":"Main navigation",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-light-border dark:border-dark-border",children:[!r&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-primary rounded-lg",children:e.jsx(E,{className:"h-5 w-5 text-white"})}),e.jsx("span",{className:"font-bold text-slate-900 dark:text-white",children:"HeroForge"})]}),r&&e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-primary rounded-lg mx-auto",children:e.jsx(E,{className:"h-5 w-5 text-white"})}),!t&&e.jsx("button",{onClick:o,className:`p-1.5 rounded-lg hover:bg-light-hover dark:hover:bg-dark-hover transition-colors ${r?"mx-auto mt-2":""}`,"aria-label":r?"Expand sidebar":"Collapse sidebar",children:r?e.jsx(ge,{className:"h-4 w-4 text-slate-600 dark:text-slate-400"}):e.jsx(fe,{className:"h-4 w-4 text-slate-600 dark:text-slate-400"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3",children:[e.jsx(Pt,{collapsed:r}),e.jsx("div",{className:"space-y-1",children:w.map(p=>e.jsx(Tt,{section:p,collapsed:r,expandedSections:i,onToggleSection:c},p.id))}),e.jsx("div",{className:"my-4 border-t border-light-border dark:border-dark-border"}),!r&&S.length>0&&e.jsx("div",{className:"mb-2 px-3",children:e.jsx("span",{className:"text-xs font-semibold text-slate-500 dark:text-slate-500 uppercase tracking-wide",children:"Quick Access"})}),e.jsx("div",{className:"space-y-0.5",children:S.map(p=>e.jsx(W,{item:p,collapsed:r,categoryColor:"default"},p.to))})]})]})]})},Ne=T()(K((s,a)=>({isOpen:!1,isMinimized:!1,isLoading:!1,messages:[],conversationId:null,error:null,setOpen:t=>s({isOpen:t}),setMinimized:t=>s({isMinimized:t}),toggle:()=>{const t=a();t.isOpen&&!t.isMinimized?s({isMinimized:!0}):s({isOpen:!0,isMinimized:!1})},addMessage:t=>s(r=>({messages:[...r.messages,t],error:null})),appendToLastMessage:t=>s(r=>{const n=[...r.messages],i=n.length-1;return i>=0&&n[i].role==="assistant"&&(n[i]={...n[i],content:n[i].content+t}),{messages:n}}),finalizeLastMessage:()=>s(t=>{const r=[...t.messages],n=r.length-1;return n>=0&&r[n].isStreaming&&(r[n]={...r[n],isStreaming:!1}),{messages:r}}),setLoading:t=>s({isLoading:t}),setError:t=>s({error:t}),clearMessages:()=>s({messages:[],conversationId:null,error:null}),setConversationId:t=>s({conversationId:t}),startNewConversation:()=>s({messages:[],conversationId:null,error:null,isLoading:!1})}),{name:"heroforge-chat",partialize:s=>({messages:s.messages.slice(-50),conversationId:s.conversationId})})),A="/api",D={sendMessage:async(s,a,t,r,n,i,o)=>{var c;const h=localStorage.getItem("token");if(!h){o("Not authenticated");return}try{const u=await fetch(`${A}/chat`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify({message:s,conversation_id:a,page_context:t})});if(!u.ok){const w=await u.json().catch(()=>({}));throw new Error(w.message||`Chat request failed: ${u.status}`)}const d=(c=u.body)==null?void 0:c.getReader(),g=new TextDecoder;if(!d)throw new Error("Response body is not readable");let f="",l=!1;for(;!l;){const w=await d.read();if(l=w.done,l)break;const S=w.value;f+=g.decode(S,{stream:!0});const y=f.split(`
`);f=y.pop()||"";for(const p of y)if(p.startsWith("data: ")){const j=p.slice(6).trim();if(!j)continue;try{const k=JSON.parse(j);if(k.type==="content"&&k.content)r(k.content),k.conversation_id&&n(k.conversation_id);else if(k.type==="done"){k.conversation_id&&n(k.conversation_id),i(k.tokens_used||0);return}else if(k.type==="error"&&k.error){o(k.error);return}}catch{console.debug("Non-JSON SSE data:",j)}}}i(0)}catch(u){o(u instanceof Error?u.message:"Failed to send message")}},getConversations:async()=>{const s=localStorage.getItem("token"),a=await fetch(`${A}/chat/conversations`,{headers:{Authorization:`Bearer ${s}`}});if(!a.ok)throw new Error("Failed to fetch conversations");return(await a.json()).conversations},getMessages:async s=>{const a=localStorage.getItem("token"),t=await fetch(`${A}/chat/conversations/${s}/messages`,{headers:{Authorization:`Bearer ${a}`}});if(!t.ok)throw new Error("Failed to fetch messages");return(await t.json()).messages},deleteConversation:async s=>{const a=localStorage.getItem("token");if(!(await fetch(`${A}/chat/conversations/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})).ok)throw new Error("Failed to delete conversation")},createConversation:async()=>{const s=localStorage.getItem("token"),a=await fetch(`${A}/chat/conversations`,{method:"POST",headers:{Authorization:`Bearer ${s}`}});if(!a.ok)throw new Error("Failed to create conversation");return(await a.json()).id}},Ft=({message:s})=>{const a=s.role==="user";return e.jsxs("div",{className:`flex gap-3 ${a?"flex-row-reverse":""}`,children:[e.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${a?"bg-cyan-600":"bg-gradient-to-br from-purple-600 to-indigo-600"}`,children:a?e.jsx(ye,{className:"w-4 h-4 text-white"}):e.jsx(jt,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:`flex-1 max-w-[80%] ${a?"text-right":"text-left"}`,children:[e.jsx("div",{className:`inline-block p-3 rounded-lg ${a?"bg-cyan-600 text-white rounded-tr-sm":"bg-gray-700 text-gray-100 rounded-tl-sm"}`,children:a?e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.content}):e.jsxs("div",{className:"text-sm prose prose-sm prose-invert max-w-none",children:[e.jsx(Ot,{components:{a:({href:t,children:r})=>e.jsx("a",{href:t,className:"text-cyan-400 hover:text-cyan-300 underline",onClick:n=>{t!=null&&t.startsWith("/")&&(n.preventDefault(),window.location.href=t)},children:r}),code:({className:t,children:r})=>!t?e.jsx("code",{className:"bg-gray-800 px-1 py-0.5 rounded text-cyan-300 text-xs",children:r}):e.jsx("code",{className:"block bg-gray-800 p-2 rounded text-xs overflow-x-auto",children:r}),ul:({children:t})=>e.jsx("ul",{className:"list-disc list-inside space-y-1 my-2",children:t}),ol:({children:t})=>e.jsx("ol",{className:"list-decimal list-inside space-y-1 my-2",children:t}),p:({children:t})=>e.jsx("p",{className:"mb-2 last:mb-0",children:t})},children:s.content}),s.isStreaming&&e.jsx("span",{className:"inline-block w-2 h-4 bg-cyan-400 animate-pulse ml-1"})]})}),e.jsx("div",{className:`text-xs text-gray-500 mt-1 ${a?"text-right":"text-left"}`,children:new Date(s.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},Bt=({onSend:s,isLoading:a,disabled:t})=>{const[r,n]=b.useState(""),i=b.useRef(null);b.useEffect(()=>{i.current&&(i.current.style.height="auto",i.current.style.height=`${Math.min(i.current.scrollHeight,120)}px`)},[r]);const o=c=>{c.preventDefault(),r.trim()&&!a&&!t&&(s(r.trim()),n(""),i.current&&(i.current.style.height="auto"))},h=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),o(c))};return e.jsxs("form",{onSubmit:o,className:"flex items-end gap-2",children:[e.jsx("div",{className:"flex-1 relative",children:e.jsx("textarea",{ref:i,value:r,onChange:c=>n(c.target.value),onKeyDown:h,placeholder:"Ask anything about your security data...",disabled:a||t,className:`w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg
                     text-white placeholder-gray-400 resize-none
                     focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent
                     disabled:opacity-50 disabled:cursor-not-allowed
                     text-sm min-h-[40px] max-h-[120px]`,rows:1})}),e.jsx("button",{type:"submit",disabled:!r.trim()||a||t,className:`flex-shrink-0 p-2 bg-cyan-600 hover:bg-cyan-700
                   disabled:bg-gray-600 disabled:cursor-not-allowed
                   rounded-lg transition-colors`,children:a?e.jsx(kt,{className:"w-5 h-5 text-white animate-spin"}):e.jsx(Nt,{className:"w-5 h-5 text-white"})})]})},_t=()=>{const s=z(),a=b.useRef(null),{messages:t,conversationId:r,isLoading:n,error:i,addMessage:o,appendToLastMessage:h,finalizeLastMessage:c,setLoading:u,setError:d,setConversationId:g}=Ne();b.useEffect(()=>{var l;(l=a.current)==null||l.scrollIntoView({behavior:"smooth"})},[t]);const f=async l=>{const w={id:crypto.randomUUID(),role:"user",content:l,timestamp:new Date().toISOString()};o(w);const S={id:crypto.randomUUID(),role:"assistant",content:"",timestamp:new Date().toISOString(),isStreaming:!0};o(S),u(!0),d(null);try{await D.sendMessage(l,r,s.pathname,y=>{h(y)},y=>{g(y)},()=>{c(),u(!1)},y=>{d(y),c(),u(!1)})}catch(y){d(y instanceof Error?y.message:"Failed to send message"),u(!1)}};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-purple-600 to-indigo-600 flex items-center justify-center mb-4",children:e.jsx(G,{className:"w-6 h-6 text-white"})}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Zeus"}),e.jsx("p",{className:"text-sm text-gray-400 max-w-xs",children:"I have access to your security data and can help you understand vulnerabilities, plan scans, and navigate the platform."}),e.jsxs("div",{className:"mt-4 space-y-2 text-xs text-gray-500",children:[e.jsx("p",{children:"Try asking:"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:'"What are my most critical vulnerabilities?"'}),e.jsx("li",{children:'"How do I start a new scan?"'}),e.jsx("li",{children:'"Explain CVE-2024-1234 to me"'})]})]})]}):e.jsx(e.Fragment,{children:t.map(l=>e.jsx(Ft,{message:l},l.id))}),e.jsx("div",{ref:a})]}),i&&e.jsxs("div",{className:"mx-4 mb-2 p-2 bg-red-900/50 border border-red-700 rounded-lg flex items-center gap-2 text-sm text-red-300",children:[e.jsx(we,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:i})]}),e.jsx("div",{className:"p-4 border-t border-gray-700",children:e.jsx(Bt,{onSend:f,isLoading:n})})]})},Ht=()=>{const{isOpen:s,isMinimized:a,messages:t,setOpen:r,setMinimized:n,startNewConversation:i}=Ne();if(!me(d=>d.isAuthenticated))return null;const h=()=>{r(!1),n(!1)},c=()=>{n(!0)},u=()=>{i()};return!s||a?e.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:e.jsxs("button",{onClick:()=>{r(!0),n(!1)},className:`group relative w-14 h-14 bg-gradient-to-br from-purple-600 to-indigo-600
                     hover:from-purple-500 hover:to-indigo-500
                     text-white rounded-full shadow-lg
                     flex items-center justify-center transition-all duration-200
                     hover:scale-105 hover:shadow-xl`,"aria-label":"Open Zeus AI Assistant",children:[e.jsx(ce,{className:"w-6 h-6"}),t.length>0&&e.jsx("span",{className:`absolute -top-1 -right-1 w-5 h-5 bg-cyan-500 rounded-full
                           text-xs font-medium flex items-center justify-center`,children:t.length>99?"99+":t.length}),e.jsx("span",{className:`absolute bottom-full right-0 mb-2 px-2 py-1 bg-gray-800 text-white
                         text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity
                         whitespace-nowrap pointer-events-none`,children:"Zeus"})]})}):e.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:e.jsxs("div",{className:`w-96 h-[500px] bg-gray-800 border border-gray-700
                      rounded-lg shadow-2xl flex flex-col overflow-hidden
                      animate-in slide-in-from-bottom-4 duration-200`,children:[e.jsxs("div",{className:`flex items-center justify-between px-4 py-3
                        bg-gradient-to-r from-purple-600 to-indigo-600`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5 text-white"}),e.jsx("span",{className:"font-medium text-white",children:"Zeus"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:u,className:`p-1.5 text-white/80 hover:text-white hover:bg-white/10 rounded
                         transition-colors`,title:"New conversation",children:e.jsx(Ct,{className:"w-4 h-4"})}),e.jsx("button",{onClick:c,className:`p-1.5 text-white/80 hover:text-white hover:bg-white/10 rounded
                         transition-colors`,title:"Minimize",children:e.jsx(St,{className:"w-4 h-4"})}),e.jsx("button",{onClick:h,className:`p-1.5 text-white/80 hover:text-white hover:bg-white/10 rounded
                         transition-colors`,title:"Close",children:e.jsx(It,{className:"w-4 h-4"})})]})]}),e.jsx(_t,{})]})})},Ce=T()((s,a)=>({isOpen:!1,context:null,conversationId:null,open:t=>{s({isOpen:!0,context:t||null})},close:()=>{s({isOpen:!1})},toggle:()=>{const{isOpen:t}=a();s({isOpen:!t})},setContext:t=>{s({context:t})},setConversationId:t=>{s({conversationId:t})},openWithPrompt:(t,r)=>{s({isOpen:!0,context:{...r,initialPrompt:t}})}})),Kt=[{id:"explain-vuln",label:"Explain Vulnerability",icon:"ðŸ”",prompt:"Explain the vulnerability CVE-",description:"Get a plain-English explanation of any CVE"},{id:"attack-path",label:"Attack Path Analysis",icon:"ðŸŽ¯",prompt:"Analyze the attack path for compromising ",description:"Understand how an attacker could exploit vulnerabilities"},{id:"remediation",label:"Remediation Script",icon:"ðŸ”§",prompt:"Generate a remediation script for ",description:"Auto-generate fix scripts for common issues"},{id:"executive-summary",label:"Executive Summary",icon:"ðŸ“Š",prompt:"Write an executive summary for the latest scan results",description:"Draft professional summaries for stakeholders"},{id:"risk-priority",label:"Risk Prioritization",icon:"âš¡",prompt:"Prioritize the vulnerabilities from my last scan by business risk",description:"AI-ranked vulnerability list based on context"},{id:"threat-brief",label:"Threat Briefing",icon:"ðŸ“°",prompt:"Give me a threat briefing for today",description:"Daily AI-generated threat summary"}],Ut=({isOpen:s,onClose:a,context:t})=>{const r=Ce(),n=s??r.isOpen,i=a??r.close,o=t??r.context,[h,c]=b.useState([{id:"1",role:"assistant",content:"Hello! I'm your AI Security Copilot. I can help you understand vulnerabilities, analyze attack paths, generate remediation scripts, and write reports. How can I assist you today?",timestamp:new Date,type:"text"}]),[u,d]=b.useState(""),[g,f]=b.useState(!1),[l,w]=b.useState(!1),[S,y]=b.useState(!0),[p,j]=b.useState(null),k=b.useRef(null),$=b.useRef(null);de(),b.useEffect(()=>{var m;(m=k.current)==null||m.scrollIntoView({behavior:"smooth"})},[h]),b.useEffect(()=>{n&&$.current&&$.current.focus()},[n]),b.useEffect(()=>{o!=null&&o.initialPrompt&&n&&(d(o.initialPrompt),r.setContext({...o,initialPrompt:void 0}))},[o==null?void 0:o.initialPrompt,n,r,o]),b.useEffect(()=>{(async()=>{if(p)try{const x=await D.getMessages(p);if(x.length>0){const N=x.map(I=>({id:I.id,role:I.role,content:I.content,timestamp:new Date(I.created_at),type:I.content.includes("```")?"code":"text"}));c(N),y(!1)}}catch(x){console.debug("Could not load conversation history:",x)}})()},[p]);const Se=b.useCallback(()=>{if(!o)return null;const m=[];return o.scanId&&m.push(`Currently viewing scan: ${o.scanId}`),o.vulnerabilityId&&m.push(`Currently viewing vulnerability: ${o.vulnerabilityId}`),o.assetId&&m.push(`Currently viewing asset: ${o.assetId}`),o.pageContext&&m.push(o.pageContext),m.length>0?m.join(". "):null},[o]),Z=async()=>{if(!u.trim()||g||l)return;const m={id:Date.now().toString(),role:"user",content:u.trim(),timestamp:new Date,type:"text"};c(C=>[...C,m]),d(""),f(!0),w(!1),y(!1);const x=(Date.now()+1).toString(),N={id:x,role:"assistant",content:"",timestamp:new Date,type:"text",isStreaming:!0};c(C=>[...C,N]);const I=Se();try{await D.sendMessage(m.content,p,I,C=>{f(!1),w(!0),c(O=>O.map(v=>v.id===x?{...v,content:v.content+C}:v))},C=>{j(C),r.setConversationId(C)},C=>{f(!1),w(!1),c(O=>O.map(v=>v.id===x?{...v,isStreaming:!1,type:v.content.includes("```")?"code":"text"}:v))},C=>{f(!1),w(!1),c(O=>O.map(v=>v.id===x?{...v,content:`Error: ${C}. Please try again.`,isStreaming:!1}:v))})}catch{f(!1),w(!1),c(O=>O.map(v=>v.id===x?{...v,content:"An error occurred. Please try again.",isStreaming:!1}:v))}},Ie=m=>{var N;let x=m.prompt;o!=null&&o.vulnerabilityId&&m.id==="explain-vuln"?x=`Explain the vulnerability ${o.vulnerabilityId}`:o!=null&&o.scanId&&m.id==="executive-summary"?x=`Write an executive summary for scan ${o.scanId}`:o!=null&&o.scanId&&m.id==="risk-priority"&&(x=`Prioritize the vulnerabilities from scan ${o.scanId} by business risk`),d(x),y(!1),(N=$.current)==null||N.focus()},Oe=m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),Z())},Ae=async()=>{if(p)try{await D.deleteConversation(p)}catch(m){console.debug("Could not delete conversation:",m)}j(null),r.setConversationId(null),c([{id:"1",role:"assistant",content:"Chat cleared. How can I help you with your security assessment?",timestamp:new Date,type:"text"}]),y(!0)},Me=m=>m.split(`
`).map((x,N)=>x.startsWith("```")?null:x.startsWith("## ")?e.jsx("h3",{className:"text-lg font-bold mt-2 mb-1",children:x.replace(/^##\s*/,"")},N):x.startsWith("### ")?e.jsx("h4",{className:"text-base font-semibold mt-2 mb-1",children:x.replace(/^###\s*/,"")},N):x.startsWith("**")&&x.endsWith("**")?e.jsx("p",{className:"font-bold",children:x.replace(/\*\*/g,"")},N):x.startsWith("|")?e.jsx("p",{className:"font-mono text-xs",children:x},N):x.startsWith("- ")||x.startsWith("* ")?e.jsxs("p",{className:"ml-4",children:["â€¢ ",x.slice(2)]},N):x.match(/^\d+\.\s/)?e.jsx("p",{className:"ml-4",children:x},N):x?e.jsx("p",{children:x},N):e.jsx("br",{},N));return n?e.jsxs("div",{className:"fixed inset-y-0 right-0 w-full sm:w-[450px] bg-gray-900 border-l border-gray-700 shadow-2xl z-50 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:e.jsx(G,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"AI Copilot"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Powered by Claude"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:Ae,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",title:"Clear chat",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",title:"Close (Cmd+K)",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),o&&(o.scanId||o.vulnerabilityId||o.assetId)&&e.jsx("div",{className:"px-4 py-2 bg-blue-900/30 border-b border-blue-800/50",children:e.jsxs("p",{className:"text-sm text-blue-300",children:[e.jsx("span",{className:"font-medium",children:"Context: "}),o.scanId&&`Scan #${o.scanId}`,o.vulnerabilityId&&`Vulnerability ${o.vulnerabilityId}`,o.assetId&&`Asset ${o.assetId}`]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[h.map(m=>e.jsx("div",{className:`flex ${m.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[85%] rounded-lg p-3 ${m.role==="user"?"bg-blue-600 text-white":"bg-gray-800 text-gray-100"}`,children:[e.jsxs("div",{className:"prose prose-invert prose-sm max-w-none",children:[Me(m.content),m.isStreaming&&e.jsx("span",{className:"inline-block w-2 h-4 bg-blue-400 animate-pulse ml-1"})]}),e.jsx("p",{className:"text-xs opacity-50 mt-2",children:m.timestamp.toLocaleTimeString()})]})},m.id)),g&&!l&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gray-800 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})}),e.jsx("div",{ref:k})]}),S&&e.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-800/50",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Quick Actions:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Kt.map(m=>e.jsxs("button",{onClick:()=>Ie(m),className:"flex items-center gap-2 p-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors text-left",children:[e.jsx("span",{className:"text-lg",children:m.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:m.label}),e.jsx("p",{className:"text-xs text-gray-400 line-clamp-1",children:m.description})]})]},m.id))})]}),e.jsx("div",{className:"px-4 py-2 border-t border-gray-700 bg-gray-800/30",children:e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["Press ",e.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-700 rounded text-gray-300",children:"Cmd"})," + ",e.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-700 rounded text-gray-300",children:"K"})," to toggle"]})}),e.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-800",children:[e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("textarea",{ref:$,value:u,onChange:m=>d(m.target.value),onKeyDown:Oe,placeholder:"Ask me anything about your security posture...",className:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500",rows:2,disabled:g||l}),e.jsx("button",{onClick:Z,disabled:!u.trim()||g||l,className:"px-4 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Press Enter to send, Shift+Enter for new line"})]})]}):null},Jt=({children:s})=>{const{user:a}=U(),{sidebarCollapsed:t}=q(),r=Q(),{isOpen:n,toggle:i}=Ce();b.useEffect(()=>{const h=c=>{(c.metaKey||c.ctrlKey)&&c.key==="k"&&(c.preventDefault(),i()),c.key==="Escape"&&n&&i()};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[i,n]);const o=a&&!r?t?"lg:ml-16":"lg:ml-64":"";return e.jsxs("div",{className:"min-h-screen bg-light-bg dark:bg-dark-bg transition-colors",children:[a&&e.jsx(Wt,{}),e.jsxs("div",{className:`flex flex-col min-h-screen transition-all duration-300 ${o}`,children:[e.jsx($t,{}),e.jsx("main",{className:"flex-1 px-4 sm:px-6 lg:px-8 py-6 w-full max-w-7xl mx-auto",children:s}),e.jsx(Lt,{})]}),e.jsx(Ht,{}),a&&e.jsx(Ut,{})]})};export{Jt as L,Et as a,Ce as u};
