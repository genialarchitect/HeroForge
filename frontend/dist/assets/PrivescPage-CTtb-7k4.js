import{b as R,u as E,d as C,j as e}from"./vendor-state-BjT_zREg.js";import{r as i}from"./vendor-react-5KxtEOLM.js";import{B as h,ar as P,a2 as K,aa as p,aN as B,ab as D,aY as M,X as O,p as Q,i as $,g as z,l as X,_ as G,I as Y,$ as J}from"./vendor-ui-C4nf_tR6.js";import{L as V}from"./Layout-DQwy8A8G.js";import{u as Z,E as ee}from"./useRequireEngagement-BnpzaIEh.js";import{a9 as u,B as y}from"./index-RI0GBk2h.js";import"./vendor-markdown-BGP8SuZQ.js";import"./vendor-utils-DfRopTPV.js";const te=({onSubmit:l,isSubmitting:c,hasEngagement:t})=>{const[n,d]=i.useState("linux"),[a,o]=i.useState(""),[m,g]=i.useState(""),[b,s]=i.useState(""),[j,L]=i.useState(""),[k,I]=i.useState("22"),[v,T]=i.useState(""),[N,F]=i.useState(""),[f,U]=i.useState("5985"),[w,q]=i.useState(!1),[S,A]=i.useState(!0),[_,W]=i.useState("300"),H=r=>{if(r.preventDefault(),!a){h.error("Target is required");return}const x={target:a,os_type:n,run_peas:S,timeout_secs:parseInt(_)||300};n==="linux"?(m&&(x.ssh_username=m),b&&(x.ssh_password=b),j&&(x.ssh_key_path=j),k&&(x.ssh_port=parseInt(k)||22)):(v&&(x.winrm_username=v),N&&(x.winrm_password=N),f&&(x.winrm_port=parseInt(f)||5985),x.winrm_https=w),l(x)};return e.jsxs("form",{onSubmit:H,className:"bg-light-surface dark:bg-dark-surface rounded-lg p-6 border border-light-border dark:border-dark-border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-slate-900 dark:text-white",children:"New Privilege Escalation Scan"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Target Host"}),e.jsx("input",{type:"text",value:a,onChange:r=>o(r.target.value),placeholder:"192.168.1.100 or hostname",className:"w-full px-3 py-2 rounded-lg border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Operating System"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>d("linux"),className:`flex-1 py-2 px-4 rounded-lg border ${n==="linux"?"bg-primary text-white border-primary":"border-light-border dark:border-dark-border text-slate-700 dark:text-slate-300 hover:bg-light-hover dark:hover:bg-dark-hover"}`,children:"Linux"}),e.jsx("button",{type:"button",onClick:()=>d("windows"),className:`flex-1 py-2 px-4 rounded-lg border ${n==="windows"?"bg-primary text-white border-primary":"border-light-border dark:border-dark-border text-slate-700 dark:text-slate-300 hover:bg-light-hover dark:hover:bg-dark-hover"}`,children:"Windows"})]})]})]}),n==="linux"?e.jsxs("div",{className:"border border-light-border dark:border-dark-border rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"SSH Connection"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Username"}),e.jsx("input",{type:"text",value:m,onChange:r=>g(r.target.value),placeholder:"root",className:"w-full px-3 py-2 rounded-lg border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Port"}),e.jsx("input",{type:"number",value:k,onChange:r=>I(r.target.value),className:"w-full px-3 py-2 rounded-lg border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Password"}),e.jsx("input",{type:"password",value:b,onChange:r=>s(r.target.value),placeholder:"Leave empty for key auth",className:"w-full px-3 py-2 rounded-lg border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"SSH Key Path"}),e.jsx("input",{type:"text",value:j,onChange:r=>L(r.target.value),placeholder:"/path/to/id_rsa",className:"w-full px-3 py-2 rounded-lg border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white text-sm"})]})]})]}):e.jsxs("div",{className:"border border-light-border dark:border-dark-border rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"WinRM Connection"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Username"}),e.jsx("input",{type:"text",value:v,onChange:r=>T(r.target.value),placeholder:"Administrator",className:"w-full px-3 py-2 rounded-lg border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Port"}),e.jsx("input",{type:"number",value:f,onChange:r=>U(r.target.value),className:"w-full px-3 py-2 rounded-lg border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-500 dark:text-slate-400 mb-1",children:"Password"}),e.jsx("input",{type:"password",value:N,onChange:r=>F(r.target.value),className:"w-full px-3 py-2 rounded-lg border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white text-sm"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"winrm-https",checked:w,onChange:r=>q(r.target.checked),className:"mr-2"}),e.jsx("label",{htmlFor:"winrm-https",className:"text-sm text-slate-700 dark:text-slate-300",children:"Use HTTPS"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center text-sm text-slate-700 dark:text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:S,onChange:r=>A(r.target.checked),className:"mr-2"}),"Run ",n==="linux"?"LinPEAS":"WinPEAS"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Timeout:"}),e.jsx("input",{type:"number",value:_,onChange:r=>W(r.target.value),className:"w-20 px-2 py-1 rounded border border-light-border dark:border-dark-border bg-light-bg dark:bg-dark-bg text-slate-900 dark:text-white text-sm"}),e.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"seconds"})]})]}),e.jsx(y,{type:"submit",variant:"primary",disabled:c||!t,children:c?e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"h-4 w-4 mr-2 animate-spin"}),"Starting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Start Scan"]})})]})]})},se=({finding:l})=>{const[c,t]=i.useState(!1),n={critical:"bg-red-500/20 text-red-400 border-red-500/30",high:"bg-orange-500/20 text-orange-400 border-orange-500/30",medium:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",low:"bg-blue-500/20 text-blue-400 border-blue-500/30",info:"bg-slate-500/20 text-slate-400 border-slate-500/30"},d=a=>{navigator.clipboard.writeText(a),h.success("Copied to clipboard")};return e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 cursor-pointer hover:bg-light-hover dark:hover:bg-dark-hover flex items-center justify-between",onClick:()=>t(!c),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[c?e.jsx(X,{className:"h-4 w-4 text-slate-500"}):e.jsx(G,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded border ${n[l.severity]||n.info}`,children:l.severity.toUpperCase()}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white",children:l.title})]}),e.jsx("div",{className:"flex items-center gap-2",children:l.mitre_techniques.length>0&&e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:l.mitre_techniques.join(", ")})})]}),c&&e.jsxs("div",{className:"border-t border-light-border dark:border-dark-border p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:l.description})]}),l.exploitation_steps.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Exploitation Steps"}),e.jsx("ol",{className:"list-decimal list-inside space-y-1",children:l.exploitation_steps.map((a,o)=>e.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-400 flex items-start gap-2",children:[e.jsx("span",{className:"flex-1 font-mono bg-slate-100 dark:bg-slate-800 rounded px-2 py-1",children:a}),e.jsx("button",{onClick:m=>{m.stopPropagation(),d(a)},className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:e.jsx(Y,{className:"h-4 w-4"})})]},o))})]}),l.references.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"References"}),e.jsx("ul",{className:"space-y-1",children:l.references.map((a,o)=>e.jsx("li",{children:e.jsxs("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline flex items-center gap-1",children:[a,e.jsx(J,{className:"h-3 w-3"})]})},o))})]})]})]})},re=({scanId:l,onClose:c})=>{const{data:t,isLoading:n}=E({queryKey:["privesc-scan",l],queryFn:()=>u.getScan(l).then(a=>a.data),refetchInterval:a=>{var o;return((o=a.state.data)==null?void 0:o.status)==="running"?3e3:!1}});if(n)return e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface rounded-lg p-6 border border-light-border dark:border-dark-border",children:e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(p,{className:"h-8 w-8 animate-spin text-primary"})})});if(!t)return e.jsx("div",{className:"bg-light-surface dark:bg-dark-surface rounded-lg p-6 border border-light-border dark:border-dark-border",children:e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Scan not found"})});const d=t.statistics;return e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface rounded-lg border border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-light-border dark:border-dark-border",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:t.target}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[t.os_type.toUpperCase()," - Started ",new Date(t.started_at).toLocaleString()]})]}),e.jsx("button",{onClick:c,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:e.jsx(O,{className:"h-5 w-5"})})]}),t.system_info&&t.system_info.hostname&&e.jsxs("div",{className:"p-4 border-b border-light-border dark:border-dark-border",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"System Information"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Hostname:"}),e.jsx("span",{className:"ml-2 text-slate-900 dark:text-white",children:t.system_info.hostname})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"OS:"}),e.jsx("span",{className:"ml-2 text-slate-900 dark:text-white",children:t.system_info.os_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Kernel:"}),e.jsx("span",{className:"ml-2 text-slate-900 dark:text-white",children:t.system_info.kernel_version})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"User:"}),e.jsx("span",{className:"ml-2 text-slate-900 dark:text-white",children:t.system_info.current_user})]})]})]}),e.jsx("div",{className:"p-4 border-b border-light-border dark:border-dark-border",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-red-500/10 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:d.critical_findings}),e.jsx("div",{className:"text-xs text-red-400",children:"Critical"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-500/10 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400",children:d.high_findings}),e.jsx("div",{className:"text-xs text-orange-400",children:"High"})]}),e.jsxs("div",{className:"text-center p-3 bg-yellow-500/10 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:d.medium_findings}),e.jsx("div",{className:"text-xs text-yellow-400",children:"Medium"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-500/10 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:d.low_findings}),e.jsx("div",{className:"text-xs text-blue-400",children:"Low"})]}),e.jsxs("div",{className:"text-center p-3 bg-slate-500/10 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-400",children:d.info_findings}),e.jsx("div",{className:"text-xs text-slate-400",children:"Info"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-500/10 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:d.exploitable_count}),e.jsx("div",{className:"text-xs text-green-400",children:"Exploitable"})]})]})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-4",children:["Findings (",t.findings.length,")"]}),t.findings.length===0?e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-center py-8",children:t.status==="running"?"Scan in progress...":"No findings discovered"}):e.jsx("div",{className:"space-y-2",children:t.findings.map(a=>e.jsx(se,{finding:a},a.id))})]}),t.errors.length>0&&e.jsxs("div",{className:"p-4 border-t border-light-border dark:border-dark-border",children:[e.jsx("h4",{className:"text-sm font-medium text-red-400 mb-2",children:"Errors"}),e.jsx("ul",{className:"space-y-1",children:t.errors.map((a,o)=>e.jsx("li",{className:"text-sm text-red-400",children:a},o))})]})]})},me=()=>{const l=R(),[c,t]=i.useState(null),{hasEngagement:n}=Z(),{data:d,isLoading:a}=E({queryKey:["privesc-scans"],queryFn:()=>u.listScans(50,0).then(s=>s.data),refetchInterval:5e3}),o=C({mutationFn:u.startScan,onSuccess:s=>{h.success("Privilege escalation scan started"),l.invalidateQueries({queryKey:["privesc-scans"]}),t(s.data.id)},onError:()=>{h.error("Failed to start scan")}}),m=C({mutationFn:u.deleteScan,onSuccess:()=>{h.success("Scan deleted"),l.invalidateQueries({queryKey:["privesc-scans"]}),c&&t(null)},onError:()=>{h.error("Failed to delete scan")}}),g=(d==null?void 0:d.scans)||[],b=s=>{switch(s){case"completed":return e.jsx(z,{className:"h-4 w-4 text-green-400"});case"running":return e.jsx(p,{className:"h-4 w-4 text-primary animate-spin"});case"failed":return e.jsx($,{className:"h-4 w-4 text-red-400"});default:return e.jsx(Q,{className:"h-4 w-4 text-slate-400"})}};return e.jsx(V,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[e.jsx(P,{className:"h-6 w-6 text-primary"}),"Privilege Escalation Scanner"]}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Automated privilege escalation enumeration with LinPEAS/WinPEAS integration"})]})}),e.jsx(ee,{toolName:"Privilege Escalation Scanner",className:"mb-6"}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(K,{className:"h-5 w-5 text-blue-400 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-400",children:[e.jsx("p",{className:"font-medium",children:"About Privilege Escalation Scanning"}),e.jsx("p",{className:"mt-1",children:"This tool runs LinPEAS (Linux) or WinPEAS (Windows) on target systems to identify potential privilege escalation vectors. It checks for SUID binaries, sudo misconfigurations, kernel exploits, service weaknesses, and more. GTFOBins/LOLBAS references are included for exploitation guidance."})]})]}),e.jsx(te,{onSubmit:s=>o.mutate(s),isSubmitting:o.isPending,hasEngagement:n}),c?e.jsx(re,{scanId:c,onClose:()=>t(null)}):e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface rounded-lg border border-light-border dark:border-dark-border",children:[e.jsx("div",{className:"p-4 border-b border-light-border dark:border-dark-border",children:e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:"Recent Scans"})}),a?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(p,{className:"h-8 w-8 animate-spin text-primary"})}):g.length===0?e.jsxs("div",{className:"text-center py-12 text-slate-500 dark:text-slate-400",children:[e.jsx(P,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No privilege escalation scans yet"}),e.jsx("p",{className:"text-sm mt-1",children:"Start a scan to enumerate potential privilege escalation vectors"})]}):e.jsx("div",{className:"divide-y divide-light-border dark:divide-dark-border",children:g.map(s=>e.jsxs("div",{className:"p-4 hover:bg-light-hover dark:hover:bg-dark-hover flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[b(s.status),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-white",children:s.target}),e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:[s.os_type.toUpperCase()," - ",new Date(s.created_at).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[s.status==="completed"&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.critical_count>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 text-red-400 rounded",children:[s.critical_count," Critical"]}),s.high_count>0&&e.jsxs("span",{className:"px-2 py-1 bg-orange-500/20 text-orange-400 rounded",children:[s.high_count," High"]}),e.jsxs("span",{className:"text-slate-500",children:[s.findings_count," findings"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>t(s.id),children:e.jsx(B,{className:"h-4 w-4"})}),e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>m.mutate(s.id),children:e.jsx(D,{className:"h-4 w-4 text-red-400"})})]})]})]},s.id))})]})]})})};export{me as default};
