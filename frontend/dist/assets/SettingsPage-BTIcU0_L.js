import{j as e}from"./vendor-state-BjT_zREg.js";import{r,R as le}from"./vendor-react-5KxtEOLM.js";import{L as ht}from"./Layout-DF6EApG0.js";import{B as l,U as ds,S as ue,ay as ps,M as ts,z as Ee,a as Xe,O as fe,e as Ps,l as Je,_ as pt,aU as gt,aV as ft,aq as jt,ab as ie,aW as Is,p as Ne,v as Fs,m as oe,X as Se,u as Ts,aM as _e,aX as bt,aY as Ds,aZ as Rs,a_ as ns,g as de,k as yt,F as Ye,E as gs,G as fs,s as ls,Z as Ms,o as as,a$ as ms,R as vt,y as Ls,I as he,r as Nt,b0 as Us,H as wt,$ as Ze,a2 as $e,t as Os,b1 as Oe,x as ge,af as xs,al as vs,a6 as $s,K as Te,f as zs,ao as Gs,h as ze,b2 as js,a9 as Fe,W as Vs,Y as Ns,b3 as _t,aN as Bs,V as ws,d as kt,n as is,w as Ct,i as we,b4 as qs,b5 as St,q as Hs,b6 as Ws,b7 as Et,ad as At,b8 as Ks,b9 as bs,ba as Pt,ag as Qs,bb as It}from"./vendor-ui-CaTPr3iI.js";import{p as ss,I as K,B as S,n as Pe,a as Ke,q as Ge,u as je,t as Re,w as Me,e as Ve,x as es,y as cs,z as Be,A as qe,j as Le,b as Ft,v as be,d as ye,C as ke,D as Ce,E as ve,F as He}from"./index-BgPDfr41.js";import{C as B}from"./Card-CV6m9jT5.js";import{L as ee}from"./LoadingSpinner-DiN0bg1Z.js";import{B as te}from"./Badge-Bi3Nk-Vg.js";import{C as Ae}from"./ConfirmationDialog-E60e_YmT.js";import{b as Tt}from"./vendor-utils-DfRopTPV.js";import{S as Dt}from"./ScanComparison-Bgw2FC5i.js";import{S as Rt}from"./ScheduledReports-PTuSrGJJ.js";import{C as Ie}from"./Checkbox-BctekNnY.js";import"./vendor-markdown-BGP8SuZQ.js";import"./vendor-charts-Cw33pWBR.js";const Mt=()=>{var D;const[i,A]=r.useState(null),[w,h]=r.useState(!0),[v,b]=r.useState(!1),[g,M]=r.useState(!1),[s,a]=r.useState(""),[t,c]=r.useState(!1),[d,p]=r.useState(""),[n,T]=r.useState(""),[E,G]=r.useState("");r.useEffect(()=>{f()},[]);const f=async()=>{h(!0);try{const I=await ss.me();A(I.data),a(I.data.email||"")}catch(I){l.error("Failed to load profile"),console.error(I)}finally{h(!1)}},k=async I=>{var z,R;if(I.preventDefault(),!s.trim()){l.error("Email is required");return}b(!0);try{const L=await ss.updateProfile({email:s.trim()});A(L.data),l.success("Profile updated successfully")}catch(L){const N=L;l.error(((R=(z=N.response)==null?void 0:z.data)==null?void 0:R.error)||"Failed to update profile")}finally{b(!1)}},C=async I=>{var z,R;if(I.preventDefault(),!d||!n){l.error("All password fields are required");return}if(n.length<6){l.error("New password must be at least 6 characters");return}if(n!==E){l.error("Passwords do not match");return}M(!0);try{await ss.changePassword({current_password:d,new_password:n}),l.success("Password changed successfully"),c(!1),p(""),T(""),G("")}catch(L){const N=L;l.error(((R=(z=N.response)==null?void 0:z.data)==null?void 0:R.error)||"Failed to change password")}finally{M(!1)}},u=I=>I?new Date(I).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"N/A";return w?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ds,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Profile Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(ds,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Username"}),e.jsx("p",{className:"text-white font-medium",children:i==null?void 0:i.username})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(ue,{className:"h-5 w-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Roles"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:((D=i==null?void 0:i.roles)==null?void 0:D.map(I=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-primary/20 text-primary rounded capitalize",children:I},I)))||e.jsx("span",{className:"text-slate-400",children:"No roles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(ps,{className:"h-5 w-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Member Since"}),e.jsx("p",{className:"text-white",children:u(i==null?void 0:i.created_at)})]})]})]}),e.jsx("form",{onSubmit:k,className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-2",children:[e.jsx(ts,{className:"h-4 w-4"}),"Email Address"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(K,{type:"email",value:s,onChange:I=>a(I.target.value),placeholder:"your@email.com",className:"flex-1"}),e.jsxs(S,{type:"submit",variant:"primary",loading:v,disabled:v||s===(i==null?void 0:i.email),children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Save"]})]})]})})]}),e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Xe,{className:"h-6 w-6 text-yellow-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Security"})]}),!t&&e.jsx(S,{variant:"secondary",onClick:()=>c(!0),children:"Change Password"})]}),t?e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsx(K,{label:"Current Password",type:"password",value:d,onChange:I=>p(I.target.value),placeholder:"Enter current password"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(K,{label:"New Password",type:"password",value:n,onChange:I=>T(I.target.value),placeholder:"Enter new password"}),e.jsx(K,{label:"Confirm New Password",type:"password",value:E,onChange:I=>G(I.target.value),placeholder:"Confirm new password"})]}),n&&E&&n!==E&&e.jsx("p",{className:"text-sm text-red-400",children:"Passwords do not match"}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(S,{type:"button",variant:"secondary",onClick:()=>{c(!1),p(""),T(""),G("")},children:"Cancel"}),e.jsx(S,{type:"submit",variant:"primary",loading:g,disabled:g||!d||!n||n!==E,children:"Update Password"})]})]}):e.jsx("p",{className:"text-slate-400",children:"Keep your account secure by using a strong, unique password."})]}),e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(ue,{className:"h-6 w-6 text-green-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Account Status"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${(i==null?void 0:i.is_active)!==!1?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-white",children:(i==null?void 0:i.is_active)!==!1?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Your account is in good standing."})]})]})},Lt=[{id:"admin",name:"Admin",description:"Full system access"},{id:"user",name:"User",description:"Standard user access"},{id:"auditor",name:"Auditor",description:"Read-only access to all scans"},{id:"viewer",name:"Viewer",description:"Limited view access"}],Ut=()=>{const[i,A]=r.useState([]),[w,h]=r.useState([]),[v,b]=r.useState(!0),[g,M]=r.useState(!1),[s,a]=r.useState(new Set),[t,c]=r.useState(!1),[d,p]=r.useState(!0),[n,T]=r.useState(null),[E,G]=r.useState(!1);r.useEffect(()=>{f()},[]);const f=async()=>{var _;b(!0);try{const x=await Pe.getUsers();A(x.data),p(!0)}catch(x){((_=x.response)==null?void 0:_.status)===403?p(!1):l.error("Failed to load users"),console.error(x)}finally{b(!1)}},k=async()=>{M(!0);try{const _=await Pe.getAuditLogs({limit:50,offset:0});h(_.data.logs)}catch(_){l.error("Failed to load audit logs"),console.error(_)}finally{M(!1)}},C=_=>{const x=new Set(s);x.has(_)?x.delete(_):x.add(_),a(x)},u=async _=>{var x,F;try{await Pe.updateUser(_.id,{is_active:!_.is_active}),l.success(`User ${_.is_active?"deactivated":"activated"}`),f()}catch(j){const Q=j;l.error(((F=(x=Q.response)==null?void 0:x.data)==null?void 0:F.error)||"Failed to update user")}},D=async()=>{var _,x;if(n){G(!0);try{await Pe.deleteUser(n.id),l.success(`User "${n.username}" deleted successfully`),f(),T(null)}catch(F){const j=F;l.error(((x=(_=j.response)==null?void 0:_.data)==null?void 0:x.error)||"Failed to delete user")}finally{G(!1)}}},I=async(_,x)=>{var F,j;try{await Pe.assignRole(_,x),l.success("Role assigned"),f()}catch(Q){const X=Q;l.error(((j=(F=X.response)==null?void 0:F.data)==null?void 0:j.error)||"Failed to assign role")}},z=async(_,x)=>{var F,j;try{await Pe.removeRole(_,x),l.success("Role removed"),f()}catch(Q){const X=Q;l.error(((j=(F=X.response)==null?void 0:F.data)==null?void 0:j.error)||"Failed to remove role")}},R=async _=>{var x,F;try{await Pe.unlockUser(_.id),l.success(`Account "${_.username}" unlocked`),f()}catch(j){const Q=j;l.error(((F=(x=Q.response)==null?void 0:x.data)==null?void 0:F.error)||"Failed to unlock account")}},L=_=>new Date(_).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),N=_=>{switch(_){case"admin":return"bg-red-500/20 text-red-400 border-red-500/30";case"user":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"auditor":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"viewer":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return v?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):d?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ps,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"User Management"})]}),e.jsxs(te,{variant:"status",type:"completed",children:[i.length," users"]})]}),e.jsx("div",{className:"space-y-3",children:i.map(_=>{const x=s.has(_.id),F=_.roles||[];return e.jsxs("div",{className:"bg-dark-bg rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>C(_.id),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"text-slate-400",children:x?e.jsx(Je,{className:"h-4 w-4"}):e.jsx(pt,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${_.is_active!==!1?"bg-green-400":"bg-red-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:_.username}),e.jsx("p",{className:"text-sm text-slate-400",children:_.email})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex gap-1",children:F.map(j=>e.jsx("span",{className:`px-2 py-0.5 text-xs rounded border capitalize ${N(j)}`,children:j},j))}),_.is_locked&&e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded border bg-red-500/20 text-red-400 border-red-500/30 flex items-center gap-1",children:[e.jsx(Xe,{className:"h-3 w-3"}),"Locked"]}),e.jsx("span",{className:"text-xs text-slate-500",children:_.created_at?L(_.created_at):"N/A"})]})]}),x&&e.jsxs("div",{className:"border-t border-dark-border p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"Manage Roles"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:Lt.map(j=>{const Q=F.includes(j.id);return e.jsxs("button",{onClick:X=>{X.stopPropagation(),Q?z(_.id,j.id):I(_.id,j.id)},className:`p-3 rounded-lg border text-left transition-colors ${Q?"bg-primary/20 border-primary/50 text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-primary/30"}`,children:[e.jsx("p",{className:"font-medium text-sm capitalize",children:j.name}),e.jsx("p",{className:"text-xs opacity-75",children:j.description})]},j.id)})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-dark-border",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{variant:_.is_active!==!1?"secondary":"primary",size:"sm",onClick:j=>{j.stopPropagation(),u(_)},children:_.is_active!==!1?e.jsxs(e.Fragment,{children:[e.jsx(gt,{className:"h-4 w-4 mr-1"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(ft,{className:"h-4 w-4 mr-1"}),"Activate"]})}),_.is_locked&&e.jsxs(S,{variant:"primary",size:"sm",onClick:j=>{j.stopPropagation(),R(_)},children:[e.jsx(jt,{className:"h-4 w-4 mr-1"}),"Unlock Account"]})]}),e.jsxs(S,{variant:"secondary",size:"sm",onClick:j=>{j.stopPropagation(),T(_)},className:"text-red-400 hover:text-red-300 hover:bg-red-500/10","aria-label":`Delete user ${_.username}`,children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})]},_.id)})})]}),e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Is,{className:"h-6 w-6 text-purple-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Audit Logs"})]}),e.jsx(S,{variant:"secondary",onClick:()=>{c(!t),!t&&w.length===0&&k()},children:t?"Hide Logs":"Show Logs"})]}),t&&e.jsx(e.Fragment,{children:g?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ee,{})}):w.length===0?e.jsx("p",{className:"text-slate-400 text-center py-8",children:"No audit logs found"}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:w.map(_=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-dark-bg rounded-lg text-sm",children:[e.jsx(Ne,{className:"h-4 w-4 text-slate-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium text-white",children:_.action}),_.target_type&&e.jsxs("span",{className:"text-slate-400",children:["on ",_.target_type]}),_.target_id&&e.jsx("span",{className:"text-xs text-slate-500 font-mono truncate max-w-32",children:_.target_id})]}),_.details&&e.jsx("p",{className:"text-xs text-slate-500 mt-1 truncate",children:_.details})]}),e.jsx("span",{className:"text-xs text-slate-500 whitespace-nowrap",children:L(_.created_at)})]},_.id))})}),!t&&e.jsx("p",{className:"text-slate-400",children:"View a log of administrative actions performed in the system."})]}),e.jsx(Ae,{isOpen:!!n,onClose:()=>T(null),onConfirm:D,title:"Delete User",message:`Are you sure you want to delete user "${n==null?void 0:n.username}"? All their data, including scans and settings, will be permanently removed.`,confirmLabel:"Delete User",variant:"danger",loading:E})]}):e.jsx(B,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(fe,{className:"h-12 w-12 text-yellow-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-slate-400",children:"You don't have permission to access the administration panel."}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Contact an administrator if you need elevated access."})]})})},os=["#ef4444","#f97316","#eab308","#22c55e","#14b8a6","#3b82f6","#8b5cf6","#ec4899","#6366f1","#64748b"],Ot=()=>{const[i,A]=r.useState([]),[w,h]=r.useState(!0),[v,b]=r.useState(!1),[g,M]=r.useState(null),[s,a]=r.useState({name:"",description:"",targets:"",color:os[0]}),[t,c]=r.useState(null),[d,p]=r.useState(!1);r.useEffect(()=>{n()},[]);const n=async()=>{h(!0);try{const C=await Ke.getAll();A(C.data)}catch(C){l.error("Failed to load target groups"),console.error(C)}finally{h(!1)}},T=()=>{a({name:"",description:"",targets:"",color:os[0]}),M(null),b(!1)},E=C=>{const u=JSON.parse(C.targets||"[]");a({name:C.name,description:C.description||"",targets:u.join(`
`),color:C.color}),M(C.id),b(!0)},G=async C=>{var D,I;C.preventDefault();const u=s.targets.split(`
`).map(z=>z.trim()).filter(z=>z.length>0);if(!s.name.trim()){l.error("Name is required");return}if(u.length===0){l.error("At least one target is required");return}try{g?(await Ke.update(g,{name:s.name,description:s.description||void 0,targets:u,color:s.color}),l.success("Target group updated")):(await Ke.create({name:s.name,description:s.description||void 0,targets:u,color:s.color}),l.success("Target group created")),T(),n()}catch(z){const R=z;l.error(((I=(D=R.response)==null?void 0:D.data)==null?void 0:I.error)||"Failed to save target group")}},f=async()=>{var C,u;if(t){p(!0);try{await Ke.delete(t.id),l.success(`Target group "${t.name}" deleted`),n(),c(null)}catch(D){const I=D;l.error(((u=(C=I.response)==null?void 0:C.data)==null?void 0:u.error)||"Failed to delete")}finally{p(!1)}}},k=C=>{try{return JSON.parse(C||"[]")}catch{return[]}};return w?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Target Groups"})]}),!v&&e.jsxs(S,{variant:"primary",onClick:()=>b(!0),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"New Group"]})]})}),v&&e.jsx(B,{children:e.jsxs("form",{onSubmit:G,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:g?"Edit Target Group":"Create Target Group"}),e.jsx("button",{type:"button",onClick:T,className:"text-slate-400 hover:text-white",children:e.jsx(Se,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:C=>a({...s,name:C.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Production Servers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Color"}),e.jsx("div",{className:"flex gap-2",children:os.map(C=>e.jsx("button",{type:"button",onClick:()=>a({...s,color:C}),className:`w-8 h-8 rounded-full border-2 transition-all ${s.color===C?"border-white scale-110":"border-transparent"}`,style:{backgroundColor:C}},C))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:s.description,onChange:C=>a({...s,description:C.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Targets (one per line)"}),e.jsx("textarea",{value:s.targets,onChange:C=>a({...s,targets:C.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:5,placeholder:`192.168.1.0/24
10.0.0.1
example.com`})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(S,{type:"button",variant:"secondary",onClick:T,children:"Cancel"}),e.jsxs(S,{type:"submit",variant:"primary",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),g?"Update":"Create"]})]})]})}),i.length===0&&!v?e.jsx(B,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ts,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No target groups yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create groups to organize your scan targets"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(C=>{const u=k(C.targets);return e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:C.color}}),e.jsx("h4",{className:"font-medium text-white",children:C.name})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>E(C),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>c(C),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete target group ${C.name}`,children:e.jsx(ie,{className:"h-4 w-4"})})]})]}),C.description&&e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:C.description}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:[u.length," target",u.length!==1?"s":""]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[u.slice(0,5).map((D,I)=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-300 font-mono",children:D},I)),u.length>5&&e.jsxs("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-500",children:["+",u.length-5," more"]})]})]})]},C.id)})}),e.jsx(Ae,{isOpen:!!t,onClose:()=>c(null),onConfirm:f,title:"Delete Target Group",message:`Are you sure you want to delete the target group "${t==null?void 0:t.name}"? Scheduled scans using this group will need to be updated.`,confirmLabel:"Delete Group",variant:"danger",loading:d})]})},_s={name:"",description:"",schedule_type:"daily",schedule_value:"02:00",targets:"",port_range_start:1,port_range_end:1e3,threads:100,enable_os_detection:!0,enable_service_detection:!0,enable_vuln_scan:!0,enable_enumeration:!1},ks=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],$t=()=>{const[i,A]=r.useState([]),[w,h]=r.useState([]),[v,b]=r.useState(!0),[g,M]=r.useState(!1),[s,a]=r.useState(null),[t,c]=r.useState(_s),[d,p]=r.useState(0),[n,T]=r.useState(1),[E,G]=r.useState(null),[f,k]=r.useState(!1);r.useEffect(()=>{C()},[]);const C=async()=>{b(!0);try{const[x,F]=await Promise.all([Ge.getAll(),Ke.getAll()]);A(x.data),h(F.data)}catch(x){l.error("Failed to load scheduled scans"),console.error(x)}finally{b(!1)}},u=()=>{c(_s),a(null),M(!1),p(0),T(1)},D=x=>{const F=JSON.parse(x.config);if(c({name:x.name,description:x.description||"",schedule_type:x.schedule_type,schedule_value:x.schedule_value,targets:F.targets.join(`
`),port_range_start:F.port_range[0],port_range_end:F.port_range[1],threads:F.threads,enable_os_detection:F.enable_os_detection,enable_service_detection:F.enable_service_detection,enable_vuln_scan:F.enable_vuln_scan,enable_enumeration:F.enable_enumeration}),x.schedule_type==="weekly"){const j=x.schedule_value.split(" ");j.length>=2&&p(parseInt(j[1])||0)}else if(x.schedule_type==="monthly"){const j=x.schedule_value.split(" ");j.length>=2&&T(parseInt(j[1])||1)}a(x.id),M(!0)},I=()=>{const x=t.schedule_value.includes(":")?t.schedule_value:"02:00";switch(t.schedule_type){case"daily":return x;case"weekly":return`${x} ${d}`;case"monthly":return`${x} ${n}`;default:return x}},z=async x=>{var X,O;x.preventDefault();const F=t.targets.split(`
`).map(q=>q.trim()).filter(q=>q.length>0);if(!t.name.trim()){l.error("Name is required");return}if(F.length===0){l.error("At least one target is required");return}const j={targets:F,port_range:[t.port_range_start,t.port_range_end],threads:t.threads,enable_os_detection:t.enable_os_detection,enable_service_detection:t.enable_service_detection,enable_vuln_scan:t.enable_vuln_scan,enable_enumeration:t.enable_enumeration},Q=I();try{s?(await Ge.update(s,{name:t.name,description:t.description||void 0,config:j,schedule_type:t.schedule_type,schedule_value:Q}),l.success("Scheduled scan updated")):(await Ge.create({name:t.name,description:t.description||void 0,config:j,schedule_type:t.schedule_type,schedule_value:Q}),l.success("Scheduled scan created")),u(),C()}catch(q){const Y=q;l.error(((O=(X=Y.response)==null?void 0:X.data)==null?void 0:O.error)||"Failed to save scheduled scan")}},R=async x=>{var F,j;try{await Ge.update(x.id,{is_active:!x.is_active}),l.success(`Scheduled scan ${x.is_active?"paused":"activated"}`),C()}catch(Q){const X=Q;l.error(((j=(F=X.response)==null?void 0:F.data)==null?void 0:j.error)||"Failed to update")}},L=async()=>{var x,F;if(E){k(!0);try{await Ge.delete(E.id),l.success(`Scheduled scan "${E.name}" deleted`),C(),G(null)}catch(j){const Q=j;l.error(((F=(x=Q.response)==null?void 0:x.data)==null?void 0:F.error)||"Failed to delete")}finally{k(!1)}}},N=x=>{const F=JSON.parse(x.targets||"[]");c(j=>({...j,targets:F.join(`
`)}))},_=x=>{const F=x.schedule_value.split(" "),j=F[0];switch(x.schedule_type){case"daily":return`Daily at ${j}`;case"weekly":return`Every ${ks[parseInt(F[1])||0]} at ${j}`;case"monthly":return`Monthly on day ${F[1]||1} at ${j}`;default:return x.schedule_value}};return v?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scheduled Scans"})]}),!g&&e.jsxs(S,{variant:"primary",onClick:()=>M(!0),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"New Schedule"]})]})}),g&&e.jsx(B,{children:e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:s?"Edit Scheduled Scan":"Create Scheduled Scan"}),e.jsx("button",{type:"button",onClick:u,className:"text-slate-400 hover:text-white",children:e.jsx(Se,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:t.name,onChange:x=>c({...t,name:x.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Daily Network Scan"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:t.description,onChange:x=>c({...t,description:x.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(ps,{className:"h-4 w-4"})," Schedule"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Frequency"}),e.jsxs("select",{value:t.schedule_type,onChange:x=>c({...t,schedule_type:x.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),t.schedule_type==="weekly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Week"}),e.jsx("select",{value:d,onChange:x=>p(parseInt(x.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:ks.map((x,F)=>e.jsx("option",{value:F,children:x},x))})]}),t.schedule_type==="monthly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Month"}),e.jsx("select",{value:n,onChange:x=>T(parseInt(x.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Array.from({length:28},(x,F)=>F+1).map(x=>e.jsx("option",{value:x,children:x},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Time (UTC)"}),e.jsx("input",{type:"time",value:t.schedule_value.split(" ")[0],onChange:x=>c({...t,schedule_value:x.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Targets (one per line)"}),w.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Use group:"}),w.slice(0,3).map(x=>e.jsx("button",{type:"button",onClick:()=>N(x),className:"px-2 py-0.5 text-xs rounded border border-dark-border text-slate-400 hover:text-white hover:border-primary",style:{borderLeftColor:x.color,borderLeftWidth:3},children:x.name},x.id))]})]}),e.jsx("textarea",{value:t.targets,onChange:x=>c({...t,targets:x.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:4,placeholder:`192.168.1.0/24
10.0.0.1`})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port Start"}),e.jsx("input",{type:"number",value:t.port_range_start,onChange:x=>c({...t,port_range_start:parseInt(x.target.value)||1}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port End"}),e.jsx("input",{type:"number",value:t.port_range_end,onChange:x=>c({...t,port_range_end:parseInt(x.target.value)||1e3}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Threads"}),e.jsx("input",{type:"number",value:t.threads,onChange:x=>c({...t,threads:parseInt(x.target.value)||100}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:1e3})]})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:[{key:"enable_os_detection",label:"OS Detection"},{key:"enable_service_detection",label:"Service Detection"},{key:"enable_vuln_scan",label:"Vulnerability Scan"},{key:"enable_enumeration",label:"Enumeration"}].map(({key:x,label:F})=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t[x],onChange:j=>c({...t,[x]:j.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-slate-300",children:F})]},x))}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(S,{type:"button",variant:"secondary",onClick:u,children:"Cancel"}),e.jsxs(S,{type:"submit",variant:"primary",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),s?"Update":"Create"]})]})]})}),i.length===0&&!g?e.jsx(B,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ne,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scheduled scans"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create automated recurring scans"})]})}):e.jsx("div",{className:"space-y-3",children:i.map(x=>{const F=JSON.parse(x.config);return e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${x.is_active?"bg-green-500/20":"bg-slate-500/20"}`,children:e.jsx(Ne,{className:`h-5 w-5 ${x.is_active?"text-green-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-white",children:x.name}),e.jsx(te,{variant:"status",type:x.is_active?"completed":"pending",children:x.is_active?"Active":"Paused"})]}),e.jsx("p",{className:"text-sm text-slate-400",children:_(x)}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[F.targets.length," target",F.targets.length!==1?"s":""," | Ports ",F.port_range[0],"-",F.port_range[1]," |",x.run_count," runs",x.last_run_at&&e.jsxs(e.Fragment,{children:[" | Last run ",Tt(new Date(x.last_run_at))," ago"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>R(x),className:`p-2 rounded transition-colors ${x.is_active?"text-yellow-400 hover:bg-yellow-500/20":"text-green-400 hover:bg-green-500/20"}`,title:x.is_active?"Pause":"Activate",children:x.is_active?e.jsx(bt,{className:"h-4 w-4"}):e.jsx(Ds,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>D(x),className:"p-2 text-slate-400 hover:text-primary transition-colors",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>G(x),className:"p-2 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete scheduled scan ${x.name}`,children:e.jsx(ie,{className:"h-4 w-4"})})]})]})},x.id)})}),e.jsx(Ae,{isOpen:!!E,onClose:()=>G(null),onConfirm:L,title:"Delete Scheduled Scan",message:`Are you sure you want to delete the scheduled scan "${E==null?void 0:E.name}"? Future automated scans will no longer run.`,confirmLabel:"Delete Schedule",variant:"warning",loading:f})]})},zt=()=>{const[i,A]=r.useState(null),[w,h]=r.useState(!0),[v,b]=r.useState(!1),[g,M]=r.useState(!1),[s,a]=r.useState(!1),[t,c]=r.useState(!1),[d,p]=r.useState(null),[n,T]=r.useState({email_on_scan_complete:!1,email_on_critical_vuln:!0,email_address:"",slack_webhook_url:"",teams_webhook_url:""});r.useEffect(()=>{E(),G()},[]);const E=async()=>{var D;h(!0);try{const I=await je.getSettings();A(I.data),T({email_on_scan_complete:I.data.email_on_scan_complete,email_on_critical_vuln:I.data.email_on_critical_vuln,email_address:I.data.email_address||"",slack_webhook_url:I.data.slack_webhook_url||"",teams_webhook_url:I.data.teams_webhook_url||""})}catch(I){((D=I.response)==null?void 0:D.status)!==404&&(l.error("Failed to load notification settings"),console.error(I))}finally{h(!1)}},G=async()=>{try{const D=await je.checkSmtpStatus();p(D.data.configured)}catch(D){console.error("Failed to check SMTP status:",D),p(!1)}},f=async D=>{var I,z;if(D.preventDefault(),(n.email_on_scan_complete||n.email_on_critical_vuln)&&!n.email_address){l.error("Email address is required when notifications are enabled");return}b(!0);try{const R=await je.updateSettings(n);A(R.data),l.success("Notification settings saved")}catch(R){const L=R;l.error(((z=(I=L.response)==null?void 0:I.data)==null?void 0:z.error)||"Failed to save settings")}finally{b(!1)}},k=async()=>{var D,I;if(!n.slack_webhook_url){l.error("Please enter a Slack webhook URL first");return}M(!0);try{n.slack_webhook_url!==(i==null?void 0:i.slack_webhook_url)&&await je.updateSettings({slack_webhook_url:n.slack_webhook_url});const z=await je.testSlack();l.success(z.data.message)}catch(z){const R=z;l.error(((I=(D=R.response)==null?void 0:D.data)==null?void 0:I.error)||"Failed to send test message")}finally{M(!1)}},C=async()=>{var D,I;if(!n.teams_webhook_url){l.error("Please enter a Teams webhook URL first");return}a(!0);try{n.teams_webhook_url!==(i==null?void 0:i.teams_webhook_url)&&await je.updateSettings({teams_webhook_url:n.teams_webhook_url});const z=await je.testTeams();l.success(z.data.message)}catch(z){const R=z;l.error(((I=(D=R.response)==null?void 0:D.data)==null?void 0:I.error)||"Failed to send test message")}finally{a(!1)}},u=async()=>{var D,I;if(!n.email_address){l.error("Please enter an email address first");return}if(!d){l.error("SMTP is not configured on the server. Contact your administrator.");return}c(!0);try{n.email_address!==(i==null?void 0:i.email_address)&&await je.updateSettings({email_address:n.email_address});const z=await je.testEmail();l.success(z.data.message)}catch(z){const R=z;l.error(((I=(D=R.response)==null?void 0:D.data)==null?void 0:I.error)||"Failed to send test email")}finally{c(!1)}};return w?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Rs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Notification Settings"})]}),e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Notification Email Address"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"email",value:n.email_address,onChange:D=>T({...n,email_address:D.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"your@email.com"})]}),e.jsx(S,{type:"button",variant:"secondary",onClick:u,disabled:!n.email_address||t||!d,title:d?"Send test email":"SMTP not configured on server",children:t?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Sending..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Email address where notifications will be sent"}),d!==null&&e.jsx("span",{className:`text-xs flex items-center gap-1 ${d?"text-green-400":"text-amber-400"}`,children:d?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"h-3 w-3"}),"SMTP configured"]}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"h-3 w-3"}),"SMTP not configured"]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Email Notifications"}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:n.email_on_scan_complete,onChange:D=>T({...n,email_on_scan_complete:D.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"font-medium text-white",children:"Scan Completion"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Receive an email when any of your scans complete, including a summary of findings"})]})]}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:n.email_on_critical_vuln,onChange:D=>T({...n,email_on_critical_vuln:D.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"font-medium text-white",children:"Critical Vulnerabilities"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Get immediate alerts when critical or high severity vulnerabilities are discovered"})]})]})]}),d===!1?e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(fe,{className:"h-5 w-5 text-amber-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-200",children:"SMTP is not configured on this server. Email notifications are disabled."}),e.jsx("p",{className:"text-xs text-amber-300/70 mt-1",children:"Contact your administrator to configure SMTP settings (SMTP_HOST, SMTP_USER, etc.)"})]})]})}):e.jsx("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ts,{className:"h-5 w-5 text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-200",children:d?"Email notifications are ready. Use the Test button to verify delivery.":"Checking SMTP configuration..."}),e.jsx("p",{className:"text-xs text-blue-300/70 mt-1",children:"Contact your administrator if you're not receiving emails."})]})]})}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-dark-border",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(yt,{className:"h-4 w-4"}),"Webhook Integrations"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Slack Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:n.slack_webhook_url,onChange:D=>T({...n,slack_webhook_url:D.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://hooks.slack.com/services/YOUR/WEBHOOK/URL"}),e.jsx(S,{type:"button",variant:"secondary",onClick:k,disabled:!n.slack_webhook_url||g,children:g?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Send scan notifications to a Slack channel. Create a webhook at"," ",e.jsx("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Slack Incoming Webhooks"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Microsoft Teams Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:n.teams_webhook_url,onChange:D=>T({...n,teams_webhook_url:D.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://outlook.office.com/webhook/YOUR/WEBHOOK/URL"}),e.jsx(S,{type:"button",variant:"secondary",onClick:C,disabled:!n.teams_webhook_url||s,children:s?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Send scan notifications to a Teams channel. Create a webhook in your Teams channel connectors."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(S,{type:"submit",variant:"primary",disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Save Settings"]})})})]})]}),i&&e.jsxs(B,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"Current Status"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Scan Complete Emails:"}),e.jsx("span",{className:`ml-2 ${i.email_on_scan_complete?"text-green-400":"text-slate-400"}`,children:i.email_on_scan_complete?"Enabled":"Disabled"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Critical Vuln Alerts:"}),e.jsx("span",{className:`ml-2 ${i.email_on_critical_vuln?"text-green-400":"text-slate-400"}`,children:i.email_on_critical_vuln?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-slate-500",children:"Last Updated:"}),e.jsx("span",{className:"ml-2 text-slate-300",children:new Date(i.updated_at).toLocaleString()})]})]})]})]})},We={quick:{label:"Quick",icon:Ms,color:"text-yellow-400"},standard:{label:"Standard",icon:ls,color:"text-blue-400"},comprehensive:{label:"Comprehensive",icon:ue,color:"text-purple-400"},web:{label:"Web",icon:fs,color:"text-green-400"},stealth:{label:"Stealth",icon:gs,color:"text-slate-400"},custom:{label:"Custom",icon:Ye,color:"text-cyan-400"}},Gt=()=>{var Y;const[i,A]=r.useState([]),[w,h]=r.useState(!0),[v,b]=r.useState(!1),[g,M]=r.useState(null),[s,a]=r.useState({name:"",description:"",category:"custom",estimated_duration_mins:""}),[t,c]=r.useState(new Set),[d,p]=r.useState(new Set),[n,T]=r.useState(null),[E,G]=r.useState(!1),[f,k]=r.useState(null),[C,u]=r.useState(null);r.useEffect(()=>{D()},[]);const D=async()=>{h(!0);try{const o=await Re.getAll();A(o.data)}catch(o){l.error("Failed to load templates"),console.error(o)}finally{h(!1)}},I=r.useMemo(()=>{const o={};return i.forEach($=>{const H=$.category||"custom";o[H]||(o[H]=[]),o[H].push($)}),Object.keys(o).forEach($=>{o[$].sort((H,y)=>H.is_system!==y.is_system?H.is_system?-1:1:H.is_default!==y.is_default?H.is_default?-1:1:y.use_count-H.use_count)}),o},[i]),z=r.useMemo(()=>["quick","standard","comprehensive","web","stealth","custom"].filter($=>{var H;return((H=I[$])==null?void 0:H.length)>0}),[I]),R=r.useMemo(()=>f?I[f]||[]:i,[i,f,I]),L=()=>{a({name:"",description:"",category:"custom",estimated_duration_mins:""}),M(null),b(!1)},N=o=>{if(o.is_system){l.error("System templates cannot be edited. Clone it to create your own version.");return}a({name:o.name,description:o.description||"",category:o.category,estimated_duration_mins:o.estimated_duration_mins||""}),M(o.id),b(!0)},_=async o=>{var $,H;if(o.preventDefault(),!s.name.trim()){l.error("Name is required");return}if(!g){l.error('Cannot create templates from this form. Use "Save as Template" in the scan form.');return}try{await Re.update(g,{name:s.name,description:s.description||void 0,category:s.category,estimated_duration_mins:s.estimated_duration_mins||void 0}),l.success("Template updated"),L(),D()}catch(y){const V=y;l.error(((H=($=V.response)==null?void 0:$.data)==null?void 0:H.error)||"Failed to update template")}},x=async()=>{var o,$;if(n){G(!0);try{await Re.delete(n.id),l.success(`Template "${n.name}" deleted`),D(),T(null)}catch(H){const y=H;l.error((($=(o=y.response)==null?void 0:o.data)==null?void 0:$.error)||"Failed to delete")}finally{G(!1)}}},F=async o=>{var H,y;const $=prompt("Enter name for the cloned template:",`${o.name} (Copy)`);if($){p(V=>new Set([...V,o.id]));try{await Re.clone(o.id,$),l.success("Template cloned successfully"),D()}catch(V){const m=V;l.error(((y=(H=m.response)==null?void 0:H.data)==null?void 0:y.error)||"Failed to clone template")}finally{p(V=>{const m=new Set(V);return m.delete(o.id),m})}}},j=async o=>{var $,H;u(o.id);try{await Re.setDefault(o.id),l.success(`"${o.name}" set as default template`),D()}catch(y){const V=y;l.error(((H=($=V.response)==null?void 0:$.data)==null?void 0:H.error)||"Failed to set default")}finally{u(null)}},Q=async o=>{var V,m;const $=prompt(`Enter name for new scan (based on "${o.name}"):`,`${o.name} - ${new Date().toLocaleDateString()}`);if(!$)return;const H=prompt("Enter target(s) to scan (comma-separated IPs or hostnames):");if(!H)return;const y=H.split(",").map(W=>W.trim()).filter(Boolean);if(y.length===0){l.error("At least one target is required");return}c(new Set([...t,o.id]));try{await Re.createScan(o.id,$,y),l.success("Scan started from template!")}catch(W){const J=W;l.error(((m=(V=J.response)==null?void 0:V.data)==null?void 0:m.error)||"Failed to create scan")}finally{c(W=>{const J=new Set(W);return J.delete(o.id),J})}},X=o=>{if(!o)return"-";if(o<60)return`~${o}m`;const $=Math.floor(o/60),H=o%60;return H?`~${$}h ${H}m`:`~${$}h`},O=o=>new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),q=o=>e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[o.enable_os_detection&&e.jsx(te,{variant:"status",type:"completed",children:"OS"}),o.enable_service_detection&&e.jsx(te,{variant:"status",type:"completed",children:"Services"}),o.enable_vuln_scan&&e.jsx(te,{variant:"status",type:"running",children:"Vuln Scan"}),o.enable_enumeration&&e.jsx(te,{variant:"status",type:"pending",children:"Enum"})]});return w?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scan Templates"})]}),e.jsx("div",{className:"text-sm text-slate-400",children:"Reusable scan profiles for quick configuration"})]}),z.length>0&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>k(null),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${f===null?"bg-primary text-white":"bg-dark-bg text-slate-400 hover:text-white hover:bg-slate-700"}`,children:["All (",i.length,")"]}),z.map(o=>{var V;const $=We[o],H=$.icon,y=((V=I[o])==null?void 0:V.length)||0;return e.jsxs("button",{onClick:()=>k(o),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${f===o?"bg-primary text-white":"bg-dark-bg text-slate-400 hover:text-white hover:bg-slate-700"}`,children:[e.jsx(H,{className:`h-4 w-4 ${f===o?"text-white":$.color}`}),$.label," (",y,")"]},o)})]})]}),v&&e.jsx(B,{children:e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Edit Template"}),e.jsx("button",{type:"button",onClick:L,className:"text-slate-400 hover:text-white",children:e.jsx(Se,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:o=>a({...s,name:o.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"My Custom Template"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Category"}),e.jsx("select",{value:s.category,onChange:o=>a({...s,category:o.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Object.entries(We).map(([o,$])=>e.jsx("option",{value:o,children:$.label},o))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("textarea",{value:s.description,onChange:o=>a({...s,description:o.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",rows:2,placeholder:"Optional description of the template"})]}),e.jsxs("div",{className:"w-48",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Est. Duration (mins)"}),e.jsx("input",{type:"number",value:s.estimated_duration_mins,onChange:o=>a({...s,estimated_duration_mins:o.target.value?parseInt(o.target.value):""}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"30",min:"1"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(S,{type:"button",variant:"secondary",onClick:L,children:"Cancel"}),e.jsxs(S,{type:"submit",variant:"primary",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Update"]})]})]})}),R.length===0&&!v?e.jsx(B,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ye,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:f?`No ${((Y=We[f])==null?void 0:Y.label)||""} templates`:"No scan templates yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:'Save scan configurations using "Save as Template" when creating a scan'})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:R.map(o=>{const $=o.config,H=t.has(o.id),y=d.has(o.id),V=C===o.id,m=We[o.category]||We.custom,W=m.icon;return e.jsxs(B,{className:"relative",children:[o.is_system&&e.jsx("div",{className:"absolute top-2 right-2",title:"System template (read-only)",children:e.jsx(Xe,{className:"h-4 w-4 text-slate-500"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-dark-bg ${m.color}`,children:e.jsx(W,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-white truncate",children:o.name}),o.is_default&&e.jsx("span",{title:"Default template",children:e.jsx(as,{className:"h-4 w-4 text-yellow-400 flex-shrink-0"})})]}),o.description&&e.jsx("p",{className:"text-sm text-slate-400 line-clamp-2 mt-0.5",children:o.description})]})]}),e.jsxs("div",{className:"space-y-2 border-t border-dark-border pt-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Ports: ",$.port_range[0],"-",$.port_range[1]]})]}),$.scan_type&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vt,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-slate-400 capitalize",children:$.scan_type.replace("_"," ")})]}),$.enable_enumeration&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ls,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Enum: ",$.enum_depth||"light"]})]}),o.estimated_duration_mins&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-slate-400",children:X(o.estimated_duration_mins)})]})]}),q($)]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 border-t border-dark-border pt-3",children:[e.jsxs("span",{children:["Used ",o.use_count," times"]}),o.last_used_at?e.jsxs("span",{children:["Last: ",O(o.last_used_at)]}):e.jsxs("span",{children:["Created ",O(o.created_at)]})]}),e.jsxs("div",{className:"flex items-center justify-between border-t border-dark-border pt-3",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>F(o),disabled:y,className:"p-1.5 text-slate-400 hover:text-primary transition-colors disabled:opacity-50",title:"Clone template",children:e.jsx(he,{className:"h-4 w-4"})}),!o.is_system&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>N(o),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit template",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>T(o),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete template",children:e.jsx(ie,{className:"h-4 w-4"})})]}),!o.is_default&&e.jsx("button",{onClick:()=>j(o),disabled:V,className:"p-1.5 text-slate-400 hover:text-yellow-400 transition-colors disabled:opacity-50",title:"Set as default",children:e.jsx(as,{className:"h-4 w-4"})})]}),e.jsxs(S,{variant:"primary",size:"sm",onClick:()=>Q(o),loading:H,disabled:H,children:[e.jsx(Nt,{className:"h-4 w-4 mr-1.5"}),"Use"]})]})]})]},o.id)})}),e.jsx(Ae,{isOpen:!!n,onClose:()=>T(null),onConfirm:x,title:"Delete Template",message:`Are you sure you want to delete the template "${n==null?void 0:n.name}"? This will not affect any scans previously created from this template.`,confirmLabel:"Delete Template",variant:"danger",loading:E})]})},Cs=["critical","high","medium","low","info"],Vt=["web","network","infrastructure","cloud","api","mobile","other"],Bt=()=>{var H,y,V;const[i,A]=r.useState([]),[w,h]=r.useState([]),[v,b]=r.useState(!0),[g,M]=r.useState(!1),[s,a]=r.useState(null),[t,c]=r.useState(null),[d,p]=r.useState(!1),[n,T]=r.useState(!1),[E,G]=r.useState(null),[f,k]=r.useState(""),[C,u]=r.useState(""),[D,I]=r.useState(""),[z,R]=r.useState(!0),[L,N]=r.useState({category:"web",title:"",severity:"medium",description:"",impact:"",remediation:"",references:[],cwe_ids:[],cvss_vector:"",cvss_score:void 0,tags:[]});r.useEffect(()=>{_(),x()},[C,D,f,z]);const _=async()=>{b(!0);try{const m=await Me.list({category:C||void 0,severity:D||void 0,search:f||void 0,include_system:z});A(m.data)}catch(m){l.error("Failed to load finding templates"),console.error(m)}finally{b(!1)}},x=async()=>{try{const m=await Me.getCategories();h(m.data)}catch(m){console.error("Failed to load categories:",m)}},F=()=>{N({category:"web",title:"",severity:"medium",description:"",impact:"",remediation:"",references:[],cwe_ids:[],cvss_vector:"",cvss_score:void 0,tags:[]}),a(null),M(!1)},j=m=>{N({category:m.category,title:m.title,severity:m.severity,description:m.description,impact:m.impact||"",remediation:m.remediation||"",references:m.references?JSON.parse(m.references):[],cwe_ids:m.cwe_ids?JSON.parse(m.cwe_ids):[],cvss_vector:m.cvss_vector||"",cvss_score:m.cvss_score||void 0,tags:m.tags?JSON.parse(m.tags):[]}),a(m),M(!0)},Q=async m=>{var J,me;const W=prompt("Enter name for cloned template:",`${m.title} (Copy)`);if(W)try{await Me.clone(m.id,{new_title:W}),l.success("Template cloned successfully"),_(),x()}catch(P){const re=P;l.error(((me=(J=re.response)==null?void 0:J.data)==null?void 0:me.error)||"Failed to clone template")}},X=async m=>{var W,J;if(m.preventDefault(),!L.title.trim()){l.error("Title is required");return}if(!L.description.trim()){l.error("Description is required");return}T(!0);try{s?(await Me.update(s.id,L),l.success("Template updated successfully")):(await Me.create(L),l.success("Template created successfully")),F(),_(),x()}catch(me){const P=me;l.error(((J=(W=P.response)==null?void 0:W.data)==null?void 0:J.error)||"Failed to save template")}finally{T(!1)}},O=async()=>{var m,W;if(t){p(!0);try{await Me.delete(t.id),l.success(`Template "${t.title}" deleted`),_(),x(),c(null)}catch(J){const me=J;l.error(((W=(m=me.response)==null?void 0:m.data)==null?void 0:W.error)||"Failed to delete template")}finally{p(!1)}}},q=m=>{switch(m.toLowerCase()){case"critical":case"high":return e.jsx(fe,{className:"h-4 w-4"});case"medium":return e.jsx(ue,{className:"h-4 w-4"});default:return e.jsx($e,{className:"h-4 w-4"})}},Y=m=>{const W=m.toLowerCase();return W==="critical"?"critical":W==="high"?"high":W==="medium"?"medium":"low"},o=m=>{if(!m)return[];try{return JSON.parse(m)}catch{return[]}},$=m=>new Date(m).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return v&&i.length===0?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Us,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Finding Templates"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-slate-400",children:[i.length," template",i.length!==1?"s":""]}),e.jsxs(S,{variant:"primary",size:"sm",onClick:()=>M(!0),children:[e.jsx(oe,{className:"h-4 w-4 mr-1.5"}),"New Template"]})]})]})}),e.jsx(B,{children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ls,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",value:f,onChange:m=>k(m.target.value),placeholder:"Search templates...",className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})}),e.jsxs("div",{className:"relative",children:[e.jsx(wt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsxs("select",{value:C,onChange:m=>u(m.target.value),className:"bg-dark-bg border border-dark-border rounded-lg pl-10 pr-8 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"All Categories"}),w.map(m=>e.jsxs("option",{value:m.category,children:[m.category.charAt(0).toUpperCase()+m.category.slice(1)," (",m.count,")"]},m.category))]}),e.jsx(Je,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:D,onChange:m=>I(m.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent appearance-none cursor-pointer pr-8",children:[e.jsx("option",{value:"",children:"All Severities"}),Cs.map(m=>e.jsx("option",{value:m,children:m.charAt(0).toUpperCase()+m.slice(1)},m))]}),e.jsx(Je,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:z,onChange:m=>R(m.target.checked),className:"rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),"Include system templates"]})]})}),g&&e.jsx(B,{children:e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:s?"Edit Template":"New Template"}),e.jsx("button",{type:"button",onClick:F,className:"text-slate-400 hover:text-white",children:e.jsx(Se,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Category"}),e.jsx("select",{value:L.category,onChange:m=>N({...L,category:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Vt.map(m=>e.jsx("option",{value:m,children:m.charAt(0).toUpperCase()+m.slice(1)},m))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Severity"}),e.jsx("select",{value:L.severity,onChange:m=>N({...L,severity:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Cs.map(m=>e.jsx("option",{value:m,children:m.charAt(0).toUpperCase()+m.slice(1)},m))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CVSS Score"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"10",value:L.cvss_score||"",onChange:m=>N({...L,cvss_score:m.target.value?parseFloat(m.target.value):void 0}),placeholder:"0.0 - 10.0",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:L.title,onChange:m=>N({...L,title:m.target.value}),placeholder:"e.g., SQL Injection in Login Form",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description *"}),e.jsx("textarea",{value:L.description,onChange:m=>N({...L,description:m.target.value}),rows:4,placeholder:"Detailed description of the vulnerability...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Impact"}),e.jsx("textarea",{value:L.impact||"",onChange:m=>N({...L,impact:m.target.value}),rows:2,placeholder:"Potential impact if exploited...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Remediation"}),e.jsx("textarea",{value:L.remediation||"",onChange:m=>N({...L,remediation:m.target.value}),rows:3,placeholder:"Recommended steps to fix...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CVSS Vector"}),e.jsx("input",{type:"text",value:L.cvss_vector||"",onChange:m=>N({...L,cvss_vector:m.target.value}),placeholder:"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CWE IDs (comma-separated)"}),e.jsx("input",{type:"text",value:((H=L.cwe_ids)==null?void 0:H.join(", "))||"",onChange:m=>{const W=m.target.value.split(",").map(J=>parseInt(J.trim())).filter(J=>!isNaN(J));N({...L,cwe_ids:W})},placeholder:"e.g., 89, 564",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"References (one URL per line)"}),e.jsx("textarea",{value:((y=L.references)==null?void 0:y.join(`
`))||"",onChange:m=>{const W=m.target.value.split(`
`).map(J=>J.trim()).filter(J=>J);N({...L,references:W})},rows:2,placeholder:"https://owasp.org/...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:((V=L.tags)==null?void 0:V.join(", "))||"",onChange:m=>{const W=m.target.value.split(",").map(J=>J.trim()).filter(J=>J);N({...L,tags:W})},placeholder:"e.g., owasp, web, injection",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(S,{type:"button",variant:"secondary",onClick:F,children:"Cancel"}),e.jsxs(S,{type:"submit",variant:"primary",loading:n,disabled:n,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),s?"Update":"Create"]})]})]})}),i.length===0&&!g?e.jsx(B,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ye,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No finding templates found"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:C||D||f?"Try adjusting your filters":"Create your first template or include system templates"})]})}):e.jsx("div",{className:"space-y-3",children:i.map(m=>{const W=E===m.id,J=o(m.references),me=o(m.cwe_ids),P=o(m.tags);return e.jsx(B,{className:W?"ring-1 ring-primary":"",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>G(W?null:m.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(te,{variant:"severity",type:Y(m.severity),children:[q(m.severity),e.jsx("span",{className:"ml-1",children:m.severity})]}),e.jsx(te,{variant:"status",type:"pending",children:m.category}),m.is_system&&e.jsx(te,{variant:"status",type:"completed",children:"System"})]}),e.jsx("h4",{className:"font-semibold text-white text-lg mt-2",children:m.title}),!W&&e.jsx("p",{className:"text-sm text-slate-400 mt-1 line-clamp-2",children:m.description})]}),e.jsxs("div",{className:"flex gap-1 ml-4",children:[e.jsx("button",{onClick:()=>Q(m),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Clone template",children:e.jsx(he,{className:"h-4 w-4"})}),!m.is_system&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>j(m),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit template",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>c(m),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete template",children:e.jsx(ie,{className:"h-4 w-4"})})]})]})]}),W&&e.jsxs("div",{className:"border-t border-dark-border pt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:m.description})]}),m.impact&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Impact"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:m.impact})]}),m.remediation&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Remediation"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:m.remediation})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[m.cvss_score!==null&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"CVSS:"})," ",e.jsx("span",{className:"text-white font-medium",children:m.cvss_score.toFixed(1)})]}),m.cvss_vector&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Vector:"})," ",e.jsx("code",{className:"text-slate-300 text-xs",children:m.cvss_vector})]}),me.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"CWE:"})," ",me.map((re,pe)=>e.jsxs("span",{children:[pe>0&&", ",e.jsxs("a",{href:`https://cwe.mitre.org/data/definitions/${re}.html`,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:["CWE-",re]})]},re))]})]}),J.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-2",children:"References"}),e.jsx("div",{className:"space-y-1",children:J.map((re,pe)=>e.jsxs("a",{href:re,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-primary hover:underline",children:[e.jsx(Ze,{className:"h-3 w-3"}),re]},pe))})]}),P.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5",children:P.map(re=>e.jsx("span",{className:"px-2 py-0.5 bg-dark-border rounded text-xs text-slate-300",children:re},re))}),e.jsxs("div",{className:"text-xs text-slate-500 pt-2 border-t border-dark-border",children:["Created ",$(m.created_at),m.updated_at!==m.created_at&&e.jsxs(e.Fragment,{children:["  Updated ",$(m.updated_at)]})]})]})]})},m.id)})}),e.jsx(Ae,{isOpen:!!t,onClose:()=>c(null),onConfirm:O,title:"Delete Template",message:`Are you sure you want to delete the template "${t==null?void 0:t.title}"? This action cannot be undone.`,confirmLabel:"Delete Template",variant:"danger",loading:d})]})},Qe=[{id:"host",label:"Single Host",description:"Exclude a single IP address",placeholder:"192.168.1.1",icon:e.jsx(ge,{className:"h-4 w-4"})},{id:"cidr",label:"CIDR Range",description:"Exclude a network range",placeholder:"192.168.1.0/24",icon:e.jsx(xs,{className:"h-4 w-4"})},{id:"hostname",label:"Hostname Pattern",description:"Exclude by hostname (supports wildcards)",placeholder:"*.internal.example.com",icon:e.jsx(fs,{className:"h-4 w-4"})},{id:"port",label:"Single Port",description:"Exclude a specific port",placeholder:"22",icon:e.jsx(ms,{className:"h-4 w-4"})},{id:"port_range",label:"Port Range",description:"Exclude a range of ports",placeholder:"1-1000",icon:e.jsx(ms,{className:"h-4 w-4"})}],qt=()=>{const[i,A]=r.useState([]),[w,h]=r.useState(!0),[v,b]=r.useState(!1),[g,M]=r.useState(!1),[s,a]=r.useState(null),[t,c]=r.useState({name:"",description:"",exclusion_type:"host",value:"",is_global:!0}),[d,p]=r.useState({exclusion_type:"host",values:"",is_global:!0,name_prefix:"Imported"}),[n,T]=r.useState(!1),[E,G]=r.useState(null),[f,k]=r.useState(!1);r.useEffect(()=>{C()},[]);const C=async()=>{h(!0);try{const j=await Ve.getAll();A(j.data)}catch(j){l.error("Failed to load exclusions"),console.error(j)}finally{h(!1)}},u=()=>{c({name:"",description:"",exclusion_type:"host",value:"",is_global:!0}),a(null),b(!1)},D=()=>{p({exclusion_type:"host",values:"",is_global:!0,name_prefix:"Imported"}),M(!1)},I=j=>{c({name:j.name,description:j.description||"",exclusion_type:j.exclusion_type,value:j.value,is_global:j.is_global}),a(j.id),b(!0)},z=async j=>{var Q,X;if(j.preventDefault(),!t.name.trim()){l.error("Name is required");return}if(!t.value.trim()){l.error("Value is required");return}try{const O={name:t.name.trim(),description:t.description.trim()||void 0,exclusion_type:t.exclusion_type,value:t.value.trim(),is_global:t.is_global};s?(await Ve.update(s,O),l.success("Exclusion updated")):(await Ve.create(O),l.success("Exclusion created")),u(),C()}catch(O){const q=O;l.error(((X=(Q=q.response)==null?void 0:Q.data)==null?void 0:X.error)||"Failed to save exclusion")}},R=async()=>{var j,Q;if(E){k(!0);try{await Ve.delete(E.id),l.success(`Exclusion "${E.name}" deleted`),C(),G(null)}catch(X){const O=X;l.error(((Q=(j=O.response)==null?void 0:j.data)==null?void 0:Q.error)||"Failed to delete")}finally{k(!1)}}},L=async j=>{var Q,X;if(j.preventDefault(),!d.values.trim()){l.error("Please enter values to import");return}if(!d.name_prefix.trim()){l.error("Please enter a name prefix");return}T(!0);try{const q=(await Ve.bulkImport({exclusion_type:d.exclusion_type,values:d.values,is_global:d.is_global,name_prefix:d.name_prefix.trim()})).data;q.imported>0&&l.success(`Imported ${q.imported} exclusion(s)`),q.failed>0&&(l.warning(`${q.failed} value(s) failed to import`),q.errors.slice(0,3).forEach(Y=>{l.error(Y,{autoClose:5e3})})),D(),C()}catch(O){const q=O;l.error(((X=(Q=q.response)==null?void 0:Q.data)==null?void 0:X.error)||"Failed to bulk import")}finally{T(!1)}},N=()=>d.values.trim()?d.values.split(/[,\n;]/).map(j=>j.trim()).filter(j=>j.length>0).length:0,_=j=>Qe.find(Q=>Q.id===j)||Qe[0],x=i.filter(j=>j.is_global),F=i.filter(j=>!j.is_global);return w?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Os,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scan Exclusions"})]}),!v&&!g&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{variant:"secondary",onClick:()=>M(!0),children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Bulk Import"]}),e.jsxs(S,{variant:"primary",onClick:()=>b(!0),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"New Exclusion"]})]})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Configure hosts and ports to exclude from scans. Global exclusions apply to all scans automatically."})]}),v&&e.jsx(B,{children:e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:s?"Edit Exclusion":"Create Exclusion"}),e.jsx("button",{type:"button",onClick:u,className:"text-slate-400 hover:text-white",children:e.jsx(Se,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:t.name,onChange:j=>c({...t,name:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Development Servers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Type"}),e.jsx("select",{value:t.exclusion_type,onChange:j=>c({...t,exclusion_type:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Qe.map(j=>e.jsx("option",{value:j.id,children:j.label},j.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Value"}),e.jsx("input",{type:"text",value:t.value,onChange:j=>c({...t,value:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono",placeholder:_(t.exclusion_type).placeholder}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:_(t.exclusion_type).description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description (optional)"}),e.jsx("input",{type:"text",value:t.description,onChange:j=>c({...t,description:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Why is this excluded?"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.is_global,onChange:j=>c({...t,is_global:j.target.checked}),className:"w-4 h-4 rounded bg-dark-bg border-dark-border text-primary focus:ring-primary focus:ring-offset-dark-bg"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Apply to all scans (global exclusion)"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[e.jsx($e,{className:"h-3 w-3"}),e.jsx("span",{children:"Non-global exclusions can be selected per-scan"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(S,{type:"button",variant:"secondary",onClick:u,children:"Cancel"}),e.jsxs(S,{type:"submit",variant:"primary",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),s?"Update":"Create"]})]})]})}),g&&e.jsx(B,{children:e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5 text-cyan-400"}),e.jsx("h4",{className:"text-lg font-medium text-white",children:"Bulk Import Exclusions"})]}),e.jsx("button",{type:"button",onClick:D,className:"text-slate-400 hover:text-white",children:e.jsx(Se,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Exclusion Type"}),e.jsx("select",{value:d.exclusion_type,onChange:j=>p({...d,exclusion_type:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Qe.map(j=>e.jsx("option",{value:j.id,children:j.label},j.id))}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:_(d.exclusion_type).description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name Prefix"}),e.jsx("input",{type:"text",value:d.name_prefix,onChange:j=>p({...d,name_prefix:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Imported"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:['Exclusions will be named "',d.name_prefix||"Imported",' 1", "',d.name_prefix||"Imported",' 2", etc.']})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Values"}),e.jsxs("span",{className:"text-xs text-slate-500",children:[N()," value(s) detected"]})]}),e.jsx("textarea",{value:d.values,onChange:j=>p({...d,values:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:6,placeholder:`Paste values here, one per line or comma-separated.

Example for IPs:
192.168.1.1
192.168.1.2
10.0.0.0/8

Example for ports:
22, 23, 135, 139, 445`})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.is_global,onChange:j=>p({...d,is_global:j.target.checked}),className:"w-4 h-4 rounded bg-dark-bg border-dark-border text-primary focus:ring-primary focus:ring-offset-dark-bg"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Apply to all scans (global exclusions)"})]})}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsx($e,{className:"h-3 w-3"}),e.jsx("span",{children:"Separate values with commas, newlines, or semicolons"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{type:"button",variant:"secondary",onClick:D,children:"Cancel"}),e.jsxs(S,{type:"submit",variant:"primary",loading:n,disabled:N()===0,children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Import ",N()>0?`(${N()})`:""]})]})]})]})}),i.length===0&&!v&&!g?e.jsx(B,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ts,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No exclusions configured"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create exclusions to skip specific hosts or ports during scans"})]})}):e.jsxs(e.Fragment,{children:[x.length>0&&e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(fs,{className:"h-4 w-4 text-green-400"}),e.jsx("h4",{className:"font-medium text-white",children:"Global Exclusions"}),e.jsx("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-0.5 rounded",children:"Applied to all scans"})]}),e.jsx("div",{className:"space-y-2",children:x.map(j=>e.jsx(Ss,{exclusion:j,onEdit:I,onDelete:G},j.id))})]}),F.length>0&&e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ge,{className:"h-4 w-4 text-blue-400"}),e.jsx("h4",{className:"font-medium text-white",children:"Per-Scan Exclusions"}),e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded",children:"Select when creating scans"})]}),e.jsx("div",{className:"space-y-2",children:F.map(j=>e.jsx(Ss,{exclusion:j,onEdit:I,onDelete:G},j.id))})]})]}),e.jsx(Ae,{isOpen:!!E,onClose:()=>G(null),onConfirm:R,title:"Delete Exclusion",message:`Are you sure you want to delete the exclusion "${E==null?void 0:E.name}"? This cannot be undone.`,confirmLabel:"Delete Exclusion",variant:"danger",loading:f})]})},Ss=({exclusion:i,onEdit:A,onDelete:w})=>{const h=Qe.find(b=>b.id===i.exclusion_type),v=b=>{switch(b){case"host":case"cidr":return"bg-purple-500/20 text-purple-400";case"hostname":return"bg-cyan-500/20 text-cyan-400";case"port":case"port_range":return"bg-orange-500/20 text-orange-400";default:return"bg-slate-500/20 text-slate-400"}};return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"text-slate-400",children:h==null?void 0:h.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:i.name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${v(i.exclusion_type)}`,children:(h==null?void 0:h.label)||i.exclusion_type})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("code",{className:"text-sm font-mono text-slate-300 bg-dark-surface px-2 py-0.5 rounded",children:i.value}),i.description&&e.jsx("span",{className:"text-xs text-slate-500 truncate",children:i.description})]})]})]}),e.jsxs("div",{className:"flex gap-1 ml-4",children:[e.jsx("button",{onClick:()=>A(i),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit exclusion",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>w(i),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete exclusion",children:e.jsx(ie,{className:"h-4 w-4"})})]})]})};var Ht=Object.defineProperty,rs=Object.getOwnPropertySymbols,Js=Object.prototype.hasOwnProperty,Ys=Object.prototype.propertyIsEnumerable,Es=(i,A,w)=>A in i?Ht(i,A,{enumerable:!0,configurable:!0,writable:!0,value:w}):i[A]=w,us=(i,A)=>{for(var w in A||(A={}))Js.call(A,w)&&Es(i,w,A[w]);if(rs)for(var w of rs(A))Ys.call(A,w)&&Es(i,w,A[w]);return i},hs=(i,A)=>{var w={};for(var h in i)Js.call(i,h)&&A.indexOf(h)<0&&(w[h]=i[h]);if(i!=null&&rs)for(var h of rs(i))A.indexOf(h)<0&&Ys.call(i,h)&&(w[h]=i[h]);return w};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var De;(i=>{const A=class Z{constructor(s,a,t,c){if(this.version=s,this.errorCorrectionLevel=a,this.modules=[],this.isFunction=[],s<Z.MIN_VERSION||s>Z.MAX_VERSION)throw new RangeError("Version value out of range");if(c<-1||c>7)throw new RangeError("Mask value out of range");this.size=s*4+17;let d=[];for(let n=0;n<this.size;n++)d.push(!1);for(let n=0;n<this.size;n++)this.modules.push(d.slice()),this.isFunction.push(d.slice());this.drawFunctionPatterns();const p=this.addEccAndInterleave(t);if(this.drawCodewords(p),c==-1){let n=1e9;for(let T=0;T<8;T++){this.applyMask(T),this.drawFormatBits(T);const E=this.getPenaltyScore();E<n&&(c=T,n=E),this.applyMask(T)}}v(0<=c&&c<=7),this.mask=c,this.applyMask(c),this.drawFormatBits(c),this.isFunction=[]}static encodeText(s,a){const t=i.QrSegment.makeSegments(s);return Z.encodeSegments(t,a)}static encodeBinary(s,a){const t=i.QrSegment.makeBytes(s);return Z.encodeSegments([t],a)}static encodeSegments(s,a,t=1,c=40,d=-1,p=!0){if(!(Z.MIN_VERSION<=t&&t<=c&&c<=Z.MAX_VERSION)||d<-1||d>7)throw new RangeError("Invalid value");let n,T;for(n=t;;n++){const k=Z.getNumDataCodewords(n,a)*8,C=g.getTotalBits(s,n);if(C<=k){T=C;break}if(n>=c)throw new RangeError("Data too long")}for(const k of[Z.Ecc.MEDIUM,Z.Ecc.QUARTILE,Z.Ecc.HIGH])p&&T<=Z.getNumDataCodewords(n,k)*8&&(a=k);let E=[];for(const k of s){w(k.mode.modeBits,4,E),w(k.numChars,k.mode.numCharCountBits(n),E);for(const C of k.getData())E.push(C)}v(E.length==T);const G=Z.getNumDataCodewords(n,a)*8;v(E.length<=G),w(0,Math.min(4,G-E.length),E),w(0,(8-E.length%8)%8,E),v(E.length%8==0);for(let k=236;E.length<G;k^=253)w(k,8,E);let f=[];for(;f.length*8<E.length;)f.push(0);return E.forEach((k,C)=>f[C>>>3]|=k<<7-(C&7)),new Z(n,a,f,d)}getModule(s,a){return 0<=s&&s<this.size&&0<=a&&a<this.size&&this.modules[a][s]}getModules(){return this.modules}drawFunctionPatterns(){for(let t=0;t<this.size;t++)this.setFunctionModule(6,t,t%2==0),this.setFunctionModule(t,6,t%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const s=this.getAlignmentPatternPositions(),a=s.length;for(let t=0;t<a;t++)for(let c=0;c<a;c++)t==0&&c==0||t==0&&c==a-1||t==a-1&&c==0||this.drawAlignmentPattern(s[t],s[c]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(s){const a=this.errorCorrectionLevel.formatBits<<3|s;let t=a;for(let d=0;d<10;d++)t=t<<1^(t>>>9)*1335;const c=(a<<10|t)^21522;v(c>>>15==0);for(let d=0;d<=5;d++)this.setFunctionModule(8,d,h(c,d));this.setFunctionModule(8,7,h(c,6)),this.setFunctionModule(8,8,h(c,7)),this.setFunctionModule(7,8,h(c,8));for(let d=9;d<15;d++)this.setFunctionModule(14-d,8,h(c,d));for(let d=0;d<8;d++)this.setFunctionModule(this.size-1-d,8,h(c,d));for(let d=8;d<15;d++)this.setFunctionModule(8,this.size-15+d,h(c,d));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let s=this.version;for(let t=0;t<12;t++)s=s<<1^(s>>>11)*7973;const a=this.version<<12|s;v(a>>>18==0);for(let t=0;t<18;t++){const c=h(a,t),d=this.size-11+t%3,p=Math.floor(t/3);this.setFunctionModule(d,p,c),this.setFunctionModule(p,d,c)}}drawFinderPattern(s,a){for(let t=-4;t<=4;t++)for(let c=-4;c<=4;c++){const d=Math.max(Math.abs(c),Math.abs(t)),p=s+c,n=a+t;0<=p&&p<this.size&&0<=n&&n<this.size&&this.setFunctionModule(p,n,d!=2&&d!=4)}}drawAlignmentPattern(s,a){for(let t=-2;t<=2;t++)for(let c=-2;c<=2;c++)this.setFunctionModule(s+c,a+t,Math.max(Math.abs(c),Math.abs(t))!=1)}setFunctionModule(s,a,t){this.modules[a][s]=t,this.isFunction[a][s]=!0}addEccAndInterleave(s){const a=this.version,t=this.errorCorrectionLevel;if(s.length!=Z.getNumDataCodewords(a,t))throw new RangeError("Invalid argument");const c=Z.NUM_ERROR_CORRECTION_BLOCKS[t.ordinal][a],d=Z.ECC_CODEWORDS_PER_BLOCK[t.ordinal][a],p=Math.floor(Z.getNumRawDataModules(a)/8),n=c-p%c,T=Math.floor(p/c);let E=[];const G=Z.reedSolomonComputeDivisor(d);for(let k=0,C=0;k<c;k++){let u=s.slice(C,C+T-d+(k<n?0:1));C+=u.length;const D=Z.reedSolomonComputeRemainder(u,G);k<n&&u.push(0),E.push(u.concat(D))}let f=[];for(let k=0;k<E[0].length;k++)E.forEach((C,u)=>{(k!=T-d||u>=n)&&f.push(C[k])});return v(f.length==p),f}drawCodewords(s){if(s.length!=Math.floor(Z.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let a=0;for(let t=this.size-1;t>=1;t-=2){t==6&&(t=5);for(let c=0;c<this.size;c++)for(let d=0;d<2;d++){const p=t-d,T=(t+1&2)==0?this.size-1-c:c;!this.isFunction[T][p]&&a<s.length*8&&(this.modules[T][p]=h(s[a>>>3],7-(a&7)),a++)}}v(a==s.length*8)}applyMask(s){if(s<0||s>7)throw new RangeError("Mask value out of range");for(let a=0;a<this.size;a++)for(let t=0;t<this.size;t++){let c;switch(s){case 0:c=(t+a)%2==0;break;case 1:c=a%2==0;break;case 2:c=t%3==0;break;case 3:c=(t+a)%3==0;break;case 4:c=(Math.floor(t/3)+Math.floor(a/2))%2==0;break;case 5:c=t*a%2+t*a%3==0;break;case 6:c=(t*a%2+t*a%3)%2==0;break;case 7:c=((t+a)%2+t*a%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[a][t]&&c&&(this.modules[a][t]=!this.modules[a][t])}}getPenaltyScore(){let s=0;for(let d=0;d<this.size;d++){let p=!1,n=0,T=[0,0,0,0,0,0,0];for(let E=0;E<this.size;E++)this.modules[d][E]==p?(n++,n==5?s+=Z.PENALTY_N1:n>5&&s++):(this.finderPenaltyAddHistory(n,T),p||(s+=this.finderPenaltyCountPatterns(T)*Z.PENALTY_N3),p=this.modules[d][E],n=1);s+=this.finderPenaltyTerminateAndCount(p,n,T)*Z.PENALTY_N3}for(let d=0;d<this.size;d++){let p=!1,n=0,T=[0,0,0,0,0,0,0];for(let E=0;E<this.size;E++)this.modules[E][d]==p?(n++,n==5?s+=Z.PENALTY_N1:n>5&&s++):(this.finderPenaltyAddHistory(n,T),p||(s+=this.finderPenaltyCountPatterns(T)*Z.PENALTY_N3),p=this.modules[E][d],n=1);s+=this.finderPenaltyTerminateAndCount(p,n,T)*Z.PENALTY_N3}for(let d=0;d<this.size-1;d++)for(let p=0;p<this.size-1;p++){const n=this.modules[d][p];n==this.modules[d][p+1]&&n==this.modules[d+1][p]&&n==this.modules[d+1][p+1]&&(s+=Z.PENALTY_N2)}let a=0;for(const d of this.modules)a=d.reduce((p,n)=>p+(n?1:0),a);const t=this.size*this.size,c=Math.ceil(Math.abs(a*20-t*10)/t)-1;return v(0<=c&&c<=9),s+=c*Z.PENALTY_N4,v(0<=s&&s<=2568888),s}getAlignmentPatternPositions(){if(this.version==1)return[];{const s=Math.floor(this.version/7)+2,a=this.version==32?26:Math.ceil((this.version*4+4)/(s*2-2))*2;let t=[6];for(let c=this.size-7;t.length<s;c-=a)t.splice(1,0,c);return t}}static getNumRawDataModules(s){if(s<Z.MIN_VERSION||s>Z.MAX_VERSION)throw new RangeError("Version number out of range");let a=(16*s+128)*s+64;if(s>=2){const t=Math.floor(s/7)+2;a-=(25*t-10)*t-55,s>=7&&(a-=36)}return v(208<=a&&a<=29648),a}static getNumDataCodewords(s,a){return Math.floor(Z.getNumRawDataModules(s)/8)-Z.ECC_CODEWORDS_PER_BLOCK[a.ordinal][s]*Z.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][s]}static reedSolomonComputeDivisor(s){if(s<1||s>255)throw new RangeError("Degree out of range");let a=[];for(let c=0;c<s-1;c++)a.push(0);a.push(1);let t=1;for(let c=0;c<s;c++){for(let d=0;d<a.length;d++)a[d]=Z.reedSolomonMultiply(a[d],t),d+1<a.length&&(a[d]^=a[d+1]);t=Z.reedSolomonMultiply(t,2)}return a}static reedSolomonComputeRemainder(s,a){let t=a.map(c=>0);for(const c of s){const d=c^t.shift();t.push(0),a.forEach((p,n)=>t[n]^=Z.reedSolomonMultiply(p,d))}return t}static reedSolomonMultiply(s,a){if(s>>>8||a>>>8)throw new RangeError("Byte out of range");let t=0;for(let c=7;c>=0;c--)t=t<<1^(t>>>7)*285,t^=(a>>>c&1)*s;return v(t>>>8==0),t}finderPenaltyCountPatterns(s){const a=s[1];v(a<=this.size*3);const t=a>0&&s[2]==a&&s[3]==a*3&&s[4]==a&&s[5]==a;return(t&&s[0]>=a*4&&s[6]>=a?1:0)+(t&&s[6]>=a*4&&s[0]>=a?1:0)}finderPenaltyTerminateAndCount(s,a,t){return s&&(this.finderPenaltyAddHistory(a,t),a=0),a+=this.size,this.finderPenaltyAddHistory(a,t),this.finderPenaltyCountPatterns(t)}finderPenaltyAddHistory(s,a){a[0]==0&&(s+=this.size),a.pop(),a.unshift(s)}};A.MIN_VERSION=1,A.MAX_VERSION=40,A.PENALTY_N1=3,A.PENALTY_N2=3,A.PENALTY_N3=40,A.PENALTY_N4=10,A.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],A.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],i.QrCode=A;function w(M,s,a){if(s<0||s>31||M>>>s)throw new RangeError("Value out of range");for(let t=s-1;t>=0;t--)a.push(M>>>t&1)}function h(M,s){return(M>>>s&1)!=0}function v(M){if(!M)throw new Error("Assertion error")}const b=class ae{constructor(s,a,t){if(this.mode=s,this.numChars=a,this.bitData=t,a<0)throw new RangeError("Invalid argument");this.bitData=t.slice()}static makeBytes(s){let a=[];for(const t of s)w(t,8,a);return new ae(ae.Mode.BYTE,s.length,a)}static makeNumeric(s){if(!ae.isNumeric(s))throw new RangeError("String contains non-numeric characters");let a=[];for(let t=0;t<s.length;){const c=Math.min(s.length-t,3);w(parseInt(s.substring(t,t+c),10),c*3+1,a),t+=c}return new ae(ae.Mode.NUMERIC,s.length,a)}static makeAlphanumeric(s){if(!ae.isAlphanumeric(s))throw new RangeError("String contains unencodable characters in alphanumeric mode");let a=[],t;for(t=0;t+2<=s.length;t+=2){let c=ae.ALPHANUMERIC_CHARSET.indexOf(s.charAt(t))*45;c+=ae.ALPHANUMERIC_CHARSET.indexOf(s.charAt(t+1)),w(c,11,a)}return t<s.length&&w(ae.ALPHANUMERIC_CHARSET.indexOf(s.charAt(t)),6,a),new ae(ae.Mode.ALPHANUMERIC,s.length,a)}static makeSegments(s){return s==""?[]:ae.isNumeric(s)?[ae.makeNumeric(s)]:ae.isAlphanumeric(s)?[ae.makeAlphanumeric(s)]:[ae.makeBytes(ae.toUtf8ByteArray(s))]}static makeEci(s){let a=[];if(s<0)throw new RangeError("ECI assignment value out of range");if(s<128)w(s,8,a);else if(s<16384)w(2,2,a),w(s,14,a);else if(s<1e6)w(6,3,a),w(s,21,a);else throw new RangeError("ECI assignment value out of range");return new ae(ae.Mode.ECI,0,a)}static isNumeric(s){return ae.NUMERIC_REGEX.test(s)}static isAlphanumeric(s){return ae.ALPHANUMERIC_REGEX.test(s)}getData(){return this.bitData.slice()}static getTotalBits(s,a){let t=0;for(const c of s){const d=c.mode.numCharCountBits(a);if(c.numChars>=1<<d)return 1/0;t+=4+d+c.bitData.length}return t}static toUtf8ByteArray(s){s=encodeURI(s);let a=[];for(let t=0;t<s.length;t++)s.charAt(t)!="%"?a.push(s.charCodeAt(t)):(a.push(parseInt(s.substring(t+1,t+3),16)),t+=2);return a}};b.NUMERIC_REGEX=/^[0-9]*$/,b.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,b.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let g=b;i.QrSegment=b})(De||(De={}));(i=>{(A=>{const w=class{constructor(v,b){this.ordinal=v,this.formatBits=b}};w.LOW=new w(0,1),w.MEDIUM=new w(1,0),w.QUARTILE=new w(2,3),w.HIGH=new w(3,2),A.Ecc=w})(i.QrCode||(i.QrCode={}))})(De||(De={}));(i=>{(A=>{const w=class{constructor(v,b){this.modeBits=v,this.numBitsCharCount=b}numCharCountBits(v){return this.numBitsCharCount[Math.floor((v+7)/17)]}};w.NUMERIC=new w(1,[10,12,14]),w.ALPHANUMERIC=new w(2,[9,11,13]),w.BYTE=new w(4,[8,16,16]),w.KANJI=new w(8,[8,10,12]),w.ECI=new w(7,[0,0,0]),A.Mode=w})(i.QrSegment||(i.QrSegment={}))})(De||(De={}));var Ue=De;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Wt={L:Ue.QrCode.Ecc.LOW,M:Ue.QrCode.Ecc.MEDIUM,Q:Ue.QrCode.Ecc.QUARTILE,H:Ue.QrCode.Ecc.HIGH},Xs=128,Zs="L",et="#FFFFFF",st="#000000",tt=!1,at=1,Kt=4,Qt=0,Jt=.1;function rt(i,A=0){const w=[];return i.forEach(function(h,v){let b=null;h.forEach(function(g,M){if(!g&&b!==null){w.push(`M${b+A} ${v+A}h${M-b}v1H${b+A}z`),b=null;return}if(M===h.length-1){if(!g)return;b===null?w.push(`M${M+A},${v+A} h1v1H${M+A}z`):w.push(`M${b+A},${v+A} h${M+1-b}v1H${b+A}z`);return}g&&b===null&&(b=M)})}),w.join("")}function lt(i,A){return i.slice().map((w,h)=>h<A.y||h>=A.y+A.h?w:w.map((v,b)=>b<A.x||b>=A.x+A.w?v:!1))}function Yt(i,A,w,h){if(h==null)return null;const v=i.length+w*2,b=Math.floor(A*Jt),g=v/A,M=(h.width||b)*g,s=(h.height||b)*g,a=h.x==null?i.length/2-M/2:h.x*g,t=h.y==null?i.length/2-s/2:h.y*g,c=h.opacity==null?1:h.opacity;let d=null;if(h.excavate){let n=Math.floor(a),T=Math.floor(t),E=Math.ceil(M+a-n),G=Math.ceil(s+t-T);d={x:n,y:T,w:E,h:G}}const p=h.crossOrigin;return{x:a,y:t,h:s,w:M,excavation:d,opacity:c,crossOrigin:p}}function Xt(i,A){return A!=null?Math.max(Math.floor(A),0):i?Kt:Qt}function nt({value:i,level:A,minVersion:w,includeMargin:h,marginSize:v,imageSettings:b,size:g,boostLevel:M}){let s=le.useMemo(()=>{const n=(Array.isArray(i)?i:[i]).reduce((T,E)=>(T.push(...Ue.QrSegment.makeSegments(E)),T),[]);return Ue.QrCode.encodeSegments(n,Wt[A],w,void 0,void 0,M)},[i,A,w,M]);const{cells:a,margin:t,numCells:c,calculatedImageSettings:d}=le.useMemo(()=>{let p=s.getModules();const n=Xt(h,v),T=p.length+n*2,E=Yt(p,g,n,b);return{cells:p,margin:n,numCells:T,calculatedImageSettings:E}},[s,g,b,h,v]);return{qrcode:s,margin:t,cells:a,numCells:c,calculatedImageSettings:d}}var Zt=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),ea=le.forwardRef(function(A,w){const h=A,{value:v,size:b=Xs,level:g=Zs,bgColor:M=et,fgColor:s=st,includeMargin:a=tt,minVersion:t=at,boostLevel:c,marginSize:d,imageSettings:p}=h,T=hs(h,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:E}=T,G=hs(T,["style"]),f=p==null?void 0:p.src,k=le.useRef(null),C=le.useRef(null),u=le.useCallback(F=>{k.current=F,typeof w=="function"?w(F):w&&(w.current=F)},[w]),[D,I]=le.useState(!1),{margin:z,cells:R,numCells:L,calculatedImageSettings:N}=nt({value:v,level:g,minVersion:t,boostLevel:c,includeMargin:a,marginSize:d,imageSettings:p,size:b});le.useEffect(()=>{if(k.current!=null){const F=k.current,j=F.getContext("2d");if(!j)return;let Q=R;const X=C.current,O=N!=null&&X!==null&&X.complete&&X.naturalHeight!==0&&X.naturalWidth!==0;O&&N.excavation!=null&&(Q=lt(R,N.excavation));const q=window.devicePixelRatio||1;F.height=F.width=b*q;const Y=b/L*q;j.scale(Y,Y),j.fillStyle=M,j.fillRect(0,0,L,L),j.fillStyle=s,Zt?j.fill(new Path2D(rt(Q,z))):R.forEach(function(o,$){o.forEach(function(H,y){H&&j.fillRect(y+z,$+z,1,1)})}),N&&(j.globalAlpha=N.opacity),O&&j.drawImage(X,N.x+z,N.y+z,N.w,N.h)}}),le.useEffect(()=>{I(!1)},[f]);const _=us({height:b,width:b},E);let x=null;return f!=null&&(x=le.createElement("img",{src:f,key:f,style:{display:"none"},onLoad:()=>{I(!0)},ref:C,crossOrigin:N==null?void 0:N.crossOrigin})),le.createElement(le.Fragment,null,le.createElement("canvas",us({style:_,height:b,width:b,ref:u,role:"img"},G)),x)});ea.displayName="QRCodeCanvas";var it=le.forwardRef(function(A,w){const h=A,{value:v,size:b=Xs,level:g=Zs,bgColor:M=et,fgColor:s=st,includeMargin:a=tt,minVersion:t=at,boostLevel:c,title:d,marginSize:p,imageSettings:n}=h,T=hs(h,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:E,cells:G,numCells:f,calculatedImageSettings:k}=nt({value:v,level:g,minVersion:t,boostLevel:c,includeMargin:a,marginSize:p,imageSettings:n,size:b});let C=G,u=null;n!=null&&k!=null&&(k.excavation!=null&&(C=lt(G,k.excavation)),u=le.createElement("image",{href:n.src,height:k.h,width:k.w,x:k.x+E,y:k.y+E,preserveAspectRatio:"none",opacity:k.opacity,crossOrigin:k.crossOrigin}));const D=rt(C,E);return le.createElement("svg",us({height:b,width:b,viewBox:`0 0 ${f} ${f}`,ref:w,role:"img"},T),!!d&&le.createElement("title",null,d),le.createElement("path",{fill:M,d:`M0,0 h${f}v${f}H0z`,shapeRendering:"crispEdges"}),le.createElement("path",{fill:s,d:D,shapeRendering:"crispEdges"}),u)});it.displayName="QRCodeSVG";const sa=()=>{const[i,A]=r.useState(!1),[w,h]=r.useState(!0),[v,b]=r.useState("idle"),[g,M]=r.useState(""),[s,a]=r.useState(""),[t,c]=r.useState([]),[d,p]=r.useState(""),[n,T]=r.useState(!1),[E,G]=r.useState(!1),[f,k]=r.useState(""),[C,u]=r.useState(""),[D,I]=r.useState(!1),[z,R]=r.useState(!1),[L,N]=r.useState(""),[_,x]=r.useState(""),[F,j]=r.useState(!1);r.useEffect(()=>{Q()},[]);const Q=async()=>{h(!0);try{const y=await ss.me();A(y.data.mfa_enabled||!1)}catch(y){console.error("Failed to check MFA status:",y)}finally{h(!1)}},X=async()=>{var y,V;try{const m=await es.setup();M(m.data.secret),a(m.data.qr_code_url),c(m.data.recovery_codes),b("scan-qr")}catch(m){const W=m;l.error(((V=(y=W.response)==null?void 0:y.data)==null?void 0:V.error)||"Failed to initialize MFA setup")}},O=async y=>{var V,m;if(y.preventDefault(),!d||d.length!==6){l.error("Please enter a valid 6-digit code");return}T(!0);try{await es.verifySetup({totp_code:d}),l.success("MFA enabled successfully!"),b("show-recovery"),A(!0)}catch(W){const J=W;l.error(((m=(V=J.response)==null?void 0:V.data)==null?void 0:m.error)||"Invalid verification code")}finally{T(!1)}},q=()=>{b("idle"),M(""),a(""),c([]),p("")},Y=async y=>{var V,m;if(y.preventDefault(),!f||!C){l.error("Password and TOTP code are required");return}I(!0);try{await es.disable({password:f,totp_code:C}),l.success("MFA disabled successfully"),A(!1),G(!1),k(""),u("")}catch(W){const J=W;l.error(((m=(V=J.response)==null?void 0:V.data)==null?void 0:m.error)||"Failed to disable MFA")}finally{I(!1)}},o=async y=>{var V,m;if(y.preventDefault(),!L||!_){l.error("Password and TOTP code are required");return}j(!0);try{const W=await es.regenerateRecoveryCodes({password:L,totp_code:_});c(W.data.recovery_codes),l.success("Recovery codes regenerated successfully"),R(!1),N(""),x(""),b("show-recovery")}catch(W){const J=W;l.error(((m=(V=J.response)==null?void 0:V.data)==null?void 0:m.error)||"Failed to regenerate recovery codes")}finally{j(!1)}},$=y=>{navigator.clipboard.writeText(y),l.success("Copied to clipboard")},H=()=>{const y=new Blob([t.join(`
`)],{type:"text/plain"}),V=URL.createObjectURL(y),m=document.createElement("a");m.href=V,m.download="heroforge-recovery-codes.txt",document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(V),l.success("Recovery codes downloaded")};return w?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):v!=="idle"?e.jsx("div",{className:"space-y-6",children:e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Enable Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{className:v==="scan-qr"?"text-primary":"",children:"1. Scan QR"}),e.jsx("span",{children:""}),e.jsx("span",{className:v==="verify-code"?"text-primary":"",children:"2. Verify"}),e.jsx("span",{children:""}),e.jsx("span",{className:v==="show-recovery"?"text-primary":"",children:"3. Save Codes"})]})]}),v==="scan-qr"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 1: Scan QR Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Use an authenticator app like Google Authenticator, Authy, or 1Password to scan this QR code:"}),s&&e.jsx("div",{className:"bg-white p-4 rounded-lg mb-4",children:e.jsx(it,{value:s,size:256,level:"M",marginSize:2})}),e.jsxs("div",{className:"mt-4 w-full max-w-md",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Or enter this secret manually:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{type:"text",value:g,readOnly:!0,className:"font-mono text-sm flex-1"}),e.jsx(S,{variant:"secondary",onClick:()=>$(g),children:e.jsx(he,{className:"h-4 w-4"})})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(S,{variant:"primary",onClick:()=>b("verify-code"),children:"Next: Verify Code"})})]}),v==="verify-code"&&e.jsxs("form",{onSubmit:O,className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(vs,{className:"h-12 w-12 text-primary mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 2: Verify Your Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Enter the 6-digit code from your authenticator app to confirm setup:"}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsx(K,{type:"text",value:d,onChange:y=>p(y.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center text-2xl tracking-widest font-mono",maxLength:6,autoFocus:!0})})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(S,{type:"button",variant:"secondary",onClick:()=>b("scan-qr"),children:"Back"}),e.jsx(S,{type:"submit",variant:"primary",loading:n,disabled:n||d.length!==6,children:"Verify & Enable MFA"})]})]}),v==="show-recovery"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(fe,{className:"h-6 w-6 text-yellow-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-yellow-400 mb-2",children:"Save Your Recovery Codes"}),e.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Store these recovery codes in a safe place. Each code can be used once to access your account if you lose your authenticator device."}),e.jsx("div",{className:"grid grid-cols-2 gap-2 bg-dark-bg rounded-lg p-4 font-mono text-sm mb-4",children:t.map((y,V)=>e.jsxs("div",{className:"text-white",children:[V+1,". ",y]},V))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{variant:"secondary",onClick:()=>$(t.join(`
`)),children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Copy Codes"]}),e.jsxs(S,{variant:"secondary",onClick:H,children:[e.jsx($s,{className:"h-4 w-4 mr-2"}),"Download Codes"]})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(S,{variant:"primary",onClick:q,children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Finish Setup"]})})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ue,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-start justify-between mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[i?e.jsx(de,{className:"h-6 w-6 text-green-400 flex-shrink-0"}):e.jsx(fe,{className:"h-6 w-6 text-yellow-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white mb-1",children:i?"MFA Enabled":"MFA Disabled"}),e.jsx("p",{className:"text-sm text-slate-400",children:i?"Your account is protected with two-factor authentication.":"Enable MFA to add an extra layer of security to your account."})]})]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${i?"bg-green-400":"bg-yellow-400"}`})]}),i?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Te,{className:"h-5 w-5 text-primary"}),e.jsx("h5",{className:"font-medium text-white",children:"Recovery Codes"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Generate new recovery codes if you've lost the originals or used them."}),e.jsx(S,{variant:"secondary",size:"sm",onClick:()=>R(!0),children:"Regenerate Codes"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Xe,{className:"h-5 w-5 text-red-400"}),e.jsx("h5",{className:"font-medium text-white",children:"Disable MFA"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Turn off two-factor authentication for your account."}),e.jsx(S,{variant:"danger",size:"sm",onClick:()=>G(!0),children:"Disable MFA"})]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h5",{className:"text-white font-medium mb-2",children:"Why enable MFA?"}),e.jsxs("ul",{className:"text-sm text-slate-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Adds an extra layer of security beyond your password"}),e.jsx("li",{children:"Prevents unauthorized access even if your password is compromised"}),e.jsx("li",{children:"Uses time-based codes from your smartphone"}),e.jsx("li",{children:"Industry standard for securing sensitive accounts"})]})]}),e.jsxs(S,{variant:"primary",onClick:X,children:[e.jsx(vs,{className:"h-4 w-4 mr-2"}),"Enable Two-Factor Authentication"]})]})]}),E&&e.jsx(B,{children:e.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Disable Two-Factor Authentication"}),e.jsxs("button",{type:"button",onClick:()=>{G(!1),k(""),u("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"Disabling MFA will make your account less secure. You'll need to provide your password and a TOTP code to confirm."})}),e.jsx(K,{label:"Password",type:"password",value:f,onChange:y=>k(y.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(K,{label:"TOTP Code",type:"text",value:C,onChange:y=>u(y.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(S,{type:"button",variant:"secondary",onClick:()=>{G(!1),k(""),u("")},children:"Cancel"}),e.jsx(S,{type:"submit",variant:"danger",loading:D,disabled:D||!f||C.length!==6,children:"Disable MFA"})]})]})}),z&&e.jsx(B,{children:e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Regenerate Recovery Codes"}),e.jsxs("button",{type:"button",onClick:()=>{R(!1),N(""),x("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"This will invalidate all existing recovery codes. Make sure to save the new codes in a safe place."})}),e.jsx(K,{label:"Password",type:"password",value:L,onChange:y=>N(y.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(K,{label:"TOTP Code",type:"text",value:_,onChange:y=>x(y.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(S,{type:"button",variant:"secondary",onClick:()=>{R(!1),N(""),x("")},children:"Cancel"}),e.jsx(S,{type:"submit",variant:"primary",loading:F,disabled:F||!L||_.length!==6,children:"Generate New Codes"})]})]})})]})},ta=()=>{const[i,A]=r.useState([]),[w,h]=r.useState(!0),[v,b]=r.useState(!1),[g,M]=r.useState(""),[s,a]=r.useState(!1),[t,c]=r.useState(null),[d,p]=r.useState(null),[n,T]=r.useState(!1);r.useEffect(()=>{E()},[]);const E=async()=>{h(!0);try{const u=await cs.getAll();A(u.data)}catch(u){l.error("Failed to load API keys"),console.error(u)}finally{h(!1)}},G=async()=>{var u,D;if(!g.trim()){l.error("Please enter a name for the API key");return}a(!0);try{const I=await cs.create({name:g.trim()});c(I.data),M(""),await E(),l.success("API key created successfully")}catch(I){const z=I;l.error(((D=(u=z.response)==null?void 0:u.data)==null?void 0:D.error)||"Failed to create API key")}finally{a(!1)}},f=async()=>{var u,D;if(d){T(!0);try{await cs.delete(d.id),await E(),l.success(`API key "${d.name}" revoked successfully`),p(null)}catch(I){const z=I;l.error(((D=(u=z.response)==null?void 0:u.data)==null?void 0:D.error)||"Failed to revoke API key")}finally{T(!1)}}},k=u=>{navigator.clipboard.writeText(u),l.success("API key copied to clipboard")},C=()=>{c(null),b(!1)};return w?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Keys"})]}),e.jsxs(S,{variant:"primary",onClick:()=>b(!0),className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"Create API Key"]})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"API keys allow programmatic access to HeroForge. Keep your keys secure and never share them publicly."}),i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Te,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No API keys yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Create your first API key to get started"})]}):e.jsx("div",{className:"space-y-3",children:i.map(u=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary/30 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-medium text-white",children:u.name}),e.jsxs("code",{className:"px-2 py-1 bg-dark-surface rounded text-xs text-slate-400 font-mono",children:[u.prefix,"..."]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ps,{className:"h-3 w-3"}),"Created ",new Date(u.created_at).toLocaleDateString()]}),u.last_used_at&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"h-3 w-3"}),"Last used ",new Date(u.last_used_at).toLocaleDateString()]}),!u.last_used_at&&e.jsx("span",{className:"text-amber-500",children:"Never used"})]})]}),e.jsxs(S,{variant:"danger",size:"sm",onClick:()=>p(u),className:"flex items-center gap-2","aria-label":`Revoke API key ${u.name}`,children:[e.jsx(ie,{className:"h-4 w-4"}),"Revoke"]})]},u.id))})]}),v&&!t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Create API Key"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Key Name"}),e.jsx("input",{type:"text",value:g,onChange:u=>M(u.target.value),placeholder:"e.g., Production Server, CI/CD Pipeline",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",autoFocus:!0}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Give your API key a descriptive name to remember where it's used"})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4",children:[e.jsx(S,{variant:"secondary",onClick:()=>{b(!1),M("")},children:"Cancel"}),e.jsx(S,{variant:"primary",onClick:G,disabled:s||!g.trim(),children:s?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Creating..."})]}):"Create Key"})]})]})]})}),t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-2xl w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(de,{className:"h-6 w-6 text-green-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Key Created Successfully"})]}),e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-amber-200 font-medium mb-2",children:"Important: Save your API key now!"}),e.jsx("p",{className:"text-xs text-amber-300/70",children:"This is the only time you'll see the full key. If you lose it, you'll need to create a new one."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"API Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("code",{className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-3 text-white font-mono text-sm break-all",children:t.key}),e.jsxs(S,{variant:"secondary",onClick:()=>k(t.key),className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),"Copy"]})]})]}),e.jsxs("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-200 mb-2",children:"Using your API key"}),e.jsx("p",{className:"text-xs text-blue-300/70 mb-3",children:"Include your API key in the X-API-Key header:"}),e.jsxs("code",{className:"block bg-dark-bg border border-dark-border rounded px-3 py-2 text-xs text-slate-300 font-mono",children:['curl -H "X-API-Key: ',t.key,'" https://heroforge.example.com/api/scans']})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(S,{variant:"primary",onClick:C,children:"Done"})})]})]})}),e.jsx(Ae,{isOpen:!!d,onClose:()=>p(null),onConfirm:f,title:"Revoke API Key",message:`Are you sure you want to revoke the API key "${d==null?void 0:d.name}"? Any applications using this key will lose access immediately.`,confirmLabel:"Revoke Key",variant:"danger",loading:n})]})},aa=()=>{const[i,A]=r.useState(!0),[w,h]=r.useState(!1),[v,b]=r.useState(!1),[g,M]=r.useState(!1),[s,a]=r.useState({jira_url:"",username:"",api_token:"",project_key:"",issue_type:"Task",default_assignee:"",enabled:!0}),[t,c]=r.useState([]),[d,p]=r.useState([]),[n,T]=r.useState(!1);r.useEffect(()=>{E()},[]);const E=async()=>{var u;A(!0);try{const D=await Be.getSettings();a(D.data),M(!0)}catch(D){((u=D.response)==null?void 0:u.status)===404?M(!1):console.error("Failed to load JIRA settings:",D)}finally{A(!1)}},G=async()=>{var u,D;if(!s.jira_url||!s.username||!s.api_token||!s.project_key){l.error("Please fill in all required fields");return}h(!0);try{await Be.updateSettings(s),l.success("JIRA settings saved successfully"),M(!0)}catch(I){const z=I;console.error("Failed to save JIRA settings:",I),l.error(((D=(u=z.response)==null?void 0:u.data)==null?void 0:D.error)||"Failed to save JIRA settings")}finally{h(!1)}},f=async()=>{var u,D;if(!g){l.error("Please save your settings first");return}b(!0);try{await Be.testConnection(),l.success("JIRA connection successful!")}catch(I){const z=I;console.error("JIRA connection failed:",I),l.error(((D=(u=z.response)==null?void 0:u.data)==null?void 0:D.error)||"JIRA connection failed")}finally{b(!1)}},k=async()=>{var u,D;if(!g){l.error("Please save your settings first");return}T(!0);try{const I=await Be.listProjects();c(I.data),l.success(`Loaded ${I.data.length} projects`)}catch(I){const z=I;console.error("Failed to load projects:",I),l.error(((D=(u=z.response)==null?void 0:u.data)==null?void 0:D.error)||"Failed to load projects")}finally{T(!1)}},C=async()=>{var u,D;if(!g||!s.project_key){l.error("Please save your settings and select a project first");return}T(!0);try{const I=await Be.listIssueTypes();p(I.data),l.success(`Loaded ${I.data.length} issue types`)}catch(I){const z=I;console.error("Failed to load issue types:",I),l.error(((D=(u=z.response)==null?void 0:u.data)==null?void 0:D.error)||"Failed to load issue types")}finally{T(!1)}};return i?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ls,{className:"h-6 w-6 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"JIRA Integration"})]}),e.jsxs("div",{className:"space-y-4",children:[!g&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(fe,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"JIRA Integration Not Configured"}),e.jsx("p",{children:"Configure your JIRA instance to automatically create tickets from vulnerabilities."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["JIRA URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(K,{type:"url",placeholder:"https://your-domain.atlassian.net",value:s.jira_url,onChange:u=>a({...s,jira_url:u.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your JIRA instance URL (e.g., https://company.atlassian.net)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Username/Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(K,{type:"text",placeholder:"user@example.com",value:s.username,onChange:u=>a({...s,username:u.target.value})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["API Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(K,{type:"password",placeholder:"Your JIRA API token",value:s.api_token,onChange:u=>a({...s,api_token:u.target.value})}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Generate an API token at"," ",e.jsxs("a",{href:"https://id.atlassian.com/manage-profile/security/api-tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 inline-flex items-center gap-1",children:["Atlassian Account Settings ",e.jsx(Ze,{className:"h-3 w-3"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Key ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:t.length>0?e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:s.project_key,onChange:u=>a({...s,project_key:u.target.value}),children:[e.jsx("option",{value:"",children:"Select a project"}),t.map(u=>e.jsxs("option",{value:u.key,children:[u.name," (",u.key,")"]},u.key))]}):e.jsx(K,{type:"text",placeholder:"PROJECT",value:s.project_key,onChange:u=>a({...s,project_key:u.target.value})})}),e.jsx(S,{onClick:k,disabled:!g||n,variant:"secondary",children:n?"Loading...":"Load Projects"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Issue Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:d.length>0?e.jsx("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:s.issue_type,onChange:u=>a({...s,issue_type:u.target.value}),children:d.map(u=>e.jsx("option",{value:u.name,children:u.name},u.id))}):e.jsx(K,{type:"text",placeholder:"Task",value:s.issue_type,onChange:u=>a({...s,issue_type:u.target.value})})}),e.jsx(S,{onClick:C,disabled:!g||!s.project_key||n,variant:"secondary",children:n?"Loading...":"Load Types"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Assignee (optional)"}),e.jsx(K,{type:"text",placeholder:"username",value:s.default_assignee||"",onChange:u=>a({...s,default_assignee:u.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Leave empty for unassigned or enter a JIRA username"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"jira-enabled",checked:s.enabled,onChange:u=>a({...s,enabled:u.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"jira-enabled",className:"text-sm font-medium text-gray-700",children:"Enable JIRA integration"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(S,{onClick:G,disabled:w,children:w?"Saving...":"Save Settings"}),e.jsx(S,{onClick:f,disabled:!g||v,variant:"secondary",children:v?"Testing...":"Test Connection"})]}),g&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(de,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("p",{className:"font-medium",children:"JIRA Integration Configured"}),e.jsx("p",{children:"You can now create JIRA tickets from vulnerabilities."})]})]})]})]}),e.jsxs(B,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"How to Use JIRA Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Configure your JIRA instance settings above and test the connection."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Navigate to any vulnerability in your scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"3"})}),e.jsx("p",{children:'Click the "Create JIRA Ticket" button to automatically create an issue with vulnerability details.'})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"The vulnerability will be linked to the JIRA ticket, and you can track it in your JIRA project."})]})]})]})]})},ra=()=>{const[i,A]=r.useState(!0),[w,h]=r.useState(!1),[v,b]=r.useState(!1),[g,M]=r.useState(!1),[s,a]=r.useState({instance_url:"",username:"",password:"",default_assignment_group:"",default_category:"",default_impact:3,default_urgency:3,enabled:!0}),[t,c]=r.useState([]),[d,p]=r.useState([]),[n,T]=r.useState(!1),[E,G]=r.useState(!1);r.useEffect(()=>{f()},[]);const f=async()=>{var R;A(!0);try{const N=(await qe.getSettings()).data;a({instance_url:N.instance_url||"",username:N.username||"",password:"",default_assignment_group:N.default_assignment_group||"",default_category:N.default_category||"",default_impact:N.default_impact||3,default_urgency:N.default_urgency||3,enabled:N.enabled}),M(!0)}catch(L){((R=L.response)==null?void 0:R.status)===404?M(!1):console.error("Failed to load ServiceNow settings:",L)}finally{A(!1)}},k=async()=>{var R,L;if(!s.instance_url||!s.username||!s.password){l.error("Please fill in all required fields");return}if(!s.instance_url.startsWith("https://")){l.error("Instance URL must start with https://");return}h(!0);try{await qe.updateSettings({instance_url:s.instance_url,username:s.username,password:s.password,default_assignment_group:s.default_assignment_group||void 0,default_category:s.default_category||void 0,default_impact:s.default_impact,default_urgency:s.default_urgency,enabled:s.enabled}),l.success("ServiceNow settings saved successfully"),M(!0)}catch(N){const _=N;console.error("Failed to save ServiceNow settings:",N),l.error(((L=(R=_.response)==null?void 0:R.data)==null?void 0:L.error)||"Failed to save ServiceNow settings")}finally{h(!1)}},C=async()=>{var R,L;if(!g){l.error("Please save your settings first");return}b(!0);try{await qe.testConnection(),l.success("ServiceNow connection successful!")}catch(N){const _=N;console.error("ServiceNow connection failed:",N),l.error(((L=(R=_.response)==null?void 0:R.data)==null?void 0:L.error)||"ServiceNow connection failed")}finally{b(!1)}},u=async()=>{var R,L;if(!g){l.error("Please save your settings first");return}T(!0);try{const N=await qe.getAssignmentGroups();c(N.data),l.success(`Loaded ${N.data.length} assignment groups`)}catch(N){const _=N;console.error("Failed to load assignment groups:",N),l.error(((L=(R=_.response)==null?void 0:R.data)==null?void 0:L.error)||"Failed to load assignment groups")}finally{T(!1)}},D=async()=>{var R,L;if(!g){l.error("Please save your settings first");return}G(!0);try{const N=await qe.getCategories();p(N.data),l.success(`Loaded ${N.data.length} categories`)}catch(N){const _=N;console.error("Failed to load categories:",N),l.error(((L=(R=_.response)==null?void 0:R.data)==null?void 0:L.error)||"Failed to load categories")}finally{G(!1)}},I=[{value:1,label:"1 - High"},{value:2,label:"2 - Medium"},{value:3,label:"3 - Low"}],z=[{value:1,label:"1 - High"},{value:2,label:"2 - Medium"},{value:3,label:"3 - Low"}];return i?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(zs,{className:"h-6 w-6 text-green-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"ServiceNow Integration"})]}),e.jsxs("div",{className:"space-y-4",children:[!g&&e.jsxs("div",{className:"bg-blue-900/30 border border-blue-700 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(fe,{className:"h-5 w-5 text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-300",children:[e.jsx("p",{className:"font-medium mb-1",children:"ServiceNow Integration Not Configured"}),e.jsx("p",{children:"Configure your ServiceNow instance to create incidents and change requests from vulnerabilities."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Instance URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(K,{type:"url",placeholder:"https://yourcompany.service-now.com",value:s.instance_url,onChange:R=>a({...s,instance_url:R.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your ServiceNow instance URL (e.g., https://company.service-now.com)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(K,{type:"text",placeholder:"username",value:s.username,onChange:R=>a({...s,username:R.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"ServiceNow user with API access permissions"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(K,{type:"password",placeholder:g?"********":"Enter password",value:s.password,onChange:R=>a({...s,password:R.target.value})}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Password for the ServiceNow user. Consider using a"," ",e.jsxs("a",{href:"https://docs.servicenow.com/bundle/tokyo-platform-security/page/administer/users/concept/c_OAuthApplications.html",target:"_blank",rel:"noopener noreferrer",className:"text-cyan-400 hover:text-cyan-300 inline-flex items-center gap-1",children:["OAuth token ",e.jsx(Ze,{className:"h-3 w-3"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Assignment Group"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:t.length>0?e.jsxs("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:s.default_assignment_group,onChange:R=>a({...s,default_assignment_group:R.target.value}),children:[e.jsx("option",{value:"",children:"Select an assignment group"}),t.map(R=>e.jsx("option",{value:R.sys_id,children:R.name},R.sys_id))]}):e.jsx(K,{type:"text",placeholder:"Group sys_id or name",value:s.default_assignment_group,onChange:R=>a({...s,default_assignment_group:R.target.value})})}),e.jsx(S,{onClick:u,disabled:!g||n,variant:"secondary",children:n?"Loading...":"Load Groups"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Category"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:d.length>0?e.jsxs("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:s.default_category,onChange:R=>a({...s,default_category:R.target.value}),children:[e.jsx("option",{value:"",children:"Select a category"}),d.map(R=>e.jsx("option",{value:R.value,children:R.label},R.value))]}):e.jsx(K,{type:"text",placeholder:"security",value:s.default_category,onChange:R=>a({...s,default_category:R.target.value})})}),e.jsx(S,{onClick:D,disabled:!g||E,variant:"secondary",children:E?"Loading...":"Load Categories"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Impact"}),e.jsx("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:s.default_impact,onChange:R=>a({...s,default_impact:parseInt(R.target.value)}),children:I.map(R=>e.jsx("option",{value:R.value,children:R.label},R.value))}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Auto-calculated from severity when creating tickets"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Urgency"}),e.jsx("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:s.default_urgency,onChange:R=>a({...s,default_urgency:parseInt(R.target.value)}),children:z.map(R=>e.jsx("option",{value:R.value,children:R.label},R.value))}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Auto-calculated from severity when creating tickets"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"servicenow-enabled",checked:s.enabled,onChange:R=>a({...s,enabled:R.target.checked}),className:"h-4 w-4 text-cyan-500 focus:ring-cyan-500 border-gray-600 rounded bg-gray-700"}),e.jsx("label",{htmlFor:"servicenow-enabled",className:"text-sm font-medium text-gray-300",children:"Enable ServiceNow integration"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(S,{onClick:k,disabled:w,children:w?"Saving...":"Save Settings"}),e.jsx(S,{onClick:C,disabled:!g||v,variant:"secondary",children:v?"Testing...":"Test Connection"})]}),g&&e.jsxs("div",{className:"bg-green-900/30 border border-green-700 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(de,{className:"h-5 w-5 text-green-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-green-300",children:[e.jsx("p",{className:"font-medium",children:"ServiceNow Integration Configured"}),e.jsx("p",{children:"You can now create incidents and change requests from vulnerabilities."})]})]})]})]}),e.jsxs(B,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-100 mb-4",children:"How to Use ServiceNow Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Configure your ServiceNow instance settings above and test the connection."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Navigate to any vulnerability in your scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"3"})}),e.jsx("p",{children:"Use the ServiceNow dropdown to create an Incident or Change Request with vulnerability details."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"Tickets are linked to vulnerabilities and can be tracked in HeroForge."})]})]})]}),e.jsxs(B,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-100 mb-4",children:"ServiceNow Table API Reference"}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-2",children:[e.jsx("p",{children:"HeroForge uses the ServiceNow Table API to create tickets:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("code",{className:"text-cyan-400",children:"/api/now/table/incident"})," - Create incidents"]}),e.jsxs("li",{children:[e.jsx("code",{className:"text-cyan-400",children:"/api/now/table/change_request"})," - Create change requests"]}),e.jsxs("li",{children:[e.jsx("code",{className:"text-cyan-400",children:"/api/now/table/sys_user_group"})," - List assignment groups"]})]}),e.jsxs("p",{className:"mt-3",children:["Ensure your ServiceNow user has the following roles: ",e.jsx("code",{className:"text-cyan-400",children:"itil"})," or ",e.jsx("code",{className:"text-cyan-400",children:"rest_api_explorer"}),"."]})]})]})]})},la=()=>{const[i,A]=r.useState([]),[w,h]=r.useState(!0),[v,b]=r.useState(!1),[g,M]=r.useState(null),[s,a]=r.useState(null),[t,c]=r.useState(null),[d,p]=r.useState(!1),[n,T]=r.useState([]),[E,G]=r.useState(!1),[f,k]=r.useState(""),[C,u]=r.useState(!1);r.useEffect(()=>{D(),R()},[]);const D=async()=>{h(!0);try{const N=await Le.getSettings();A(N.data)}catch(N){l.error("Failed to load SIEM settings"),console.error(N)}finally{h(!1)}},I=async N=>{var _,x;a(N);try{const F=await Le.testConnection(N);F.data.success?l.success("Connection test successful!"):l.error(`Connection test failed: ${F.data.message}`)}catch(F){const j=F;l.error(((x=(_=j.response)==null?void 0:_.data)==null?void 0:x.error)||"Connection test failed")}finally{a(null)}},z=async()=>{var N,_;if(t){p(!0);try{await Le.deleteSettings(t.id),l.success(`${t.siem_type.toUpperCase()} integration deleted`),D(),c(null)}catch(x){const F=x;l.error(((_=(N=F.response)==null?void 0:N.data)==null?void 0:_.error)||"Failed to delete SIEM integration")}finally{p(!1)}}},R=async()=>{G(!0);try{const N=await Ft.getAll();T(N.data.filter(_=>_.status==="completed"))}catch(N){console.error("Failed to load scans:",N)}finally{G(!1)}},L=async()=>{var _,x;if(!f){l.error("Please select a scan to export");return}if(i.filter(F=>F.enabled).length===0){l.error("No enabled SIEM integrations found. Please enable at least one integration.");return}u(!0);try{const F=await Le.exportScan(f);F.data.success?(l.success(`Scan exported to ${F.data.exported_to} SIEM integration(s). ${F.data.events_count} events sent.`),F.data.errors&&F.data.errors.length>0&&F.data.errors.forEach(j=>l.warning(j))):l.error("Export failed. Check SIEM configuration.")}catch(F){const j=F;l.error(((x=(_=j.response)==null?void 0:_.data)==null?void 0:x.error)||"Failed to export scan to SIEM")}finally{u(!1)}};return w?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"SIEM Integrations"})]}),e.jsxs(S,{variant:"primary",onClick:()=>b(!0),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Add Integration"]})]}),i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ge,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"No SIEM integrations configured"}),e.jsxs(S,{variant:"primary",onClick:()=>b(!0),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Add Your First Integration"]})]}):e.jsx("div",{className:"space-y-4",children:i.map(N=>e.jsx("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-primary/20 text-primary rounded-md text-sm font-medium uppercase",children:N.siem_type}),N.enabled?e.jsxs("span",{className:"flex items-center gap-1 text-green-400 text-sm",children:[e.jsx(de,{className:"h-4 w-4"}),"Enabled"]}):e.jsxs("span",{className:"flex items-center gap-1 text-slate-500 text-sm",children:[e.jsx(ze,{className:"h-4 w-4"}),"Disabled"]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Endpoint:"}),e.jsx("span",{className:"text-white font-mono",children:N.endpoint_url})]}),N.protocol&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Protocol:"}),e.jsx("span",{className:"text-white uppercase",children:N.protocol})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:N.export_on_scan_complete,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export on scan complete"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:N.export_on_critical_vuln,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export critical vulnerabilities"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>I(N.id),disabled:s===N.id,children:s===N.id?e.jsx(ee,{}):e.jsx(js,{className:"h-4 w-4"})}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>M(N),children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>c(N),"aria-label":`Delete ${N.siem_type} integration`,children:e.jsx(ie,{className:"h-4 w-4 text-red-400"})})]})]})},N.id))})]}),e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Manual Export"})]}),e.jsx(S,{variant:"outline",size:"sm",onClick:R,disabled:E,children:E?e.jsx(ee,{}):e.jsx(Fe,{className:"h-4 w-4"})})]}),i.filter(N=>N.enabled).length===0?e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(ze,{className:"h-5 w-5 text-amber-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-200",children:[e.jsx("p",{className:"font-medium mb-1",children:"No Enabled Integrations"}),e.jsx("p",{children:"Enable at least one SIEM integration above before exporting scan results."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Manually export scan results to all enabled SIEM integrations."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:f,onChange:N=>k(N.target.value),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",disabled:E||C,children:[e.jsx("option",{value:"",children:"Select a completed scan..."}),n.map(N=>e.jsxs("option",{value:N.id,children:[N.name," - ",new Date(N.created_at).toLocaleDateString()," ",new Date(N.created_at).toLocaleTimeString()]},N.id))]}),e.jsx(S,{variant:"primary",onClick:L,disabled:!f||C||E,children:C?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Exporting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Export to SIEM"]})})]}),n.length===0&&!E&&e.jsx("p",{className:"text-sm text-slate-500",children:"No completed scans available for export."}),e.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["Export will send data to: ",i.filter(N=>N.enabled).map(N=>N.siem_type.toUpperCase()).join(", ")]})]})]}),e.jsxs(B,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"About SIEM Integration"}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-400",children:[e.jsx("p",{children:"SIEM (Security Information and Event Management) integration allows HeroForge to automatically export scan results and vulnerability findings to your security monitoring platform."}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Syslog:"})," RFC 5424 compliant syslog over TCP/UDP"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Splunk:"})," Splunk HTTP Event Collector (HEC)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Elasticsearch:"})," Direct indexing via Bulk API"]})]})]})]}),(v||g)&&e.jsx(na,{settings:g,onClose:()=>{b(!1),M(null)},onSave:()=>{b(!1),M(null),D()}}),e.jsx(Ae,{isOpen:!!t,onClose:()=>c(null),onConfirm:z,title:"Delete SIEM Integration",message:`Are you sure you want to delete the ${t==null?void 0:t.siem_type.toUpperCase()} integration? Automatic exports to this endpoint will stop.`,confirmLabel:"Delete Integration",variant:"danger",loading:d})]})},na=({settings:i,onClose:A,onSave:w})=>{const[h,v]=r.useState({siem_type:(i==null?void 0:i.siem_type)||"syslog",endpoint_url:(i==null?void 0:i.endpoint_url)||"",api_key:(i==null?void 0:i.api_key)||"",protocol:(i==null?void 0:i.protocol)||"tcp",enabled:(i==null?void 0:i.enabled)??!0,export_on_scan_complete:(i==null?void 0:i.export_on_scan_complete)??!1,export_on_critical_vuln:(i==null?void 0:i.export_on_critical_vuln)??!0}),[b,g]=r.useState(!1),M=async s=>{var a,t;if(s.preventDefault(),!h.endpoint_url){l.error("Endpoint URL is required");return}if(h.siem_type==="splunk"&&!h.api_key){l.error("API key is required for Splunk HEC");return}g(!0);try{if(i){const c={endpoint_url:h.endpoint_url,enabled:h.enabled,export_on_scan_complete:h.export_on_scan_complete,export_on_critical_vuln:h.export_on_critical_vuln};h.api_key&&(c.api_key=h.api_key),h.siem_type==="syslog"&&(c.protocol=h.protocol),await Le.updateSettings(i.id,c),l.success("SIEM integration updated")}else{const c={siem_type:h.siem_type,endpoint_url:h.endpoint_url,enabled:h.enabled,export_on_scan_complete:h.export_on_scan_complete,export_on_critical_vuln:h.export_on_critical_vuln};h.api_key&&(c.api_key=h.api_key),h.siem_type==="syslog"&&(c.protocol=h.protocol),await Le.createSettings(c),l.success("SIEM integration created")}w()}catch(c){const d=c;l.error(((t=(a=d.response)==null?void 0:a.data)==null?void 0:t.error)||"Failed to save SIEM integration")}finally{g(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white",children:[i?"Edit":"Add"," SIEM Integration"]}),e.jsx("button",{onClick:A,className:"text-slate-400 hover:text-white",children:e.jsx(Se,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:M,className:"p-6 space-y-6",children:[!i&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"SIEM Type"}),e.jsxs("select",{value:h.siem_type,onChange:s=>v({...h,siem_type:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"syslog",children:"Syslog (RFC 5424)"}),e.jsx("option",{value:"splunk",children:"Splunk HEC"}),e.jsx("option",{value:"elasticsearch",children:"Elasticsearch"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Endpoint URL"}),e.jsx("input",{type:"text",value:h.endpoint_url,onChange:s=>v({...h,endpoint_url:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:h.siem_type==="syslog"?"192.168.1.100:514":h.siem_type==="splunk"?"https://splunk.example.com:8088":"https://elasticsearch.example.com:9200"})]}),h.siem_type==="syslog"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Protocol"}),e.jsxs("select",{value:h.protocol,onChange:s=>v({...h,protocol:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"})]})]}),(h.siem_type==="splunk"||h.siem_type==="elasticsearch")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:[h.siem_type==="splunk"?"HEC Token":"API Key"," ",h.siem_type==="splunk"&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"password",value:h.api_key,onChange:s=>v({...h,api_key:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:i?"(leave blank to keep current)":""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h.enabled,onChange:s=>v({...h,enabled:s.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Enable this integration"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h.export_on_scan_complete,onChange:s=>v({...h,export_on_scan_complete:s.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export when scans complete"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h.export_on_critical_vuln,onChange:s=>v({...h,export_on_critical_vuln:s.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export critical vulnerabilities immediately"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(S,{type:"button",variant:"outline",onClick:A,children:"Cancel"}),e.jsx(S,{type:"submit",variant:"primary",disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs("span",{children:[i?"Update":"Create"," Integration"]})})]})]})]})})},ia=()=>{const[i,A]=r.useState(!0),[w,h]=r.useState([]),[v,b]=r.useState(null),[g,M]=r.useState(!1),[s,a]=r.useState(!1),[t,c]=r.useState(null),[d,p]=r.useState(!1),[n,T]=r.useState(!1),[E,G]=r.useState(null),[f,k]=r.useState(""),C=r.useRef(null),[u,D]=r.useState({name:"",vpnType:"openvpn",username:"",password:""}),[I,z]=r.useState(null);r.useEffect(()=>{R()},[]);const R=async()=>{A(!0);try{const[O,q]=await Promise.all([be.getConfigs(),be.getStatus()]);h(O.data),b(q.data)}catch(O){console.error("Failed to load VPN data:",O),l.error("Failed to load VPN settings")}finally{A(!1)}},L=O=>{var $,H;const q=($=O.target.files)==null?void 0:$[0];if(!q)return;const Y=(H=q.name.split(".").pop())==null?void 0:H.toLowerCase();let o="openvpn";Y==="conf"&&(o="wireguard"),z(q),D({...u,name:q.name.replace(/\.(ovpn|conf)$/i,""),vpnType:o}),M(!0)},N=async()=>{if(!I){l.error("Please select a VPN config file");return}if(!u.name.trim()){l.error("Please enter a name for the VPN config");return}a(!0);try{const O=new FileReader;O.onload=async()=>{var Y,o;const q=O.result.split(",")[1];try{await be.uploadConfig({name:u.name.trim(),vpn_type:u.vpnType,config_data:q,filename:I.name,username:u.username||void 0,password:u.password||void 0,set_as_default:!1}),l.success("VPN config uploaded successfully"),M(!1),z(null),D({name:"",vpnType:"openvpn",username:"",password:""}),C.current&&(C.current.value=""),await R()}catch($){const H=$;console.error("Failed to upload VPN config:",$),l.error(((o=(Y=H.response)==null?void 0:Y.data)==null?void 0:o.error)||"Failed to upload VPN config")}},O.readAsDataURL(I)}finally{a(!1)}},_=async O=>{var q,Y;if(window.confirm("Are you sure you want to delete this VPN config?"))try{await be.deleteConfig(O),l.success("VPN config deleted"),await R()}catch(o){const $=o;console.error("Failed to delete VPN config:",o),l.error(((Y=(q=$.response)==null?void 0:q.data)==null?void 0:Y.error)||"Failed to delete VPN config")}},x=async O=>{var q,Y;c(O);try{const o=await be.testConfig(O);o.data.success?l.success(`Connection successful! IP: ${o.data.assigned_ip||"N/A"}`):l.error(o.data.message||"Connection test failed")}catch(o){const $=o;console.error("Failed to test VPN config:",o),l.error(((Y=(q=$.response)==null?void 0:q.data)==null?void 0:Y.error)||"Connection test failed")}finally{c(null)}},F=async O=>{var q,Y;p(!0);try{await be.connect({config_id:O,connection_mode:"persistent"}),l.success("VPN connected"),await R()}catch(o){const $=o;console.error("Failed to connect VPN:",o),l.error(((Y=(q=$.response)==null?void 0:q.data)==null?void 0:Y.error)||"Failed to connect")}finally{p(!1)}},j=async()=>{var O,q;T(!0);try{await be.disconnect(),l.success("VPN disconnected"),await R()}catch(Y){const o=Y;console.error("Failed to disconnect VPN:",Y),l.error(((q=(O=o.response)==null?void 0:O.data)==null?void 0:q.error)||"Failed to disconnect")}finally{T(!1)}},Q=async O=>{var q,Y;try{await be.updateConfig(O,{is_default:!0}),l.success("Default VPN config updated"),await R()}catch(o){const $=o;console.error("Failed to set default:",o),l.error(((Y=(q=$.response)==null?void 0:q.data)==null?void 0:Y.error)||"Failed to set default")}},X=async O=>{var q,Y;if(!f.trim()){l.error("Name cannot be empty");return}try{await be.updateConfig(O,{name:f.trim()}),l.success("VPN config updated"),G(null),await R()}catch(o){const $=o;console.error("Failed to update config:",o),l.error(((Y=(q=$.response)==null?void 0:q.data)==null?void 0:Y.error)||"Failed to update")}};return i?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[v!=null&&v.connected?e.jsx(Vs,{className:"h-6 w-6 text-green-500"}):e.jsx(Ns,{className:"h-6 w-6 text-slate-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"VPN Status"}),e.jsx("p",{className:"text-sm text-slate-400",children:v!=null&&v.connected?`Connected to ${v.config_name}`:"Not connected"})]})]}),(v==null?void 0:v.connected)&&e.jsxs(S,{onClick:j,disabled:n,variant:"danger",className:"flex items-center gap-2",children:[e.jsx(_t,{className:"h-4 w-4"}),n?"Disconnecting...":"Disconnect"]})]}),(v==null?void 0:v.connected)&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-dark-hover rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Mode"}),e.jsx("p",{className:"text-sm text-white",children:v.connection_mode==="persistent"?"Persistent":"Per-Scan"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Assigned IP"}),e.jsx("p",{className:"text-sm text-white font-mono",children:v.assigned_ip||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Interface"}),e.jsx("p",{className:"text-sm text-white font-mono",children:v.interface_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Connected Since"}),e.jsx("p",{className:"text-sm text-white",children:v.connected_since?new Date(v.connected_since).toLocaleString():"N/A"})]})]})]}),e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"VPN Configurations"})]}),e.jsxs("div",{children:[e.jsx("input",{ref:C,type:"file",accept:".ovpn,.conf",onChange:L,className:"hidden"}),e.jsxs(S,{onClick:()=>{var O;return(O=C.current)==null?void 0:O.click()},className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-4 w-4"}),"Upload Config"]})]})]}),g&&e.jsxs("div",{className:"mb-6 p-4 bg-dark-hover rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"Upload VPN Configuration"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{children:"File:"}),e.jsx("span",{className:"text-white font-mono",children:I==null?void 0:I.name}),e.jsx("span",{className:"px-2 py-0.5 bg-primary/20 text-primary rounded text-xs uppercase",children:u.vpnType})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Config Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(K,{type:"text",placeholder:"My VPN Connection",value:u.name,onChange:O=>D({...u,name:O.target.value})})]}),u.vpnType==="openvpn"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Username (optional)"}),e.jsx(K,{type:"text",placeholder:"VPN username",value:u.username,onChange:O=>D({...u,username:O.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Required if your VPN requires authentication"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Password (optional)"}),e.jsx(K,{type:"password",placeholder:"VPN password",value:u.password,onChange:O=>D({...u,password:O.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(S,{onClick:N,disabled:s,children:s?"Uploading...":"Upload"}),e.jsx(S,{onClick:()=>{M(!1),z(null),C.current&&(C.current.value="")},variant:"secondary",children:"Cancel"})]})]})]}),w.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(Ns,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No VPN configurations yet"}),e.jsx("p",{className:"text-sm",children:"Upload an OpenVPN (.ovpn) or WireGuard (.conf) file to get started"})]}):e.jsx("div",{className:"space-y-3",children:w.map(O=>e.jsxs("div",{className:"p-4 bg-dark-hover rounded-lg border border-dark-border flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${O.vpn_type==="openvpn"?"bg-orange-500/20 text-orange-400":"bg-blue-500/20 text-blue-400"}`,children:e.jsx(ue,{className:"h-5 w-5"})}),e.jsxs("div",{children:[E===O.id?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{type:"text",value:f,onChange:q=>k(q.target.value),className:"w-48",autoFocus:!0,onKeyDown:q=>{q.key==="Enter"&&X(O.id),q.key==="Escape"&&G(null)}}),e.jsx(S,{size:"sm",onClick:()=>X(O.id),children:"Save"}),e.jsx(S,{size:"sm",variant:"secondary",onClick:()=>G(null),children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium",children:O.name}),O.is_default&&e.jsx(as,{className:"h-4 w-4 text-yellow-400 fill-yellow-400"}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-700 text-slate-300 rounded text-xs uppercase",children:O.vpn_type}),(v==null?void 0:v.connected)&&v.config_id===O.id&&e.jsx("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 rounded text-xs",children:"Connected"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500 mt-1",children:[O.requires_credentials&&e.jsx("span",{className:O.has_credentials?"text-green-400":"text-yellow-400",children:O.has_credentials?"Credentials saved":"Credentials required"}),O.last_used_at&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"h-3 w-3"}),"Last used: ",new Date(O.last_used_at).toLocaleDateString()]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:E!==O.id&&e.jsxs(e.Fragment,{children:[!O.is_default&&e.jsx(S,{size:"sm",variant:"ghost",onClick:()=>Q(O.id),title:"Set as default",children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(S,{size:"sm",variant:"ghost",onClick:()=>{G(O.id),k(O.name)},title:"Edit",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx(S,{size:"sm",variant:"ghost",onClick:()=>x(O.id),disabled:t===O.id,title:"Test connection",children:t===O.id?e.jsx(ee,{size:"sm"}):e.jsx(de,{className:"h-4 w-4"})}),!(v!=null&&v.connected)||v.config_id!==O.id?e.jsx(S,{size:"sm",variant:"secondary",onClick:()=>F(O.id),disabled:d||(v==null?void 0:v.connected),title:"Connect",children:e.jsx(Ds,{className:"h-4 w-4"})}):null,e.jsx(S,{size:"sm",variant:"ghost",onClick:()=>_(O.id),className:"text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(ie,{className:"h-4 w-4"})})]})})]},O.id))})]}),e.jsxs(B,{children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"How to Use VPN Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-slate-400",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Upload your OpenVPN (.ovpn) or WireGuard (.conf) configuration file."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"If your VPN requires credentials, enter them during upload. They are stored encrypted."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"3"})}),e.jsx("p",{children:"Test your connection to verify it works before using it for scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"When creating a scan, select a VPN config to route the scan through that VPN. The VPN connects before the scan starts and disconnects when it completes."})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(fe,{className:"h-5 w-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-200",children:[e.jsx("p",{className:"font-medium",children:"Security Note"}),e.jsx("p",{className:"text-yellow-300/80 mt-1",children:"VPN credentials are encrypted using AES-256-GCM. Config files containing dangerous options (scripts, hooks) are rejected. Only use VPN configurations from trusted sources."})]})]})})]})]})},ca=()=>{const[i,A]=r.useState(!0),[w,h]=r.useState([]),[v,b]=r.useState([]),[g,M]=r.useState(null),[s,a]=r.useState(!1),[t,c]=r.useState(!1),[d,p]=r.useState(!1),[n,T]=r.useState(!1),[E,G]=r.useState(null),[f,k]=r.useState(!1),[C,u]=r.useState(null),[D,I]=r.useState(""),[z,R]=r.useState("agents"),[L,N]=r.useState({name:"",description:"",network_zones:[],max_concurrent_tasks:1}),[_,x]=r.useState({name:"",description:"",network_ranges:"",color:"#06b6d4"});r.useEffect(()=>{F()},[]);const F=async()=>{A(!0);try{const[y,V,m]=await Promise.all([ye.list(),ye.groups.list(),ye.getStats()]);h(y.data),b(V.data),M(m.data)}catch(y){console.error("Failed to load agent data:",y),l.error("Failed to load agent data")}finally{A(!1)}},j=async()=>{var y,V,m;if(!L.name.trim()){l.error("Agent name is required");return}p(!0);try{const W=await ye.register({...L,network_zones:(y=L.network_zones)==null?void 0:y.filter(J=>J.trim())});G(W.data.token),l.success("Agent registered successfully"),a(!1),N({name:"",description:"",network_zones:[],max_concurrent_tasks:1}),await F()}catch(W){const J=W;l.error(((m=(V=J.response)==null?void 0:V.data)==null?void 0:m.error)||"Failed to register agent")}finally{p(!1)}},Q=async()=>{var y,V;if(!_.name.trim()){l.error("Group name is required");return}T(!0);try{await ye.groups.create({name:_.name.trim(),description:_.description.trim()||void 0,network_ranges:_.network_ranges.split(",").map(m=>m.trim()).filter(Boolean),color:_.color}),l.success("Group created successfully"),c(!1),x({name:"",description:"",network_ranges:"",color:"#06b6d4"}),await F()}catch(m){const W=m;l.error(((V=(y=W.response)==null?void 0:y.data)==null?void 0:V.error)||"Failed to create group")}finally{T(!1)}},X=async y=>{var V,m;if(window.confirm("Are you sure you want to delete this agent?"))try{await ye.delete(y),l.success("Agent deleted"),await F()}catch(W){const J=W;l.error(((m=(V=J.response)==null?void 0:V.data)==null?void 0:m.error)||"Failed to delete agent")}},O=async y=>{var V,m;if(window.confirm("Are you sure you want to delete this group?"))try{await ye.groups.delete(y),l.success("Group deleted"),await F()}catch(W){const J=W;l.error(((m=(V=J.response)==null?void 0:V.data)==null?void 0:m.error)||"Failed to delete group")}},q=async y=>{var V,m;if(window.confirm("Are you sure? The current token will be invalidated."))try{const W=await ye.regenerateToken(y);G(W.data.token),l.success("Token regenerated")}catch(W){const J=W;l.error(((m=(V=J.response)==null?void 0:V.data)==null?void 0:m.error)||"Failed to regenerate token")}},Y=async y=>{var V,m;if(!D.trim()){l.error("Name cannot be empty");return}try{await ye.update(y,{name:D.trim()}),l.success("Agent updated"),u(null),await F()}catch(W){const J=W;l.error(((m=(V=J.response)==null?void 0:V.data)==null?void 0:m.error)||"Failed to update agent")}},o=y=>{navigator.clipboard.writeText(y),l.success("Copied to clipboard")},$=y=>{switch(y){case"online":return e.jsx(de,{className:"h-4 w-4 text-green-400"});case"busy":return e.jsx(ws,{className:"h-4 w-4 text-yellow-400 animate-pulse"});case"offline":return e.jsx(we,{className:"h-4 w-4 text-red-400"});case"pending":return e.jsx(Ne,{className:"h-4 w-4 text-slate-400"});case"disabled":return e.jsx(Se,{className:"h-4 w-4 text-slate-500"});default:return e.jsx(ze,{className:"h-4 w-4 text-slate-400"})}},H=y=>{switch(y){case"online":return"completed";case"busy":return"running";case"offline":case"disabled":return"failed";default:return"pending"}};return i?e.jsx(B,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})})}):e.jsxs("div",{className:"space-y-6",children:[E&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-lg w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(ze,{className:"h-6 w-6 text-yellow-400"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Agent Token"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"This token will only be shown once. Copy it now and configure it in your agent."}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{type:f?"text":"password",value:E,readOnly:!0,className:"font-mono text-sm pr-24"}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex gap-1",children:[e.jsx(S,{size:"sm",variant:"ghost",onClick:()=>k(!f),children:f?e.jsx(gs,{className:"h-4 w-4"}):e.jsx(Bs,{className:"h-4 w-4"})}),e.jsx(S,{size:"sm",variant:"ghost",onClick:()=>o(E),children:e.jsx(he,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:e.jsx("p",{className:"text-sm text-yellow-200",children:"Store this token securely. You will need to regenerate it if lost."})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(S,{onClick:()=>G(null),children:"Done"})})]})}),g&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(B,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(ge,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:g.total_agents}),e.jsx("p",{className:"text-sm text-slate-400",children:"Total Agents"})]})]})}),e.jsx(B,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(de,{className:"h-5 w-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:g.online_agents}),e.jsx("p",{className:"text-sm text-slate-400",children:"Online"})]})]})}),e.jsx(B,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:e.jsx(ws,{className:"h-5 w-5 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:g.busy_agents}),e.jsx("p",{className:"text-sm text-slate-400",children:"Busy"})]})]})}),e.jsx(B,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-500/20 rounded-lg",children:e.jsx(kt,{className:"h-5 w-5 text-slate-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:g.total_tasks_completed}),e.jsx("p",{className:"text-sm text-slate-400",children:"Tasks Completed"})]})]})})]}),e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>R("agents"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium ${z==="agents"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(ge,{className:"h-4 w-4"}),"Agents (",w.length,")"]}),e.jsxs("button",{onClick:()=>R("groups"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium ${z==="groups"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(is,{className:"h-4 w-4"}),"Groups (",v.length,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(S,{onClick:()=>F(),variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),"Refresh"]}),z==="agents"?e.jsxs(S,{onClick:()=>a(!0),className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"Register Agent"]}):e.jsxs(S,{onClick:()=>c(!0),className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"Create Group"]})]})]}),s&&e.jsxs("div",{className:"mb-6 p-4 bg-dark-hover rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"Register New Agent"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(K,{type:"text",placeholder:"Production Agent 1",value:L.name,onChange:y=>N({...L,name:y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Description"}),e.jsx(K,{type:"text",placeholder:"Agent for internal network scanning",value:L.description||"",onChange:y=>N({...L,description:y.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Max Concurrent Tasks"}),e.jsx(K,{type:"number",min:1,max:10,value:L.max_concurrent_tasks,onChange:y=>N({...L,max_concurrent_tasks:parseInt(y.target.value)||1})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Network Zones (comma-separated)"}),e.jsx(K,{type:"text",placeholder:"10.0.0.0/8, 192.168.0.0/16",value:(L.network_zones||[]).join(", "),onChange:y=>N({...L,network_zones:y.target.value.split(",").map(V=>V.trim())})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(S,{onClick:j,disabled:d,children:d?"Registering...":"Register"}),e.jsx(S,{variant:"secondary",onClick:()=>a(!1),children:"Cancel"})]})]})]}),t&&e.jsxs("div",{className:"mb-6 p-4 bg-dark-hover rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"Create Agent Group"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(K,{type:"text",placeholder:"Internal Network",value:_.name,onChange:y=>x({..._,name:y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Color"}),e.jsx(K,{type:"color",value:_.color,onChange:y=>x({..._,color:y.target.value}),className:"h-10 p-1"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Description"}),e.jsx(K,{type:"text",placeholder:"Agents for internal network segments",value:_.description,onChange:y=>x({..._,description:y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Network Ranges (comma-separated)"}),e.jsx(K,{type:"text",placeholder:"10.0.0.0/8, 192.168.0.0/16",value:_.network_ranges,onChange:y=>x({..._,network_ranges:y.target.value})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(S,{onClick:Q,disabled:n,children:n?"Creating...":"Create Group"}),e.jsx(S,{variant:"secondary",onClick:()=>c(!1),children:"Cancel"})]})]})]}),z==="agents"&&e.jsx("div",{className:"space-y-3",children:w.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(ge,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No agents registered yet"}),e.jsx("p",{className:"text-sm",children:"Register an agent to start distributed scanning"})]}):w.map(y=>e.jsx("div",{className:"p-4 bg-dark-hover rounded-lg border border-dark-border",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(ge,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[C===y.id?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{type:"text",value:D,onChange:V=>I(V.target.value),className:"w-48",autoFocus:!0,onKeyDown:V=>{V.key==="Enter"&&Y(y.id),V.key==="Escape"&&u(null)}}),e.jsx(S,{size:"sm",onClick:()=>Y(y.id),children:"Save"}),e.jsx(S,{size:"sm",variant:"secondary",onClick:()=>u(null),children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium",children:y.name}),$(y.status),e.jsx(te,{type:H(y.status),children:y.status})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-slate-400",children:[y.hostname&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ct,{className:"h-3 w-3"}),y.hostname]}),y.ip_address&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(xs,{className:"h-3 w-3"}),y.ip_address]}),y.version&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ls,{className:"h-3 w-3"}),"v",y.version]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-slate-500",children:[e.jsxs("span",{children:["Token: ",y.token_prefix,"..."]}),e.jsxs("span",{children:["Tasks: ",y.current_tasks,"/",y.max_concurrent_tasks]}),y.last_heartbeat_at&&e.jsxs("span",{children:["Last seen: ",new Date(y.last_heartbeat_at).toLocaleString()]})]}),y.groups.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Groups:"}),y.groups.map(V=>e.jsx("span",{className:"px-2 py-0.5 rounded text-xs",style:{backgroundColor:`${V.color}20`,color:V.color},children:V.name},V.id))]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:C!==y.id&&e.jsxs(e.Fragment,{children:[e.jsx(S,{size:"sm",variant:"ghost",onClick:()=>{u(y.id),I(y.name)},title:"Edit",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx(S,{size:"sm",variant:"ghost",onClick:()=>q(y.id),title:"Regenerate token",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx(S,{size:"sm",variant:"ghost",onClick:()=>X(y.id),className:"text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(ie,{className:"h-4 w-4"})})]})})]})},y.id))}),z==="groups"&&e.jsx("div",{className:"space-y-3",children:v.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(is,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No groups created yet"}),e.jsx("p",{className:"text-sm",children:"Create groups to organize agents by network zone"})]}):v.map(y=>e.jsx("div",{className:"p-4 bg-dark-hover rounded-lg border border-dark-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${y.color}20`},children:e.jsx(is,{className:"h-5 w-5",style:{color:y.color}})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium",children:y.name}),e.jsxs("span",{className:"text-sm text-slate-400",children:["(",y.agent_count," agent",y.agent_count!==1?"s":"",")"]})]}),y.description&&e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:y.description}),y.network_ranges&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(xs,{className:"h-3 w-3 text-slate-500"}),e.jsx("span",{className:"text-xs text-slate-500",children:JSON.parse(y.network_ranges).join(", ")})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(S,{size:"sm",variant:"ghost",onClick:()=>O(y.id),className:"text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(ie,{className:"h-4 w-4"})})})]})},y.id))})]}),e.jsxs(B,{children:[e.jsxs("h4",{className:"text-md font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5 text-primary"}),"How to Deploy Agents"]}),e.jsxs("div",{className:"space-y-4 text-sm text-slate-400",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Register a new agent above to receive a unique token. This token authenticates the agent with the server."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Download and run the HeroForge agent on your target network. Configure it with the server URL and token."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"3"})}),e.jsx("p",{children:"Create groups to organize agents by network zone (e.g., DMZ, Internal, Cloud)."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"When creating scans, select an agent or group to route the scan through the appropriate network segment."})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-dark-hover rounded-lg",children:[e.jsx("p",{className:"text-sm text-slate-300 font-medium mb-2",children:"Agent Configuration Example"}),e.jsx("pre",{className:"text-xs text-slate-400 overflow-x-auto",children:`# heroforge-agent.yaml
server_url: https://heroforge.example.com
token: hfa_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
heartbeat_interval: 30
max_concurrent_tasks: 3`})]})]})]})},As={"scan.started":"Scan Started","scan.completed":"Scan Completed","scan.failed":"Scan Failed","vulnerability.found":"Vulnerability Found","vulnerability.critical":"Critical Vulnerability","vulnerability.resolved":"Vulnerability Resolved","asset.discovered":"Asset Discovered","compliance.violation":"Compliance Violation"};function oa(){const[i,A]=r.useState([]),[w,h]=r.useState([]),[v,b]=r.useState(!0),[g,M]=r.useState(!1),[s,a]=r.useState(null),[t,c]=r.useState(!1),[d,p]=r.useState(null),[n,T]=r.useState([]),[E,G]=r.useState(!1),[f,k]=r.useState(null),[C,u]=r.useState(null),[D,I]=r.useState(""),[z,R]=r.useState(""),[L,N]=r.useState(""),[_,x]=r.useState([]),[F,j]=r.useState([]),[Q,X]=r.useState(!0),[O,q]=r.useState(!1),[Y,o]=r.useState(!1);r.useEffect(()=>{$(),H()},[]);const $=async()=>{try{const U=await ke.list();A(U.data)}catch(U){console.error("Failed to load webhooks:",U),l.error("Failed to load webhooks")}finally{b(!1)}},H=async()=>{try{const U=await ke.getEventTypes();h(U.data.event_types)}catch(U){console.error("Failed to load event types:",U)}},y=()=>{I(""),R(""),N(""),x([]),j([]),X(!0),q(!1),a(null)},V=()=>{y(),M(!0)},m=U=>{a(U),I(U.name),R(U.url),N(""),x([...U.events]),j(U.headers?Object.entries(U.headers).map(([se,ce])=>({key:se,value:ce})):[]),X(U.is_active),M(!0)},W=()=>{M(!1),y()},J=async()=>{try{const U=await ke.generateSecret();N(U.data.secret),q(!0),l.success("Secret generated")}catch{l.error("Failed to generate secret")}},me=()=>{L&&(navigator.clipboard.writeText(L),l.success("Secret copied to clipboard"))},P=()=>{j([...F,{key:"",value:""}])},re=U=>{j(F.filter((se,ce)=>ce!==U))},pe=(U,se,ce)=>{const xe=[...F];xe[U][se]=ce,j(xe)},ct=U=>{_.includes(U)?x(_.filter(se=>se!==U)):x([..._,U])},ot=async U=>{var se,ce;if(U.preventDefault(),!z.startsWith("http://")&&!z.startsWith("https://")){l.error("URL must start with http:// or https://");return}if(_.length===0){l.error("Please select at least one event");return}o(!0);try{const xe={};if(F.forEach(ne=>{ne.key.trim()&&ne.value.trim()&&(xe[ne.key.trim()]=ne.value.trim())}),s){const ne={name:D,url:z,events:_,headers:Object.keys(xe).length>0?xe:void 0,is_active:Q};L&&(ne.secret=L),await ke.update(s.id,ne),l.success("Webhook updated")}else{const ne={name:D,url:z,events:_,headers:Object.keys(xe).length>0?xe:void 0,is_active:Q};L&&(ne.secret=L),await ke.create(ne),l.success("Webhook created")}W(),$()}catch(xe){const ne=((ce=(se=xe.response)==null?void 0:se.data)==null?void 0:ce.error)||"Failed to save webhook";l.error(ne)}finally{o(!1)}},dt=async(U,se)=>{if(confirm(`Are you sure you want to delete the webhook "${se}"?`))try{await ke.delete(U),l.success("Webhook deleted"),$()}catch{l.error("Failed to delete webhook")}},mt=async U=>{var se,ce;k(U);try{const ne=(await ke.test(U)).data;ne.success?l.success(`Test successful (HTTP ${ne.status_code})`):l.error(`Test failed: ${ne.error||"Unknown error"}`)}catch(xe){const ne=((ce=(se=xe.response)==null?void 0:se.data)==null?void 0:ce.error)||"Failed to test webhook";l.error(ne)}finally{k(null)}},xt=async U=>{p(U),c(!0),G(!0);try{const se=await ke.getDeliveries(U,50);T(se.data)}catch{l.error("Failed to load delivery history"),T([])}finally{G(!1)}},ut=U=>U.is_active?U.failure_count>=5?e.jsx(we,{className:"w-5 h-5 text-red-500"}):U.last_status_code&&U.last_status_code>=200&&U.last_status_code<300?e.jsx(de,{className:"w-5 h-5 text-green-500"}):e.jsx(ze,{className:"w-5 h-5 text-yellow-500"}):e.jsx(ze,{className:"w-5 h-5 text-gray-500"}),ys=U=>U?new Date(U).toLocaleString():"Never";return v?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Fe,{className:"w-6 h-6 animate-spin text-cyan-400"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"Webhooks"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Send HTTP notifications to external systems when events occur"})]}),e.jsxs("button",{onClick:V,className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(oe,{className:"w-4 h-4"}),"Add Webhook"]})]}),i.length===0?e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-8 text-center",children:[e.jsx(qs,{className:"w-12 h-12 mx-auto text-gray-500 mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-300",children:"No webhooks configured"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Create a webhook to send notifications to external systems"})]}):e.jsx("div",{className:"space-y-4",children:i.map(U=>e.jsx("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[ut(U),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-100",children:U.name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 font-mono",children:U.url}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:U.events.map(se=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-700 text-gray-300 rounded",children:As[se]||se},se))}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-400",children:[e.jsxs("span",{children:["Last triggered: ",ys(U.last_triggered_at)]}),U.last_status_code&&e.jsxs("span",{className:U.last_status_code>=200&&U.last_status_code<300?"text-green-400":"text-red-400",children:["HTTP ",U.last_status_code]}),U.failure_count>0&&e.jsxs("span",{className:"text-red-400",children:[U.failure_count," failures"]}),U.has_secret&&e.jsx("span",{className:"text-cyan-400",children:"Signed"}),!U.is_active&&e.jsx("span",{className:"text-gray-500",children:"Disabled"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>mt(U.id),disabled:f===U.id,className:"p-2 text-gray-400 hover:text-cyan-400 transition-colors disabled:opacity-50",title:"Test webhook",children:f===U.id?e.jsx(Fe,{className:"w-4 h-4 animate-spin"}):e.jsx(St,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>xt(U.id),className:"p-2 text-gray-400 hover:text-cyan-400 transition-colors",title:"View delivery history",children:e.jsx(Is,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>m(U),className:"p-2 text-gray-400 hover:text-cyan-400 transition-colors",title:"Edit webhook",children:e.jsx(_e,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>dt(U.id,U.name),className:"p-2 text-gray-400 hover:text-red-400 transition-colors",title:"Delete webhook",children:e.jsx(ie,{className:"w-4 h-4"})})]})]})},U.id))}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100 mb-4",children:s?"Edit Webhook":"Create Webhook"}),e.jsxs("form",{onSubmit:ot,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:D,onChange:U=>I(U.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"My Webhook"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"URL"}),e.jsx("input",{type:"url",value:z,onChange:U=>R(U.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent font-mono text-sm",placeholder:"https://example.com/webhook"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Secret Key (optional)"}),e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"If set, requests will include an X-Webhook-Signature header with HMAC-SHA256 signature"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:O?"text":"password",value:L,onChange:U=>N(U.target.value),className:"w-full px-3 py-2 pr-20 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent font-mono text-sm",placeholder:s!=null&&s.has_secret?"(unchanged)":"Enter or generate a secret"}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex gap-1",children:[e.jsx("button",{type:"button",onClick:()=>q(!O),className:"p-1 text-gray-400 hover:text-gray-200",children:O?e.jsx(gs,{className:"w-4 h-4"}):e.jsx(Bs,{className:"w-4 h-4"})}),L&&e.jsx("button",{type:"button",onClick:me,className:"p-1 text-gray-400 hover:text-gray-200",children:e.jsx(he,{className:"w-4 h-4"})})]})]}),e.jsx("button",{type:"button",onClick:J,className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg transition-colors",children:"Generate"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Events"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:w.map(U=>e.jsxs("label",{className:"flex items-start gap-2 p-3 bg-gray-700/50 rounded-lg cursor-pointer hover:bg-gray-700",children:[e.jsx("input",{type:"checkbox",checked:_.includes(U.id),onChange:()=>ct(U.id),className:"mt-1 rounded border-gray-600 bg-gray-700 text-cyan-500 focus:ring-cyan-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-200",children:U.name}),e.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:U.description})]})]},U.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Custom Headers (optional)"}),e.jsx("button",{type:"button",onClick:P,className:"text-sm text-cyan-400 hover:text-cyan-300",children:"+ Add Header"})]}),F.length>0&&e.jsx("div",{className:"space-y-2",children:F.map((U,se)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:U.key,onChange:ce=>pe(se,"key",ce.target.value),placeholder:"Header name",className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 text-sm"}),e.jsx("input",{type:"text",value:U.value,onChange:ce=>pe(se,"value",ce.target.value),placeholder:"Header value",className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 text-sm"}),e.jsx("button",{type:"button",onClick:()=>re(se),className:"p-2 text-gray-400 hover:text-red-400",children:e.jsx(ie,{className:"w-4 h-4"})})]},se))})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:Q,onChange:U=>X(U.target.checked),className:"rounded border-gray-600 bg-gray-700 text-cyan-500 focus:ring-cyan-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Enable webhook"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:W,className:"px-4 py-2 text-gray-300 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:Y,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors disabled:opacity-50",children:Y?"Saving...":s?"Save Changes":"Create Webhook"})]})]})]})}),t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"Delivery History"}),e.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-white",children:"Close"})]}),E?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Fe,{className:"w-6 h-6 animate-spin text-cyan-400"})}):n.length===0?e.jsx("div",{className:"text-center py-12 text-gray-400",children:"No deliveries yet"}):e.jsx("div",{className:"space-y-3",children:n.map(U=>e.jsxs("div",{className:"bg-gray-700/50 rounded-lg border border-gray-600",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer",onClick:()=>u(C===U.id?null:U.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[U.response_status&&U.response_status>=200&&U.response_status<300?e.jsx(de,{className:"w-5 h-5 text-green-500"}):e.jsx(we,{className:"w-5 h-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-200",children:As[U.event_type]||U.event_type}),e.jsx("span",{className:"text-sm text-gray-400 ml-3",children:ys(U.delivered_at)})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[U.response_status&&e.jsxs("span",{className:U.response_status>=200&&U.response_status<300?"text-green-400":"text-red-400",children:["HTTP ",U.response_status]}),U.error&&e.jsx("span",{className:"text-red-400 text-sm",children:U.error}),C===U.id?e.jsx(Hs,{className:"w-4 h-4 text-gray-400"}):e.jsx(Je,{className:"w-4 h-4 text-gray-400"})]})]}),C===U.id&&e.jsxs("div",{className:"px-4 pb-4 border-t border-gray-600 pt-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-400 mb-2",children:"Request Payload"}),e.jsx("pre",{className:"bg-gray-900 p-3 rounded text-xs text-gray-300 overflow-x-auto",children:JSON.stringify(JSON.parse(U.payload||"{}"),null,2)})]}),U.response_body&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-400 mb-2",children:"Response Body"}),e.jsx("pre",{className:"bg-gray-900 p-3 rounded text-xs text-gray-300 overflow-x-auto max-h-48",children:U.response_body})]})]})]},U.id))})]})})]})}const da=()=>{var me;const[i,A]=r.useState([]),[w,h]=r.useState(!0),[v,b]=r.useState(!1),[g,M]=r.useState({name:"",platform:"github_actions",permissions:{trigger_scans:!0,view_results:!0,download_reports:!0,view_quality_gates:!0},expires_in_days:90}),[s,a]=r.useState(null),[t,c]=r.useState(!1),[d,p]=r.useState([]),[n,T]=r.useState(!0),[E,G]=r.useState(!1),[f,k]=r.useState({name:"",description:"",fail_on_critical:!0,fail_on_high:!0,max_critical:0,max_high:0,max_medium:10,max_low:50,is_default:!1}),[C,u]=r.useState(!1),[D,I]=r.useState([]),[z,R]=r.useState(!0),[L,N]=r.useState("tokens"),[_,x]=r.useState("github"),[F,j]=r.useState(""),[Q,X]=r.useState(!1);r.useEffect(()=>{O(),q(),Y()},[]),r.useEffect(()=>{L==="examples"&&o()},[_,L]);const O=async()=>{try{h(!0);const P=await Ce.tokens.list();A(P.data)}catch(P){console.error("Failed to load tokens:",P),l.error("Failed to load CI/CD tokens")}finally{h(!1)}},q=async()=>{try{T(!0);const P=await Ce.qualityGates.list();p(P.data)}catch(P){console.error("Failed to load quality gates:",P),l.error("Failed to load quality gates")}finally{T(!1)}},Y=async()=>{try{R(!0);const P=await Ce.runs.list(20);I(P.data)}catch(P){console.error("Failed to load runs:",P),l.error("Failed to load CI/CD runs")}finally{R(!1)}},o=async()=>{try{X(!0);const P=await Ce.examples.get(_);j(P.data.content)}catch(P){console.error("Failed to load pipeline example:",P),l.error("Failed to load pipeline example")}finally{X(!1)}},$=async()=>{if(!g.name.trim()){l.error("Token name is required");return}try{c(!0);let P;if(g.expires_in_days){const pe=new Date;pe.setDate(pe.getDate()+g.expires_in_days),P=pe.toISOString()}const re=await Ce.tokens.create({name:g.name,platform:g.platform==="generic"?"github_actions":g.platform,permissions:g.permissions,expires_at:P});a(re.data.token),await O(),l.success("CI/CD token created successfully")}catch(P){console.error("Failed to create token:",P),l.error("Failed to create token")}finally{c(!1)}},H=async P=>{if(confirm("Are you sure you want to revoke this token?"))try{await Ce.tokens.delete(P),await O(),l.success("Token revoked successfully")}catch(re){console.error("Failed to delete token:",re),l.error("Failed to revoke token")}},y=async()=>{if(!f.name.trim()){l.error("Quality gate name is required");return}try{u(!0),await Ce.qualityGates.create({name:f.name,description:f.description||void 0,fail_on_critical:f.fail_on_critical,fail_on_high:f.fail_on_high,max_critical:f.max_critical,max_high:f.max_high,max_medium:f.max_medium,max_low:f.max_low,is_default:f.is_default}),await q(),G(!1),k({name:"",description:"",fail_on_critical:!0,fail_on_high:!0,max_critical:0,max_high:0,max_medium:10,max_low:50,is_default:!1}),l.success("Quality gate created successfully")}catch(P){console.error("Failed to create quality gate:",P),l.error("Failed to create quality gate")}finally{u(!1)}},V=async P=>{if(confirm("Are you sure you want to delete this quality gate?"))try{await Ce.qualityGates.delete(P),await q(),l.success("Quality gate deleted")}catch(re){console.error("Failed to delete quality gate:",re),l.error("Failed to delete quality gate")}},m=P=>{navigator.clipboard.writeText(P),l.success("Copied to clipboard")},W=P=>new Date(P).toLocaleString(),J=P=>{switch(P){case"github_actions":return"GitHub Actions";case"jenkins":return"Jenkins";case"gitlab_ci":return"GitLab CI";default:return"Generic"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-2 border-b border-dark-border pb-2",children:[e.jsxs("button",{onClick:()=>N("tokens"),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg font-medium transition-colors ${L==="tokens"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(Te,{className:"h-4 w-4"}),"API Tokens"]}),e.jsxs("button",{onClick:()=>N("quality-gates"),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg font-medium transition-colors ${L==="quality-gates"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(ue,{className:"h-4 w-4"}),"Quality Gates"]}),e.jsxs("button",{onClick:()=>N("runs"),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg font-medium transition-colors ${L==="runs"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(Ws,{className:"h-4 w-4"}),"Recent Runs"]}),e.jsxs("button",{onClick:()=>N("examples"),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg font-medium transition-colors ${L==="examples"?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[e.jsx(Et,{className:"h-4 w-4"}),"Pipeline Examples"]})]}),L==="tokens"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"CI/CD API Tokens"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Create tokens for your CI/CD pipelines to trigger scans"})]}),e.jsxs(S,{onClick:()=>{b(!0),a(null)},children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"New Token"]})]}),v&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4 space-y-4",children:[e.jsx("h4",{className:"font-medium text-white",children:"Create New Token"}),s?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:[e.jsx("p",{className:"text-green-400 text-sm mb-2",children:"Token created successfully! Copy it now - it won't be shown again."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"bg-dark-bg px-3 py-2 rounded text-sm text-white flex-1 font-mono",children:s}),e.jsx(S,{onClick:()=>m(s),variant:"outline",size:"sm",children:e.jsx(he,{className:"h-4 w-4"})})]})]}),e.jsx(S,{onClick:()=>{b(!1),a(null)},variant:"outline",children:"Done"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(K,{label:"Token Name",value:g.name,onChange:P=>M({...g,name:P.target.value}),placeholder:"e.g., GitHub Actions Production"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Platform"}),e.jsxs("select",{value:g.platform,onChange:P=>M({...g,platform:P.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"github_actions",children:"GitHub Actions"}),e.jsx("option",{value:"jenkins",children:"Jenkins"}),e.jsx("option",{value:"gitlab_ci",children:"GitLab CI"}),e.jsx("option",{value:"generic",children:"Generic"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Permissions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(Ie,{checked:g.permissions.trigger_scans,onChange:P=>M({...g,permissions:{...g.permissions,trigger_scans:P}}),label:"Trigger scans"}),e.jsx(Ie,{checked:g.permissions.view_results,onChange:P=>M({...g,permissions:{...g.permissions,view_results:P}}),label:"View results"}),e.jsx(Ie,{checked:g.permissions.download_reports,onChange:P=>M({...g,permissions:{...g.permissions,download_reports:P}}),label:"Download reports"}),e.jsx(Ie,{checked:g.permissions.view_quality_gates,onChange:P=>M({...g,permissions:{...g.permissions,view_quality_gates:P}}),label:"View quality gates"})]})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Expiration (days)"}),e.jsx(K,{type:"number",value:((me=g.expires_in_days)==null?void 0:me.toString())||"",onChange:P=>M({...g,expires_in_days:P.target.value?parseInt(P.target.value):null}),placeholder:"Never expires if empty"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{onClick:$,loading:t,children:"Create Token"}),e.jsx(S,{onClick:()=>b(!1),variant:"outline",children:"Cancel"})]})]})]}),w?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"Loading tokens..."}):i.length===0?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No CI/CD tokens created yet. Create one to get started."}):e.jsx("div",{className:"space-y-2",children:i.map(P=>e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:P.name}),e.jsx("span",{className:"text-xs bg-primary/20 text-primary px-2 py-0.5 rounded",children:J(P.platform)})]}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:[e.jsxs("code",{className:"bg-dark-bg px-2 py-0.5 rounded",children:[P.prefix,"..."]}),e.jsx("span",{className:"mx-2",children:"-"}),"Created ",W(P.created_at),P.last_used_at&&e.jsxs("span",{className:"ml-2",children:["- Last used ",W(P.last_used_at)]}),P.expires_at&&e.jsxs("span",{className:"ml-2",children:["- Expires ",W(P.expires_at)]})]})]}),e.jsx(S,{onClick:()=>H(P.id),variant:"outline",size:"sm",className:"text-red-400 hover:text-red-300",children:e.jsx(ie,{className:"h-4 w-4"})})]},P.id))})]}),L==="quality-gates"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Quality Gates"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Configure pass/fail thresholds for your CI/CD pipelines"})]}),e.jsxs(S,{onClick:()=>G(!0),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"New Quality Gate"]})]}),E&&e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4 space-y-4",children:[e.jsx("h4",{className:"font-medium text-white",children:"Create Quality Gate"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(K,{label:"Name",value:f.name,onChange:P=>k({...f,name:P.target.value}),placeholder:"e.g., Production Standards"}),e.jsx(K,{label:"Description",value:f.description,onChange:P=>k({...f,description:P.target.value}),placeholder:"Optional description"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(Ie,{checked:f.fail_on_critical,onChange:P=>k({...f,fail_on_critical:P}),label:"Fail on critical vulnerabilities"}),e.jsx(Ie,{checked:f.fail_on_high,onChange:P=>k({...f,fail_on_high:P}),label:"Fail on high vulnerabilities"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Max Critical"}),e.jsx(K,{type:"number",value:f.max_critical.toString(),onChange:P=>k({...f,max_critical:parseInt(P.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Max High"}),e.jsx(K,{type:"number",value:f.max_high.toString(),onChange:P=>k({...f,max_high:parseInt(P.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Max Medium"}),e.jsx(K,{type:"number",value:f.max_medium.toString(),onChange:P=>k({...f,max_medium:parseInt(P.target.value)||0}),placeholder:"10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Max Low"}),e.jsx(K,{type:"number",value:f.max_low.toString(),onChange:P=>k({...f,max_low:parseInt(P.target.value)||0}),placeholder:"50"})]})]}),e.jsx("div",{className:"flex gap-4",children:e.jsx(Ie,{checked:f.is_default,onChange:P=>k({...f,is_default:P}),label:"Set as default quality gate"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{onClick:y,loading:C,children:"Create Quality Gate"}),e.jsx(S,{onClick:()=>G(!1),variant:"outline",children:"Cancel"})]})]}),n?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"Loading quality gates..."}):d.length===0?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No quality gates configured. The default gate will block any critical vulnerabilities."}):e.jsx("div",{className:"space-y-2",children:d.map(P=>e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:P.name}),P.is_default&&e.jsx("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-0.5 rounded",children:"Default"}),!P.user_id&&e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded",children:"System"})]}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:[P.fail_on_critical&&"Fail on Critical",P.fail_on_high&&(P.fail_on_critical?", High":"Fail on High"),` - Max: Critical=${P.max_critical}, High=${P.max_high}, Medium=${P.max_medium}, Low=${P.max_low}`]}),P.description&&e.jsx("div",{className:"text-sm text-slate-500 mt-1",children:P.description})]}),P.user_id&&e.jsx(S,{onClick:()=>V(P.id),variant:"outline",size:"sm",className:"text-red-400 hover:text-red-300",children:e.jsx(ie,{className:"h-4 w-4"})})]},P.id))})]}),L==="runs"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Recent CI/CD Runs"}),e.jsx("p",{className:"text-sm text-slate-400",children:"View recent scans triggered from CI/CD pipelines"})]}),z?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"Loading runs..."}):D.length===0?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"No CI/CD runs yet. Trigger a scan from your pipeline to see results here."}):e.jsx("div",{className:"space-y-2",children:D.map(P=>e.jsx("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[P.quality_gate_passed===!0?e.jsx(At,{className:"h-5 w-5 text-green-400"}):P.quality_gate_passed===!1?e.jsx(we,{className:"h-5 w-5 text-red-400"}):e.jsx(Ks,{className:"h-5 w-5 text-slate-400 animate-spin"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:P.scan_id?`Scan ${P.scan_id.slice(0,8)}...`:"Pending Scan"}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${P.status==="completed"?"bg-green-500/20 text-green-400":P.status==="failed"?"bg-red-500/20 text-red-400":P.status==="running"?"bg-blue-500/20 text-blue-400":"bg-slate-500/20 text-slate-400"}`,children:P.status})]}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:[J(P.platform),P.branch&&` - ${P.branch}`,P.commit_sha&&` (${P.commit_sha.slice(0,7)})`,e.jsxs("span",{className:"ml-2",children:["- ",W(P.started_at)]}),P.exit_code!==null&&e.jsxs("span",{className:"ml-2",children:["Exit code: ",P.exit_code]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:P.pipeline_url&&e.jsx("a",{href:P.pipeline_url,target:"_blank",rel:"noopener noreferrer",className:"text-slate-400 hover:text-white",children:e.jsx(Ze,{className:"h-4 w-4"})})})]})},P.id))})]}),L==="examples"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Pipeline Configuration Examples"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Copy these examples to integrate HeroForge with your CI/CD platform"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x("github"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${_==="github"?"bg-primary text-white":"bg-dark-surface text-slate-400 hover:text-white"}`,children:"GitHub Actions"}),e.jsx("button",{onClick:()=>x("jenkins"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${_==="jenkins"?"bg-primary text-white":"bg-dark-surface text-slate-400 hover:text-white"}`,children:"Jenkins"}),e.jsx("button",{onClick:()=>x("gitlab"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${_==="gitlab"?"bg-primary text-white":"bg-dark-surface text-slate-400 hover:text-white"}`,children:"GitLab CI"})]}),e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm text-slate-400",children:[_==="github"&&".github/workflows/security-scan.yml",_==="jenkins"&&"Jenkinsfile",_==="gitlab"&&".gitlab-ci.yml"]}),e.jsxs(S,{onClick:()=>m(F),variant:"outline",size:"sm",children:[e.jsx(he,{className:"h-4 w-4 mr-1"}),"Copy"]})]}),Q?e.jsx("div",{className:"text-center py-8 text-slate-400",children:"Loading example..."}):e.jsx("pre",{className:"bg-dark-bg rounded-lg p-4 text-sm text-slate-300 overflow-x-auto max-h-[500px]",children:e.jsx("code",{children:F})})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-400 mb-2",children:"Setup Instructions"}),e.jsxs("ol",{className:"text-sm text-slate-300 space-y-2 list-decimal list-inside",children:[e.jsx("li",{children:'Create a CI/CD token in the "API Tokens" tab above'}),e.jsxs("li",{children:["Add the token as a secret in your CI/CD platform:",e.jsxs("ul",{className:"ml-6 mt-1 space-y-1",children:[e.jsx("li",{children:"GitHub: Settings > Secrets > HEROFORGE_CI_TOKEN"}),e.jsx("li",{children:"Jenkins: Credentials > Add > heroforge-ci-token"}),e.jsx("li",{children:"GitLab: Settings > CI/CD > Variables > HEROFORGE_CI_TOKEN"})]})]}),e.jsx("li",{children:"Copy the pipeline configuration above to your repository"}),e.jsx("li",{children:"Update the target IP addresses in the configuration"}),e.jsx("li",{children:"Configure a quality gate if needed (defaults will be used otherwise)"})]})]})]})]})},ma=()=>{const[i,A]=r.useState(!0),[w,h]=r.useState([]),[v,b]=r.useState([]),[g,M]=r.useState(null),[s,a]=r.useState(!1),[t,c]=r.useState(!1),[d,p]=r.useState(null);r.useEffect(()=>{n()},[]);const n=async()=>{A(!0);try{const[f,k]=await Promise.all([ve.admin.listProviders(),ve.admin.getPresets()]);h(f.data),b(k.data)}catch(f){console.error("Failed to load SSO data:",f),l.error("Failed to load SSO providers")}finally{A(!1)}},T=async f=>{p(f);try{const k=await ve.admin.testProvider(f);k.data.success?l.success(k.data.message):l.error(k.data.message)}catch(k){console.error("Test failed:",k),l.error("Connection test failed")}finally{p(null)}},E=async f=>{if(confirm("Are you sure you want to delete this SSO provider?"))try{await ve.admin.deleteProvider(f),l.success("SSO provider deleted"),n()}catch(k){console.error("Delete failed:",k),l.error("Failed to delete provider")}},G=async f=>{const k=f.status==="active"?"disabled":"active";try{await ve.admin.updateProvider(f.id,{status:k}),l.success(`Provider ${k==="active"?"enabled":"disabled"}`),n()}catch(C){console.error("Status toggle failed:",C),l.error("Failed to update provider status")}};return i?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx(ee,{})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"SSO Authentication"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Configure SAML 2.0 and OpenID Connect identity providers for enterprise single sign-on"})]}),e.jsxs(S,{onClick:()=>a(!0),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Add Provider"]})]}),w.length===0?e.jsxs(B,{className:"p-8 text-center",children:[e.jsx(bs,{className:"h-12 w-12 text-gray-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"No SSO Providers Configured"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Add an identity provider to enable single sign-on for your users."}),e.jsxs(S,{onClick:()=>a(!0),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Add Your First Provider"]})]}):e.jsx("div",{className:"space-y-4",children:w.map(f=>e.jsx(xa,{provider:f,onEdit:()=>{M(f),c(!0)},onDelete:()=>E(f.id),onTest:()=>T(f.id),onToggleStatus:()=>G(f),testing:d===f.id},f.id))}),s&&e.jsx(ua,{presets:v,onClose:()=>a(!1),onSuccess:()=>{a(!1),n()}}),t&&g&&e.jsx(ha,{provider:g,onClose:()=>{c(!1),M(null)},onSuccess:()=>{c(!1),M(null),n()}})]})},xa=({provider:i,onEdit:A,onDelete:w,onTest:h,onToggleStatus:v,testing:b})=>{const[g,M]=r.useState(!1),[s,a]=r.useState(null),[t,c]=r.useState(!1),d=async()=>{if(!s){c(!0);try{const E=await ve.admin.getMetadata(i.id);a(E.data)}catch(E){console.error("Failed to load metadata:",E)}finally{c(!1)}}},p=()=>{g||d(),M(!g)},n=E=>{navigator.clipboard.writeText(E),l.success("Copied to clipboard")},T=async()=>{try{const E=await ve.admin.downloadMetadataXml(i.id),G=new Blob([E.data],{type:"application/xml"}),f=window.URL.createObjectURL(G),k=document.createElement("a");k.href=f,k.download=`sp-metadata-${i.name}.xml`,k.click(),window.URL.revokeObjectURL(f)}catch(E){console.error("Download failed:",E),l.error("Failed to download metadata")}};return e.jsxs(B,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-gray-700 rounded-lg",children:i.provider_type==="saml"?e.jsx(ue,{className:"h-6 w-6 text-cyan-400"}):e.jsx(bs,{className:"h-6 w-6 text-cyan-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-white",children:i.display_name}),e.jsx(te,{className:i.provider_type==="saml"?"bg-purple-600":"bg-blue-600",children:i.provider_type.toUpperCase()}),i.status==="active"?e.jsx(te,{className:"bg-green-600",children:"Active"}):e.jsx(te,{className:"bg-gray-600",children:"Disabled"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:i.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(S,{variant:"secondary",size:"sm",onClick:h,disabled:b,children:[b?e.jsx(ee,{size:"sm"}):e.jsx(js,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-1",children:"Test"})]}),e.jsx(S,{variant:"secondary",size:"sm",onClick:v,children:i.status==="active"?e.jsx(we,{className:"h-4 w-4"}):e.jsx(de,{className:"h-4 w-4"})}),e.jsx(S,{variant:"secondary",size:"sm",onClick:A,children:e.jsx(Pt,{className:"h-4 w-4"})}),e.jsx(S,{variant:"danger",size:"sm",onClick:w,children:e.jsx(ie,{className:"h-4 w-4"})}),e.jsx(S,{variant:"secondary",size:"sm",onClick:p,children:g?e.jsx(Hs,{className:"h-4 w-4"}):e.jsx(Je,{className:"h-4 w-4"})})]})]}),g&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-700",children:t?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(ee,{})}):s?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300",children:"Service Provider Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Entity ID"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm text-cyan-400 bg-gray-800 px-2 py-1 rounded flex-1 truncate",children:s.entity_id}),e.jsx(S,{size:"sm",variant:"secondary",onClick:()=>n(s.entity_id),children:e.jsx(he,{className:"h-3 w-3"})})]})]}),s.acs_url&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"ACS URL"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm text-cyan-400 bg-gray-800 px-2 py-1 rounded flex-1 truncate",children:s.acs_url}),e.jsx(S,{size:"sm",variant:"secondary",onClick:()=>n(s.acs_url),children:e.jsx(he,{className:"h-3 w-3"})})]})]}),s.redirect_uri&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Redirect URI"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm text-cyan-400 bg-gray-800 px-2 py-1 rounded flex-1 truncate",children:s.redirect_uri}),e.jsx(S,{size:"sm",variant:"secondary",onClick:()=>n(s.redirect_uri),children:e.jsx(he,{className:"h-3 w-3"})})]})]})]}),i.provider_type==="saml"&&e.jsxs(S,{variant:"secondary",size:"sm",onClick:T,children:[e.jsx($s,{className:"h-4 w-4 mr-2"}),"Download SP Metadata XML"]}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx($e,{className:"h-3 w-3"}),"Configure your Identity Provider with the above values"]})]}):e.jsx("p",{className:"text-gray-400 text-sm",children:"Failed to load metadata"})})]})},ua=({presets:i,onClose:A,onSuccess:w})=>{const[h,v]=r.useState("preset"),[b,g]=r.useState(null),[M,s]=r.useState(!1),[a,t]=r.useState({name:"",display_name:"",idp_entity_id:"",idp_sso_url:"",idp_slo_url:"",idp_certificate:"",issuer_url:"",client_id:"",client_secret:"",scopes:"openid email profile",jit_provisioning:!0,default_role:"user"}),c=p=>{g(p),t(n=>({...n,name:p.name.toLowerCase().replace(/\s+/g,"_"),display_name:p.name})),v("configure")},d=async()=>{var p,n;if(b){s(!0);try{let T;b.provider_type==="saml"?T={type:"saml",idp_entity_id:a.idp_entity_id,idp_sso_url:a.idp_sso_url,idp_slo_url:a.idp_slo_url||void 0,idp_certificate:a.idp_certificate,sign_requests:!0,require_signed_response:!0,require_signed_assertion:!0,encrypt_assertions:!1,force_authn:!1,allowed_clock_skew:60}:T={type:"oidc",issuer_url:a.issuer_url,client_id:a.client_id,client_secret:a.client_secret,scopes:a.scopes.split(/[,\s]+/).filter(Boolean),use_pkce:!0,response_type:"code"};const E={name:a.name,display_name:a.display_name,provider_type:b.provider_type,icon:b.icon,config:T,attribute_mappings:b.default_attribute_mappings,jit_provisioning:a.jit_provisioning,default_role:a.default_role};await ve.admin.createProvider(E),l.success("SSO provider created"),w()}catch(T){const E=T;console.error("Create failed:",T),l.error(((n=(p=E.response)==null?void 0:p.data)==null?void 0:n.error)||"Failed to create provider")}finally{s(!1)}}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Add SSO Provider"}),e.jsx("button",{onClick:A,className:"text-gray-400 hover:text-white",children:e.jsx(we,{className:"h-6 w-6"})})]}),h==="preset"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-400 mb-4",children:"Select an identity provider:"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:i.map(p=>e.jsxs("button",{onClick:()=>c(p),className:"p-4 bg-gray-700 hover:bg-gray-600 rounded-lg text-left transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[p.provider_type==="saml"?e.jsx(ue,{className:"h-6 w-6 text-purple-400"}):e.jsx(bs,{className:"h-6 w-6 text-blue-400"}),e.jsx("span",{className:"font-medium text-white",children:p.name})]}),e.jsx("p",{className:"text-sm text-gray-400",children:p.description}),e.jsx(te,{className:p.provider_type==="saml"?"bg-purple-600 mt-2":"bg-blue-600 mt-2",children:p.provider_type.toUpperCase()})]},p.id))})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("button",{onClick:()=>v("preset"),className:"text-cyan-400 hover:text-cyan-300",children:"Back"}),e.jsx("span",{className:"text-gray-500",children:"/"}),e.jsx("span",{className:"text-white",children:b==null?void 0:b.name})]}),(b==null?void 0:b.setup_instructions)&&e.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg mb-4 text-sm text-gray-300",children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),"Setup Instructions"]}),e.jsx("div",{className:"prose prose-invert prose-sm max-w-none whitespace-pre-wrap",children:b.setup_instructions})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Internal Name"}),e.jsx(K,{value:a.name,onChange:p=>t(n=>({...n,name:p.target.value})),placeholder:"my_idp"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Display Name"}),e.jsx(K,{value:a.display_name,onChange:p=>t(n=>({...n,display_name:p.target.value})),placeholder:"My Identity Provider"})]})]}),(b==null?void 0:b.provider_type)==="saml"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"IdP Entity ID"}),e.jsx(K,{value:a.idp_entity_id,onChange:p=>t(n=>({...n,idp_entity_id:p.target.value})),placeholder:"https://idp.example.com/metadata"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"IdP SSO URL"}),e.jsx(K,{value:a.idp_sso_url,onChange:p=>t(n=>({...n,idp_sso_url:p.target.value})),placeholder:"https://idp.example.com/sso/saml"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"IdP SLO URL (Optional)"}),e.jsx(K,{value:a.idp_slo_url,onChange:p=>t(n=>({...n,idp_slo_url:p.target.value})),placeholder:"https://idp.example.com/slo/saml"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"IdP Certificate (PEM)"}),e.jsx("textarea",{value:a.idp_certificate,onChange:p=>t(n=>({...n,idp_certificate:p.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 font-mono text-sm",rows:5,placeholder:`-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----`})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Issuer URL"}),e.jsx(K,{value:a.issuer_url,onChange:p=>t(n=>({...n,issuer_url:p.target.value})),placeholder:"https://login.microsoftonline.com/{tenant}/v2.0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Client ID"}),e.jsx(K,{value:a.client_id,onChange:p=>t(n=>({...n,client_id:p.target.value})),placeholder:"your-client-id"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Client Secret"}),e.jsx(K,{type:"password",value:a.client_secret,onChange:p=>t(n=>({...n,client_secret:p.target.value})),placeholder:"your-client-secret"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Scopes"}),e.jsx(K,{value:a.scopes,onChange:p=>t(n=>({...n,scopes:p.target.value})),placeholder:"openid email profile"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Default Role"}),e.jsxs("select",{value:a.default_role,onChange:p=>t(n=>({...n,default_role:p.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"auditor",children:"Auditor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsx("div",{className:"flex items-center pt-6",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.jit_provisioning,onChange:p=>t(n=>({...n,jit_provisioning:p.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Enable JIT User Provisioning"})]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(S,{variant:"secondary",onClick:A,children:"Cancel"}),e.jsx(S,{onClick:d,disabled:M,children:M?e.jsx(ee,{size:"sm"}):"Create Provider"})]})]})]})})},ha=({provider:i,onClose:A,onSuccess:w})=>{const[h,v]=r.useState(!1),[b,g]=r.useState("general"),[M,s]=r.useState({display_name:i.display_name,jit_provisioning:i.jit_provisioning,default_role:i.default_role,update_on_login:i.update_on_login}),[a,t]=r.useState(i.attribute_mappings||[]),[c,d]=r.useState(i.group_mappings||[]),p=async()=>{v(!0);try{const f={display_name:M.display_name,jit_provisioning:M.jit_provisioning,default_role:M.default_role,update_on_login:M.update_on_login,attribute_mappings:a,group_mappings:c};await ve.admin.updateProvider(i.id,f),l.success("SSO provider updated"),w()}catch(f){console.error("Update failed:",f),l.error("Failed to update provider")}finally{v(!1)}},n=()=>{t([...a,{source:"",target:"",required:!1}])},T=f=>{t(a.filter((k,C)=>C!==f))},E=()=>{d([...c,{group:"",role:"user",priority:0}])},G=f=>{d(c.filter((k,C)=>C!==f))};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-white",children:["Edit ",i.display_name]}),e.jsx("button",{onClick:A,className:"text-gray-400 hover:text-white",children:e.jsx(we,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex border-b border-gray-700 mb-4",children:[e.jsx("button",{onClick:()=>g("general"),className:`px-4 py-2 text-sm font-medium ${b==="general"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:"General"}),e.jsx("button",{onClick:()=>g("mappings"),className:`px-4 py-2 text-sm font-medium ${b==="mappings"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:"Attribute Mappings"})]}),b==="general"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Display Name"}),e.jsx(K,{value:M.display_name,onChange:f=>s(k=>({...k,display_name:f.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Default Role"}),e.jsxs("select",{value:M.default_role,onChange:f=>s(k=>({...k,default_role:f.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"auditor",children:"Auditor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:M.jit_provisioning,onChange:f=>s(k=>({...k,jit_provisioning:f.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Enable JIT User Provisioning"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:M.update_on_login,onChange:f=>s(k=>({...k,update_on_login:f.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Update User Profile on Login"})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300",children:"Attribute Mappings"}),e.jsxs(S,{size:"sm",variant:"secondary",onClick:n,children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),"Add"]})]}),e.jsx("div",{className:"space-y-2",children:a.map((f,k)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{placeholder:"IdP Attribute",value:f.source,onChange:C=>{const u=[...a];u[k].source=C.target.value,t(u)},className:"flex-1"}),e.jsx("span",{className:"text-gray-500",children:"->"}),e.jsxs("select",{value:f.target,onChange:C=>{const u=[...a];u[k].target=C.target.value,t(u)},className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white",children:[e.jsx("option",{value:"",children:"Select field"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"username",children:"Username"}),e.jsx("option",{value:"display_name",children:"Display Name"}),e.jsx("option",{value:"first_name",children:"First Name"}),e.jsx("option",{value:"last_name",children:"Last Name"}),e.jsx("option",{value:"groups",children:"Groups"})]}),e.jsx(S,{size:"sm",variant:"danger",onClick:()=>T(k),children:e.jsx(ie,{className:"h-3 w-3"})})]},k))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300",children:"Group to Role Mappings"}),e.jsxs(S,{size:"sm",variant:"secondary",onClick:E,children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),"Add"]})]}),e.jsx("div",{className:"space-y-2",children:c.map((f,k)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{placeholder:"IdP Group",value:f.group,onChange:C=>{const u=[...c];u[k].group=C.target.value,d(u)},className:"flex-1"}),e.jsx("span",{className:"text-gray-500",children:"->"}),e.jsxs("select",{value:f.role,onChange:C=>{const u=[...c];u[k].role=C.target.value,d(u)},className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"auditor",children:"Auditor"}),e.jsx("option",{value:"viewer",children:"Viewer"})]}),e.jsx(S,{size:"sm",variant:"danger",onClick:()=>G(k),children:e.jsx(ie,{className:"h-3 w-3"})})]},k))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(S,{variant:"secondary",onClick:A,children:"Cancel"}),e.jsx(S,{onClick:p,disabled:h,children:h?e.jsx(ee,{size:"sm"}):"Save Changes"})]})]})})},pa=()=>{const[i,A]=r.useState(!0),[w,h]=r.useState(!1),[v,b]=r.useState(!1),[g,M]=r.useState(null),[s,a]=r.useState([]),[t,c]=r.useState(null),[d,p]=r.useState(null),[n,T]=r.useState("anthropic"),[E,G]=r.useState(""),[f,k]=r.useState(""),[C,u]=r.useState(""),[D,I]=r.useState(""),[z,R]=r.useState(""),[L,N]=r.useState(""),[_,x]=r.useState(!1),[F,j]=r.useState(!0);r.useEffect(()=>{Q()},[]);const Q=async()=>{A(!0);try{const[o,$,H]=await Promise.all([He.getConfiguration(),He.getProviders(),He.getModels()]);M(o.data),a($.data),c(H.data),o.data&&(T(o.data.provider),G(o.data.model),I(o.data.ollama_base_url||""),N(o.data.fallback_provider||""),x(o.data.auto_reports),j(o.data.auto_remediation))}catch(o){l.error("Failed to load AI configuration"),console.error(o)}finally{A(!1)}},X=async o=>{var $,H;o.preventDefault(),h(!0),p(null);try{const y={provider:n,model:E||void 0,anthropic_api_key:f||void 0,openai_api_key:C||void 0,ollama_base_url:D||void 0,ollama_model:z||void 0,fallback_provider:L||void 0,auto_reports:_,auto_remediation:F},V=await He.updateConfiguration(y);M(V.data),l.success("AI configuration saved successfully"),k(""),u("")}catch(y){const V=y;l.error(((H=($=V.response)==null?void 0:$.data)==null?void 0:H.error)||"Failed to save configuration")}finally{h(!1)}},O=async()=>{var o,$;b(!0),p(null);try{const H=await He.testConnection();p({success:H.data.success,message:H.data.message,responseTime:H.data.response_time_ms||void 0}),H.data.success?l.success("Connection test successful!"):l.warning("Connection test failed")}catch(H){p({success:!1,message:(($=(o=H.response)==null?void 0:o.data)==null?void 0:$.error)||"Connection test failed"}),l.error("Connection test failed")}finally{b(!1)}},q=o=>{if(!t)return[];switch(o){case"anthropic":return t.anthropic;case"ollama":return t.ollama;case"openai":return t.openai;default:return[]}},Y=o=>s.find($=>$.provider===o);return i?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qs,{className:"w-6 h-6 text-cyan-400"}),e.jsx("h2",{className:"text-xl font-semibold text-white",children:"AI Configuration"})]}),e.jsxs(S,{variant:"secondary",onClick:Q,disabled:i,className:"flex items-center gap-2",children:[e.jsx(Fe,{className:`w-4 h-4 ${i?"animate-spin":""}`}),"Refresh"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["anthropic","ollama","openai"].map(o=>{const $=Y(o),H=n===o;return e.jsxs(B,{className:`cursor-pointer transition-all ${H?"ring-2 ring-cyan-500 bg-gray-800/80":"hover:bg-gray-800/60"}`,onClick:()=>{T(o),G("")},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5 text-cyan-400"}),e.jsx("span",{className:"font-medium text-white capitalize",children:o})]}),$!=null&&$.available?e.jsxs(te,{variant:"success",className:"flex items-center gap-1",children:[e.jsx(de,{className:"w-3 h-3"}),"Available"]}):e.jsxs(te,{variant:"danger",className:"flex items-center gap-1",children:[e.jsx(we,{className:"w-3 h-3"}),"Not Configured"]})]}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-1",children:[e.jsxs("div",{children:["Model: ",($==null?void 0:$.model)||"Not set"]}),e.jsx("div",{className:"flex items-center gap-2",children:($==null?void 0:$.streaming)&&e.jsxs(te,{variant:"primary",className:"text-xs",children:[e.jsx(Ms,{className:"w-3 h-3 mr-1"}),"Streaming"]})})]}),H&&e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-700",children:e.jsx("span",{className:"text-xs text-cyan-400",children:"Selected"})})]},o)})}),e.jsxs(B,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ks,{className:"w-5 h-5 text-cyan-400"}),e.jsx("h3",{className:"text-lg font-medium text-white",children:"Provider Settings"})]}),e.jsxs("form",{onSubmit:X,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Model"}),e.jsxs("select",{value:E,onChange:o=>G(o.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a model"}),q(n).map(o=>e.jsxs("option",{value:o.id,children:[o.name," ",o.description&&`- ${o.description}`]},o.id))]})]}),n==="anthropic"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[e.jsx(Te,{className:"w-4 h-4 inline mr-2"}),"Anthropic API Key",(g==null?void 0:g.has_anthropic_key)&&e.jsx(te,{variant:"success",className:"ml-2 text-xs",children:"Configured"})]}),e.jsx(K,{type:"password",value:f,onChange:o=>k(o.target.value),placeholder:g!=null&&g.has_anthropic_key?"":"sk-ant-...",className:"font-mono"}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Leave blank to keep existing key. Get your key from"," ",e.jsx("a",{href:"https://console.anthropic.com/",target:"_blank",rel:"noopener noreferrer",className:"text-cyan-400 hover:underline",children:"console.anthropic.com"})]})]}),n==="openai"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[e.jsx(Te,{className:"w-4 h-4 inline mr-2"}),"OpenAI API Key",(g==null?void 0:g.has_openai_key)&&e.jsx(te,{variant:"success",className:"ml-2 text-xs",children:"Configured"})]}),e.jsx(K,{type:"password",value:C,onChange:o=>u(o.target.value),placeholder:g!=null&&g.has_openai_key?"":"sk-...",className:"font-mono"}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Leave blank to keep existing key. Get your key from"," ",e.jsx("a",{href:"https://platform.openai.com/",target:"_blank",rel:"noopener noreferrer",className:"text-cyan-400 hover:underline",children:"platform.openai.com"})]})]}),n==="ollama"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[e.jsx(ge,{className:"w-4 h-4 inline mr-2"}),"Ollama Base URL"]}),e.jsx(K,{type:"url",value:D,onChange:o=>I(o.target.value),placeholder:"http://localhost:11434",className:"font-mono"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"The URL where your Ollama server is running (default: http://localhost:11434)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Custom Model Name (Optional)"}),e.jsx(K,{type:"text",value:z,onChange:o=>R(o.target.value),placeholder:"llama3:8b",className:"font-mono"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Override the model selection above with a custom Ollama model name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Fallback Provider (Optional)"}),e.jsxs("select",{value:L,onChange:o=>N(o.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"None"}),["anthropic","ollama","openai"].filter(o=>o!==n).map(o=>e.jsx("option",{value:o,children:o.charAt(0).toUpperCase()+o.slice(1)},o))]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Used when primary provider is unavailable"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"autoReports",checked:_,onChange:o=>x(o.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-cyan-500 focus:ring-cyan-500 focus:ring-offset-gray-800"}),e.jsx("label",{htmlFor:"autoReports",className:"text-sm text-gray-300",children:"Enable AI-generated executive reports"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"autoRemediation",checked:F,onChange:o=>j(o.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-cyan-500 focus:ring-cyan-500 focus:ring-offset-gray-800"}),e.jsx("label",{htmlFor:"autoRemediation",className:"text-sm text-gray-300",children:"Enable AI-assisted remediation guidance"})]})]}),d&&e.jsxs("div",{className:`p-4 rounded-lg ${d.success?"bg-green-900/30 border border-green-700":"bg-red-900/30 border border-red-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.success?e.jsx(de,{className:"w-5 h-5 text-green-400"}):e.jsx(we,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:d.success?"text-green-400":"text-red-400",children:d.success?"Connection Successful":"Connection Failed"})]}),e.jsx("p",{className:"text-sm text-gray-400",children:d.message}),d.responseTime&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Response time: ",d.responseTime,"ms"]})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-700",children:[e.jsxs(S,{type:"submit",disabled:w,className:"flex items-center gap-2",children:[e.jsx(Ee,{className:`w-4 h-4 ${w?"animate-spin":""}`}),w?"Saving...":"Save Configuration"]}),e.jsxs(S,{type:"button",variant:"secondary",onClick:O,disabled:v,className:"flex items-center gap-2",children:[e.jsx(js,{className:`w-4 h-4 ${v?"animate-pulse":""}`}),v?"Testing...":"Test Connection"]})]})]})]}),g&&e.jsxs(B,{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Current Configuration"}),e.jsxs("dl",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-400",children:"Active Provider"}),e.jsx("dd",{className:"text-white font-medium capitalize",children:g.provider})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-400",children:"Active Model"}),e.jsx("dd",{className:"text-white font-medium",children:g.model})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-400",children:"Anthropic Key"}),e.jsx("dd",{children:g.has_anthropic_key?e.jsx(te,{variant:"success",children:"Configured"}):e.jsx(te,{variant:"warning",children:"Not Set"})})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-400",children:"OpenAI Key"}),e.jsx("dd",{children:g.has_openai_key?e.jsx(te,{variant:"success",children:"Configured"}):e.jsx(te,{variant:"warning",children:"Not Set"})})]}),g.ollama_base_url&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("dt",{className:"text-gray-400",children:"Ollama URL"}),e.jsx("dd",{className:"text-white font-mono text-xs",children:g.ollama_base_url})]}),g.updated_at&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("dt",{className:"text-gray-400",children:"Last Updated"}),e.jsx("dd",{className:"text-white",children:new Date(g.updated_at).toLocaleString()})]})]})]})]})},Ta=()=>{const[i,A]=r.useState("profile"),w=[{name:"Account",tabs:[{id:"profile",label:"Profile",icon:e.jsx(ds,{className:"h-4 w-4"}),component:e.jsx(Mt,{})},{id:"security",label:"Security",icon:e.jsx(Xe,{className:"h-4 w-4"}),component:e.jsx(sa,{})},{id:"api-keys",label:"API Keys",icon:e.jsx(Te,{className:"h-4 w-4"}),component:e.jsx(ta,{})}]},{name:"Administration",tabs:[{id:"administration",label:"Users",icon:e.jsx(ue,{className:"h-4 w-4"}),component:e.jsx(Ut,{})},{id:"sso",label:"SSO",icon:e.jsx(Ps,{className:"h-4 w-4"}),component:e.jsx(ma,{})},{id:"ai-configuration",label:"AI Settings",icon:e.jsx(Qs,{className:"h-4 w-4"}),component:e.jsx(pa,{})}]},{name:"Scanning",tabs:[{id:"target-groups",label:"Target Groups",icon:e.jsx(Fs,{className:"h-4 w-4"}),component:e.jsx(Ot,{})},{id:"exclusions",label:"Exclusions",icon:e.jsx(Os,{className:"h-4 w-4"}),component:e.jsx(qt,{})},{id:"scheduled-scans",label:"Scheduled Scans",icon:e.jsx(Ne,{className:"h-4 w-4"}),component:e.jsx($t,{})},{id:"scheduled-reports",label:"Scheduled Reports",icon:e.jsx(ts,{className:"h-4 w-4"}),component:e.jsx(Rt,{})},{id:"templates",label:"Scan Templates",icon:e.jsx(Ye,{className:"h-4 w-4"}),component:e.jsx(Gt,{})},{id:"finding-templates",label:"Finding Templates",icon:e.jsx(Us,{className:"h-4 w-4"}),component:e.jsx(Bt,{})},{id:"vpn",label:"VPN",icon:e.jsx(Vs,{className:"h-4 w-4"}),component:e.jsx(ia,{})},{id:"agents",label:"Agents",icon:e.jsx(ge,{className:"h-4 w-4"}),component:e.jsx(ca,{})},{id:"compare-scans",label:"Compare",icon:e.jsx(It,{className:"h-4 w-4"}),component:e.jsx(Dt,{})}]},{name:"Integrations",tabs:[{id:"notifications",label:"Notifications",icon:e.jsx(Rs,{className:"h-4 w-4"}),component:e.jsx(zt,{})},{id:"webhooks",label:"Webhooks",icon:e.jsx(qs,{className:"h-4 w-4"}),component:e.jsx(oa,{})},{id:"jira-integration",label:"JIRA",icon:e.jsx(Ze,{className:"h-4 w-4"}),component:e.jsx(aa,{})},{id:"servicenow-integration",label:"ServiceNow",icon:e.jsx(zs,{className:"h-4 w-4"}),component:e.jsx(ra,{})},{id:"siem-integration",label:"SIEM",icon:e.jsx(Gs,{className:"h-4 w-4"}),component:e.jsx(la,{})},{id:"cicd",label:"CI/CD",icon:e.jsx(Ws,{className:"h-4 w-4"}),component:e.jsx(da,{})}]}],v=w.flatMap(b=>b.tabs).find(b=>b.id===i);return e.jsx(ht,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ls,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Settings"})]}),e.jsx("p",{className:"text-slate-400",children:"Manage your account, scanning configuration, and integrations"})]}),e.jsx("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:e.jsx("div",{className:"flex flex-wrap gap-6",children:w.map(b=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:b.name}),e.jsx("div",{className:"flex gap-1",children:b.tabs.map(g=>e.jsxs("button",{onClick:()=>A(g.id),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${i===g.id?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[g.icon,g.label]},g.id))})]},b.name))})}),e.jsx("div",{children:v==null?void 0:v.component})]})})};export{Ta as default};
