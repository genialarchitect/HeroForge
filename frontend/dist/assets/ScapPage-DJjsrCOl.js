import{b as te,u as w,d as _,j as e}from"./vendor-state-BjT_zREg.js";import{r as o}from"./vendor-react-5KxtEOLM.js";import{B as i,S as se,b2 as V,bg as re,y as E,ap as $,z as O,F as le,aZ as ne,ac as M,a7 as ce,aO as de,cB as Q,p as z,aa as P,g as B,m as ie,bN as H,bO as X,cC as oe,aX as xe,V as pe,i as me}from"./vendor-ui-CfSMq23b.js";import{N as n}from"./index-CJ_zz9jP.js";import{L as he}from"./Layout-C_2au5Vm.js";import{A as ge}from"./AcasNavigation-Dr6x0v0J.js";import"./vendor-utils-DfRopTPV.js";import"./vendor-markdown-BGP8SuZQ.js";const S={listContent:()=>n.get("/api/scap/content").then(t=>t.data),getContent:t=>n.get(`/api/scap/content/${t}`).then(s=>s.data),uploadContent:t=>n.post("/api/scap/content/upload",t).then(s=>s.data),deleteContent:t=>n.delete(`/api/scap/content/${t}`).then(s=>s.data),getProfiles:t=>n.get(`/api/scap/content/${t}/profiles`).then(s=>s.data),runScan:t=>n.post("/api/scap/execute",t).then(s=>s.data),listExecutions:()=>n.get("/api/scap/executions").then(t=>t.data),getExecution:t=>n.get(`/api/scap/executions/${t}`).then(s=>s.data),downloadArf:t=>n.get(`/api/scap/executions/${t}/arf`,{responseType:"blob"}).then(s=>s.data)},j={getSyncStatus:()=>n.get("/api/scap/stigs/sync/status").then(t=>t.data),triggerSync:()=>n.post("/api/scap/stigs/sync/check").then(t=>t.data),listAvailable:()=>n.get("/api/scap/stigs/available").then(t=>t.data),searchAvailable:t=>n.get(`/api/scap/stigs/search?q=${encodeURIComponent(t)}`).then(s=>s.data),listTracked:()=>n.get("/api/scap/stigs/tracked").then(t=>t.data),addTracked:(t,s=!0)=>n.post("/api/scap/stigs/tracked",{stig_id:t,auto_update:s}).then(l=>l.data),deleteTracked:t=>n.delete(`/api/scap/stigs/tracked/${t}`).then(s=>s.data),updateAutoUpdate:(t,s)=>n.put(`/api/scap/stigs/tracked/${t}/auto-update`,{auto_update:s}).then(l=>l.data),downloadStig:t=>n.post(`/api/scap/stigs/tracked/${t}/download`).then(s=>s.data),getSyncHistory:(t=50,s)=>{const l=new URLSearchParams({limit:t.toString()});return s&&l.append("stig_id",s),n.get(`/api/scap/stigs/sync/history?${l}`).then(d=>d.data)}},ye=({status:t})=>{const s={pending:{bg:"bg-gray-700 text-gray-300",icon:e.jsx(z,{className:"w-3 h-3"})},running:{bg:"bg-blue-900/50 text-blue-400",icon:e.jsx(P,{className:"w-3 h-3 animate-spin"})},completed:{bg:"bg-green-900/50 text-green-400",icon:e.jsx(B,{className:"w-3 h-3"})},failed:{bg:"bg-red-900/50 text-red-400",icon:e.jsx(me,{className:"w-3 h-3"})}},l=s[t]||s.pending;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs ${l.bg}`,children:[l.icon,t.charAt(0).toUpperCase()+t.slice(1)]})},ue=({type:t})=>{const s={xccdf:"bg-purple-900/50 text-purple-400",oval:"bg-cyan-900/50 text-cyan-400",datastream:"bg-amber-900/50 text-amber-400",cpe:"bg-pink-900/50 text-pink-400"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s[t]||"bg-gray-700"}`,children:t.toUpperCase()})},je=({isOpen:t,onClose:s,onSuccess:l})=>{const[d,y]=o.useState(null),[x,u]=o.useState(!1),N=async()=>{var g,h;if(d){u(!0);try{const p=new FormData;p.append("file",d),await S.uploadContent(p),i.success("SCAP content uploaded successfully"),l(),s()}catch(p){i.error(((h=(g=p.response)==null?void 0:g.data)==null?void 0:h.error)||"Upload failed")}finally{u(!1)}}};return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-100 mb-4",children:"Upload SCAP Content"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",accept:".xml,.zip",onChange:g=>{var h;return y(((h=g.target.files)==null?void 0:h[0])||null)},className:"hidden",id:"scap-upload"}),e.jsxs("label",{htmlFor:"scap-upload",className:"cursor-pointer",children:[e.jsx(V,{className:"w-12 h-12 mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-gray-400",children:d?d.name:"Click to select XCCDF, OVAL, or Data Stream file"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-400 hover:text-gray-200",children:"Cancel"}),e.jsx("button",{onClick:N,disabled:!d||x,className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 disabled:opacity-50",children:x?"Uploading...":"Upload"})]})]})]})}):null},Ne=({isOpen:t,onClose:s,content:l,onSuccess:d})=>{const[y,x]=o.useState(""),[u,N]=o.useState(""),[g,h]=o.useState(!1),{data:p}=w({queryKey:["scap-profiles",l==null?void 0:l.id],queryFn:()=>l?S.getProfiles(l.id):Promise.resolve([]),enabled:!!l}),b=async()=>{var m,v;if(!(!l||!y)){h(!0);try{await S.runScan({content_id:l.id,target:y,profile_id:u||void 0}),i.success("SCAP scan started"),d(),s()}catch(C){i.error(((v=(m=C.response)==null?void 0:m.data)==null?void 0:v.error)||"Failed to start scan")}finally{h(!1)}}};return!t||!l?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-100 mb-4",children:"Run SCAP Scan"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Content"}),e.jsx("p",{className:"text-gray-200",children:l.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Target Host"}),e.jsx("input",{type:"text",value:y,onChange:m=>x(m.target.value),placeholder:"192.168.1.100 or hostname",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-gray-200 focus:outline-none focus:border-cyan-500"})]}),p&&p.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Profile"}),e.jsxs("select",{value:u,onChange:m=>N(m.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded text-gray-200 focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"",children:"Default Profile"}),p.map(m=>e.jsx("option",{value:m.id,children:m.title},m.id))]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-400 hover:text-gray-200",children:"Cancel"}),e.jsx("button",{onClick:b,disabled:!y||g,className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 disabled:opacity-50",children:g?"Starting...":"Start Scan"})]})]})]})})},be=({isOpen:t,onClose:s,onSuccess:l})=>{var C;const[d,y]=o.useState(""),[x,u]=o.useState(null),[N,g]=o.useState(!0),[h,p]=o.useState(!1),{data:b,isLoading:m}=w({queryKey:["available-stigs",d],queryFn:()=>d?j.searchAvailable(d):j.listAvailable(),enabled:t}),v=async()=>{var c,A;if(x){p(!0);try{await j.addTracked(x.stig_id,N),i.success(`Added ${x.name} to tracked STIGs`),l(),s()}catch(k){i.error(((A=(c=k.response)==null?void 0:c.data)==null?void 0:A.error)||"Failed to add STIG")}finally{p(!1)}}};return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[80vh] flex flex-col",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-100 mb-4",children:"Add STIG to Track"}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:d,onChange:c=>y(c.target.value),placeholder:"Search available STIGs...",className:"w-full pl-10 pr-4 py-2 bg-gray-700 border border-gray-600 rounded text-gray-200 focus:outline-none focus:border-cyan-500"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto mb-4 border border-gray-700 rounded",children:m?e.jsx("div",{className:"p-4 text-center text-gray-400",children:"Loading available STIGs..."}):(C=b==null?void 0:b.stigs)!=null&&C.length?e.jsx("div",{className:"divide-y divide-gray-700",children:b.stigs.map(c=>e.jsx("div",{onClick:()=>u(c),className:`p-3 cursor-pointer hover:bg-gray-700 ${(x==null?void 0:x.stig_id)===c.stig_id?"bg-gray-700 border-l-2 border-cyan-500":""}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-200 font-medium",children:c.name}),e.jsxs("div",{className:"text-sm text-gray-400",children:[c.target_product," • V",c.version,"R",c.release]})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded ${c.is_benchmark?"bg-purple-900/50 text-purple-400":"bg-gray-700 text-gray-400"}`,children:c.category})]})},c.stig_id))}):e.jsx("div",{className:"p-4 text-center text-gray-400",children:"No STIGs found"})}),x&&e.jsxs("div",{className:"flex items-center gap-3 mb-4 p-3 bg-gray-700 rounded",children:[e.jsx("button",{onClick:()=>g(!N),className:"text-gray-400 hover:text-cyan-400",children:N?e.jsx(H,{className:"w-6 h-6 text-cyan-400"}):e.jsx(X,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-200 text-sm",children:"Auto-update enabled"}),e.jsx("div",{className:"text-xs text-gray-400",children:"Automatically download updates when available"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-400 hover:text-gray-200",children:"Cancel"}),e.jsx("button",{onClick:v,disabled:!x||h,className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 disabled:opacity-50",children:h?"Adding...":"Add STIG"})]})]})}):null},Te=()=>{var R,G,K;const t=te(),[s,l]=o.useState("content"),[d,y]=o.useState(!1),[x,u]=o.useState(!1),[N,g]=o.useState(!1),[h,p]=o.useState(null),[b,m]=o.useState(""),[v,C]=o.useState(""),{data:c=[],isLoading:A}=w({queryKey:["scap-content"],queryFn:S.listContent}),{data:k=[],isLoading:Z}=w({queryKey:["scap-executions"],queryFn:S.listExecutions,refetchInterval:1e4}),J=_({mutationFn:S.deleteContent,onSuccess:()=>{t.invalidateQueries({queryKey:["scap-content"]}),i.success("Content deleted")},onError:()=>i.error("Failed to delete content")}),{data:r}=w({queryKey:["stig-sync-status"],queryFn:j.getSyncStatus,refetchInterval:5e3}),{data:T,isLoading:W}=w({queryKey:["tracked-stigs"],queryFn:j.listTracked}),{data:F}=w({queryKey:["stig-sync-history"],queryFn:()=>j.getSyncHistory(20)}),L=_({mutationFn:j.triggerSync,onSuccess:()=>{i.success("STIG sync check started"),t.invalidateQueries({queryKey:["stig-sync-status"]})},onError:()=>i.error("Failed to start sync check")}),Y=_({mutationFn:j.deleteTracked,onSuccess:()=>{t.invalidateQueries({queryKey:["tracked-stigs"]}),i.success("STIG removed from tracking")},onError:()=>i.error("Failed to remove STIG")}),ee=_({mutationFn:({id:a,autoUpdate:f})=>j.updateAutoUpdate(a,f),onSuccess:()=>{t.invalidateQueries({queryKey:["tracked-stigs"]})},onError:()=>i.error("Failed to update setting")}),q=_({mutationFn:j.downloadStig,onSuccess:()=>{t.invalidateQueries({queryKey:["tracked-stigs"]}),t.invalidateQueries({queryKey:["scap-content"]}),i.success("STIG downloaded and imported")},onError:()=>i.error("Failed to download STIG")}),D=c.filter(a=>{const f=a.name.toLowerCase().includes(b.toLowerCase()),U=!v||a.content_type===v;return f&&U}),ae=async a=>{try{const f=await S.downloadArf(a),U=window.URL.createObjectURL(f),I=document.createElement("a");I.href=U,I.download=`scap_result_${a}.xml`,I.click(),window.URL.revokeObjectURL(U)}catch{i.error("Failed to download ARF")}};return e.jsx(he,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(ge,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(se,{className:"w-8 h-8 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"SCAP Compliance Scanner"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Security Content Automation Protocol assessment and reporting"})]})]}),e.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500",children:[e.jsx(V,{className:"w-4 h-4"}),"Upload Content"]})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>l("content"),className:`px-4 py-2 border-b-2 transition-colors ${s==="content"?"border-cyan-500 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Content Library (",c.length,")"]})}),e.jsx("button",{onClick:()=>l("executions"),className:`px-4 py-2 border-b-2 transition-colors ${s==="executions"?"border-cyan-500 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),"Scan History (",k.length,")"]})}),e.jsx("button",{onClick:()=>l("stig-repo"),className:`px-4 py-2 border-b-2 transition-colors ${s==="stig-repo"?"border-cyan-500 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"STIG Repository",r!=null&&r.updates_available?e.jsx("span",{className:"bg-amber-600 text-white text-xs px-1.5 py-0.5 rounded-full",children:r.updates_available}):null]})})]})}),s==="content"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:b,onChange:a=>m(a.target.value),placeholder:"Search content...",className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded text-gray-200 focus:outline-none focus:border-cyan-500"})]}),e.jsxs("select",{value:v,onChange:a=>C(a.target.value),className:"px-4 py-2 bg-gray-800 border border-gray-700 rounded text-gray-200 focus:outline-none focus:border-cyan-500",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"xccdf",children:"XCCDF"}),e.jsx("option",{value:"oval",children:"OVAL"}),e.jsx("option",{value:"datastream",children:"Data Stream"}),e.jsx("option",{value:"cpe",children:"CPE"})]})]}),A?e.jsx("div",{className:"text-center py-12 text-gray-400",children:"Loading..."}):D.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(le,{className:"w-12 h-12 mx-auto mb-4 text-gray-600"}),e.jsx("p",{className:"text-gray-400",children:"No SCAP content found"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload XCCDF, OVAL, or SCAP Data Stream files to get started"})]}):e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm text-gray-400",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm text-gray-400",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm text-gray-400",children:"Version"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm text-gray-400",children:"Rules"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm text-gray-400",children:"Uploaded"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:D.map(a=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-gray-200",children:a.name}),a.description&&e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:a.description})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ue,{type:a.content_type})}),e.jsx("td",{className:"px-4 py-3 text-gray-400",children:a.version||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-400",children:a.rule_count||a.definition_count||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(a.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>{p(a),u(!0)},className:"p-2 text-gray-400 hover:text-cyan-400 rounded",title:"Run Scan",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>J.mutate(a.id),className:"p-2 text-gray-400 hover:text-red-400 rounded",title:"Delete",children:e.jsx(M,{className:"w-4 h-4"})})]})})]},a.id))})]})})]}),s==="executions"&&e.jsx("div",{className:"space-y-4",children:Z?e.jsx("div",{className:"text-center py-12 text-gray-400",children:"Loading..."}):k.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"w-12 h-12 mx-auto mb-4 text-gray-600"}),e.jsx("p",{className:"text-gray-400",children:"No scan history"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Run a SCAP scan to see results here"})]}):e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm text-gray-400",children:"Target"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm text-gray-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm text-gray-400",children:"Pass"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm text-gray-400",children:"Fail"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm text-gray-400",children:"Started"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:k.map(a=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 text-gray-200",children:a.target}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ye,{status:a.status})}),e.jsx("td",{className:"px-4 py-3 text-green-400",children:a.pass_count??"-"}),e.jsx("td",{className:"px-4 py-3 text-red-400",children:a.fail_count??"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(a.started_at).toLocaleString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>ae(a.id),className:"p-2 text-gray-400 hover:text-cyan-400 rounded",title:"Download ARF Report",disabled:a.status!=="completed",children:e.jsx(ce,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-cyan-400 rounded",title:"View Details",children:e.jsx(de,{className:"w-4 h-4"})})]})})]},a.id))})]})})}),s==="stig-repo"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 mb-1",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Tracked STIGs"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-100",children:(r==null?void 0:r.total_tracked)??0})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 mb-1",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Updates Available"})]}),e.jsx("div",{className:`text-2xl font-bold ${r!=null&&r.updates_available?"text-amber-400":"text-gray-100"}`,children:(r==null?void 0:r.updates_available)??0})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 mb-1",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Last Sync"})]}),e.jsx("div",{className:"text-lg text-gray-100",children:r!=null&&r.last_sync_at?new Date(r.last_sync_at).toLocaleString():"Never"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 mb-1",children:[r!=null&&r.in_progress?e.jsx(P,{className:"w-4 h-4 animate-spin"}):e.jsx(B,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Status"})]}),e.jsx("div",{className:"text-lg text-gray-100",children:r!=null&&r.in_progress?r.current_operation||"Syncing...":(r==null?void 0:r.last_sync_result)||"Idle"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:()=>L.mutate(),disabled:(r==null?void 0:r.in_progress)||L.isPending,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 text-gray-200 rounded hover:bg-gray-600 disabled:opacity-50",children:[e.jsx(P,{className:`w-4 h-4 ${r!=null&&r.in_progress||L.isPending?"animate-spin":""}`}),"Check for Updates"]})}),e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500",children:[e.jsx(ie,{className:"w-4 h-4"}),"Add STIG"]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 bg-gray-900 border-b border-gray-700",children:e.jsx("h3",{className:"text-gray-200 font-medium",children:"Tracked STIGs"})}),W?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading..."}):(R=T==null?void 0:T.stigs)!=null&&R.length?e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm text-gray-400",children:"STIG Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm text-gray-400",children:"Current Version"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm text-gray-400",children:"Available"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm text-gray-400",children:"Last Checked"}),e.jsx("th",{className:"px-4 py-3 text-center text-sm text-gray-400",children:"Auto-Update"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:T.stigs.map(a=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-gray-200",children:a.stig_name}),e.jsx("div",{className:"text-xs text-gray-500",children:a.stig_id})]}),e.jsxs("td",{className:"px-4 py-3 text-gray-400",children:["V",a.current_version,"R",a.current_release]}),e.jsx("td",{className:"px-4 py-3",children:a.has_update?e.jsxs("span",{className:"inline-flex items-center gap-1 text-amber-400",children:[e.jsx(Q,{className:"w-4 h-4"}),"V",a.available_version,"R",a.available_release]}):e.jsx("span",{className:"text-green-400 text-sm",children:"Up to date"})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:a.last_checked_at?new Date(a.last_checked_at).toLocaleDateString():"-"}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("button",{onClick:()=>ee.mutate({id:a.id,autoUpdate:!a.auto_update}),className:"text-gray-400 hover:text-cyan-400",children:a.auto_update?e.jsx(H,{className:"w-6 h-6 text-cyan-400"}):e.jsx(X,{className:"w-6 h-6"})})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.has_update&&e.jsx("button",{onClick:()=>q.mutate(a.id),disabled:q.isPending,className:"p-2 text-gray-400 hover:text-cyan-400 rounded",title:"Download Update",children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Y.mutate(a.id),className:"p-2 text-gray-400 hover:text-red-400 rounded",title:"Remove from tracking",children:e.jsx(M,{className:"w-4 h-4"})})]})})]},a.id))})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx($,{className:"w-12 h-12 mx-auto mb-4 text-gray-600"}),e.jsx("p",{className:"text-gray-400",children:"No STIGs being tracked"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Add STIGs from the DISA repository to track updates automatically"})]})]}),(G=F==null?void 0:F.history)!=null&&G.length?e.jsxs("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 bg-gray-900 border-b border-gray-700 flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-gray-400"}),e.jsx("h3",{className:"text-gray-200 font-medium",children:"Recent Sync History"})]}),e.jsx("div",{className:"divide-y divide-gray-700",children:F.history.slice(0,10).map(a=>e.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-200",children:a.stig_id}),e.jsx("div",{className:"text-sm text-gray-400",children:a.old_version!=null?`V${a.old_version}R${a.old_release} → V${a.new_version}R${a.new_release}`:`Initial: V${a.new_version}R${a.new_release}`})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-sm ${a.status==="Completed"?"text-green-400":a.status==="Failed"?"text-red-400":"text-gray-400"}`,children:a.status}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(a.synced_at).toLocaleString()})]})]},a.id))})]}):null,(K=r==null?void 0:r.last_errors)!=null&&K.length?e.jsxs("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-400 mb-2",children:[e.jsx(pe,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Sync Errors"})]}),e.jsx("ul",{className:"space-y-1 text-sm text-red-300",children:r.last_errors.map((a,f)=>e.jsxs("li",{children:["• ",a]},f))})]}):null]}),e.jsx(je,{isOpen:d,onClose:()=>y(!1),onSuccess:()=>t.invalidateQueries({queryKey:["scap-content"]})}),e.jsx(Ne,{isOpen:x,onClose:()=>{u(!1),p(null)},content:h,onSuccess:()=>t.invalidateQueries({queryKey:["scap-executions"]})}),e.jsx(be,{isOpen:N,onClose:()=>g(!1),onSuccess:()=>t.invalidateQueries({queryKey:["tracked-stigs"]})})]})})};export{Te as default};
