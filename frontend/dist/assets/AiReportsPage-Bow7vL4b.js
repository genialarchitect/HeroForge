import{u as H,d as c,j as e}from"./vendor-state-GQ86PG8z.js";import{r as t}from"./vendor-react-5KxtEOLM.js";import{aq as l,b as Q}from"./index-DXyI7EZp.js";import"./vendor-ui-B4zQTbMA.js";import"./vendor-utils-DfRopTPV.js";const Y=()=>{const[d,A]=t.useState(""),[x,C]=t.useState("executive"),[a,_]=t.useState(null),[u,T]=t.useState(""),[p,E]=t.useState(""),[r,M]=t.useState(null),[h,F]=t.useState(""),[P,G]=t.useState(""),[i,I]=t.useState(null),[k,D]=t.useState("VulnerabilityManagement"),[g,q]=t.useState(""),[R,z]=t.useState(""),[m,L]=t.useState(null),[j,O]=t.useState(""),[b,V]=t.useState(""),[o,K]=t.useState(null),{data:y}=H({queryKey:["scans"],queryFn:async()=>(await Q.getAll()).data}),v=c({mutationFn:async()=>(x==="executive"?await l.generateExecutiveReport(d):await l.generateTechnicalReport(d)).data,onSuccess:s=>{_(s)}}),f=c({mutationFn:async()=>(await l.planScan({targets:u.split(`
`).filter(n=>n.trim()),objectives:p.split(`
`).filter(n=>n.trim())})).data,onSuccess:s=>{M(s)}}),N=c({mutationFn:async()=>(await l.analyzeExploit({code:h,context:P||void 0})).data,onSuccess:s=>{I(s)}}),S=c({mutationFn:async()=>(await l.generatePolicy({policy_type:k,organization:g,compliance_frameworks:R.split(",").map(n=>n.trim()).filter(n=>n)})).data,onSuccess:s=>{L(s)}}),w=c({mutationFn:async()=>(await l.getRemediationGuidance({vulnerability:j,context:b})).data,onSuccess:s=>{K(s)}});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"AI-Powered Security Operations"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Use LLM capabilities for automated report generation, scan planning, and security analysis"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"üìä Generate AI Reports"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Scan"}),e.jsxs("select",{value:d,onChange:s=>A(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"Choose a scan..."}),y==null?void 0:y.map(s=>e.jsxs("option",{value:s.id,children:[s.name||s.targets," - ",new Date(s.created_at).toLocaleDateString()]},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Report Type"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"executive",checked:x==="executive",onChange:s=>C(s.target.value),className:"mr-2"}),"Executive Summary (C-level)"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"technical",checked:x==="technical",onChange:s=>C(s.target.value),className:"mr-2"}),"Technical Report (Engineers)"]})]})]}),e.jsx("button",{onClick:()=>v.mutate(),disabled:!d||v.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300",children:v.isPending?"Generating...":"Generate Report"}),a&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Generated Report"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Risk Score:"})," ",a.risk_score]}),e.jsx("p",{children:e.jsx("strong",{children:"Summary:"})}),e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:a.summary||a.technical_summary}),a.key_findings&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx("strong",{children:"Key Findings:"})}),e.jsx("ul",{className:"list-disc pl-5 text-sm",children:a.key_findings.map((s,n)=>e.jsx("li",{children:s},n))})]}),a.recommendations&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx("strong",{children:"Recommendations:"})}),e.jsx("ul",{className:"list-disc pl-5 text-sm",children:a.recommendations.map((s,n)=>e.jsx("li",{children:s},n))})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"üéØ Intelligent Scan Planning"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Targets (one per line)"}),e.jsx("textarea",{value:u,onChange:s=>T(s.target.value),placeholder:`app.example.com
192.168.1.0/24
api.company.com`,className:"w-full px-3 py-2 border border-gray-300 rounded-md h-24 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Objectives (one per line)"}),e.jsx("textarea",{value:p,onChange:s=>E(s.target.value),placeholder:`Web vulnerability assessment
Network mapping
SSL/TLS analysis`,className:"w-full px-3 py-2 border border-gray-300 rounded-md h-24 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsx("button",{onClick:()=>f.mutate(),disabled:!u||!p||f.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300",children:f.isPending?"Planning...":"Generate Scan Plan"}),r&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Recommended Scan Plan"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Estimated Duration:"})," ",r.estimated_duration]}),e.jsx("p",{className:"mt-2",children:e.jsx("strong",{children:"Recommended Scans:"})}),e.jsx("ol",{className:"list-decimal pl-5 text-sm space-y-1",children:r.recommended_scans.map((s,n)=>e.jsx("li",{children:s},n))}),r.risk_factors.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mt-2",children:e.jsx("strong",{children:"Risk Factors:"})}),e.jsx("ul",{className:"list-disc pl-5 text-sm",children:r.risk_factors.map((s,n)=>e.jsx("li",{className:"text-red-600",children:s},n))})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"üîç Exploit Code Analysis"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exploit Code"}),e.jsx("textarea",{value:h,onChange:s=>F(s.target.value),placeholder:"Paste exploit code here...",className:"w-full px-3 py-2 border border-gray-300 rounded-md h-32 font-mono text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Context (optional)"}),e.jsx("input",{type:"text",value:P,onChange:s=>G(s.target.value),placeholder:"e.g., WordPress plugin, PHP file upload vulnerability",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsx("button",{onClick:()=>N.mutate(),disabled:!h||N.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300",children:N.isPending?"Analyzing...":"Analyze Exploit"}),i&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Analysis Results"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Vulnerability:"})," ",i.vulnerability_id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Impact:"})," ",e.jsx("span",{className:"text-red-600",children:i.impact_assessment})]}),e.jsx("p",{children:e.jsx("strong",{children:"Attack Flow:"})}),e.jsx("p",{className:"whitespace-pre-wrap bg-white p-2 rounded",children:i.attack_flow}),e.jsx("p",{children:e.jsx("strong",{children:"MITRE ATT&CK Techniques:"})}),e.jsx("ul",{className:"list-disc pl-5",children:i.mitre_techniques.map((s,n)=>e.jsx("li",{children:s},n))}),e.jsx("p",{children:e.jsx("strong",{children:"Mitigations:"})}),e.jsx("ul",{className:"list-disc pl-5",children:i.mitigations.map((s,n)=>e.jsx("li",{children:s},n))})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"üìã Security Policy Generator"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Policy Type"}),e.jsxs("select",{value:k,onChange:s=>D(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"AccessControl",children:"Access Control"}),e.jsx("option",{value:"DataProtection",children:"Data Protection"}),e.jsx("option",{value:"IncidentResponse",children:"Incident Response"}),e.jsx("option",{value:"ChangeManagement",children:"Change Management"}),e.jsx("option",{value:"AssetManagement",children:"Asset Management"}),e.jsx("option",{value:"VulnerabilityManagement",children:"Vulnerability Management"}),e.jsx("option",{value:"NetworkSecurity",children:"Network Security"}),e.jsx("option",{value:"CloudSecurity",children:"Cloud Security"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization Name"}),e.jsx("input",{type:"text",value:g,onChange:s=>q(s.target.value),placeholder:"Acme Corporation",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Compliance Frameworks (comma-separated)"}),e.jsx("input",{type:"text",value:R,onChange:s=>z(s.target.value),placeholder:"PCI-DSS, SOC 2, NIST CSF, HIPAA",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsx("button",{onClick:()=>S.mutate(),disabled:!g||S.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300",children:S.isPending?"Generating...":"Generate Policy"}),m&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[e.jsx("h3",{className:"font-semibold mb-2",children:m.title}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Review Schedule: ",m.review_schedule]}),e.jsx("div",{className:"bg-white p-4 rounded text-sm whitespace-pre-wrap max-h-96 overflow-y-auto",children:m.content})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"üîß Remediation Guidance"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vulnerability Description"}),e.jsx("input",{type:"text",value:j,onChange:s=>O(s.target.value),placeholder:"e.g., SQL Injection in login form",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Context"}),e.jsx("textarea",{value:b,onChange:s=>V(s.target.value),placeholder:"Additional context: affected system, technology stack, environment details...",className:"w-full px-3 py-2 border border-gray-300 rounded-md h-24 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsx("button",{onClick:()=>w.mutate(),disabled:!j||!b||w.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300",children:w.isPending?"Generating...":"Get Guidance"}),o&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Remediation Plan"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"‚ö° Immediate Actions:"}),e.jsx("ul",{className:"list-disc pl-5 mt-1",children:o.immediate_actions.map((s,n)=>e.jsx("li",{children:s},n))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"üìù Detailed Steps:"}),e.jsx("ol",{className:"list-decimal pl-5 mt-1",children:o.detailed_steps.map((s,n)=>e.jsx("li",{children:s},n))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"üõ†Ô∏è Tools Required:"}),e.jsx("ul",{className:"list-disc pl-5 mt-1",children:o.tools_required.map((s,n)=>e.jsx("li",{children:s},n))})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"‚è±Ô∏è Estimated Time:"})," ",o.estimated_time]})]})]})]})]})]})};export{Y as default};
