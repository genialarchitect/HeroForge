import{j as e}from"./vendor-state-DdX3IZQk.js";import{r as a}from"./vendor-react-Da1CiaFS.js";import{B as f,V as b,ac as B,aC as z,aQ as O,m as _,K as w,A as H,G as R,cg as U,ch as F,ci as G,a as $,I as M}from"./vendor-ui-Cfxa9o3E.js";import{d as K}from"./index-C3P2Oms8.js";import"./vendor-charts-ed8SE4MW.js";const h={getDevices:async()=>[{id:"1",name:"Front Door Camera",device_type:"camera",vendor:"Hikvision",model:"DS-2CD2143G2-I",firmware_version:"5.7.1",ip_address:"192.168.1.100",mac_address:"AA:BB:CC:DD:EE:01",protocols:["rtsp","http"],open_ports:[80,554,8e3],default_creds_status:"vulnerable",risk_score:85,last_seen:new Date().toISOString()},{id:"2",name:"Living Room Thermostat",device_type:"thermostat",vendor:"Nest",model:"Learning Thermostat",firmware_version:"6.2",ip_address:"192.168.1.101",mac_address:"AA:BB:CC:DD:EE:02",protocols:["http","mqtt"],open_ports:[80,443],default_creds_status:"changed",risk_score:25,last_seen:new Date().toISOString()},{id:"3",name:"Smart Speaker",device_type:"speaker",vendor:"Amazon",model:"Echo Dot",ip_address:"192.168.1.102",mac_address:"AA:BB:CC:DD:EE:03",protocols:["http","mqtt"],open_ports:[443],default_creds_status:"changed",risk_score:20,last_seen:new Date().toISOString()},{id:"4",name:"Smart Hub",device_type:"hub",vendor:"Samsung",model:"SmartThings Hub",ip_address:"192.168.1.103",mac_address:"AA:BB:CC:DD:EE:04",protocols:["http","zigbee","zwave"],open_ports:[80,443,8080],default_creds_status:"unknown",risk_score:45,last_seen:new Date().toISOString()},{id:"5",name:"IP Camera 2",device_type:"camera",vendor:"Dahua",model:"IPC-HDW2431T",ip_address:"192.168.1.104",mac_address:"AA:BB:CC:DD:EE:05",protocols:["rtsp","http","onvif"],open_ports:[80,554,37777],default_creds_status:"vulnerable",risk_score:90,last_seen:new Date().toISOString()},{id:"6",name:"Motion Sensor",device_type:"sensor",vendor:"Philips",model:"Hue Motion",ip_address:"192.168.1.105",mac_address:"AA:BB:CC:DD:EE:06",protocols:["zigbee"],open_ports:[],default_creds_status:"changed",risk_score:15,last_seen:new Date().toISOString()}],getScans:async()=>[{id:"1",name:"Network Discovery",scan_type:"discovery",target_range:"192.168.1.0/24",status:"completed",devices_found:12,vulnerabilities_found:4,started_at:new Date().toISOString(),completed_at:new Date().toISOString()},{id:"2",name:"Credential Check",scan_type:"credential",target_range:"192.168.1.0/24",status:"running",devices_found:6,vulnerabilities_found:2,started_at:new Date().toISOString()}],searchCredentials:async r=>[{device_type:"camera",vendor:"Hikvision",protocol:"http",username:"admin",password:"admin"},{device_type:"camera",vendor:"Hikvision",protocol:"http",username:"admin",password:"12345"},{device_type:"camera",vendor:"Dahua",protocol:"http",username:"admin",password:"admin"},{device_type:"camera",vendor:"Axis",protocol:"http",username:"root",password:"pass"},{device_type:"router",vendor:"TP-Link",protocol:"http",username:"admin",password:"admin"},{device_type:"router",vendor:"Netgear",protocol:"http",username:"admin",password:"password"},{device_type:"thermostat",vendor:"Generic",protocol:"http",username:"admin",password:"1234"},{device_type:"hub",vendor:"Generic",protocol:"http",username:"admin",password:"admin"}].filter(l=>{var i;return l.device_type.toLowerCase().includes(r.toLowerCase())||((i=l.vendor)==null?void 0:i.toLowerCase().includes(r.toLowerCase()))}),startScan:async r=>{await new Promise(n=>setTimeout(n,500))}},X=()=>{const[r,n]=a.useState("devices"),[l,i]=a.useState([]),[S,C]=a.useState([]),[p,D]=a.useState([]),[k,g]=a.useState(!0),[c,T]=a.useState(""),[o,I]=a.useState(""),[t,x]=a.useState(null);a.useEffect(()=>{A()},[]),a.useEffect(()=>{r==="credentials"&&o&&E()},[o]);const A=async()=>{try{g(!0);const[s,d]=await Promise.all([h.getDevices(),h.getScans()]);i(s),C(d)}catch{f.error("Failed to load IoT data")}finally{g(!1)}},E=async()=>{try{const s=await h.searchCredentials(o);D(s)}catch{f.error("Failed to search credentials")}},u=s=>{switch(s){case"camera":return e.jsx(G,{className:"h-5 w-5"});case"thermostat":return e.jsx(F,{className:"h-5 w-5"});case"speaker":return e.jsx(U,{className:"h-5 w-5"});case"hub":return e.jsx(R,{className:"h-5 w-5"});case"sensor":return e.jsx(H,{className:"h-5 w-5"});default:return e.jsx(b,{className:"h-5 w-5"})}},y=s=>{switch(s){case"vulnerable":return e.jsx(M,{className:"h-5 w-5 text-red-400"});case"changed":return e.jsx($,{className:"h-5 w-5 text-green-400"});default:return e.jsx(w,{className:"h-5 w-5 text-yellow-400"})}},v=s=>{switch(s){case"vulnerable":return"Default Credentials";case"changed":return"Secured";default:return"Unknown"}},L=s=>s>=70?"text-red-400":s>=40?"text-yellow-400":"text-green-400",P=l.filter(s=>{var d,j,N;return((d=s.name)==null?void 0:d.toLowerCase().includes(c.toLowerCase()))||((j=s.vendor)==null?void 0:j.toLowerCase().includes(c.toLowerCase()))||((N=s.ip_address)==null?void 0:N.includes(c))||s.device_type.toLowerCase().includes(c.toLowerCase())}),m=l.filter(s=>s.default_creds_status==="vulnerable");return e.jsx(K,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{className:"h-8 w-8 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"IoT Security"}),e.jsx("p",{className:"text-gray-400",children:"Discover and assess IoT device security"})]})]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-500",children:[e.jsx(B,{className:"h-4 w-4"}),"Start IoT Scan"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:l.length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"IoT Devices"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:m.length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Default Creds"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:l.filter(s=>s.risk_score>=70).length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"High Risk"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-cyan-400",children:new Set(l.flatMap(s=>s.protocols)).size}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Protocols"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:l.filter(s=>s.default_creds_status==="changed").length}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Secured"})]})]}),m.length>0&&e.jsx("div",{className:"bg-red-900/30 border border-red-700 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{className:"h-6 w-6 text-red-400"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-red-400 font-medium",children:[m.length," device(s) using default credentials"]}),e.jsx("p",{className:"text-red-300/70 text-sm mt-1",children:"These devices are vulnerable to unauthorized access. Change their default passwords immediately."})]})]})}),e.jsx("div",{className:"flex gap-1 mb-6 border-b border-gray-700",children:["devices","scans","credentials"].map(s=>e.jsx("button",{onClick:()=>n(s),className:`px-4 py-2 font-medium capitalize ${r===s?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:s==="credentials"?"Default Credentials":s},s))}),k?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(O,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs(e.Fragment,{children:[r==="devices"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-4 mb-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search devices...",value:c,onChange:s=>T(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white"})]})}),e.jsx("div",{className:"grid gap-4",children:P.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 cursor-pointer hover:bg-gray-750",onClick:()=>x(s),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-gray-700 rounded-lg text-cyan-400",children:u(s.device_type)}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-white font-medium flex items-center gap-2",children:[s.name||"Unknown Device",y(s.default_creds_status)]}),e.jsxs("div",{className:"text-gray-400 text-sm",children:[s.vendor," ",s.model," • ",s.ip_address]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"flex gap-1",children:s.protocols.slice(0,3).map(d=>e.jsx("span",{className:"px-2 py-1 text-xs bg-gray-700 text-gray-300 rounded",children:d.toUpperCase()},d))}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-lg font-bold ${L(s.risk_score)}`,children:s.risk_score}),e.jsx("div",{className:"text-gray-400 text-xs",children:"Risk Score"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.default_creds_status==="vulnerable"?"bg-red-600 text-white":s.default_creds_status==="changed"?"bg-green-600 text-white":"bg-yellow-600 text-white"}`,children:v(s.default_creds_status)}),e.jsxs("span",{className:"text-gray-400",children:["Ports: ",s.open_ports.length>0?s.open_ports.join(", "):"None"]}),e.jsx("span",{className:"text-gray-400 capitalize",children:s.device_type})]})]},s.id))})]}),r==="scans"&&e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Target"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Results"})]})}),e.jsx("tbody",{children:S.map(s=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-white",children:s.name}),e.jsx("td",{className:"px-4 py-3 text-gray-300 capitalize",children:s.scan_type}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("code",{className:"text-gray-300 bg-gray-700 px-2 py-1 rounded text-sm",children:s.target_range})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.status==="completed"?"bg-green-600 text-white":s.status==="running"?"bg-cyan-600 text-white":"bg-gray-600 text-gray-300"}`,children:s.status})}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[e.jsxs("span",{className:"text-white",children:[s.devices_found," devices"]}),s.vulnerabilities_found>0&&e.jsxs("span",{className:"text-red-400 ml-2",children:[s.vulnerabilities_found," vulns"]})]})]},s.id))})]})}),r==="credentials"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-4 mb-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by device type or vendor...",value:o,onChange:s=>I(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white"})]})}),p.length>0?e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Device Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Vendor"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Protocol"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Username"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Password"})]})}),e.jsx("tbody",{children:p.map((s,d)=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-white capitalize",children:s.device_type}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.vendor||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-300 uppercase",children:s.protocol}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("code",{className:"text-cyan-400 bg-gray-700 px-2 py-1 rounded",children:s.username})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("code",{className:"text-yellow-400 bg-gray-700 px-2 py-1 rounded",children:s.password})})]},d))})]})}):e.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 text-center",children:[e.jsx(w,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-white text-lg font-medium",children:"Search Default Credentials"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Enter a device type or vendor name to search our database of known default credentials"})]})]})]}),t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>x(null),children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-700 rounded-lg text-cyan-400",children:u(t.device_type)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:t.name||"Unknown Device"}),e.jsxs("p",{className:"text-gray-400",children:[t.vendor," ",t.model]})]})]}),e.jsx("button",{onClick:()=>x(null),className:"text-gray-400 hover:text-white text-2xl",children:"×"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"IP Address"}),e.jsx("div",{className:"text-white",children:t.ip_address})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"MAC Address"}),e.jsx("div",{className:"text-white",children:t.mac_address})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Device Type"}),e.jsx("div",{className:"text-white capitalize",children:t.device_type})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Firmware"}),e.jsx("div",{className:"text-white",children:t.firmware_version||"Unknown"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-2",children:"Credential Status"}),e.jsxs("div",{className:`flex items-center gap-2 p-3 rounded ${t.default_creds_status==="vulnerable"?"bg-red-900/30 border border-red-700":t.default_creds_status==="changed"?"bg-green-900/30 border border-green-700":"bg-yellow-900/30 border border-yellow-700"}`,children:[y(t.default_creds_status),e.jsx("span",{className:t.default_creds_status==="vulnerable"?"text-red-400":t.default_creds_status==="changed"?"text-green-400":"text-yellow-400",children:v(t.default_creds_status)})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-2",children:"Open Ports"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.open_ports.length>0?t.open_ports.map(s=>e.jsx("span",{className:"px-3 py-1 bg-gray-700 text-white rounded",children:s},s)):e.jsx("span",{className:"text-gray-500",children:"No open ports detected"})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-400 text-sm mb-2",children:"Protocols"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.protocols.map(s=>e.jsx("span",{className:"px-3 py-1 bg-cyan-600 text-white rounded",children:s.toUpperCase()},s))})]})]})})]})})};export{X as default};
