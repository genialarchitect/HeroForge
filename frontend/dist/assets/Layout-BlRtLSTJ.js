import{c as L,j as e,u as ye}from"./vendor-state-BXNPjUwt.js";import{$,a0 as we,a1 as je,a2 as R,B as ke,N as te,a3 as Ne,a4 as ae}from"./index-t7VPhhr8.js";import{r as b,u as Se,L as N,j as O}from"./vendor-react-5KxtEOLM.js";import{l as D,bS as se,bT as re,aj as Ce,m as W,f as z,d as Oe,s as ne,bU as Ie,bV as oe,bW as le,S as C,U as ie,bX as Ae,aF as Te,G as U,Z as G,y as H,af as S,b7 as Me,x as ze,au as Ee,N as K,bm as Le,bY as $e,bZ as Re,v as I,K as De,al as _e,b2 as ce,R as Z,W as Fe,b_ as Be,aM as Pe,V,b$ as We,bh as Ue,c0 as Ge,c1 as He,bd as A,bA as Ke,h as de,c2 as Ze,c3 as Ve,a4 as Q,aI as q,bM as Qe,c4 as qe,bz as Je,c5 as Ye,w as he,aK as J,aJ as T,aT as Xe,n as et,aG as Y,ac as X,F as E,c6 as tt,c7 as at,c8 as st,ap as rt,aL as nt,e as ot,bR as lt,o as it,ao as ct,ba as me,_ as dt,bx as ht,L as mt,aV as xt,c9 as ee,an as ut,av as gt,X as bt}from"./vendor-ui-DGSzT-Xm.js";import{M as pt}from"./vendor-markdown-RN55YrVy.js";const _=L()($(a=>({sidebarCollapsed:!1,sidebarOpen:!1,expandedSections:["featured","recon"],toggleSidebar:()=>a(s=>({sidebarCollapsed:!s.sidebarCollapsed})),setSidebarCollapsed:s=>a({sidebarCollapsed:s}),setSidebarOpen:s=>a({sidebarOpen:s}),toggleSection:s=>a(t=>({expandedSections:t.expandedSections.includes(s)?t.expandedSections.filter(r=>r!==s):[...t.expandedSections,s]})),setExpandedSections:s=>a({expandedSections:s})}),{name:"heroforge-ui-storage",partialize:a=>({sidebarCollapsed:a.sidebarCollapsed,expandedSections:a.expandedSections})}));function ft(a){const[s,t]=b.useState(()=>typeof window<"u"?window.matchMedia(a).matches:!1);return b.useEffect(()=>{if(typeof window>"u")return;const r=window.matchMedia(a),n=o=>t(o.matches);return t(r.matches),r.addEventListener("change",n),()=>r.removeEventListener("change",n)},[a]),s}function F(){return ft("(max-width: 1023px)")}const M=[{value:"light",label:"Light",icon:e.jsx(se,{className:"h-4 w-4"})},{value:"dark",label:"Dark",icon:e.jsx(re,{className:"h-4 w-4"})},{value:"system",label:"System",icon:e.jsx(Ce,{className:"h-4 w-4"})}],vt=({className:a=""})=>{const{theme:s,setTheme:t,resolvedTheme:r}=we(),[n,o]=b.useState(!1),d=b.useRef(null),h=M.find(l=>l.value===s)||M[2];b.useEffect(()=>{const l=u=>{d.current&&!d.current.contains(u.target)&&o(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]),b.useEffect(()=>{const l=u=>{u.key==="Escape"&&o(!1)};if(n)return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)},[n]);const c=l=>{t(l),o(!1)},m=()=>s==="system"?r==="dark"?e.jsx(re,{className:"h-4 w-4"}):e.jsx(se,{className:"h-4 w-4"}):h.icon;return e.jsxs("div",{className:`relative ${a}`,ref:d,children:[e.jsxs("button",{type:"button",onClick:()=>o(!n),className:`flex items-center gap-2 px-3 py-2 text-sm rounded-lg transition-colors
          text-slate-400 hover:text-slate-100 dark:text-slate-400 dark:hover:text-slate-100
          hover:bg-slate-700 dark:hover:bg-dark-hover
          bg-transparent`,"aria-haspopup":"listbox","aria-expanded":n,"aria-label":"Select theme",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[m(),e.jsx("span",{className:"hidden sm:inline",children:h.label})]}),e.jsx(D,{className:`h-3 w-3 transition-transform ${n?"rotate-180":""}`})]}),n&&e.jsx("div",{className:`absolute right-0 mt-2 w-36 rounded-lg shadow-lg z-50
            bg-white dark:bg-dark-surface
            border border-slate-200 dark:border-dark-border
            animate-fade-in`,role:"listbox","aria-label":"Theme options",children:e.jsx("div",{className:"py-1",children:M.map(l=>e.jsxs("button",{type:"button",role:"option","aria-selected":s===l.value,onClick:()=>c(l.value),className:`w-full flex items-center gap-3 px-4 py-2 text-sm transition-colors
                  ${s===l.value?"bg-primary/10 text-primary dark:text-primary-light":"text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-dark-hover"}`,children:[l.icon,e.jsx("span",{children:l.label}),s===l.value&&e.jsx("span",{className:"ml-auto text-primary dark:text-primary-light",children:e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},l.value))})})]})},yt=L()($((a,s)=>({currentOrg:null,currentOrgId:null,organizations:[],isLoading:!1,setCurrentOrg:t=>{a({currentOrg:t,currentOrgId:(t==null?void 0:t.id)??null})},setCurrentOrgId:t=>{const n=s().organizations.find(o=>o.id===t)??null;a({currentOrgId:t,currentOrg:n})},setOrganizations:t=>{a({organizations:t});const r=s().currentOrg;!r&&t.length>0&&a({currentOrg:t[0],currentOrgId:t[0].id}),r&&!t.find(n=>n.id===r.id)&&(t.length>0?a({currentOrg:t[0],currentOrgId:t[0].id}):a({currentOrg:null,currentOrgId:null}))},setLoading:t=>a({isLoading:t}),clearOrgState:()=>{a({currentOrg:null,currentOrgId:null,organizations:[],isLoading:!1})},isOrgOwner:()=>{var t;return((t=s().currentOrg)==null?void 0:t.role)==="owner"},isOrgAdmin:()=>{var r;const t=(r=s().currentOrg)==null?void 0:r.role;return t==="owner"||t==="admin"},isOrgMember:()=>{var t;return((t=s().currentOrg)==null?void 0:t.role)==="member"},getCurrentOrgRole:()=>{var t;return((t=s().currentOrg)==null?void 0:t.role)??null},getOrgById:t=>s().organizations.find(r=>r.id===t),hasMultipleOrgs:()=>s().organizations.length>1}),{name:"org-storage",partialize:a=>({currentOrgId:a.currentOrgId})})),wt=()=>{const[a,s]=b.useState(!1),t=b.useRef(null),r=Se(),{currentOrg:n,organizations:o,setCurrentOrg:d,setOrganizations:h}=yt(),{isLoading:c}=ye({queryKey:["organizations"],queryFn:async()=>{const i=await je.list();return h(i.data),i.data},staleTime:300*1e3});b.useEffect(()=>{const i=y=>{t.current&&!t.current.contains(y.target)&&s(!1)};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]);const m=i=>{d(i),s(!1)},l=()=>{s(!1),r("/organization/new")},u=()=>{s(!1),n&&r(`/organization/${n.id}`)},g=i=>{switch(i){case"owner":return"bg-amber-500/20 text-amber-400 border-amber-500/30";case"admin":return"bg-cyan-500/20 text-cyan-400 border-cyan-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return!c&&o.length===0?e.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover transition-colors",children:[e.jsx(W,{className:"h-4 w-4"}),"Create Organization"]}):e.jsxs("div",{className:"relative",ref:t,children:[e.jsxs("button",{onClick:()=>s(!a),disabled:c,className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover transition-colors border border-light-border dark:border-dark-border",children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx("span",{className:"max-w-[120px] truncate",children:c?"Loading...":(n==null?void 0:n.name)||"Select Organization"}),e.jsx(D,{className:`h-3 w-3 transition-transform ${a?"rotate-180":""}`})]}),a&&e.jsxs("div",{className:"absolute left-0 mt-1 w-64 bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border rounded-lg shadow-lg z-50 overflow-hidden",children:[e.jsx("div",{className:"max-h-64 overflow-y-auto py-1",children:o.map(i=>e.jsxs("button",{onClick:()=>m(i),className:`w-full flex items-center justify-between px-3 py-2 text-sm transition-colors ${(n==null?void 0:n.id)===i.id?"bg-primary/10 text-primary":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(z,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:i.name})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded border ${g(i.role)}`,children:i.role}),(n==null?void 0:n.id)===i.id&&e.jsx(Oe,{className:"h-4 w-4 text-primary"})]})]},i.id))}),e.jsx("div",{className:"border-t border-light-border dark:border-dark-border"}),e.jsxs("div",{className:"py-1",children:[n&&e.jsxs("button",{onClick:u,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover transition-colors",children:[e.jsx(ne,{className:"h-4 w-4"}),"Manage Organization"]}),e.jsxs("button",{onClick:l,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-light-hover dark:hover:bg-dark-hover transition-colors",children:[e.jsx(W,{className:"h-4 w-4"}),"Create Organization"]})]})]})]})},jt=()=>{const{user:a,logout:s}=R(),{sidebarCollapsed:t,toggleSidebar:r,setSidebarOpen:n}=_(),o=F(),d=()=>{o?n(!0):r()};return e.jsx("header",{className:"bg-light-surface dark:bg-dark-surface border-b border-light-border dark:border-dark-border shadow-sm sticky top-0 z-30",children:e.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-14",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[a&&e.jsx("button",{onClick:d,className:"p-2 rounded-lg hover:bg-light-hover dark:hover:bg-dark-hover transition-colors","aria-label":o?"Open menu":t?"Expand sidebar":"Collapse sidebar",children:o?e.jsx(Ie,{className:"h-5 w-5 text-slate-600 dark:text-slate-400"}):t?e.jsx(oe,{className:"h-5 w-5 text-slate-600 dark:text-slate-400"}):e.jsx(le,{className:"h-5 w-5 text-slate-600 dark:text-slate-400"})}),(!a||o)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex items-center justify-center w-9 h-9 bg-primary rounded-lg",children:e.jsx(C,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"HeroForge"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 hidden sm:block",children:"Network Triage Dashboard"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden sm:block",children:e.jsx(wt,{})}),e.jsxs("div",{className:"hidden md:flex items-center space-x-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"h-4 w-4 text-slate-500 dark:text-slate-400"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:a.username})]}),a.roles&&a.roles.length>0&&e.jsx("div",{className:"flex gap-1",children:a.roles.slice(0,2).map(h=>e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 text-xs font-medium rounded border bg-slate-500/20 text-slate-700 dark:text-slate-300 border-slate-500/30 capitalize",children:h},h))})]})]}),e.jsx(vt,{}),a&&e.jsxs(ke,{variant:"ghost",size:"sm",onClick:s,className:"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline ml-2",children:"Logout"})]})]})]})})})},kt=()=>e.jsx("footer",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Â© 2025 Genial Architect Cybersecurity Research Associates. All rights reserved."})]}),e.jsxs("nav",{className:"flex items-center gap-6 text-sm",children:[e.jsx(N,{to:"/legal/terms",className:"text-gray-500 dark:text-gray-400 hover:text-primary transition-colors",children:"Terms"}),e.jsx(N,{to:"/legal/privacy",className:"text-gray-500 dark:text-gray-400 hover:text-primary transition-colors",children:"Privacy"}),e.jsx(N,{to:"/legal/acceptable-use",className:"text-gray-500 dark:text-gray-400 hover:text-primary transition-colors",children:"Acceptable Use"}),e.jsx(N,{to:"/legal/cookies",className:"text-gray-500 dark:text-gray-400 hover:text-primary transition-colors",children:"Cookies"})]})]})})}),Nt={recon:["red_team"],red:["red_team"],blue:["blue_team"],purple:["purple_team","red_team","blue_team"],yellow:["yellow_team"],orange:["orange_team"],green:["green_team"],white:["white_team"]},xe={red:{active:"bg-red-500/10 text-red-600 dark:text-red-400",hover:"hover:bg-red-500/5 hover:text-red-600 dark:hover:text-red-400",border:"border-l-red-500",dot:"bg-red-500",bg:"bg-red-500/5"},blue:{active:"bg-blue-500/10 text-blue-600 dark:text-blue-400",hover:"hover:bg-blue-500/5 hover:text-blue-600 dark:hover:text-blue-400",border:"border-l-blue-500",dot:"bg-blue-500",bg:"bg-blue-500/5"},purple:{active:"bg-purple-500/10 text-purple-600 dark:text-purple-400",hover:"hover:bg-purple-500/5 hover:text-purple-600 dark:hover:text-purple-400",border:"border-l-purple-500",dot:"bg-purple-500",bg:"bg-purple-500/5"},yellow:{active:"bg-yellow-500/10 text-yellow-600 dark:text-yellow-400",hover:"hover:bg-yellow-500/5 hover:text-yellow-600 dark:hover:text-yellow-400",border:"border-l-yellow-500",dot:"bg-yellow-500",bg:"bg-yellow-500/5"},orange:{active:"bg-orange-500/10 text-orange-600 dark:text-orange-400",hover:"hover:bg-orange-500/5 hover:text-orange-600 dark:hover:text-orange-400",border:"border-l-orange-500",dot:"bg-orange-500",bg:"bg-orange-500/5"},green:{active:"bg-green-500/10 text-green-600 dark:text-green-400",hover:"hover:bg-green-500/5 hover:text-green-600 dark:hover:text-green-400",border:"border-l-green-500",dot:"bg-green-500",bg:"bg-green-500/5"},white:{active:"bg-slate-500/10 text-slate-700 dark:text-slate-300",hover:"hover:bg-slate-500/5 hover:text-slate-700 dark:hover:text-slate-300",border:"border-l-slate-400",dot:"bg-slate-400",bg:"bg-slate-500/5"},cyan:{active:"bg-cyan-500/10 text-cyan-600 dark:text-cyan-400",hover:"hover:bg-cyan-500/5 hover:text-cyan-600 dark:hover:text-cyan-400",border:"border-l-cyan-500",dot:"bg-cyan-500",bg:"bg-cyan-500/5"},default:{active:"bg-primary/10 text-primary",hover:"hover:bg-light-hover dark:hover:bg-dark-hover hover:text-slate-900 dark:hover:text-white",border:"border-l-primary",dot:"bg-primary",bg:"bg-primary/5"}},B=({item:a,collapsed:s,teamColor:t="default"})=>{const r=O(),n=r.pathname===a.to||a.to!=="/dashboard"&&r.pathname.startsWith(a.to)||a.to.includes("?")&&r.pathname+r.search===a.to,o=xe[t],d=a.icon,h=e.jsxs(N,{to:a.to,className:`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors text-sm ${n?`${o.active} font-medium`:`text-slate-600 dark:text-slate-400 ${o.hover}`}`,children:[e.jsx(d,{className:"h-4 w-4 flex-shrink-0"}),!s&&e.jsx("span",{className:"truncate",children:a.label})]});return s?e.jsx(ae,{content:a.label,position:"right",children:h}):h},St=({id:a,label:s,icon:t,items:r,teamColor:n,collapsed:o,expanded:d,onToggle:h})=>{const c=xe[n],m=O(),l=r.some(g=>m.pathname===g.to||m.pathname.startsWith(g.to)),u=e.jsxs("button",{onClick:h,className:`w-full flex items-center gap-2 px-3 py-2 rounded-lg transition-colors text-sm ${l?`${c.active} font-medium`:`text-slate-600 dark:text-slate-400 ${c.hover}`}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full flex-shrink-0 ${c.dot}`}),!o&&e.jsxs(e.Fragment,{children:[e.jsx(t,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"flex-1 text-left truncate",children:s}),d?e.jsx(D,{className:"h-3 w-3 flex-shrink-0"}):e.jsx(dt,{className:"h-3 w-3 flex-shrink-0"})]})]});return e.jsxs("div",{className:"mb-1",children:[o?e.jsx(ae,{content:s,position:"right",children:u}):u,d&&!o&&e.jsx("div",{className:`ml-3 pl-3 border-l-2 ${c.border} mt-1 space-y-0.5`,children:r.map(g=>e.jsx(B,{item:g,collapsed:!1,teamColor:n},g.to))})]})},Ct=({collapsed:a})=>{const s=[{to:"/dashboard?tab=topology",icon:S,label:"Network Topology"},{to:"/attack-paths",icon:ce,label:"Attack Paths"},{to:"/ai-security",icon:ct,label:"AI Security"},{to:"/llm-testing",icon:me,label:"LLM Testing"},{to:"/ai-reports",icon:E,label:"AI Reports"},{to:"/ml-models",icon:he,label:"ML Models"}];return e.jsxs("div",{className:`mb-4 rounded-lg bg-gradient-to-br from-purple-500/10 via-cyan-500/10 to-blue-500/10 border border-purple-500/20 ${a?"p-2":"p-3"}`,children:[!a&&e.jsxs("div",{className:"flex items-center gap-2 mb-2 px-1",children:[e.jsx(it,{className:"h-4 w-4 text-yellow-500"}),e.jsx("span",{className:"text-xs font-semibold text-slate-700 dark:text-slate-300 uppercase tracking-wide",children:"AI & Visualization"})]}),e.jsx("div",{className:"space-y-0.5",children:s.map(t=>e.jsx(B,{item:t,collapsed:a,teamColor:"purple"},t.to))})]})},Ot=()=>{const{user:a}=R(),s=O(),t=F(),{sidebarCollapsed:r,sidebarOpen:n,expandedSections:o,toggleSidebar:d,setSidebarOpen:h,toggleSection:c}=_(),m=te(x=>{var v;return((v=x.user)==null?void 0:v.roles)??[]}),l=m.includes("admin"),u=m.find(x=>["red_team","blue_team","yellow_team","white_team","orange_team","green_team","purple_team"].includes(x))??null,g=x=>x.some(v=>m.includes(v));if(b.useEffect(()=>{t&&h(!1)},[s.pathname,t,h]),b.useEffect(()=>{u?document.documentElement.style.setProperty("--team-accent",Ne[u]):document.documentElement.style.setProperty("--team-accent","#06b6d4")},[u]),!a)return null;const i=[{to:"/dashboard",icon:Te,label:"Scans"},{to:"/discovery",icon:U,label:"Asset Discovery"},{to:"/nuclei",icon:G,label:"Nuclei Scanner"},{to:"/webapp-scan",icon:H,label:"Web App Scan"},{to:"/dns-tools",icon:S,label:"DNS Tools"},{to:"/compare",icon:Me,label:"Scan Compare"},{to:"/assets",icon:ze,label:"Asset Inventory"}],y=[{to:"/exploit-database",icon:Ee,label:"Exploit Database"},{to:"/poc-repository",icon:K,label:"PoC Repository"},{to:"/research-workspaces",icon:Le,label:"Research Workspaces"},{to:"/binary-analysis",icon:$e,label:"Binary Analysis"},{to:"/malware-analysis",icon:Re,label:"Malware Analysis"},{to:"/fuzzing",icon:G,label:"Fuzzing"},{to:"/exploitation",icon:I,label:"Exploitation"},{to:"/cracking",icon:De,label:"Password Cracking"},{to:"/privesc",icon:_e,label:"Privilege Escalation"},{to:"/bloodhound",icon:ce,label:"BloodHound AD"},{to:"/phishing",icon:I,label:"Phishing Campaigns"},{to:"/c2",icon:Z,label:"C2 Management"},{to:"/wireless",icon:Fe,label:"Wireless Attacks"},{to:"/attack-simulation",icon:Be,label:"Attack Simulation"}],w=[{to:"/siem",icon:V,label:"SIEM"},{to:"/ueba",icon:We,label:"UEBA"},{to:"/traffic-analysis",icon:S,label:"Traffic Analysis"},{to:"/netflow-analysis",icon:V,label:"NetFlow Analysis"},{to:"/dns-analytics",icon:U,label:"DNS Analytics"},{to:"/ot-ics-security",icon:Ue,label:"OT/ICS Security"},{to:"/iot-security",icon:Ge,label:"IoT Security"},{to:"/yara",icon:He,label:"YARA Rules"},{to:"/sigma-rules",icon:A,label:"Sigma Rules"},{to:"/forensics",icon:Ke,label:"Forensics"},{to:"/incident-response",icon:de,label:"Incident Response"},{to:"/detection-engineering",icon:Ze,label:"Detection Engineering"},{to:"/threat-hunting",icon:Ve,label:"Threat Hunting"},{to:"/threat-intel",icon:Q,label:"Threat Intel"},{to:"/agents",icon:Z,label:"Scan Agents"},{to:"/attack-surface",icon:I,label:"Attack Surface"}],f=[{to:"/purple-team",icon:q,label:"Purple Team Dashboard"}],j=[{to:"/yellow-team",icon:A,label:"DevSecOps Dashboard"},{to:"/sast",icon:K,label:"SAST Scanner"},{to:"/sca",icon:Qe,label:"SCA (Dependencies)"},{to:"/cicd-integration",icon:qe,label:"CI/CD Integration"},{to:"/iac-security",icon:A,label:"IaC Security"},{to:"/container-security",icon:Je,label:"Container Security"},{to:"/api-security",icon:Ye,label:"API Security"}],p=[{to:"/orange-team",icon:J,label:"Security Awareness"}],ge=[{to:"/green-team",icon:T,label:"SOAR Dashboard"},{to:"/soar-playbooks",icon:Xe,label:"Playbooks"},{to:"/workflows",icon:T,label:"Workflows"},{to:"/remediation",icon:et,label:"Remediation"}],be=[{to:"/white-team",icon:Y,label:"GRC Dashboard"},{to:"/compliance",icon:Y,label:"Compliance"},{to:"/client-compliance",icon:X,label:"Client Checklists"},{to:"/evidence",icon:E,label:"Evidence"},{to:"/manual-assessments",icon:X,label:"Assessments"},{to:"/ato-map",icon:tt,label:"ATO Map"},{to:"/cato-network-map",icon:S,label:"cATO Network Map"},{to:"/methodology",icon:at,label:"Methodology"},{to:"/finding-templates",icon:st,label:"Finding Templates"},{to:"/executive-dashboard",icon:rt,label:"Executive Dashboard"},{to:"/reports",icon:E,label:"Reports"}],pe=[{to:"/crm",icon:z,label:"CRM Dashboard"},{to:"/admin",icon:ot,label:"Admin"},{to:"/settings",icon:ne,label:"Settings"},{to:"/plugins",icon:lt,label:"Plugins"}],fe=[{id:"recon",label:"Recon",icon:H,items:i,teamColor:"cyan"},{id:"red",label:"Red Team",icon:Pe,items:y,teamColor:"red"},{id:"blue",label:"Blue Team",icon:Q,items:w,teamColor:"blue"},{id:"purple",label:"Purple Team",icon:q,items:f,teamColor:"purple"},{id:"yellow",label:"Yellow Team",icon:he,items:j,teamColor:"yellow"},{id:"orange",label:"Orange Team",icon:J,items:p,teamColor:"orange"},{id:"green",label:"Green Team",icon:T,items:ge,teamColor:"green"},{id:"white",label:"White Team",icon:nt,items:be,teamColor:"white"}].filter(x=>{if(l)return!0;const v=Nt[x.id];return!v||v.length===0?!0:g(v)}),P=pe.filter(x=>x.to==="/admin"?l:x.to==="/crm"?l||g(["white_team"]):!0),ve=r?"w-16":"w-64";return e.jsxs(e.Fragment,{children:[t&&n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 transition-opacity",onClick:()=>h(!1)}),e.jsxs("aside",{className:`
          fixed top-0 left-0 h-full z-50
          bg-light-surface dark:bg-dark-surface
          border-r border-light-border dark:border-dark-border
          transition-all duration-300 ease-in-out
          flex flex-col
          ${t?`w-64 ${n?"translate-x-0":"-translate-x-full"}`:ve}
        `,role:"navigation","aria-label":"Main navigation",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-light-border dark:border-dark-border",children:[!r&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-primary rounded-lg",children:e.jsx(C,{className:"h-5 w-5 text-white"})}),e.jsx("span",{className:"font-bold text-slate-900 dark:text-white",children:"HeroForge"})]}),r&&e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-primary rounded-lg mx-auto",children:e.jsx(C,{className:"h-5 w-5 text-white"})}),!t&&e.jsx("button",{onClick:d,className:`p-1.5 rounded-lg hover:bg-light-hover dark:hover:bg-dark-hover transition-colors ${r?"mx-auto mt-2":""}`,"aria-label":r?"Expand sidebar":"Collapse sidebar",children:r?e.jsx(oe,{className:"h-4 w-4 text-slate-600 dark:text-slate-400"}):e.jsx(le,{className:"h-4 w-4 text-slate-600 dark:text-slate-400"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3",children:[e.jsx(Ct,{collapsed:r}),e.jsx("div",{className:"space-y-1",children:fe.map(x=>e.jsx(St,{id:x.id,label:x.label,icon:x.icon,items:x.items,teamColor:x.teamColor,collapsed:r,expanded:o.includes(x.id),onToggle:()=>c(x.id)},x.id))}),e.jsx("div",{className:"my-4 border-t border-light-border dark:border-dark-border"}),!r&&P.length>0&&e.jsx("div",{className:"mb-2 px-3",children:e.jsx("span",{className:"text-xs font-semibold text-slate-500 dark:text-slate-500 uppercase tracking-wide",children:"Quick Access"})}),e.jsx("div",{className:"space-y-0.5",children:P.map(x=>e.jsx(B,{item:x,collapsed:r,teamColor:"default"},x.to))})]})]})]})},ue=L()($((a,s)=>({isOpen:!1,isMinimized:!1,isLoading:!1,messages:[],conversationId:null,error:null,setOpen:t=>a({isOpen:t}),setMinimized:t=>a({isMinimized:t}),toggle:()=>{const t=s();t.isOpen&&!t.isMinimized?a({isMinimized:!0}):a({isOpen:!0,isMinimized:!1})},addMessage:t=>a(r=>({messages:[...r.messages,t],error:null})),appendToLastMessage:t=>a(r=>{const n=[...r.messages],o=n.length-1;return o>=0&&n[o].role==="assistant"&&(n[o]={...n[o],content:n[o].content+t}),{messages:n}}),finalizeLastMessage:()=>a(t=>{const r=[...t.messages],n=r.length-1;return n>=0&&r[n].isStreaming&&(r[n]={...r[n],isStreaming:!1}),{messages:r}}),setLoading:t=>a({isLoading:t}),setError:t=>a({error:t}),clearMessages:()=>a({messages:[],conversationId:null,error:null}),setConversationId:t=>a({conversationId:t}),startNewConversation:()=>a({messages:[],conversationId:null,error:null,isLoading:!1})}),{name:"heroforge-chat",partialize:a=>({messages:a.messages.slice(-50),conversationId:a.conversationId})})),k="/api",It={sendMessage:async(a,s,t,r,n,o,d)=>{var c;const h=localStorage.getItem("token");if(!h){d("Not authenticated");return}try{const m=await fetch(`${k}/chat`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify({message:a,conversation_id:s,page_context:t})});if(!m.ok){const i=await m.json().catch(()=>({}));throw new Error(i.message||`Chat request failed: ${m.status}`)}const l=(c=m.body)==null?void 0:c.getReader(),u=new TextDecoder;if(!l)throw new Error("Response body is not readable");let g="";for(;;){const{done:i,value:y}=await l.read();if(i)break;g+=u.decode(y,{stream:!0});const w=g.split(`
`);g=w.pop()||"";for(const f of w)if(f.startsWith("data: ")){const j=f.slice(6).trim();if(!j)continue;try{const p=JSON.parse(j);if(p.type==="content"&&p.content)r(p.content),p.conversation_id&&n(p.conversation_id);else if(p.type==="done"){p.conversation_id&&n(p.conversation_id),o(p.tokens_used||0);return}else if(p.type==="error"&&p.error){d(p.error);return}}catch{console.debug("Non-JSON SSE data:",j)}}}o(0)}catch(m){d(m instanceof Error?m.message:"Failed to send message")}},getConversations:async()=>{const a=localStorage.getItem("token"),s=await fetch(`${k}/chat/conversations`,{headers:{Authorization:`Bearer ${a}`}});if(!s.ok)throw new Error("Failed to fetch conversations");return(await s.json()).conversations},getMessages:async a=>{const s=localStorage.getItem("token"),t=await fetch(`${k}/chat/conversations/${a}/messages`,{headers:{Authorization:`Bearer ${s}`}});if(!t.ok)throw new Error("Failed to fetch messages");return(await t.json()).messages},deleteConversation:async a=>{const s=localStorage.getItem("token");if(!(await fetch(`${k}/chat/conversations/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok)throw new Error("Failed to delete conversation")},createConversation:async()=>{const a=localStorage.getItem("token"),s=await fetch(`${k}/chat/conversations`,{method:"POST",headers:{Authorization:`Bearer ${a}`}});if(!s.ok)throw new Error("Failed to create conversation");return(await s.json()).id}},At=({message:a})=>{const s=a.role==="user";return e.jsxs("div",{className:`flex gap-3 ${s?"flex-row-reverse":""}`,children:[e.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${s?"bg-cyan-600":"bg-gradient-to-br from-purple-600 to-indigo-600"}`,children:s?e.jsx(ie,{className:"w-4 h-4 text-white"}):e.jsx(ht,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:`flex-1 max-w-[80%] ${s?"text-right":"text-left"}`,children:[e.jsx("div",{className:`inline-block p-3 rounded-lg ${s?"bg-cyan-600 text-white rounded-tr-sm":"bg-gray-700 text-gray-100 rounded-tl-sm"}`,children:s?e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:a.content}):e.jsxs("div",{className:"text-sm prose prose-sm prose-invert max-w-none",children:[e.jsx(pt,{components:{a:({href:t,children:r})=>e.jsx("a",{href:t,className:"text-cyan-400 hover:text-cyan-300 underline",onClick:n=>{t!=null&&t.startsWith("/")&&(n.preventDefault(),window.location.href=t)},children:r}),code:({className:t,children:r})=>!t?e.jsx("code",{className:"bg-gray-800 px-1 py-0.5 rounded text-cyan-300 text-xs",children:r}):e.jsx("code",{className:"block bg-gray-800 p-2 rounded text-xs overflow-x-auto",children:r}),ul:({children:t})=>e.jsx("ul",{className:"list-disc list-inside space-y-1 my-2",children:t}),ol:({children:t})=>e.jsx("ol",{className:"list-decimal list-inside space-y-1 my-2",children:t}),p:({children:t})=>e.jsx("p",{className:"mb-2 last:mb-0",children:t})},children:a.content}),a.isStreaming&&e.jsx("span",{className:"inline-block w-2 h-4 bg-cyan-400 animate-pulse ml-1"})]})}),e.jsx("div",{className:`text-xs text-gray-500 mt-1 ${s?"text-right":"text-left"}`,children:new Date(a.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},Tt=({onSend:a,isLoading:s,disabled:t})=>{const[r,n]=b.useState(""),o=b.useRef(null);b.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=`${Math.min(o.current.scrollHeight,120)}px`)},[r]);const d=c=>{c.preventDefault(),r.trim()&&!s&&!t&&(a(r.trim()),n(""),o.current&&(o.current.style.height="auto"))},h=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),d(c))};return e.jsxs("form",{onSubmit:d,className:"flex items-end gap-2",children:[e.jsx("div",{className:"flex-1 relative",children:e.jsx("textarea",{ref:o,value:r,onChange:c=>n(c.target.value),onKeyDown:h,placeholder:"Ask anything about your security data...",disabled:s||t,className:`w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg
                     text-white placeholder-gray-400 resize-none
                     focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent
                     disabled:opacity-50 disabled:cursor-not-allowed
                     text-sm min-h-[40px] max-h-[120px]`,rows:1})}),e.jsx("button",{type:"submit",disabled:!r.trim()||s||t,className:`flex-shrink-0 p-2 bg-cyan-600 hover:bg-cyan-700
                   disabled:bg-gray-600 disabled:cursor-not-allowed
                   rounded-lg transition-colors`,children:s?e.jsx(mt,{className:"w-5 h-5 text-white animate-spin"}):e.jsx(xt,{className:"w-5 h-5 text-white"})})]})},Mt=()=>{const a=O(),s=b.useRef(null),{messages:t,conversationId:r,isLoading:n,error:o,addMessage:d,appendToLastMessage:h,finalizeLastMessage:c,setLoading:m,setError:l,setConversationId:u}=ue();b.useEffect(()=>{var i;(i=s.current)==null||i.scrollIntoView({behavior:"smooth"})},[t]);const g=async i=>{const y={id:crypto.randomUUID(),role:"user",content:i,timestamp:new Date().toISOString()};d(y);const w={id:crypto.randomUUID(),role:"assistant",content:"",timestamp:new Date().toISOString(),isStreaming:!0};d(w),m(!0),l(null);try{await It.sendMessage(i,r,a.pathname,f=>{h(f)},f=>{u(f)},()=>{c(),m(!1)},f=>{l(f),c(),m(!1)})}catch(f){l(f instanceof Error?f.message:"Failed to send message"),m(!1)}};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-purple-600 to-indigo-600 flex items-center justify-center mb-4",children:e.jsx(me,{className:"w-6 h-6 text-white"})}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Zeus"}),e.jsx("p",{className:"text-sm text-gray-400 max-w-xs",children:"I have access to your security data and can help you understand vulnerabilities, plan scans, and navigate the platform."}),e.jsxs("div",{className:"mt-4 space-y-2 text-xs text-gray-500",children:[e.jsx("p",{children:"Try asking:"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:'"What are my most critical vulnerabilities?"'}),e.jsx("li",{children:'"How do I start a new scan?"'}),e.jsx("li",{children:'"Explain CVE-2024-1234 to me"'})]})]})]}):e.jsx(e.Fragment,{children:t.map(i=>e.jsx(At,{message:i},i.id))}),e.jsx("div",{ref:s})]}),o&&e.jsxs("div",{className:"mx-4 mb-2 p-2 bg-red-900/50 border border-red-700 rounded-lg flex items-center gap-2 text-sm text-red-300",children:[e.jsx(de,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:o})]}),e.jsx("div",{className:"p-4 border-t border-gray-700",children:e.jsx(Tt,{onSend:g,isLoading:n})})]})},zt=()=>{const{isOpen:a,isMinimized:s,messages:t,setOpen:r,setMinimized:n,startNewConversation:o}=ue();if(!te(l=>l.isAuthenticated))return null;const h=()=>{r(!1),n(!1)},c=()=>{n(!0)},m=()=>{o()};return!a||s?e.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:e.jsxs("button",{onClick:()=>{r(!0),n(!1)},className:`group relative w-14 h-14 bg-gradient-to-br from-purple-600 to-indigo-600
                     hover:from-purple-500 hover:to-indigo-500
                     text-white rounded-full shadow-lg
                     flex items-center justify-center transition-all duration-200
                     hover:scale-105 hover:shadow-xl`,"aria-label":"Open Zeus AI Assistant",children:[e.jsx(ee,{className:"w-6 h-6"}),t.length>0&&e.jsx("span",{className:`absolute -top-1 -right-1 w-5 h-5 bg-cyan-500 rounded-full
                           text-xs font-medium flex items-center justify-center`,children:t.length>99?"99+":t.length}),e.jsx("span",{className:`absolute bottom-full right-0 mb-2 px-2 py-1 bg-gray-800 text-white
                         text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity
                         whitespace-nowrap pointer-events-none`,children:"Zeus"})]})}):e.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:e.jsxs("div",{className:`w-96 h-[500px] bg-gray-800 border border-gray-700
                      rounded-lg shadow-2xl flex flex-col overflow-hidden
                      animate-in slide-in-from-bottom-4 duration-200`,children:[e.jsxs("div",{className:`flex items-center justify-between px-4 py-3
                        bg-gradient-to-r from-purple-600 to-indigo-600`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5 text-white"}),e.jsx("span",{className:"font-medium text-white",children:"Zeus"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:m,className:`p-1.5 text-white/80 hover:text-white hover:bg-white/10 rounded
                         transition-colors`,title:"New conversation",children:e.jsx(ut,{className:"w-4 h-4"})}),e.jsx("button",{onClick:c,className:`p-1.5 text-white/80 hover:text-white hover:bg-white/10 rounded
                         transition-colors`,title:"Minimize",children:e.jsx(gt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:h,className:`p-1.5 text-white/80 hover:text-white hover:bg-white/10 rounded
                         transition-colors`,title:"Close",children:e.jsx(bt,{className:"w-4 h-4"})})]})]}),e.jsx(Mt,{})]})})},Ft=({children:a})=>{const{user:s}=R(),{sidebarCollapsed:t}=_(),r=F(),n=s&&!r?t?"lg:ml-16":"lg:ml-64":"";return e.jsxs("div",{className:"min-h-screen bg-light-bg dark:bg-dark-bg transition-colors",children:[s&&e.jsx(Ot,{}),e.jsxs("div",{className:`flex flex-col min-h-screen transition-all duration-300 ${n}`,children:[e.jsx(jt,{}),e.jsx("main",{className:"flex-1 px-4 sm:px-6 lg:px-8 py-6 w-full max-w-7xl mx-auto",children:a}),e.jsx(kt,{})]}),e.jsx(zt,{})]})};export{Ft as L,yt as u};
