import{j as e}from"./vendor-state-DrZ0R9WI.js";import{r as n,R as te}from"./vendor-react-HUtzaQ-y.js";import{e as He,C as z,L as X,I as ee,B as M,a as ke,b as oe,g as be,t as $e,s as Te,c as ws,n as he,h as Pe,i as Ae,j as Me,m as Be,k as es,l as Le,o as Ue,p as Ie,q as st,v as pe,r as _e,w as ve,d as tt}from"./index-1Xo5B0Ip.js";import{B as l,U as as,S as xe,ap as Xe,aH as Se,D as we,a as ze,V as me,o as at,b as qe,$ as rt,aI as lt,aJ as nt,ak as it,ac as ie,aK as ks,t as ge,y as _s,P as ue,X as fe,x as Ss,aE as je,aL as Cs,aM as cs,aN as Es,aO as We,a1 as de,al as ct,F as Ne,E as Ps,i as os,n as ds,Z as ot,s as Je,aP as rs,R as dt,A as As,J as Re,v as mt,aQ as Is,I as xt,a2 as Ze,a5 as ls,w as Fs,aR as De,h as ms,N as ut,aS as us,a9 as ht,K as Ke,f as Ds,an as Rs,aT as Ye,aU as pt,ad as Ge,W as Ts,_ as hs,aV as gt,aW as Ms,aX as ft,aY as bt,a0 as ps,u as jt,G as yt}from"./vendor-ui-Bx796rwZ.js";import{S as vt}from"./ScanComparison-CgD-e4Ff.js";import"./vendor-charts-VRtd0GUX.js";const Nt=()=>{var k;const[c,C]=n.useState(null),[j,g]=n.useState(!0),[b,v]=n.useState(!1),[D,T]=n.useState(!1),[t,a]=n.useState(""),[s,i]=n.useState(!1),[o,E]=n.useState(""),[d,I]=n.useState(""),[A,B]=n.useState("");n.useEffect(()=>{$()},[]);const $=async()=>{g(!0);try{const y=await He.me();C(y.data),a(y.data.email||"")}catch(y){l.error("Failed to load profile"),console.error(y)}finally{g(!1)}},L=async y=>{var O,_;if(y.preventDefault(),!t.trim()){l.error("Email is required");return}v(!0);try{const R=await He.updateProfile({email:t.trim()});C(R.data),l.success("Profile updated successfully")}catch(R){const f=R;l.error(((_=(O=f.response)==null?void 0:O.data)==null?void 0:_.error)||"Failed to update profile")}finally{v(!1)}},N=async y=>{var O,_;if(y.preventDefault(),!o||!d){l.error("All password fields are required");return}if(d.length<6){l.error("New password must be at least 6 characters");return}if(d!==A){l.error("Passwords do not match");return}T(!0);try{await He.changePassword({current_password:o,new_password:d}),l.success("Password changed successfully"),i(!1),E(""),I(""),B("")}catch(R){const f=R;l.error(((_=(O=f.response)==null?void 0:O.data)==null?void 0:_.error)||"Failed to change password")}finally{T(!1)}},h=y=>y?new Date(y).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"N/A";return j?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(as,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Profile Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(as,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Username"}),e.jsx("p",{className:"text-white font-medium",children:c==null?void 0:c.username})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(xe,{className:"h-5 w-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Roles"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:((k=c==null?void 0:c.roles)==null?void 0:k.map(y=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-primary/20 text-primary rounded capitalize",children:y},y)))||e.jsx("span",{className:"text-slate-400",children:"No roles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(Xe,{className:"h-5 w-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Member Since"}),e.jsx("p",{className:"text-white",children:h(c==null?void 0:c.created_at)})]})]})]}),e.jsx("form",{onSubmit:L,className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-2",children:[e.jsx(Se,{className:"h-4 w-4"}),"Email Address"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(ee,{type:"email",value:t,onChange:y=>a(y.target.value),placeholder:"your@email.com",className:"flex-1"}),e.jsxs(M,{type:"submit",variant:"primary",loading:b,disabled:b||t===(c==null?void 0:c.email),children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Save"]})]})]})})]}),e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ze,{className:"h-6 w-6 text-yellow-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Security"})]}),!s&&e.jsx(M,{variant:"secondary",onClick:()=>i(!0),children:"Change Password"})]}),s?e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsx(ee,{label:"Current Password",type:"password",value:o,onChange:y=>E(y.target.value),placeholder:"Enter current password"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(ee,{label:"New Password",type:"password",value:d,onChange:y=>I(y.target.value),placeholder:"Enter new password"}),e.jsx(ee,{label:"Confirm New Password",type:"password",value:A,onChange:y=>B(y.target.value),placeholder:"Confirm new password"})]}),d&&A&&d!==A&&e.jsx("p",{className:"text-sm text-red-400",children:"Passwords do not match"}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(M,{type:"button",variant:"secondary",onClick:()=>{i(!1),E(""),I(""),B("")},children:"Cancel"}),e.jsx(M,{type:"submit",variant:"primary",loading:D,disabled:D||!o||!d||d!==A,children:"Update Password"})]})]}):e.jsx("p",{className:"text-slate-400",children:"Keep your account secure by using a strong, unique password."})]}),e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(xe,{className:"h-6 w-6 text-green-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Account Status"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${(c==null?void 0:c.is_active)!==!1?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-white",children:(c==null?void 0:c.is_active)!==!1?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Your account is in good standing."})]})]})},wt=[{id:"admin",name:"Admin",description:"Full system access"},{id:"user",name:"User",description:"Standard user access"},{id:"auditor",name:"Auditor",description:"Read-only access to all scans"},{id:"viewer",name:"Viewer",description:"Limited view access"}],kt=()=>{const[c,C]=n.useState([]),[j,g]=n.useState([]),[b,v]=n.useState(!0),[D,T]=n.useState(!1),[t,a]=n.useState(new Set),[s,i]=n.useState(!1),[o,E]=n.useState(!0),[d,I]=n.useState(null),[A,B]=n.useState(!1);n.useEffect(()=>{$()},[]);const $=async()=>{var w;v(!0);try{const x=await ke.getUsers();C(x.data),E(!0)}catch(x){((w=x.response)==null?void 0:w.status)===403?E(!1):l.error("Failed to load users"),console.error(x)}finally{v(!1)}},L=async()=>{T(!0);try{const w=await ke.getAuditLogs({limit:50,offset:0});g(w.data.logs)}catch(w){l.error("Failed to load audit logs"),console.error(w)}finally{T(!1)}},N=w=>{const x=new Set(t);x.has(w)?x.delete(w):x.add(w),a(x)},h=async w=>{var x,P;try{await ke.updateUser(w.id,{is_active:!w.is_active}),l.success(`User ${w.is_active?"deactivated":"activated"}`),$()}catch(p){const G=p;l.error(((P=(x=G.response)==null?void 0:x.data)==null?void 0:P.error)||"Failed to update user")}},k=async()=>{var w,x;if(d){B(!0);try{await ke.deleteUser(d.id),l.success(`User "${d.username}" deleted successfully`),$(),I(null)}catch(P){const p=P;l.error(((x=(w=p.response)==null?void 0:w.data)==null?void 0:x.error)||"Failed to delete user")}finally{B(!1)}}},y=async(w,x)=>{var P,p;try{await ke.assignRole(w,x),l.success("Role assigned"),$()}catch(G){const J=G;l.error(((p=(P=J.response)==null?void 0:P.data)==null?void 0:p.error)||"Failed to assign role")}},O=async(w,x)=>{var P,p;try{await ke.removeRole(w,x),l.success("Role removed"),$()}catch(G){const J=G;l.error(((p=(P=J.response)==null?void 0:P.data)==null?void 0:p.error)||"Failed to remove role")}},_=async w=>{var x,P;try{await ke.unlockUser(w.id),l.success(`Account "${w.username}" unlocked`),$()}catch(p){const G=p;l.error(((P=(x=G.response)==null?void 0:x.data)==null?void 0:P.error)||"Failed to unlock account")}},R=w=>new Date(w).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),f=w=>{switch(w){case"admin":return"bg-red-500/20 text-red-400 border-red-500/30";case"user":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"auditor":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"viewer":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return b?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):o?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(at,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"User Management"})]}),e.jsxs(oe,{variant:"status",type:"completed",children:[c.length," users"]})]}),e.jsx("div",{className:"space-y-3",children:c.map(w=>{const x=t.has(w.id),P=w.roles||[];return e.jsxs("div",{className:"bg-dark-bg rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>N(w.id),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"text-slate-400",children:x?e.jsx(qe,{className:"h-4 w-4"}):e.jsx(rt,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${w.is_active!==!1?"bg-green-400":"bg-red-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:w.username}),e.jsx("p",{className:"text-sm text-slate-400",children:w.email})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex gap-1",children:P.map(p=>e.jsx("span",{className:`px-2 py-0.5 text-xs rounded border capitalize ${f(p)}`,children:p},p))}),w.is_locked&&e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded border bg-red-500/20 text-red-400 border-red-500/30 flex items-center gap-1",children:[e.jsx(ze,{className:"h-3 w-3"}),"Locked"]}),e.jsx("span",{className:"text-xs text-slate-500",children:w.created_at?R(w.created_at):"N/A"})]})]}),x&&e.jsxs("div",{className:"border-t border-dark-border p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),"Manage Roles"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:wt.map(p=>{const G=P.includes(p.id);return e.jsxs("button",{onClick:J=>{J.stopPropagation(),G?O(w.id,p.id):y(w.id,p.id)},className:`p-3 rounded-lg border text-left transition-colors ${G?"bg-primary/20 border-primary/50 text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-primary/30"}`,children:[e.jsx("p",{className:"font-medium text-sm capitalize",children:p.name}),e.jsx("p",{className:"text-xs opacity-75",children:p.description})]},p.id)})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-dark-border",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(M,{variant:w.is_active!==!1?"secondary":"primary",size:"sm",onClick:p=>{p.stopPropagation(),h(w)},children:w.is_active!==!1?e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"h-4 w-4 mr-1"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(nt,{className:"h-4 w-4 mr-1"}),"Activate"]})}),w.is_locked&&e.jsxs(M,{variant:"primary",size:"sm",onClick:p=>{p.stopPropagation(),_(w)},children:[e.jsx(it,{className:"h-4 w-4 mr-1"}),"Unlock Account"]})]}),e.jsxs(M,{variant:"secondary",size:"sm",onClick:p=>{p.stopPropagation(),I(w)},className:"text-red-400 hover:text-red-300 hover:bg-red-500/10","aria-label":`Delete user ${w.username}`,children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})]},w.id)})})]}),e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ks,{className:"h-6 w-6 text-purple-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Audit Logs"})]}),e.jsx(M,{variant:"secondary",onClick:()=>{i(!s),!s&&j.length===0&&L()},children:s?"Hide Logs":"Show Logs"})]}),s&&e.jsx(e.Fragment,{children:D?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(X,{})}):j.length===0?e.jsx("p",{className:"text-slate-400 text-center py-8",children:"No audit logs found"}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:j.map(w=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-dark-bg rounded-lg text-sm",children:[e.jsx(ge,{className:"h-4 w-4 text-slate-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium text-white",children:w.action}),w.target_type&&e.jsxs("span",{className:"text-slate-400",children:["on ",w.target_type]}),w.target_id&&e.jsx("span",{className:"text-xs text-slate-500 font-mono truncate max-w-32",children:w.target_id})]}),w.details&&e.jsx("p",{className:"text-xs text-slate-500 mt-1 truncate",children:w.details})]}),e.jsx("span",{className:"text-xs text-slate-500 whitespace-nowrap",children:R(w.created_at)})]},w.id))})}),!s&&e.jsx("p",{className:"text-slate-400",children:"View a log of administrative actions performed in the system."})]}),e.jsx(be,{isOpen:!!d,onClose:()=>I(null),onConfirm:k,title:"Delete User",message:`Are you sure you want to delete user "${d==null?void 0:d.username}"? All their data, including scans and settings, will be permanently removed.`,confirmLabel:"Delete User",variant:"danger",loading:A})]}):e.jsx(z,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(me,{className:"h-12 w-12 text-yellow-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-slate-400",children:"You don't have permission to access the administration panel."}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Contact an administrator if you need elevated access."})]})})},ss=["#ef4444","#f97316","#eab308","#22c55e","#14b8a6","#3b82f6","#8b5cf6","#ec4899","#6366f1","#64748b"],_t=()=>{const[c,C]=n.useState([]),[j,g]=n.useState(!0),[b,v]=n.useState(!1),[D,T]=n.useState(null),[t,a]=n.useState({name:"",description:"",targets:"",color:ss[0]}),[s,i]=n.useState(null),[o,E]=n.useState(!1);n.useEffect(()=>{d()},[]);const d=async()=>{g(!0);try{const N=await $e.getAll();C(N.data)}catch(N){l.error("Failed to load target groups"),console.error(N)}finally{g(!1)}},I=()=>{a({name:"",description:"",targets:"",color:ss[0]}),T(null),v(!1)},A=N=>{const h=JSON.parse(N.targets||"[]");a({name:N.name,description:N.description||"",targets:h.join(`
`),color:N.color}),T(N.id),v(!0)},B=async N=>{var k,y;N.preventDefault();const h=t.targets.split(`
`).map(O=>O.trim()).filter(O=>O.length>0);if(!t.name.trim()){l.error("Name is required");return}if(h.length===0){l.error("At least one target is required");return}try{D?(await $e.update(D,{name:t.name,description:t.description||void 0,targets:h,color:t.color}),l.success("Target group updated")):(await $e.create({name:t.name,description:t.description||void 0,targets:h,color:t.color}),l.success("Target group created")),I(),d()}catch(O){const _=O;l.error(((y=(k=_.response)==null?void 0:k.data)==null?void 0:y.error)||"Failed to save target group")}},$=async()=>{var N,h;if(s){E(!0);try{await $e.delete(s.id),l.success(`Target group "${s.name}" deleted`),d(),i(null)}catch(k){const y=k;l.error(((h=(N=y.response)==null?void 0:N.data)==null?void 0:h.error)||"Failed to delete")}finally{E(!1)}}},L=N=>{try{return JSON.parse(N||"[]")}catch{return[]}};return j?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_s,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Target Groups"})]}),!b&&e.jsxs(M,{variant:"primary",onClick:()=>v(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"New Group"]})]})}),b&&e.jsx(z,{children:e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:D?"Edit Target Group":"Create Target Group"}),e.jsx("button",{type:"button",onClick:I,className:"text-slate-400 hover:text-white",children:e.jsx(fe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:t.name,onChange:N=>a({...t,name:N.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Production Servers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Color"}),e.jsx("div",{className:"flex gap-2",children:ss.map(N=>e.jsx("button",{type:"button",onClick:()=>a({...t,color:N}),className:`w-8 h-8 rounded-full border-2 transition-all ${t.color===N?"border-white scale-110":"border-transparent"}`,style:{backgroundColor:N}},N))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:t.description,onChange:N=>a({...t,description:N.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Targets (one per line)"}),e.jsx("textarea",{value:t.targets,onChange:N=>a({...t,targets:N.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:5,placeholder:`192.168.1.0/24
10.0.0.1
example.com`})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(M,{type:"button",variant:"secondary",onClick:I,children:"Cancel"}),e.jsxs(M,{type:"submit",variant:"primary",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),D?"Update":"Create"]})]})]})}),c.length===0&&!b?e.jsx(z,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ss,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No target groups yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create groups to organize your scan targets"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(N=>{const h=L(N.targets);return e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:N.color}}),e.jsx("h4",{className:"font-medium text-white",children:N.name})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>A(N),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>i(N),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete target group ${N.name}`,children:e.jsx(ie,{className:"h-4 w-4"})})]})]}),N.description&&e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:N.description}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:[h.length," target",h.length!==1?"s":""]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[h.slice(0,5).map((k,y)=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-300 font-mono",children:k},y)),h.length>5&&e.jsxs("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-500",children:["+",h.length-5," more"]})]})]})]},N.id)})}),e.jsx(be,{isOpen:!!s,onClose:()=>i(null),onConfirm:$,title:"Delete Target Group",message:`Are you sure you want to delete the target group "${s==null?void 0:s.name}"? Scheduled scans using this group will need to be updated.`,confirmLabel:"Delete Group",variant:"danger",loading:o})]})},gs={name:"",description:"",schedule_type:"daily",schedule_value:"02:00",targets:"",port_range_start:1,port_range_end:1e3,threads:100,enable_os_detection:!0,enable_service_detection:!0,enable_vuln_scan:!0,enable_enumeration:!1},fs=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],St=()=>{const[c,C]=n.useState([]),[j,g]=n.useState([]),[b,v]=n.useState(!0),[D,T]=n.useState(!1),[t,a]=n.useState(null),[s,i]=n.useState(gs),[o,E]=n.useState(0),[d,I]=n.useState(1),[A,B]=n.useState(null),[$,L]=n.useState(!1);n.useEffect(()=>{N()},[]);const N=async()=>{v(!0);try{const[x,P]=await Promise.all([Te.getAll(),$e.getAll()]);C(x.data),g(P.data)}catch(x){l.error("Failed to load scheduled scans"),console.error(x)}finally{v(!1)}},h=()=>{i(gs),a(null),T(!1),E(0),I(1)},k=x=>{const P=JSON.parse(x.config);if(i({name:x.name,description:x.description||"",schedule_type:x.schedule_type,schedule_value:x.schedule_value,targets:P.targets.join(`
`),port_range_start:P.port_range[0],port_range_end:P.port_range[1],threads:P.threads,enable_os_detection:P.enable_os_detection,enable_service_detection:P.enable_service_detection,enable_vuln_scan:P.enable_vuln_scan,enable_enumeration:P.enable_enumeration}),x.schedule_type==="weekly"){const p=x.schedule_value.split(" ");p.length>=2&&E(parseInt(p[1])||0)}else if(x.schedule_type==="monthly"){const p=x.schedule_value.split(" ");p.length>=2&&I(parseInt(p[1])||1)}a(x.id),T(!0)},y=()=>{const x=s.schedule_value.includes(":")?s.schedule_value:"02:00";switch(s.schedule_type){case"daily":return x;case"weekly":return`${x} ${o}`;case"monthly":return`${x} ${d}`;default:return x}},O=async x=>{var J,r;x.preventDefault();const P=s.targets.split(`
`).map(F=>F.trim()).filter(F=>F.length>0);if(!s.name.trim()){l.error("Name is required");return}if(P.length===0){l.error("At least one target is required");return}const p={targets:P,port_range:[s.port_range_start,s.port_range_end],threads:s.threads,enable_os_detection:s.enable_os_detection,enable_service_detection:s.enable_service_detection,enable_vuln_scan:s.enable_vuln_scan,enable_enumeration:s.enable_enumeration},G=y();try{t?(await Te.update(t,{name:s.name,description:s.description||void 0,config:p,schedule_type:s.schedule_type,schedule_value:G}),l.success("Scheduled scan updated")):(await Te.create({name:s.name,description:s.description||void 0,config:p,schedule_type:s.schedule_type,schedule_value:G}),l.success("Scheduled scan created")),h(),N()}catch(F){const V=F;l.error(((r=(J=V.response)==null?void 0:J.data)==null?void 0:r.error)||"Failed to save scheduled scan")}},_=async x=>{var P,p;try{await Te.update(x.id,{is_active:!x.is_active}),l.success(`Scheduled scan ${x.is_active?"paused":"activated"}`),N()}catch(G){const J=G;l.error(((p=(P=J.response)==null?void 0:P.data)==null?void 0:p.error)||"Failed to update")}},R=async()=>{var x,P;if(A){L(!0);try{await Te.delete(A.id),l.success(`Scheduled scan "${A.name}" deleted`),N(),B(null)}catch(p){const G=p;l.error(((P=(x=G.response)==null?void 0:x.data)==null?void 0:P.error)||"Failed to delete")}finally{L(!1)}}},f=x=>{const P=JSON.parse(x.targets||"[]");i(p=>({...p,targets:P.join(`
`)}))},w=x=>{const P=x.schedule_value.split(" "),p=P[0];switch(x.schedule_type){case"daily":return`Daily at ${p}`;case"weekly":return`Every ${fs[parseInt(P[1])||0]} at ${p}`;case"monthly":return`Monthly on day ${P[1]||1} at ${p}`;default:return x.schedule_value}};return b?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scheduled Scans"})]}),!D&&e.jsxs(M,{variant:"primary",onClick:()=>T(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"New Schedule"]})]})}),D&&e.jsx(z,{children:e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:t?"Edit Scheduled Scan":"Create Scheduled Scan"}),e.jsx("button",{type:"button",onClick:h,className:"text-slate-400 hover:text-white",children:e.jsx(fe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:x=>i({...s,name:x.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Daily Network Scan"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:s.description,onChange:x=>i({...s,description:x.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(Xe,{className:"h-4 w-4"})," Schedule"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Frequency"}),e.jsxs("select",{value:s.schedule_type,onChange:x=>i({...s,schedule_type:x.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),s.schedule_type==="weekly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Week"}),e.jsx("select",{value:o,onChange:x=>E(parseInt(x.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:fs.map((x,P)=>e.jsx("option",{value:P,children:x},x))})]}),s.schedule_type==="monthly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Month"}),e.jsx("select",{value:d,onChange:x=>I(parseInt(x.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Array.from({length:28},(x,P)=>P+1).map(x=>e.jsx("option",{value:x,children:x},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Time (UTC)"}),e.jsx("input",{type:"time",value:s.schedule_value.split(" ")[0],onChange:x=>i({...s,schedule_value:x.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Targets (one per line)"}),j.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Use group:"}),j.slice(0,3).map(x=>e.jsx("button",{type:"button",onClick:()=>f(x),className:"px-2 py-0.5 text-xs rounded border border-dark-border text-slate-400 hover:text-white hover:border-primary",style:{borderLeftColor:x.color,borderLeftWidth:3},children:x.name},x.id))]})]}),e.jsx("textarea",{value:s.targets,onChange:x=>i({...s,targets:x.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:4,placeholder:`192.168.1.0/24
10.0.0.1`})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port Start"}),e.jsx("input",{type:"number",value:s.port_range_start,onChange:x=>i({...s,port_range_start:parseInt(x.target.value)||1}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port End"}),e.jsx("input",{type:"number",value:s.port_range_end,onChange:x=>i({...s,port_range_end:parseInt(x.target.value)||1e3}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Threads"}),e.jsx("input",{type:"number",value:s.threads,onChange:x=>i({...s,threads:parseInt(x.target.value)||100}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:1e3})]})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:[{key:"enable_os_detection",label:"OS Detection"},{key:"enable_service_detection",label:"Service Detection"},{key:"enable_vuln_scan",label:"Vulnerability Scan"},{key:"enable_enumeration",label:"Enumeration"}].map(({key:x,label:P})=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s[x],onChange:p=>i({...s,[x]:p.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-slate-300",children:P})]},x))}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(M,{type:"button",variant:"secondary",onClick:h,children:"Cancel"}),e.jsxs(M,{type:"submit",variant:"primary",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),t?"Update":"Create"]})]})]})}),c.length===0&&!D?e.jsx(z,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ge,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scheduled scans"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create automated recurring scans"})]})}):e.jsx("div",{className:"space-y-3",children:c.map(x=>{const P=JSON.parse(x.config);return e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${x.is_active?"bg-green-500/20":"bg-slate-500/20"}`,children:e.jsx(ge,{className:`h-5 w-5 ${x.is_active?"text-green-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-white",children:x.name}),e.jsx(oe,{variant:"status",type:x.is_active?"completed":"pending",children:x.is_active?"Active":"Paused"})]}),e.jsx("p",{className:"text-sm text-slate-400",children:w(x)}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[P.targets.length," target",P.targets.length!==1?"s":""," | Ports ",P.port_range[0],"-",P.port_range[1]," |",x.run_count," runs",x.last_run_at&&e.jsxs(e.Fragment,{children:[" | Last run ",ws(new Date(x.last_run_at))," ago"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>_(x),className:`p-2 rounded transition-colors ${x.is_active?"text-yellow-400 hover:bg-yellow-500/20":"text-green-400 hover:bg-green-500/20"}`,title:x.is_active?"Pause":"Activate",children:x.is_active?e.jsx(Cs,{className:"h-4 w-4"}):e.jsx(cs,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>k(x),className:"p-2 text-slate-400 hover:text-primary transition-colors",children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>B(x),className:"p-2 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete scheduled scan ${x.name}`,children:e.jsx(ie,{className:"h-4 w-4"})})]})]})},x.id)})}),e.jsx(be,{isOpen:!!A,onClose:()=>B(null),onConfirm:R,title:"Delete Scheduled Scan",message:`Are you sure you want to delete the scheduled scan "${A==null?void 0:A.name}"? Future automated scans will no longer run.`,confirmLabel:"Delete Schedule",variant:"warning",loading:$})]})},Ct=()=>{const[c,C]=n.useState(null),[j,g]=n.useState(!0),[b,v]=n.useState(!1),[D,T]=n.useState(!1),[t,a]=n.useState(!1),[s,i]=n.useState(!1),[o,E]=n.useState(null),[d,I]=n.useState({email_on_scan_complete:!1,email_on_critical_vuln:!0,email_address:"",slack_webhook_url:"",teams_webhook_url:""});n.useEffect(()=>{A(),B()},[]);const A=async()=>{var k;g(!0);try{const y=await he.getSettings();C(y.data),I({email_on_scan_complete:y.data.email_on_scan_complete,email_on_critical_vuln:y.data.email_on_critical_vuln,email_address:y.data.email_address||"",slack_webhook_url:y.data.slack_webhook_url||"",teams_webhook_url:y.data.teams_webhook_url||""})}catch(y){((k=y.response)==null?void 0:k.status)!==404&&(l.error("Failed to load notification settings"),console.error(y))}finally{g(!1)}},B=async()=>{try{const k=await he.checkSmtpStatus();E(k.data.configured)}catch(k){console.error("Failed to check SMTP status:",k),E(!1)}},$=async k=>{var y,O;if(k.preventDefault(),(d.email_on_scan_complete||d.email_on_critical_vuln)&&!d.email_address){l.error("Email address is required when notifications are enabled");return}v(!0);try{const _=await he.updateSettings(d);C(_.data),l.success("Notification settings saved")}catch(_){const R=_;l.error(((O=(y=R.response)==null?void 0:y.data)==null?void 0:O.error)||"Failed to save settings")}finally{v(!1)}},L=async()=>{var k,y;if(!d.slack_webhook_url){l.error("Please enter a Slack webhook URL first");return}T(!0);try{d.slack_webhook_url!==(c==null?void 0:c.slack_webhook_url)&&await he.updateSettings({slack_webhook_url:d.slack_webhook_url});const O=await he.testSlack();l.success(O.data.message)}catch(O){const _=O;l.error(((y=(k=_.response)==null?void 0:k.data)==null?void 0:y.error)||"Failed to send test message")}finally{T(!1)}},N=async()=>{var k,y;if(!d.teams_webhook_url){l.error("Please enter a Teams webhook URL first");return}a(!0);try{d.teams_webhook_url!==(c==null?void 0:c.teams_webhook_url)&&await he.updateSettings({teams_webhook_url:d.teams_webhook_url});const O=await he.testTeams();l.success(O.data.message)}catch(O){const _=O;l.error(((y=(k=_.response)==null?void 0:k.data)==null?void 0:y.error)||"Failed to send test message")}finally{a(!1)}},h=async()=>{var k,y;if(!d.email_address){l.error("Please enter an email address first");return}if(!o){l.error("SMTP is not configured on the server. Contact your administrator.");return}i(!0);try{d.email_address!==(c==null?void 0:c.email_address)&&await he.updateSettings({email_address:d.email_address});const O=await he.testEmail();l.success(O.data.message)}catch(O){const _=O;l.error(((y=(k=_.response)==null?void 0:k.data)==null?void 0:y.error)||"Failed to send test email")}finally{i(!1)}};return j?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Es,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Notification Settings"})]}),e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Notification Email Address"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Se,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"email",value:d.email_address,onChange:k=>I({...d,email_address:k.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"your@email.com"})]}),e.jsx(M,{type:"button",variant:"secondary",onClick:h,disabled:!d.email_address||s||!o,title:o?"Send test email":"SMTP not configured on server",children:s?e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx("span",{className:"ml-2",children:"Sending..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Email address where notifications will be sent"}),o!==null&&e.jsx("span",{className:`text-xs flex items-center gap-1 ${o?"text-green-400":"text-amber-400"}`,children:o?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"h-3 w-3"}),"SMTP configured"]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"h-3 w-3"}),"SMTP not configured"]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Email Notifications"}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:d.email_on_scan_complete,onChange:k=>I({...d,email_on_scan_complete:k.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"font-medium text-white",children:"Scan Completion"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Receive an email when any of your scans complete, including a summary of findings"})]})]}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:d.email_on_critical_vuln,onChange:k=>I({...d,email_on_critical_vuln:k.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"font-medium text-white",children:"Critical Vulnerabilities"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Get immediate alerts when critical or high severity vulnerabilities are discovered"})]})]})]}),o===!1?e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(me,{className:"h-5 w-5 text-amber-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-200",children:"SMTP is not configured on this server. Email notifications are disabled."}),e.jsx("p",{className:"text-xs text-amber-300/70 mt-1",children:"Contact your administrator to configure SMTP settings (SMTP_HOST, SMTP_USER, etc.)"})]})]})}):e.jsx("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Se,{className:"h-5 w-5 text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-200",children:o?"Email notifications are ready. Use the Test button to verify delivery.":"Checking SMTP configuration..."}),e.jsx("p",{className:"text-xs text-blue-300/70 mt-1",children:"Contact your administrator if you're not receiving emails."})]})]})}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-dark-border",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(ct,{className:"h-4 w-4"}),"Webhook Integrations"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Slack Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:d.slack_webhook_url,onChange:k=>I({...d,slack_webhook_url:k.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://hooks.slack.com/services/YOUR/WEBHOOK/URL"}),e.jsx(M,{type:"button",variant:"secondary",onClick:L,disabled:!d.slack_webhook_url||D,children:D?e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Send scan notifications to a Slack channel. Create a webhook at"," ",e.jsx("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Slack Incoming Webhooks"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Microsoft Teams Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:d.teams_webhook_url,onChange:k=>I({...d,teams_webhook_url:k.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://outlook.office.com/webhook/YOUR/WEBHOOK/URL"}),e.jsx(M,{type:"button",variant:"secondary",onClick:N,disabled:!d.teams_webhook_url||t,children:t?e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Send scan notifications to a Teams channel. Create a webhook in your Teams channel connectors."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(M,{type:"submit",variant:"primary",disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Save Settings"]})})})]})]}),c&&e.jsxs(z,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"Current Status"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Scan Complete Emails:"}),e.jsx("span",{className:`ml-2 ${c.email_on_scan_complete?"text-green-400":"text-slate-400"}`,children:c.email_on_scan_complete?"Enabled":"Disabled"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Critical Vuln Alerts:"}),e.jsx("span",{className:`ml-2 ${c.email_on_critical_vuln?"text-green-400":"text-slate-400"}`,children:c.email_on_critical_vuln?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-slate-500",children:"Last Updated:"}),e.jsx("span",{className:"ml-2 text-slate-300",children:new Date(c.updated_at).toLocaleString()})]})]})]})]})},Oe={quick:{label:"Quick",icon:ot,color:"text-yellow-400"},standard:{label:"Standard",icon:ds,color:"text-blue-400"},comprehensive:{label:"Comprehensive",icon:xe,color:"text-purple-400"},web:{label:"Web",icon:os,color:"text-green-400"},stealth:{label:"Stealth",icon:Ps,color:"text-slate-400"},custom:{label:"Custom",icon:Ne,color:"text-cyan-400"}},Et=()=>{var V;const[c,C]=n.useState([]),[j,g]=n.useState(!0),[b,v]=n.useState(!1),[D,T]=n.useState(null),[t,a]=n.useState({name:"",description:"",category:"custom",estimated_duration_mins:""}),[s,i]=n.useState(new Set),[o,E]=n.useState(new Set),[d,I]=n.useState(null),[A,B]=n.useState(!1),[$,L]=n.useState(null),[N,h]=n.useState(null);n.useEffect(()=>{k()},[]);const k=async()=>{g(!0);try{const u=await Pe.getAll();C(u.data)}catch(u){l.error("Failed to load templates"),console.error(u)}finally{g(!1)}},y=n.useMemo(()=>{const u={};return c.forEach(U=>{const W=U.category||"custom";u[W]||(u[W]=[]),u[W].push(U)}),Object.keys(u).forEach(U=>{u[U].sort((W,H)=>W.is_system!==H.is_system?W.is_system?-1:1:W.is_default!==H.is_default?W.is_default?-1:1:H.use_count-W.use_count)}),u},[c]),O=n.useMemo(()=>["quick","standard","comprehensive","web","stealth","custom"].filter(U=>{var W;return((W=y[U])==null?void 0:W.length)>0}),[y]),_=n.useMemo(()=>$?y[$]||[]:c,[c,$,y]),R=()=>{a({name:"",description:"",category:"custom",estimated_duration_mins:""}),T(null),v(!1)},f=u=>{if(u.is_system){l.error("System templates cannot be edited. Clone it to create your own version.");return}a({name:u.name,description:u.description||"",category:u.category,estimated_duration_mins:u.estimated_duration_mins||""}),T(u.id),v(!0)},w=async u=>{var U,W;if(u.preventDefault(),!t.name.trim()){l.error("Name is required");return}if(!D){l.error('Cannot create templates from this form. Use "Save as Template" in the scan form.');return}try{await Pe.update(D,{name:t.name,description:t.description||void 0,category:t.category,estimated_duration_mins:t.estimated_duration_mins||void 0}),l.success("Template updated"),R(),k()}catch(H){const K=H;l.error(((W=(U=K.response)==null?void 0:U.data)==null?void 0:W.error)||"Failed to update template")}},x=async()=>{var u,U;if(d){B(!0);try{await Pe.delete(d.id),l.success(`Template "${d.name}" deleted`),k(),I(null)}catch(W){const H=W;l.error(((U=(u=H.response)==null?void 0:u.data)==null?void 0:U.error)||"Failed to delete")}finally{B(!1)}}},P=async u=>{var W,H;const U=prompt("Enter name for the cloned template:",`${u.name} (Copy)`);if(U){E(K=>new Set([...K,u.id]));try{await Pe.clone(u.id,U),l.success("Template cloned successfully"),k()}catch(K){const m=K;l.error(((H=(W=m.response)==null?void 0:W.data)==null?void 0:H.error)||"Failed to clone template")}finally{E(K=>{const m=new Set(K);return m.delete(u.id),m})}}},p=async u=>{var U,W;h(u.id);try{await Pe.setDefault(u.id),l.success(`"${u.name}" set as default template`),k()}catch(H){const K=H;l.error(((W=(U=K.response)==null?void 0:U.data)==null?void 0:W.error)||"Failed to set default")}finally{h(null)}},G=async u=>{var K,m;const U=prompt(`Enter name for new scan (based on "${u.name}"):`,`${u.name} - ${new Date().toLocaleDateString()}`);if(!U)return;const W=prompt("Enter target(s) to scan (comma-separated IPs or hostnames):");if(!W)return;const H=W.split(",").map(q=>q.trim()).filter(Boolean);if(H.length===0){l.error("At least one target is required");return}i(new Set([...s,u.id]));try{await Pe.createScan(u.id,U,H),l.success("Scan started from template!")}catch(q){const Q=q;l.error(((m=(K=Q.response)==null?void 0:K.data)==null?void 0:m.error)||"Failed to create scan")}finally{i(q=>{const Q=new Set(q);return Q.delete(u.id),Q})}},J=u=>{if(!u)return"-";if(u<60)return`~${u}m`;const U=Math.floor(u/60),W=u%60;return W?`~${U}h ${W}m`:`~${U}h`},r=u=>new Date(u).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),F=u=>e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[u.enable_os_detection&&e.jsx(oe,{variant:"status",type:"completed",children:"OS"}),u.enable_service_detection&&e.jsx(oe,{variant:"status",type:"completed",children:"Services"}),u.enable_vuln_scan&&e.jsx(oe,{variant:"status",type:"running",children:"Vuln Scan"}),u.enable_enumeration&&e.jsx(oe,{variant:"status",type:"pending",children:"Enum"})]});return j?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scan Templates"})]}),e.jsx("div",{className:"text-sm text-slate-400",children:"Reusable scan profiles for quick configuration"})]}),O.length>0&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>L(null),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${$===null?"bg-primary text-white":"bg-dark-bg text-slate-400 hover:text-white hover:bg-slate-700"}`,children:["All (",c.length,")"]}),O.map(u=>{var K;const U=Oe[u],W=U.icon,H=((K=y[u])==null?void 0:K.length)||0;return e.jsxs("button",{onClick:()=>L(u),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${$===u?"bg-primary text-white":"bg-dark-bg text-slate-400 hover:text-white hover:bg-slate-700"}`,children:[e.jsx(W,{className:`h-4 w-4 ${$===u?"text-white":U.color}`}),U.label," (",H,")"]},u)})]})]}),b&&e.jsx(z,{children:e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Edit Template"}),e.jsx("button",{type:"button",onClick:R,className:"text-slate-400 hover:text-white",children:e.jsx(fe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:t.name,onChange:u=>a({...t,name:u.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"My Custom Template"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Category"}),e.jsx("select",{value:t.category,onChange:u=>a({...t,category:u.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Object.entries(Oe).map(([u,U])=>e.jsx("option",{value:u,children:U.label},u))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("textarea",{value:t.description,onChange:u=>a({...t,description:u.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",rows:2,placeholder:"Optional description of the template"})]}),e.jsxs("div",{className:"w-48",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Est. Duration (mins)"}),e.jsx("input",{type:"number",value:t.estimated_duration_mins,onChange:u=>a({...t,estimated_duration_mins:u.target.value?parseInt(u.target.value):""}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"30",min:"1"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(M,{type:"button",variant:"secondary",onClick:R,children:"Cancel"}),e.jsxs(M,{type:"submit",variant:"primary",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Update"]})]})]})}),_.length===0&&!b?e.jsx(z,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ne,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:$?`No ${((V=Oe[$])==null?void 0:V.label)||""} templates`:"No scan templates yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:'Save scan configurations using "Save as Template" when creating a scan'})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:_.map(u=>{const U=u.config,W=s.has(u.id),H=o.has(u.id),K=N===u.id,m=Oe[u.category]||Oe.custom,q=m.icon;return e.jsxs(z,{className:"relative",children:[u.is_system&&e.jsx("div",{className:"absolute top-2 right-2",title:"System template (read-only)",children:e.jsx(ze,{className:"h-4 w-4 text-slate-500"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-dark-bg ${m.color}`,children:e.jsx(q,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-white truncate",children:u.name}),u.is_default&&e.jsx("span",{title:"Default template",children:e.jsx(Je,{className:"h-4 w-4 text-yellow-400 flex-shrink-0"})})]}),u.description&&e.jsx("p",{className:"text-sm text-slate-400 line-clamp-2 mt-0.5",children:u.description})]})]}),e.jsxs("div",{className:"space-y-2 border-t border-dark-border pt-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Ports: ",U.port_range[0],"-",U.port_range[1]]})]}),U.scan_type&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-slate-400 capitalize",children:U.scan_type.replace("_"," ")})]}),U.enable_enumeration&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(As,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Enum: ",U.enum_depth||"light"]})]}),u.estimated_duration_mins&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-slate-400",children:J(u.estimated_duration_mins)})]})]}),F(U)]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 border-t border-dark-border pt-3",children:[e.jsxs("span",{children:["Used ",u.use_count," times"]}),u.last_used_at?e.jsxs("span",{children:["Last: ",r(u.last_used_at)]}):e.jsxs("span",{children:["Created ",r(u.created_at)]})]}),e.jsxs("div",{className:"flex items-center justify-between border-t border-dark-border pt-3",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>P(u),disabled:H,className:"p-1.5 text-slate-400 hover:text-primary transition-colors disabled:opacity-50",title:"Clone template",children:e.jsx(Re,{className:"h-4 w-4"})}),!u.is_system&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>f(u),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit template",children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>I(u),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete template",children:e.jsx(ie,{className:"h-4 w-4"})})]}),!u.is_default&&e.jsx("button",{onClick:()=>p(u),disabled:K,className:"p-1.5 text-slate-400 hover:text-yellow-400 transition-colors disabled:opacity-50",title:"Set as default",children:e.jsx(Je,{className:"h-4 w-4"})})]}),e.jsxs(M,{variant:"primary",size:"sm",onClick:()=>G(u),loading:W,disabled:W,children:[e.jsx(mt,{className:"h-4 w-4 mr-1.5"}),"Use"]})]})]})]},u.id)})}),e.jsx(be,{isOpen:!!d,onClose:()=>I(null),onConfirm:x,title:"Delete Template",message:`Are you sure you want to delete the template "${d==null?void 0:d.name}"? This will not affect any scans previously created from this template.`,confirmLabel:"Delete Template",variant:"danger",loading:A})]})},bs=["critical","high","medium","low","info"],Pt=["web","network","infrastructure","cloud","api","mobile","other"],At=()=>{var W,H,K;const[c,C]=n.useState([]),[j,g]=n.useState([]),[b,v]=n.useState(!0),[D,T]=n.useState(!1),[t,a]=n.useState(null),[s,i]=n.useState(null),[o,E]=n.useState(!1),[d,I]=n.useState(!1),[A,B]=n.useState(null),[$,L]=n.useState(""),[N,h]=n.useState(""),[k,y]=n.useState(""),[O,_]=n.useState(!0),[R,f]=n.useState({category:"web",title:"",severity:"medium",description:"",impact:"",remediation:"",references:[],cwe_ids:[],cvss_vector:"",cvss_score:void 0,tags:[]});n.useEffect(()=>{w(),x()},[N,k,$,O]);const w=async()=>{v(!0);try{const m=await Ae.list({category:N||void 0,severity:k||void 0,search:$||void 0,include_system:O});C(m.data)}catch(m){l.error("Failed to load finding templates"),console.error(m)}finally{v(!1)}},x=async()=>{try{const m=await Ae.getCategories();g(m.data)}catch(m){console.error("Failed to load categories:",m)}},P=()=>{f({category:"web",title:"",severity:"medium",description:"",impact:"",remediation:"",references:[],cwe_ids:[],cvss_vector:"",cvss_score:void 0,tags:[]}),a(null),T(!1)},p=m=>{f({category:m.category,title:m.title,severity:m.severity,description:m.description,impact:m.impact||"",remediation:m.remediation||"",references:m.references?JSON.parse(m.references):[],cwe_ids:m.cwe_ids?JSON.parse(m.cwe_ids):[],cvss_vector:m.cvss_vector||"",cvss_score:m.cvss_score||void 0,tags:m.tags?JSON.parse(m.tags):[]}),a(m),T(!0)},G=async m=>{var Q,ce;const q=prompt("Enter name for cloned template:",`${m.title} (Copy)`);if(q)try{await Ae.clone(m.id,{new_title:q}),l.success("Template cloned successfully"),w(),x()}catch(ye){const le=ye;l.error(((ce=(Q=le.response)==null?void 0:Q.data)==null?void 0:ce.error)||"Failed to clone template")}},J=async m=>{var q,Q;if(m.preventDefault(),!R.title.trim()){l.error("Title is required");return}if(!R.description.trim()){l.error("Description is required");return}I(!0);try{t?(await Ae.update(t.id,R),l.success("Template updated successfully")):(await Ae.create(R),l.success("Template created successfully")),P(),w(),x()}catch(ce){const ye=ce;l.error(((Q=(q=ye.response)==null?void 0:q.data)==null?void 0:Q.error)||"Failed to save template")}finally{I(!1)}},r=async()=>{var m,q;if(s){E(!0);try{await Ae.delete(s.id),l.success(`Template "${s.title}" deleted`),w(),x(),i(null)}catch(Q){const ce=Q;l.error(((q=(m=ce.response)==null?void 0:m.data)==null?void 0:q.error)||"Failed to delete template")}finally{E(!1)}}},F=m=>{switch(m.toLowerCase()){case"critical":case"high":return e.jsx(me,{className:"h-4 w-4"});case"medium":return e.jsx(xe,{className:"h-4 w-4"});default:return e.jsx(ls,{className:"h-4 w-4"})}},V=m=>{const q=m.toLowerCase();return q==="critical"?"critical":q==="high"?"high":q==="medium"?"medium":"low"},u=m=>{if(!m)return[];try{return JSON.parse(m)}catch{return[]}},U=m=>new Date(m).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return b&&c.length===0?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Finding Templates"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-slate-400",children:[c.length," template",c.length!==1?"s":""]}),e.jsxs(M,{variant:"primary",size:"sm",onClick:()=>T(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-1.5"}),"New Template"]})]})]})}),e.jsx(z,{children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(As,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",value:$,onChange:m=>L(m.target.value),placeholder:"Search templates...",className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})}),e.jsxs("div",{className:"relative",children:[e.jsx(xt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsxs("select",{value:N,onChange:m=>h(m.target.value),className:"bg-dark-bg border border-dark-border rounded-lg pl-10 pr-8 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"All Categories"}),j.map(m=>e.jsxs("option",{value:m.category,children:[m.category.charAt(0).toUpperCase()+m.category.slice(1)," (",m.count,")"]},m.category))]}),e.jsx(qe,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:k,onChange:m=>y(m.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent appearance-none cursor-pointer pr-8",children:[e.jsx("option",{value:"",children:"All Severities"}),bs.map(m=>e.jsx("option",{value:m,children:m.charAt(0).toUpperCase()+m.slice(1)},m))]}),e.jsx(qe,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:O,onChange:m=>_(m.target.checked),className:"rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),"Include system templates"]})]})}),D&&e.jsx(z,{children:e.jsxs("form",{onSubmit:J,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:t?"Edit Template":"New Template"}),e.jsx("button",{type:"button",onClick:P,className:"text-slate-400 hover:text-white",children:e.jsx(fe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Category"}),e.jsx("select",{value:R.category,onChange:m=>f({...R,category:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Pt.map(m=>e.jsx("option",{value:m,children:m.charAt(0).toUpperCase()+m.slice(1)},m))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Severity"}),e.jsx("select",{value:R.severity,onChange:m=>f({...R,severity:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:bs.map(m=>e.jsx("option",{value:m,children:m.charAt(0).toUpperCase()+m.slice(1)},m))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CVSS Score"}),e.jsx("input",{type:"number",step:"0.1",min:"0",max:"10",value:R.cvss_score||"",onChange:m=>f({...R,cvss_score:m.target.value?parseFloat(m.target.value):void 0}),placeholder:"0.0 - 10.0",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:R.title,onChange:m=>f({...R,title:m.target.value}),placeholder:"e.g., SQL Injection in Login Form",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description *"}),e.jsx("textarea",{value:R.description,onChange:m=>f({...R,description:m.target.value}),rows:4,placeholder:"Detailed description of the vulnerability...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Impact"}),e.jsx("textarea",{value:R.impact||"",onChange:m=>f({...R,impact:m.target.value}),rows:2,placeholder:"Potential impact if exploited...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Remediation"}),e.jsx("textarea",{value:R.remediation||"",onChange:m=>f({...R,remediation:m.target.value}),rows:3,placeholder:"Recommended steps to fix...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CVSS Vector"}),e.jsx("input",{type:"text",value:R.cvss_vector||"",onChange:m=>f({...R,cvss_vector:m.target.value}),placeholder:"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"CWE IDs (comma-separated)"}),e.jsx("input",{type:"text",value:((W=R.cwe_ids)==null?void 0:W.join(", "))||"",onChange:m=>{const q=m.target.value.split(",").map(Q=>parseInt(Q.trim())).filter(Q=>!isNaN(Q));f({...R,cwe_ids:q})},placeholder:"e.g., 89, 564",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"References (one URL per line)"}),e.jsx("textarea",{value:((H=R.references)==null?void 0:H.join(`
`))||"",onChange:m=>{const q=m.target.value.split(`
`).map(Q=>Q.trim()).filter(Q=>Q);f({...R,references:q})},rows:2,placeholder:"https://owasp.org/...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:((K=R.tags)==null?void 0:K.join(", "))||"",onChange:m=>{const q=m.target.value.split(",").map(Q=>Q.trim()).filter(Q=>Q);f({...R,tags:q})},placeholder:"e.g., owasp, web, injection",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(M,{type:"button",variant:"secondary",onClick:P,children:"Cancel"}),e.jsxs(M,{type:"submit",variant:"primary",loading:d,disabled:d,children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),t?"Update":"Create"]})]})]})}),c.length===0&&!D?e.jsx(z,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ne,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No finding templates found"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:N||k||$?"Try adjusting your filters":"Create your first template or include system templates"})]})}):e.jsx("div",{className:"space-y-3",children:c.map(m=>{const q=A===m.id,Q=u(m.references),ce=u(m.cwe_ids),ye=u(m.tags);return e.jsx(z,{className:q?"ring-1 ring-primary":"",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>B(q?null:m.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(oe,{variant:"severity",type:V(m.severity),children:[F(m.severity),e.jsx("span",{className:"ml-1",children:m.severity})]}),e.jsx(oe,{variant:"status",type:"pending",children:m.category}),m.is_system&&e.jsx(oe,{variant:"status",type:"completed",children:"System"})]}),e.jsx("h4",{className:"font-semibold text-white text-lg mt-2",children:m.title}),!q&&e.jsx("p",{className:"text-sm text-slate-400 mt-1 line-clamp-2",children:m.description})]}),e.jsxs("div",{className:"flex gap-1 ml-4",children:[e.jsx("button",{onClick:()=>G(m),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Clone template",children:e.jsx(Re,{className:"h-4 w-4"})}),!m.is_system&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>p(m),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit template",children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>i(m),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete template",children:e.jsx(ie,{className:"h-4 w-4"})})]})]})]}),q&&e.jsxs("div",{className:"border-t border-dark-border pt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:m.description})]}),m.impact&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Impact"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:m.impact})]}),m.remediation&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-1",children:"Remediation"}),e.jsx("p",{className:"text-sm text-slate-400 whitespace-pre-wrap",children:m.remediation})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[m.cvss_score!==null&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"CVSS:"})," ",e.jsx("span",{className:"text-white font-medium",children:m.cvss_score.toFixed(1)})]}),m.cvss_vector&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Vector:"})," ",e.jsx("code",{className:"text-slate-300 text-xs",children:m.cvss_vector})]}),ce.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"CWE:"})," ",ce.map((le,Ee)=>e.jsxs("span",{children:[Ee>0&&", ",e.jsxs("a",{href:`https://cwe.mitre.org/data/definitions/${le}.html`,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:["CWE-",le]})]},le))]})]}),Q.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-2",children:"References"}),e.jsx("div",{className:"space-y-1",children:Q.map((le,Ee)=>e.jsxs("a",{href:le,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-primary hover:underline",children:[e.jsx(Ze,{className:"h-3 w-3"}),le]},Ee))})]}),ye.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5",children:ye.map(le=>e.jsx("span",{className:"px-2 py-0.5 bg-dark-border rounded text-xs text-slate-300",children:le},le))}),e.jsxs("div",{className:"text-xs text-slate-500 pt-2 border-t border-dark-border",children:["Created ",U(m.created_at),m.updated_at!==m.created_at&&e.jsxs(e.Fragment,{children:["  Updated ",U(m.updated_at)]})]})]})]})},m.id)})}),e.jsx(be,{isOpen:!!s,onClose:()=>i(null),onConfirm:r,title:"Delete Template",message:`Are you sure you want to delete the template "${s==null?void 0:s.title}"? This action cannot be undone.`,confirmLabel:"Delete Template",variant:"danger",loading:o})]})},Ve=[{id:"host",label:"Single Host",description:"Exclude a single IP address",placeholder:"192.168.1.1",icon:e.jsx(ms,{className:"h-4 w-4"})},{id:"cidr",label:"CIDR Range",description:"Exclude a network range",placeholder:"192.168.1.0/24",icon:e.jsx(ut,{className:"h-4 w-4"})},{id:"hostname",label:"Hostname Pattern",description:"Exclude by hostname (supports wildcards)",placeholder:"*.internal.example.com",icon:e.jsx(os,{className:"h-4 w-4"})},{id:"port",label:"Single Port",description:"Exclude a specific port",placeholder:"22",icon:e.jsx(rs,{className:"h-4 w-4"})},{id:"port_range",label:"Port Range",description:"Exclude a range of ports",placeholder:"1-1000",icon:e.jsx(rs,{className:"h-4 w-4"})}],It=()=>{const[c,C]=n.useState([]),[j,g]=n.useState(!0),[b,v]=n.useState(!1),[D,T]=n.useState(!1),[t,a]=n.useState(null),[s,i]=n.useState({name:"",description:"",exclusion_type:"host",value:"",is_global:!0}),[o,E]=n.useState({exclusion_type:"host",values:"",is_global:!0,name_prefix:"Imported"}),[d,I]=n.useState(!1),[A,B]=n.useState(null),[$,L]=n.useState(!1);n.useEffect(()=>{N()},[]);const N=async()=>{g(!0);try{const p=await Me.getAll();C(p.data)}catch(p){l.error("Failed to load exclusions"),console.error(p)}finally{g(!1)}},h=()=>{i({name:"",description:"",exclusion_type:"host",value:"",is_global:!0}),a(null),v(!1)},k=()=>{E({exclusion_type:"host",values:"",is_global:!0,name_prefix:"Imported"}),T(!1)},y=p=>{i({name:p.name,description:p.description||"",exclusion_type:p.exclusion_type,value:p.value,is_global:p.is_global}),a(p.id),v(!0)},O=async p=>{var G,J;if(p.preventDefault(),!s.name.trim()){l.error("Name is required");return}if(!s.value.trim()){l.error("Value is required");return}try{const r={name:s.name.trim(),description:s.description.trim()||void 0,exclusion_type:s.exclusion_type,value:s.value.trim(),is_global:s.is_global};t?(await Me.update(t,r),l.success("Exclusion updated")):(await Me.create(r),l.success("Exclusion created")),h(),N()}catch(r){const F=r;l.error(((J=(G=F.response)==null?void 0:G.data)==null?void 0:J.error)||"Failed to save exclusion")}},_=async()=>{var p,G;if(A){L(!0);try{await Me.delete(A.id),l.success(`Exclusion "${A.name}" deleted`),N(),B(null)}catch(J){const r=J;l.error(((G=(p=r.response)==null?void 0:p.data)==null?void 0:G.error)||"Failed to delete")}finally{L(!1)}}},R=async p=>{var G,J;if(p.preventDefault(),!o.values.trim()){l.error("Please enter values to import");return}if(!o.name_prefix.trim()){l.error("Please enter a name prefix");return}I(!0);try{const F=(await Me.bulkImport({exclusion_type:o.exclusion_type,values:o.values,is_global:o.is_global,name_prefix:o.name_prefix.trim()})).data;F.imported>0&&l.success(`Imported ${F.imported} exclusion(s)`),F.failed>0&&(l.warning(`${F.failed} value(s) failed to import`),F.errors.slice(0,3).forEach(V=>{l.error(V,{autoClose:5e3})})),k(),N()}catch(r){const F=r;l.error(((J=(G=F.response)==null?void 0:G.data)==null?void 0:J.error)||"Failed to bulk import")}finally{I(!1)}},f=()=>o.values.trim()?o.values.split(/[,\n;]/).map(p=>p.trim()).filter(p=>p.length>0).length:0,w=p=>Ve.find(G=>G.id===p)||Ve[0],x=c.filter(p=>p.is_global),P=c.filter(p=>!p.is_global);return j?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scan Exclusions"})]}),!b&&!D&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"secondary",onClick:()=>T(!0),children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Bulk Import"]}),e.jsxs(M,{variant:"primary",onClick:()=>v(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"New Exclusion"]})]})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Configure hosts and ports to exclude from scans. Global exclusions apply to all scans automatically."})]}),b&&e.jsx(z,{children:e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:t?"Edit Exclusion":"Create Exclusion"}),e.jsx("button",{type:"button",onClick:h,className:"text-slate-400 hover:text-white",children:e.jsx(fe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:p=>i({...s,name:p.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Development Servers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Type"}),e.jsx("select",{value:s.exclusion_type,onChange:p=>i({...s,exclusion_type:p.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Ve.map(p=>e.jsx("option",{value:p.id,children:p.label},p.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Value"}),e.jsx("input",{type:"text",value:s.value,onChange:p=>i({...s,value:p.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono",placeholder:w(s.exclusion_type).placeholder}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:w(s.exclusion_type).description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description (optional)"}),e.jsx("input",{type:"text",value:s.description,onChange:p=>i({...s,description:p.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Why is this excluded?"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.is_global,onChange:p=>i({...s,is_global:p.target.checked}),className:"w-4 h-4 rounded bg-dark-bg border-dark-border text-primary focus:ring-primary focus:ring-offset-dark-bg"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Apply to all scans (global exclusion)"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(ls,{className:"h-3 w-3"}),e.jsx("span",{children:"Non-global exclusions can be selected per-scan"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(M,{type:"button",variant:"secondary",onClick:h,children:"Cancel"}),e.jsxs(M,{type:"submit",variant:"primary",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),t?"Update":"Create"]})]})]})}),D&&e.jsx(z,{children:e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-5 w-5 text-cyan-400"}),e.jsx("h4",{className:"text-lg font-medium text-white",children:"Bulk Import Exclusions"})]}),e.jsx("button",{type:"button",onClick:k,className:"text-slate-400 hover:text-white",children:e.jsx(fe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Exclusion Type"}),e.jsx("select",{value:o.exclusion_type,onChange:p=>E({...o,exclusion_type:p.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:Ve.map(p=>e.jsx("option",{value:p.id,children:p.label},p.id))}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:w(o.exclusion_type).description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name Prefix"}),e.jsx("input",{type:"text",value:o.name_prefix,onChange:p=>E({...o,name_prefix:p.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Imported"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:['Exclusions will be named "',o.name_prefix||"Imported",' 1", "',o.name_prefix||"Imported",' 2", etc.']})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Values"}),e.jsxs("span",{className:"text-xs text-slate-500",children:[f()," value(s) detected"]})]}),e.jsx("textarea",{value:o.values,onChange:p=>E({...o,values:p.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:6,placeholder:`Paste values here, one per line or comma-separated.

Example for IPs:
192.168.1.1
192.168.1.2
10.0.0.0/8

Example for ports:
22, 23, 135, 139, 445`})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o.is_global,onChange:p=>E({...o,is_global:p.target.checked}),className:"w-4 h-4 rounded bg-dark-bg border-dark-border text-primary focus:ring-primary focus:ring-offset-dark-bg"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Apply to all scans (global exclusions)"})]})}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(ls,{className:"h-3 w-3"}),e.jsx("span",{children:"Separate values with commas, newlines, or semicolons"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(M,{type:"button",variant:"secondary",onClick:k,children:"Cancel"}),e.jsxs(M,{type:"submit",variant:"primary",loading:d,disabled:f()===0,children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Import ",f()>0?`(${f()})`:""]})]})]})]})}),c.length===0&&!b&&!D?e.jsx(z,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ss,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No exclusions configured"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create exclusions to skip specific hosts or ports during scans"})]})}):e.jsxs(e.Fragment,{children:[x.length>0&&e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(os,{className:"h-4 w-4 text-green-400"}),e.jsx("h4",{className:"font-medium text-white",children:"Global Exclusions"}),e.jsx("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-0.5 rounded",children:"Applied to all scans"})]}),e.jsx("div",{className:"space-y-2",children:x.map(p=>e.jsx(js,{exclusion:p,onEdit:y,onDelete:B},p.id))})]}),P.length>0&&e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ms,{className:"h-4 w-4 text-blue-400"}),e.jsx("h4",{className:"font-medium text-white",children:"Per-Scan Exclusions"}),e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded",children:"Select when creating scans"})]}),e.jsx("div",{className:"space-y-2",children:P.map(p=>e.jsx(js,{exclusion:p,onEdit:y,onDelete:B},p.id))})]})]}),e.jsx(be,{isOpen:!!A,onClose:()=>B(null),onConfirm:_,title:"Delete Exclusion",message:`Are you sure you want to delete the exclusion "${A==null?void 0:A.name}"? This cannot be undone.`,confirmLabel:"Delete Exclusion",variant:"danger",loading:$})]})},js=({exclusion:c,onEdit:C,onDelete:j})=>{const g=Ve.find(v=>v.id===c.exclusion_type),b=v=>{switch(v){case"host":case"cidr":return"bg-purple-500/20 text-purple-400";case"hostname":return"bg-cyan-500/20 text-cyan-400";case"port":case"port_range":return"bg-orange-500/20 text-orange-400";default:return"bg-slate-500/20 text-slate-400"}};return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"text-slate-400",children:g==null?void 0:g.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:c.name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${b(c.exclusion_type)}`,children:(g==null?void 0:g.label)||c.exclusion_type})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("code",{className:"text-sm font-mono text-slate-300 bg-dark-surface px-2 py-0.5 rounded",children:c.value}),c.description&&e.jsx("span",{className:"text-xs text-slate-500 truncate",children:c.description})]})]})]}),e.jsxs("div",{className:"flex gap-1 ml-4",children:[e.jsx("button",{onClick:()=>C(c),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit exclusion",children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>j(c),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete exclusion",children:e.jsx(ie,{className:"h-4 w-4"})})]})]})};var Ft=Object.defineProperty,Qe=Object.getOwnPropertySymbols,Ls=Object.prototype.hasOwnProperty,Us=Object.prototype.propertyIsEnumerable,ys=(c,C,j)=>C in c?Ft(c,C,{enumerable:!0,configurable:!0,writable:!0,value:j}):c[C]=j,ns=(c,C)=>{for(var j in C||(C={}))Ls.call(C,j)&&ys(c,j,C[j]);if(Qe)for(var j of Qe(C))Us.call(C,j)&&ys(c,j,C[j]);return c},is=(c,C)=>{var j={};for(var g in c)Ls.call(c,g)&&C.indexOf(g)<0&&(j[g]=c[g]);if(c!=null&&Qe)for(var g of Qe(c))C.indexOf(g)<0&&Us.call(c,g)&&(j[g]=c[g]);return j};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Ce;(c=>{const C=class Y{constructor(t,a,s,i){if(this.version=t,this.errorCorrectionLevel=a,this.modules=[],this.isFunction=[],t<Y.MIN_VERSION||t>Y.MAX_VERSION)throw new RangeError("Version value out of range");if(i<-1||i>7)throw new RangeError("Mask value out of range");this.size=t*4+17;let o=[];for(let d=0;d<this.size;d++)o.push(!1);for(let d=0;d<this.size;d++)this.modules.push(o.slice()),this.isFunction.push(o.slice());this.drawFunctionPatterns();const E=this.addEccAndInterleave(s);if(this.drawCodewords(E),i==-1){let d=1e9;for(let I=0;I<8;I++){this.applyMask(I),this.drawFormatBits(I);const A=this.getPenaltyScore();A<d&&(i=I,d=A),this.applyMask(I)}}b(0<=i&&i<=7),this.mask=i,this.applyMask(i),this.drawFormatBits(i),this.isFunction=[]}static encodeText(t,a){const s=c.QrSegment.makeSegments(t);return Y.encodeSegments(s,a)}static encodeBinary(t,a){const s=c.QrSegment.makeBytes(t);return Y.encodeSegments([s],a)}static encodeSegments(t,a,s=1,i=40,o=-1,E=!0){if(!(Y.MIN_VERSION<=s&&s<=i&&i<=Y.MAX_VERSION)||o<-1||o>7)throw new RangeError("Invalid value");let d,I;for(d=s;;d++){const L=Y.getNumDataCodewords(d,a)*8,N=D.getTotalBits(t,d);if(N<=L){I=N;break}if(d>=i)throw new RangeError("Data too long")}for(const L of[Y.Ecc.MEDIUM,Y.Ecc.QUARTILE,Y.Ecc.HIGH])E&&I<=Y.getNumDataCodewords(d,L)*8&&(a=L);let A=[];for(const L of t){j(L.mode.modeBits,4,A),j(L.numChars,L.mode.numCharCountBits(d),A);for(const N of L.getData())A.push(N)}b(A.length==I);const B=Y.getNumDataCodewords(d,a)*8;b(A.length<=B),j(0,Math.min(4,B-A.length),A),j(0,(8-A.length%8)%8,A),b(A.length%8==0);for(let L=236;A.length<B;L^=253)j(L,8,A);let $=[];for(;$.length*8<A.length;)$.push(0);return A.forEach((L,N)=>$[N>>>3]|=L<<7-(N&7)),new Y(d,a,$,o)}getModule(t,a){return 0<=t&&t<this.size&&0<=a&&a<this.size&&this.modules[a][t]}getModules(){return this.modules}drawFunctionPatterns(){for(let s=0;s<this.size;s++)this.setFunctionModule(6,s,s%2==0),this.setFunctionModule(s,6,s%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const t=this.getAlignmentPatternPositions(),a=t.length;for(let s=0;s<a;s++)for(let i=0;i<a;i++)s==0&&i==0||s==0&&i==a-1||s==a-1&&i==0||this.drawAlignmentPattern(t[s],t[i]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){const a=this.errorCorrectionLevel.formatBits<<3|t;let s=a;for(let o=0;o<10;o++)s=s<<1^(s>>>9)*1335;const i=(a<<10|s)^21522;b(i>>>15==0);for(let o=0;o<=5;o++)this.setFunctionModule(8,o,g(i,o));this.setFunctionModule(8,7,g(i,6)),this.setFunctionModule(8,8,g(i,7)),this.setFunctionModule(7,8,g(i,8));for(let o=9;o<15;o++)this.setFunctionModule(14-o,8,g(i,o));for(let o=0;o<8;o++)this.setFunctionModule(this.size-1-o,8,g(i,o));for(let o=8;o<15;o++)this.setFunctionModule(8,this.size-15+o,g(i,o));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let s=0;s<12;s++)t=t<<1^(t>>>11)*7973;const a=this.version<<12|t;b(a>>>18==0);for(let s=0;s<18;s++){const i=g(a,s),o=this.size-11+s%3,E=Math.floor(s/3);this.setFunctionModule(o,E,i),this.setFunctionModule(E,o,i)}}drawFinderPattern(t,a){for(let s=-4;s<=4;s++)for(let i=-4;i<=4;i++){const o=Math.max(Math.abs(i),Math.abs(s)),E=t+i,d=a+s;0<=E&&E<this.size&&0<=d&&d<this.size&&this.setFunctionModule(E,d,o!=2&&o!=4)}}drawAlignmentPattern(t,a){for(let s=-2;s<=2;s++)for(let i=-2;i<=2;i++)this.setFunctionModule(t+i,a+s,Math.max(Math.abs(i),Math.abs(s))!=1)}setFunctionModule(t,a,s){this.modules[a][t]=s,this.isFunction[a][t]=!0}addEccAndInterleave(t){const a=this.version,s=this.errorCorrectionLevel;if(t.length!=Y.getNumDataCodewords(a,s))throw new RangeError("Invalid argument");const i=Y.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][a],o=Y.ECC_CODEWORDS_PER_BLOCK[s.ordinal][a],E=Math.floor(Y.getNumRawDataModules(a)/8),d=i-E%i,I=Math.floor(E/i);let A=[];const B=Y.reedSolomonComputeDivisor(o);for(let L=0,N=0;L<i;L++){let h=t.slice(N,N+I-o+(L<d?0:1));N+=h.length;const k=Y.reedSolomonComputeRemainder(h,B);L<d&&h.push(0),A.push(h.concat(k))}let $=[];for(let L=0;L<A[0].length;L++)A.forEach((N,h)=>{(L!=I-o||h>=d)&&$.push(N[L])});return b($.length==E),$}drawCodewords(t){if(t.length!=Math.floor(Y.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let a=0;for(let s=this.size-1;s>=1;s-=2){s==6&&(s=5);for(let i=0;i<this.size;i++)for(let o=0;o<2;o++){const E=s-o,I=(s+1&2)==0?this.size-1-i:i;!this.isFunction[I][E]&&a<t.length*8&&(this.modules[I][E]=g(t[a>>>3],7-(a&7)),a++)}}b(a==t.length*8)}applyMask(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(let a=0;a<this.size;a++)for(let s=0;s<this.size;s++){let i;switch(t){case 0:i=(s+a)%2==0;break;case 1:i=a%2==0;break;case 2:i=s%3==0;break;case 3:i=(s+a)%3==0;break;case 4:i=(Math.floor(s/3)+Math.floor(a/2))%2==0;break;case 5:i=s*a%2+s*a%3==0;break;case 6:i=(s*a%2+s*a%3)%2==0;break;case 7:i=((s+a)%2+s*a%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[a][s]&&i&&(this.modules[a][s]=!this.modules[a][s])}}getPenaltyScore(){let t=0;for(let o=0;o<this.size;o++){let E=!1,d=0,I=[0,0,0,0,0,0,0];for(let A=0;A<this.size;A++)this.modules[o][A]==E?(d++,d==5?t+=Y.PENALTY_N1:d>5&&t++):(this.finderPenaltyAddHistory(d,I),E||(t+=this.finderPenaltyCountPatterns(I)*Y.PENALTY_N3),E=this.modules[o][A],d=1);t+=this.finderPenaltyTerminateAndCount(E,d,I)*Y.PENALTY_N3}for(let o=0;o<this.size;o++){let E=!1,d=0,I=[0,0,0,0,0,0,0];for(let A=0;A<this.size;A++)this.modules[A][o]==E?(d++,d==5?t+=Y.PENALTY_N1:d>5&&t++):(this.finderPenaltyAddHistory(d,I),E||(t+=this.finderPenaltyCountPatterns(I)*Y.PENALTY_N3),E=this.modules[A][o],d=1);t+=this.finderPenaltyTerminateAndCount(E,d,I)*Y.PENALTY_N3}for(let o=0;o<this.size-1;o++)for(let E=0;E<this.size-1;E++){const d=this.modules[o][E];d==this.modules[o][E+1]&&d==this.modules[o+1][E]&&d==this.modules[o+1][E+1]&&(t+=Y.PENALTY_N2)}let a=0;for(const o of this.modules)a=o.reduce((E,d)=>E+(d?1:0),a);const s=this.size*this.size,i=Math.ceil(Math.abs(a*20-s*10)/s)-1;return b(0<=i&&i<=9),t+=i*Y.PENALTY_N4,b(0<=t&&t<=2568888),t}getAlignmentPatternPositions(){if(this.version==1)return[];{const t=Math.floor(this.version/7)+2,a=this.version==32?26:Math.ceil((this.version*4+4)/(t*2-2))*2;let s=[6];for(let i=this.size-7;s.length<t;i-=a)s.splice(1,0,i);return s}}static getNumRawDataModules(t){if(t<Y.MIN_VERSION||t>Y.MAX_VERSION)throw new RangeError("Version number out of range");let a=(16*t+128)*t+64;if(t>=2){const s=Math.floor(t/7)+2;a-=(25*s-10)*s-55,t>=7&&(a-=36)}return b(208<=a&&a<=29648),a}static getNumDataCodewords(t,a){return Math.floor(Y.getNumRawDataModules(t)/8)-Y.ECC_CODEWORDS_PER_BLOCK[a.ordinal][t]*Y.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw new RangeError("Degree out of range");let a=[];for(let i=0;i<t-1;i++)a.push(0);a.push(1);let s=1;for(let i=0;i<t;i++){for(let o=0;o<a.length;o++)a[o]=Y.reedSolomonMultiply(a[o],s),o+1<a.length&&(a[o]^=a[o+1]);s=Y.reedSolomonMultiply(s,2)}return a}static reedSolomonComputeRemainder(t,a){let s=a.map(i=>0);for(const i of t){const o=i^s.shift();s.push(0),a.forEach((E,d)=>s[d]^=Y.reedSolomonMultiply(E,o))}return s}static reedSolomonMultiply(t,a){if(t>>>8||a>>>8)throw new RangeError("Byte out of range");let s=0;for(let i=7;i>=0;i--)s=s<<1^(s>>>7)*285,s^=(a>>>i&1)*t;return b(s>>>8==0),s}finderPenaltyCountPatterns(t){const a=t[1];b(a<=this.size*3);const s=a>0&&t[2]==a&&t[3]==a*3&&t[4]==a&&t[5]==a;return(s&&t[0]>=a*4&&t[6]>=a?1:0)+(s&&t[6]>=a*4&&t[0]>=a?1:0)}finderPenaltyTerminateAndCount(t,a,s){return t&&(this.finderPenaltyAddHistory(a,s),a=0),a+=this.size,this.finderPenaltyAddHistory(a,s),this.finderPenaltyCountPatterns(s)}finderPenaltyAddHistory(t,a){a[0]==0&&(t+=this.size),a.pop(),a.unshift(t)}};C.MIN_VERSION=1,C.MAX_VERSION=40,C.PENALTY_N1=3,C.PENALTY_N2=3,C.PENALTY_N3=40,C.PENALTY_N4=10,C.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],C.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],c.QrCode=C;function j(T,t,a){if(t<0||t>31||T>>>t)throw new RangeError("Value out of range");for(let s=t-1;s>=0;s--)a.push(T>>>s&1)}function g(T,t){return(T>>>t&1)!=0}function b(T){if(!T)throw new Error("Assertion error")}const v=class se{constructor(t,a,s){if(this.mode=t,this.numChars=a,this.bitData=s,a<0)throw new RangeError("Invalid argument");this.bitData=s.slice()}static makeBytes(t){let a=[];for(const s of t)j(s,8,a);return new se(se.Mode.BYTE,t.length,a)}static makeNumeric(t){if(!se.isNumeric(t))throw new RangeError("String contains non-numeric characters");let a=[];for(let s=0;s<t.length;){const i=Math.min(t.length-s,3);j(parseInt(t.substring(s,s+i),10),i*3+1,a),s+=i}return new se(se.Mode.NUMERIC,t.length,a)}static makeAlphanumeric(t){if(!se.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");let a=[],s;for(s=0;s+2<=t.length;s+=2){let i=se.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s))*45;i+=se.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s+1)),j(i,11,a)}return s<t.length&&j(se.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s)),6,a),new se(se.Mode.ALPHANUMERIC,t.length,a)}static makeSegments(t){return t==""?[]:se.isNumeric(t)?[se.makeNumeric(t)]:se.isAlphanumeric(t)?[se.makeAlphanumeric(t)]:[se.makeBytes(se.toUtf8ByteArray(t))]}static makeEci(t){let a=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)j(t,8,a);else if(t<16384)j(2,2,a),j(t,14,a);else if(t<1e6)j(6,3,a),j(t,21,a);else throw new RangeError("ECI assignment value out of range");return new se(se.Mode.ECI,0,a)}static isNumeric(t){return se.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return se.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(t,a){let s=0;for(const i of t){const o=i.mode.numCharCountBits(a);if(i.numChars>=1<<o)return 1/0;s+=4+o+i.bitData.length}return s}static toUtf8ByteArray(t){t=encodeURI(t);let a=[];for(let s=0;s<t.length;s++)t.charAt(s)!="%"?a.push(t.charCodeAt(s)):(a.push(parseInt(t.substring(s+1,s+3),16)),s+=2);return a}};v.NUMERIC_REGEX=/^[0-9]*$/,v.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,v.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let D=v;c.QrSegment=v})(Ce||(Ce={}));(c=>{(C=>{const j=class{constructor(b,v){this.ordinal=b,this.formatBits=v}};j.LOW=new j(0,1),j.MEDIUM=new j(1,0),j.QUARTILE=new j(2,3),j.HIGH=new j(3,2),C.Ecc=j})(c.QrCode||(c.QrCode={}))})(Ce||(Ce={}));(c=>{(C=>{const j=class{constructor(b,v){this.modeBits=b,this.numBitsCharCount=v}numCharCountBits(b){return this.numBitsCharCount[Math.floor((b+7)/17)]}};j.NUMERIC=new j(1,[10,12,14]),j.ALPHANUMERIC=new j(2,[9,11,13]),j.BYTE=new j(4,[8,16,16]),j.KANJI=new j(8,[8,10,12]),j.ECI=new j(7,[0,0,0]),C.Mode=j})(c.QrSegment||(c.QrSegment={}))})(Ce||(Ce={}));var Fe=Ce;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Dt={L:Fe.QrCode.Ecc.LOW,M:Fe.QrCode.Ecc.MEDIUM,Q:Fe.QrCode.Ecc.QUARTILE,H:Fe.QrCode.Ecc.HIGH},Os=128,$s="L",Vs="#FFFFFF",zs="#000000",Bs=!1,Hs=1,Rt=4,Tt=0,Mt=.1;function Ws(c,C=0){const j=[];return c.forEach(function(g,b){let v=null;g.forEach(function(D,T){if(!D&&v!==null){j.push(`M${v+C} ${b+C}h${T-v}v1H${v+C}z`),v=null;return}if(T===g.length-1){if(!D)return;v===null?j.push(`M${T+C},${b+C} h1v1H${T+C}z`):j.push(`M${v+C},${b+C} h${T+1-v}v1H${v+C}z`);return}D&&v===null&&(v=T)})}),j.join("")}function Gs(c,C){return c.slice().map((j,g)=>g<C.y||g>=C.y+C.h?j:j.map((b,v)=>v<C.x||v>=C.x+C.w?b:!1))}function Lt(c,C,j,g){if(g==null)return null;const b=c.length+j*2,v=Math.floor(C*Mt),D=b/C,T=(g.width||v)*D,t=(g.height||v)*D,a=g.x==null?c.length/2-T/2:g.x*D,s=g.y==null?c.length/2-t/2:g.y*D,i=g.opacity==null?1:g.opacity;let o=null;if(g.excavate){let d=Math.floor(a),I=Math.floor(s),A=Math.ceil(T+a-d),B=Math.ceil(t+s-I);o={x:d,y:I,w:A,h:B}}const E=g.crossOrigin;return{x:a,y:s,h:t,w:T,excavation:o,opacity:i,crossOrigin:E}}function Ut(c,C){return C!=null?Math.max(Math.floor(C),0):c?Rt:Tt}function qs({value:c,level:C,minVersion:j,includeMargin:g,marginSize:b,imageSettings:v,size:D,boostLevel:T}){let t=te.useMemo(()=>{const d=(Array.isArray(c)?c:[c]).reduce((I,A)=>(I.push(...Fe.QrSegment.makeSegments(A)),I),[]);return Fe.QrCode.encodeSegments(d,Dt[C],j,void 0,void 0,T)},[c,C,j,T]);const{cells:a,margin:s,numCells:i,calculatedImageSettings:o}=te.useMemo(()=>{let E=t.getModules();const d=Ut(g,b),I=E.length+d*2,A=Lt(E,D,d,v);return{cells:E,margin:d,numCells:I,calculatedImageSettings:A}},[t,D,v,g,b]);return{qrcode:t,margin:s,cells:a,numCells:i,calculatedImageSettings:o}}var Ot=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),$t=te.forwardRef(function(C,j){const g=C,{value:b,size:v=Os,level:D=$s,bgColor:T=Vs,fgColor:t=zs,includeMargin:a=Bs,minVersion:s=Hs,boostLevel:i,marginSize:o,imageSettings:E}=g,I=is(g,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:A}=I,B=is(I,["style"]),$=E==null?void 0:E.src,L=te.useRef(null),N=te.useRef(null),h=te.useCallback(P=>{L.current=P,typeof j=="function"?j(P):j&&(j.current=P)},[j]),[k,y]=te.useState(!1),{margin:O,cells:_,numCells:R,calculatedImageSettings:f}=qs({value:b,level:D,minVersion:s,boostLevel:i,includeMargin:a,marginSize:o,imageSettings:E,size:v});te.useEffect(()=>{if(L.current!=null){const P=L.current,p=P.getContext("2d");if(!p)return;let G=_;const J=N.current,r=f!=null&&J!==null&&J.complete&&J.naturalHeight!==0&&J.naturalWidth!==0;r&&f.excavation!=null&&(G=Gs(_,f.excavation));const F=window.devicePixelRatio||1;P.height=P.width=v*F;const V=v/R*F;p.scale(V,V),p.fillStyle=T,p.fillRect(0,0,R,R),p.fillStyle=t,Ot?p.fill(new Path2D(Ws(G,O))):_.forEach(function(u,U){u.forEach(function(W,H){W&&p.fillRect(H+O,U+O,1,1)})}),f&&(p.globalAlpha=f.opacity),r&&p.drawImage(J,f.x+O,f.y+O,f.w,f.h)}}),te.useEffect(()=>{y(!1)},[$]);const w=ns({height:v,width:v},A);let x=null;return $!=null&&(x=te.createElement("img",{src:$,key:$,style:{display:"none"},onLoad:()=>{y(!0)},ref:N,crossOrigin:f==null?void 0:f.crossOrigin})),te.createElement(te.Fragment,null,te.createElement("canvas",ns({style:w,height:v,width:v,ref:h,role:"img"},B)),x)});$t.displayName="QRCodeCanvas";var Js=te.forwardRef(function(C,j){const g=C,{value:b,size:v=Os,level:D=$s,bgColor:T=Vs,fgColor:t=zs,includeMargin:a=Bs,minVersion:s=Hs,boostLevel:i,title:o,marginSize:E,imageSettings:d}=g,I=is(g,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:A,cells:B,numCells:$,calculatedImageSettings:L}=qs({value:b,level:D,minVersion:s,boostLevel:i,includeMargin:a,marginSize:E,imageSettings:d,size:v});let N=B,h=null;d!=null&&L!=null&&(L.excavation!=null&&(N=Gs(B,L.excavation)),h=te.createElement("image",{href:d.src,height:L.h,width:L.w,x:L.x+A,y:L.y+A,preserveAspectRatio:"none",opacity:L.opacity,crossOrigin:L.crossOrigin}));const k=Ws(N,A);return te.createElement("svg",ns({height:v,width:v,viewBox:`0 0 ${$} ${$}`,ref:j,role:"img"},I),!!o&&te.createElement("title",null,o),te.createElement("path",{fill:T,d:`M0,0 h${$}v${$}H0z`,shapeRendering:"crispEdges"}),te.createElement("path",{fill:t,d:k,shapeRendering:"crispEdges"}),h)});Js.displayName="QRCodeSVG";const Vt=()=>{const[c,C]=n.useState(!1),[j,g]=n.useState(!0),[b,v]=n.useState("idle"),[D,T]=n.useState(""),[t,a]=n.useState(""),[s,i]=n.useState([]),[o,E]=n.useState(""),[d,I]=n.useState(!1),[A,B]=n.useState(!1),[$,L]=n.useState(""),[N,h]=n.useState(""),[k,y]=n.useState(!1),[O,_]=n.useState(!1),[R,f]=n.useState(""),[w,x]=n.useState(""),[P,p]=n.useState(!1);n.useEffect(()=>{G()},[]);const G=async()=>{g(!0);try{const H=await He.me();C(H.data.mfa_enabled||!1)}catch(H){console.error("Failed to check MFA status:",H)}finally{g(!1)}},J=async()=>{var H,K;try{const m=await Be.setup();T(m.data.secret),a(m.data.qr_code_url),i(m.data.recovery_codes),v("scan-qr")}catch(m){const q=m;l.error(((K=(H=q.response)==null?void 0:H.data)==null?void 0:K.error)||"Failed to initialize MFA setup")}},r=async H=>{var K,m;if(H.preventDefault(),!o||o.length!==6){l.error("Please enter a valid 6-digit code");return}I(!0);try{await Be.verifySetup({totp_code:o}),l.success("MFA enabled successfully!"),v("show-recovery"),C(!0)}catch(q){const Q=q;l.error(((m=(K=Q.response)==null?void 0:K.data)==null?void 0:m.error)||"Invalid verification code")}finally{I(!1)}},F=()=>{v("idle"),T(""),a(""),i([]),E("")},V=async H=>{var K,m;if(H.preventDefault(),!$||!N){l.error("Password and TOTP code are required");return}y(!0);try{await Be.disable({password:$,totp_code:N}),l.success("MFA disabled successfully"),C(!1),B(!1),L(""),h("")}catch(q){const Q=q;l.error(((m=(K=Q.response)==null?void 0:K.data)==null?void 0:m.error)||"Failed to disable MFA")}finally{y(!1)}},u=async H=>{var K,m;if(H.preventDefault(),!R||!w){l.error("Password and TOTP code are required");return}p(!0);try{const q=await Be.regenerateRecoveryCodes({password:R,totp_code:w});i(q.data.recovery_codes),l.success("Recovery codes regenerated successfully"),_(!1),f(""),x(""),v("show-recovery")}catch(q){const Q=q;l.error(((m=(K=Q.response)==null?void 0:K.data)==null?void 0:m.error)||"Failed to regenerate recovery codes")}finally{p(!1)}},U=H=>{navigator.clipboard.writeText(H),l.success("Copied to clipboard")},W=()=>{const H=new Blob([s.join(`
`)],{type:"text/plain"}),K=URL.createObjectURL(H),m=document.createElement("a");m.href=K,m.download="heroforge-recovery-codes.txt",document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(K),l.success("Recovery codes downloaded")};return j?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):b!=="idle"?e.jsx("div",{className:"space-y-6",children:e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xe,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Enable Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{className:b==="scan-qr"?"text-primary":"",children:"1. Scan QR"}),e.jsx("span",{children:""}),e.jsx("span",{className:b==="verify-code"?"text-primary":"",children:"2. Verify"}),e.jsx("span",{children:""}),e.jsx("span",{className:b==="show-recovery"?"text-primary":"",children:"3. Save Codes"})]})]}),b==="scan-qr"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 1: Scan QR Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Use an authenticator app like Google Authenticator, Authy, or 1Password to scan this QR code:"}),t&&e.jsx("div",{className:"bg-white p-4 rounded-lg mb-4",children:e.jsx(Js,{value:t,size:256,level:"M",marginSize:2})}),e.jsxs("div",{className:"mt-4 w-full max-w-md",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Or enter this secret manually:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ee,{type:"text",value:D,readOnly:!0,className:"font-mono text-sm flex-1"}),e.jsx(M,{variant:"secondary",onClick:()=>U(D),children:e.jsx(Re,{className:"h-4 w-4"})})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(M,{variant:"primary",onClick:()=>v("verify-code"),children:"Next: Verify Code"})})]}),b==="verify-code"&&e.jsxs("form",{onSubmit:r,className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(us,{className:"h-12 w-12 text-primary mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 2: Verify Your Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Enter the 6-digit code from your authenticator app to confirm setup:"}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsx(ee,{type:"text",value:o,onChange:H=>E(H.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center text-2xl tracking-widest font-mono",maxLength:6,autoFocus:!0})})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(M,{type:"button",variant:"secondary",onClick:()=>v("scan-qr"),children:"Back"}),e.jsx(M,{type:"submit",variant:"primary",loading:d,disabled:d||o.length!==6,children:"Verify & Enable MFA"})]})]}),b==="show-recovery"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(me,{className:"h-6 w-6 text-yellow-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-yellow-400 mb-2",children:"Save Your Recovery Codes"}),e.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Store these recovery codes in a safe place. Each code can be used once to access your account if you lose your authenticator device."}),e.jsx("div",{className:"grid grid-cols-2 gap-2 bg-dark-bg rounded-lg p-4 font-mono text-sm mb-4",children:s.map((H,K)=>e.jsxs("div",{className:"text-white",children:[K+1,". ",H]},K))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"secondary",onClick:()=>U(s.join(`
`)),children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Copy Codes"]}),e.jsxs(M,{variant:"secondary",onClick:W,children:[e.jsx(ht,{className:"h-4 w-4 mr-2"}),"Download Codes"]})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(M,{variant:"primary",onClick:F,children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Finish Setup"]})})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(xe,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-start justify-between mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[c?e.jsx(de,{className:"h-6 w-6 text-green-400 flex-shrink-0"}):e.jsx(me,{className:"h-6 w-6 text-yellow-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white mb-1",children:c?"MFA Enabled":"MFA Disabled"}),e.jsx("p",{className:"text-sm text-slate-400",children:c?"Your account is protected with two-factor authentication.":"Enable MFA to add an extra layer of security to your account."})]})]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${c?"bg-green-400":"bg-yellow-400"}`})]}),c?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ke,{className:"h-5 w-5 text-primary"}),e.jsx("h5",{className:"font-medium text-white",children:"Recovery Codes"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Generate new recovery codes if you've lost the originals or used them."}),e.jsx(M,{variant:"secondary",size:"sm",onClick:()=>_(!0),children:"Regenerate Codes"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ze,{className:"h-5 w-5 text-red-400"}),e.jsx("h5",{className:"font-medium text-white",children:"Disable MFA"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Turn off two-factor authentication for your account."}),e.jsx(M,{variant:"danger",size:"sm",onClick:()=>B(!0),children:"Disable MFA"})]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h5",{className:"text-white font-medium mb-2",children:"Why enable MFA?"}),e.jsxs("ul",{className:"text-sm text-slate-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Adds an extra layer of security beyond your password"}),e.jsx("li",{children:"Prevents unauthorized access even if your password is compromised"}),e.jsx("li",{children:"Uses time-based codes from your smartphone"}),e.jsx("li",{children:"Industry standard for securing sensitive accounts"})]})]}),e.jsxs(M,{variant:"primary",onClick:J,children:[e.jsx(us,{className:"h-4 w-4 mr-2"}),"Enable Two-Factor Authentication"]})]})]}),A&&e.jsx(z,{children:e.jsxs("form",{onSubmit:V,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Disable Two-Factor Authentication"}),e.jsxs("button",{type:"button",onClick:()=>{B(!1),L(""),h("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"Disabling MFA will make your account less secure. You'll need to provide your password and a TOTP code to confirm."})}),e.jsx(ee,{label:"Password",type:"password",value:$,onChange:H=>L(H.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(ee,{label:"TOTP Code",type:"text",value:N,onChange:H=>h(H.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(M,{type:"button",variant:"secondary",onClick:()=>{B(!1),L(""),h("")},children:"Cancel"}),e.jsx(M,{type:"submit",variant:"danger",loading:k,disabled:k||!$||N.length!==6,children:"Disable MFA"})]})]})}),O&&e.jsx(z,{children:e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Regenerate Recovery Codes"}),e.jsxs("button",{type:"button",onClick:()=>{_(!1),f(""),x("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"This will invalidate all existing recovery codes. Make sure to save the new codes in a safe place."})}),e.jsx(ee,{label:"Password",type:"password",value:R,onChange:H=>f(H.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(ee,{label:"TOTP Code",type:"text",value:w,onChange:H=>x(H.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(M,{type:"button",variant:"secondary",onClick:()=>{_(!1),f(""),x("")},children:"Cancel"}),e.jsx(M,{type:"submit",variant:"primary",loading:P,disabled:P||!R||w.length!==6,children:"Generate New Codes"})]})]})})]})},zt=()=>{const[c,C]=n.useState([]),[j,g]=n.useState(!0),[b,v]=n.useState(!1),[D,T]=n.useState(""),[t,a]=n.useState(!1),[s,i]=n.useState(null),[o,E]=n.useState(null),[d,I]=n.useState(!1);n.useEffect(()=>{A()},[]);const A=async()=>{g(!0);try{const h=await es.getAll();C(h.data)}catch(h){l.error("Failed to load API keys"),console.error(h)}finally{g(!1)}},B=async()=>{var h,k;if(!D.trim()){l.error("Please enter a name for the API key");return}a(!0);try{const y=await es.create({name:D.trim()});i(y.data),T(""),await A(),l.success("API key created successfully")}catch(y){const O=y;l.error(((k=(h=O.response)==null?void 0:h.data)==null?void 0:k.error)||"Failed to create API key")}finally{a(!1)}},$=async()=>{var h,k;if(o){I(!0);try{await es.delete(o.id),await A(),l.success(`API key "${o.name}" revoked successfully`),E(null)}catch(y){const O=y;l.error(((k=(h=O.response)==null?void 0:h.data)==null?void 0:k.error)||"Failed to revoke API key")}finally{I(!1)}}},L=h=>{navigator.clipboard.writeText(h),l.success("API key copied to clipboard")},N=()=>{i(null),v(!1)};return j?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Keys"})]}),e.jsxs(M,{variant:"primary",onClick:()=>v(!0),className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"Create API Key"]})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"API keys allow programmatic access to HeroForge. Keep your keys secure and never share them publicly."}),c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ke,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No API keys yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Create your first API key to get started"})]}):e.jsx("div",{className:"space-y-3",children:c.map(h=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary/30 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-medium text-white",children:h.name}),e.jsxs("code",{className:"px-2 py-1 bg-dark-surface rounded text-xs text-slate-400 font-mono",children:[h.prefix,"..."]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Xe,{className:"h-3 w-3"}),"Created ",new Date(h.created_at).toLocaleDateString()]}),h.last_used_at&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"h-3 w-3"}),"Last used ",new Date(h.last_used_at).toLocaleDateString()]}),!h.last_used_at&&e.jsx("span",{className:"text-amber-500",children:"Never used"})]})]}),e.jsxs(M,{variant:"danger",size:"sm",onClick:()=>E(h),className:"flex items-center gap-2","aria-label":`Revoke API key ${h.name}`,children:[e.jsx(ie,{className:"h-4 w-4"}),"Revoke"]})]},h.id))})]}),b&&!s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Create API Key"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Key Name"}),e.jsx("input",{type:"text",value:D,onChange:h=>T(h.target.value),placeholder:"e.g., Production Server, CI/CD Pipeline",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",autoFocus:!0}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Give your API key a descriptive name to remember where it's used"})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4",children:[e.jsx(M,{variant:"secondary",onClick:()=>{v(!1),T("")},children:"Cancel"}),e.jsx(M,{variant:"primary",onClick:B,disabled:t||!D.trim(),children:t?e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx("span",{className:"ml-2",children:"Creating..."})]}):"Create Key"})]})]})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-2xl w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(de,{className:"h-6 w-6 text-green-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Key Created Successfully"})]}),e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-amber-200 font-medium mb-2",children:"Important: Save your API key now!"}),e.jsx("p",{className:"text-xs text-amber-300/70",children:"This is the only time you'll see the full key. If you lose it, you'll need to create a new one."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"API Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("code",{className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-3 text-white font-mono text-sm break-all",children:s.key}),e.jsxs(M,{variant:"secondary",onClick:()=>L(s.key),className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-4 w-4"}),"Copy"]})]})]}),e.jsxs("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-200 mb-2",children:"Using your API key"}),e.jsx("p",{className:"text-xs text-blue-300/70 mb-3",children:"Include your API key in the X-API-Key header:"}),e.jsxs("code",{className:"block bg-dark-bg border border-dark-border rounded px-3 py-2 text-xs text-slate-300 font-mono",children:['curl -H "X-API-Key: ',s.key,'" https://heroforge.example.com/api/scans']})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(M,{variant:"primary",onClick:N,children:"Done"})})]})]})}),e.jsx(be,{isOpen:!!o,onClose:()=>E(null),onConfirm:$,title:"Revoke API Key",message:`Are you sure you want to revoke the API key "${o==null?void 0:o.name}"? Any applications using this key will lose access immediately.`,confirmLabel:"Revoke Key",variant:"danger",loading:d})]})},Bt=()=>{const[c,C]=n.useState(!0),[j,g]=n.useState(!1),[b,v]=n.useState(!1),[D,T]=n.useState(!1),[t,a]=n.useState({jira_url:"",username:"",api_token:"",project_key:"",issue_type:"Task",default_assignee:"",enabled:!0}),[s,i]=n.useState([]),[o,E]=n.useState([]),[d,I]=n.useState(!1);n.useEffect(()=>{A()},[]);const A=async()=>{var h;C(!0);try{const k=await Le.getSettings();a(k.data),T(!0)}catch(k){((h=k.response)==null?void 0:h.status)===404?T(!1):console.error("Failed to load JIRA settings:",k)}finally{C(!1)}},B=async()=>{var h,k;if(!t.jira_url||!t.username||!t.api_token||!t.project_key){l.error("Please fill in all required fields");return}g(!0);try{await Le.updateSettings(t),l.success("JIRA settings saved successfully"),T(!0)}catch(y){const O=y;console.error("Failed to save JIRA settings:",y),l.error(((k=(h=O.response)==null?void 0:h.data)==null?void 0:k.error)||"Failed to save JIRA settings")}finally{g(!1)}},$=async()=>{var h,k;if(!D){l.error("Please save your settings first");return}v(!0);try{await Le.testConnection(),l.success("JIRA connection successful!")}catch(y){const O=y;console.error("JIRA connection failed:",y),l.error(((k=(h=O.response)==null?void 0:h.data)==null?void 0:k.error)||"JIRA connection failed")}finally{v(!1)}},L=async()=>{var h,k;if(!D){l.error("Please save your settings first");return}I(!0);try{const y=await Le.listProjects();i(y.data),l.success(`Loaded ${y.data.length} projects`)}catch(y){const O=y;console.error("Failed to load projects:",y),l.error(((k=(h=O.response)==null?void 0:h.data)==null?void 0:k.error)||"Failed to load projects")}finally{I(!1)}},N=async()=>{var h,k;if(!D||!t.project_key){l.error("Please save your settings and select a project first");return}I(!0);try{const y=await Le.listIssueTypes();E(y.data),l.success(`Loaded ${y.data.length} issue types`)}catch(y){const O=y;console.error("Failed to load issue types:",y),l.error(((k=(h=O.response)==null?void 0:h.data)==null?void 0:k.error)||"Failed to load issue types")}finally{I(!1)}};return c?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ds,{className:"h-6 w-6 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"JIRA Integration"})]}),e.jsxs("div",{className:"space-y-4",children:[!D&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(me,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"JIRA Integration Not Configured"}),e.jsx("p",{children:"Configure your JIRA instance to automatically create tickets from vulnerabilities."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["JIRA URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{type:"url",placeholder:"https://your-domain.atlassian.net",value:t.jira_url,onChange:h=>a({...t,jira_url:h.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your JIRA instance URL (e.g., https://company.atlassian.net)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Username/Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{type:"text",placeholder:"user@example.com",value:t.username,onChange:h=>a({...t,username:h.target.value})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["API Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{type:"password",placeholder:"Your JIRA API token",value:t.api_token,onChange:h=>a({...t,api_token:h.target.value})}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Generate an API token at"," ",e.jsxs("a",{href:"https://id.atlassian.com/manage-profile/security/api-tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 inline-flex items-center gap-1",children:["Atlassian Account Settings ",e.jsx(Ze,{className:"h-3 w-3"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Key ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:s.length>0?e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:t.project_key,onChange:h=>a({...t,project_key:h.target.value}),children:[e.jsx("option",{value:"",children:"Select a project"}),s.map(h=>e.jsxs("option",{value:h.key,children:[h.name," (",h.key,")"]},h.key))]}):e.jsx(ee,{type:"text",placeholder:"PROJECT",value:t.project_key,onChange:h=>a({...t,project_key:h.target.value})})}),e.jsx(M,{onClick:L,disabled:!D||d,variant:"secondary",children:d?"Loading...":"Load Projects"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Issue Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:o.length>0?e.jsx("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:t.issue_type,onChange:h=>a({...t,issue_type:h.target.value}),children:o.map(h=>e.jsx("option",{value:h.name,children:h.name},h.id))}):e.jsx(ee,{type:"text",placeholder:"Task",value:t.issue_type,onChange:h=>a({...t,issue_type:h.target.value})})}),e.jsx(M,{onClick:N,disabled:!D||!t.project_key||d,variant:"secondary",children:d?"Loading...":"Load Types"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Assignee (optional)"}),e.jsx(ee,{type:"text",placeholder:"username",value:t.default_assignee||"",onChange:h=>a({...t,default_assignee:h.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Leave empty for unassigned or enter a JIRA username"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"jira-enabled",checked:t.enabled,onChange:h=>a({...t,enabled:h.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"jira-enabled",className:"text-sm font-medium text-gray-700",children:"Enable JIRA integration"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(M,{onClick:B,disabled:j,children:j?"Saving...":"Save Settings"}),e.jsx(M,{onClick:$,disabled:!D||b,variant:"secondary",children:b?"Testing...":"Test Connection"})]}),D&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(de,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("p",{className:"font-medium",children:"JIRA Integration Configured"}),e.jsx("p",{children:"You can now create JIRA tickets from vulnerabilities."})]})]})]})]}),e.jsxs(z,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"How to Use JIRA Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Configure your JIRA instance settings above and test the connection."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Navigate to any vulnerability in your scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"3"})}),e.jsx("p",{children:'Click the "Create JIRA Ticket" button to automatically create an issue with vulnerability details.'})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"The vulnerability will be linked to the JIRA ticket, and you can track it in your JIRA project."})]})]})]})]})},Ht=()=>{const[c,C]=n.useState(!0),[j,g]=n.useState(!1),[b,v]=n.useState(!1),[D,T]=n.useState(!1),[t,a]=n.useState({instance_url:"",username:"",password:"",default_assignment_group:"",default_category:"",default_impact:3,default_urgency:3,enabled:!0}),[s,i]=n.useState([]),[o,E]=n.useState([]),[d,I]=n.useState(!1),[A,B]=n.useState(!1);n.useEffect(()=>{$()},[]);const $=async()=>{var _;C(!0);try{const f=(await Ue.getSettings()).data;a({instance_url:f.instance_url||"",username:f.username||"",password:"",default_assignment_group:f.default_assignment_group||"",default_category:f.default_category||"",default_impact:f.default_impact||3,default_urgency:f.default_urgency||3,enabled:f.enabled}),T(!0)}catch(R){((_=R.response)==null?void 0:_.status)===404?T(!1):console.error("Failed to load ServiceNow settings:",R)}finally{C(!1)}},L=async()=>{var _,R;if(!t.instance_url||!t.username||!t.password){l.error("Please fill in all required fields");return}if(!t.instance_url.startsWith("https://")){l.error("Instance URL must start with https://");return}g(!0);try{await Ue.updateSettings({instance_url:t.instance_url,username:t.username,password:t.password,default_assignment_group:t.default_assignment_group||void 0,default_category:t.default_category||void 0,default_impact:t.default_impact,default_urgency:t.default_urgency,enabled:t.enabled}),l.success("ServiceNow settings saved successfully"),T(!0)}catch(f){const w=f;console.error("Failed to save ServiceNow settings:",f),l.error(((R=(_=w.response)==null?void 0:_.data)==null?void 0:R.error)||"Failed to save ServiceNow settings")}finally{g(!1)}},N=async()=>{var _,R;if(!D){l.error("Please save your settings first");return}v(!0);try{await Ue.testConnection(),l.success("ServiceNow connection successful!")}catch(f){const w=f;console.error("ServiceNow connection failed:",f),l.error(((R=(_=w.response)==null?void 0:_.data)==null?void 0:R.error)||"ServiceNow connection failed")}finally{v(!1)}},h=async()=>{var _,R;if(!D){l.error("Please save your settings first");return}I(!0);try{const f=await Ue.getAssignmentGroups();i(f.data),l.success(`Loaded ${f.data.length} assignment groups`)}catch(f){const w=f;console.error("Failed to load assignment groups:",f),l.error(((R=(_=w.response)==null?void 0:_.data)==null?void 0:R.error)||"Failed to load assignment groups")}finally{I(!1)}},k=async()=>{var _,R;if(!D){l.error("Please save your settings first");return}B(!0);try{const f=await Ue.getCategories();E(f.data),l.success(`Loaded ${f.data.length} categories`)}catch(f){const w=f;console.error("Failed to load categories:",f),l.error(((R=(_=w.response)==null?void 0:_.data)==null?void 0:R.error)||"Failed to load categories")}finally{B(!1)}},y=[{value:1,label:"1 - High"},{value:2,label:"2 - Medium"},{value:3,label:"3 - Low"}],O=[{value:1,label:"1 - High"},{value:2,label:"2 - Medium"},{value:3,label:"3 - Low"}];return c?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Ds,{className:"h-6 w-6 text-green-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"ServiceNow Integration"})]}),e.jsxs("div",{className:"space-y-4",children:[!D&&e.jsxs("div",{className:"bg-blue-900/30 border border-blue-700 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(me,{className:"h-5 w-5 text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-300",children:[e.jsx("p",{className:"font-medium mb-1",children:"ServiceNow Integration Not Configured"}),e.jsx("p",{children:"Configure your ServiceNow instance to create incidents and change requests from vulnerabilities."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Instance URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{type:"url",placeholder:"https://yourcompany.service-now.com",value:t.instance_url,onChange:_=>a({...t,instance_url:_.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your ServiceNow instance URL (e.g., https://company.service-now.com)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{type:"text",placeholder:"username",value:t.username,onChange:_=>a({...t,username:_.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"ServiceNow user with API access permissions"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{type:"password",placeholder:D?"********":"Enter password",value:t.password,onChange:_=>a({...t,password:_.target.value})}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Password for the ServiceNow user. Consider using a"," ",e.jsxs("a",{href:"https://docs.servicenow.com/bundle/tokyo-platform-security/page/administer/users/concept/c_OAuthApplications.html",target:"_blank",rel:"noopener noreferrer",className:"text-cyan-400 hover:text-cyan-300 inline-flex items-center gap-1",children:["OAuth token ",e.jsx(Ze,{className:"h-3 w-3"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Assignment Group"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:s.length>0?e.jsxs("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:t.default_assignment_group,onChange:_=>a({...t,default_assignment_group:_.target.value}),children:[e.jsx("option",{value:"",children:"Select an assignment group"}),s.map(_=>e.jsx("option",{value:_.sys_id,children:_.name},_.sys_id))]}):e.jsx(ee,{type:"text",placeholder:"Group sys_id or name",value:t.default_assignment_group,onChange:_=>a({...t,default_assignment_group:_.target.value})})}),e.jsx(M,{onClick:h,disabled:!D||d,variant:"secondary",children:d?"Loading...":"Load Groups"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Category"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:o.length>0?e.jsxs("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:t.default_category,onChange:_=>a({...t,default_category:_.target.value}),children:[e.jsx("option",{value:"",children:"Select a category"}),o.map(_=>e.jsx("option",{value:_.value,children:_.label},_.value))]}):e.jsx(ee,{type:"text",placeholder:"security",value:t.default_category,onChange:_=>a({...t,default_category:_.target.value})})}),e.jsx(M,{onClick:k,disabled:!D||A,variant:"secondary",children:A?"Loading...":"Load Categories"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Impact"}),e.jsx("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:t.default_impact,onChange:_=>a({...t,default_impact:parseInt(_.target.value)}),children:y.map(_=>e.jsx("option",{value:_.value,children:_.label},_.value))}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Auto-calculated from severity when creating tickets"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Urgency"}),e.jsx("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",value:t.default_urgency,onChange:_=>a({...t,default_urgency:parseInt(_.target.value)}),children:O.map(_=>e.jsx("option",{value:_.value,children:_.label},_.value))}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Auto-calculated from severity when creating tickets"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"servicenow-enabled",checked:t.enabled,onChange:_=>a({...t,enabled:_.target.checked}),className:"h-4 w-4 text-cyan-500 focus:ring-cyan-500 border-gray-600 rounded bg-gray-700"}),e.jsx("label",{htmlFor:"servicenow-enabled",className:"text-sm font-medium text-gray-300",children:"Enable ServiceNow integration"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(M,{onClick:L,disabled:j,children:j?"Saving...":"Save Settings"}),e.jsx(M,{onClick:N,disabled:!D||b,variant:"secondary",children:b?"Testing...":"Test Connection"})]}),D&&e.jsxs("div",{className:"bg-green-900/30 border border-green-700 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(de,{className:"h-5 w-5 text-green-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-green-300",children:[e.jsx("p",{className:"font-medium",children:"ServiceNow Integration Configured"}),e.jsx("p",{children:"You can now create incidents and change requests from vulnerabilities."})]})]})]})]}),e.jsxs(z,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-100 mb-4",children:"How to Use ServiceNow Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Configure your ServiceNow instance settings above and test the connection."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Navigate to any vulnerability in your scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"3"})}),e.jsx("p",{children:"Use the ServiceNow dropdown to create an Incident or Change Request with vulnerability details."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-cyan-900/50 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"Tickets are linked to vulnerabilities and can be tracked in HeroForge."})]})]})]}),e.jsxs(z,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-100 mb-4",children:"ServiceNow Table API Reference"}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-2",children:[e.jsx("p",{children:"HeroForge uses the ServiceNow Table API to create tickets:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("code",{className:"text-cyan-400",children:"/api/now/table/incident"})," - Create incidents"]}),e.jsxs("li",{children:[e.jsx("code",{className:"text-cyan-400",children:"/api/now/table/change_request"})," - Create change requests"]}),e.jsxs("li",{children:[e.jsx("code",{className:"text-cyan-400",children:"/api/now/table/sys_user_group"})," - List assignment groups"]})]}),e.jsxs("p",{className:"mt-3",children:["Ensure your ServiceNow user has the following roles: ",e.jsx("code",{className:"text-cyan-400",children:"itil"})," or ",e.jsx("code",{className:"text-cyan-400",children:"rest_api_explorer"}),"."]})]})]})]})},Wt=()=>{const[c,C]=n.useState([]),[j,g]=n.useState(!0),[b,v]=n.useState(!1),[D,T]=n.useState(null),[t,a]=n.useState(null),[s,i]=n.useState(null),[o,E]=n.useState(!1),[d,I]=n.useState([]),[A,B]=n.useState(!1),[$,L]=n.useState(""),[N,h]=n.useState(!1);n.useEffect(()=>{k(),_()},[]);const k=async()=>{g(!0);try{const f=await Ie.getSettings();C(f.data)}catch(f){l.error("Failed to load SIEM settings"),console.error(f)}finally{g(!1)}},y=async f=>{var w,x;a(f);try{const P=await Ie.testConnection(f);P.data.success?l.success("Connection test successful!"):l.error(`Connection test failed: ${P.data.message}`)}catch(P){const p=P;l.error(((x=(w=p.response)==null?void 0:w.data)==null?void 0:x.error)||"Connection test failed")}finally{a(null)}},O=async()=>{var f,w;if(s){E(!0);try{await Ie.deleteSettings(s.id),l.success(`${s.siem_type.toUpperCase()} integration deleted`),k(),i(null)}catch(x){const P=x;l.error(((w=(f=P.response)==null?void 0:f.data)==null?void 0:w.error)||"Failed to delete SIEM integration")}finally{E(!1)}}},_=async()=>{B(!0);try{const f=await st.getAll();I(f.data.filter(w=>w.status==="completed"))}catch(f){console.error("Failed to load scans:",f)}finally{B(!1)}},R=async()=>{var w,x;if(!$){l.error("Please select a scan to export");return}if(c.filter(P=>P.enabled).length===0){l.error("No enabled SIEM integrations found. Please enable at least one integration.");return}h(!0);try{const P=await Ie.exportScan($);P.data.success?(l.success(`Scan exported to ${P.data.exported_to} SIEM integration(s). ${P.data.events_count} events sent.`),P.data.errors&&P.data.errors.length>0&&P.data.errors.forEach(p=>l.warning(p))):l.error("Export failed. Check SIEM configuration.")}catch(P){const p=P;l.error(((x=(w=p.response)==null?void 0:w.data)==null?void 0:x.error)||"Failed to export scan to SIEM")}finally{h(!1)}};return j?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"SIEM Integrations"})]}),e.jsxs(M,{variant:"primary",onClick:()=>v(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Add Integration"]})]}),c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ms,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"No SIEM integrations configured"}),e.jsxs(M,{variant:"primary",onClick:()=>v(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Add Your First Integration"]})]}):e.jsx("div",{className:"space-y-4",children:c.map(f=>e.jsx("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-primary/20 text-primary rounded-md text-sm font-medium uppercase",children:f.siem_type}),f.enabled?e.jsxs("span",{className:"flex items-center gap-1 text-green-400 text-sm",children:[e.jsx(de,{className:"h-4 w-4"}),"Enabled"]}):e.jsxs("span",{className:"flex items-center gap-1 text-slate-500 text-sm",children:[e.jsx(Ye,{className:"h-4 w-4"}),"Disabled"]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Endpoint:"}),e.jsx("span",{className:"text-white font-mono",children:f.endpoint_url})]}),f.protocol&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Protocol:"}),e.jsx("span",{className:"text-white uppercase",children:f.protocol})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:f.export_on_scan_complete,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export on scan complete"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:f.export_on_critical_vuln,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export critical vulnerabilities"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{variant:"outline",size:"sm",onClick:()=>y(f.id),disabled:t===f.id,children:t===f.id?e.jsx(X,{}):e.jsx(pt,{className:"h-4 w-4"})}),e.jsx(M,{variant:"outline",size:"sm",onClick:()=>T(f),children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx(M,{variant:"outline",size:"sm",onClick:()=>i(f),"aria-label":`Delete ${f.siem_type} integration`,children:e.jsx(ie,{className:"h-4 w-4 text-red-400"})})]})]})},f.id))})]}),e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Manual Export"})]}),e.jsx(M,{variant:"outline",size:"sm",onClick:_,disabled:A,children:A?e.jsx(X,{}):e.jsx(Ge,{className:"h-4 w-4"})})]}),c.filter(f=>f.enabled).length===0?e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(Ye,{className:"h-5 w-5 text-amber-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-200",children:[e.jsx("p",{className:"font-medium mb-1",children:"No Enabled Integrations"}),e.jsx("p",{children:"Enable at least one SIEM integration above before exporting scan results."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Manually export scan results to all enabled SIEM integrations."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:$,onChange:f=>L(f.target.value),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",disabled:A||N,children:[e.jsx("option",{value:"",children:"Select a completed scan..."}),d.map(f=>e.jsxs("option",{value:f.id,children:[f.name," - ",new Date(f.created_at).toLocaleDateString()," ",new Date(f.created_at).toLocaleTimeString()]},f.id))]}),e.jsx(M,{variant:"primary",onClick:R,disabled:!$||N||A,children:N?e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx("span",{className:"ml-2",children:"Exporting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Export to SIEM"]})})]}),d.length===0&&!A&&e.jsx("p",{className:"text-sm text-slate-500",children:"No completed scans available for export."}),e.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["Export will send data to: ",c.filter(f=>f.enabled).map(f=>f.siem_type.toUpperCase()).join(", ")]})]})]}),e.jsxs(z,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"About SIEM Integration"}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-400",children:[e.jsx("p",{children:"SIEM (Security Information and Event Management) integration allows HeroForge to automatically export scan results and vulnerability findings to your security monitoring platform."}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Syslog:"})," RFC 5424 compliant syslog over TCP/UDP"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Splunk:"})," Splunk HTTP Event Collector (HEC)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Elasticsearch:"})," Direct indexing via Bulk API"]})]})]})]}),(b||D)&&e.jsx(Gt,{settings:D,onClose:()=>{v(!1),T(null)},onSave:()=>{v(!1),T(null),k()}}),e.jsx(be,{isOpen:!!s,onClose:()=>i(null),onConfirm:O,title:"Delete SIEM Integration",message:`Are you sure you want to delete the ${s==null?void 0:s.siem_type.toUpperCase()} integration? Automatic exports to this endpoint will stop.`,confirmLabel:"Delete Integration",variant:"danger",loading:o})]})},Gt=({settings:c,onClose:C,onSave:j})=>{const[g,b]=n.useState({siem_type:(c==null?void 0:c.siem_type)||"syslog",endpoint_url:(c==null?void 0:c.endpoint_url)||"",api_key:(c==null?void 0:c.api_key)||"",protocol:(c==null?void 0:c.protocol)||"tcp",enabled:(c==null?void 0:c.enabled)??!0,export_on_scan_complete:(c==null?void 0:c.export_on_scan_complete)??!1,export_on_critical_vuln:(c==null?void 0:c.export_on_critical_vuln)??!0}),[v,D]=n.useState(!1),T=async t=>{var a,s;if(t.preventDefault(),!g.endpoint_url){l.error("Endpoint URL is required");return}if(g.siem_type==="splunk"&&!g.api_key){l.error("API key is required for Splunk HEC");return}D(!0);try{if(c){const i={endpoint_url:g.endpoint_url,enabled:g.enabled,export_on_scan_complete:g.export_on_scan_complete,export_on_critical_vuln:g.export_on_critical_vuln};g.api_key&&(i.api_key=g.api_key),g.siem_type==="syslog"&&(i.protocol=g.protocol),await Ie.updateSettings(c.id,i),l.success("SIEM integration updated")}else{const i={siem_type:g.siem_type,endpoint_url:g.endpoint_url,enabled:g.enabled,export_on_scan_complete:g.export_on_scan_complete,export_on_critical_vuln:g.export_on_critical_vuln};g.api_key&&(i.api_key=g.api_key),g.siem_type==="syslog"&&(i.protocol=g.protocol),await Ie.createSettings(i),l.success("SIEM integration created")}j()}catch(i){const o=i;l.error(((s=(a=o.response)==null?void 0:a.data)==null?void 0:s.error)||"Failed to save SIEM integration")}finally{D(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white",children:[c?"Edit":"Add"," SIEM Integration"]}),e.jsx("button",{onClick:C,className:"text-slate-400 hover:text-white",children:e.jsx(fe,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:T,className:"p-6 space-y-6",children:[!c&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"SIEM Type"}),e.jsxs("select",{value:g.siem_type,onChange:t=>b({...g,siem_type:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"syslog",children:"Syslog (RFC 5424)"}),e.jsx("option",{value:"splunk",children:"Splunk HEC"}),e.jsx("option",{value:"elasticsearch",children:"Elasticsearch"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Endpoint URL"}),e.jsx("input",{type:"text",value:g.endpoint_url,onChange:t=>b({...g,endpoint_url:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:g.siem_type==="syslog"?"192.168.1.100:514":g.siem_type==="splunk"?"https://splunk.example.com:8088":"https://elasticsearch.example.com:9200"})]}),g.siem_type==="syslog"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Protocol"}),e.jsxs("select",{value:g.protocol,onChange:t=>b({...g,protocol:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"})]})]}),(g.siem_type==="splunk"||g.siem_type==="elasticsearch")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:[g.siem_type==="splunk"?"HEC Token":"API Key"," ",g.siem_type==="splunk"&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"password",value:g.api_key,onChange:t=>b({...g,api_key:t.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:c?"(leave blank to keep current)":""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g.enabled,onChange:t=>b({...g,enabled:t.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Enable this integration"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g.export_on_scan_complete,onChange:t=>b({...g,export_on_scan_complete:t.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export when scans complete"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g.export_on_critical_vuln,onChange:t=>b({...g,export_on_critical_vuln:t.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export critical vulnerabilities immediately"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(M,{type:"button",variant:"outline",onClick:C,children:"Cancel"}),e.jsx(M,{type:"submit",variant:"primary",disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs("span",{children:[c?"Update":"Create"," Integration"]})})]})]})]})})},qt=()=>{const[c,C]=n.useState(!0),[j,g]=n.useState([]),[b,v]=n.useState(null),[D,T]=n.useState(!1),[t,a]=n.useState(!1),[s,i]=n.useState(null),[o,E]=n.useState(!1),[d,I]=n.useState(!1),[A,B]=n.useState(null),[$,L]=n.useState(""),N=n.useRef(null),[h,k]=n.useState({name:"",vpnType:"openvpn",username:"",password:""}),[y,O]=n.useState(null);n.useEffect(()=>{_()},[]);const _=async()=>{C(!0);try{const[r,F]=await Promise.all([pe.getConfigs(),pe.getStatus()]);g(r.data),v(F.data)}catch(r){console.error("Failed to load VPN data:",r),l.error("Failed to load VPN settings")}finally{C(!1)}},R=r=>{var U,W;const F=(U=r.target.files)==null?void 0:U[0];if(!F)return;const V=(W=F.name.split(".").pop())==null?void 0:W.toLowerCase();let u="openvpn";V==="conf"&&(u="wireguard"),O(F),k({...h,name:F.name.replace(/\.(ovpn|conf)$/i,""),vpnType:u}),T(!0)},f=async()=>{if(!y){l.error("Please select a VPN config file");return}if(!h.name.trim()){l.error("Please enter a name for the VPN config");return}a(!0);try{const r=new FileReader;r.onload=async()=>{var V,u;const F=r.result.split(",")[1];try{await pe.uploadConfig({name:h.name.trim(),vpn_type:h.vpnType,config_data:F,filename:y.name,username:h.username||void 0,password:h.password||void 0,set_as_default:!1}),l.success("VPN config uploaded successfully"),T(!1),O(null),k({name:"",vpnType:"openvpn",username:"",password:""}),N.current&&(N.current.value=""),await _()}catch(U){const W=U;console.error("Failed to upload VPN config:",U),l.error(((u=(V=W.response)==null?void 0:V.data)==null?void 0:u.error)||"Failed to upload VPN config")}},r.readAsDataURL(y)}finally{a(!1)}},w=async r=>{var F,V;if(window.confirm("Are you sure you want to delete this VPN config?"))try{await pe.deleteConfig(r),l.success("VPN config deleted"),await _()}catch(u){const U=u;console.error("Failed to delete VPN config:",u),l.error(((V=(F=U.response)==null?void 0:F.data)==null?void 0:V.error)||"Failed to delete VPN config")}},x=async r=>{var F,V;i(r);try{const u=await pe.testConfig(r);u.data.success?l.success(`Connection successful! IP: ${u.data.assigned_ip||"N/A"}`):l.error(u.data.message||"Connection test failed")}catch(u){const U=u;console.error("Failed to test VPN config:",u),l.error(((V=(F=U.response)==null?void 0:F.data)==null?void 0:V.error)||"Connection test failed")}finally{i(null)}},P=async r=>{var F,V;E(!0);try{await pe.connect({config_id:r,connection_mode:"persistent"}),l.success("VPN connected"),await _()}catch(u){const U=u;console.error("Failed to connect VPN:",u),l.error(((V=(F=U.response)==null?void 0:F.data)==null?void 0:V.error)||"Failed to connect")}finally{E(!1)}},p=async()=>{var r,F;I(!0);try{await pe.disconnect(),l.success("VPN disconnected"),await _()}catch(V){const u=V;console.error("Failed to disconnect VPN:",V),l.error(((F=(r=u.response)==null?void 0:r.data)==null?void 0:F.error)||"Failed to disconnect")}finally{I(!1)}},G=async r=>{var F,V;try{await pe.updateConfig(r,{is_default:!0}),l.success("Default VPN config updated"),await _()}catch(u){const U=u;console.error("Failed to set default:",u),l.error(((V=(F=U.response)==null?void 0:F.data)==null?void 0:V.error)||"Failed to set default")}},J=async r=>{var F,V;if(!$.trim()){l.error("Name cannot be empty");return}try{await pe.updateConfig(r,{name:$.trim()}),l.success("VPN config updated"),B(null),await _()}catch(u){const U=u;console.error("Failed to update config:",u),l.error(((V=(F=U.response)==null?void 0:F.data)==null?void 0:V.error)||"Failed to update")}};return c?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[b!=null&&b.connected?e.jsx(Ts,{className:"h-6 w-6 text-green-500"}):e.jsx(hs,{className:"h-6 w-6 text-slate-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"VPN Status"}),e.jsx("p",{className:"text-sm text-slate-400",children:b!=null&&b.connected?`Connected to ${b.config_name}`:"Not connected"})]})]}),(b==null?void 0:b.connected)&&e.jsxs(M,{onClick:p,disabled:d,variant:"danger",className:"flex items-center gap-2",children:[e.jsx(gt,{className:"h-4 w-4"}),d?"Disconnecting...":"Disconnect"]})]}),(b==null?void 0:b.connected)&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-dark-hover rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Mode"}),e.jsx("p",{className:"text-sm text-white",children:b.connection_mode==="persistent"?"Persistent":"Per-Scan"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Assigned IP"}),e.jsx("p",{className:"text-sm text-white font-mono",children:b.assigned_ip||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Interface"}),e.jsx("p",{className:"text-sm text-white font-mono",children:b.interface_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Connected Since"}),e.jsx("p",{className:"text-sm text-white",children:b.connected_since?new Date(b.connected_since).toLocaleString():"N/A"})]})]})]}),e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xe,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"VPN Configurations"})]}),e.jsxs("div",{children:[e.jsx("input",{ref:N,type:"file",accept:".ovpn,.conf",onChange:R,className:"hidden"}),e.jsxs(M,{onClick:()=>{var r;return(r=N.current)==null?void 0:r.click()},className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-4 w-4"}),"Upload Config"]})]})]}),D&&e.jsxs("div",{className:"mb-6 p-4 bg-dark-hover rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"Upload VPN Configuration"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{children:"File:"}),e.jsx("span",{className:"text-white font-mono",children:y==null?void 0:y.name}),e.jsx("span",{className:"px-2 py-0.5 bg-primary/20 text-primary rounded text-xs uppercase",children:h.vpnType})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Config Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ee,{type:"text",placeholder:"My VPN Connection",value:h.name,onChange:r=>k({...h,name:r.target.value})})]}),h.vpnType==="openvpn"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Username (optional)"}),e.jsx(ee,{type:"text",placeholder:"VPN username",value:h.username,onChange:r=>k({...h,username:r.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Required if your VPN requires authentication"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Password (optional)"}),e.jsx(ee,{type:"password",placeholder:"VPN password",value:h.password,onChange:r=>k({...h,password:r.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(M,{onClick:f,disabled:t,children:t?"Uploading...":"Upload"}),e.jsx(M,{onClick:()=>{T(!1),O(null),N.current&&(N.current.value="")},variant:"secondary",children:"Cancel"})]})]})]}),j.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(hs,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No VPN configurations yet"}),e.jsx("p",{className:"text-sm",children:"Upload an OpenVPN (.ovpn) or WireGuard (.conf) file to get started"})]}):e.jsx("div",{className:"space-y-3",children:j.map(r=>e.jsxs("div",{className:"p-4 bg-dark-hover rounded-lg border border-dark-border flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${r.vpn_type==="openvpn"?"bg-orange-500/20 text-orange-400":"bg-blue-500/20 text-blue-400"}`,children:e.jsx(xe,{className:"h-5 w-5"})}),e.jsxs("div",{children:[A===r.id?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{type:"text",value:$,onChange:F=>L(F.target.value),className:"w-48",autoFocus:!0,onKeyDown:F=>{F.key==="Enter"&&J(r.id),F.key==="Escape"&&B(null)}}),e.jsx(M,{size:"sm",onClick:()=>J(r.id),children:"Save"}),e.jsx(M,{size:"sm",variant:"secondary",onClick:()=>B(null),children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium",children:r.name}),r.is_default&&e.jsx(Je,{className:"h-4 w-4 text-yellow-400 fill-yellow-400"}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-700 text-slate-300 rounded text-xs uppercase",children:r.vpn_type}),(b==null?void 0:b.connected)&&b.config_id===r.id&&e.jsx("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 rounded text-xs",children:"Connected"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500 mt-1",children:[r.requires_credentials&&e.jsx("span",{className:r.has_credentials?"text-green-400":"text-yellow-400",children:r.has_credentials?"Credentials saved":"Credentials required"}),r.last_used_at&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"h-3 w-3"}),"Last used: ",new Date(r.last_used_at).toLocaleDateString()]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:A!==r.id&&e.jsxs(e.Fragment,{children:[!r.is_default&&e.jsx(M,{size:"sm",variant:"ghost",onClick:()=>G(r.id),title:"Set as default",children:e.jsx(Je,{className:"h-4 w-4"})}),e.jsx(M,{size:"sm",variant:"ghost",onClick:()=>{B(r.id),L(r.name)},title:"Edit",children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx(M,{size:"sm",variant:"ghost",onClick:()=>x(r.id),disabled:s===r.id,title:"Test connection",children:s===r.id?e.jsx(X,{size:"sm"}):e.jsx(de,{className:"h-4 w-4"})}),!(b!=null&&b.connected)||b.config_id!==r.id?e.jsx(M,{size:"sm",variant:"secondary",onClick:()=>P(r.id),disabled:o||(b==null?void 0:b.connected),title:"Connect",children:e.jsx(cs,{className:"h-4 w-4"})}):null,e.jsx(M,{size:"sm",variant:"ghost",onClick:()=>w(r.id),className:"text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(ie,{className:"h-4 w-4"})})]})})]},r.id))})]}),e.jsxs(z,{children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"How to Use VPN Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-slate-400",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Upload your OpenVPN (.ovpn) or WireGuard (.conf) configuration file."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"If your VPN requires credentials, enter them during upload. They are stored encrypted."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"3"})}),e.jsx("p",{children:"Test your connection to verify it works before using it for scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"When creating a scan, select a VPN config to route the scan through that VPN. The VPN connects before the scan starts and disconnects when it completes."})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(me,{className:"h-5 w-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-200",children:[e.jsx("p",{className:"font-medium",children:"Security Note"}),e.jsx("p",{className:"text-yellow-300/80 mt-1",children:"VPN credentials are encrypted using AES-256-GCM. Config files containing dangerous options (scripts, hooks) are rejected. Only use VPN configurations from trusted sources."})]})]})})]})]})},vs={name:"",description:"",report_type:"vulnerability",format:"pdf",schedule:"0 8 * * *",recipients:[],filters:{days_back:30},include_charts:!0},ts=[{value:"vulnerability",label:"Vulnerability Report",description:"All discovered vulnerabilities with severity and remediation"},{value:"scan_summary",label:"Scan Summary",description:"Overview of completed scans and their results"},{value:"compliance",label:"Compliance Report",description:"Compliance framework analysis and control mappings"},{value:"executive",label:"Executive Summary",description:"High-level security posture overview"}],Jt=[{value:"pdf",label:"PDF"},{value:"html",label:"HTML"},{value:"csv",label:"CSV"}],Kt=[{value:"",label:"All Severities"},{value:"low",label:"Low and above"},{value:"medium",label:"Medium and above"},{value:"high",label:"High and above"},{value:"critical",label:"Critical only"}],Yt=[{value:"pci_dss",label:"PCI-DSS 4.0"},{value:"nist_800_53",label:"NIST 800-53"},{value:"nist_csf",label:"NIST CSF"},{value:"cis",label:"CIS Benchmarks"},{value:"hipaa",label:"HIPAA"},{value:"soc2",label:"SOC 2"},{value:"owasp_top10",label:"OWASP Top 10"}],Qt=()=>{var J;const[c,C]=n.useState([]),[j,g]=n.useState([]),[b,v]=n.useState(!0),[D,T]=n.useState(!1),[t,a]=n.useState(null),[s,i]=n.useState(vs),[o,E]=n.useState(""),[d,I]=n.useState(null),[A,B]=n.useState(!1),[$,L]=n.useState(null),[N,h]=n.useState(!1);n.useEffect(()=>{k()},[]);const k=async()=>{v(!0);try{const[r,F]=await Promise.all([_e.getAll(),_e.getPresets()]);C(r.data),g(F.data)}catch(r){l.error("Failed to load scheduled reports"),console.error(r)}finally{v(!1)}},y=()=>{i(vs),a(null),T(!1),E(""),h(!1)},O=r=>{const F=JSON.parse(r.recipients),V=r.filters?JSON.parse(r.filters):{};i({name:r.name,description:r.description||"",report_type:r.report_type,format:r.format,schedule:r.schedule,recipients:F,filters:V,include_charts:r.include_charts});const u=j.some(U=>U.cron===r.schedule);h(!u),a(r.id),T(!0)},_=()=>{const r=o.trim().toLowerCase();if(!r)return;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)){l.error("Please enter a valid email address");return}if(s.recipients.includes(r)){l.warning("Email already added");return}i(V=>({...V,recipients:[...V.recipients,r]})),E("")},R=r=>{i(F=>({...F,recipients:F.recipients.filter(V=>V!==r)}))},f=async r=>{var F,V;if(r.preventDefault(),!s.name.trim()){l.error("Name is required");return}if(s.recipients.length===0){l.error("At least one recipient is required");return}try{t?(await _e.update(t,{name:s.name,description:s.description||void 0,report_type:s.report_type,format:s.format,schedule:s.schedule,recipients:s.recipients,filters:s.filters,include_charts:s.include_charts}),l.success("Scheduled report updated")):(await _e.create({name:s.name,description:s.description||void 0,report_type:s.report_type,format:s.format,schedule:s.schedule,recipients:s.recipients,filters:s.filters,include_charts:s.include_charts}),l.success("Scheduled report created")),y(),k()}catch(u){const U=u;l.error(((V=(F=U.response)==null?void 0:F.data)==null?void 0:V.error)||"Failed to save scheduled report")}},w=async r=>{var F,V;try{await _e.update(r.id,{is_active:!r.is_active}),l.success(`Scheduled report ${r.is_active?"paused":"activated"}`),k()}catch(u){const U=u;l.error(((V=(F=U.response)==null?void 0:F.data)==null?void 0:V.error)||"Failed to update")}},x=async r=>{var F,V;L(r.id);try{await _e.runNow(r.id),l.success("Report generation started. You will receive it via email shortly.")}catch(u){const U=u;l.error(((V=(F=U.response)==null?void 0:F.data)==null?void 0:V.error)||"Failed to run report")}finally{L(null)}},P=async()=>{var r,F;if(d){B(!0);try{await _e.delete(d.id),l.success(`Scheduled report "${d.name}" deleted`),k(),I(null)}catch(V){const u=V;l.error(((F=(r=u.response)==null?void 0:r.data)==null?void 0:F.error)||"Failed to delete")}finally{B(!1)}}},p=r=>{const F=j.find(u=>u.cron===r);if(F)return F.label;const V=r.split(" ");if(V.length===5){const[u,U]=V,W=`${U.padStart(2,"0")}:${u.padStart(2,"0")}`;if(V[4]==="*"&&V[3]==="*"&&V[2]==="*")return`Daily at ${W}`;if(V[4]!=="*")return`Weekly on ${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][parseInt(V[4])]} at ${W}`;if(V[2]!=="*")return`Monthly on day ${V[2]} at ${W}`}return r},G=r=>{var F;return((F=ts.find(V=>V.value===r))==null?void 0:F.label)||r};return b?e.jsx(z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(X,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scheduled Reports"})]}),!D&&e.jsxs(M,{variant:"primary",onClick:()=>T(!0),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"New Scheduled Report"]})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Automatically generate and email reports on a schedule"})]}),D&&e.jsx(z,{children:e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:t?"Edit Scheduled Report":"Create Scheduled Report"}),e.jsx("button",{type:"button",onClick:y,className:"text-slate-400 hover:text-white",children:e.jsx(fe,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:r=>i({...s,name:r.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Weekly Vulnerability Report"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:s.description,onChange:r=>i({...s,description:r.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Report Type"}),e.jsx("select",{value:s.report_type,onChange:r=>i({...s,report_type:r.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",children:ts.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:(J=ts.find(r=>r.value===s.report_type))==null?void 0:J.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Format"}),e.jsx("div",{className:"flex gap-2",children:Jt.map(r=>e.jsx("button",{type:"button",onClick:()=>i({...s,format:r.value}),className:`flex-1 px-4 py-2 rounded-lg border transition-colors ${s.format===r.value?"bg-primary/20 border-primary text-primary":"bg-dark-bg border-dark-border text-slate-400 hover:border-slate-500"}`,children:r.label},r.value))})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(Xe,{className:"h-4 w-4"})," Schedule"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[j.map(r=>e.jsx("button",{type:"button",onClick:()=>{i({...s,schedule:r.cron}),h(!1)},className:`px-3 py-1.5 rounded-lg border text-sm transition-colors ${s.schedule===r.cron&&!N?"bg-primary/20 border-primary text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-slate-500"}`,title:r.description,children:r.label},r.id)),e.jsx("button",{type:"button",onClick:()=>h(!0),className:`px-3 py-1.5 rounded-lg border text-sm transition-colors ${N?"bg-primary/20 border-primary text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-slate-500"}`,children:"Custom"})]}),N&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Cron Expression"}),e.jsx("input",{type:"text",value:s.schedule,onChange:r=>i({...s,schedule:r.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white font-mono text-sm",placeholder:"0 8 * * *"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:'Format: minute hour day-of-month month day-of-week (e.g., "0 8 * * *" for daily at 8am)'})]})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"})," Recipients"]}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"email",value:o,onChange:r=>E(r.target.value),onKeyDown:r=>{r.key==="Enter"&&(r.preventDefault(),_())},className:"flex-1 bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",placeholder:"email@example.com"}),e.jsx(M,{type:"button",variant:"secondary",onClick:_,children:e.jsx(ue,{className:"h-4 w-4"})})]}),s.recipients.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:s.recipients.map(r=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-dark-surface rounded-lg text-sm text-slate-300",children:[e.jsx(Se,{className:"h-3 w-3"}),r,e.jsx("button",{type:"button",onClick:()=>R(r),className:"ml-1 text-slate-500 hover:text-red-400",children:e.jsx(fe,{className:"h-3 w-3"})})]},r))}):e.jsx("p",{className:"text-sm text-slate-500",children:"No recipients added"})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-3",children:"Filters"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Time Period"}),e.jsxs("select",{value:s.filters.days_back||30,onChange:r=>i({...s,filters:{...s.filters,days_back:parseInt(r.target.value)}}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:7,children:"Last 7 days"}),e.jsx("option",{value:14,children:"Last 14 days"}),e.jsx("option",{value:30,children:"Last 30 days"}),e.jsx("option",{value:60,children:"Last 60 days"}),e.jsx("option",{value:90,children:"Last 90 days"})]})]}),s.report_type==="vulnerability"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Minimum Severity"}),e.jsx("select",{value:s.filters.min_severity||"",onChange:r=>i({...s,filters:{...s.filters,min_severity:r.target.value||void 0}}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Kt.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),s.report_type==="compliance"&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Frameworks"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Yt.map(r=>{var F;return e.jsx("button",{type:"button",onClick:()=>{const V=s.filters.frameworks||[],u=V.includes(r.value)?V.filter(U=>U!==r.value):[...V,r.value];i({...s,filters:{...s.filters,frameworks:u}})},className:`px-2 py-1 rounded text-xs border transition-colors ${(F=s.filters.frameworks)!=null&&F.includes(r.value)?"bg-primary/20 border-primary text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-slate-500"}`,children:r.label},r.value)})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"include_charts",checked:s.include_charts,onChange:r=>i({...s,include_charts:r.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),e.jsx("label",{htmlFor:"include_charts",className:"text-sm text-slate-300",children:"Include charts and visualizations"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(M,{type:"button",variant:"secondary",onClick:y,children:"Cancel"}),e.jsxs(M,{type:"submit",variant:"primary",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),t?"Update":"Create"]})]})]})}),c.length===0&&!D?e.jsx(z,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ne,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scheduled reports"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create automated reports to receive regular updates via email"})]})}):e.jsx("div",{className:"space-y-3",children:c.map(r=>{const F=JSON.parse(r.recipients);return e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${r.is_active?"bg-green-500/20":"bg-slate-500/20"}`,children:e.jsx(Ne,{className:`h-5 w-5 ${r.is_active?"text-green-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-white",children:r.name}),e.jsx(oe,{variant:"status",type:r.is_active?"completed":"pending",children:r.is_active?"Active":"Paused"}),e.jsx(oe,{variant:"primary",children:r.format.toUpperCase()})]}),e.jsxs("p",{className:"text-sm text-slate-400",children:[G(r.report_type)," - ",p(r.schedule)]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Se,{className:"h-3 w-3"}),F.length," recipient",F.length!==1?"s":""]}),r.last_run_at&&e.jsxs("span",{className:"ml-3",children:[e.jsx(ge,{className:"h-3 w-3 inline mr-1"}),"Last run ",ws(new Date(r.last_run_at))," ago"]}),e.jsxs("span",{className:"ml-3",children:["Next: ",new Date(r.next_run_at).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>x(r),disabled:$===r.id,className:"p-2 text-cyan-400 hover:bg-cyan-500/20 rounded transition-colors disabled:opacity-50",title:"Run Now",children:$===r.id?e.jsx(X,{size:"sm"}):e.jsx(We,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>w(r),className:`p-2 rounded transition-colors ${r.is_active?"text-yellow-400 hover:bg-yellow-500/20":"text-green-400 hover:bg-green-500/20"}`,title:r.is_active?"Pause":"Activate",children:r.is_active?e.jsx(Cs,{className:"h-4 w-4"}):e.jsx(cs,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>O(r),className:"p-2 text-slate-400 hover:text-primary transition-colors",children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>I(r),className:"p-2 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete scheduled report ${r.name}`,children:e.jsx(ie,{className:"h-4 w-4"})})]})]})},r.id)})}),e.jsx(be,{isOpen:!!d,onClose:()=>I(null),onConfirm:P,title:"Delete Scheduled Report",message:`Are you sure you want to delete the scheduled report "${d==null?void 0:d.name}"? Future reports will no longer be generated.`,confirmLabel:"Delete Report",variant:"warning",loading:A})]})},Ns={"scan.started":"Scan Started","scan.completed":"Scan Completed","scan.failed":"Scan Failed","vulnerability.found":"Vulnerability Found","vulnerability.critical":"Critical Vulnerability","vulnerability.resolved":"Vulnerability Resolved","asset.discovered":"Asset Discovered","compliance.violation":"Compliance Violation"};function Xt(){const[c,C]=n.useState([]),[j,g]=n.useState([]),[b,v]=n.useState(!0),[D,T]=n.useState(!1),[t,a]=n.useState(null),[s,i]=n.useState(!1),[o,E]=n.useState(null),[d,I]=n.useState([]),[A,B]=n.useState(!1),[$,L]=n.useState(null),[N,h]=n.useState(null),[k,y]=n.useState(""),[O,_]=n.useState(""),[R,f]=n.useState(""),[w,x]=n.useState([]),[P,p]=n.useState([]),[G,J]=n.useState(!0),[r,F]=n.useState(!1),[V,u]=n.useState(!1);n.useEffect(()=>{U(),W()},[]);const U=async()=>{try{const S=await ve.list();C(S.data)}catch(S){console.error("Failed to load webhooks:",S),l.error("Failed to load webhooks")}finally{v(!1)}},W=async()=>{try{const S=await ve.getEventTypes();g(S.data.event_types)}catch(S){console.error("Failed to load event types:",S)}},H=()=>{y(""),_(""),f(""),x([]),p([]),J(!0),F(!1),a(null)},K=()=>{H(),T(!0)},m=S=>{a(S),y(S.name),_(S.url),f(""),x([...S.events]),p(S.headers?Object.entries(S.headers).map(([Z,re])=>({key:Z,value:re})):[]),J(S.is_active),T(!0)},q=()=>{T(!1),H()},Q=async()=>{try{const S=await ve.generateSecret();f(S.data.secret),F(!0),l.success("Secret generated")}catch{l.error("Failed to generate secret")}},ce=()=>{R&&(navigator.clipboard.writeText(R),l.success("Secret copied to clipboard"))},ye=()=>{p([...P,{key:"",value:""}])},le=S=>{p(P.filter((Z,re)=>re!==S))},Ee=(S,Z,re)=>{const ne=[...P];ne[S][Z]=re,p(ne)},Ks=S=>{w.includes(S)?x(w.filter(Z=>Z!==S)):x([...w,S])},Ys=async S=>{var Z,re;if(S.preventDefault(),!O.startsWith("http://")&&!O.startsWith("https://")){l.error("URL must start with http:// or https://");return}if(w.length===0){l.error("Please select at least one event");return}u(!0);try{const ne={};if(P.forEach(ae=>{ae.key.trim()&&ae.value.trim()&&(ne[ae.key.trim()]=ae.value.trim())}),t){const ae={name:k,url:O,events:w,headers:Object.keys(ne).length>0?ne:void 0,is_active:G};R&&(ae.secret=R),await ve.update(t.id,ae),l.success("Webhook updated")}else{const ae={name:k,url:O,events:w,headers:Object.keys(ne).length>0?ne:void 0,is_active:G};R&&(ae.secret=R),await ve.create(ae),l.success("Webhook created")}q(),U()}catch(ne){const ae=((re=(Z=ne.response)==null?void 0:Z.data)==null?void 0:re.error)||"Failed to save webhook";l.error(ae)}finally{u(!1)}},Qs=async(S,Z)=>{if(confirm(`Are you sure you want to delete the webhook "${Z}"?`))try{await ve.delete(S),l.success("Webhook deleted"),U()}catch{l.error("Failed to delete webhook")}},Xs=async S=>{var Z,re;L(S);try{const ae=(await ve.test(S)).data;ae.success?l.success(`Test successful (HTTP ${ae.status_code})`):l.error(`Test failed: ${ae.error||"Unknown error"}`)}catch(ne){const ae=((re=(Z=ne.response)==null?void 0:Z.data)==null?void 0:re.error)||"Failed to test webhook";l.error(ae)}finally{L(null)}},Zs=async S=>{E(S),i(!0),B(!0);try{const Z=await ve.getDeliveries(S,50);I(Z.data)}catch{l.error("Failed to load delivery history"),I([])}finally{B(!1)}},et=S=>S.is_active?S.failure_count>=5?e.jsx(ps,{className:"w-5 h-5 text-red-500"}):S.last_status_code&&S.last_status_code>=200&&S.last_status_code<300?e.jsx(de,{className:"w-5 h-5 text-green-500"}):e.jsx(Ye,{className:"w-5 h-5 text-yellow-500"}):e.jsx(Ye,{className:"w-5 h-5 text-gray-500"}),xs=S=>S?new Date(S).toLocaleString():"Never";return b?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Ge,{className:"w-6 h-6 animate-spin text-cyan-400"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"Webhooks"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Send HTTP notifications to external systems when events occur"})]}),e.jsxs("button",{onClick:K,className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(ue,{className:"w-4 h-4"}),"Add Webhook"]})]}),c.length===0?e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-8 text-center",children:[e.jsx(Ms,{className:"w-12 h-12 mx-auto text-gray-500 mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-300",children:"No webhooks configured"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Create a webhook to send notifications to external systems"})]}):e.jsx("div",{className:"space-y-4",children:c.map(S=>e.jsx("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[et(S),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-100",children:S.name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 font-mono",children:S.url}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:S.events.map(Z=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-700 text-gray-300 rounded",children:Ns[Z]||Z},Z))}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-400",children:[e.jsxs("span",{children:["Last triggered: ",xs(S.last_triggered_at)]}),S.last_status_code&&e.jsxs("span",{className:S.last_status_code>=200&&S.last_status_code<300?"text-green-400":"text-red-400",children:["HTTP ",S.last_status_code]}),S.failure_count>0&&e.jsxs("span",{className:"text-red-400",children:[S.failure_count," failures"]}),S.has_secret&&e.jsx("span",{className:"text-cyan-400",children:"Signed"}),!S.is_active&&e.jsx("span",{className:"text-gray-500",children:"Disabled"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Xs(S.id),disabled:$===S.id,className:"p-2 text-gray-400 hover:text-cyan-400 transition-colors disabled:opacity-50",title:"Test webhook",children:$===S.id?e.jsx(Ge,{className:"w-4 h-4 animate-spin"}):e.jsx(ft,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Zs(S.id),className:"p-2 text-gray-400 hover:text-cyan-400 transition-colors",title:"View delivery history",children:e.jsx(ks,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>m(S),className:"p-2 text-gray-400 hover:text-cyan-400 transition-colors",title:"Edit webhook",children:e.jsx(je,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Qs(S.id,S.name),className:"p-2 text-gray-400 hover:text-red-400 transition-colors",title:"Delete webhook",children:e.jsx(ie,{className:"w-4 h-4"})})]})]})},S.id))}),D&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100 mb-4",children:t?"Edit Webhook":"Create Webhook"}),e.jsxs("form",{onSubmit:Ys,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:k,onChange:S=>y(S.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent",placeholder:"My Webhook"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"URL"}),e.jsx("input",{type:"url",value:O,onChange:S=>_(S.target.value),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent font-mono text-sm",placeholder:"https://example.com/webhook"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Secret Key (optional)"}),e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"If set, requests will include an X-Webhook-Signature header with HMAC-SHA256 signature"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:r?"text":"password",value:R,onChange:S=>f(S.target.value),className:"w-full px-3 py-2 pr-20 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent font-mono text-sm",placeholder:t!=null&&t.has_secret?"(unchanged)":"Enter or generate a secret"}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex gap-1",children:[e.jsx("button",{type:"button",onClick:()=>F(!r),className:"p-1 text-gray-400 hover:text-gray-200",children:r?e.jsx(Ps,{className:"w-4 h-4"}):e.jsx(bt,{className:"w-4 h-4"})}),R&&e.jsx("button",{type:"button",onClick:ce,className:"p-1 text-gray-400 hover:text-gray-200",children:e.jsx(Re,{className:"w-4 h-4"})})]})]}),e.jsx("button",{type:"button",onClick:Q,className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg transition-colors",children:"Generate"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Events"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:j.map(S=>e.jsxs("label",{className:"flex items-start gap-2 p-3 bg-gray-700/50 rounded-lg cursor-pointer hover:bg-gray-700",children:[e.jsx("input",{type:"checkbox",checked:w.includes(S.id),onChange:()=>Ks(S.id),className:"mt-1 rounded border-gray-600 bg-gray-700 text-cyan-500 focus:ring-cyan-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-200",children:S.name}),e.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:S.description})]})]},S.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Custom Headers (optional)"}),e.jsx("button",{type:"button",onClick:ye,className:"text-sm text-cyan-400 hover:text-cyan-300",children:"+ Add Header"})]}),P.length>0&&e.jsx("div",{className:"space-y-2",children:P.map((S,Z)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:S.key,onChange:re=>Ee(Z,"key",re.target.value),placeholder:"Header name",className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 text-sm"}),e.jsx("input",{type:"text",value:S.value,onChange:re=>Ee(Z,"value",re.target.value),placeholder:"Header value",className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-gray-100 text-sm"}),e.jsx("button",{type:"button",onClick:()=>le(Z),className:"p-2 text-gray-400 hover:text-red-400",children:e.jsx(ie,{className:"w-4 h-4"})})]},Z))})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:G,onChange:S=>J(S.target.checked),className:"rounded border-gray-600 bg-gray-700 text-cyan-500 focus:ring-cyan-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Enable webhook"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:q,className:"px-4 py-2 text-gray-300 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:V,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors disabled:opacity-50",children:V?"Saving...":t?"Save Changes":"Create Webhook"})]})]})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"Delivery History"}),e.jsx("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-white",children:"Close"})]}),A?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Ge,{className:"w-6 h-6 animate-spin text-cyan-400"})}):d.length===0?e.jsx("div",{className:"text-center py-12 text-gray-400",children:"No deliveries yet"}):e.jsx("div",{className:"space-y-3",children:d.map(S=>e.jsxs("div",{className:"bg-gray-700/50 rounded-lg border border-gray-600",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer",onClick:()=>h(N===S.id?null:S.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[S.response_status&&S.response_status>=200&&S.response_status<300?e.jsx(de,{className:"w-5 h-5 text-green-500"}):e.jsx(ps,{className:"w-5 h-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-200",children:Ns[S.event_type]||S.event_type}),e.jsx("span",{className:"text-sm text-gray-400 ml-3",children:xs(S.delivered_at)})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[S.response_status&&e.jsxs("span",{className:S.response_status>=200&&S.response_status<300?"text-green-400":"text-red-400",children:["HTTP ",S.response_status]}),S.error&&e.jsx("span",{className:"text-red-400 text-sm",children:S.error}),N===S.id?e.jsx(jt,{className:"w-4 h-4 text-gray-400"}):e.jsx(qe,{className:"w-4 h-4 text-gray-400"})]})]}),N===S.id&&e.jsxs("div",{className:"px-4 pb-4 border-t border-gray-600 pt-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-400 mb-2",children:"Request Payload"}),e.jsx("pre",{className:"bg-gray-900 p-3 rounded text-xs text-gray-300 overflow-x-auto",children:JSON.stringify(JSON.parse(S.payload||"{}"),null,2)})]}),S.response_body&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-400 mb-2",children:"Response Body"}),e.jsx("pre",{className:"bg-gray-900 p-3 rounded text-xs text-gray-300 overflow-x-auto max-h-48",children:S.response_body})]})]})]},S.id))})]})})]})}const ia=()=>{const[c,C]=n.useState("profile"),j=[{name:"Account",tabs:[{id:"profile",label:"Profile",icon:e.jsx(as,{className:"h-4 w-4"}),component:e.jsx(Nt,{})},{id:"security",label:"Security",icon:e.jsx(ze,{className:"h-4 w-4"}),component:e.jsx(Vt,{})},{id:"api-keys",label:"API Keys",icon:e.jsx(Ke,{className:"h-4 w-4"}),component:e.jsx(zt,{})}]},{name:"Administration",tabs:[{id:"administration",label:"Users",icon:e.jsx(xe,{className:"h-4 w-4"}),component:e.jsx(kt,{})}]},{name:"Scanning",tabs:[{id:"target-groups",label:"Target Groups",icon:e.jsx(_s,{className:"h-4 w-4"}),component:e.jsx(_t,{})},{id:"exclusions",label:"Exclusions",icon:e.jsx(Fs,{className:"h-4 w-4"}),component:e.jsx(It,{})},{id:"scheduled-scans",label:"Scheduled Scans",icon:e.jsx(ge,{className:"h-4 w-4"}),component:e.jsx(St,{})},{id:"scheduled-reports",label:"Scheduled Reports",icon:e.jsx(Se,{className:"h-4 w-4"}),component:e.jsx(Qt,{})},{id:"templates",label:"Scan Templates",icon:e.jsx(Ne,{className:"h-4 w-4"}),component:e.jsx(Et,{})},{id:"finding-templates",label:"Finding Templates",icon:e.jsx(Is,{className:"h-4 w-4"}),component:e.jsx(At,{})},{id:"vpn",label:"VPN",icon:e.jsx(Ts,{className:"h-4 w-4"}),component:e.jsx(qt,{})},{id:"compare-scans",label:"Compare",icon:e.jsx(yt,{className:"h-4 w-4"}),component:e.jsx(vt,{})}]},{name:"Integrations",tabs:[{id:"notifications",label:"Notifications",icon:e.jsx(Es,{className:"h-4 w-4"}),component:e.jsx(Ct,{})},{id:"webhooks",label:"Webhooks",icon:e.jsx(Ms,{className:"h-4 w-4"}),component:e.jsx(Xt,{})},{id:"jira-integration",label:"JIRA",icon:e.jsx(Ze,{className:"h-4 w-4"}),component:e.jsx(Bt,{})},{id:"servicenow-integration",label:"ServiceNow",icon:e.jsx(Ds,{className:"h-4 w-4"}),component:e.jsx(Ht,{})},{id:"siem-integration",label:"SIEM",icon:e.jsx(Rs,{className:"h-4 w-4"}),component:e.jsx(Wt,{})}]}],b=j.flatMap(v=>v.tabs).find(v=>v.id===c);return e.jsx(tt,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ds,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Settings"})]}),e.jsx("p",{className:"text-slate-400",children:"Manage your account, scanning configuration, and integrations"})]}),e.jsx("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:e.jsx("div",{className:"flex flex-wrap gap-6",children:j.map(v=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:v.name}),e.jsx("div",{className:"flex gap-1",children:v.tabs.map(D=>e.jsxs("button",{onClick:()=>C(D.id),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${c===D.id?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[D.icon,D.label]},D.id))})]},v.name))})}),e.jsx("div",{children:b==null?void 0:b.component})]})})};export{ia as default};
