import{j as e}from"./vendor-state-DNqmiQl8.js";import{r as a}from"./vendor-react-CGkJ0Xct.js";import{d as je,C as S,L as J,I as z,B as f,a as ae,b as se,e as ce,t as me,s as de,f as Qe,n as Q,g as Je,h as De,i as Xe,u as Ze,j as pe,m as ge,k as ve,l as oe,o as ie,v as X,c as es}from"./index-5gWEWEvL.js";import{B as t,U as ke,S as Z,a8 as Te,am as Se,m as xe,a as ye,s as B,h as ss,u as Ke,w as ze,an as ts,ao as as,ap as rs,Q as le,aq as ls,o as re,T as Ee,af as G,X as Ne,F as ns,ak as he,ar as is,as as qe,at as He,au as we,y as W,av as cs,aw as Ce,A as ds,ax as ne,V as fe,N as Re,d as Pe,O as Ae,H as os,R as ms,l as xs,ay as hs,z as Ie,az as Le,J as us,K as be,g as Ge,D as We,a6 as Be,aA as Ue,aB as ps,aC as Fe,W as Ye,v as Me,aD as gs,aE as Ve}from"./vendor-ui-tNk-6tcv.js";import"./vendor-charts-DvNHdErC.js";const js=()=>{var l;const[c,U]=a.useState(null),[M,p]=a.useState(!0),[h,_]=a.useState(!1),[v,I]=a.useState(!1),[o,C]=a.useState(""),[n,w]=a.useState(!1),[k,R]=a.useState(""),[g,P]=a.useState(""),[F,L]=a.useState("");a.useEffect(()=>{D()},[]);const D=async()=>{p(!0);try{const d=await je.me();U(d.data),C(d.data.email||"")}catch(d){t.error("Failed to load profile"),console.error(d)}finally{p(!1)}},i=async d=>{var T,j;if(d.preventDefault(),!o.trim()){t.error("Email is required");return}_(!0);try{const A=await je.updateProfile({email:o.trim()});U(A.data),t.success("Profile updated successfully")}catch(A){t.error(((j=(T=A.response)==null?void 0:T.data)==null?void 0:j.error)||"Failed to update profile")}finally{_(!1)}},m=async d=>{var T,j;if(d.preventDefault(),!k||!g){t.error("All password fields are required");return}if(g.length<6){t.error("New password must be at least 6 characters");return}if(g!==F){t.error("Passwords do not match");return}I(!0);try{await je.changePassword({current_password:k,new_password:g}),t.success("Password changed successfully"),w(!1),R(""),P(""),L("")}catch(A){t.error(((j=(T=A.response)==null?void 0:T.data)==null?void 0:j.error)||"Failed to change password")}finally{I(!1)}},r=d=>d?new Date(d).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"N/A";return M?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(J,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ke,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Profile Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg",children:e.jsx(ke,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Username"}),e.jsx("p",{className:"text-white font-medium",children:c==null?void 0:c.username})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(Z,{className:"h-5 w-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Roles"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:((l=c==null?void 0:c.roles)==null?void 0:l.map(d=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-primary/20 text-primary rounded capitalize",children:d},d)))||e.jsx("span",{className:"text-slate-400",children:"No roles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-lg",children:e.jsx(Te,{className:"h-5 w-5 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"Member Since"}),e.jsx("p",{className:"text-white",children:r(c==null?void 0:c.created_at)})]})]})]}),e.jsx("form",{onSubmit:i,className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-2",children:[e.jsx(Se,{className:"h-4 w-4"}),"Email Address"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(z,{type:"email",value:o,onChange:d=>C(d.target.value),placeholder:"your@email.com",className:"flex-1"}),e.jsxs(f,{type:"submit",variant:"primary",loading:h,disabled:h||o===(c==null?void 0:c.email),children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Save"]})]})]})})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ye,{className:"h-6 w-6 text-yellow-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Security"})]}),!n&&e.jsx(f,{variant:"secondary",onClick:()=>w(!0),children:"Change Password"})]}),n?e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsx(z,{label:"Current Password",type:"password",value:k,onChange:d=>R(d.target.value),placeholder:"Enter current password"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(z,{label:"New Password",type:"password",value:g,onChange:d=>P(d.target.value),placeholder:"Enter new password"}),e.jsx(z,{label:"Confirm New Password",type:"password",value:F,onChange:d=>L(d.target.value),placeholder:"Confirm new password"})]}),g&&F&&g!==F&&e.jsx("p",{className:"text-sm text-red-400",children:"Passwords do not match"}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:()=>{w(!1),R(""),P(""),L("")},children:"Cancel"}),e.jsx(f,{type:"submit",variant:"primary",loading:v,disabled:v||!k||!g||g!==F,children:"Update Password"})]})]}):e.jsx("p",{className:"text-slate-400",children:"Keep your account secure by using a strong, unique password."})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Z,{className:"h-6 w-6 text-green-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Account Status"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${(c==null?void 0:c.is_active)!==!1?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-white",children:(c==null?void 0:c.is_active)!==!1?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:"Your account is in good standing."})]})]})},fs=[{id:"admin",name:"Admin",description:"Full system access"},{id:"user",name:"User",description:"Standard user access"},{id:"auditor",name:"Auditor",description:"Read-only access to all scans"},{id:"viewer",name:"Viewer",description:"Limited view access"}],bs=()=>{const[c,U]=a.useState([]),[M,p]=a.useState([]),[h,_]=a.useState(!0),[v,I]=a.useState(!1),[o,C]=a.useState(new Set),[n,w]=a.useState(!1),[k,R]=a.useState(!0),[g,P]=a.useState(null),[F,L]=a.useState(!1);a.useEffect(()=>{D()},[]);const D=async()=>{var x;_(!0);try{const s=await ae.getUsers();U(s.data),R(!0)}catch(s){((x=s.response)==null?void 0:x.status)===403?R(!1):t.error("Failed to load users"),console.error(s)}finally{_(!1)}},i=async()=>{I(!0);try{const x=await ae.getAuditLogs(50);p(x.data)}catch(x){t.error("Failed to load audit logs"),console.error(x)}finally{I(!1)}},m=x=>{const s=new Set(o);s.has(x)?s.delete(x):s.add(x),C(s)},r=async x=>{var s,u;try{await ae.updateUser(x.id,{is_active:!x.is_active}),t.success(`User ${x.is_active?"deactivated":"activated"}`),D()}catch(N){t.error(((u=(s=N.response)==null?void 0:s.data)==null?void 0:u.error)||"Failed to update user")}},l=async()=>{var x,s;if(g){L(!0);try{await ae.deleteUser(g.id),t.success(`User "${g.username}" deleted successfully`),D(),P(null)}catch(u){t.error(((s=(x=u.response)==null?void 0:x.data)==null?void 0:s.error)||"Failed to delete user")}finally{L(!1)}}},d=async(x,s)=>{var u,N;try{await ae.assignRole(x,s),t.success("Role assigned"),D()}catch(H){t.error(((N=(u=H.response)==null?void 0:u.data)==null?void 0:N.error)||"Failed to assign role")}},T=async(x,s)=>{var u,N;try{await ae.removeRole(x,s),t.success("Role removed"),D()}catch(H){t.error(((N=(u=H.response)==null?void 0:u.data)==null?void 0:N.error)||"Failed to remove role")}},j=async x=>{var s,u;try{await ae.unlockUser(x.id),t.success(`Account "${x.username}" unlocked`),D()}catch(N){t.error(((u=(s=N.response)==null?void 0:s.data)==null?void 0:u.error)||"Failed to unlock account")}},A=x=>new Date(x).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),b=x=>{switch(x){case"admin":return"bg-red-500/20 text-red-400 border-red-500/30";case"user":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"auditor":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"viewer":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400 border-slate-500/30"}};return h?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(J,{})})}):k?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ss,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"User Management"})]}),e.jsxs(se,{variant:"status",type:"completed",children:[c.length," users"]})]}),e.jsx("div",{className:"space-y-3",children:c.map(x=>{const s=o.has(x.id),u=x.roles||[];return e.jsxs("div",{className:"bg-dark-bg rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>m(x.id),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"text-slate-400",children:s?e.jsx(Ke,{className:"h-4 w-4"}):e.jsx(ze,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${x.is_active!==!1?"bg-green-400":"bg-red-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:x.username}),e.jsx("p",{className:"text-sm text-slate-400",children:x.email})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex gap-1",children:u.map(N=>e.jsx("span",{className:`px-2 py-0.5 text-xs rounded border capitalize ${b(N)}`,children:N},N))}),x.is_locked&&e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded border bg-red-500/20 text-red-400 border-red-500/30 flex items-center gap-1",children:[e.jsx(ye,{className:"h-3 w-3"}),"Locked"]}),e.jsx("span",{className:"text-xs text-slate-500",children:x.created_at?A(x.created_at):"N/A"})]})]}),s&&e.jsxs("div",{className:"border-t border-dark-border p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),"Manage Roles"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:fs.map(N=>{const H=u.includes(N.id);return e.jsxs("button",{onClick:Y=>{Y.stopPropagation(),H?T(x.id,N.id):d(x.id,N.id)},className:`p-3 rounded-lg border text-left transition-colors ${H?"bg-primary/20 border-primary/50 text-primary":"bg-dark-surface border-dark-border text-slate-400 hover:border-primary/30"}`,children:[e.jsx("p",{className:"font-medium text-sm capitalize",children:N.name}),e.jsx("p",{className:"text-xs opacity-75",children:N.description})]},N.id)})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-dark-border",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{variant:x.is_active!==!1?"secondary":"primary",size:"sm",onClick:N=>{N.stopPropagation(),r(x)},children:x.is_active!==!1?e.jsxs(e.Fragment,{children:[e.jsx(ts,{className:"h-4 w-4 mr-1"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"h-4 w-4 mr-1"}),"Activate"]})}),x.is_locked&&e.jsxs(f,{variant:"primary",size:"sm",onClick:N=>{N.stopPropagation(),j(x)},children:[e.jsx(rs,{className:"h-4 w-4 mr-1"}),"Unlock Account"]})]}),e.jsxs(f,{variant:"secondary",size:"sm",onClick:N=>{N.stopPropagation(),P(x)},className:"text-red-400 hover:text-red-300 hover:bg-red-500/10","aria-label":`Delete user ${x.username}`,children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})]},x.id)})})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ls,{className:"h-6 w-6 text-purple-400"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Audit Logs"})]}),e.jsx(f,{variant:"secondary",onClick:()=>{w(!n),!n&&M.length===0&&i()},children:n?"Hide Logs":"Show Logs"})]}),n&&e.jsx(e.Fragment,{children:v?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(J,{})}):M.length===0?e.jsx("p",{className:"text-slate-400 text-center py-8",children:"No audit logs found"}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:M.map(x=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-dark-bg rounded-lg text-sm",children:[e.jsx(re,{className:"h-4 w-4 text-slate-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium text-white",children:x.action}),x.target_type&&e.jsxs("span",{className:"text-slate-400",children:["on ",x.target_type]}),x.target_id&&e.jsx("span",{className:"text-xs text-slate-500 font-mono truncate max-w-32",children:x.target_id})]}),x.details&&e.jsx("p",{className:"text-xs text-slate-500 mt-1 truncate",children:x.details})]}),e.jsx("span",{className:"text-xs text-slate-500 whitespace-nowrap",children:A(x.created_at)})]},x.id))})}),!n&&e.jsx("p",{className:"text-slate-400",children:"View a log of administrative actions performed in the system."})]}),e.jsx(ce,{isOpen:!!g,onClose:()=>P(null),onConfirm:l,title:"Delete User",message:`Are you sure you want to delete user "${g==null?void 0:g.username}"? All their data, including scans and settings, will be permanently removed.`,confirmLabel:"Delete User",variant:"danger",loading:F})]}):e.jsx(S,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(B,{className:"h-12 w-12 text-yellow-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-slate-400",children:"You don't have permission to access the administration panel."}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Contact an administrator if you need elevated access."})]})})},_e=["#ef4444","#f97316","#eab308","#22c55e","#14b8a6","#3b82f6","#8b5cf6","#ec4899","#6366f1","#64748b"],ys=()=>{const[c,U]=a.useState([]),[M,p]=a.useState(!0),[h,_]=a.useState(!1),[v,I]=a.useState(null),[o,C]=a.useState({name:"",description:"",targets:"",color:_e[0]}),[n,w]=a.useState(null),[k,R]=a.useState(!1);a.useEffect(()=>{g()},[]);const g=async()=>{p(!0);try{const m=await me.getAll();U(m.data)}catch(m){t.error("Failed to load target groups"),console.error(m)}finally{p(!1)}},P=()=>{C({name:"",description:"",targets:"",color:_e[0]}),I(null),_(!1)},F=m=>{const r=JSON.parse(m.targets||"[]");C({name:m.name,description:m.description||"",targets:r.join(`
`),color:m.color}),I(m.id),_(!0)},L=async m=>{var l,d;m.preventDefault();const r=o.targets.split(`
`).map(T=>T.trim()).filter(T=>T.length>0);if(!o.name.trim()){t.error("Name is required");return}if(r.length===0){t.error("At least one target is required");return}try{v?(await me.update(v,{name:o.name,description:o.description||void 0,targets:r,color:o.color}),t.success("Target group updated")):(await me.create({name:o.name,description:o.description||void 0,targets:r,color:o.color}),t.success("Target group created")),P(),g()}catch(T){t.error(((d=(l=T.response)==null?void 0:l.data)==null?void 0:d.error)||"Failed to save target group")}},D=async()=>{var m,r;if(n){R(!0);try{await me.delete(n.id),t.success(`Target group "${n.name}" deleted`),g(),w(null)}catch(l){t.error(((r=(m=l.response)==null?void 0:m.data)==null?void 0:r.error)||"Failed to delete")}finally{R(!1)}}},i=m=>{try{return JSON.parse(m||"[]")}catch{return[]}};return M?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(J,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Target Groups"})]}),!h&&e.jsxs(f,{variant:"primary",onClick:()=>_(!0),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"New Group"]})]})}),h&&e.jsx(S,{children:e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:v?"Edit Target Group":"Create Target Group"}),e.jsx("button",{type:"button",onClick:P,className:"text-slate-400 hover:text-white",children:e.jsx(Ne,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:o.name,onChange:m=>C({...o,name:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Production Servers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Color"}),e.jsx("div",{className:"flex gap-2",children:_e.map(m=>e.jsx("button",{type:"button",onClick:()=>C({...o,color:m}),className:`w-8 h-8 rounded-full border-2 transition-all ${o.color===m?"border-white scale-110":"border-transparent"}`,style:{backgroundColor:m}},m))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:o.description,onChange:m=>C({...o,description:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Targets (one per line)"}),e.jsx("textarea",{value:o.targets,onChange:m=>C({...o,targets:m.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:5,placeholder:`192.168.1.0/24
10.0.0.1
example.com`})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:P,children:"Cancel"}),e.jsxs(f,{type:"submit",variant:"primary",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),v?"Update":"Create"]})]})]})}),c.length===0&&!h?e.jsx(S,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ns,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No target groups yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create groups to organize your scan targets"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(m=>{const r=i(m.targets);return e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:m.color}}),e.jsx("h4",{className:"font-medium text-white",children:m.name})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>F(m),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>w(m),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete target group ${m.name}`,children:e.jsx(le,{className:"h-4 w-4"})})]})]}),m.description&&e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:m.description}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:[r.length," target",r.length!==1?"s":""]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[r.slice(0,5).map((l,d)=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-300 font-mono",children:l},d)),r.length>5&&e.jsxs("span",{className:"px-2 py-0.5 text-xs bg-dark-bg rounded text-slate-500",children:["+",r.length-5," more"]})]})]})]},m.id)})}),e.jsx(ce,{isOpen:!!n,onClose:()=>w(null),onConfirm:D,title:"Delete Target Group",message:`Are you sure you want to delete the target group "${n==null?void 0:n.name}"? Scheduled scans using this group will need to be updated.`,confirmLabel:"Delete Group",variant:"danger",loading:k})]})},$e={name:"",description:"",schedule_type:"daily",schedule_value:"02:00",targets:"",port_range_start:1,port_range_end:1e3,threads:100,enable_os_detection:!0,enable_service_detection:!0,enable_vuln_scan:!0,enable_enumeration:!1},Oe=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Ns=()=>{const[c,U]=a.useState([]),[M,p]=a.useState([]),[h,_]=a.useState(!0),[v,I]=a.useState(!1),[o,C]=a.useState(null),[n,w]=a.useState($e),[k,R]=a.useState(0),[g,P]=a.useState(1),[F,L]=a.useState(null),[D,i]=a.useState(!1);a.useEffect(()=>{m()},[]);const m=async()=>{_(!0);try{const[s,u]=await Promise.all([de.getAll(),me.getAll()]);U(s.data),p(u.data)}catch(s){t.error("Failed to load scheduled scans"),console.error(s)}finally{_(!1)}},r=()=>{w($e),C(null),I(!1),R(0),P(1)},l=s=>{const u=JSON.parse(s.config);if(w({name:s.name,description:s.description||"",schedule_type:s.schedule_type,schedule_value:s.schedule_value,targets:u.targets.join(`
`),port_range_start:u.port_range[0],port_range_end:u.port_range[1],threads:u.threads,enable_os_detection:u.enable_os_detection,enable_service_detection:u.enable_service_detection,enable_vuln_scan:u.enable_vuln_scan,enable_enumeration:u.enable_enumeration}),s.schedule_type==="weekly"){const N=s.schedule_value.split(" ");N.length>=2&&R(parseInt(N[1])||0)}else if(s.schedule_type==="monthly"){const N=s.schedule_value.split(" ");N.length>=2&&P(parseInt(N[1])||1)}C(s.id),I(!0)},d=()=>{const s=n.schedule_value.includes(":")?n.schedule_value:"02:00";switch(n.schedule_type){case"daily":return s;case"weekly":return`${s} ${k}`;case"monthly":return`${s} ${g}`;default:return s}},T=async s=>{var Y,y;s.preventDefault();const u=n.targets.split(`
`).map(E=>E.trim()).filter(E=>E.length>0);if(!n.name.trim()){t.error("Name is required");return}if(u.length===0){t.error("At least one target is required");return}const N={targets:u,port_range:[n.port_range_start,n.port_range_end],threads:n.threads,enable_os_detection:n.enable_os_detection,enable_service_detection:n.enable_service_detection,enable_vuln_scan:n.enable_vuln_scan,enable_enumeration:n.enable_enumeration},H=d();try{o?(await de.update(o,{name:n.name,description:n.description||void 0,config:N,schedule_type:n.schedule_type,schedule_value:H}),t.success("Scheduled scan updated")):(await de.create({name:n.name,description:n.description||void 0,config:N,schedule_type:n.schedule_type,schedule_value:H}),t.success("Scheduled scan created")),r(),m()}catch(E){t.error(((y=(Y=E.response)==null?void 0:Y.data)==null?void 0:y.error)||"Failed to save scheduled scan")}},j=async s=>{var u,N;try{await de.update(s.id,{is_active:!s.is_active}),t.success(`Scheduled scan ${s.is_active?"paused":"activated"}`),m()}catch(H){t.error(((N=(u=H.response)==null?void 0:u.data)==null?void 0:N.error)||"Failed to update")}},A=async()=>{var s,u;if(F){i(!0);try{await de.delete(F.id),t.success(`Scheduled scan "${F.name}" deleted`),m(),L(null)}catch(N){t.error(((u=(s=N.response)==null?void 0:s.data)==null?void 0:u.error)||"Failed to delete")}finally{i(!1)}}},b=s=>{const u=JSON.parse(s.targets||"[]");w(N=>({...N,targets:u.join(`
`)}))},x=s=>{const u=s.schedule_value.split(" "),N=u[0];switch(s.schedule_type){case"daily":return`Daily at ${N}`;case"weekly":return`Every ${Oe[parseInt(u[1])||0]} at ${N}`;case"monthly":return`Monthly on day ${u[1]||1} at ${N}`;default:return s.schedule_value}};return h?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(J,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scheduled Scans"})]}),!v&&e.jsxs(f,{variant:"primary",onClick:()=>I(!0),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"New Schedule"]})]})}),v&&e.jsx(S,{children:e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:o?"Edit Scheduled Scan":"Create Scheduled Scan"}),e.jsx("button",{type:"button",onClick:r,className:"text-slate-400 hover:text-white",children:e.jsx(Ne,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:n.name,onChange:s=>w({...n,name:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Daily Network Scan"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:n.description,onChange:s=>w({...n,description:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Optional description"})]})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(Te,{className:"h-4 w-4"})," Schedule"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Frequency"}),e.jsxs("select",{value:n.schedule_type,onChange:s=>w({...n,schedule_type:s.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),n.schedule_type==="weekly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Week"}),e.jsx("select",{value:k,onChange:s=>R(parseInt(s.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Oe.map((s,u)=>e.jsx("option",{value:u,children:s},s))})]}),n.schedule_type==="monthly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Day of Month"}),e.jsx("select",{value:g,onChange:s=>P(parseInt(s.target.value)),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white",children:Array.from({length:28},(s,u)=>u+1).map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Time (UTC)"}),e.jsx("input",{type:"time",value:n.schedule_value.split(" ")[0],onChange:s=>w({...n,schedule_value:s.target.value}),className:"w-full bg-dark-surface border border-dark-border rounded-lg px-3 py-2 text-white"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Targets (one per line)"}),M.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Use group:"}),M.slice(0,3).map(s=>e.jsx("button",{type:"button",onClick:()=>b(s),className:"px-2 py-0.5 text-xs rounded border border-dark-border text-slate-400 hover:text-white hover:border-primary",style:{borderLeftColor:s.color,borderLeftWidth:3},children:s.name},s.id))]})]}),e.jsx("textarea",{value:n.targets,onChange:s=>w({...n,targets:s.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",rows:4,placeholder:`192.168.1.0/24
10.0.0.1`})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port Start"}),e.jsx("input",{type:"number",value:n.port_range_start,onChange:s=>w({...n,port_range_start:parseInt(s.target.value)||1}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Port End"}),e.jsx("input",{type:"number",value:n.port_range_end,onChange:s=>w({...n,port_range_end:parseInt(s.target.value)||1e3}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:65535})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Threads"}),e.jsx("input",{type:"number",value:n.threads,onChange:s=>w({...n,threads:parseInt(s.target.value)||100}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white",min:1,max:1e3})]})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:[{key:"enable_os_detection",label:"OS Detection"},{key:"enable_service_detection",label:"Service Detection"},{key:"enable_vuln_scan",label:"Vulnerability Scan"},{key:"enable_enumeration",label:"Enumeration"}].map(({key:s,label:u})=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n[s],onChange:N=>w({...n,[s]:N.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm text-slate-300",children:u})]},s))}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:r,children:"Cancel"}),e.jsxs(f,{type:"submit",variant:"primary",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),o?"Update":"Create"]})]})]})}),c.length===0&&!v?e.jsx(S,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(re,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scheduled scans"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create automated recurring scans"})]})}):e.jsx("div",{className:"space-y-3",children:c.map(s=>{const u=JSON.parse(s.config);return e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.is_active?"bg-green-500/20":"bg-slate-500/20"}`,children:e.jsx(re,{className:`h-5 w-5 ${s.is_active?"text-green-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-white",children:s.name}),e.jsx(se,{variant:"status",type:s.is_active?"completed":"pending",children:s.is_active?"Active":"Paused"})]}),e.jsx("p",{className:"text-sm text-slate-400",children:x(s)}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[u.targets.length," target",u.targets.length!==1?"s":""," | Ports ",u.port_range[0],"-",u.port_range[1]," |",s.run_count," runs",s.last_run_at&&e.jsxs(e.Fragment,{children:[" | Last run ",Qe(new Date(s.last_run_at))," ago"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>j(s),className:`p-2 rounded transition-colors ${s.is_active?"text-yellow-400 hover:bg-yellow-500/20":"text-green-400 hover:bg-green-500/20"}`,title:s.is_active?"Pause":"Activate",children:s.is_active?e.jsx(is,{className:"h-4 w-4"}):e.jsx(qe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>l(s),className:"p-2 text-slate-400 hover:text-primary transition-colors",children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>L(s),className:"p-2 text-slate-400 hover:text-red-400 transition-colors","aria-label":`Delete scheduled scan ${s.name}`,children:e.jsx(le,{className:"h-4 w-4"})})]})]})},s.id)})}),e.jsx(ce,{isOpen:!!F,onClose:()=>L(null),onConfirm:A,title:"Delete Scheduled Scan",message:`Are you sure you want to delete the scheduled scan "${F==null?void 0:F.name}"? Future automated scans will no longer run.`,confirmLabel:"Delete Schedule",variant:"warning",loading:D})]})},vs=()=>{const[c,U]=a.useState(null),[M,p]=a.useState(!0),[h,_]=a.useState(!1),[v,I]=a.useState(!1),[o,C]=a.useState(!1),[n,w]=a.useState(!1),[k,R]=a.useState(null),[g,P]=a.useState({email_on_scan_complete:!1,email_on_critical_vuln:!0,email_address:"",slack_webhook_url:"",teams_webhook_url:""});a.useEffect(()=>{F(),L()},[]);const F=async()=>{var l;p(!0);try{const d=await Q.getSettings();U(d.data),P({email_on_scan_complete:d.data.email_on_scan_complete,email_on_critical_vuln:d.data.email_on_critical_vuln,email_address:d.data.email_address||"",slack_webhook_url:d.data.slack_webhook_url||"",teams_webhook_url:d.data.teams_webhook_url||""})}catch(d){((l=d.response)==null?void 0:l.status)!==404&&(t.error("Failed to load notification settings"),console.error(d))}finally{p(!1)}},L=async()=>{try{const l=await Q.checkSmtpStatus();R(l.data.configured)}catch(l){console.error("Failed to check SMTP status:",l),R(!1)}},D=async l=>{var d,T;if(l.preventDefault(),(g.email_on_scan_complete||g.email_on_critical_vuln)&&!g.email_address){t.error("Email address is required when notifications are enabled");return}_(!0);try{const j=await Q.updateSettings(g);U(j.data),t.success("Notification settings saved")}catch(j){t.error(((T=(d=j.response)==null?void 0:d.data)==null?void 0:T.error)||"Failed to save settings")}finally{_(!1)}},i=async()=>{var l,d;if(!g.slack_webhook_url){t.error("Please enter a Slack webhook URL first");return}I(!0);try{g.slack_webhook_url!==(c==null?void 0:c.slack_webhook_url)&&await Q.updateSettings({slack_webhook_url:g.slack_webhook_url});const T=await Q.testSlack();t.success(T.data.message)}catch(T){t.error(((d=(l=T.response)==null?void 0:l.data)==null?void 0:d.error)||"Failed to send test message")}finally{I(!1)}},m=async()=>{var l,d;if(!g.teams_webhook_url){t.error("Please enter a Teams webhook URL first");return}C(!0);try{g.teams_webhook_url!==(c==null?void 0:c.teams_webhook_url)&&await Q.updateSettings({teams_webhook_url:g.teams_webhook_url});const T=await Q.testTeams();t.success(T.data.message)}catch(T){t.error(((d=(l=T.response)==null?void 0:l.data)==null?void 0:d.error)||"Failed to send test message")}finally{C(!1)}},r=async()=>{var l,d;if(!g.email_address){t.error("Please enter an email address first");return}if(!k){t.error("SMTP is not configured on the server. Contact your administrator.");return}w(!0);try{g.email_address!==(c==null?void 0:c.email_address)&&await Q.updateSettings({email_address:g.email_address});const T=await Q.testEmail();t.success(T.data.message)}catch(T){t.error(((d=(l=T.response)==null?void 0:l.data)==null?void 0:d.error)||"Failed to send test email")}finally{w(!1)}};return M?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(J,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(He,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Notification Settings"})]}),e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Notification Email Address"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Se,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"email",value:g.email_address,onChange:l=>P({...g,email_address:l.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg pl-10 pr-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"your@email.com"})]}),e.jsx(f,{type:"button",variant:"secondary",onClick:r,disabled:!g.email_address||n||!k,title:k?"Send test email":"SMTP not configured on server",children:n?e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx("span",{className:"ml-2",children:"Sending..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Email address where notifications will be sent"}),k!==null&&e.jsx("span",{className:`text-xs flex items-center gap-1 ${k?"text-green-400":"text-amber-400"}`,children:k?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-3 w-3"}),"SMTP configured"]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"h-3 w-3"}),"SMTP not configured"]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Email Notifications"}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:g.email_on_scan_complete,onChange:l=>P({...g,email_on_scan_complete:l.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"font-medium text-white",children:"Scan Completion"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Receive an email when any of your scans complete, including a summary of findings"})]})]}),e.jsxs("label",{className:"flex items-start gap-4 p-4 bg-dark-bg rounded-lg border border-dark-border cursor-pointer hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:g.email_on_critical_vuln,onChange:l=>P({...g,email_on_critical_vuln:l.target.checked}),className:"mt-1 w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"font-medium text-white",children:"Critical Vulnerabilities"})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Get immediate alerts when critical or high severity vulnerabilities are discovered"})]})]})]}),k===!1?e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(B,{className:"h-5 w-5 text-amber-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-200",children:"SMTP is not configured on this server. Email notifications are disabled."}),e.jsx("p",{className:"text-xs text-amber-300/70 mt-1",children:"Contact your administrator to configure SMTP settings (SMTP_HOST, SMTP_USER, etc.)"})]})]})}):e.jsx("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Se,{className:"h-5 w-5 text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-200",children:k?"Email notifications are ready. Use the Test button to verify delivery.":"Checking SMTP configuration..."}),e.jsx("p",{className:"text-xs text-blue-300/70 mt-1",children:"Contact your administrator if you're not receiving emails."})]})]})}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-dark-border",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(cs,{className:"h-4 w-4"}),"Webhook Integrations"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Slack Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:g.slack_webhook_url,onChange:l=>P({...g,slack_webhook_url:l.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://hooks.slack.com/services/YOUR/WEBHOOK/URL"}),e.jsx(f,{type:"button",variant:"secondary",onClick:i,disabled:!g.slack_webhook_url||v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Send scan notifications to a Slack channel. Create a webhook at"," ",e.jsx("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Slack Incoming Webhooks"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Microsoft Teams Webhook URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:g.teams_webhook_url,onChange:l=>P({...g,teams_webhook_url:l.target.value}),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://outlook.office.com/webhook/YOUR/WEBHOOK/URL"}),e.jsx(f,{type:"button",variant:"secondary",onClick:m,disabled:!g.teams_webhook_url||o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx("span",{className:"ml-2",children:"Testing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Test"]})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Send scan notifications to a Teams channel. Create a webhook in your Teams channel connectors."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(f,{type:"submit",variant:"primary",disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Save Settings"]})})})]})]}),c&&e.jsxs(S,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"Current Status"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Scan Complete Emails:"}),e.jsx("span",{className:`ml-2 ${c.email_on_scan_complete?"text-green-400":"text-slate-400"}`,children:c.email_on_scan_complete?"Enabled":"Disabled"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Critical Vuln Alerts:"}),e.jsx("span",{className:`ml-2 ${c.email_on_critical_vuln?"text-green-400":"text-slate-400"}`,children:c.email_on_critical_vuln?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-slate-500",children:"Last Updated:"}),e.jsx("span",{className:"ml-2 text-slate-300",children:new Date(c.updated_at).toLocaleString()})]})]})]})]})},ws=()=>{const[c,U]=a.useState([]),[M,p]=a.useState(!0),[h,_]=a.useState(""),[v,I]=a.useState(""),[o,C]=a.useState(!1),[n,w]=a.useState(null),[k,R]=a.useState(new Set);a.useEffect(()=>{g()},[]);const g=async()=>{p(!0);try{const m=(await Je.getAll()).data.filter(r=>r.status==="completed");U(m)}catch(i){t.error("Failed to load scans"),console.error(i)}finally{p(!1)}},P=async()=>{var i,m;if(!h||!v){t.error("Please select two scans to compare");return}if(h===v){t.error("Please select two different scans");return}C(!0);try{const r=await Xe.compare(h,v);w(r.data),t.success("Comparison completed")}catch(r){t.error(((m=(i=r.response)==null?void 0:i.data)==null?void 0:m.error)||"Failed to compare scans"),console.error(r)}finally{C(!1)}},F=i=>{const m=new Set(k);m.has(i)?m.delete(i):m.add(i),R(m)},L=i=>{switch(i){case"NewService":return e.jsx(G,{className:"h-3 w-3 text-green-400"});case"ServiceRemoved":return e.jsx(ne,{className:"h-3 w-3 text-red-400"});case"ServiceChanged":case"VersionChanged":return e.jsx(fe,{className:"h-3 w-3 text-yellow-400"});default:return null}},D=i=>{switch(i){case"NewService":return"New Service";case"ServiceRemoved":return"Service Removed";case"ServiceChanged":return"Service Changed";case"VersionChanged":return"Version Changed";default:return i}};return M?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(J,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ce,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Compare Scans"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"Select two completed scans to compare their results and identify changes in hosts, ports, services, and vulnerabilities."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Baseline Scan (Older)"}),e.jsxs("select",{value:h,onChange:i=>_(i.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a scan..."}),c.map(i=>e.jsxs("option",{value:i.id,children:[i.name," - ",new Date(i.created_at).toLocaleString()]},i.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Comparison Scan (Newer)"}),e.jsxs("select",{value:v,onChange:i=>I(i.target.value),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select a scan..."}),c.map(i=>e.jsxs("option",{value:i.id,children:[i.name," - ",new Date(i.created_at).toLocaleString()]},i.id))]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(f,{variant:"primary",onClick:P,loading:o,disabled:!h||!v||h===v,children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Compare Scans"]})})]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ds,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Comparison Summary"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(G,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"New Hosts"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:n.diff.summary.total_new_hosts})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ne,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Removed"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:n.diff.summary.total_removed_hosts})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-yellow-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(fe,{className:"h-4 w-4 text-yellow-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Changed"})]}),e.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:n.diff.summary.total_hosts_changed})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Re,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"New Ports"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:n.diff.summary.total_new_ports})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Re,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Closed"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:n.diff.summary.total_closed_ports})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(B,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"New Vulns"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:n.diff.summary.total_new_vulnerabilities})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(W,{className:"h-4 w-4 text-green-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Resolved"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:n.diff.summary.total_resolved_vulnerabilities})]})]})]}),n.diff.new_hosts.length>0&&e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(G,{className:"h-5 w-5 text-green-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["New Hosts (",n.diff.new_hosts.length,")"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.diff.new_hosts.map(i=>e.jsx("span",{className:"px-3 py-1.5 bg-green-500/20 border border-green-500/30 rounded-lg text-green-400 font-mono text-sm",children:i},i))})]}),n.diff.removed_hosts.length>0&&e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ne,{className:"h-5 w-5 text-red-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Removed Hosts (",n.diff.removed_hosts.length,")"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.diff.removed_hosts.map(i=>e.jsx("span",{className:"px-3 py-1.5 bg-red-500/20 border border-red-500/30 rounded-lg text-red-400 font-mono text-sm",children:i},i))})]}),n.diff.host_changes.length>0&&e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Pe,{className:"h-5 w-5 text-yellow-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Host Changes (",n.diff.host_changes.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:n.diff.host_changes.map(i=>{const m=k.has(i.ip);return i.new_ports.length>0||i.closed_ports.length>0||i.new_vulnerabilities.length>0||i.resolved_vulnerabilities.length>0||i.service_changes.length>0||i.os_change!==null?e.jsxs("div",{className:"bg-dark-bg rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("button",{onClick:()=>F(i.ip),className:"w-full flex items-center justify-between p-4 hover:bg-dark-hover transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[m?e.jsx(Ke,{className:"h-4 w-4 text-slate-400"}):e.jsx(ze,{className:"h-4 w-4 text-slate-400"}),e.jsx(Pe,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"font-mono text-white",children:i.ip}),i.hostname&&e.jsxs("span",{className:"text-sm text-slate-400",children:["(",i.hostname,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.new_ports.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-green-500/20 border border-green-500/30 rounded text-xs text-green-400",children:["+",i.new_ports.length," ports"]}),i.closed_ports.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 border border-red-500/30 rounded text-xs text-red-400",children:["-",i.closed_ports.length," ports"]}),i.new_vulnerabilities.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 border border-red-500/30 rounded text-xs text-red-400",children:["+",i.new_vulnerabilities.length," vulns"]}),i.resolved_vulnerabilities.length>0&&e.jsxs("span",{className:"px-2 py-1 bg-green-500/20 border border-green-500/30 rounded text-xs text-green-400",children:["-",i.resolved_vulnerabilities.length," vulns"]})]})]}),m&&e.jsxs("div",{className:"border-t border-dark-border p-4 space-y-4",children:[i.os_change&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-slate-300 mb-2",children:"Operating System Change"}),e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-3 w-3 text-red-400"}),e.jsxs("span",{className:"text-sm text-red-400",children:[i.os_change.old_os," (",i.os_change.old_confidence,"% confidence)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-3 w-3 text-green-400"}),e.jsxs("span",{className:"text-sm text-green-400",children:[i.os_change.new_os," (",i.os_change.new_confidence,"% confidence)"]})]})]})]}),i.new_ports.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4 text-green-400"}),"New Open Ports (",i.new_ports.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:i.new_ports.map(l=>e.jsxs("div",{className:"bg-dark-surface rounded p-2 flex items-center justify-between",children:[e.jsxs("span",{className:"font-mono text-sm text-green-400",children:[l.port,"/",l.protocol]}),l.service&&e.jsxs("span",{className:"text-xs text-slate-400",children:[l.service.name,l.service.version&&` ${l.service.version}`]})]},l.port))})]}),i.closed_ports.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4 text-red-400"}),"Closed Ports (",i.closed_ports.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:i.closed_ports.map(l=>e.jsxs("div",{className:"bg-dark-surface rounded p-2 flex items-center justify-between",children:[e.jsxs("span",{className:"font-mono text-sm text-red-400",children:[l.port,"/",l.protocol]}),l.service&&e.jsxs("span",{className:"text-xs text-slate-400",children:[l.service.name,l.service.version&&` ${l.service.version}`]})]},l.port))})]}),i.service_changes.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-yellow-400"}),"Service Changes (",i.service_changes.length,")"]}),e.jsx("div",{className:"space-y-2",children:i.service_changes.map((l,d)=>e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-mono text-sm text-white",children:[l.port,"/",l.protocol]}),e.jsxs("div",{className:"flex items-center gap-2",children:[L(l.change_type),e.jsx("span",{className:"text-xs text-yellow-400",children:D(l.change_type)})]})]}),l.old_service&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ne,{className:"h-3 w-3 text-red-400"}),e.jsxs("span",{className:"text-red-400",children:[l.old_service,l.old_version&&` ${l.old_version}`]})]}),l.new_service&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(G,{className:"h-3 w-3 text-green-400"}),e.jsxs("span",{className:"text-green-400",children:[l.new_service,l.new_version&&` ${l.new_version}`]})]})]},d))})]}),i.new_vulnerabilities.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4 text-red-400"}),"New Vulnerabilities (",i.new_vulnerabilities.length,")"]}),e.jsx("div",{className:"space-y-2",children:i.new_vulnerabilities.map((l,d)=>e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-white",children:l.cve_id||l.title}),e.jsx(se,{variant:"severity",type:De(l.severity),children:l.severity})]}),e.jsx("p",{className:"text-xs text-slate-400",children:l.description}),l.affected_service&&e.jsxs("span",{className:"text-xs text-slate-500",children:["Service: ",l.affected_service]})]},d))})]}),i.resolved_vulnerabilities.length>0&&e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-green-400"}),"Resolved Vulnerabilities (",i.resolved_vulnerabilities.length,")"]}),e.jsx("div",{className:"space-y-2",children:i.resolved_vulnerabilities.map((l,d)=>e.jsxs("div",{className:"bg-dark-surface rounded p-3 space-y-1 opacity-75",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-green-400 line-through",children:l.cve_id||l.title}),e.jsx(se,{variant:"severity",type:De(l.severity),children:l.severity})]}),e.jsx("p",{className:"text-xs text-slate-500",children:l.description})]},d))})]})]})]},i.ip):null})})]}),n.diff.new_hosts.length===0&&n.diff.removed_hosts.length===0&&n.diff.host_changes.length===0&&e.jsx(S,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(W,{className:"h-12 w-12 text-green-400 mx-auto mb-4"}),e.jsx("p",{className:"text-lg text-white font-medium mb-2",children:"No Changes Detected"}),e.jsx("p",{className:"text-sm text-slate-400",children:"The selected scans have identical results"})]})})]}),!n&&c.length===0&&e.jsx(S,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Z,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No completed scans available"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Complete at least two scans to use the comparison feature"})]})})]})},_s=()=>{const[c,U]=a.useState([]),[M,p]=a.useState(!0),[h,_]=a.useState(!1),[v,I]=a.useState(null),[o,C]=a.useState({name:"",description:""}),[n,w]=a.useState(new Set),[k,R]=a.useState(null),[g,P]=a.useState(!1),{addScan:F}=Ze();a.useEffect(()=>{L()},[]);const L=async()=>{p(!0);try{const j=await pe.getAll();U(j.data)}catch(j){t.error("Failed to load templates"),console.error(j)}finally{p(!1)}},D=()=>{C({name:"",description:""}),I(null),_(!1)},i=j=>{C({name:j.name,description:j.description||""}),I(j.id),_(!0)},m=async j=>{var A,b;if(j.preventDefault(),!o.name.trim()){t.error("Name is required");return}if(!v){t.error('Cannot create templates from this form. Use "Save as Template" in the scan form.');return}try{await pe.update(v,{name:o.name,description:o.description||void 0}),t.success("Template updated"),D(),L()}catch(x){t.error(((b=(A=x.response)==null?void 0:A.data)==null?void 0:b.error)||"Failed to update template")}},r=async()=>{var j,A;if(k){P(!0);try{await pe.delete(k.id),t.success(`Template "${k.name}" deleted`),L(),R(null)}catch(b){t.error(((A=(j=b.response)==null?void 0:j.data)==null?void 0:A.error)||"Failed to delete")}finally{P(!1)}}},l=async(j,A)=>{var x,s;const b=prompt(`Enter name for new scan (based on "${A}"):`,`${A} - ${new Date().toLocaleDateString()}`);if(b){w(new Set([...n,j]));try{const u=await pe.createScan(j,b);F(u.data),t.success("Scan started from template!")}catch(u){t.error(((s=(x=u.response)==null?void 0:x.data)==null?void 0:s.error)||"Failed to create scan")}finally{w(u=>{const N=new Set(u);return N.delete(j),N})}}},d=j=>{try{return JSON.parse(j)}catch{return null}},T=j=>new Date(j).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return M?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(J,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Scan Templates"})]}),e.jsx("div",{className:"text-sm text-slate-400",children:"Save scan configurations for quick reuse"})]})}),h&&e.jsx(S,{children:e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Edit Template"}),e.jsx("button",{type:"button",onClick:D,className:"text-slate-400 hover:text-white",children:e.jsx(Ne,{className:"h-5 w-5"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:o.name,onChange:j=>C({...o,name:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Production Network Template"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Description"}),e.jsx("textarea",{value:o.description,onChange:j=>C({...o,description:j.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",rows:3,placeholder:"Optional description"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:D,children:"Cancel"}),e.jsxs(f,{type:"submit",variant:"primary",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Update"]})]})]})}),c.length===0&&!h?e.jsx(S,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ae,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No scan templates yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:'Save scan configurations using "Save as Template" when creating a scan'})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:c.map(j=>{const A=d(j.config),b=n.has(j.id);return e.jsx(S,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-white text-lg",children:j.name}),j.description&&e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:j.description})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>i(j),className:"p-1.5 text-slate-400 hover:text-primary transition-colors",title:"Edit template",children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>R(j),className:"p-1.5 text-slate-400 hover:text-red-400 transition-colors",title:"Delete template","aria-label":`Delete template ${j.name}`,children:e.jsx(le,{className:"h-4 w-4"})})]})]}),A&&e.jsxs("div",{className:"space-y-2 border-t border-dark-border pt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:[A.targets.length," target",A.targets.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(os,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Ports: ",A.port_range[0],"-",A.port_range[1]]})]}),A.scan_type&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-slate-400 capitalize",children:A.scan_type.replace("_"," ")})]}),A.enable_enumeration&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xs,{className:"h-4 w-4 text-slate-500"}),e.jsxs("span",{className:"text-slate-400",children:["Enumeration: ",A.enum_depth||"light"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[A.enable_os_detection&&e.jsx(se,{variant:"status",type:"completed",children:"OS Detection"}),A.enable_service_detection&&e.jsx(se,{variant:"status",type:"completed",children:"Services"}),A.enable_vuln_scan&&e.jsx(se,{variant:"status",type:"running",children:"Vuln Scan"}),A.enable_enumeration&&e.jsx(se,{variant:"status",type:"pending",children:"Enumeration"})]})]}),e.jsxs("div",{className:"flex items-center justify-between border-t border-dark-border pt-4",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:["Created ",T(j.created_at)]}),e.jsxs(f,{variant:"primary",size:"sm",onClick:()=>l(j.id,j.name),loading:b,disabled:b,children:[e.jsx(hs,{className:"h-4 w-4 mr-1.5"}),"Create Scan"]})]})]})},j.id)})}),e.jsx(ce,{isOpen:!!k,onClose:()=>R(null),onConfirm:r,title:"Delete Template",message:`Are you sure you want to delete the template "${k==null?void 0:k.name}"? This will not affect any scans previously created from this template.`,confirmLabel:"Delete Template",variant:"danger",loading:g})]})},ks=()=>{const[c,U]=a.useState(!1),[M,p]=a.useState(!0),[h,_]=a.useState("idle"),[v,I]=a.useState(""),[o,C]=a.useState(""),[n,w]=a.useState([]),[k,R]=a.useState(""),[g,P]=a.useState(!1),[F,L]=a.useState(!1),[D,i]=a.useState(""),[m,r]=a.useState(""),[l,d]=a.useState(!1),[T,j]=a.useState(!1),[A,b]=a.useState(""),[x,s]=a.useState(""),[u,N]=a.useState(!1);a.useEffect(()=>{H()},[]);const H=async()=>{p(!0);try{const V=await je.me();U(V.data.mfa_enabled||!1)}catch(V){console.error("Failed to check MFA status:",V)}finally{p(!1)}},Y=async()=>{var V,q;try{const K=await ge.setup();I(K.data.secret),C(K.data.qr_code_url),w(K.data.recovery_codes),_("scan-qr")}catch(K){t.error(((q=(V=K.response)==null?void 0:V.data)==null?void 0:q.error)||"Failed to initialize MFA setup")}},y=async V=>{var q,K;if(V.preventDefault(),!k||k.length!==6){t.error("Please enter a valid 6-digit code");return}P(!0);try{await ge.verifySetup({totp_code:k}),t.success("MFA enabled successfully!"),_("show-recovery"),U(!0)}catch(te){t.error(((K=(q=te.response)==null?void 0:q.data)==null?void 0:K.error)||"Invalid verification code")}finally{P(!1)}},E=()=>{_("idle"),I(""),C(""),w([]),R("")},O=async V=>{var q,K;if(V.preventDefault(),!D||!m){t.error("Password and TOTP code are required");return}d(!0);try{await ge.disable({password:D,totp_code:m}),t.success("MFA disabled successfully"),U(!1),L(!1),i(""),r("")}catch(te){t.error(((K=(q=te.response)==null?void 0:q.data)==null?void 0:K.error)||"Failed to disable MFA")}finally{d(!1)}},$=async V=>{var q,K;if(V.preventDefault(),!A||!x){t.error("Password and TOTP code are required");return}N(!0);try{const te=await ge.regenerateRecoveryCodes({password:A,totp_code:x});w(te.data.recovery_codes),t.success("Recovery codes regenerated successfully"),j(!1),b(""),s(""),_("show-recovery")}catch(te){t.error(((K=(q=te.response)==null?void 0:q.data)==null?void 0:K.error)||"Failed to regenerate recovery codes")}finally{N(!1)}},ee=V=>{navigator.clipboard.writeText(V),t.success("Copied to clipboard")},ue=()=>{const V=new Blob([n.join(`
`)],{type:"text/plain"}),q=URL.createObjectURL(V),K=document.createElement("a");K.href=q,K.download="heroforge-recovery-codes.txt",document.body.appendChild(K),K.click(),document.body.removeChild(K),URL.revokeObjectURL(q),t.success("Recovery codes downloaded")};return M?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(J,{})})}):h!=="idle"?e.jsx("div",{className:"space-y-6",children:e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Enable Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{className:h==="scan-qr"?"text-primary":"",children:"1. Scan QR"}),e.jsx("span",{children:""}),e.jsx("span",{className:h==="verify-code"?"text-primary":"",children:"2. Verify"}),e.jsx("span",{children:""}),e.jsx("span",{className:h==="show-recovery"?"text-primary":"",children:"3. Save Codes"})]})]}),h==="scan-qr"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 1: Scan QR Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Use an authenticator app like Google Authenticator, Authy, or 1Password to scan this QR code:"}),o&&e.jsx("div",{className:"bg-white p-4 rounded-lg mb-4",children:e.jsx("img",{src:o,alt:"MFA QR Code",className:"w-64 h-64"})}),e.jsxs("div",{className:"mt-4 w-full max-w-md",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Or enter this secret manually:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{type:"text",value:v,readOnly:!0,className:"font-mono text-sm flex-1"}),e.jsx(f,{variant:"secondary",onClick:()=>ee(v),children:e.jsx(Ie,{className:"h-4 w-4"})})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(f,{variant:"primary",onClick:()=>_("verify-code"),children:"Next: Verify Code"})})]}),h==="verify-code"&&e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsx("div",{className:"bg-dark-bg rounded-lg p-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Le,{className:"h-12 w-12 text-primary mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Step 2: Verify Your Code"}),e.jsx("p",{className:"text-slate-400 text-sm text-center mb-6 max-w-md",children:"Enter the 6-digit code from your authenticator app to confirm setup:"}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsx(z,{type:"text",value:k,onChange:V=>R(V.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center text-2xl tracking-widest font-mono",maxLength:6,autoFocus:!0})})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:()=>_("scan-qr"),children:"Back"}),e.jsx(f,{type:"submit",variant:"primary",loading:g,disabled:g||k.length!==6,children:"Verify & Enable MFA"})]})]}),h==="show-recovery"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(B,{className:"h-6 w-6 text-yellow-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-yellow-400 mb-2",children:"Save Your Recovery Codes"}),e.jsx("p",{className:"text-slate-300 text-sm mb-4",children:"Store these recovery codes in a safe place. Each code can be used once to access your account if you lose your authenticator device."}),e.jsx("div",{className:"grid grid-cols-2 gap-2 bg-dark-bg rounded-lg p-4 font-mono text-sm mb-4",children:n.map((V,q)=>e.jsxs("div",{className:"text-white",children:[q+1,". ",V]},q))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"secondary",onClick:()=>ee(n.join(`
`)),children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Copy Codes"]}),e.jsxs(f,{variant:"secondary",onClick:ue,children:[e.jsx(us,{className:"h-4 w-4 mr-2"}),"Download Codes"]})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(f,{variant:"primary",onClick:E,children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Finish Setup"]})})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Z,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Two-Factor Authentication"})]}),e.jsxs("div",{className:"flex items-start justify-between mb-6 p-4 bg-dark-bg rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[c?e.jsx(W,{className:"h-6 w-6 text-green-400 flex-shrink-0"}):e.jsx(B,{className:"h-6 w-6 text-yellow-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white mb-1",children:c?"MFA Enabled":"MFA Disabled"}),e.jsx("p",{className:"text-sm text-slate-400",children:c?"Your account is protected with two-factor authentication.":"Enable MFA to add an extra layer of security to your account."})]})]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${c?"bg-green-400":"bg-yellow-400"}`})]}),c?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(be,{className:"h-5 w-5 text-primary"}),e.jsx("h5",{className:"font-medium text-white",children:"Recovery Codes"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Generate new recovery codes if you've lost the originals or used them."}),e.jsx(f,{variant:"secondary",size:"sm",onClick:()=>j(!0),children:"Regenerate Codes"})]}),e.jsxs("div",{className:"bg-dark-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ye,{className:"h-5 w-5 text-red-400"}),e.jsx("h5",{className:"font-medium text-white",children:"Disable MFA"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Turn off two-factor authentication for your account."}),e.jsx(f,{variant:"danger",size:"sm",onClick:()=>L(!0),children:"Disable MFA"})]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h5",{className:"text-white font-medium mb-2",children:"Why enable MFA?"}),e.jsxs("ul",{className:"text-sm text-slate-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Adds an extra layer of security beyond your password"}),e.jsx("li",{children:"Prevents unauthorized access even if your password is compromised"}),e.jsx("li",{children:"Uses time-based codes from your smartphone"}),e.jsx("li",{children:"Industry standard for securing sensitive accounts"})]})]}),e.jsxs(f,{variant:"primary",onClick:Y,children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Enable Two-Factor Authentication"]})]})]}),F&&e.jsx(S,{children:e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Disable Two-Factor Authentication"}),e.jsxs("button",{type:"button",onClick:()=>{L(!1),i(""),r("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"Disabling MFA will make your account less secure. You'll need to provide your password and a TOTP code to confirm."})}),e.jsx(z,{label:"Password",type:"password",value:D,onChange:V=>i(V.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(z,{label:"TOTP Code",type:"text",value:m,onChange:V=>r(V.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:()=>{L(!1),i(""),r("")},children:"Cancel"}),e.jsx(f,{type:"submit",variant:"danger",loading:l,disabled:l||!D||m.length!==6,children:"Disable MFA"})]})]})}),T&&e.jsx(S,{children:e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Regenerate Recovery Codes"}),e.jsxs("button",{type:"button",onClick:()=>{j(!1),b(""),s("")},className:"text-slate-400 hover:text-white",children:[e.jsx("span",{className:"sr-only",children:"Close"}),""]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-yellow-300",children:"This will invalidate all existing recovery codes. Make sure to save the new codes in a safe place."})}),e.jsx(z,{label:"Password",type:"password",value:A,onChange:V=>b(V.target.value),placeholder:"Your account password",autoComplete:"current-password"}),e.jsx(z,{label:"TOTP Code",type:"text",value:x,onChange:V=>s(V.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center tracking-widest font-mono",maxLength:6}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:()=>{j(!1),b(""),s("")},children:"Cancel"}),e.jsx(f,{type:"submit",variant:"primary",loading:u,disabled:u||!A||x.length!==6,children:"Generate New Codes"})]})]})})]})},Ss=()=>{const[c,U]=a.useState([]),[M,p]=a.useState(!0),[h,_]=a.useState(!1),[v,I]=a.useState(""),[o,C]=a.useState(!1),[n,w]=a.useState(null),[k,R]=a.useState(null),[g,P]=a.useState(!1);a.useEffect(()=>{F()},[]);const F=async()=>{p(!0);try{const r=await ve.getAll();U(r.data)}catch(r){t.error("Failed to load API keys"),console.error(r)}finally{p(!1)}},L=async()=>{var r,l;if(!v.trim()){t.error("Please enter a name for the API key");return}C(!0);try{const d=await ve.create({name:v.trim()});w(d.data),I(""),await F(),t.success("API key created successfully")}catch(d){t.error(((l=(r=d.response)==null?void 0:r.data)==null?void 0:l.error)||"Failed to create API key")}finally{C(!1)}},D=async()=>{var r,l;if(k){P(!0);try{await ve.delete(k.id),await F(),t.success(`API key "${k.name}" revoked successfully`),R(null)}catch(d){t.error(((l=(r=d.response)==null?void 0:r.data)==null?void 0:l.error)||"Failed to revoke API key")}finally{P(!1)}}},i=r=>{navigator.clipboard.writeText(r),t.success("API key copied to clipboard")},m=()=>{w(null),_(!1)};return M?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(J,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Keys"})]}),e.jsxs(f,{variant:"primary",onClick:()=>_(!0),className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),"Create API Key"]})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"API keys allow programmatic access to HeroForge. Keep your keys secure and never share them publicly."}),c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(be,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No API keys yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Create your first API key to get started"})]}):e.jsx("div",{className:"space-y-3",children:c.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-dark-bg rounded-lg border border-dark-border hover:border-primary/30 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-medium text-white",children:r.name}),e.jsxs("code",{className:"px-2 py-1 bg-dark-surface rounded text-xs text-slate-400 font-mono",children:[r.prefix,"..."]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Te,{className:"h-3 w-3"}),"Created ",new Date(r.created_at).toLocaleDateString()]}),r.last_used_at&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(re,{className:"h-3 w-3"}),"Last used ",new Date(r.last_used_at).toLocaleDateString()]}),!r.last_used_at&&e.jsx("span",{className:"text-amber-500",children:"Never used"})]})]}),e.jsxs(f,{variant:"danger",size:"sm",onClick:()=>R(r),className:"flex items-center gap-2","aria-label":`Revoke API key ${r.name}`,children:[e.jsx(le,{className:"h-4 w-4"}),"Revoke"]})]},r.id))})]}),h&&!n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Create API Key"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Key Name"}),e.jsx("input",{type:"text",value:v,onChange:r=>I(r.target.value),placeholder:"e.g., Production Server, CI/CD Pipeline",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",autoFocus:!0}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Give your API key a descriptive name to remember where it's used"})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4",children:[e.jsx(f,{variant:"secondary",onClick:()=>{_(!1),I("")},children:"Cancel"}),e.jsx(f,{variant:"primary",onClick:L,disabled:o||!v.trim(),children:o?e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx("span",{className:"ml-2",children:"Creating..."})]}):"Create Key"})]})]})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg p-6 max-w-2xl w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(W,{className:"h-6 w-6 text-green-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"API Key Created Successfully"})]}),e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-amber-200 font-medium mb-2",children:"Important: Save your API key now!"}),e.jsx("p",{className:"text-xs text-amber-300/70",children:"This is the only time you'll see the full key. If you lose it, you'll need to create a new one."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"API Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("code",{className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-3 text-white font-mono text-sm break-all",children:n.key}),e.jsxs(f,{variant:"secondary",onClick:()=>i(n.key),className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-4 w-4"}),"Copy"]})]})]}),e.jsxs("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-200 mb-2",children:"Using your API key"}),e.jsx("p",{className:"text-xs text-blue-300/70 mb-3",children:"Include your API key in the X-API-Key header:"}),e.jsxs("code",{className:"block bg-dark-bg border border-dark-border rounded px-3 py-2 text-xs text-slate-300 font-mono",children:['curl -H "X-API-Key: ',n.key,'" https://heroforge.example.com/api/scans']})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(f,{variant:"primary",onClick:m,children:"Done"})})]})]})}),e.jsx(ce,{isOpen:!!k,onClose:()=>R(null),onConfirm:D,title:"Revoke API Key",message:`Are you sure you want to revoke the API key "${k==null?void 0:k.name}"? Any applications using this key will lose access immediately.`,confirmLabel:"Revoke Key",variant:"danger",loading:g})]})},Cs=()=>{const[c,U]=a.useState(!0),[M,p]=a.useState(!1),[h,_]=a.useState(!1),[v,I]=a.useState(!1),[o,C]=a.useState({jira_url:"",username:"",api_token:"",project_key:"",issue_type:"Task",default_assignee:"",enabled:!0}),[n,w]=a.useState([]),[k,R]=a.useState([]),[g,P]=a.useState(!1);a.useEffect(()=>{F()},[]);const F=async()=>{var r;U(!0);try{const l=await oe.getSettings();C(l.data),I(!0)}catch(l){((r=l.response)==null?void 0:r.status)===404?I(!1):console.error("Failed to load JIRA settings:",l)}finally{U(!1)}},L=async()=>{var r,l;if(!o.jira_url||!o.username||!o.api_token||!o.project_key){t.error("Please fill in all required fields");return}p(!0);try{await oe.updateSettings(o),t.success("JIRA settings saved successfully"),I(!0)}catch(d){console.error("Failed to save JIRA settings:",d),t.error(((l=(r=d.response)==null?void 0:r.data)==null?void 0:l.error)||"Failed to save JIRA settings")}finally{p(!1)}},D=async()=>{var r,l;if(!v){t.error("Please save your settings first");return}_(!0);try{await oe.testConnection(),t.success("JIRA connection successful!")}catch(d){console.error("JIRA connection failed:",d),t.error(((l=(r=d.response)==null?void 0:r.data)==null?void 0:l.error)||"JIRA connection failed")}finally{_(!1)}},i=async()=>{var r,l;if(!v){t.error("Please save your settings first");return}P(!0);try{const d=await oe.listProjects();w(d.data),t.success(`Loaded ${d.data.length} projects`)}catch(d){console.error("Failed to load projects:",d),t.error(((l=(r=d.response)==null?void 0:r.data)==null?void 0:l.error)||"Failed to load projects")}finally{P(!1)}},m=async()=>{var r,l;if(!v||!o.project_key){t.error("Please save your settings and select a project first");return}P(!0);try{const d=await oe.listIssueTypes();R(d.data),t.success(`Loaded ${d.data.length} issue types`)}catch(d){console.error("Failed to load issue types:",d),t.error(((l=(r=d.response)==null?void 0:r.data)==null?void 0:l.error)||"Failed to load issue types")}finally{P(!1)}};return c?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(J,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Ge,{className:"h-6 w-6 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"JIRA Integration"})]}),e.jsxs("div",{className:"space-y-4",children:[!v&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(B,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"JIRA Integration Not Configured"}),e.jsx("p",{children:"Configure your JIRA instance to automatically create tickets from vulnerabilities."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["JIRA URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(z,{type:"url",placeholder:"https://your-domain.atlassian.net",value:o.jira_url,onChange:r=>C({...o,jira_url:r.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Your JIRA instance URL (e.g., https://company.atlassian.net)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Username/Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(z,{type:"text",placeholder:"user@example.com",value:o.username,onChange:r=>C({...o,username:r.target.value})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["API Token ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(z,{type:"password",placeholder:"Your JIRA API token",value:o.api_token,onChange:r=>C({...o,api_token:r.target.value})}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Generate an API token at"," ",e.jsxs("a",{href:"https://id.atlassian.com/manage-profile/security/api-tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 inline-flex items-center gap-1",children:["Atlassian Account Settings ",e.jsx(We,{className:"h-3 w-3"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Key ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:n.length>0?e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:o.project_key,onChange:r=>C({...o,project_key:r.target.value}),children:[e.jsx("option",{value:"",children:"Select a project"}),n.map(r=>e.jsxs("option",{value:r.key,children:[r.name," (",r.key,")"]},r.key))]}):e.jsx(z,{type:"text",placeholder:"PROJECT",value:o.project_key,onChange:r=>C({...o,project_key:r.target.value})})}),e.jsx(f,{onClick:i,disabled:!v||g,variant:"secondary",children:g?"Loading...":"Load Projects"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Issue Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:k.length>0?e.jsx("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:o.issue_type,onChange:r=>C({...o,issue_type:r.target.value}),children:k.map(r=>e.jsx("option",{value:r.name,children:r.name},r.id))}):e.jsx(z,{type:"text",placeholder:"Task",value:o.issue_type,onChange:r=>C({...o,issue_type:r.target.value})})}),e.jsx(f,{onClick:m,disabled:!v||!o.project_key||g,variant:"secondary",children:g?"Loading...":"Load Types"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Assignee (optional)"}),e.jsx(z,{type:"text",placeholder:"username",value:o.default_assignee||"",onChange:r=>C({...o,default_assignee:r.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Leave empty for unassigned or enter a JIRA username"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"jira-enabled",checked:o.enabled,onChange:r=>C({...o,enabled:r.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"jira-enabled",className:"text-sm font-medium text-gray-700",children:"Enable JIRA integration"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(f,{onClick:L,disabled:M,children:M?"Saving...":"Save Settings"}),e.jsx(f,{onClick:D,disabled:!v||h,variant:"secondary",children:h?"Testing...":"Test Connection"})]}),v&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(W,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("p",{className:"font-medium",children:"JIRA Integration Configured"}),e.jsx("p",{children:"You can now create JIRA tickets from vulnerabilities."})]})]})]})]}),e.jsxs(S,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"How to Use JIRA Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Configure your JIRA instance settings above and test the connection."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"Navigate to any vulnerability in your scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"3"})}),e.jsx("p",{children:'Click the "Create JIRA Ticket" button to automatically create an issue with vulnerability details.'})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-700 font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"The vulnerability will be linked to the JIRA ticket, and you can track it in your JIRA project."})]})]})]})]})},Ps=()=>{const[c,U]=a.useState([]),[M,p]=a.useState(!0),[h,_]=a.useState(!1),[v,I]=a.useState(null),[o,C]=a.useState(null),[n,w]=a.useState(null),[k,R]=a.useState(!1),[g,P]=a.useState([]),[F,L]=a.useState(!1),[D,i]=a.useState(""),[m,r]=a.useState(!1);a.useEffect(()=>{l(),j()},[]);const l=async()=>{p(!0);try{const b=await ie.getSettings();U(b.data)}catch(b){t.error("Failed to load SIEM settings"),console.error(b)}finally{p(!1)}},d=async b=>{var x,s;C(b);try{const u=await ie.testConnection(b);u.data.success?t.success("Connection test successful!"):t.error(`Connection test failed: ${u.data.message}`)}catch(u){t.error(((s=(x=u.response)==null?void 0:x.data)==null?void 0:s.error)||"Connection test failed")}finally{C(null)}},T=async()=>{var b,x;if(n){R(!0);try{await ie.deleteSettings(n.id),t.success(`${n.siem_type.toUpperCase()} integration deleted`),l(),w(null)}catch(s){t.error(((x=(b=s.response)==null?void 0:b.data)==null?void 0:x.error)||"Failed to delete SIEM integration")}finally{R(!1)}}},j=async()=>{L(!0);try{const b=await Je.getAll();P(b.data.filter(x=>x.status==="completed"))}catch(b){console.error("Failed to load scans:",b)}finally{L(!1)}},A=async()=>{var x,s;if(!D){t.error("Please select a scan to export");return}if(c.filter(u=>u.enabled).length===0){t.error("No enabled SIEM integrations found. Please enable at least one integration.");return}r(!0);try{const u=await ie.exportScan(D);u.data.success?(t.success(`Scan exported to ${u.data.exported_to} SIEM integration(s). ${u.data.events_count} events sent.`),u.data.errors&&u.data.errors.length>0&&u.data.errors.forEach(N=>t.warning(N))):t.error("Export failed. Check SIEM configuration.")}catch(u){t.error(((s=(x=u.response)==null?void 0:x.data)==null?void 0:s.error)||"Failed to export scan to SIEM")}finally{r(!1)}};return M?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(J,{})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:"SIEM Integrations"})]}),e.jsxs(f,{variant:"primary",onClick:()=>_(!0),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Add Integration"]})]}),c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Pe,{className:"h-12 w-12 text-slate-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"No SIEM integrations configured"}),e.jsxs(f,{variant:"primary",onClick:()=>_(!0),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Add Your First Integration"]})]}):e.jsx("div",{className:"space-y-4",children:c.map(b=>e.jsx("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-primary/20 text-primary rounded-md text-sm font-medium uppercase",children:b.siem_type}),b.enabled?e.jsxs("span",{className:"flex items-center gap-1 text-green-400 text-sm",children:[e.jsx(W,{className:"h-4 w-4"}),"Enabled"]}):e.jsxs("span",{className:"flex items-center gap-1 text-slate-500 text-sm",children:[e.jsx(Ue,{className:"h-4 w-4"}),"Disabled"]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Endpoint:"}),e.jsx("span",{className:"text-white font-mono",children:b.endpoint_url})]}),b.protocol&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"Protocol:"}),e.jsx("span",{className:"text-white uppercase",children:b.protocol})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:b.export_on_scan_complete,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export on scan complete"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:b.export_on_critical_vuln,disabled:!0,className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary"}),e.jsx("span",{className:"text-slate-400",children:"Export critical vulnerabilities"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{variant:"outline",size:"sm",onClick:()=>d(b.id),disabled:o===b.id,children:o===b.id?e.jsx(J,{}):e.jsx(ps,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>I(b),children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>w(b),"aria-label":`Delete ${b.siem_type} integration`,children:e.jsx(le,{className:"h-4 w-4 text-red-400"})})]})]})},b.id))})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Manual Export"})]}),e.jsx(f,{variant:"outline",size:"sm",onClick:j,disabled:F,children:F?e.jsx(J,{}):e.jsx(fe,{className:"h-4 w-4"})})]}),c.filter(b=>b.enabled).length===0?e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(Ue,{className:"h-5 w-5 text-amber-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-amber-200",children:[e.jsx("p",{className:"font-medium mb-1",children:"No Enabled Integrations"}),e.jsx("p",{children:"Enable at least one SIEM integration above before exporting scan results."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Manually export scan results to all enabled SIEM integrations."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:D,onChange:b=>i(b.target.value),className:"flex-1 bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",disabled:F||m,children:[e.jsx("option",{value:"",children:"Select a completed scan..."}),g.map(b=>e.jsxs("option",{value:b.id,children:[b.name," - ",new Date(b.created_at).toLocaleDateString()," ",new Date(b.created_at).toLocaleTimeString()]},b.id))]}),e.jsx(f,{variant:"primary",onClick:A,disabled:!D||m||F,children:m?e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx("span",{className:"ml-2",children:"Exporting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"Export to SIEM"]})})]}),g.length===0&&!F&&e.jsx("p",{className:"text-sm text-slate-500",children:"No completed scans available for export."}),e.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["Export will send data to: ",c.filter(b=>b.enabled).map(b=>b.siem_type.toUpperCase()).join(", ")]})]})]}),e.jsxs(S,{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"About SIEM Integration"}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-400",children:[e.jsx("p",{children:"SIEM (Security Information and Event Management) integration allows HeroForge to automatically export scan results and vulnerability findings to your security monitoring platform."}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Syslog:"})," RFC 5424 compliant syslog over TCP/UDP"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Splunk:"})," Splunk HTTP Event Collector (HEC)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Elasticsearch:"})," Direct indexing via Bulk API"]})]})]})]}),(h||v)&&e.jsx(As,{settings:v,onClose:()=>{_(!1),I(null)},onSave:()=>{_(!1),I(null),l()}}),e.jsx(ce,{isOpen:!!n,onClose:()=>w(null),onConfirm:T,title:"Delete SIEM Integration",message:`Are you sure you want to delete the ${n==null?void 0:n.siem_type.toUpperCase()} integration? Automatic exports to this endpoint will stop.`,confirmLabel:"Delete Integration",variant:"danger",loading:k})]})},As=({settings:c,onClose:U,onSave:M})=>{const[p,h]=a.useState({siem_type:(c==null?void 0:c.siem_type)||"syslog",endpoint_url:(c==null?void 0:c.endpoint_url)||"",api_key:(c==null?void 0:c.api_key)||"",protocol:(c==null?void 0:c.protocol)||"tcp",enabled:(c==null?void 0:c.enabled)??!0,export_on_scan_complete:(c==null?void 0:c.export_on_scan_complete)??!1,export_on_critical_vuln:(c==null?void 0:c.export_on_critical_vuln)??!0}),[_,v]=a.useState(!1),I=async o=>{var C,n;if(o.preventDefault(),!p.endpoint_url){t.error("Endpoint URL is required");return}if(p.siem_type==="splunk"&&!p.api_key){t.error("API key is required for Splunk HEC");return}v(!0);try{if(c){const w={endpoint_url:p.endpoint_url,enabled:p.enabled,export_on_scan_complete:p.export_on_scan_complete,export_on_critical_vuln:p.export_on_critical_vuln};p.api_key&&(w.api_key=p.api_key),p.siem_type==="syslog"&&(w.protocol=p.protocol),await ie.updateSettings(c.id,w),t.success("SIEM integration updated")}else{const w={siem_type:p.siem_type,endpoint_url:p.endpoint_url,enabled:p.enabled,export_on_scan_complete:p.export_on_scan_complete,export_on_critical_vuln:p.export_on_critical_vuln};p.api_key&&(w.api_key=p.api_key),p.siem_type==="syslog"&&(w.protocol=p.protocol),await ie.createSettings(w),t.success("SIEM integration created")}M()}catch(w){t.error(((n=(C=w.response)==null?void 0:C.data)==null?void 0:n.error)||"Failed to save SIEM integration")}finally{v(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("h3",{className:"text-xl font-semibold text-white",children:[c?"Edit":"Add"," SIEM Integration"]}),e.jsx("button",{onClick:U,className:"text-slate-400 hover:text-white",children:e.jsx(Ne,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:I,className:"p-6 space-y-6",children:[!c&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"SIEM Type"}),e.jsxs("select",{value:p.siem_type,onChange:o=>h({...p,siem_type:o.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"syslog",children:"Syslog (RFC 5424)"}),e.jsx("option",{value:"splunk",children:"Splunk HEC"}),e.jsx("option",{value:"elasticsearch",children:"Elasticsearch"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Endpoint URL"}),e.jsx("input",{type:"text",value:p.endpoint_url,onChange:o=>h({...p,endpoint_url:o.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:p.siem_type==="syslog"?"192.168.1.100:514":p.siem_type==="splunk"?"https://splunk.example.com:8088":"https://elasticsearch.example.com:9200"})]}),p.siem_type==="syslog"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Protocol"}),e.jsxs("select",{value:p.protocol,onChange:o=>h({...p,protocol:o.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"tcp",children:"TCP"}),e.jsx("option",{value:"udp",children:"UDP"})]})]}),(p.siem_type==="splunk"||p.siem_type==="elasticsearch")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:[p.siem_type==="splunk"?"HEC Token":"API Key"," ",p.siem_type==="splunk"&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"password",value:p.api_key,onChange:o=>h({...p,api_key:o.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:c?"(leave blank to keep current)":""})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:p.enabled,onChange:o=>h({...p,enabled:o.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Enable this integration"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:p.export_on_scan_complete,onChange:o=>h({...p,export_on_scan_complete:o.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export when scans complete"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:p.export_on_critical_vuln,onChange:o=>h({...p,export_on_critical_vuln:o.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-surface text-primary focus:ring-primary"}),e.jsx("span",{className:"text-white",children:"Auto-export critical vulnerabilities immediately"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(f,{type:"button",variant:"outline",onClick:U,children:"Cancel"}),e.jsx(f,{type:"submit",variant:"primary",disabled:_,children:_?e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx("span",{className:"ml-2",children:"Saving..."})]}):e.jsxs("span",{children:[c?"Update":"Create"," Integration"]})})]})]})]})})},Is=()=>{const[c,U]=a.useState(!0),[M,p]=a.useState([]),[h,_]=a.useState(null),[v,I]=a.useState(!1),[o,C]=a.useState(!1),[n,w]=a.useState(null),[k,R]=a.useState(!1),[g,P]=a.useState(!1),[F,L]=a.useState(null),[D,i]=a.useState(""),m=a.useRef(null),[r,l]=a.useState({name:"",vpnType:"openvpn",username:"",password:""}),[d,T]=a.useState(null);a.useEffect(()=>{j()},[]);const j=async()=>{U(!0);try{const[y,E]=await Promise.all([X.getConfigs(),X.getStatus()]);p(y.data),_(E.data)}catch(y){console.error("Failed to load VPN data:",y),t.error("Failed to load VPN settings")}finally{U(!1)}},A=y=>{var ee,ue;const E=(ee=y.target.files)==null?void 0:ee[0];if(!E)return;const O=(ue=E.name.split(".").pop())==null?void 0:ue.toLowerCase();let $="openvpn";O==="conf"&&($="wireguard"),T(E),l({...r,name:E.name.replace(/\.(ovpn|conf)$/i,""),vpnType:$}),I(!0)},b=async()=>{if(!d){t.error("Please select a VPN config file");return}if(!r.name.trim()){t.error("Please enter a name for the VPN config");return}C(!0);try{const y=new FileReader;y.onload=async()=>{var O,$;const E=y.result.split(",")[1];try{await X.uploadConfig({name:r.name.trim(),vpn_type:r.vpnType,config_data:E,filename:d.name,username:r.username||void 0,password:r.password||void 0,set_as_default:!1}),t.success("VPN config uploaded successfully"),I(!1),T(null),l({name:"",vpnType:"openvpn",username:"",password:""}),m.current&&(m.current.value=""),await j()}catch(ee){console.error("Failed to upload VPN config:",ee),t.error((($=(O=ee.response)==null?void 0:O.data)==null?void 0:$.error)||"Failed to upload VPN config")}},y.readAsDataURL(d)}finally{C(!1)}},x=async y=>{var E,O;if(window.confirm("Are you sure you want to delete this VPN config?"))try{await X.deleteConfig(y),t.success("VPN config deleted"),await j()}catch($){console.error("Failed to delete VPN config:",$),t.error(((O=(E=$.response)==null?void 0:E.data)==null?void 0:O.error)||"Failed to delete VPN config")}},s=async y=>{var E,O;w(y);try{const $=await X.testConfig(y);$.data.success?t.success(`Connection successful! IP: ${$.data.assigned_ip||"N/A"}`):t.error($.data.message||"Connection test failed")}catch($){console.error("Failed to test VPN config:",$),t.error(((O=(E=$.response)==null?void 0:E.data)==null?void 0:O.error)||"Connection test failed")}finally{w(null)}},u=async y=>{var E,O;R(!0);try{await X.connect({config_id:y,connection_mode:"persistent"}),t.success("VPN connected"),await j()}catch($){console.error("Failed to connect VPN:",$),t.error(((O=(E=$.response)==null?void 0:E.data)==null?void 0:O.error)||"Failed to connect")}finally{R(!1)}},N=async()=>{var y,E;P(!0);try{await X.disconnect(),t.success("VPN disconnected"),await j()}catch(O){console.error("Failed to disconnect VPN:",O),t.error(((E=(y=O.response)==null?void 0:y.data)==null?void 0:E.error)||"Failed to disconnect")}finally{P(!1)}},H=async y=>{var E,O;try{await X.updateConfig(y,{is_default:!0}),t.success("Default VPN config updated"),await j()}catch($){console.error("Failed to set default:",$),t.error(((O=(E=$.response)==null?void 0:E.data)==null?void 0:O.error)||"Failed to set default")}},Y=async y=>{var E,O;if(!D.trim()){t.error("Name cannot be empty");return}try{await X.updateConfig(y,{name:D.trim()}),t.success("VPN config updated"),L(null),await j()}catch($){console.error("Failed to update config:",$),t.error(((O=(E=$.response)==null?void 0:E.data)==null?void 0:O.error)||"Failed to update")}};return c?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(J,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[h!=null&&h.connected?e.jsx(Ye,{className:"h-6 w-6 text-green-500"}):e.jsx(Me,{className:"h-6 w-6 text-slate-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"VPN Status"}),e.jsx("p",{className:"text-sm text-slate-400",children:h!=null&&h.connected?`Connected to ${h.config_name}`:"Not connected"})]})]}),(h==null?void 0:h.connected)&&e.jsxs(f,{onClick:N,disabled:g,variant:"danger",className:"flex items-center gap-2",children:[e.jsx(gs,{className:"h-4 w-4"}),g?"Disconnecting...":"Disconnect"]})]}),(h==null?void 0:h.connected)&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-dark-hover rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Mode"}),e.jsx("p",{className:"text-sm text-white",children:h.connection_mode==="persistent"?"Persistent":"Per-Scan"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Assigned IP"}),e.jsx("p",{className:"text-sm text-white font-mono",children:h.assigned_ip||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Interface"}),e.jsx("p",{className:"text-sm text-white font-mono",children:h.interface_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Connected Since"}),e.jsx("p",{className:"text-sm text-white",children:h.connected_since?new Date(h.connected_since).toLocaleString():"N/A"})]})]})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"VPN Configurations"})]}),e.jsxs("div",{children:[e.jsx("input",{ref:m,type:"file",accept:".ovpn,.conf",onChange:A,className:"hidden"}),e.jsxs(f,{onClick:()=>{var y;return(y=m.current)==null?void 0:y.click()},className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),"Upload Config"]})]})]}),v&&e.jsxs("div",{className:"mb-6 p-4 bg-dark-hover rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"Upload VPN Configuration"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[e.jsx("span",{children:"File:"}),e.jsx("span",{className:"text-white font-mono",children:d==null?void 0:d.name}),e.jsx("span",{className:"px-2 py-0.5 bg-primary/20 text-primary rounded text-xs uppercase",children:r.vpnType})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Config Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(z,{type:"text",placeholder:"My VPN Connection",value:r.name,onChange:y=>l({...r,name:y.target.value})})]}),r.vpnType==="openvpn"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Username (optional)"}),e.jsx(z,{type:"text",placeholder:"VPN username",value:r.username,onChange:y=>l({...r,username:y.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Required if your VPN requires authentication"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Password (optional)"}),e.jsx(z,{type:"password",placeholder:"VPN password",value:r.password,onChange:y=>l({...r,password:y.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(f,{onClick:b,disabled:o,children:o?"Uploading...":"Upload"}),e.jsx(f,{onClick:()=>{I(!1),T(null),m.current&&(m.current.value="")},variant:"secondary",children:"Cancel"})]})]})]}),M.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(Me,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No VPN configurations yet"}),e.jsx("p",{className:"text-sm",children:"Upload an OpenVPN (.ovpn) or WireGuard (.conf) file to get started"})]}):e.jsx("div",{className:"space-y-3",children:M.map(y=>e.jsxs("div",{className:"p-4 bg-dark-hover rounded-lg border border-dark-border flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${y.vpn_type==="openvpn"?"bg-orange-500/20 text-orange-400":"bg-blue-500/20 text-blue-400"}`,children:e.jsx(Z,{className:"h-5 w-5"})}),e.jsxs("div",{children:[F===y.id?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{type:"text",value:D,onChange:E=>i(E.target.value),className:"w-48",autoFocus:!0,onKeyDown:E=>{E.key==="Enter"&&Y(y.id),E.key==="Escape"&&L(null)}}),e.jsx(f,{size:"sm",onClick:()=>Y(y.id),children:"Save"}),e.jsx(f,{size:"sm",variant:"secondary",onClick:()=>L(null),children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium",children:y.name}),y.is_default&&e.jsx(Ve,{className:"h-4 w-4 text-yellow-400 fill-yellow-400"}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-700 text-slate-300 rounded text-xs uppercase",children:y.vpn_type}),(h==null?void 0:h.connected)&&h.config_id===y.id&&e.jsx("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 rounded text-xs",children:"Connected"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500 mt-1",children:[y.requires_credentials&&e.jsx("span",{className:y.has_credentials?"text-green-400":"text-yellow-400",children:y.has_credentials?"Credentials saved":"Credentials required"}),y.last_used_at&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(re,{className:"h-3 w-3"}),"Last used: ",new Date(y.last_used_at).toLocaleDateString()]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:F!==y.id&&e.jsxs(e.Fragment,{children:[!y.is_default&&e.jsx(f,{size:"sm",variant:"ghost",onClick:()=>H(y.id),title:"Set as default",children:e.jsx(Ve,{className:"h-4 w-4"})}),e.jsx(f,{size:"sm",variant:"ghost",onClick:()=>{L(y.id),i(y.name)},title:"Edit",children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx(f,{size:"sm",variant:"ghost",onClick:()=>s(y.id),disabled:n===y.id,title:"Test connection",children:n===y.id?e.jsx(J,{size:"sm"}):e.jsx(W,{className:"h-4 w-4"})}),!(h!=null&&h.connected)||h.config_id!==y.id?e.jsx(f,{size:"sm",variant:"secondary",onClick:()=>u(y.id),disabled:k||(h==null?void 0:h.connected),title:"Connect",children:e.jsx(qe,{className:"h-4 w-4"})}):null,e.jsx(f,{size:"sm",variant:"ghost",onClick:()=>x(y.id),className:"text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(le,{className:"h-4 w-4"})})]})})]},y.id))})]}),e.jsxs(S,{children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-4",children:"How to Use VPN Integration"}),e.jsxs("div",{className:"space-y-3 text-sm text-slate-400",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"1"})}),e.jsx("p",{children:"Upload your OpenVPN (.ovpn) or WireGuard (.conf) configuration file."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"2"})}),e.jsx("p",{children:"If your VPN requires credentials, enter them during upload. They are stored encrypted."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"3"})}),e.jsx("p",{children:"Test your connection to verify it works before using it for scans."})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/20 rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-primary font-semibold text-xs",children:"4"})}),e.jsx("p",{children:"When creating a scan, select a VPN config to route the scan through that VPN. The VPN connects before the scan starts and disconnects when it completes."})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(B,{className:"h-5 w-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-200",children:[e.jsx("p",{className:"font-medium",children:"Security Note"}),e.jsx("p",{className:"text-yellow-300/80 mt-1",children:"VPN credentials are encrypted using AES-256-GCM. Config files containing dangerous options (scripts, hooks) are rejected. Only use VPN configurations from trusted sources."})]})]})})]})]})},Ls=()=>{const[c,U]=a.useState("profile"),M=[{name:"Account",tabs:[{id:"profile",label:"Profile",icon:e.jsx(ke,{className:"h-4 w-4"}),component:e.jsx(js,{})},{id:"security",label:"Security",icon:e.jsx(ye,{className:"h-4 w-4"}),component:e.jsx(ks,{})},{id:"api-keys",label:"API Keys",icon:e.jsx(be,{className:"h-4 w-4"}),component:e.jsx(Ss,{})}]},{name:"Administration",tabs:[{id:"administration",label:"Users",icon:e.jsx(Z,{className:"h-4 w-4"}),component:e.jsx(bs,{})}]},{name:"Scanning",tabs:[{id:"target-groups",label:"Target Groups",icon:e.jsx(Ee,{className:"h-4 w-4"}),component:e.jsx(ys,{})},{id:"scheduled-scans",label:"Scheduled Scans",icon:e.jsx(re,{className:"h-4 w-4"}),component:e.jsx(Ns,{})},{id:"templates",label:"Templates",icon:e.jsx(Ae,{className:"h-4 w-4"}),component:e.jsx(_s,{})},{id:"vpn",label:"VPN",icon:e.jsx(Ye,{className:"h-4 w-4"}),component:e.jsx(Is,{})},{id:"compare-scans",label:"Compare",icon:e.jsx(Ce,{className:"h-4 w-4"}),component:e.jsx(ws,{})}]},{name:"Integrations",tabs:[{id:"notifications",label:"Notifications",icon:e.jsx(He,{className:"h-4 w-4"}),component:e.jsx(vs,{})},{id:"jira-integration",label:"JIRA",icon:e.jsx(We,{className:"h-4 w-4"}),component:e.jsx(Cs,{})},{id:"siem-integration",label:"SIEM",icon:e.jsx(Be,{className:"h-4 w-4"}),component:e.jsx(Ps,{})}]}],h=M.flatMap(_=>_.tabs).find(_=>_.id===c);return e.jsx(es,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Ge,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Settings"})]}),e.jsx("p",{className:"text-slate-400",children:"Manage your account, scanning configuration, and integrations"})]}),e.jsx("div",{className:"bg-dark-surface rounded-lg border border-dark-border p-4",children:e.jsx("div",{className:"flex flex-wrap gap-6",children:M.map(_=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:_.name}),e.jsx("div",{className:"flex gap-1",children:_.tabs.map(v=>e.jsxs("button",{onClick:()=>U(v.id),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${c===v.id?"bg-primary text-white":"text-slate-400 hover:text-white hover:bg-dark-hover"}`,children:[v.icon,v.label]},v.id))})]},_.name))})}),e.jsx("div",{children:h==null?void 0:h.component})]})})};export{Ls as default};
