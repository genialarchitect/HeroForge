import{j as e}from"./vendor-state-oFDmcCcB.js";import{r}from"./vendor-react-5KxtEOLM.js";import{B as l,bA as S,a7 as P,m as k,aa as I,V as H,aR as J,aZ as X,ac as q,z as W,a0 as Y,b7 as Z}from"./vendor-ui-BlFJDRaq.js";import{L as K}from"./Layout-U2SG3QMf.js";import{ar as d}from"./index-DU1ke8Sf.js";import"./vendor-markdown-BwTKtS0m.js";import"./vendor-utils-DfRopTPV.js";const ne=()=>{const[o,A]=r.useState("overview"),[n,L]=r.useState(null),[j,D]=r.useState([]),[t,F]=r.useState(null),[R,$]=r.useState([]),[b,E]=r.useState([]),[U,N]=r.useState(!0),[v,z]=r.useState(""),[M,g]=r.useState(!1),[Q,ee]=r.useState(new Set),[c,x]=r.useState({name:"",repository_url:"",ecosystem:"npm"}),[f,w]=r.useState(!1);r.useEffect(()=>{p()},[]);const p=async()=>{try{N(!0);const[s,a]=await Promise.all([d.getStats().then(i=>i.data),d.getProjects().then(i=>i.data)]),m=(s==null?void 0:s.stats)||s;L(m),D(a),a.length>0&&await y(a[0])}catch(s){console.error("Failed to load SCA data:",s),l.error("Failed to load SCA data")}finally{N(!1)}},y=async s=>{F(s);try{const[a,m]=await Promise.all([d.getDependencies(s.id).then(i=>i.data),d.getVulnerabilities(s.id).then(i=>i.data)]);$(a),E(m)}catch(a){console.error("Failed to load project details:",a),l.error("Failed to load project details")}},T=async s=>{try{l.info(`Analyzing ${s.name}...`),await d.analyzeProject(s.id,{check_updates:!0}),l.success("Analysis complete!"),await p(),(t==null?void 0:t.id)===s.id&&await y(s)}catch(a){console.error("Analysis failed:",a),l.error("Analysis failed")}},C=async s=>{if(t)try{l.info(`Generating ${s.toUpperCase()} SBOM...`);const a=await d.exportSbom(t.id,s),m=new Blob([a.data],{type:"application/json"}),i=window.URL.createObjectURL(m),h=document.createElement("a");h.href=i,h.download=`${t.name}-sbom-${s}.json`,document.body.appendChild(h),h.click(),document.body.removeChild(h),window.URL.revokeObjectURL(i),l.success(`${s.toUpperCase()} SBOM exported successfully`)}catch(a){console.error("Failed to export SBOM:",a),l.error("Failed to export SBOM")}},V=async()=>{if(!c.name.trim()){l.error("Project name is required");return}try{w(!0),await d.createProject({name:c.name.trim(),repository_url:c.repository_url.trim()||void 0,ecosystem:c.ecosystem}),l.success("Project created successfully"),g(!1),x({name:"",repository_url:"",ecosystem:"npm"}),await p()}catch(s){console.error("Failed to create project:",s),l.error("Failed to create project")}finally{w(!1)}},B=async s=>{if(confirm(`Are you sure you want to delete "${s.name}"?`))try{await d.deleteProject(s.id),l.success("Project deleted"),await p()}catch(a){console.error("Failed to delete project:",a),l.error("Failed to delete project")}},_=s=>{switch(s.toLowerCase()){case"critical":return"bg-purple-600";case"high":return"bg-red-600";case"medium":return"bg-yellow-600";case"low":return"bg-blue-600";default:return"bg-gray-600"}},O=s=>{switch(s==null?void 0:s.toLowerCase()){case"high":return"text-red-400";case"medium":return"text-yellow-400";case"low":return"text-green-400";default:return"text-gray-400"}},u=s=>{switch(s){case"cargo":return"ðŸ¦€";case"npm":return"ðŸ“¦";case"pypi":return"ðŸ";case"go":return"ðŸ¹";case"maven":return"â˜•";default:return"ðŸ“¦"}},G=R.filter(s=>s.name.toLowerCase().includes(v.toLowerCase()));return e.jsxs(K,{children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{className:"h-8 w-8 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Software Composition Analysis"}),e.jsx("p",{className:"text-gray-400",children:"Analyze dependencies and identify vulnerabilities"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>C("cyclonedx"),className:"flex items-center gap-2 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",disabled:!t,children:[e.jsx(P,{className:"h-4 w-4"}),"CycloneDX"]}),e.jsxs("button",{onClick:()=>C("spdx"),className:"flex items-center gap-2 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",disabled:!t,children:[e.jsx(P,{className:"h-4 w-4"}),"SPDX"]}),e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-500",children:[e.jsx(k,{className:"h-4 w-4"}),"Add Project"]})]})]}),n&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:n.total_projects}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Projects"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:n.total_dependencies}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Dependencies"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:n.vulnerable_dependencies}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Vulnerable"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400",children:n.critical_vulns}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Critical"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:n.high_vulns}),e.jsx("div",{className:"text-gray-400 text-sm",children:"High"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:n.medium_vulns}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Medium"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400",children:n.license_issues}),e.jsx("div",{className:"text-gray-400 text-sm",children:"License Issues"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-cyan-400",children:n.updates_available}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Updates"})]})]}),e.jsx("div",{className:"flex gap-1 mb-6 border-b border-gray-700",children:["overview","projects","dependencies","vulnerabilities"].map(s=>e.jsx("button",{onClick:()=>A(s),className:`px-4 py-2 font-medium capitalize ${o===s?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:s},s))}),U?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(I,{className:"h-8 w-8 text-cyan-400 animate-spin"})}):e.jsxs(e.Fragment,{children:[o==="projects"&&e.jsxs("div",{className:"grid gap-4",children:[j.map(s=>e.jsx("div",{className:`bg-gray-800 rounded-lg p-4 cursor-pointer border-2 transition-colors ${(t==null?void 0:t.id)===s.id?"border-cyan-500":"border-transparent hover:border-gray-600"}`,onClick:()=>y(s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:u(s.ecosystem)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:s.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[s.ecosystem," â€¢ ",s.total_dependencies," dependencies"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[s.vulnerable_dependencies>0&&e.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.vulnerable_dependencies," vulnerable"]})]}),s.license_issues>0&&e.jsxs("div",{className:"flex items-center gap-2 text-yellow-400",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.license_issues," license issues"]})]}),e.jsx("button",{onClick:a=>{a.stopPropagation(),T(s)},className:"p-2 bg-cyan-600 rounded-lg hover:bg-cyan-500",title:"Analyze",children:e.jsx(X,{className:"h-4 w-4 text-white"})}),e.jsx("button",{onClick:a=>{a.stopPropagation(),B(s)},className:"p-2 bg-red-600 rounded-lg hover:bg-red-500",title:"Delete",children:e.jsx(q,{className:"h-4 w-4 text-white"})})]})]})},s.id)),j.length===0&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 text-center",children:[e.jsx(S,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"No Projects Yet"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Create your first SCA project to start analyzing dependencies"}),e.jsxs("button",{onClick:()=>g(!0),className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-500",children:[e.jsx(k,{className:"h-4 w-4 inline mr-2"}),"Add Project"]})]})]}),o==="dependencies"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-4 mb-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(W,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search dependencies...",value:v,onChange:s=>z(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white"})]})}),e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Package"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Version"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Latest"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"License"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{children:G.map(s=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:u(s.ecosystem)}),e.jsx("span",{className:"text-white",children:s.name})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.version}),e.jsx("td",{className:"px-4 py-3",children:s.update_available?e.jsx("span",{className:"text-cyan-400",children:s.latest_version}):e.jsx("span",{className:"text-green-400",children:s.version})}),e.jsx("td",{className:`px-4 py-3 ${O(s.license_risk)}`,children:s.license||"Unknown"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.is_direct?"bg-cyan-600 text-white":"bg-gray-600 text-gray-300"}`,children:s.is_direct?"Direct":"Transitive"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{className:"p-1 hover:bg-gray-700 rounded",children:e.jsx(Y,{className:"h-4 w-4 text-gray-400"})})})]},s.id))})]})})]}),o==="vulnerabilities"&&e.jsx("div",{className:"space-y-4",children:b.map(s=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs text-white ${_(s.severity)}`,children:s.severity.toUpperCase()}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:s.vuln_id}),e.jsx("p",{className:"text-gray-300 mt-1",children:s.title}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:s.description}),s.fixed_version&&e.jsxs("p",{className:"text-green-400 text-sm mt-2",children:["Fixed in version: ",s.fixed_version]})]})]}),e.jsxs("div",{className:"text-right",children:[s.cvss_score&&e.jsxs("div",{className:"text-white font-bold",children:["CVSS: ",s.cvss_score]}),e.jsx("div",{className:"text-gray-400 text-sm",children:s.source}),s.exploited_in_wild&&e.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-red-600 text-white text-xs rounded",children:"Exploited in Wild"})]})]})},s.id))}),o==="overview"&&t&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Selected Project"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-3xl",children:u(t.ecosystem)}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold text-white",children:t.name}),e.jsx("p",{className:"text-gray-400",children:t.ecosystem})]})]}),t.repository_url&&e.jsxs("a",{href:t.repository_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-cyan-400 hover:underline",children:[e.jsx(Z,{className:"h-4 w-4"}),t.repository_url]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{className:"bg-gray-700 rounded p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:t.total_dependencies}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Dependencies"})]}),e.jsxs("div",{className:"bg-gray-700 rounded p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:t.vulnerable_dependencies}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Vulnerable"})]}),e.jsxs("div",{className:"bg-gray-700 rounded p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:t.license_issues}),e.jsx("div",{className:"text-gray-400 text-sm",children:"License Issues"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Recent Vulnerabilities"}),e.jsx("div",{className:"space-y-3",children:b.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 rounded p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs text-white ${_(s.severity)}`,children:s.severity.toUpperCase()}),e.jsx("span",{className:"text-white",children:s.vuln_id})]}),s.cvss_score&&e.jsxs("span",{className:"text-gray-300",children:["CVSS: ",s.cvss_score]})]},s.id))})]})]})]})]}),M&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Add SCA Project"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Project Name *"}),e.jsx("input",{type:"text",value:c.name,onChange:s=>x({...c,name:s.target.value}),placeholder:"e.g., my-web-app",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Repository URL"}),e.jsx("input",{type:"url",value:c.repository_url,onChange:s=>x({...c,repository_url:s.target.value}),placeholder:"https://github.com/user/repo",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Ecosystem"}),e.jsxs("select",{value:c.ecosystem,onChange:s=>x({...c,ecosystem:s.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"npm",children:"ðŸ“¦ npm (JavaScript/Node.js)"}),e.jsx("option",{value:"cargo",children:"ðŸ¦€ Cargo (Rust)"}),e.jsx("option",{value:"pypi",children:"ðŸ PyPI (Python)"}),e.jsx("option",{value:"go",children:"ðŸ¹ Go Modules"}),e.jsx("option",{value:"maven",children:"â˜• Maven (Java)"}),e.jsx("option",{value:"nuget",children:"ðŸ”· NuGet (.NET)"}),e.jsx("option",{value:"composer",children:"ðŸ˜ Composer (PHP)"}),e.jsx("option",{value:"rubygems",children:"ðŸ’Ž RubyGems"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{g(!1),x({name:"",repository_url:"",ecosystem:"npm"})},className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{onClick:V,disabled:f||!c.name.trim(),className:"flex-1 px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Creating...":"Create Project"})]})]})})]})};export{ne as default};
