import{b as I,u as x,d as b,j as e}from"./vendor-state-DdX3IZQk.js";import{r as j}from"./vendor-react-Da1CiaFS.js";import{Q as Y,D as M,A as Z,q as N,a3 as f,N as v,a9 as P,P as T,aR as g,at as ee,ae as q,E as z,aN as se,B as m,aq as te}from"./vendor-ui-wM19Qo8C.js";import{d as ae,a5 as c}from"./index-hrzMRAZZ.js";import"./vendor-charts-CCbxmwBt.js";const d={getStats:()=>c.get("/forensics/stats").then(s=>s.data),listCases:s=>c.get("/forensics/cases",{params:s}).then(a=>a.data),createCase:s=>c.post("/forensics/cases",s).then(a=>a.data),getCase:s=>c.get(`/forensics/cases/${s}`).then(a=>a.data),updateCase:(s,a)=>c.put(`/forensics/cases/${s}`,a).then(r=>r.data),closeCase:(s,a)=>c.post(`/forensics/cases/${s}/close`,a).then(r=>r.data),listMemoryDumps:s=>c.get("/forensics/memory",{params:s?{case_id:s}:{}}).then(a=>a.data),uploadMemoryDump:(s,a)=>c.post(`/forensics/cases/${s}/memory`,a,{headers:{"Content-Type":"multipart/form-data"}}).then(r=>r.data),analyzeMemory:s=>c.post(`/forensics/memory/${s}/analyze`).then(a=>a.data),listDiskImages:s=>c.get("/forensics/disk",{params:s?{case_id:s}:{}}).then(a=>a.data),analyzeDisk:s=>c.post(`/forensics/disk/${s}/analyze`).then(a=>a.data),listPcaps:s=>c.get("/forensics/network",{params:s?{case_id:s}:{}}).then(a=>a.data),analyzePcap:s=>c.post(`/forensics/network/${s}/analyze`).then(a=>a.data),listArtifactCollections:s=>c.get("/forensics/artifacts",{params:s?{case_id:s}:{}}).then(a=>a.data),startCollection:(s,a)=>c.post(`/forensics/cases/${s}/artifacts/collect`,a).then(r=>r.data)},B={open:{bg:"bg-blue-500/20",text:"text-blue-400"},active:{bg:"bg-cyan-500/20",text:"text-cyan-400"},in_progress:{bg:"bg-yellow-500/20",text:"text-yellow-400"},analyzing:{bg:"bg-purple-500/20",text:"text-purple-400"},completed:{bg:"bg-green-500/20",text:"text-green-400"},closed:{bg:"bg-gray-500/20",text:"text-gray-400"},failed:{bg:"bg-red-500/20",text:"text-red-400"},pending:{bg:"bg-orange-500/20",text:"text-orange-400"}},E={low:{bg:"bg-gray-500/20",text:"text-gray-400"},medium:{bg:"bg-blue-500/20",text:"text-blue-400"},high:{bg:"bg-orange-500/20",text:"text-orange-400"},critical:{bg:"bg-red-500/20",text:"text-red-400"}};function y({status:s}){const a=B[s.toLowerCase()]||B.pending;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${a.bg} ${a.text}`,children:s.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase())})}function U({priority:s}){const a=E[s.toLowerCase()]||E.medium;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${a.bg} ${a.text}`,children:s.charAt(0).toUpperCase()+s.slice(1)})}const Q=({isOpen:s,onClose:a,title:r,children:l,size:i="md"})=>{if(!s)return null;const o={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:a}),e.jsxs("div",{className:`relative bg-gray-800 border border-gray-700 rounded-lg shadow-xl w-full ${o[i]} max-h-[90vh] overflow-y-auto mx-4`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 sticky top-0 bg-gray-800 z-10",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:r}),e.jsx("button",{onClick:a,className:"p-1 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-white",children:e.jsx(te,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4",children:l})]})]})},re=({onSubmit:s,onCancel:a,isLoading:r})=>{const[l,i]=j.useState({title:"",description:"",case_type:"incident",priority:"medium"}),o=n=>{n.preventDefault(),s(l)};return e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Title *"}),e.jsx("input",{type:"text",required:!0,value:l.title,onChange:n=>i({...l,title:n.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500",placeholder:"Case title..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:l.description,onChange:n=>i({...l,description:n.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500",rows:3,placeholder:"Describe the forensic investigation..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Case Type"}),e.jsxs("select",{value:l.case_type,onChange:n=>i({...l,case_type:n.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500",children:[e.jsx("option",{value:"incident",children:"Incident Response"}),e.jsx("option",{value:"malware",children:"Malware Analysis"}),e.jsx("option",{value:"insider_threat",children:"Insider Threat"}),e.jsx("option",{value:"data_breach",children:"Data Breach"}),e.jsx("option",{value:"fraud",children:"Fraud Investigation"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Priority"}),e.jsxs("select",{value:l.priority,onChange:n=>i({...l,priority:n.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:a,disabled:r,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors disabled:opacity-50",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:r,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors disabled:opacity-50 flex items-center gap-2",children:[r&&e.jsx(g,{className:"w-4 h-4 animate-spin"}),"Create Case"]})]})]})},le=({caseData:s,onClose:a})=>{I();const{data:r}=x({queryKey:["forensics-memory",s.id],queryFn:()=>d.listMemoryDumps(s.id)}),{data:l}=x({queryKey:["forensics-disk",s.id],queryFn:()=>d.listDiskImages(s.id)}),{data:i}=x({queryKey:["forensics-pcaps",s.id],queryFn:()=>d.listPcaps(s.id)});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:"text-gray-500 font-mono text-sm",children:s.case_number})}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:s.title}),s.description&&e.jsx("p",{className:"text-gray-400 mt-2",children:s.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{priority:s.priority}),e.jsx(y,{status:s.status})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-gray-900 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Case Type"}),e.jsx("p",{className:"text-white",children:s.case_type.replace(/_/g," ")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Created"}),e.jsx("p",{className:"text-white",children:new Date(s.created_at).toLocaleString()})]}),s.tags.length>0&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.tags.map((o,n)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs",children:o},n))})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-white",children:"Evidence"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:"w-8 h-8 text-purple-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:(r==null?void 0:r.length)||0}),e.jsx("p",{className:"text-sm text-gray-400",children:"Memory Dumps"})]})]})}),e.jsx("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{className:"w-8 h-8 text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:(l==null?void 0:l.length)||0}),e.jsx("p",{className:"text-sm text-gray-400",children:"Disk Images"})]})]})}),e.jsx("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{className:"w-8 h-8 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:(i==null?void 0:i.length)||0}),e.jsx("p",{className:"text-sm text-gray-400",children:"PCAP Captures"})]})]})})]})]})]})};function xe(){const s=I(),[a,r]=j.useState("cases"),[l,i]=j.useState(!1),[o,n]=j.useState(null),[u,H]=j.useState(""),{data:h}=x({queryKey:["forensics-stats"],queryFn:()=>d.getStats()}),{data:w,isLoading:O}=x({queryKey:["forensics-cases",u],queryFn:()=>d.listCases(u?{status:u}:{}),enabled:a==="cases"}),{data:C,isLoading:R}=x({queryKey:["forensics-memory"],queryFn:()=>d.listMemoryDumps(),enabled:a==="memory"}),{data:k,isLoading:G}=x({queryKey:["forensics-disk"],queryFn:()=>d.listDiskImages(),enabled:a==="disk"}),{data:_,isLoading:V}=x({queryKey:["forensics-pcaps"],queryFn:()=>d.listPcaps(),enabled:a==="network"}),{data:F,isLoading:X}=x({queryKey:["forensics-artifacts"],queryFn:()=>d.listArtifactCollections(),enabled:a==="artifacts"}),A=b({mutationFn:d.createCase,onSuccess:()=>{s.invalidateQueries({queryKey:["forensics-cases"]}),s.invalidateQueries({queryKey:["forensics-stats"]}),i(!1),m.success("Forensic case created successfully")},onError:()=>m.error("Failed to create case")}),D=b({mutationFn:d.analyzeMemory,onSuccess:()=>{s.invalidateQueries({queryKey:["forensics-memory"]}),m.success("Memory analysis started")},onError:()=>m.error("Failed to start memory analysis")}),L=b({mutationFn:d.analyzeDisk,onSuccess:()=>{s.invalidateQueries({queryKey:["forensics-disk"]}),m.success("Disk analysis started")},onError:()=>m.error("Failed to start disk analysis")}),K=b({mutationFn:d.analyzePcap,onSuccess:()=>{s.invalidateQueries({queryKey:["forensics-pcaps"]}),m.success("PCAP analysis started")},onError:()=>m.error("Failed to start PCAP analysis")}),J=[{id:"cases",label:"Cases",icon:e.jsx(M,{className:"w-4 h-4"})},{id:"memory",label:"Memory Analysis",icon:e.jsx(N,{className:"w-4 h-4"})},{id:"disk",label:"Disk Forensics",icon:e.jsx(f,{className:"w-4 h-4"})},{id:"network",label:"Network Analysis",icon:e.jsx(v,{className:"w-4 h-4"})},{id:"artifacts",label:"Artifacts",icon:e.jsx(P,{className:"w-4 h-4"})}],S=t=>{if(t===0)return"0 B";const p=1024,W=["B","KB","MB","GB","TB"],$=Math.floor(Math.log(t)/Math.log(p));return parseFloat((t/Math.pow(p,$)).toFixed(2))+" "+W[$]};return e.jsx(ae,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(Y,{className:"w-8 h-8 text-blue-500"}),"Digital Forensics"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Memory, disk, and network forensic analysis"})]})}),h&&e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(M,{className:"w-6 h-6 text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:h.total_cases}),e.jsx("p",{className:"text-xs text-gray-400",children:"Total Cases"})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"w-6 h-6 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:h.active_cases}),e.jsx("p",{className:"text-xs text-gray-400",children:"Active"})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:"w-6 h-6 text-purple-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:h.memory_dumps}),e.jsx("p",{className:"text-xs text-gray-400",children:"Memory Dumps"})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{className:"w-6 h-6 text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:h.disk_images}),e.jsx("p",{className:"text-xs text-gray-400",children:"Disk Images"})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{className:"w-6 h-6 text-yellow-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:h.pcap_files}),e.jsx("p",{className:"text-xs text-gray-400",children:"PCAP Files"})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"w-6 h-6 text-orange-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:h.artifact_collections}),e.jsx("p",{className:"text-xs text-gray-400",children:"Artifacts"})]})]})})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:J.map(t=>e.jsxs("button",{onClick:()=>r(t.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${a===t.id?"border-cyan-500 text-cyan-500":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[t.icon,t.label]},t.id))})}),e.jsxs("div",{children:[a==="cases"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("select",{value:u,onChange:t=>H(t.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"",children:"All Cases"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(T,{className:"w-4 h-4"}),"New Case"]})]}),O?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(g,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):w&&w.length>0?e.jsx("div",{className:"space-y-3",children:w.map(t=>e.jsx("div",{onClick:()=>n(t),className:"bg-gray-800 border border-gray-700 rounded-lg p-4 hover:border-gray-600 cursor-pointer transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:"text-gray-500 font-mono text-sm",children:t.case_number})}),e.jsx("h3",{className:"text-lg font-medium text-white",children:t.title}),t.description&&e.jsx("p",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"w-3 h-3"}),new Date(t.created_at).toLocaleDateString()]}),e.jsx("span",{children:t.case_type.replace(/_/g," ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{priority:t.priority}),e.jsx(y,{status:t.status})]})]})},t.id))}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(M,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Forensic Cases"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Create a case to start your investigation"}),e.jsxs("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(T,{className:"w-4 h-4 inline mr-2"}),"Create Case"]})]})]}),a==="memory"&&e.jsx("div",{className:"space-y-4",children:R?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(g,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):C&&C.length>0?e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Hostname"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"OS"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Size"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Created"}),e.jsx("th",{className:"text-right p-4 text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:C.map(t=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"p-4 text-white font-medium",children:t.hostname}),e.jsxs("td",{className:"p-4 text-gray-400",children:[t.os_type," ",t.os_version]}),e.jsx("td",{className:"p-4 text-gray-400",children:S(t.dump_size_bytes)}),e.jsx("td",{className:"p-4",children:e.jsx(y,{status:t.status})}),e.jsx("td",{className:"p-4 text-gray-500 text-sm",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.status==="pending"&&e.jsx("button",{onClick:()=>D.mutate(t.id),disabled:D.isPending,className:"p-2 hover:bg-gray-600 rounded-lg text-cyan-400",children:e.jsx(q,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 hover:bg-gray-600 rounded-lg text-gray-400",children:e.jsx(z,{className:"w-4 h-4"})})]})})]},t.id))})]})}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(N,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Memory Dumps"}),e.jsx("p",{className:"text-gray-400",children:"Upload memory dumps from forensic cases to analyze"})]})}),a==="disk"&&e.jsx("div",{className:"space-y-4",children:G?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(g,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):k&&k.length>0?e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Hostname"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Type"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Format"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Size"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"text-right p-4 text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:k.map(t=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"p-4 text-white font-medium",children:t.hostname}),e.jsx("td",{className:"p-4 text-gray-400",children:t.disk_type}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs",children:t.image_format.toUpperCase()})}),e.jsx("td",{className:"p-4 text-gray-400",children:S(t.size_bytes)}),e.jsx("td",{className:"p-4",children:e.jsx(y,{status:t.status})}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.status==="pending"&&e.jsx("button",{onClick:()=>L.mutate(t.id),disabled:L.isPending,className:"p-2 hover:bg-gray-600 rounded-lg text-cyan-400",children:e.jsx(q,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 hover:bg-gray-600 rounded-lg text-gray-400",children:e.jsx(z,{className:"w-4 h-4"})})]})})]},t.id))})]})}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(f,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Disk Images"}),e.jsx("p",{className:"text-gray-400",children:"Upload disk images from forensic cases to analyze"})]})}),a==="network"&&e.jsx("div",{className:"space-y-4",children:V?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(g,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):_&&_.length>0?e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Name"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Size"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Packets"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Duration"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"text-right p-4 text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:_.map(t=>{var p;return e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.name}),t.description&&e.jsx("p",{className:"text-xs text-gray-500",children:t.description})]})}),e.jsx("td",{className:"p-4 text-gray-400",children:S(t.file_size_bytes)}),e.jsx("td",{className:"p-4 text-gray-400",children:((p=t.packet_count)==null?void 0:p.toLocaleString())||"-"}),e.jsx("td",{className:"p-4 text-gray-400",children:t.duration_seconds?`${Math.round(t.duration_seconds)}s`:"-"}),e.jsx("td",{className:"p-4",children:e.jsx(y,{status:t.status})}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.status==="pending"&&e.jsx("button",{onClick:()=>K.mutate(t.id),disabled:K.isPending,className:"p-2 hover:bg-gray-600 rounded-lg text-cyan-400",children:e.jsx(q,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 hover:bg-gray-600 rounded-lg text-gray-400",children:e.jsx(z,{className:"w-4 h-4"})})]})})]},t.id)})})]})}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(v,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No PCAP Files"}),e.jsx("p",{className:"text-gray-400",children:"Upload network captures from forensic cases to analyze"})]})}),a==="artifacts"&&e.jsx("div",{className:"space-y-4",children:X?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(g,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):F&&F.length>0?e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Hostname"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Collection Type"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Artifacts"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-400",children:"Created"}),e.jsx("th",{className:"text-right p-4 text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:F.map(t=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"p-4 text-white font-medium",children:t.hostname}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs",children:t.collection_type})}),e.jsx("td",{className:"p-4 text-gray-400",children:t.artifacts_collected}),e.jsx("td",{className:"p-4",children:e.jsx(y,{status:t.status})}),e.jsx("td",{className:"p-4 text-gray-500 text-sm",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("button",{className:"p-2 hover:bg-gray-600 rounded-lg text-gray-400",children:e.jsx(se,{className:"w-4 h-4"})})})]},t.id))})]})}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(P,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Artifact Collections"}),e.jsx("p",{className:"text-gray-400",children:"Start artifact collection from forensic cases"})]})})]}),e.jsx(Q,{isOpen:l,onClose:()=>i(!1),title:"Create Forensic Case",children:e.jsx(re,{onSubmit:t=>A.mutate(t),onCancel:()=>i(!1),isLoading:A.isPending})}),e.jsx(Q,{isOpen:!!o,onClose:()=>n(null),title:"Case Details",size:"lg",children:o&&e.jsx(le,{caseData:o,onClose:()=>n(null)})})]})})}export{xe as default};
