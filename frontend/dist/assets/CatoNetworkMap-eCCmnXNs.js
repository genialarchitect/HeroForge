import{e as pr,f as hr,j as a}from"./vendor-state-BXNPjUwt.js";import{R as mr,r as N}from"./vendor-react-5KxtEOLM.js";import{s as lt,p as Wn,z as Yn,i as xr,d as Zn,t as yr}from"./vendor-viz-7_UERYEb.js";import{f as bt,y as vt}from"./vendor-charts-CaL4i8-H.js";import{aY as ot,X as rt,F as wr,C as br,h as vr,L as Nr,B as ce,af as Xn,z as Sr,m as Gn,a6 as Er,a7 as jr,bt as Cr,g as $t,O as Ve,i as Tt,a4 as Un,aI as kr,E as Mr,a as Ar,G as Ir,w as tn,bz as Pr,bA as Dr,n as $r,W as Tr,bB as Lr,bv as _r,aZ as zr,aj as nn,bb as Hr,ar as Rr,x as Kn,ai as Br,S as qn,s as Vr,ab as Fr}from"./vendor-ui-DGSzT-Xm.js";import{B as ue,M as Re}from"./index-t7VPhhr8.js";import{L as sn}from"./Layout-BlRtLSTJ.js";import{L as Or}from"./LoadingSpinner-FDR9VoOL.js";import{u as Wr}from"./index-D-BwACm5.js";import"./vendor-utils-DfRopTPV.js";import"./vendor-markdown-RN55YrVy.js";function ie(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=ie(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}const fe={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Fe=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Qn=["Enter"," ","Escape"],Jn={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Ie;(function(e){e.Strict="strict",e.Loose="loose"})(Ie||(Ie={}));var Se;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Se||(Se={}));var Oe;(function(e){e.Partial="partial",e.Full="full"})(Oe||(Oe={}));const es={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var we;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(we||(we={}));var ne;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(ne||(ne={}));var Z;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Z||(Z={}));const on={[Z.Left]:Z.Right,[Z.Right]:Z.Left,[Z.Top]:Z.Bottom,[Z.Bottom]:Z.Top};function ts(e){return e===null?null:e?"valid":"invalid"}const ns=e=>"id"in e&&"source"in e&&"target"in e,Yr=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Lt=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Xe=(e,t=[0,0])=>{const{width:n,height:o}=he(e),s=e.origin??t,r=n*s[0],i=o*s[1];return{x:e.position.x-r,y:e.position.y-i}},Zr=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const r=typeof s=="string";let i=!t.nodeLookup&&!r?s:void 0;t.nodeLookup&&(i=r?t.nodeLookup.get(s):Lt(s)?s:t.nodeLookup.get(s.id));const c=i?it(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return dt(o,c)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return ut(n)},Ge=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},o=!1;return e.forEach(s=>{(t.filter===void 0||t.filter(s))&&(n=dt(n,it(s)),o=!0)}),o?ut(n):{x:0,y:0,width:0,height:0}},_t=(e,t,[n,o,s]=[0,0,1],r=!1,i=!1)=>{const c={...Ke(t,[n,o,s]),width:t.width/s,height:t.height/s},u=[];for(const g of e.values()){const{measured:h,selectable:l=!0,hidden:d=!1}=g;if(i&&!l||d)continue;const m=h.width??g.width??g.initialWidth??null,p=h.height??g.height??g.initialHeight??null,w=We(c,De(g)),y=(m??0)*(p??0),x=r&&w>0;(!g.internals.handleBounds||x||w>=y||g.dragging)&&u.push(g)}return u},Xr=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function Gr(e,t){const n=new Map,o=t!=null&&t.nodes?new Set(t.nodes.map(s=>s.id)):null;return e.forEach(s=>{s.measured.width&&s.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!s.hidden)&&(!o||o.has(s.id))&&n.set(s.id,s)}),n}async function Ur({nodes:e,width:t,height:n,panZoom:o,minZoom:s,maxZoom:r},i){if(e.size===0)return Promise.resolve(!0);const c=Gr(e,i),u=Ge(c),g=zt(u,t,n,(i==null?void 0:i.minZoom)??s,(i==null?void 0:i.maxZoom)??r,(i==null?void 0:i.padding)??.1);return await o.setViewport(g,{duration:i==null?void 0:i.duration,ease:i==null?void 0:i.ease,interpolate:i==null?void 0:i.interpolate}),Promise.resolve(!0)}function ss({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:s,onError:r}){const i=n.get(e),c=i.parentId?n.get(i.parentId):void 0,{x:u,y:g}=c?c.internals.positionAbsolute:{x:0,y:0},h=i.origin??o;let l=i.extent||s;if(i.extent==="parent"&&!i.expandParent)if(!c)r==null||r("005",fe.error005());else{const m=c.measured.width,p=c.measured.height;m&&p&&(l=[[u,g],[u+m,g+p]])}else c&&$e(i.extent)&&(l=[[i.extent[0][0]+u,i.extent[0][1]+g],[i.extent[1][0]+u,i.extent[1][1]+g]]);const d=$e(l)?Ee(t,l,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&(r==null||r("015",fe.error015())),{position:{x:d.x-u+(i.measured.width??0)*h[0],y:d.y-g+(i.measured.height??0)*h[1]},positionAbsolute:d}}async function Kr({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:s}){const r=new Set(e.map(d=>d.id)),i=[];for(const d of n){if(d.deletable===!1)continue;const m=r.has(d.id),p=!m&&d.parentId&&i.find(w=>w.id===d.parentId);(m||p)&&i.push(d)}const c=new Set(t.map(d=>d.id)),u=o.filter(d=>d.deletable!==!1),h=Xr(i,u);for(const d of u)c.has(d.id)&&!h.find(p=>p.id===d.id)&&h.push(d);if(!s)return{edges:h,nodes:i};const l=await s({nodes:i,edges:h});return typeof l=="boolean"?l?{edges:h,nodes:i}:{edges:[],nodes:[]}:l}const Pe=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Ee=(e={x:0,y:0},t,n)=>({x:Pe(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:Pe(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function os(e,t,n){const{width:o,height:s}=he(n),{x:r,y:i}=n.internals.positionAbsolute;return Ee(e,[[r,i],[r+o,i+s]],t)}const rn=(e,t,n)=>e<t?Pe(Math.abs(e-t),1,t)/t:e>n?-Pe(Math.abs(e-n),1,t)/t:0,rs=(e,t,n=15,o=40)=>{const s=rn(e.x,o,t.width-o)*n,r=rn(e.y,o,t.height-o)*n;return[s,r]},dt=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),kt=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),ut=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),De=(e,t=[0,0])=>{var s,r;const{x:n,y:o}=Lt(e)?e.internals.positionAbsolute:Xe(e,t);return{x:n,y:o,width:((s=e.measured)==null?void 0:s.width)??e.width??e.initialWidth??0,height:((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight??0}},it=(e,t=[0,0])=>{var s,r;const{x:n,y:o}=Lt(e)?e.internals.positionAbsolute:Xe(e,t);return{x:n,y:o,x2:n+(((s=e.measured)==null?void 0:s.width)??e.width??e.initialWidth??0),y2:o+(((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight??0)}},is=(e,t)=>ut(dt(kt(e),kt(t))),We=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},an=e=>le(e.width)&&le(e.height)&&le(e.x)&&le(e.y),le=e=>!isNaN(e)&&isFinite(e),qr=(e,t)=>{},Ue=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Ke=({x:e,y:t},[n,o,s],r=!1,i=[1,1])=>{const c={x:(e-n)/s,y:(t-o)/s};return r?Ue(c,i):c},at=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o});function ke(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Qr(e,t,n){if(typeof e=="string"||typeof e=="number"){const o=ke(e,n),s=ke(e,t);return{top:o,right:s,bottom:o,left:s,x:s*2,y:o*2}}if(typeof e=="object"){const o=ke(e.top??e.y??0,n),s=ke(e.bottom??e.y??0,n),r=ke(e.left??e.x??0,t),i=ke(e.right??e.x??0,t);return{top:o,right:i,bottom:s,left:r,x:r+i,y:o+s}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Jr(e,t,n,o,s,r){const{x:i,y:c}=at(e,[t,n,o]),{x:u,y:g}=at({x:e.x+e.width,y:e.y+e.height},[t,n,o]),h=s-u,l=r-g;return{left:Math.floor(i),top:Math.floor(c),right:Math.floor(h),bottom:Math.floor(l)}}const zt=(e,t,n,o,s,r)=>{const i=Qr(r,t,n),c=(t-i.x)/e.width,u=(n-i.y)/e.height,g=Math.min(c,u),h=Pe(g,o,s),l=e.x+e.width/2,d=e.y+e.height/2,m=t/2-l*h,p=n/2-d*h,w=Jr(e,m,p,h,t,n),y={left:Math.min(w.left-i.left,0),top:Math.min(w.top-i.top,0),right:Math.min(w.right-i.right,0),bottom:Math.min(w.bottom-i.bottom,0)};return{x:m-y.left+y.right,y:p-y.top+y.bottom,zoom:h}},Ye=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function $e(e){return e!=null&&e!=="parent"}function he(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function as(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function cs(e,t={width:0,height:0},n,o,s){const r={...e},i=o.get(n);if(i){const c=i.origin||s;r.x+=i.internals.positionAbsolute.x-(t.width??0)*c[0],r.y+=i.internals.positionAbsolute.y-(t.height??0)*c[1]}return r}function cn(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function ei(){let e,t;return{promise:new Promise((o,s)=>{e=o,t=s}),resolve:e,reject:t}}function ti(e){return{...Jn,...e||{}}}function Be(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:s}){const{x:r,y:i}=de(e),c=Ke({x:r-((s==null?void 0:s.left)??0),y:i-((s==null?void 0:s.top)??0)},o),{x:u,y:g}=n?Ue(c,t):c;return{xSnapped:u,ySnapped:g,...c}}const Ht=e=>({width:e.offsetWidth,height:e.offsetHeight}),ls=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},ni=["INPUT","SELECT","TEXTAREA"];function ds(e){var o,s;const t=((s=(o=e.composedPath)==null?void 0:o.call(e))==null?void 0:s[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:ni.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const us=e=>"clientX"in e,de=(e,t)=>{var r,i;const n=us(e),o=n?e.clientX:(r=e.touches)==null?void 0:r[0].clientX,s=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},ln=(e,t,n,o,s)=>{const r=t.querySelectorAll(`.${e}`);return!r||!r.length?null:Array.from(r).map(i=>{const c=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:s,position:i.getAttribute("data-handlepos"),x:(c.left-n.left)/o,y:(c.top-n.top)/o,...Ht(i)}})};function fs({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:r,targetControlX:i,targetControlY:c}){const u=e*.125+s*.375+i*.375+n*.125,g=t*.125+r*.375+c*.375+o*.125,h=Math.abs(u-e),l=Math.abs(g-t);return[u,g,h,l]}function et(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function dn({pos:e,x1:t,y1:n,x2:o,y2:s,c:r}){switch(e){case Z.Left:return[t-et(t-o,r),n];case Z.Right:return[t+et(o-t,r),n];case Z.Top:return[t,n-et(n-s,r)];case Z.Bottom:return[t,n+et(s-n,r)]}}function gs({sourceX:e,sourceY:t,sourcePosition:n=Z.Bottom,targetX:o,targetY:s,targetPosition:r=Z.Top,curvature:i=.25}){const[c,u]=dn({pos:n,x1:e,y1:t,x2:o,y2:s,c:i}),[g,h]=dn({pos:r,x1:o,y1:s,x2:e,y2:t,c:i}),[l,d,m,p]=fs({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:c,sourceControlY:u,targetControlX:g,targetControlY:h});return[`M${e},${t} C${c},${u} ${g},${h} ${o},${s}`,l,d,m,p]}function ps({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,r=n<e?n+s:n-s,i=Math.abs(o-t)/2,c=o<t?o+i:o-i;return[r,c,s,i]}function si({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o=0,elevateOnSelect:s=!1,zIndexMode:r="basic"}){if(r==="manual")return o;const i=s&&n?o+1e3:o,c=Math.max(e.parentId||s&&e.selected?e.internals.z:0,t.parentId||s&&t.selected?t.internals.z:0);return i+c}function oi({sourceNode:e,targetNode:t,width:n,height:o,transform:s}){const r=dt(it(e),it(t));r.x===r.x2&&(r.x2+=1),r.y===r.y2&&(r.y2+=1);const i={x:-s[0]/s[2],y:-s[1]/s[2],width:n/s[2],height:o/s[2]};return We(i,ut(r))>0}const ri=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,ii=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),hs=(e,t,n={})=>{if(!e.source||!e.target)return t;const o=n.getEdgeId||ri;let s;return ns(e)?s={...e}:s={...e,id:o(e)},ii(s,t)?t:(s.sourceHandle===null&&delete s.sourceHandle,s.targetHandle===null&&delete s.targetHandle,t.concat(s))};function ms({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,r,i,c]=ps({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,r,i,c]}const un={[Z.Left]:{x:-1,y:0},[Z.Right]:{x:1,y:0},[Z.Top]:{x:0,y:-1},[Z.Bottom]:{x:0,y:1}},ai=({source:e,sourcePosition:t=Z.Bottom,target:n})=>t===Z.Left||t===Z.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},fn=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function ci({source:e,sourcePosition:t=Z.Bottom,target:n,targetPosition:o=Z.Top,center:s,offset:r,stepPosition:i}){const c=un[t],u=un[o],g={x:e.x+c.x*r,y:e.y+c.y*r},h={x:n.x+u.x*r,y:n.y+u.y*r},l=ai({source:g,sourcePosition:t,target:h}),d=l.x!==0?"x":"y",m=l[d];let p=[],w,y;const x={x:0,y:0},b={x:0,y:0},[,,f,v]=ps({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(c[d]*u[d]===-1){d==="x"?(w=s.x??g.x+(h.x-g.x)*i,y=s.y??(g.y+h.y)/2):(w=s.x??(g.x+h.x)/2,y=s.y??g.y+(h.y-g.y)*i);const E=[{x:w,y:g.y},{x:w,y:h.y}],k=[{x:g.x,y},{x:h.x,y}];c[d]===m?p=d==="x"?E:k:p=d==="x"?k:E}else{const E=[{x:g.x,y:h.y}],k=[{x:h.x,y:g.y}];if(d==="x"?p=c.x===m?k:E:p=c.y===m?E:k,t===o){const j=Math.abs(e[d]-n[d]);if(j<=r){const D=Math.min(r-1,r-j);c[d]===m?x[d]=(g[d]>e[d]?-1:1)*D:b[d]=(h[d]>n[d]?-1:1)*D}}if(t!==o){const j=d==="x"?"y":"x",D=c[d]===u[j],H=g[j]>h[j],L=g[j]<h[j];(c[d]===1&&(!D&&H||D&&L)||c[d]!==1&&(!D&&L||D&&H))&&(p=d==="x"?E:k)}const I={x:g.x+x.x,y:g.y+x.y},S={x:h.x+b.x,y:h.y+b.y},T=Math.max(Math.abs(I.x-p[0].x),Math.abs(S.x-p[0].x)),C=Math.max(Math.abs(I.y-p[0].y),Math.abs(S.y-p[0].y));T>=C?(w=(I.x+S.x)/2,y=p[0].y):(w=p[0].x,y=(I.y+S.y)/2)}return[[e,{x:g.x+x.x,y:g.y+x.y},...p,{x:h.x+b.x,y:h.y+b.y},n],w,y,f,v]}function li(e,t,n,o){const s=Math.min(fn(e,t)/2,fn(t,n)/2,o),{x:r,y:i}=t;if(e.x===r&&r===n.x||e.y===i&&i===n.y)return`L${r} ${i}`;if(e.y===i){const g=e.x<n.x?-1:1,h=e.y<n.y?1:-1;return`L ${r+s*g},${i}Q ${r},${i} ${r},${i+s*h}`}const c=e.x<n.x?1:-1,u=e.y<n.y?-1:1;return`L ${r},${i+s*u}Q ${r},${i} ${r+s*c},${i}`}function Mt({sourceX:e,sourceY:t,sourcePosition:n=Z.Bottom,targetX:o,targetY:s,targetPosition:r=Z.Top,borderRadius:i=5,centerX:c,centerY:u,offset:g=20,stepPosition:h=.5}){const[l,d,m,p,w]=ci({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:r,center:{x:c,y:u},offset:g,stepPosition:h});return[l.reduce((x,b,f)=>{let v="";return f>0&&f<l.length-1?v=li(l[f-1],b,l[f+1],i):v=`${f===0?"M":"L"}${b.x} ${b.y}`,x+=v,x},""),d,m,p,w]}function gn(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function di(e){var l;const{sourceNode:t,targetNode:n}=e;if(!gn(t)||!gn(n))return null;const o=t.internals.handleBounds||pn(t.handles),s=n.internals.handleBounds||pn(n.handles),r=hn((o==null?void 0:o.source)??[],e.sourceHandle),i=hn(e.connectionMode===Ie.Strict?(s==null?void 0:s.target)??[]:((s==null?void 0:s.target)??[]).concat((s==null?void 0:s.source)??[]),e.targetHandle);if(!r||!i)return(l=e.onError)==null||l.call(e,"008",fe.error008(r?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const c=(r==null?void 0:r.position)||Z.Bottom,u=(i==null?void 0:i.position)||Z.Top,g=je(t,r,c),h=je(n,i,u);return{sourceX:g.x,sourceY:g.y,targetX:h.x,targetY:h.y,sourcePosition:c,targetPosition:u}}function pn(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function je(e,t,n=Z.Left,o=!1){const s=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,r=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:c}=t??he(e);if(o)return{x:s+i/2,y:r+c/2};switch((t==null?void 0:t.position)??n){case Z.Top:return{x:s+i/2,y:r};case Z.Right:return{x:s+i,y:r+c/2};case Z.Bottom:return{x:s+i/2,y:r+c};case Z.Left:return{x:s,y:r+c/2}}}function hn(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function At(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function ui(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:s}){const r=new Set;return e.reduce((i,c)=>([c.markerStart||o,c.markerEnd||s].forEach(u=>{if(u&&typeof u=="object"){const g=At(u,t);r.has(g)||(i.push({id:g,color:u.color||n,...u}),r.add(g))}}),i),[]).sort((i,c)=>i.id.localeCompare(c.id))}const xs=1e3,fi=10,Rt={nodeOrigin:[0,0],nodeExtent:Fe,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},gi={...Rt,checkEquality:!0};function Bt(e,t){const n={...e};for(const o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function pi(e,t,n){const o=Bt(Rt,n);for(const s of e.values())if(s.parentId)Ft(s,e,t,o);else{const r=Xe(s,o.nodeOrigin),i=$e(s.extent)?s.extent:o.nodeExtent,c=Ee(r,i,he(s));s.internals.positionAbsolute=c}}function hi(e,t){if(!e.handles)return e.measured?t==null?void 0:t.internals.handleBounds:void 0;const n=[],o=[];for(const s of e.handles){const r={id:s.id,width:s.width??1,height:s.height??1,nodeId:e.id,x:s.x,y:s.y,position:s.position,type:s.type};s.type==="source"?n.push(r):s.type==="target"&&o.push(r)}return{source:n,target:o}}function Vt(e){return e==="manual"}function It(e,t,n,o={}){var g,h;const s=Bt(gi,o),r={i:0},i=new Map(t),c=s!=null&&s.elevateNodesOnSelect&&!Vt(s.zIndexMode)?xs:0;let u=e.length>0;t.clear(),n.clear();for(const l of e){let d=i.get(l.id);if(s.checkEquality&&l===(d==null?void 0:d.internals.userNode))t.set(l.id,d);else{const m=Xe(l,s.nodeOrigin),p=$e(l.extent)?l.extent:s.nodeExtent,w=Ee(m,p,he(l));d={...s.defaults,...l,measured:{width:(g=l.measured)==null?void 0:g.width,height:(h=l.measured)==null?void 0:h.height},internals:{positionAbsolute:w,handleBounds:hi(l,d),z:ys(l,c,s.zIndexMode),userNode:l}},t.set(l.id,d)}(d.measured===void 0||d.measured.width===void 0||d.measured.height===void 0)&&!d.hidden&&(u=!1),l.parentId&&Ft(d,t,n,o,r)}return u}function mi(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Ft(e,t,n,o,s){const{elevateNodesOnSelect:r,nodeOrigin:i,nodeExtent:c,zIndexMode:u}=Bt(Rt,o),g=e.parentId,h=t.get(g);if(!h){console.warn(`Parent node ${g} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}mi(e,n),s&&!h.parentId&&h.internals.rootParentIndex===void 0&&u==="auto"&&(h.internals.rootParentIndex=++s.i,h.internals.z=h.internals.z+s.i*fi),s&&h.internals.rootParentIndex!==void 0&&(s.i=h.internals.rootParentIndex);const l=r&&!Vt(u)?xs:0,{x:d,y:m,z:p}=xi(e,h,i,c,l,u),{positionAbsolute:w}=e.internals,y=d!==w.x||m!==w.y;(y||p!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:y?{x:d,y:m}:w,z:p}})}function ys(e,t,n){const o=le(e.zIndex)?e.zIndex:0;return Vt(n)?o:o+(e.selected?t:0)}function xi(e,t,n,o,s,r){const{x:i,y:c}=t.internals.positionAbsolute,u=he(e),g=Xe(e,n),h=$e(e.extent)?Ee(g,e.extent,u):g;let l=Ee({x:i+h.x,y:c+h.y},o,u);e.extent==="parent"&&(l=os(l,u,t));const d=ys(e,s,r),m=t.internals.z??0;return{x:l.x,y:l.y,z:m>=d?m+1:d}}function Ot(e,t,n,o=[0,0]){var i;const s=[],r=new Map;for(const c of e){const u=t.get(c.parentId);if(!u)continue;const g=((i=r.get(c.parentId))==null?void 0:i.expandedRect)??De(u),h=is(g,c.rect);r.set(c.parentId,{expandedRect:h,parent:u})}return r.size>0&&r.forEach(({expandedRect:c,parent:u},g)=>{var f;const h=u.internals.positionAbsolute,l=he(u),d=u.origin??o,m=c.x<h.x?Math.round(Math.abs(h.x-c.x)):0,p=c.y<h.y?Math.round(Math.abs(h.y-c.y)):0,w=Math.max(l.width,Math.round(c.width)),y=Math.max(l.height,Math.round(c.height)),x=(w-l.width)*d[0],b=(y-l.height)*d[1];(m>0||p>0||x||b)&&(s.push({id:g,type:"position",position:{x:u.position.x-m+x,y:u.position.y-p+b}}),(f=n.get(g))==null||f.forEach(v=>{e.some(M=>M.id===v.id)||s.push({id:v.id,type:"position",position:{x:v.position.x+m,y:v.position.y+p}})})),(l.width<c.width||l.height<c.height||m||p)&&s.push({id:g,type:"dimensions",setAttributes:!0,dimensions:{width:w+(m?d[0]*m-x:0),height:y+(p?d[1]*p-b:0)}})}),s}function yi(e,t,n,o,s,r,i){const c=o==null?void 0:o.querySelector(".xyflow__viewport");let u=!1;if(!c)return{changes:[],updatedInternals:u};const g=[],h=window.getComputedStyle(c),{m22:l}=new window.DOMMatrixReadOnly(h.transform),d=[];for(const m of e.values()){const p=t.get(m.id);if(!p)continue;if(p.hidden){t.set(p.id,{...p,internals:{...p.internals,handleBounds:void 0}}),u=!0;continue}const w=Ht(m.nodeElement),y=p.measured.width!==w.width||p.measured.height!==w.height;if(!!(w.width&&w.height&&(y||!p.internals.handleBounds||m.force))){const b=m.nodeElement.getBoundingClientRect(),f=$e(p.extent)?p.extent:r;let{positionAbsolute:v}=p.internals;p.parentId&&p.extent==="parent"?v=os(v,w,t.get(p.parentId)):f&&(v=Ee(v,f,w));const M={...p,measured:w,internals:{...p.internals,positionAbsolute:v,handleBounds:{source:ln("source",m.nodeElement,b,l,p.id),target:ln("target",m.nodeElement,b,l,p.id)}}};t.set(p.id,M),p.parentId&&Ft(M,t,n,{nodeOrigin:s,zIndexMode:i}),u=!0,y&&(g.push({id:p.id,type:"dimensions",dimensions:w}),p.expandParent&&p.parentId&&d.push({id:p.id,parentId:p.parentId,rect:De(M,s)}))}}if(d.length>0){const m=Ot(d,t,n,s);g.push(...m)}return{changes:g,updatedInternals:u}}async function wi({delta:e,panZoom:t,transform:n,translateExtent:o,width:s,height:r}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[s,r]],o),c=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(c)}function mn(e,t,n,o,s,r){let i=s;const c=o.get(i)||new Map;o.set(i,c.set(n,t)),i=`${s}-${e}`;const u=o.get(i)||new Map;if(o.set(i,u.set(n,t)),r){i=`${s}-${e}-${r}`;const g=o.get(i)||new Map;o.set(i,g.set(n,t))}}function ws(e,t,n){e.clear(),t.clear();for(const o of n){const{source:s,target:r,sourceHandle:i=null,targetHandle:c=null}=o,u={edgeId:o.id,source:s,target:r,sourceHandle:i,targetHandle:c},g=`${s}-${i}--${r}-${c}`,h=`${r}-${c}--${s}-${i}`;mn("source",u,h,e,s,i),mn("target",u,g,e,r,c),t.set(o.id,o)}}function bs(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:bs(n,t):!1}function xn(e,t,n){var s;let o=e;do{if((s=o==null?void 0:o.matches)!=null&&s.call(o,t))return!0;if(o===n)return!1;o=o==null?void 0:o.parentElement}while(o);return!1}function bi(e,t,n,o){const s=new Map;for(const[r,i]of e)if((i.selected||i.id===o)&&(!i.parentId||!bs(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const c=e.get(r);c&&s.set(r,{id:r,position:c.position||{x:0,y:0},distance:{x:n.x-c.internals.positionAbsolute.x,y:n.y-c.internals.positionAbsolute.y},extent:c.extent,parentId:c.parentId,origin:c.origin,expandParent:c.expandParent,internals:{positionAbsolute:c.internals.positionAbsolute||{x:0,y:0}},measured:{width:c.measured.width??0,height:c.measured.height??0}})}return s}function Nt({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){var i,c,u;const s=[];for(const[g,h]of t){const l=(i=n.get(g))==null?void 0:i.internals.userNode;l&&s.push({...l,position:h.position,dragging:o})}if(!e)return[s[0],s];const r=(c=n.get(e))==null?void 0:c.internals.userNode;return[r?{...r,position:((u=t.get(e))==null?void 0:u.position)||r.position,dragging:o}:s[0],s]}function vi({dragItems:e,snapGrid:t,x:n,y:o}){const s=e.values().next().value;if(!s)return null;const r={x:n-s.distance.x,y:o-s.distance.y},i=Ue(r,t);return{x:i.x-r.x,y:i.y-r.y}}function Ni({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:s}){let r={x:null,y:null},i=0,c=new Map,u=!1,g={x:0,y:0},h=null,l=!1,d=null,m=!1,p=!1,w=null;function y({noDragClassName:b,handleSelector:f,domNode:v,isSelectable:M,nodeId:E,nodeClickDistance:k=0}){d=lt(v);function I({x:j,y:D}){const{nodeLookup:H,nodeExtent:L,snapGrid:V,snapToGrid:R,nodeOrigin:P,onNodeDrag:A,onSelectionDrag:F,onError:O,updateNodePositions:B}=t();r={x:j,y:D};let $=!1;const _=c.size>1,W=_&&L?kt(Ge(c)):null,X=_&&R?vi({dragItems:c,snapGrid:V,x:j,y:D}):null;for(const[Q,z]of c){if(!H.has(Q))continue;let U={x:j-z.distance.x,y:D-z.distance.y};R&&(U=X?{x:Math.round(U.x+X.x),y:Math.round(U.y+X.y)}:Ue(U,V));let G=null;if(_&&L&&!z.extent&&W){const{positionAbsolute:q}=z.internals,te=q.x-W.x+L[0][0],se=q.x+z.measured.width-W.x2+L[1][0],ee=q.y-W.y+L[0][1],ae=q.y+z.measured.height-W.y2+L[1][1];G=[[te,ee],[se,ae]]}const{position:Y,positionAbsolute:K}=ss({nodeId:Q,nextPosition:U,nodeLookup:H,nodeExtent:G||L,nodeOrigin:P,onError:O});$=$||z.position.x!==Y.x||z.position.y!==Y.y,z.position=Y,z.internals.positionAbsolute=K}if(p=p||$,!!$&&(B(c,!0),w&&(o||A||!E&&F))){const[Q,z]=Nt({nodeId:E,dragItems:c,nodeLookup:H});o==null||o(w,c,Q,z),A==null||A(w,Q,z),E||F==null||F(w,z)}}async function S(){if(!h)return;const{transform:j,panBy:D,autoPanSpeed:H,autoPanOnNodeDrag:L}=t();if(!L){u=!1,cancelAnimationFrame(i);return}const[V,R]=rs(g,h,H);(V!==0||R!==0)&&(r.x=(r.x??0)-V/j[2],r.y=(r.y??0)-R/j[2],await D({x:V,y:R})&&I(r)),i=requestAnimationFrame(S)}function T(j){var _;const{nodeLookup:D,multiSelectionActive:H,nodesDraggable:L,transform:V,snapGrid:R,snapToGrid:P,selectNodesOnDrag:A,onNodeDragStart:F,onSelectionDragStart:O,unselectNodesAndEdges:B}=t();l=!0,(!A||!M)&&!H&&E&&((_=D.get(E))!=null&&_.selected||B()),M&&A&&E&&(e==null||e(E));const $=Be(j.sourceEvent,{transform:V,snapGrid:R,snapToGrid:P,containerBounds:h});if(r=$,c=bi(D,L,$,E),c.size>0&&(n||F||!E&&O)){const[W,X]=Nt({nodeId:E,dragItems:c,nodeLookup:D});n==null||n(j.sourceEvent,c,W,X),F==null||F(j.sourceEvent,W,X),E||O==null||O(j.sourceEvent,X)}}const C=Zn().clickDistance(k).on("start",j=>{const{domNode:D,nodeDragThreshold:H,transform:L,snapGrid:V,snapToGrid:R}=t();h=(D==null?void 0:D.getBoundingClientRect())||null,m=!1,p=!1,w=j.sourceEvent,H===0&&T(j),r=Be(j.sourceEvent,{transform:L,snapGrid:V,snapToGrid:R,containerBounds:h}),g=de(j.sourceEvent,h)}).on("drag",j=>{const{autoPanOnNodeDrag:D,transform:H,snapGrid:L,snapToGrid:V,nodeDragThreshold:R,nodeLookup:P}=t(),A=Be(j.sourceEvent,{transform:H,snapGrid:L,snapToGrid:V,containerBounds:h});if(w=j.sourceEvent,(j.sourceEvent.type==="touchmove"&&j.sourceEvent.touches.length>1||E&&!P.has(E))&&(m=!0),!m){if(!u&&D&&l&&(u=!0,S()),!l){const F=de(j.sourceEvent,h),O=F.x-g.x,B=F.y-g.y;Math.sqrt(O*O+B*B)>R&&T(j)}(r.x!==A.xSnapped||r.y!==A.ySnapped)&&c&&l&&(g=de(j.sourceEvent,h),I(A))}}).on("end",j=>{if(!(!l||m)&&(u=!1,l=!1,cancelAnimationFrame(i),c.size>0)){const{nodeLookup:D,updateNodePositions:H,onNodeDragStop:L,onSelectionDragStop:V}=t();if(p&&(H(c,!1),p=!1),s||L||!E&&V){const[R,P]=Nt({nodeId:E,dragItems:c,nodeLookup:D,dragging:!1});s==null||s(j.sourceEvent,c,R,P),L==null||L(j.sourceEvent,R,P),E||V==null||V(j.sourceEvent,P)}}}).filter(j=>{const D=j.target;return!j.button&&(!b||!xn(D,`.${b}`,v))&&(!f||xn(D,f,v))});d.call(C)}function x(){d==null||d.on(".drag",null)}return{update:y,destroy:x}}function Si(e,t,n){const o=[],s={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const r of t.values())We(s,De(r))>0&&o.push(r);return o}const Ei=250;function ji(e,t,n,o){var c,u;let s=[],r=1/0;const i=Si(e,n,t+Ei);for(const g of i){const h=[...((c=g.internals.handleBounds)==null?void 0:c.source)??[],...((u=g.internals.handleBounds)==null?void 0:u.target)??[]];for(const l of h){if(o.nodeId===l.nodeId&&o.type===l.type&&o.id===l.id)continue;const{x:d,y:m}=je(g,l,l.position,!0),p=Math.sqrt(Math.pow(d-e.x,2)+Math.pow(m-e.y,2));p>t||(p<r?(s=[{...l,x:d,y:m}],r=p):p===r&&s.push({...l,x:d,y:m}))}}if(!s.length)return null;if(s.length>1){const g=o.type==="source"?"target":"source";return s.find(h=>h.type===g)??s[0]}return s[0]}function vs(e,t,n,o,s,r=!1){var g,h,l;const i=o.get(e);if(!i)return null;const c=s==="strict"?(g=i.internals.handleBounds)==null?void 0:g[t]:[...((h=i.internals.handleBounds)==null?void 0:h.source)??[],...((l=i.internals.handleBounds)==null?void 0:l.target)??[]],u=(n?c==null?void 0:c.find(d=>d.id===n):c==null?void 0:c[0])??null;return u&&r?{...u,...je(i,u,u.position,!0)}:u}function Ns(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Ci(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const Ss=()=>!0;function ki(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:s,edgeUpdaterType:r,isTarget:i,domNode:c,nodeLookup:u,lib:g,autoPanOnConnect:h,flowId:l,panBy:d,cancelConnection:m,onConnectStart:p,onConnect:w,onConnectEnd:y,isValidConnection:x=Ss,onReconnectEnd:b,updateConnection:f,getTransform:v,getFromHandle:M,autoPanSpeed:E,dragThreshold:k=1,handleDomNode:I}){const S=ls(e.target);let T=0,C;const{x:j,y:D}=de(e),H=Ns(r,I),L=c==null?void 0:c.getBoundingClientRect();let V=!1;if(!L||!H)return;const R=vs(s,H,o,u,t);if(!R)return;let P=de(e,L),A=!1,F=null,O=!1,B=null;function $(){if(!h||!L)return;const[Y,K]=rs(P,L,E);d({x:Y,y:K}),T=requestAnimationFrame($)}const _={...R,nodeId:s,type:H,position:R.position},W=u.get(s);let Q={inProgress:!0,isValid:null,from:je(W,_,Z.Left,!0),fromHandle:_,fromPosition:_.position,fromNode:W,to:P,toHandle:null,toPosition:on[_.position],toNode:null,pointer:P};function z(){V=!0,f(Q),p==null||p(e,{nodeId:s,handleId:o,handleType:H})}k===0&&z();function U(Y){if(!V){const{x:ae,y:me}=de(Y),ge=ae-j,ve=me-D;if(!(ge*ge+ve*ve>k*k))return;z()}if(!M()||!_){G(Y);return}const K=v();P=de(Y,L),C=ji(Ke(P,K,!1,[1,1]),n,u,_),A||($(),A=!0);const q=Es(Y,{handle:C,connectionMode:t,fromNodeId:s,fromHandleId:o,fromType:i?"target":"source",isValidConnection:x,doc:S,lib:g,flowId:l,nodeLookup:u});B=q.handleDomNode,F=q.connection,O=Ci(!!C,q.isValid);const te=u.get(s),se=te?je(te,_,Z.Left,!0):Q.from,ee={...Q,from:se,isValid:O,to:q.toHandle&&O?at({x:q.toHandle.x,y:q.toHandle.y},K):P,toHandle:q.toHandle,toPosition:O&&q.toHandle?q.toHandle.position:on[_.position],toNode:q.toHandle?u.get(q.toHandle.nodeId):null,pointer:P};f(ee),Q=ee}function G(Y){if(!("touches"in Y&&Y.touches.length>0)){if(V){(C||B)&&F&&O&&(w==null||w(F));const{inProgress:K,...q}=Q,te={...q,toPosition:Q.toHandle?Q.toPosition:null};y==null||y(Y,te),r&&(b==null||b(Y,te))}m(),cancelAnimationFrame(T),A=!1,O=!1,F=null,B=null,S.removeEventListener("mousemove",U),S.removeEventListener("mouseup",G),S.removeEventListener("touchmove",U),S.removeEventListener("touchend",G)}}S.addEventListener("mousemove",U),S.addEventListener("mouseup",G),S.addEventListener("touchmove",U),S.addEventListener("touchend",G)}function Es(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:s,fromType:r,doc:i,lib:c,flowId:u,isValidConnection:g=Ss,nodeLookup:h}){const l=r==="target",d=t?i.querySelector(`.${c}-flow__handle[data-id="${u}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:m,y:p}=de(e),w=i.elementFromPoint(m,p),y=w!=null&&w.classList.contains(`${c}-flow__handle`)?w:d,x={handleDomNode:y,isValid:!1,connection:null,toHandle:null};if(y){const b=Ns(void 0,y),f=y.getAttribute("data-nodeid"),v=y.getAttribute("data-handleid"),M=y.classList.contains("connectable"),E=y.classList.contains("connectableend");if(!f||!b)return x;const k={source:l?f:o,sourceHandle:l?v:s,target:l?o:f,targetHandle:l?s:v};x.connection=k;const S=M&&E&&(n===Ie.Strict?l&&b==="source"||!l&&b==="target":f!==o||v!==s);x.isValid=S&&g(k),x.toHandle=vs(f,b,v,h,n,!0)}return x}const Pt={onPointerDown:ki,isValid:Es};function Mi({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const s=lt(e);function r({translateExtent:c,width:u,height:g,zoomStep:h=1,pannable:l=!0,zoomable:d=!0,inversePan:m=!1}){const p=f=>{if(f.sourceEvent.type!=="wheel"||!t)return;const v=n(),M=f.sourceEvent.ctrlKey&&Ye()?10:1,E=-f.sourceEvent.deltaY*(f.sourceEvent.deltaMode===1?.05:f.sourceEvent.deltaMode?1:.002)*h,k=v[2]*Math.pow(2,E*M);t.scaleTo(k)};let w=[0,0];const y=f=>{(f.sourceEvent.type==="mousedown"||f.sourceEvent.type==="touchstart")&&(w=[f.sourceEvent.clientX??f.sourceEvent.touches[0].clientX,f.sourceEvent.clientY??f.sourceEvent.touches[0].clientY])},x=f=>{const v=n();if(f.sourceEvent.type!=="mousemove"&&f.sourceEvent.type!=="touchmove"||!t)return;const M=[f.sourceEvent.clientX??f.sourceEvent.touches[0].clientX,f.sourceEvent.clientY??f.sourceEvent.touches[0].clientY],E=[M[0]-w[0],M[1]-w[1]];w=M;const k=o()*Math.max(v[2],Math.log(v[2]))*(m?-1:1),I={x:v[0]-E[0]*k,y:v[1]-E[1]*k},S=[[0,0],[u,g]];t.setViewportConstrained({x:I.x,y:I.y,zoom:v[2]},S,c)},b=Yn().on("start",y).on("zoom",l?x:null).on("zoom.wheel",d?p:null);s.call(b,{})}function i(){s.on("zoom",null)}return{update:r,destroy:i,pointer:Wn}}const ft=e=>({x:e.x,y:e.y,zoom:e.k}),St=({x:e,y:t,zoom:n})=>xr.translate(e,t).scale(n),Me=(e,t)=>e.target.closest(`.${t}`),js=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Ai=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,Et=(e,t=0,n=Ai,o=()=>{})=>{const s=typeof t=="number"&&t>0;return s||o(),s?e.transition().duration(t).ease(n).on("end",o):e},Cs=e=>{const t=e.ctrlKey&&Ye()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Ii({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:s,panOnScrollSpeed:r,zoomOnPinch:i,onPanZoomStart:c,onPanZoom:u,onPanZoomEnd:g}){return h=>{if(Me(h,t))return h.ctrlKey&&h.preventDefault(),!1;h.preventDefault(),h.stopImmediatePropagation();const l=n.property("__zoom").k||1;if(h.ctrlKey&&i){const y=Wn(h),x=Cs(h),b=l*Math.pow(2,x);o.scaleTo(n,b,y,h);return}const d=h.deltaMode===1?20:1;let m=s===Se.Vertical?0:h.deltaX*d,p=s===Se.Horizontal?0:h.deltaY*d;!Ye()&&h.shiftKey&&s!==Se.Vertical&&(m=h.deltaY*d,p=0),o.translateBy(n,-(m/l)*r,-(p/l)*r,{internal:!0});const w=ft(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(u==null||u(h,w),e.panScrollTimeout=setTimeout(()=>{g==null||g(h,w),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,c==null||c(h,w))}}function Pi({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,s){const r=o.type==="wheel",i=!t&&r&&!o.ctrlKey,c=Me(o,e);if(o.ctrlKey&&r&&c&&o.preventDefault(),i||c)return null;o.preventDefault(),n.call(this,o,s)}}function Di({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{var r,i,c;if((r=o.sourceEvent)!=null&&r.internal)return;const s=ft(o.transform);e.mouseButton=((i=o.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=s,((c=o.sourceEvent)==null?void 0:c.type)==="mousedown"&&t(!0),n&&(n==null||n(o.sourceEvent,s))}}function $i({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:s}){return r=>{var i,c;e.usedRightMouseButton=!!(n&&js(t,e.mouseButton??0)),(i=r.sourceEvent)!=null&&i.sync||o([r.transform.x,r.transform.y,r.transform.k]),s&&!((c=r.sourceEvent)!=null&&c.internal)&&(s==null||s(r.sourceEvent,ft(r.transform)))}}function Ti({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:s,onPaneContextMenu:r}){return i=>{var c;if(!((c=i.sourceEvent)!=null&&c.internal)&&(e.isZoomingOrPanning=!1,r&&js(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&r(i.sourceEvent),e.usedRightMouseButton=!1,o(!1),s)){const u=ft(i.transform);e.prevViewport=u,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{s==null||s(i.sourceEvent,u)},n?150:0)}}}function Li({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:s,zoomOnDoubleClick:r,userSelectionActive:i,noWheelClassName:c,noPanClassName:u,lib:g,connectionInProgress:h}){return l=>{var y;const d=e||t,m=n&&l.ctrlKey,p=l.type==="wheel";if(l.button===1&&l.type==="mousedown"&&(Me(l,`${g}-flow__node`)||Me(l,`${g}-flow__edge`)))return!0;if(!o&&!d&&!s&&!r&&!n||i||h&&!p||Me(l,c)&&p||Me(l,u)&&(!p||s&&p&&!e)||!n&&l.ctrlKey&&p)return!1;if(!n&&l.type==="touchstart"&&((y=l.touches)==null?void 0:y.length)>1)return l.preventDefault(),!1;if(!d&&!s&&!m&&p||!o&&(l.type==="mousedown"||l.type==="touchstart")||Array.isArray(o)&&!o.includes(l.button)&&l.type==="mousedown")return!1;const w=Array.isArray(o)&&o.includes(l.button)||!l.button||l.button<=1;return(!l.ctrlKey||p)&&w}}function _i({domNode:e,minZoom:t,maxZoom:n,translateExtent:o,viewport:s,onPanZoom:r,onPanZoomStart:i,onPanZoomEnd:c,onDraggingChange:u}){const g={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},h=e.getBoundingClientRect(),l=Yn().scaleExtent([t,n]).translateExtent(o),d=lt(e).call(l);b({x:s.x,y:s.y,zoom:Pe(s.zoom,t,n)},[[0,0],[h.width,h.height]],o);const m=d.on("wheel.zoom"),p=d.on("dblclick.zoom");l.wheelDelta(Cs);function w(C,j){return d?new Promise(D=>{l==null||l.interpolate((j==null?void 0:j.interpolate)==="linear"?vt:bt).transform(Et(d,j==null?void 0:j.duration,j==null?void 0:j.ease,()=>D(!0)),C)}):Promise.resolve(!1)}function y({noWheelClassName:C,noPanClassName:j,onPaneContextMenu:D,userSelectionActive:H,panOnScroll:L,panOnDrag:V,panOnScrollMode:R,panOnScrollSpeed:P,preventScrolling:A,zoomOnPinch:F,zoomOnScroll:O,zoomOnDoubleClick:B,zoomActivationKeyPressed:$,lib:_,onTransformChange:W,connectionInProgress:X,paneClickDistance:Q,selectionOnDrag:z}){H&&!g.isZoomingOrPanning&&x();const U=L&&!$&&!H;l.clickDistance(z?1/0:!le(Q)||Q<0?0:Q);const G=U?Ii({zoomPanValues:g,noWheelClassName:C,d3Selection:d,d3Zoom:l,panOnScrollMode:R,panOnScrollSpeed:P,zoomOnPinch:F,onPanZoomStart:i,onPanZoom:r,onPanZoomEnd:c}):Pi({noWheelClassName:C,preventScrolling:A,d3ZoomHandler:m});if(d.on("wheel.zoom",G,{passive:!1}),!H){const K=Di({zoomPanValues:g,onDraggingChange:u,onPanZoomStart:i});l.on("start",K);const q=$i({zoomPanValues:g,panOnDrag:V,onPaneContextMenu:!!D,onPanZoom:r,onTransformChange:W});l.on("zoom",q);const te=Ti({zoomPanValues:g,panOnDrag:V,panOnScroll:L,onPaneContextMenu:D,onPanZoomEnd:c,onDraggingChange:u});l.on("end",te)}const Y=Li({zoomActivationKeyPressed:$,panOnDrag:V,zoomOnScroll:O,panOnScroll:L,zoomOnDoubleClick:B,zoomOnPinch:F,userSelectionActive:H,noPanClassName:j,noWheelClassName:C,lib:_,connectionInProgress:X});l.filter(Y),B?d.on("dblclick.zoom",p):d.on("dblclick.zoom",null)}function x(){l.on("zoom",null)}async function b(C,j,D){const H=St(C),L=l==null?void 0:l.constrain()(H,j,D);return L&&await w(L),new Promise(V=>V(L))}async function f(C,j){const D=St(C);return await w(D,j),new Promise(H=>H(D))}function v(C){if(d){const j=St(C),D=d.property("__zoom");(D.k!==C.zoom||D.x!==C.x||D.y!==C.y)&&(l==null||l.transform(d,j,null,{sync:!0}))}}function M(){const C=d?yr(d.node()):{x:0,y:0,k:1};return{x:C.x,y:C.y,zoom:C.k}}function E(C,j){return d?new Promise(D=>{l==null||l.interpolate((j==null?void 0:j.interpolate)==="linear"?vt:bt).scaleTo(Et(d,j==null?void 0:j.duration,j==null?void 0:j.ease,()=>D(!0)),C)}):Promise.resolve(!1)}function k(C,j){return d?new Promise(D=>{l==null||l.interpolate((j==null?void 0:j.interpolate)==="linear"?vt:bt).scaleBy(Et(d,j==null?void 0:j.duration,j==null?void 0:j.ease,()=>D(!0)),C)}):Promise.resolve(!1)}function I(C){l==null||l.scaleExtent(C)}function S(C){l==null||l.translateExtent(C)}function T(C){const j=!le(C)||C<0?0:C;l==null||l.clickDistance(j)}return{update:y,destroy:x,setViewport:f,setViewportConstrained:b,getViewport:M,scaleTo:E,scaleBy:k,setScaleExtent:I,setTranslateExtent:S,syncViewport:v,setClickDistance:T}}var Te;(function(e){e.Line="line",e.Handle="handle"})(Te||(Te={}));function zi({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:s,affectsY:r}){const i=e-t,c=n-o,u=[i>0?1:i<0?-1:0,c>0?1:c<0?-1:0];return i&&s&&(u[0]=u[0]*-1),c&&r&&(u[1]=u[1]*-1),u}function yn(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),s=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:s}}function xe(e,t){return Math.max(0,t-e)}function ye(e,t){return Math.max(0,e-t)}function tt(e,t,n){return Math.max(0,t-e,e-n)}function wn(e,t){return e?!t:t}function Hi(e,t,n,o,s,r,i,c){let{affectsX:u,affectsY:g}=t;const{isHorizontal:h,isVertical:l}=t,d=h&&l,{xSnapped:m,ySnapped:p}=n,{minWidth:w,maxWidth:y,minHeight:x,maxHeight:b}=o,{x:f,y:v,width:M,height:E,aspectRatio:k}=e;let I=Math.floor(h?m-e.pointerX:0),S=Math.floor(l?p-e.pointerY:0);const T=M+(u?-I:I),C=E+(g?-S:S),j=-r[0]*M,D=-r[1]*E;let H=tt(T,w,y),L=tt(C,x,b);if(i){let P=0,A=0;u&&I<0?P=xe(f+I+j,i[0][0]):!u&&I>0&&(P=ye(f+T+j,i[1][0])),g&&S<0?A=xe(v+S+D,i[0][1]):!g&&S>0&&(A=ye(v+C+D,i[1][1])),H=Math.max(H,P),L=Math.max(L,A)}if(c){let P=0,A=0;u&&I>0?P=ye(f+I,c[0][0]):!u&&I<0&&(P=xe(f+T,c[1][0])),g&&S>0?A=ye(v+S,c[0][1]):!g&&S<0&&(A=xe(v+C,c[1][1])),H=Math.max(H,P),L=Math.max(L,A)}if(s){if(h){const P=tt(T/k,x,b)*k;if(H=Math.max(H,P),i){let A=0;!u&&!g||u&&!g&&d?A=ye(v+D+T/k,i[1][1])*k:A=xe(v+D+(u?I:-I)/k,i[0][1])*k,H=Math.max(H,A)}if(c){let A=0;!u&&!g||u&&!g&&d?A=xe(v+T/k,c[1][1])*k:A=ye(v+(u?I:-I)/k,c[0][1])*k,H=Math.max(H,A)}}if(l){const P=tt(C*k,w,y)/k;if(L=Math.max(L,P),i){let A=0;!u&&!g||g&&!u&&d?A=ye(f+C*k+j,i[1][0])/k:A=xe(f+(g?S:-S)*k+j,i[0][0])/k,L=Math.max(L,A)}if(c){let A=0;!u&&!g||g&&!u&&d?A=xe(f+C*k,c[1][0])/k:A=ye(f+(g?S:-S)*k,c[0][0])/k,L=Math.max(L,A)}}}S=S+(S<0?L:-L),I=I+(I<0?H:-H),s&&(d?T>C*k?S=(wn(u,g)?-I:I)/k:I=(wn(u,g)?-S:S)*k:h?(S=I/k,g=u):(I=S*k,u=g));const V=u?f+I:f,R=g?v+S:v;return{width:M+(u?-I:I),height:E+(g?-S:S),x:r[0]*I*(u?-1:1)+V,y:r[1]*S*(g?-1:1)+R}}const ks={width:0,height:0,x:0,y:0},Ri={...ks,pointerX:0,pointerY:0,aspectRatio:1};function Bi(e){return[[0,0],[e.measured.width,e.measured.height]]}function Vi(e,t,n){const o=t.position.x+e.position.x,s=t.position.y+e.position.y,r=e.measured.width??0,i=e.measured.height??0,c=n[0]*r,u=n[1]*i;return[[o-c,s-u],[o+r-c,s+i-u]]}function Fi({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:s}){const r=lt(e);let i={controlDirection:yn("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function c({controlPosition:g,boundaries:h,keepAspectRatio:l,resizeDirection:d,onResizeStart:m,onResize:p,onResizeEnd:w,shouldResize:y}){let x={...ks},b={...Ri};i={boundaries:h,resizeDirection:d,keepAspectRatio:l,controlDirection:yn(g)};let f,v=null,M=[],E,k,I,S=!1;const T=Zn().on("start",C=>{const{nodeLookup:j,transform:D,snapGrid:H,snapToGrid:L,nodeOrigin:V,paneDomNode:R}=n();if(f=j.get(t),!f)return;v=(R==null?void 0:R.getBoundingClientRect())??null;const{xSnapped:P,ySnapped:A}=Be(C.sourceEvent,{transform:D,snapGrid:H,snapToGrid:L,containerBounds:v});x={width:f.measured.width??0,height:f.measured.height??0,x:f.position.x??0,y:f.position.y??0},b={...x,pointerX:P,pointerY:A,aspectRatio:x.width/x.height},E=void 0,f.parentId&&(f.extent==="parent"||f.expandParent)&&(E=j.get(f.parentId),k=E&&f.extent==="parent"?Bi(E):void 0),M=[],I=void 0;for(const[F,O]of j)if(O.parentId===t&&(M.push({id:F,position:{...O.position},extent:O.extent}),O.extent==="parent"||O.expandParent)){const B=Vi(O,f,O.origin??V);I?I=[[Math.min(B[0][0],I[0][0]),Math.min(B[0][1],I[0][1])],[Math.max(B[1][0],I[1][0]),Math.max(B[1][1],I[1][1])]]:I=B}m==null||m(C,{...x})}).on("drag",C=>{const{transform:j,snapGrid:D,snapToGrid:H,nodeOrigin:L}=n(),V=Be(C.sourceEvent,{transform:j,snapGrid:D,snapToGrid:H,containerBounds:v}),R=[];if(!f)return;const{x:P,y:A,width:F,height:O}=x,B={},$=f.origin??L,{width:_,height:W,x:X,y:Q}=Hi(b,i.controlDirection,V,i.boundaries,i.keepAspectRatio,$,k,I),z=_!==F,U=W!==O,G=X!==P&&z,Y=Q!==A&&U;if(!G&&!Y&&!z&&!U)return;if((G||Y||$[0]===1||$[1]===1)&&(B.x=G?X:x.x,B.y=Y?Q:x.y,x.x=B.x,x.y=B.y,M.length>0)){const se=X-P,ee=Q-A;for(const ae of M)ae.position={x:ae.position.x-se+$[0]*(_-F),y:ae.position.y-ee+$[1]*(W-O)},R.push(ae)}if((z||U)&&(B.width=z&&(!i.resizeDirection||i.resizeDirection==="horizontal")?_:x.width,B.height=U&&(!i.resizeDirection||i.resizeDirection==="vertical")?W:x.height,x.width=B.width,x.height=B.height),E&&f.expandParent){const se=$[0]*(B.width??0);B.x&&B.x<se&&(x.x=se,b.x=b.x-(B.x-se));const ee=$[1]*(B.height??0);B.y&&B.y<ee&&(x.y=ee,b.y=b.y-(B.y-ee))}const K=zi({width:x.width,prevWidth:F,height:x.height,prevHeight:O,affectsX:i.controlDirection.affectsX,affectsY:i.controlDirection.affectsY}),q={...x,direction:K};(y==null?void 0:y(C,q))!==!1&&(S=!0,p==null||p(C,q),o(B,R))}).on("end",C=>{S&&(w==null||w(C,{...x}),s==null||s({...x}),S=!1)});r.call(T)}function u(){r.on(".drag",null)}return{update:c,destroy:u}}const{useDebugValue:Oi}=mr,{useSyncExternalStoreWithSelector:Wi}=pr,Yi=e=>e;function Ms(e,t=Yi,n){const o=Wi(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Oi(o),o}const bn=(e,t)=>{const n=hr(e),o=(s,r=t)=>Ms(n,s,r);return Object.assign(o,n),o},Zi=(e,t)=>e?bn(e,t):bn;function oe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const gt=N.createContext(null),Xi=gt.Provider,As=fe.error001();function J(e,t){const n=N.useContext(gt);if(n===null)throw new Error(As);return Ms(n,e,t)}function re(){const e=N.useContext(gt);if(e===null)throw new Error(As);return N.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const vn={display:"none"},Gi={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Is="react-flow__node-desc",Ps="react-flow__edge-desc",Ui="react-flow__aria-live",Ki=e=>e.ariaLiveMessage,qi=e=>e.ariaLabelConfig;function Qi({rfId:e}){const t=J(Ki);return a.jsx("div",{id:`${Ui}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Gi,children:t})}function Ji({rfId:e,disableKeyboardA11y:t}){const n=J(qi);return a.jsxs(a.Fragment,{children:[a.jsx("div",{id:`${Is}-${e}`,style:vn,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),a.jsx("div",{id:`${Ps}-${e}`,style:vn,children:n["edge.a11yDescription.default"]}),!t&&a.jsx(Qi,{rfId:e})]})}const qe=N.forwardRef(({position:e="top-left",children:t,className:n,style:o,...s},r)=>{const i=`${e}`.split("-");return a.jsx("div",{className:ie(["react-flow__panel",n,...i]),style:o,ref:r,...s,children:t})});qe.displayName="Panel";function ea({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:a.jsx(qe,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:a.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const ta=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},nt=e=>e.id;function na(e,t){return oe(e.selectedNodes.map(nt),t.selectedNodes.map(nt))&&oe(e.selectedEdges.map(nt),t.selectedEdges.map(nt))}function sa({onSelectionChange:e}){const t=re(),{selectedNodes:n,selectedEdges:o}=J(ta,na);return N.useEffect(()=>{const s={nodes:n,edges:o};e==null||e(s),t.getState().onSelectionChangeHandlers.forEach(r=>r(s))},[n,o,e]),null}const oa=e=>!!e.onSelectionChangeHandlers;function ra({onSelectionChange:e}){const t=J(oa);return e||t?a.jsx(sa,{onSelectionChange:e}):null}const Ds=[0,0],ia={x:0,y:0,zoom:1},aa=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],Nn=[...aa,"rfId"],ca=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),Sn={translateExtent:Fe,nodeOrigin:Ds,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function la(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:s,setTranslateExtent:r,setNodeExtent:i,reset:c,setDefaultNodesAndEdges:u}=J(ca,oe),g=re();N.useEffect(()=>(u(e.defaultNodes,e.defaultEdges),()=>{h.current=Sn,c()}),[]);const h=N.useRef(Sn);return N.useEffect(()=>{for(const l of Nn){const d=e[l],m=h.current[l];d!==m&&(typeof e[l]>"u"||(l==="nodes"?t(d):l==="edges"?n(d):l==="minZoom"?o(d):l==="maxZoom"?s(d):l==="translateExtent"?r(d):l==="nodeExtent"?i(d):l==="ariaLabelConfig"?g.setState({ariaLabelConfig:ti(d)}):l==="fitView"?g.setState({fitViewQueued:d}):l==="fitViewOptions"?g.setState({fitViewOptions:d}):g.setState({[l]:d})))}h.current=e},Nn.map(l=>e[l])),null}function En(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function da(e){var o;const[t,n]=N.useState(e==="system"?null:e);return N.useEffect(()=>{if(e!=="system"){n(e);return}const s=En(),r=()=>n(s!=null&&s.matches?"dark":"light");return r(),s==null||s.addEventListener("change",r),()=>{s==null||s.removeEventListener("change",r)}},[e]),t!==null?t:(o=En())!=null&&o.matches?"dark":"light"}const jn=typeof document<"u"?document:null;function Ze(e=null,t={target:jn,actInsideInputWithModifier:!0}){const[n,o]=N.useState(!1),s=N.useRef(!1),r=N.useRef(new Set([])),[i,c]=N.useMemo(()=>{if(e!==null){const g=(Array.isArray(e)?e:[e]).filter(l=>typeof l=="string").map(l=>l.replace("+",`
`).replace(`

`,`
+`).split(`
`)),h=g.reduce((l,d)=>l.concat(...d),[]);return[g,h]}return[[],[]]},[e]);return N.useEffect(()=>{const u=(t==null?void 0:t.target)??jn,g=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const h=m=>{var y,x;if(s.current=m.ctrlKey||m.metaKey||m.shiftKey||m.altKey,(!s.current||s.current&&!g)&&ds(m))return!1;const w=kn(m.code,c);if(r.current.add(m[w]),Cn(i,r.current,!1)){const b=((x=(y=m.composedPath)==null?void 0:y.call(m))==null?void 0:x[0])||m.target,f=(b==null?void 0:b.nodeName)==="BUTTON"||(b==null?void 0:b.nodeName)==="A";t.preventDefault!==!1&&(s.current||!f)&&m.preventDefault(),o(!0)}},l=m=>{const p=kn(m.code,c);Cn(i,r.current,!0)?(o(!1),r.current.clear()):r.current.delete(m[p]),m.key==="Meta"&&r.current.clear(),s.current=!1},d=()=>{r.current.clear(),o(!1)};return u==null||u.addEventListener("keydown",h),u==null||u.addEventListener("keyup",l),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{u==null||u.removeEventListener("keydown",h),u==null||u.removeEventListener("keyup",l),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,o]),n}function Cn(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function kn(e,t){return t.includes(e)?"code":"key"}const ua=()=>{const e=re();return N.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,s,r],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??o,y:t.y??s,zoom:t.zoom??r},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{const{width:o,height:s,minZoom:r,maxZoom:i,panZoom:c}=e.getState(),u=zt(t,o,s,r,i,(n==null?void 0:n.padding)??.1);return c?(await c.setViewport(u,{duration:n==null?void 0:n.duration,ease:n==null?void 0:n.ease,interpolate:n==null?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:o,snapGrid:s,snapToGrid:r,domNode:i}=e.getState();if(!i)return t;const{x:c,y:u}=i.getBoundingClientRect(),g={x:t.x-c,y:t.y-u},h=n.snapGrid??s,l=n.snapToGrid??r;return Ke(g,o,l,h)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:s,y:r}=o.getBoundingClientRect(),i=at(t,n);return{x:i.x+s,y:i.y+r}}}),[])};function $s(e,t){const n=[],o=new Map,s=[];for(const r of e)if(r.type==="add"){s.push(r);continue}else if(r.type==="remove"||r.type==="replace")o.set(r.id,[r]);else{const i=o.get(r.id);i?i.push(r):o.set(r.id,[r])}for(const r of t){const i=o.get(r.id);if(!i){n.push(r);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const c={...r};for(const u of i)fa(u,c);n.push(c)}return s.length&&s.forEach(r=>{r.index!==void 0?n.splice(r.index,0,{...r.item}):n.push({...r.item})}),n}function fa(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Ts(e,t){return $s(e,t)}function Ls(e,t){return $s(e,t)}function Ne(e,t){return{id:e,type:"select",selected:t}}function Ae(e,t=new Set,n=!1){const o=[];for(const[s,r]of e){const i=t.has(s);!(r.selected===void 0&&!i)&&r.selected!==i&&(n&&(r.selected=i),o.push(Ne(r.id,i)))}return o}function Mn({items:e=[],lookup:t}){var s;const n=[],o=new Map(e.map(r=>[r.id,r]));for(const[r,i]of e.entries()){const c=t.get(i.id),u=((s=c==null?void 0:c.internals)==null?void 0:s.userNode)??c;u!==void 0&&u!==i&&n.push({id:i.id,item:i,type:"replace"}),u===void 0&&n.push({item:i,type:"add",index:r})}for(const[r]of t)o.get(r)===void 0&&n.push({id:r,type:"remove"});return n}function An(e){return{id:e.id,type:"remove"}}const In=e=>Yr(e),ga=e=>ns(e);function _s(e){return N.forwardRef(e)}const pa=typeof window<"u"?N.useLayoutEffect:N.useEffect;function Pn(e){const[t,n]=N.useState(BigInt(0)),[o]=N.useState(()=>ha(()=>n(s=>s+BigInt(1))));return pa(()=>{const s=o.get();s.length&&(e(s),o.reset())},[t]),o}function ha(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const zs=N.createContext(null);function ma({children:e}){const t=re(),n=N.useCallback(c=>{const{nodes:u=[],setNodes:g,hasDefaultNodes:h,onNodesChange:l,nodeLookup:d,fitViewQueued:m,onNodesChangeMiddlewareMap:p}=t.getState();let w=u;for(const x of c)w=typeof x=="function"?x(w):x;let y=Mn({items:w,lookup:d});for(const x of p.values())y=x(y);h&&g(w),y.length>0?l==null||l(y):m&&window.requestAnimationFrame(()=>{const{fitViewQueued:x,nodes:b,setNodes:f}=t.getState();x&&f(b)})},[]),o=Pn(n),s=N.useCallback(c=>{const{edges:u=[],setEdges:g,hasDefaultEdges:h,onEdgesChange:l,edgeLookup:d}=t.getState();let m=u;for(const p of c)m=typeof p=="function"?p(m):p;h?g(m):l&&l(Mn({items:m,lookup:d}))},[]),r=Pn(s),i=N.useMemo(()=>({nodeQueue:o,edgeQueue:r}),[]);return a.jsx(zs.Provider,{value:i,children:e})}function xa(){const e=N.useContext(zs);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const ya=e=>!!e.panZoom;function Wt(){const e=ua(),t=re(),n=xa(),o=J(ya),s=N.useMemo(()=>{const r=l=>t.getState().nodeLookup.get(l),i=l=>{n.nodeQueue.push(l)},c=l=>{n.edgeQueue.push(l)},u=l=>{var x,b;const{nodeLookup:d,nodeOrigin:m}=t.getState(),p=In(l)?l:d.get(l.id),w=p.parentId?cs(p.position,p.measured,p.parentId,d,m):p.position,y={...p,position:w,width:((x=p.measured)==null?void 0:x.width)??p.width,height:((b=p.measured)==null?void 0:b.height)??p.height};return De(y)},g=(l,d,m={replace:!1})=>{i(p=>p.map(w=>{if(w.id===l){const y=typeof d=="function"?d(w):d;return m.replace&&In(y)?y:{...w,...y}}return w}))},h=(l,d,m={replace:!1})=>{c(p=>p.map(w=>{if(w.id===l){const y=typeof d=="function"?d(w):d;return m.replace&&ga(y)?y:{...w,...y}}return w}))};return{getNodes:()=>t.getState().nodes.map(l=>({...l})),getNode:l=>{var d;return(d=r(l))==null?void 0:d.internals.userNode},getInternalNode:r,getEdges:()=>{const{edges:l=[]}=t.getState();return l.map(d=>({...d}))},getEdge:l=>t.getState().edgeLookup.get(l),setNodes:i,setEdges:c,addNodes:l=>{const d=Array.isArray(l)?l:[l];n.nodeQueue.push(m=>[...m,...d])},addEdges:l=>{const d=Array.isArray(l)?l:[l];n.edgeQueue.push(m=>[...m,...d])},toObject:()=>{const{nodes:l=[],edges:d=[],transform:m}=t.getState(),[p,w,y]=m;return{nodes:l.map(x=>({...x})),edges:d.map(x=>({...x})),viewport:{x:p,y:w,zoom:y}}},deleteElements:async({nodes:l=[],edges:d=[]})=>{const{nodes:m,edges:p,onNodesDelete:w,onEdgesDelete:y,triggerNodeChanges:x,triggerEdgeChanges:b,onDelete:f,onBeforeDelete:v}=t.getState(),{nodes:M,edges:E}=await Kr({nodesToRemove:l,edgesToRemove:d,nodes:m,edges:p,onBeforeDelete:v}),k=E.length>0,I=M.length>0;if(k){const S=E.map(An);y==null||y(E),b(S)}if(I){const S=M.map(An);w==null||w(M),x(S)}return(I||k)&&(f==null||f({nodes:M,edges:E})),{deletedNodes:M,deletedEdges:E}},getIntersectingNodes:(l,d=!0,m)=>{const p=an(l),w=p?l:u(l),y=m!==void 0;return w?(m||t.getState().nodes).filter(x=>{const b=t.getState().nodeLookup.get(x.id);if(b&&!p&&(x.id===l.id||!b.internals.positionAbsolute))return!1;const f=De(y?x:b),v=We(f,w);return d&&v>0||v>=f.width*f.height||v>=w.width*w.height}):[]},isNodeIntersecting:(l,d,m=!0)=>{const w=an(l)?l:u(l);if(!w)return!1;const y=We(w,d);return m&&y>0||y>=d.width*d.height||y>=w.width*w.height},updateNode:g,updateNodeData:(l,d,m={replace:!1})=>{g(l,p=>{const w=typeof d=="function"?d(p):d;return m.replace?{...p,data:w}:{...p,data:{...p.data,...w}}},m)},updateEdge:h,updateEdgeData:(l,d,m={replace:!1})=>{h(l,p=>{const w=typeof d=="function"?d(p):d;return m.replace?{...p,data:w}:{...p,data:{...p.data,...w}}},m)},getNodesBounds:l=>{const{nodeLookup:d,nodeOrigin:m}=t.getState();return Zr(l,{nodeLookup:d,nodeOrigin:m})},getHandleConnections:({type:l,id:d,nodeId:m})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${m}-${l}${d?`-${d}`:""}`))==null?void 0:p.values())??[])},getNodeConnections:({type:l,handleId:d,nodeId:m})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${m}${l?d?`-${l}-${d}`:`-${l}`:""}`))==null?void 0:p.values())??[])},fitView:async l=>{const d=t.getState().fitViewResolver??ei();return t.setState({fitViewQueued:!0,fitViewOptions:l,fitViewResolver:d}),n.nodeQueue.push(m=>[...m]),d.promise}}},[]);return N.useMemo(()=>({...s,...e,viewportInitialized:o}),[o])}const Dn=e=>e.selected,wa=typeof window<"u"?window:void 0;function ba({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=re(),{deleteElements:o}=Wt(),s=Ze(e,{actInsideInputWithModifier:!1}),r=Ze(t,{target:wa});N.useEffect(()=>{if(s){const{edges:i,nodes:c}=n.getState();o({nodes:c.filter(Dn),edges:i.filter(Dn)}),n.setState({nodesSelectionActive:!1})}},[s]),N.useEffect(()=>{n.setState({multiSelectionActive:r})},[r])}function va(e){const t=re();N.useEffect(()=>{const n=()=>{var s,r,i,c;if(!e.current||!(((r=(s=e.current).checkVisibility)==null?void 0:r.call(s))??!0))return!1;const o=Ht(e.current);(o.height===0||o.width===0)&&((c=(i=t.getState()).onError)==null||c.call(i,"004",fe.error004())),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}const pt={position:"absolute",width:"100%",height:"100%",top:0,left:0},Na=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function Sa({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:s=.5,panOnScrollMode:r=Se.Free,zoomOnDoubleClick:i=!0,panOnDrag:c=!0,defaultViewport:u,translateExtent:g,minZoom:h,maxZoom:l,zoomActivationKeyCode:d,preventScrolling:m=!0,children:p,noWheelClassName:w,noPanClassName:y,onViewportChange:x,isControlledViewport:b,paneClickDistance:f,selectionOnDrag:v}){const M=re(),E=N.useRef(null),{userSelectionActive:k,lib:I,connectionInProgress:S}=J(Na,oe),T=Ze(d),C=N.useRef();va(E);const j=N.useCallback(D=>{x==null||x({x:D[0],y:D[1],zoom:D[2]}),b||M.setState({transform:D})},[x,b]);return N.useEffect(()=>{if(E.current){C.current=_i({domNode:E.current,minZoom:h,maxZoom:l,translateExtent:g,viewport:u,onDraggingChange:V=>M.setState({paneDragging:V}),onPanZoomStart:(V,R)=>{const{onViewportChangeStart:P,onMoveStart:A}=M.getState();A==null||A(V,R),P==null||P(R)},onPanZoom:(V,R)=>{const{onViewportChange:P,onMove:A}=M.getState();A==null||A(V,R),P==null||P(R)},onPanZoomEnd:(V,R)=>{const{onViewportChangeEnd:P,onMoveEnd:A}=M.getState();A==null||A(V,R),P==null||P(R)}});const{x:D,y:H,zoom:L}=C.current.getViewport();return M.setState({panZoom:C.current,transform:[D,H,L],domNode:E.current.closest(".react-flow")}),()=>{var V;(V=C.current)==null||V.destroy()}}},[]),N.useEffect(()=>{var D;(D=C.current)==null||D.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:s,panOnScrollMode:r,zoomOnDoubleClick:i,panOnDrag:c,zoomActivationKeyPressed:T,preventScrolling:m,noPanClassName:y,userSelectionActive:k,noWheelClassName:w,lib:I,onTransformChange:j,connectionInProgress:S,selectionOnDrag:v,paneClickDistance:f})},[e,t,n,o,s,r,i,c,T,m,y,k,w,I,j,S,v,f]),a.jsx("div",{className:"react-flow__renderer",ref:E,style:pt,children:p})}const Ea=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function ja(){const{userSelectionActive:e,userSelectionRect:t}=J(Ea,oe);return e&&t?a.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const jt=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Ca=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function ka({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Oe.Full,panOnDrag:o,paneClickDistance:s,selectionOnDrag:r,onSelectionStart:i,onSelectionEnd:c,onPaneClick:u,onPaneContextMenu:g,onPaneScroll:h,onPaneMouseEnter:l,onPaneMouseMove:d,onPaneMouseLeave:m,children:p}){const w=re(),{userSelectionActive:y,elementsSelectable:x,dragging:b,connectionInProgress:f}=J(Ca,oe),v=x&&(e||y),M=N.useRef(null),E=N.useRef(),k=N.useRef(new Set),I=N.useRef(new Set),S=N.useRef(!1),T=P=>{if(S.current||f){S.current=!1;return}u==null||u(P),w.getState().resetSelectedElements(),w.setState({nodesSelectionActive:!1})},C=P=>{if(Array.isArray(o)&&(o!=null&&o.includes(2))){P.preventDefault();return}g==null||g(P)},j=h?P=>h(P):void 0,D=P=>{S.current&&(P.stopPropagation(),S.current=!1)},H=P=>{var W,X;const{domNode:A}=w.getState();if(E.current=A==null?void 0:A.getBoundingClientRect(),!E.current)return;const F=P.target===M.current;if(!F&&!!P.target.closest(".nokey")||!e||!(r&&F||t)||P.button!==0||!P.isPrimary)return;(X=(W=P.target)==null?void 0:W.setPointerCapture)==null||X.call(W,P.pointerId),S.current=!1;const{x:$,y:_}=de(P.nativeEvent,E.current);w.setState({userSelectionRect:{width:0,height:0,startX:$,startY:_,x:$,y:_}}),F||(P.stopPropagation(),P.preventDefault())},L=P=>{const{userSelectionRect:A,transform:F,nodeLookup:O,edgeLookup:B,connectionLookup:$,triggerNodeChanges:_,triggerEdgeChanges:W,defaultEdgeOptions:X,resetSelectedElements:Q}=w.getState();if(!E.current||!A)return;const{x:z,y:U}=de(P.nativeEvent,E.current),{startX:G,startY:Y}=A;if(!S.current){const ee=t?0:s;if(Math.hypot(z-G,U-Y)<=ee)return;Q(),i==null||i(P)}S.current=!0;const K={startX:G,startY:Y,x:z<G?z:G,y:U<Y?U:Y,width:Math.abs(z-G),height:Math.abs(U-Y)},q=k.current,te=I.current;k.current=new Set(_t(O,K,F,n===Oe.Partial,!0).map(ee=>ee.id)),I.current=new Set;const se=(X==null?void 0:X.selectable)??!0;for(const ee of k.current){const ae=$.get(ee);if(ae)for(const{edgeId:me}of ae.values()){const ge=B.get(me);ge&&(ge.selectable??se)&&I.current.add(me)}}if(!cn(q,k.current)){const ee=Ae(O,k.current,!0);_(ee)}if(!cn(te,I.current)){const ee=Ae(B,I.current);W(ee)}w.setState({userSelectionRect:K,userSelectionActive:!0,nodesSelectionActive:!1})},V=P=>{var A,F;P.button===0&&((F=(A=P.target)==null?void 0:A.releasePointerCapture)==null||F.call(A,P.pointerId),!y&&P.target===M.current&&w.getState().userSelectionRect&&(T==null||T(P)),w.setState({userSelectionActive:!1,userSelectionRect:null}),S.current&&(c==null||c(P),w.setState({nodesSelectionActive:k.current.size>0})))},R=o===!0||Array.isArray(o)&&o.includes(0);return a.jsxs("div",{className:ie(["react-flow__pane",{draggable:R,dragging:b,selection:e}]),onClick:v?void 0:jt(T,M),onContextMenu:jt(C,M),onWheel:jt(j,M),onPointerEnter:v?void 0:l,onPointerMove:v?L:d,onPointerUp:v?V:void 0,onPointerDownCapture:v?H:void 0,onClickCapture:v?D:void 0,onPointerLeave:m,ref:M,style:pt,children:[p,a.jsx(ja,{})]})}function Dt({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:r,multiSelectionActive:i,nodeLookup:c,onError:u}=t.getState(),g=c.get(e);if(!g){u==null||u("012",fe.error012(e));return}t.setState({nodesSelectionActive:!1}),g.selected?(n||g.selected&&i)&&(r({nodes:[g],edges:[]}),requestAnimationFrame(()=>{var h;return(h=o==null?void 0:o.current)==null?void 0:h.blur()})):s([e])}function Hs({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:r,nodeClickDistance:i}){const c=re(),[u,g]=N.useState(!1),h=N.useRef();return N.useEffect(()=>{h.current=Ni({getStoreItems:()=>c.getState(),onNodeMouseDown:l=>{Dt({id:l,store:c,nodeRef:e})},onDragStart:()=>{g(!0)},onDragStop:()=>{g(!1)}})},[]),N.useEffect(()=>{var l,d;if(t)(l=h.current)==null||l.destroy();else if(e.current)return(d=h.current)==null||d.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:r,nodeId:s,nodeClickDistance:i}),()=>{var m;(m=h.current)==null||m.destroy()}},[n,o,t,r,e,s]),u}const Ma=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Rs(){const e=re();return N.useCallback(n=>{const{nodeExtent:o,snapToGrid:s,snapGrid:r,nodesDraggable:i,onError:c,updateNodePositions:u,nodeLookup:g,nodeOrigin:h}=e.getState(),l=new Map,d=Ma(i),m=s?r[0]:5,p=s?r[1]:5,w=n.direction.x*m*n.factor,y=n.direction.y*p*n.factor;for(const[,x]of g){if(!d(x))continue;let b={x:x.internals.positionAbsolute.x+w,y:x.internals.positionAbsolute.y+y};s&&(b=Ue(b,r));const{position:f,positionAbsolute:v}=ss({nodeId:x.id,nextPosition:b,nodeLookup:g,nodeExtent:o,nodeOrigin:h,onError:c});x.position=f,x.internals.positionAbsolute=v,l.set(x.id,x)}u(l)},[])}const Yt=N.createContext(null),Aa=Yt.Provider;Yt.Consumer;const Bs=()=>N.useContext(Yt),Ia=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Pa=(e,t,n)=>o=>{const{connectionClickStartHandle:s,connectionMode:r,connection:i}=o,{fromHandle:c,toHandle:u,isValid:g}=i,h=(u==null?void 0:u.nodeId)===e&&(u==null?void 0:u.id)===t&&(u==null?void 0:u.type)===n;return{connectingFrom:(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n,connectingTo:h,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===n,isPossibleEndHandle:r===Ie.Strict?(c==null?void 0:c.type)!==n:e!==(c==null?void 0:c.nodeId)||t!==(c==null?void 0:c.id),connectionInProcess:!!c,clickConnectionInProcess:!!s,valid:h&&g}};function Da({type:e="source",position:t=Z.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:r=!0,id:i,onConnect:c,children:u,className:g,onMouseDown:h,onTouchStart:l,...d},m){var L,V;const p=i||null,w=e==="target",y=re(),x=Bs(),{connectOnClick:b,noPanClassName:f,rfId:v}=J(Ia,oe),{connectingFrom:M,connectingTo:E,clickConnecting:k,isPossibleEndHandle:I,connectionInProcess:S,clickConnectionInProcess:T,valid:C}=J(Pa(x,p,e),oe);x||(V=(L=y.getState()).onError)==null||V.call(L,"010",fe.error010());const j=R=>{const{defaultEdgeOptions:P,onConnect:A,hasDefaultEdges:F}=y.getState(),O={...P,...R};if(F){const{edges:B,setEdges:$}=y.getState();$(hs(O,B))}A==null||A(O),c==null||c(O)},D=R=>{if(!x)return;const P=us(R.nativeEvent);if(s&&(P&&R.button===0||!P)){const A=y.getState();Pt.onPointerDown(R.nativeEvent,{handleDomNode:R.currentTarget,autoPanOnConnect:A.autoPanOnConnect,connectionMode:A.connectionMode,connectionRadius:A.connectionRadius,domNode:A.domNode,nodeLookup:A.nodeLookup,lib:A.lib,isTarget:w,handleId:p,nodeId:x,flowId:A.rfId,panBy:A.panBy,cancelConnection:A.cancelConnection,onConnectStart:A.onConnectStart,onConnectEnd:A.onConnectEnd,updateConnection:A.updateConnection,onConnect:j,isValidConnection:n||A.isValidConnection,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle,autoPanSpeed:A.autoPanSpeed,dragThreshold:A.connectionDragThreshold})}P?h==null||h(R):l==null||l(R)},H=R=>{const{onClickConnectStart:P,onClickConnectEnd:A,connectionClickStartHandle:F,connectionMode:O,isValidConnection:B,lib:$,rfId:_,nodeLookup:W,connection:X}=y.getState();if(!x||!F&&!s)return;if(!F){P==null||P(R.nativeEvent,{nodeId:x,handleId:p,handleType:e}),y.setState({connectionClickStartHandle:{nodeId:x,type:e,id:p}});return}const Q=ls(R.target),z=n||B,{connection:U,isValid:G}=Pt.isValid(R.nativeEvent,{handle:{nodeId:x,id:p,type:e},connectionMode:O,fromNodeId:F.nodeId,fromHandleId:F.id||null,fromType:F.type,isValidConnection:z,flowId:_,doc:Q,lib:$,nodeLookup:W});G&&U&&j(U);const Y=structuredClone(X);delete Y.inProgress,Y.toPosition=Y.toHandle?Y.toHandle.position:null,A==null||A(R,Y),y.setState({connectionClickStartHandle:null})};return a.jsx("div",{"data-handleid":p,"data-nodeid":x,"data-handlepos":t,"data-id":`${v}-${x}-${p}-${e}`,className:ie(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",f,g,{source:!w,target:w,connectable:o,connectablestart:s,connectableend:r,clickconnecting:k,connectingfrom:M,connectingto:E,valid:C,connectionindicator:o&&(!S||I)&&(S||T?r:s)}]),onMouseDown:D,onTouchStart:D,onClick:b?H:void 0,ref:m,...d,children:u})}const be=N.memo(_s(Da));function $a({data:e,isConnectable:t,sourcePosition:n=Z.Bottom}){return a.jsxs(a.Fragment,{children:[e==null?void 0:e.label,a.jsx(be,{type:"source",position:n,isConnectable:t})]})}function Ta({data:e,isConnectable:t,targetPosition:n=Z.Top,sourcePosition:o=Z.Bottom}){return a.jsxs(a.Fragment,{children:[a.jsx(be,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,a.jsx(be,{type:"source",position:o,isConnectable:t})]})}function La(){return null}function _a({data:e,isConnectable:t,targetPosition:n=Z.Top}){return a.jsxs(a.Fragment,{children:[a.jsx(be,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const ct={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},$n={input:$a,default:Ta,output:_a,group:La};function za(e){var t,n,o,s;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((o=e.style)==null?void 0:o.width),height:e.height??((s=e.style)==null?void 0:s.height)}}const Ha=e=>{const{width:t,height:n,x:o,y:s}=Ge(e.nodeLookup,{filter:r=>!!r.selected});return{width:le(t)?t:null,height:le(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${s}px)`}};function Ra({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=re(),{width:s,height:r,transformString:i,userSelectionActive:c}=J(Ha,oe),u=Rs(),g=N.useRef(null);if(N.useEffect(()=>{var d;n||(d=g.current)==null||d.focus({preventScroll:!0})},[n]),Hs({nodeRef:g}),c||!s||!r)return null;const h=e?d=>{const m=o.getState().nodes.filter(p=>p.selected);e(d,m)}:void 0,l=d=>{Object.prototype.hasOwnProperty.call(ct,d.key)&&(d.preventDefault(),u({direction:ct[d.key],factor:d.shiftKey?4:1}))};return a.jsx("div",{className:ie(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:a.jsx("div",{ref:g,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:l,style:{width:s,height:r}})})}const Tn=typeof window<"u"?window:void 0,Ba=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Vs({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,paneClickDistance:c,deleteKeyCode:u,selectionKeyCode:g,selectionOnDrag:h,selectionMode:l,onSelectionStart:d,onSelectionEnd:m,multiSelectionKeyCode:p,panActivationKeyCode:w,zoomActivationKeyCode:y,elementsSelectable:x,zoomOnScroll:b,zoomOnPinch:f,panOnScroll:v,panOnScrollSpeed:M,panOnScrollMode:E,zoomOnDoubleClick:k,panOnDrag:I,defaultViewport:S,translateExtent:T,minZoom:C,maxZoom:j,preventScrolling:D,onSelectionContextMenu:H,noWheelClassName:L,noPanClassName:V,disableKeyboardA11y:R,onViewportChange:P,isControlledViewport:A}){const{nodesSelectionActive:F,userSelectionActive:O}=J(Ba,oe),B=Ze(g,{target:Tn}),$=Ze(w,{target:Tn}),_=$||I,W=$||v,X=h&&_!==!0,Q=B||O||X;return ba({deleteKeyCode:u,multiSelectionKeyCode:p}),a.jsx(Sa,{onPaneContextMenu:r,elementsSelectable:x,zoomOnScroll:b,zoomOnPinch:f,panOnScroll:W,panOnScrollSpeed:M,panOnScrollMode:E,zoomOnDoubleClick:k,panOnDrag:!B&&_,defaultViewport:S,translateExtent:T,minZoom:C,maxZoom:j,zoomActivationKeyCode:y,preventScrolling:D,noWheelClassName:L,noPanClassName:V,onViewportChange:P,isControlledViewport:A,paneClickDistance:c,selectionOnDrag:X,children:a.jsxs(ka,{onSelectionStart:d,onSelectionEnd:m,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,panOnDrag:_,isSelecting:!!Q,selectionMode:l,selectionKeyPressed:B,paneClickDistance:c,selectionOnDrag:X,children:[e,F&&a.jsx(Ra,{onSelectionContextMenu:H,noPanClassName:V,disableKeyboardA11y:R})]})})}Vs.displayName="FlowRenderer";const Va=N.memo(Vs),Fa=e=>t=>e?_t(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Oa(e){return J(N.useCallback(Fa(e),[e]),oe)}const Wa=e=>e.updateNodeInternals;function Ya(){const e=J(Wa),[t]=N.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(s=>{const r=s.target.getAttribute("data-id");o.set(r,{id:r,nodeElement:s.target,force:!0})}),e(o)}));return N.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Za({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const s=re(),r=N.useRef(null),i=N.useRef(null),c=N.useRef(e.sourcePosition),u=N.useRef(e.targetPosition),g=N.useRef(t),h=n&&!!e.internals.handleBounds;return N.useEffect(()=>{r.current&&!e.hidden&&(!h||i.current!==r.current)&&(i.current&&(o==null||o.unobserve(i.current)),o==null||o.observe(r.current),i.current=r.current)},[h,e.hidden]),N.useEffect(()=>()=>{i.current&&(o==null||o.unobserve(i.current),i.current=null)},[]),N.useEffect(()=>{if(r.current){const l=g.current!==t,d=c.current!==e.sourcePosition,m=u.current!==e.targetPosition;(l||d||m)&&(g.current=t,c.current=e.sourcePosition,u.current=e.targetPosition,s.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:r.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),r}function Xa({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:s,onContextMenu:r,onDoubleClick:i,nodesDraggable:c,elementsSelectable:u,nodesConnectable:g,nodesFocusable:h,resizeObserver:l,noDragClassName:d,noPanClassName:m,disableKeyboardA11y:p,rfId:w,nodeTypes:y,nodeClickDistance:x,onError:b}){const{node:f,internals:v,isParent:M}=J(z=>{const U=z.nodeLookup.get(e),G=z.parentLookup.has(e);return{node:U,internals:U.internals,isParent:G}},oe);let E=f.type||"default",k=(y==null?void 0:y[E])||$n[E];k===void 0&&(b==null||b("003",fe.error003(E)),E="default",k=(y==null?void 0:y.default)||$n.default);const I=!!(f.draggable||c&&typeof f.draggable>"u"),S=!!(f.selectable||u&&typeof f.selectable>"u"),T=!!(f.connectable||g&&typeof f.connectable>"u"),C=!!(f.focusable||h&&typeof f.focusable>"u"),j=re(),D=as(f),H=Za({node:f,nodeType:E,hasDimensions:D,resizeObserver:l}),L=Hs({nodeRef:H,disabled:f.hidden||!I,noDragClassName:d,handleSelector:f.dragHandle,nodeId:e,isSelectable:S,nodeClickDistance:x}),V=Rs();if(f.hidden)return null;const R=he(f),P=za(f),A=S||I||t||n||o||s,F=n?z=>n(z,{...v.userNode}):void 0,O=o?z=>o(z,{...v.userNode}):void 0,B=s?z=>s(z,{...v.userNode}):void 0,$=r?z=>r(z,{...v.userNode}):void 0,_=i?z=>i(z,{...v.userNode}):void 0,W=z=>{const{selectNodesOnDrag:U,nodeDragThreshold:G}=j.getState();S&&(!U||!I||G>0)&&Dt({id:e,store:j,nodeRef:H}),t&&t(z,{...v.userNode})},X=z=>{if(!(ds(z.nativeEvent)||p)){if(Qn.includes(z.key)&&S){const U=z.key==="Escape";Dt({id:e,store:j,unselect:U,nodeRef:H})}else if(I&&f.selected&&Object.prototype.hasOwnProperty.call(ct,z.key)){z.preventDefault();const{ariaLabelConfig:U}=j.getState();j.setState({ariaLiveMessage:U["node.a11yDescription.ariaLiveMessage"]({direction:z.key.replace("Arrow","").toLowerCase(),x:~~v.positionAbsolute.x,y:~~v.positionAbsolute.y})}),V({direction:ct[z.key],factor:z.shiftKey?4:1})}}},Q=()=>{var te;if(p||!((te=H.current)!=null&&te.matches(":focus-visible")))return;const{transform:z,width:U,height:G,autoPanOnNodeFocus:Y,setCenter:K}=j.getState();if(!Y)return;_t(new Map([[e,f]]),{x:0,y:0,width:U,height:G},z,!0).length>0||K(f.position.x+R.width/2,f.position.y+R.height/2,{zoom:z[2]})};return a.jsx("div",{className:ie(["react-flow__node",`react-flow__node-${E}`,{[m]:I},f.className,{selected:f.selected,selectable:S,parent:M,draggable:I,dragging:L}]),ref:H,style:{zIndex:v.z,transform:`translate(${v.positionAbsolute.x}px,${v.positionAbsolute.y}px)`,pointerEvents:A?"all":"none",visibility:D?"visible":"hidden",...f.style,...P},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:F,onMouseMove:O,onMouseLeave:B,onContextMenu:$,onClick:W,onDoubleClick:_,onKeyDown:C?X:void 0,tabIndex:C?0:void 0,onFocus:C?Q:void 0,role:f.ariaRole??(C?"group":void 0),"aria-roledescription":"node","aria-describedby":p?void 0:`${Is}-${w}`,"aria-label":f.ariaLabel,...f.domAttributes,children:a.jsx(Aa,{value:e,children:a.jsx(k,{id:e,data:f.data,type:E,positionAbsoluteX:v.positionAbsolute.x,positionAbsoluteY:v.positionAbsolute.y,selected:f.selected??!1,selectable:S,draggable:I,deletable:f.deletable??!0,isConnectable:T,sourcePosition:f.sourcePosition,targetPosition:f.targetPosition,dragging:L,dragHandle:f.dragHandle,zIndex:v.z,parentId:f.parentId,...R})})})}var Ga=N.memo(Xa);const Ua=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Fs(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,onError:r}=J(Ua,oe),i=Oa(e.onlyRenderVisibleElements),c=Ya();return a.jsx("div",{className:"react-flow__nodes",style:pt,children:i.map(u=>a.jsx(Ga,{id:u,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:c,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,nodeClickDistance:e.nodeClickDistance,onError:r},u))})}Fs.displayName="NodeRenderer";const Ka=N.memo(Fs);function qa(e){return J(N.useCallback(n=>{if(!e)return n.edges.map(s=>s.id);const o=[];if(n.width&&n.height)for(const s of n.edges){const r=n.nodeLookup.get(s.source),i=n.nodeLookup.get(s.target);r&&i&&oi({sourceNode:r,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&o.push(s.id)}return o},[e]),oe)}const Qa=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return a.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},Ja=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return a.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},Ln={[ne.Arrow]:Qa,[ne.ArrowClosed]:Ja};function ec(e){const t=re();return N.useMemo(()=>{var s,r;return Object.prototype.hasOwnProperty.call(Ln,e)?Ln[e]:((r=(s=t.getState()).onError)==null||r.call(s,"009",fe.error009(e)),null)},[e])}const tc=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:r="strokeWidth",strokeWidth:i,orient:c="auto-start-reverse"})=>{const u=ec(t);return u?a.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:r,orient:c,refX:"0",refY:"0",children:a.jsx(u,{color:n,strokeWidth:i})}):null},Os=({defaultColor:e,rfId:t})=>{const n=J(r=>r.edges),o=J(r=>r.defaultEdgeOptions),s=N.useMemo(()=>ui(n,{id:t,defaultColor:e,defaultMarkerStart:o==null?void 0:o.markerStart,defaultMarkerEnd:o==null?void 0:o.markerEnd}),[n,o,t,e]);return s.length?a.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:a.jsx("defs",{children:s.map(r=>a.jsx(tc,{id:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient},r.id))})}):null};Os.displayName="MarkerDefinitions";var nc=N.memo(Os);function Ws({x:e,y:t,label:n,labelStyle:o,labelShowBg:s=!0,labelBgStyle:r,labelBgPadding:i=[2,4],labelBgBorderRadius:c=2,children:u,className:g,...h}){const[l,d]=N.useState({x:1,y:0,width:0,height:0}),m=ie(["react-flow__edge-textwrapper",g]),p=N.useRef(null);return N.useEffect(()=>{if(p.current){const w=p.current.getBBox();d({x:w.x,y:w.y,width:w.width,height:w.height})}},[n]),n?a.jsxs("g",{transform:`translate(${e-l.width/2} ${t-l.height/2})`,className:m,visibility:l.width?"visible":"hidden",...h,children:[s&&a.jsx("rect",{width:l.width+2*i[0],x:-i[0],y:-i[1],height:l.height+2*i[1],className:"react-flow__edge-textbg",style:r,rx:c,ry:c}),a.jsx("text",{className:"react-flow__edge-text",y:l.height/2,dy:"0.3em",ref:p,style:o,children:n}),u]}):null}Ws.displayName="EdgeText";const sc=N.memo(Ws);function ht({path:e,labelX:t,labelY:n,label:o,labelStyle:s,labelShowBg:r,labelBgStyle:i,labelBgPadding:c,labelBgBorderRadius:u,interactionWidth:g=20,...h}){return a.jsxs(a.Fragment,{children:[a.jsx("path",{...h,d:e,fill:"none",className:ie(["react-flow__edge-path",h.className])}),g?a.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}):null,o&&le(t)&&le(n)?a.jsx(sc,{x:t,y:n,label:o,labelStyle:s,labelShowBg:r,labelBgStyle:i,labelBgPadding:c,labelBgBorderRadius:u}):null]})}function _n({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===Z.Left||e===Z.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function Ys({sourceX:e,sourceY:t,sourcePosition:n=Z.Bottom,targetX:o,targetY:s,targetPosition:r=Z.Top}){const[i,c]=_n({pos:n,x1:e,y1:t,x2:o,y2:s}),[u,g]=_n({pos:r,x1:o,y1:s,x2:e,y2:t}),[h,l,d,m]=fs({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:i,sourceControlY:c,targetControlX:u,targetControlY:g});return[`M${e},${t} C${i},${c} ${u},${g} ${o},${s}`,h,l,d,m]}function Zs(e){return N.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,sourcePosition:i,targetPosition:c,label:u,labelStyle:g,labelShowBg:h,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:m,style:p,markerEnd:w,markerStart:y,interactionWidth:x})=>{const[b,f,v]=Ys({sourceX:n,sourceY:o,sourcePosition:i,targetX:s,targetY:r,targetPosition:c}),M=e.isInternal?void 0:t;return a.jsx(ht,{id:M,path:b,labelX:f,labelY:v,label:u,labelStyle:g,labelShowBg:h,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:m,style:p,markerEnd:w,markerStart:y,interactionWidth:x})})}const oc=Zs({isInternal:!1}),Xs=Zs({isInternal:!0});oc.displayName="SimpleBezierEdge";Xs.displayName="SimpleBezierEdgeInternal";function Gs(e){return N.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,label:i,labelStyle:c,labelShowBg:u,labelBgStyle:g,labelBgPadding:h,labelBgBorderRadius:l,style:d,sourcePosition:m=Z.Bottom,targetPosition:p=Z.Top,markerEnd:w,markerStart:y,pathOptions:x,interactionWidth:b})=>{const[f,v,M]=Mt({sourceX:n,sourceY:o,sourcePosition:m,targetX:s,targetY:r,targetPosition:p,borderRadius:x==null?void 0:x.borderRadius,offset:x==null?void 0:x.offset,stepPosition:x==null?void 0:x.stepPosition}),E=e.isInternal?void 0:t;return a.jsx(ht,{id:E,path:f,labelX:v,labelY:M,label:i,labelStyle:c,labelShowBg:u,labelBgStyle:g,labelBgPadding:h,labelBgBorderRadius:l,style:d,markerEnd:w,markerStart:y,interactionWidth:b})})}const Us=Gs({isInternal:!1}),Ks=Gs({isInternal:!0});Us.displayName="SmoothStepEdge";Ks.displayName="SmoothStepEdgeInternal";function qs(e){return N.memo(({id:t,...n})=>{var s;const o=e.isInternal?void 0:t;return a.jsx(Us,{...n,id:o,pathOptions:N.useMemo(()=>{var r;return{borderRadius:0,offset:(r=n.pathOptions)==null?void 0:r.offset}},[(s=n.pathOptions)==null?void 0:s.offset])})})}const rc=qs({isInternal:!1}),Qs=qs({isInternal:!0});rc.displayName="StepEdge";Qs.displayName="StepEdgeInternal";function Js(e){return N.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,label:i,labelStyle:c,labelShowBg:u,labelBgStyle:g,labelBgPadding:h,labelBgBorderRadius:l,style:d,markerEnd:m,markerStart:p,interactionWidth:w})=>{const[y,x,b]=ms({sourceX:n,sourceY:o,targetX:s,targetY:r}),f=e.isInternal?void 0:t;return a.jsx(ht,{id:f,path:y,labelX:x,labelY:b,label:i,labelStyle:c,labelShowBg:u,labelBgStyle:g,labelBgPadding:h,labelBgBorderRadius:l,style:d,markerEnd:m,markerStart:p,interactionWidth:w})})}const ic=Js({isInternal:!1}),eo=Js({isInternal:!0});ic.displayName="StraightEdge";eo.displayName="StraightEdgeInternal";function to(e){return N.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,sourcePosition:i=Z.Bottom,targetPosition:c=Z.Top,label:u,labelStyle:g,labelShowBg:h,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:m,style:p,markerEnd:w,markerStart:y,pathOptions:x,interactionWidth:b})=>{const[f,v,M]=gs({sourceX:n,sourceY:o,sourcePosition:i,targetX:s,targetY:r,targetPosition:c,curvature:x==null?void 0:x.curvature}),E=e.isInternal?void 0:t;return a.jsx(ht,{id:E,path:f,labelX:v,labelY:M,label:u,labelStyle:g,labelShowBg:h,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:m,style:p,markerEnd:w,markerStart:y,interactionWidth:b})})}const ac=to({isInternal:!1}),no=to({isInternal:!0});ac.displayName="BezierEdge";no.displayName="BezierEdgeInternal";const zn={default:no,straight:eo,step:Qs,smoothstep:Ks,simplebezier:Xs},Hn={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},cc=(e,t,n)=>n===Z.Left?e-t:n===Z.Right?e+t:e,lc=(e,t,n)=>n===Z.Top?e-t:n===Z.Bottom?e+t:e,Rn="react-flow__edgeupdater";function Bn({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:r,onMouseOut:i,type:c}){return a.jsx("circle",{onMouseDown:s,onMouseEnter:r,onMouseOut:i,className:ie([Rn,`${Rn}-${c}`]),cx:cc(t,o,e),cy:lc(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function dc({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:s,targetX:r,targetY:i,sourcePosition:c,targetPosition:u,onReconnect:g,onReconnectStart:h,onReconnectEnd:l,setReconnecting:d,setUpdateHover:m}){const p=re(),w=(v,M)=>{if(v.button!==0)return;const{autoPanOnConnect:E,domNode:k,isValidConnection:I,connectionMode:S,connectionRadius:T,lib:C,onConnectStart:j,onConnectEnd:D,cancelConnection:H,nodeLookup:L,rfId:V,panBy:R,updateConnection:P}=p.getState(),A=M.type==="target",F=($,_)=>{d(!1),l==null||l($,n,M.type,_)},O=$=>g==null?void 0:g(n,$),B=($,_)=>{d(!0),h==null||h(v,n,M.type),j==null||j($,_)};Pt.onPointerDown(v.nativeEvent,{autoPanOnConnect:E,connectionMode:S,connectionRadius:T,domNode:k,handleId:M.id,nodeId:M.nodeId,nodeLookup:L,isTarget:A,edgeUpdaterType:M.type,lib:C,flowId:V,cancelConnection:H,panBy:R,isValidConnection:I,onConnect:O,onConnectStart:B,onConnectEnd:D,onReconnectEnd:F,updateConnection:P,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle,dragThreshold:p.getState().connectionDragThreshold,handleDomNode:v.currentTarget})},y=v=>w(v,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),x=v=>w(v,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),b=()=>m(!0),f=()=>m(!1);return a.jsxs(a.Fragment,{children:[(e===!0||e==="source")&&a.jsx(Bn,{position:c,centerX:o,centerY:s,radius:t,onMouseDown:y,onMouseEnter:b,onMouseOut:f,type:"source"}),(e===!0||e==="target")&&a.jsx(Bn,{position:u,centerX:r,centerY:i,radius:t,onMouseDown:x,onMouseEnter:b,onMouseOut:f,type:"target"})]})}function uc({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:s,onDoubleClick:r,onContextMenu:i,onMouseEnter:c,onMouseMove:u,onMouseLeave:g,reconnectRadius:h,onReconnect:l,onReconnectStart:d,onReconnectEnd:m,rfId:p,edgeTypes:w,noPanClassName:y,onError:x,disableKeyboardA11y:b}){let f=J(K=>K.edgeLookup.get(e));const v=J(K=>K.defaultEdgeOptions);f=v?{...v,...f}:f;let M=f.type||"default",E=(w==null?void 0:w[M])||zn[M];E===void 0&&(x==null||x("011",fe.error011(M)),M="default",E=(w==null?void 0:w.default)||zn.default);const k=!!(f.focusable||t&&typeof f.focusable>"u"),I=typeof l<"u"&&(f.reconnectable||n&&typeof f.reconnectable>"u"),S=!!(f.selectable||o&&typeof f.selectable>"u"),T=N.useRef(null),[C,j]=N.useState(!1),[D,H]=N.useState(!1),L=re(),{zIndex:V,sourceX:R,sourceY:P,targetX:A,targetY:F,sourcePosition:O,targetPosition:B}=J(N.useCallback(K=>{const q=K.nodeLookup.get(f.source),te=K.nodeLookup.get(f.target);if(!q||!te)return{zIndex:f.zIndex,...Hn};const se=di({id:e,sourceNode:q,targetNode:te,sourceHandle:f.sourceHandle||null,targetHandle:f.targetHandle||null,connectionMode:K.connectionMode,onError:x});return{zIndex:si({selected:f.selected,zIndex:f.zIndex,sourceNode:q,targetNode:te,elevateOnSelect:K.elevateEdgesOnSelect,zIndexMode:K.zIndexMode}),...se||Hn}},[f.source,f.target,f.sourceHandle,f.targetHandle,f.selected,f.zIndex]),oe),$=N.useMemo(()=>f.markerStart?`url('#${At(f.markerStart,p)}')`:void 0,[f.markerStart,p]),_=N.useMemo(()=>f.markerEnd?`url('#${At(f.markerEnd,p)}')`:void 0,[f.markerEnd,p]);if(f.hidden||R===null||P===null||A===null||F===null)return null;const W=K=>{var ee;const{addSelectedEdges:q,unselectNodesAndEdges:te,multiSelectionActive:se}=L.getState();S&&(L.setState({nodesSelectionActive:!1}),f.selected&&se?(te({nodes:[],edges:[f]}),(ee=T.current)==null||ee.blur()):q([e])),s&&s(K,f)},X=r?K=>{r(K,{...f})}:void 0,Q=i?K=>{i(K,{...f})}:void 0,z=c?K=>{c(K,{...f})}:void 0,U=u?K=>{u(K,{...f})}:void 0,G=g?K=>{g(K,{...f})}:void 0,Y=K=>{var q;if(!b&&Qn.includes(K.key)&&S){const{unselectNodesAndEdges:te,addSelectedEdges:se}=L.getState();K.key==="Escape"?((q=T.current)==null||q.blur(),te({edges:[f]})):se([e])}};return a.jsx("svg",{style:{zIndex:V},children:a.jsxs("g",{className:ie(["react-flow__edge",`react-flow__edge-${M}`,f.className,y,{selected:f.selected,animated:f.animated,inactive:!S&&!s,updating:C,selectable:S}]),onClick:W,onDoubleClick:X,onContextMenu:Q,onMouseEnter:z,onMouseMove:U,onMouseLeave:G,onKeyDown:k?Y:void 0,tabIndex:k?0:void 0,role:f.ariaRole??(k?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":f.ariaLabel===null?void 0:f.ariaLabel||`Edge from ${f.source} to ${f.target}`,"aria-describedby":k?`${Ps}-${p}`:void 0,ref:T,...f.domAttributes,children:[!D&&a.jsx(E,{id:e,source:f.source,target:f.target,type:f.type,selected:f.selected,animated:f.animated,selectable:S,deletable:f.deletable??!0,label:f.label,labelStyle:f.labelStyle,labelShowBg:f.labelShowBg,labelBgStyle:f.labelBgStyle,labelBgPadding:f.labelBgPadding,labelBgBorderRadius:f.labelBgBorderRadius,sourceX:R,sourceY:P,targetX:A,targetY:F,sourcePosition:O,targetPosition:B,data:f.data,style:f.style,sourceHandleId:f.sourceHandle,targetHandleId:f.targetHandle,markerStart:$,markerEnd:_,pathOptions:"pathOptions"in f?f.pathOptions:void 0,interactionWidth:f.interactionWidth}),I&&a.jsx(dc,{edge:f,isReconnectable:I,reconnectRadius:h,onReconnect:l,onReconnectStart:d,onReconnectEnd:m,sourceX:R,sourceY:P,targetX:A,targetY:F,sourcePosition:O,targetPosition:B,setUpdateHover:j,setReconnecting:H})]})})}var fc=N.memo(uc);const gc=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function so({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:s,onReconnect:r,onEdgeContextMenu:i,onEdgeMouseEnter:c,onEdgeMouseMove:u,onEdgeMouseLeave:g,onEdgeClick:h,reconnectRadius:l,onEdgeDoubleClick:d,onReconnectStart:m,onReconnectEnd:p,disableKeyboardA11y:w}){const{edgesFocusable:y,edgesReconnectable:x,elementsSelectable:b,onError:f}=J(gc,oe),v=qa(t);return a.jsxs("div",{className:"react-flow__edges",children:[a.jsx(nc,{defaultColor:e,rfId:n}),v.map(M=>a.jsx(fc,{id:M,edgesFocusable:y,edgesReconnectable:x,elementsSelectable:b,noPanClassName:s,onReconnect:r,onContextMenu:i,onMouseEnter:c,onMouseMove:u,onMouseLeave:g,onClick:h,reconnectRadius:l,onDoubleClick:d,onReconnectStart:m,onReconnectEnd:p,rfId:n,onError:f,edgeTypes:o,disableKeyboardA11y:w},M))]})}so.displayName="EdgeRenderer";const pc=N.memo(so),hc=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function mc({children:e}){const t=J(hc);return a.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function xc(e){const t=Wt(),n=N.useRef(!1);N.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const yc=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function wc(e){const t=J(yc),n=re();return N.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function bc(e){return e.connection.inProgress?{...e.connection,to:Ke(e.connection.to,e.transform)}:{...e.connection}}function vc(e){return bc}function Nc(e){const t=vc();return J(t,oe)}const Sc=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Ec({containerStyle:e,style:t,type:n,component:o}){const{nodesConnectable:s,width:r,height:i,isValid:c,inProgress:u}=J(Sc,oe);return!(r&&s&&u)?null:a.jsx("svg",{style:e,width:r,height:i,className:"react-flow__connectionline react-flow__container",children:a.jsx("g",{className:ie(["react-flow__connection",ts(c)]),children:a.jsx(oo,{style:t,type:n,CustomComponent:o,isValid:c})})})}const oo=({style:e,type:t=we.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:s,from:r,fromNode:i,fromHandle:c,fromPosition:u,to:g,toNode:h,toHandle:l,toPosition:d,pointer:m}=Nc();if(!s)return;if(n)return a.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:c,fromX:r.x,fromY:r.y,toX:g.x,toY:g.y,fromPosition:u,toPosition:d,connectionStatus:ts(o),toNode:h,toHandle:l,pointer:m});let p="";const w={sourceX:r.x,sourceY:r.y,sourcePosition:u,targetX:g.x,targetY:g.y,targetPosition:d};switch(t){case we.Bezier:[p]=gs(w);break;case we.SimpleBezier:[p]=Ys(w);break;case we.Step:[p]=Mt({...w,borderRadius:0});break;case we.SmoothStep:[p]=Mt(w);break;default:[p]=ms(w)}return a.jsx("path",{d:p,fill:"none",className:"react-flow__connection-path",style:e})};oo.displayName="ConnectionLine";const jc={};function Vn(e=jc){N.useRef(e),re(),N.useEffect(()=>{},[e])}function Cc(){re(),N.useRef(!1),N.useEffect(()=>{},[])}function ro({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:s,onNodeDoubleClick:r,onEdgeDoubleClick:i,onNodeMouseEnter:c,onNodeMouseMove:u,onNodeMouseLeave:g,onNodeContextMenu:h,onSelectionContextMenu:l,onSelectionStart:d,onSelectionEnd:m,connectionLineType:p,connectionLineStyle:w,connectionLineComponent:y,connectionLineContainerStyle:x,selectionKeyCode:b,selectionOnDrag:f,selectionMode:v,multiSelectionKeyCode:M,panActivationKeyCode:E,zoomActivationKeyCode:k,deleteKeyCode:I,onlyRenderVisibleElements:S,elementsSelectable:T,defaultViewport:C,translateExtent:j,minZoom:D,maxZoom:H,preventScrolling:L,defaultMarkerColor:V,zoomOnScroll:R,zoomOnPinch:P,panOnScroll:A,panOnScrollSpeed:F,panOnScrollMode:O,zoomOnDoubleClick:B,panOnDrag:$,onPaneClick:_,onPaneMouseEnter:W,onPaneMouseMove:X,onPaneMouseLeave:Q,onPaneScroll:z,onPaneContextMenu:U,paneClickDistance:G,nodeClickDistance:Y,onEdgeContextMenu:K,onEdgeMouseEnter:q,onEdgeMouseMove:te,onEdgeMouseLeave:se,reconnectRadius:ee,onReconnect:ae,onReconnectStart:me,onReconnectEnd:ge,noDragClassName:ve,noWheelClassName:Le,noPanClassName:_e,disableKeyboardA11y:ze,nodeExtent:xt,rfId:Qe,viewport:Ce,onViewportChange:He}){return Vn(e),Vn(t),Cc(),xc(n),wc(Ce),a.jsx(Va,{onPaneClick:_,onPaneMouseEnter:W,onPaneMouseMove:X,onPaneMouseLeave:Q,onPaneContextMenu:U,onPaneScroll:z,paneClickDistance:G,deleteKeyCode:I,selectionKeyCode:b,selectionOnDrag:f,selectionMode:v,onSelectionStart:d,onSelectionEnd:m,multiSelectionKeyCode:M,panActivationKeyCode:E,zoomActivationKeyCode:k,elementsSelectable:T,zoomOnScroll:R,zoomOnPinch:P,zoomOnDoubleClick:B,panOnScroll:A,panOnScrollSpeed:F,panOnScrollMode:O,panOnDrag:$,defaultViewport:C,translateExtent:j,minZoom:D,maxZoom:H,onSelectionContextMenu:l,preventScrolling:L,noDragClassName:ve,noWheelClassName:Le,noPanClassName:_e,disableKeyboardA11y:ze,onViewportChange:He,isControlledViewport:!!Ce,children:a.jsxs(mc,{children:[a.jsx(pc,{edgeTypes:t,onEdgeClick:s,onEdgeDoubleClick:i,onReconnect:ae,onReconnectStart:me,onReconnectEnd:ge,onlyRenderVisibleElements:S,onEdgeContextMenu:K,onEdgeMouseEnter:q,onEdgeMouseMove:te,onEdgeMouseLeave:se,reconnectRadius:ee,defaultMarkerColor:V,noPanClassName:_e,disableKeyboardA11y:ze,rfId:Qe}),a.jsx(Ec,{style:w,type:p,component:y,containerStyle:x}),a.jsx("div",{className:"react-flow__edgelabel-renderer"}),a.jsx(Ka,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:r,onNodeMouseEnter:c,onNodeMouseMove:u,onNodeMouseLeave:g,onNodeContextMenu:h,nodeClickDistance:Y,onlyRenderVisibleElements:S,noPanClassName:_e,noDragClassName:ve,disableKeyboardA11y:ze,nodeExtent:xt,rfId:Qe}),a.jsx("div",{className:"react-flow__viewport-portal"})]})})}ro.displayName="GraphView";const kc=N.memo(ro),Fn=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,fitViewOptions:c,minZoom:u=.5,maxZoom:g=2,nodeOrigin:h,nodeExtent:l,zIndexMode:d="basic"}={})=>{const m=new Map,p=new Map,w=new Map,y=new Map,x=o??t??[],b=n??e??[],f=h??[0,0],v=l??Fe;ws(w,y,x);const M=It(b,m,p,{nodeOrigin:f,nodeExtent:v,zIndexMode:d});let E=[0,0,1];if(i&&s&&r){const k=Ge(m,{filter:C=>!!((C.width||C.initialWidth)&&(C.height||C.initialHeight))}),{x:I,y:S,zoom:T}=zt(k,s,r,u,g,(c==null?void 0:c.padding)??.1);E=[I,S,T]}return{rfId:"1",width:s??0,height:r??0,transform:E,nodes:b,nodesInitialized:M,nodeLookup:m,parentLookup:p,edges:x,edgeLookup:y,connectionLookup:w,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:u,maxZoom:g,translateExtent:Fe,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Ie.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:f,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:c,fitViewResolver:null,connection:{...es},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:qr,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Jn,zIndexMode:d,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},Mc=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,fitViewOptions:c,minZoom:u,maxZoom:g,nodeOrigin:h,nodeExtent:l,zIndexMode:d})=>Zi((m,p)=>{async function w(){const{nodeLookup:y,panZoom:x,fitViewOptions:b,fitViewResolver:f,width:v,height:M,minZoom:E,maxZoom:k}=p();x&&(await Ur({nodes:y,width:v,height:M,panZoom:x,minZoom:E,maxZoom:k},b),f==null||f.resolve(!0),m({fitViewResolver:null}))}return{...Fn({nodes:e,edges:t,width:s,height:r,fitView:i,fitViewOptions:c,minZoom:u,maxZoom:g,nodeOrigin:h,nodeExtent:l,defaultNodes:n,defaultEdges:o,zIndexMode:d}),setNodes:y=>{const{nodeLookup:x,parentLookup:b,nodeOrigin:f,elevateNodesOnSelect:v,fitViewQueued:M,zIndexMode:E}=p(),k=It(y,x,b,{nodeOrigin:f,nodeExtent:l,elevateNodesOnSelect:v,checkEquality:!0,zIndexMode:E});M&&k?(w(),m({nodes:y,nodesInitialized:k,fitViewQueued:!1,fitViewOptions:void 0})):m({nodes:y,nodesInitialized:k})},setEdges:y=>{const{connectionLookup:x,edgeLookup:b}=p();ws(x,b,y),m({edges:y})},setDefaultNodesAndEdges:(y,x)=>{if(y){const{setNodes:b}=p();b(y),m({hasDefaultNodes:!0})}if(x){const{setEdges:b}=p();b(x),m({hasDefaultEdges:!0})}},updateNodeInternals:y=>{const{triggerNodeChanges:x,nodeLookup:b,parentLookup:f,domNode:v,nodeOrigin:M,nodeExtent:E,debug:k,fitViewQueued:I,zIndexMode:S}=p(),{changes:T,updatedInternals:C}=yi(y,b,f,v,M,E,S);C&&(pi(b,f,{nodeOrigin:M,nodeExtent:E,zIndexMode:S}),I?(w(),m({fitViewQueued:!1,fitViewOptions:void 0})):m({}),(T==null?void 0:T.length)>0&&(k&&console.log("React Flow: trigger node changes",T),x==null||x(T)))},updateNodePositions:(y,x=!1)=>{const b=[];let f=[];const{nodeLookup:v,triggerNodeChanges:M,connection:E,updateConnection:k,onNodesChangeMiddlewareMap:I}=p();for(const[S,T]of y){const C=v.get(S),j=!!(C!=null&&C.expandParent&&(C!=null&&C.parentId)&&(T!=null&&T.position)),D={id:S,type:"position",position:j?{x:Math.max(0,T.position.x),y:Math.max(0,T.position.y)}:T.position,dragging:x};if(C&&E.inProgress&&E.fromNode.id===C.id){const H=je(C,E.fromHandle,Z.Left,!0);k({...E,from:H})}j&&C.parentId&&b.push({id:S,parentId:C.parentId,rect:{...T.internals.positionAbsolute,width:T.measured.width??0,height:T.measured.height??0}}),f.push(D)}if(b.length>0){const{parentLookup:S,nodeOrigin:T}=p(),C=Ot(b,v,S,T);f.push(...C)}for(const S of I.values())f=S(f);M(f)},triggerNodeChanges:y=>{const{onNodesChange:x,setNodes:b,nodes:f,hasDefaultNodes:v,debug:M}=p();if(y!=null&&y.length){if(v){const E=Ts(y,f);b(E)}M&&console.log("React Flow: trigger node changes",y),x==null||x(y)}},triggerEdgeChanges:y=>{const{onEdgesChange:x,setEdges:b,edges:f,hasDefaultEdges:v,debug:M}=p();if(y!=null&&y.length){if(v){const E=Ls(y,f);b(E)}M&&console.log("React Flow: trigger edge changes",y),x==null||x(y)}},addSelectedNodes:y=>{const{multiSelectionActive:x,edgeLookup:b,nodeLookup:f,triggerNodeChanges:v,triggerEdgeChanges:M}=p();if(x){const E=y.map(k=>Ne(k,!0));v(E);return}v(Ae(f,new Set([...y]),!0)),M(Ae(b))},addSelectedEdges:y=>{const{multiSelectionActive:x,edgeLookup:b,nodeLookup:f,triggerNodeChanges:v,triggerEdgeChanges:M}=p();if(x){const E=y.map(k=>Ne(k,!0));M(E);return}M(Ae(b,new Set([...y]))),v(Ae(f,new Set,!0))},unselectNodesAndEdges:({nodes:y,edges:x}={})=>{const{edges:b,nodes:f,nodeLookup:v,triggerNodeChanges:M,triggerEdgeChanges:E}=p(),k=y||f,I=x||b,S=k.map(C=>{const j=v.get(C.id);return j&&(j.selected=!1),Ne(C.id,!1)}),T=I.map(C=>Ne(C.id,!1));M(S),E(T)},setMinZoom:y=>{const{panZoom:x,maxZoom:b}=p();x==null||x.setScaleExtent([y,b]),m({minZoom:y})},setMaxZoom:y=>{const{panZoom:x,minZoom:b}=p();x==null||x.setScaleExtent([b,y]),m({maxZoom:y})},setTranslateExtent:y=>{var x;(x=p().panZoom)==null||x.setTranslateExtent(y),m({translateExtent:y})},resetSelectedElements:()=>{const{edges:y,nodes:x,triggerNodeChanges:b,triggerEdgeChanges:f,elementsSelectable:v}=p();if(!v)return;const M=x.reduce((k,I)=>I.selected?[...k,Ne(I.id,!1)]:k,[]),E=y.reduce((k,I)=>I.selected?[...k,Ne(I.id,!1)]:k,[]);b(M),f(E)},setNodeExtent:y=>{const{nodes:x,nodeLookup:b,parentLookup:f,nodeOrigin:v,elevateNodesOnSelect:M,nodeExtent:E,zIndexMode:k}=p();y[0][0]===E[0][0]&&y[0][1]===E[0][1]&&y[1][0]===E[1][0]&&y[1][1]===E[1][1]||(It(x,b,f,{nodeOrigin:v,nodeExtent:y,elevateNodesOnSelect:M,checkEquality:!1,zIndexMode:k}),m({nodeExtent:y}))},panBy:y=>{const{transform:x,width:b,height:f,panZoom:v,translateExtent:M}=p();return wi({delta:y,panZoom:v,transform:x,translateExtent:M,width:b,height:f})},setCenter:async(y,x,b)=>{const{width:f,height:v,maxZoom:M,panZoom:E}=p();if(!E)return Promise.resolve(!1);const k=typeof(b==null?void 0:b.zoom)<"u"?b.zoom:M;return await E.setViewport({x:f/2-y*k,y:v/2-x*k,zoom:k},{duration:b==null?void 0:b.duration,ease:b==null?void 0:b.ease,interpolate:b==null?void 0:b.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{m({connection:{...es}})},updateConnection:y=>{m({connection:y})},reset:()=>m({...Fn()})}},Object.is);function Ac({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:s,initialHeight:r,initialMinZoom:i,initialMaxZoom:c,initialFitViewOptions:u,fitView:g,nodeOrigin:h,nodeExtent:l,zIndexMode:d,children:m}){const[p]=N.useState(()=>Mc({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:g,minZoom:i,maxZoom:c,fitViewOptions:u,nodeOrigin:h,nodeExtent:l,zIndexMode:d}));return a.jsx(Xi,{value:p,children:a.jsx(ma,{children:m})})}function Ic({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:s,width:r,height:i,fitView:c,fitViewOptions:u,minZoom:g,maxZoom:h,nodeOrigin:l,nodeExtent:d,zIndexMode:m}){return N.useContext(gt)?a.jsx(a.Fragment,{children:e}):a.jsx(Ac,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:s,initialWidth:r,initialHeight:i,fitView:c,initialFitViewOptions:u,initialMinZoom:g,initialMaxZoom:h,nodeOrigin:l,nodeExtent:d,zIndexMode:m,children:e})}const Pc={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Dc({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:r,edgeTypes:i,onNodeClick:c,onEdgeClick:u,onInit:g,onMove:h,onMoveStart:l,onMoveEnd:d,onConnect:m,onConnectStart:p,onConnectEnd:w,onClickConnectStart:y,onClickConnectEnd:x,onNodeMouseEnter:b,onNodeMouseMove:f,onNodeMouseLeave:v,onNodeContextMenu:M,onNodeDoubleClick:E,onNodeDragStart:k,onNodeDrag:I,onNodeDragStop:S,onNodesDelete:T,onEdgesDelete:C,onDelete:j,onSelectionChange:D,onSelectionDragStart:H,onSelectionDrag:L,onSelectionDragStop:V,onSelectionContextMenu:R,onSelectionStart:P,onSelectionEnd:A,onBeforeDelete:F,connectionMode:O,connectionLineType:B=we.Bezier,connectionLineStyle:$,connectionLineComponent:_,connectionLineContainerStyle:W,deleteKeyCode:X="Backspace",selectionKeyCode:Q="Shift",selectionOnDrag:z=!1,selectionMode:U=Oe.Full,panActivationKeyCode:G="Space",multiSelectionKeyCode:Y=Ye()?"Meta":"Control",zoomActivationKeyCode:K=Ye()?"Meta":"Control",snapToGrid:q,snapGrid:te,onlyRenderVisibleElements:se=!1,selectNodesOnDrag:ee,nodesDraggable:ae,autoPanOnNodeFocus:me,nodesConnectable:ge,nodesFocusable:ve,nodeOrigin:Le=Ds,edgesFocusable:_e,edgesReconnectable:ze,elementsSelectable:xt=!0,defaultViewport:Qe=ia,minZoom:Ce=.5,maxZoom:He=2,translateExtent:Xt=Fe,preventScrolling:uo=!0,nodeExtent:yt,defaultMarkerColor:fo="#b1b1b7",zoomOnScroll:go=!0,zoomOnPinch:po=!0,panOnScroll:ho=!1,panOnScrollSpeed:mo=.5,panOnScrollMode:xo=Se.Free,zoomOnDoubleClick:yo=!0,panOnDrag:wo=!0,onPaneClick:bo,onPaneMouseEnter:vo,onPaneMouseMove:No,onPaneMouseLeave:So,onPaneScroll:Eo,onPaneContextMenu:jo,paneClickDistance:Co=1,nodeClickDistance:ko=0,children:Mo,onReconnect:Ao,onReconnectStart:Io,onReconnectEnd:Po,onEdgeContextMenu:Do,onEdgeDoubleClick:$o,onEdgeMouseEnter:To,onEdgeMouseMove:Lo,onEdgeMouseLeave:_o,reconnectRadius:zo=10,onNodesChange:Ho,onEdgesChange:Ro,noDragClassName:Bo="nodrag",noWheelClassName:Vo="nowheel",noPanClassName:Gt="nopan",fitView:Ut,fitViewOptions:Kt,connectOnClick:Fo,attributionPosition:Oo,proOptions:Wo,defaultEdgeOptions:Yo,elevateNodesOnSelect:Zo=!0,elevateEdgesOnSelect:Xo=!1,disableKeyboardA11y:qt=!1,autoPanOnConnect:Go,autoPanOnNodeDrag:Uo,autoPanSpeed:Ko,connectionRadius:qo,isValidConnection:Qo,onError:Jo,style:er,id:Qt,nodeDragThreshold:tr,connectionDragThreshold:nr,viewport:sr,onViewportChange:or,width:rr,height:ir,colorMode:ar="light",debug:cr,onScroll:Je,ariaLabelConfig:lr,zIndexMode:Jt="basic",...dr},ur){const wt=Qt||"1",fr=da(ar),gr=N.useCallback(en=>{en.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Je==null||Je(en)},[Je]);return a.jsx("div",{"data-testid":"rf__wrapper",...dr,onScroll:gr,style:{...er,...Pc},ref:ur,className:ie(["react-flow",s,fr]),id:Qt,role:"application",children:a.jsxs(Ic,{nodes:e,edges:t,width:rr,height:ir,fitView:Ut,fitViewOptions:Kt,minZoom:Ce,maxZoom:He,nodeOrigin:Le,nodeExtent:yt,zIndexMode:Jt,children:[a.jsx(kc,{onInit:g,onNodeClick:c,onEdgeClick:u,onNodeMouseEnter:b,onNodeMouseMove:f,onNodeMouseLeave:v,onNodeContextMenu:M,onNodeDoubleClick:E,nodeTypes:r,edgeTypes:i,connectionLineType:B,connectionLineStyle:$,connectionLineComponent:_,connectionLineContainerStyle:W,selectionKeyCode:Q,selectionOnDrag:z,selectionMode:U,deleteKeyCode:X,multiSelectionKeyCode:Y,panActivationKeyCode:G,zoomActivationKeyCode:K,onlyRenderVisibleElements:se,defaultViewport:Qe,translateExtent:Xt,minZoom:Ce,maxZoom:He,preventScrolling:uo,zoomOnScroll:go,zoomOnPinch:po,zoomOnDoubleClick:yo,panOnScroll:ho,panOnScrollSpeed:mo,panOnScrollMode:xo,panOnDrag:wo,onPaneClick:bo,onPaneMouseEnter:vo,onPaneMouseMove:No,onPaneMouseLeave:So,onPaneScroll:Eo,onPaneContextMenu:jo,paneClickDistance:Co,nodeClickDistance:ko,onSelectionContextMenu:R,onSelectionStart:P,onSelectionEnd:A,onReconnect:Ao,onReconnectStart:Io,onReconnectEnd:Po,onEdgeContextMenu:Do,onEdgeDoubleClick:$o,onEdgeMouseEnter:To,onEdgeMouseMove:Lo,onEdgeMouseLeave:_o,reconnectRadius:zo,defaultMarkerColor:fo,noDragClassName:Bo,noWheelClassName:Vo,noPanClassName:Gt,rfId:wt,disableKeyboardA11y:qt,nodeExtent:yt,viewport:sr,onViewportChange:or}),a.jsx(la,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:m,onConnectStart:p,onConnectEnd:w,onClickConnectStart:y,onClickConnectEnd:x,nodesDraggable:ae,autoPanOnNodeFocus:me,nodesConnectable:ge,nodesFocusable:ve,edgesFocusable:_e,edgesReconnectable:ze,elementsSelectable:xt,elevateNodesOnSelect:Zo,elevateEdgesOnSelect:Xo,minZoom:Ce,maxZoom:He,nodeExtent:yt,onNodesChange:Ho,onEdgesChange:Ro,snapToGrid:q,snapGrid:te,connectionMode:O,translateExtent:Xt,connectOnClick:Fo,defaultEdgeOptions:Yo,fitView:Ut,fitViewOptions:Kt,onNodesDelete:T,onEdgesDelete:C,onDelete:j,onNodeDragStart:k,onNodeDrag:I,onNodeDragStop:S,onSelectionDrag:L,onSelectionDragStart:H,onSelectionDragStop:V,onMove:h,onMoveStart:l,onMoveEnd:d,noPanClassName:Gt,nodeOrigin:Le,rfId:wt,autoPanOnConnect:Go,autoPanOnNodeDrag:Uo,autoPanSpeed:Ko,onError:Jo,connectionRadius:qo,isValidConnection:Qo,selectNodesOnDrag:ee,nodeDragThreshold:tr,connectionDragThreshold:nr,onBeforeDelete:F,debug:cr,ariaLabelConfig:lr,zIndexMode:Jt}),a.jsx(ra,{onSelectionChange:D}),Mo,a.jsx(ea,{proOptions:Wo,position:Oo}),a.jsx(Ji,{rfId:wt,disableKeyboardA11y:qt})]})})}var $c=_s(Dc);function Tc(e){const[t,n]=N.useState(e),o=N.useCallback(s=>n(r=>Ts(s,r)),[]);return[t,n,o]}function Lc(e){const[t,n]=N.useState(e),o=N.useCallback(s=>n(r=>Ls(s,r)),[]);return[t,n,o]}function _c({dimensions:e,lineWidth:t,variant:n,className:o}){return a.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ie(["react-flow__background-pattern",n,o])})}function zc({radius:e,className:t}){return a.jsx("circle",{cx:e,cy:e,r:e,className:ie(["react-flow__background-pattern","dots",t])})}var pe;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(pe||(pe={}));const Hc={[pe.Dots]:1,[pe.Lines]:1,[pe.Cross]:6},Rc=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function io({id:e,variant:t=pe.Dots,gap:n=20,size:o,lineWidth:s=1,offset:r=0,color:i,bgColor:c,style:u,className:g,patternClassName:h}){const l=N.useRef(null),{transform:d,patternId:m}=J(Rc,oe),p=o||Hc[t],w=t===pe.Dots,y=t===pe.Cross,x=Array.isArray(n)?n:[n,n],b=[x[0]*d[2]||1,x[1]*d[2]||1],f=p*d[2],v=Array.isArray(r)?r:[r,r],M=y?[f,f]:b,E=[v[0]*d[2]||1+M[0]/2,v[1]*d[2]||1+M[1]/2],k=`${m}${e||""}`;return a.jsxs("svg",{className:ie(["react-flow__background",g]),style:{...u,...pt,"--xy-background-color-props":c,"--xy-background-pattern-color-props":i},ref:l,"data-testid":"rf__background",children:[a.jsx("pattern",{id:k,x:d[0]%b[0],y:d[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${E[0]},-${E[1]})`,children:w?a.jsx(zc,{radius:f/2,className:h}):a.jsx(_c,{dimensions:M,lineWidth:s,variant:t,className:h})}),a.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${k})`})]})}io.displayName="Background";const Bc=N.memo(io);function Vc(){return a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:a.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Fc(){return a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:a.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Oc(){return a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:a.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Wc(){return a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:a.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Yc(){return a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:a.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function st({children:e,className:t,...n}){return a.jsx("button",{type:"button",className:ie(["react-flow__controls-button",t]),...n,children:e})}const Zc=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function ao({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:r,onZoomOut:i,onFitView:c,onInteractiveChange:u,className:g,children:h,position:l="bottom-left",orientation:d="vertical","aria-label":m}){const p=re(),{isInteractive:w,minZoomReached:y,maxZoomReached:x,ariaLabelConfig:b}=J(Zc,oe),{zoomIn:f,zoomOut:v,fitView:M}=Wt(),E=()=>{f(),r==null||r()},k=()=>{v(),i==null||i()},I=()=>{M(s),c==null||c()},S=()=>{p.setState({nodesDraggable:!w,nodesConnectable:!w,elementsSelectable:!w}),u==null||u(!w)},T=d==="horizontal"?"horizontal":"vertical";return a.jsxs(qe,{className:ie(["react-flow__controls",T,g]),position:l,style:e,"data-testid":"rf__controls","aria-label":m??b["controls.ariaLabel"],children:[t&&a.jsxs(a.Fragment,{children:[a.jsx(st,{onClick:E,className:"react-flow__controls-zoomin",title:b["controls.zoomIn.ariaLabel"],"aria-label":b["controls.zoomIn.ariaLabel"],disabled:x,children:a.jsx(Vc,{})}),a.jsx(st,{onClick:k,className:"react-flow__controls-zoomout",title:b["controls.zoomOut.ariaLabel"],"aria-label":b["controls.zoomOut.ariaLabel"],disabled:y,children:a.jsx(Fc,{})})]}),n&&a.jsx(st,{className:"react-flow__controls-fitview",onClick:I,title:b["controls.fitView.ariaLabel"],"aria-label":b["controls.fitView.ariaLabel"],children:a.jsx(Oc,{})}),o&&a.jsx(st,{className:"react-flow__controls-interactive",onClick:S,title:b["controls.interactive.ariaLabel"],"aria-label":b["controls.interactive.ariaLabel"],children:w?a.jsx(Yc,{}):a.jsx(Wc,{})}),h]})}ao.displayName="Controls";const Xc=N.memo(ao);function Gc({id:e,x:t,y:n,width:o,height:s,style:r,color:i,strokeColor:c,strokeWidth:u,className:g,borderRadius:h,shapeRendering:l,selected:d,onClick:m}){const{background:p,backgroundColor:w}=r||{},y=i||p||w;return a.jsx("rect",{className:ie(["react-flow__minimap-node",{selected:d},g]),x:t,y:n,rx:h,ry:h,width:o,height:s,style:{fill:y,stroke:c,strokeWidth:u},shapeRendering:l,onClick:m?x=>m(x,e):void 0})}const Uc=N.memo(Gc),Kc=e=>e.nodes.map(t=>t.id),Ct=e=>e instanceof Function?e:()=>e;function qc({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:s,nodeComponent:r=Uc,onClick:i}){const c=J(Kc,oe),u=Ct(t),g=Ct(e),h=Ct(n),l=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return a.jsx(a.Fragment,{children:c.map(d=>a.jsx(Jc,{id:d,nodeColorFunc:u,nodeStrokeColorFunc:g,nodeClassNameFunc:h,nodeBorderRadius:o,nodeStrokeWidth:s,NodeComponent:r,onClick:i,shapeRendering:l},d))})}function Qc({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:s,nodeStrokeWidth:r,shapeRendering:i,NodeComponent:c,onClick:u}){const{node:g,x:h,y:l,width:d,height:m}=J(p=>{const{internals:w}=p.nodeLookup.get(e),y=w.userNode,{x,y:b}=w.positionAbsolute,{width:f,height:v}=he(y);return{node:y,x,y:b,width:f,height:v}},oe);return!g||g.hidden||!as(g)?null:a.jsx(c,{x:h,y:l,width:d,height:m,style:g.style,selected:!!g.selected,className:o(g),color:t(g),borderRadius:s,strokeColor:n(g),strokeWidth:r,shapeRendering:i,onClick:u,id:g.id})}const Jc=N.memo(Qc);var el=N.memo(qc);const tl=200,nl=150,sl=e=>!e.hidden,ol=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?is(Ge(e.nodeLookup,{filter:sl}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},rl="react-flow__minimap-desc";function co({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:s="",nodeBorderRadius:r=5,nodeStrokeWidth:i,nodeComponent:c,bgColor:u,maskColor:g,maskStrokeColor:h,maskStrokeWidth:l,position:d="bottom-right",onClick:m,onNodeClick:p,pannable:w=!1,zoomable:y=!1,ariaLabel:x,inversePan:b,zoomStep:f=1,offsetScale:v=5}){const M=re(),E=N.useRef(null),{boundingRect:k,viewBB:I,rfId:S,panZoom:T,translateExtent:C,flowWidth:j,flowHeight:D,ariaLabelConfig:H}=J(ol,oe),L=(e==null?void 0:e.width)??tl,V=(e==null?void 0:e.height)??nl,R=k.width/L,P=k.height/V,A=Math.max(R,P),F=A*L,O=A*V,B=v*A,$=k.x-(F-k.width)/2-B,_=k.y-(O-k.height)/2-B,W=F+B*2,X=O+B*2,Q=`${rl}-${S}`,z=N.useRef(0),U=N.useRef();z.current=A,N.useEffect(()=>{if(E.current&&T)return U.current=Mi({domNode:E.current,panZoom:T,getTransform:()=>M.getState().transform,getViewScale:()=>z.current}),()=>{var q;(q=U.current)==null||q.destroy()}},[T]),N.useEffect(()=>{var q;(q=U.current)==null||q.update({translateExtent:C,width:j,height:D,inversePan:b,pannable:w,zoomStep:f,zoomable:y})},[w,y,b,f,C,j,D]);const G=m?q=>{var ee;const[te,se]=((ee=U.current)==null?void 0:ee.pointer(q))||[0,0];m(q,{x:te,y:se})}:void 0,Y=p?N.useCallback((q,te)=>{const se=M.getState().nodeLookup.get(te).internals.userNode;p(q,se)},[]):void 0,K=x??H["minimap.ariaLabel"];return a.jsx(qe,{position:d,style:{...e,"--xy-minimap-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-background-color-props":typeof g=="string"?g:void 0,"--xy-minimap-mask-stroke-color-props":typeof h=="string"?h:void 0,"--xy-minimap-mask-stroke-width-props":typeof l=="number"?l*A:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:ie(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:a.jsxs("svg",{width:L,height:V,viewBox:`${$} ${_} ${W} ${X}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Q,ref:E,onClick:G,children:[K&&a.jsx("title",{id:Q,children:K}),a.jsx(el,{onClick:Y,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:r,nodeClassName:s,nodeStrokeWidth:i,nodeComponent:c}),a.jsx("path",{className:"react-flow__minimap-mask",d:`M${$-B},${_-B}h${W+B*2}v${X+B*2}h${-W-B*2}z
        M${I.x},${I.y}h${I.width}v${I.height}h${-I.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}co.displayName="MiniMap";const il=N.memo(co),al=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,cl={[Te.Line]:"right",[Te.Handle]:"bottom-right"};function ll({nodeId:e,position:t,variant:n=Te.Handle,className:o,style:s=void 0,children:r,color:i,minWidth:c=10,minHeight:u=10,maxWidth:g=Number.MAX_VALUE,maxHeight:h=Number.MAX_VALUE,keepAspectRatio:l=!1,resizeDirection:d,autoScale:m=!0,shouldResize:p,onResizeStart:w,onResize:y,onResizeEnd:x}){const b=Bs(),f=typeof e=="string"?e:b,v=re(),M=N.useRef(null),E=n===Te.Handle,k=J(N.useCallback(al(E&&m),[E,m]),oe),I=N.useRef(null),S=t??cl[n];N.useEffect(()=>{if(!(!M.current||!f))return I.current||(I.current=Fi({domNode:M.current,nodeId:f,getStoreItems:()=>{const{nodeLookup:C,transform:j,snapGrid:D,snapToGrid:H,nodeOrigin:L,domNode:V}=v.getState();return{nodeLookup:C,transform:j,snapGrid:D,snapToGrid:H,nodeOrigin:L,paneDomNode:V}},onChange:(C,j)=>{const{triggerNodeChanges:D,nodeLookup:H,parentLookup:L,nodeOrigin:V}=v.getState(),R=[],P={x:C.x,y:C.y},A=H.get(f);if(A&&A.expandParent&&A.parentId){const F=A.origin??V,O=C.width??A.measured.width??0,B=C.height??A.measured.height??0,$={id:A.id,parentId:A.parentId,rect:{width:O,height:B,...cs({x:C.x??A.position.x,y:C.y??A.position.y},{width:O,height:B},A.parentId,H,F)}},_=Ot([$],H,L,V);R.push(..._),P.x=C.x?Math.max(F[0]*O,C.x):void 0,P.y=C.y?Math.max(F[1]*B,C.y):void 0}if(P.x!==void 0&&P.y!==void 0){const F={id:f,type:"position",position:{...P}};R.push(F)}if(C.width!==void 0&&C.height!==void 0){const O={id:f,type:"dimensions",resizing:!0,setAttributes:d?d==="horizontal"?"width":"height":!0,dimensions:{width:C.width,height:C.height}};R.push(O)}for(const F of j){const O={...F,type:"position"};R.push(O)}D(R)},onEnd:({width:C,height:j})=>{const D={id:f,type:"dimensions",resizing:!1,dimensions:{width:C,height:j}};v.getState().triggerNodeChanges([D])}})),I.current.update({controlPosition:S,boundaries:{minWidth:c,minHeight:u,maxWidth:g,maxHeight:h},keepAspectRatio:l,resizeDirection:d,onResizeStart:w,onResize:y,onResizeEnd:x,shouldResize:p}),()=>{var C;(C=I.current)==null||C.destroy()}},[S,c,u,g,h,l,w,y,x,p]);const T=S.split("-");return a.jsx("div",{className:ie(["react-flow__resize-control","nodrag",...T,n,o]),ref:M,style:{...s,scale:k,...i&&{[E?"backgroundColor":"borderColor"]:i}},children:r})}N.memo(ll);const dl=({isOpen:e,onClose:t,onImportComplete:n,engagementId:o})=>{var I;const[s,r]=N.useState(null),[i,c]=N.useState([]),[u,g]=N.useState("auto"),[h,l]=N.useState("merge"),[d,m]=N.useState(!1),[p,w]=N.useState(null),[y,x]=N.useState(null);N.useEffect(()=>{e&&(async()=>{try{const T=await Re.get("/api/network-topology/import/formats");c(T.data.formats||[])}catch(T){console.error("Failed to fetch formats:",T)}})()},[e]);const b=N.useCallback(S=>{if(S.length>0){r(S[0]),x(null),w(null);const T=S[0].name.toLowerCase();T.endsWith(".xml")?g("nmap_xml"):T.endsWith(".gnmap")?g("nmap_grepable"):T.endsWith(".json")?g("masscan_json"):g("auto")}},[]),{getRootProps:f,getInputProps:v,isDragActive:M}=Wr({onDrop:b,accept:{"text/xml":[".xml"],"application/xml":[".xml"],"application/json":[".json"],"text/plain":[".txt",".log",".gnmap",".greppable"]},maxFiles:1,maxSize:10*1024*1024}),E=async()=>{var S,T;if(!s){x("Please select a file to import");return}m(!0),x(null);try{const C=new FormData;C.append("file",s);const j=new URLSearchParams;u!=="auto"&&j.append("format",u),j.append("mergeMode",h),o&&j.append("engagementId",o);const D=await Re.post(`/api/network-topology/import/tool?${j.toString()}`,C,{headers:{"Content-Type":"multipart/form-data"}});D.data.success?(n(D.data.nodes,D.data.edges,D.data.stats),ce.success(`Imported ${D.data.stats.hostsImported} hosts with ${D.data.stats.portsDiscovered} ports`),t()):x(D.data.error||"Import failed")}catch(C){const j=((T=(S=C.response)==null?void 0:S.data)==null?void 0:T.error)||C.message||"Import failed";x(j),ce.error(j)}finally{m(!1)}},k=()=>{r(null),w(null),x(null),g("auto"),l("merge"),t()};return e?a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6 border-b border-gray-700 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[a.jsx(ot,{className:"w-6 h-6 text-cyan-400"}),"Import Network Topology"]}),a.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Upload scan results from nmap, masscan, netcat, or rustscan"})]}),a.jsx("button",{onClick:k,className:"text-gray-400 hover:text-white",children:a.jsx(rt,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{...f(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${M?"border-cyan-500 bg-cyan-500/10":s?"border-green-500 bg-green-500/10":"border-gray-600 hover:border-gray-500"}`,children:[a.jsx("input",{...v()}),s?a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx(wr,{className:"w-10 h-10 text-green-400"}),a.jsxs("div",{className:"text-left",children:[a.jsx("p",{className:"text-white font-medium",children:s.name}),a.jsxs("p",{className:"text-sm text-gray-400",children:[(s.size/1024).toFixed(1)," KB"]})]}),a.jsx("button",{onClick:S=>{S.stopPropagation(),r(null),w(null)},className:"ml-4 text-gray-400 hover:text-red-400",children:a.jsx(rt,{className:"w-5 h-5"})})]}):a.jsxs(a.Fragment,{children:[a.jsx(ot,{className:"w-12 h-12 text-gray-500 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-300",children:M?"Drop the file here...":"Drag & drop a scan file, or click to select"}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Supports: .xml, .gnmap, .json, .txt, .log (max 10MB)"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"File Format"}),a.jsxs("select",{value:u,onChange:S=>g(S.target.value),className:"w-full p-2.5 bg-gray-900 border border-gray-600 rounded-lg text-white",children:[a.jsx("option",{value:"auto",children:"Auto-detect"}),i.map(S=>a.jsx("option",{value:S.id,children:S.name},S.id))]}),u!=="auto"&&i.find(S=>S.id===u)&&a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:(I=i.find(S=>S.id===u))==null?void 0:I.description})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Import Mode"}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"merge",label:"Merge",desc:"Add new hosts, update existing"},{value:"replace",label:"Replace",desc:"Replace all existing nodes"},{value:"append",label:"Append",desc:"Add all nodes (may duplicate)"}].map(S=>a.jsxs("button",{onClick:()=>l(S.value),className:`p-3 rounded-lg border text-left transition-colors ${h===S.value?"border-cyan-500 bg-cyan-500/10":"border-gray-600 hover:border-gray-500"}`,children:[a.jsx("div",{className:"font-medium text-white",children:S.label}),a.jsx("div",{className:"text-xs text-gray-400",children:S.desc})]},S.value))})]}),a.jsxs("div",{className:"bg-gray-900 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(br,{className:"w-4 h-4 text-gray-400"}),a.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Supported Tool Commands"})]}),a.jsxs("div",{className:"space-y-2 text-xs font-mono text-gray-500",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-cyan-400",children:"nmap:"})," ","nmap -sV -oX output.xml <target>"]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-cyan-400",children:"nmap (grep):"})," ","nmap -sV -oG output.gnmap <target>"]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-cyan-400",children:"masscan:"})," ","masscan -p1-65535 -oJ output.json <target>"]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-cyan-400",children:"netcat:"})," ","nc -zv <host> 1-1000 2>&1 | tee output.txt"]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-cyan-400",children:"rustscan:"})," ","rustscan -a <target> --greppable > output.txt"]})]})]}),y&&a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-500/10 border border-red-500/30 rounded-lg",children:[a.jsx(vr,{className:"w-5 h-5 text-red-400 flex-shrink-0"}),a.jsx("p",{className:"text-sm text-red-400",children:y})]})]}),a.jsxs("div",{className:"p-6 border-t border-gray-700 flex justify-end gap-3",children:[a.jsx(ue,{variant:"secondary",onClick:k,children:"Cancel"}),a.jsx(ue,{onClick:E,disabled:!s||d,children:d?a.jsxs(a.Fragment,{children:[a.jsx(Nr,{className:"w-4 h-4 mr-2 animate-spin"}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ot,{className:"w-4 h-4 mr-2"}),"Import"]})})]})]})}):null},Zt={router:Br,switch:Xn,firewall:Un,server:Kn,database:Rr,cloud:Hr,workstation:nn,laptop:nn,mobile:zr,iot:tn,printer:_r,camera:Lr,wireless_ap:Tr,load_balancer:$r,storage:Dr,container:Pr,virtual_machine:tn,internet:Ir,vpn:Ar},lo={router:"Router",switch:"Switch",firewall:"Firewall",server:"Server",database:"Database",cloud:"Cloud Service",workstation:"Workstation",laptop:"Laptop",mobile:"Mobile Device",iot:"IoT Device",printer:"Printer",camera:"Camera",wireless_ap:"Wireless AP",load_balancer:"Load Balancer",storage:"Storage",container:"Container",virtual_machine:"Virtual Machine",internet:"Internet",vpn:"VPN Gateway"},mt={external:{bg:"bg-red-500/10",border:"border-red-500",text:"text-red-400"},dmz:{bg:"bg-yellow-500/10",border:"border-yellow-500",text:"text-yellow-400"},internal:{bg:"bg-blue-500/10",border:"border-blue-500",text:"text-blue-400"},restricted:{bg:"bg-purple-500/10",border:"border-purple-500",text:"text-purple-400"},management:{bg:"bg-green-500/10",border:"border-green-500",text:"text-green-400"}},ul={compliant:"ring-green-500",non_compliant:"ring-red-500",partial:"ring-yellow-500",not_assessed:"ring-gray-500"},fl=({data:e,selected:t})=>{const n=Zt[e.deviceType]||Kn,o=mt[e.securityZone],s=ul[e.complianceStatus],r=()=>{switch(e.complianceStatus){case"compliant":return a.jsx($t,{className:"w-3 h-3 text-green-400"});case"non_compliant":return a.jsx(Tt,{className:"w-3 h-3 text-red-400"});case"partial":return a.jsx(Ve,{className:"w-3 h-3 text-yellow-400"});default:return a.jsx(qn,{className:"w-3 h-3 text-gray-400"})}};return a.jsxs("div",{className:`relative px-4 py-3 rounded-lg border-2 ${o.bg} ${o.border} ${t?"ring-2 ring-cyan-400":""} transition-all shadow-lg hover:shadow-xl`,children:[a.jsx(be,{type:"target",position:Z.Top,className:"!bg-cyan-500 !w-3 !h-3"}),a.jsx(be,{type:"source",position:Z.Bottom,className:"!bg-cyan-500 !w-3 !h-3"}),a.jsx(be,{type:"target",position:Z.Left,className:"!bg-cyan-500 !w-3 !h-3"}),a.jsx(be,{type:"source",position:Z.Right,className:"!bg-cyan-500 !w-3 !h-3"}),a.jsx("div",{className:`absolute -top-2 -right-2 p-1 rounded-full bg-gray-900 ring-2 ${s}`,children:a.jsx(r,{})}),a.jsxs("div",{className:"flex flex-col items-center gap-2 min-w-[100px]",children:[a.jsx("div",{className:`p-3 rounded-lg bg-gray-800/80 ${o.border} border`,children:a.jsx(n,{className:`w-8 h-8 ${o.text}`})}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"font-semibold text-white text-sm",children:e.label}),e.ipAddress&&a.jsx("div",{className:"text-xs text-gray-400 font-mono",children:e.ipAddress}),e.hostname&&a.jsx("div",{className:"text-xs text-gray-500",children:e.hostname})]}),e.vulnerabilities&&e.vulnerabilities>0&&a.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-400 bg-red-500/20 px-2 py-0.5 rounded",children:[a.jsx(Ve,{className:"w-3 h-3"}),e.vulnerabilities," vuln"]})]})]})},gl=({data:e})=>{const t=mt[e.zone];return a.jsx("div",{className:`px-6 py-4 rounded-xl border-2 border-dashed ${t.border} ${t.bg} min-w-[200px] min-h-[150px]`,style:{pointerEvents:"none"},children:a.jsx("div",{className:`text-sm font-bold ${t.text} uppercase tracking-wider`,children:e.label})})},pl={networkDevice:fl,securityZone:gl},On=()=>{const e=[{id:"internet",type:"networkDevice",position:{x:400,y:0},data:{label:"Internet",deviceType:"internet",securityZone:"external",complianceStatus:"not_assessed"}},{id:"ext-firewall",type:"networkDevice",position:{x:400,y:120},data:{label:"External Firewall",deviceType:"firewall",securityZone:"dmz",ipAddress:"10.0.0.1",hostname:"fw-ext-01",complianceStatus:"compliant",controlsAssessed:45,controlsPassing:43}},{id:"dmz-switch",type:"networkDevice",position:{x:400,y:240},data:{label:"DMZ Switch",deviceType:"switch",securityZone:"dmz",ipAddress:"10.0.1.1",hostname:"sw-dmz-01",complianceStatus:"compliant",controlsAssessed:20,controlsPassing:20}},{id:"web-server",type:"networkDevice",position:{x:200,y:350},data:{label:"Web Server",deviceType:"server",securityZone:"dmz",ipAddress:"10.0.1.10",hostname:"web-01",os:"Ubuntu 22.04",complianceStatus:"partial",controlsAssessed:85,controlsPassing:72,vulnerabilities:3}},{id:"mail-server",type:"networkDevice",position:{x:400,y:350},data:{label:"Mail Server",deviceType:"server",securityZone:"dmz",ipAddress:"10.0.1.11",hostname:"mail-01",os:"RHEL 8",complianceStatus:"compliant",controlsAssessed:90,controlsPassing:88}},{id:"vpn-gateway",type:"networkDevice",position:{x:600,y:350},data:{label:"VPN Gateway",deviceType:"vpn",securityZone:"dmz",ipAddress:"10.0.1.12",hostname:"vpn-01",complianceStatus:"compliant",controlsAssessed:40,controlsPassing:40}},{id:"int-firewall",type:"networkDevice",position:{x:400,y:480},data:{label:"Internal Firewall",deviceType:"firewall",securityZone:"internal",ipAddress:"10.1.0.1",hostname:"fw-int-01",complianceStatus:"compliant",controlsAssessed:45,controlsPassing:44}},{id:"core-switch",type:"networkDevice",position:{x:400,y:600},data:{label:"Core Switch",deviceType:"switch",securityZone:"internal",ipAddress:"10.1.1.1",hostname:"sw-core-01",complianceStatus:"compliant",controlsAssessed:25,controlsPassing:25}},{id:"app-server-1",type:"networkDevice",position:{x:100,y:720},data:{label:"App Server 1",deviceType:"server",securityZone:"internal",ipAddress:"10.1.2.10",hostname:"app-01",os:"Windows Server 2022",complianceStatus:"partial",controlsAssessed:95,controlsPassing:80,vulnerabilities:5}},{id:"app-server-2",type:"networkDevice",position:{x:300,y:720},data:{label:"App Server 2",deviceType:"container",securityZone:"internal",ipAddress:"10.1.2.11",hostname:"k8s-node-01",os:"Kubernetes",complianceStatus:"compliant",controlsAssessed:100,controlsPassing:98}},{id:"load-balancer",type:"networkDevice",position:{x:200,y:600},data:{label:"Load Balancer",deviceType:"load_balancer",securityZone:"internal",ipAddress:"10.1.2.1",hostname:"lb-01",complianceStatus:"compliant",controlsAssessed:30,controlsPassing:30}},{id:"wireless-ap",type:"networkDevice",position:{x:600,y:720},data:{label:"Wireless AP",deviceType:"wireless_ap",securityZone:"internal",ipAddress:"10.1.3.1",hostname:"ap-01",complianceStatus:"partial",controlsAssessed:20,controlsPassing:16,vulnerabilities:2}},{id:"workstation-1",type:"networkDevice",position:{x:700,y:820},data:{label:"Workstation",deviceType:"workstation",securityZone:"internal",ipAddress:"10.1.4.100",hostname:"ws-001",os:"Windows 11",complianceStatus:"compliant",controlsAssessed:50,controlsPassing:48}},{id:"laptop-1",type:"networkDevice",position:{x:500,y:820},data:{label:"Mobile Laptop",deviceType:"laptop",securityZone:"internal",ipAddress:"DHCP",hostname:"laptop-001",os:"macOS",complianceStatus:"partial",controlsAssessed:45,controlsPassing:38,vulnerabilities:1}},{id:"db-firewall",type:"networkDevice",position:{x:200,y:850},data:{label:"DB Firewall",deviceType:"firewall",securityZone:"restricted",ipAddress:"10.2.0.1",hostname:"fw-db-01",complianceStatus:"compliant",controlsAssessed:50,controlsPassing:50}},{id:"primary-db",type:"networkDevice",position:{x:100,y:970},data:{label:"Primary Database",deviceType:"database",securityZone:"restricted",ipAddress:"10.2.1.10",hostname:"db-primary",os:"PostgreSQL 15",complianceStatus:"compliant",controlsAssessed:80,controlsPassing:78}},{id:"replica-db",type:"networkDevice",position:{x:300,y:970},data:{label:"Replica Database",deviceType:"database",securityZone:"restricted",ipAddress:"10.2.1.11",hostname:"db-replica",os:"PostgreSQL 15",complianceStatus:"compliant",controlsAssessed:80,controlsPassing:80}},{id:"storage-san",type:"networkDevice",position:{x:200,y:1080},data:{label:"SAN Storage",deviceType:"storage",securityZone:"restricted",ipAddress:"10.2.2.1",hostname:"san-01",complianceStatus:"compliant",controlsAssessed:40,controlsPassing:40}},{id:"mgmt-switch",type:"networkDevice",position:{x:700,y:600},data:{label:"Mgmt Switch",deviceType:"switch",securityZone:"management",ipAddress:"10.3.0.1",hostname:"sw-mgmt-01",complianceStatus:"compliant",controlsAssessed:20,controlsPassing:20}},{id:"siem",type:"networkDevice",position:{x:850,y:550},data:{label:"SIEM",deviceType:"server",securityZone:"management",ipAddress:"10.3.1.10",hostname:"siem-01",complianceStatus:"compliant",controlsAssessed:60,controlsPassing:58}},{id:"monitoring",type:"networkDevice",position:{x:850,y:670},data:{label:"Monitoring",deviceType:"server",securityZone:"management",ipAddress:"10.3.1.11",hostname:"monitor-01",complianceStatus:"compliant",controlsAssessed:45,controlsPassing:45}},{id:"cloud-aws",type:"networkDevice",position:{x:50,y:120},data:{label:"AWS Cloud",deviceType:"cloud",securityZone:"external",complianceStatus:"partial",controlsAssessed:120,controlsPassing:100,vulnerabilities:8,description:"Cloud infrastructure"}}],t=[{id:"e-internet-fw",source:"internet",target:"ext-firewall",animated:!0,style:{stroke:"#ef4444"},markerEnd:{type:ne.ArrowClosed,color:"#ef4444"},label:"HTTPS/443",data:{protocol:"HTTPS",port:443,encrypted:!0,dataClassification:"public"}},{id:"e-cloud-fw",source:"cloud-aws",target:"ext-firewall",animated:!0,style:{stroke:"#ef4444"},markerEnd:{type:ne.ArrowClosed,color:"#ef4444"},label:"VPN/IPSec",data:{protocol:"IPSec",encrypted:!0}},{id:"e-fw-dmz-sw",source:"ext-firewall",target:"dmz-switch",style:{stroke:"#eab308"},markerEnd:{type:ne.ArrowClosed,color:"#eab308"}},{id:"e-dmz-web",source:"dmz-switch",target:"web-server",style:{stroke:"#eab308"},markerEnd:{type:ne.ArrowClosed,color:"#eab308"},label:"HTTP/80",data:{protocol:"HTTP",port:80}},{id:"e-dmz-mail",source:"dmz-switch",target:"mail-server",style:{stroke:"#eab308"},markerEnd:{type:ne.ArrowClosed,color:"#eab308"},label:"SMTP/25",data:{protocol:"SMTP",port:25,encrypted:!0}},{id:"e-dmz-vpn",source:"dmz-switch",target:"vpn-gateway",style:{stroke:"#eab308"},markerEnd:{type:ne.ArrowClosed,color:"#eab308"},label:"OpenVPN/1194",data:{protocol:"OpenVPN",port:1194,encrypted:!0}},{id:"e-dmz-int-fw",source:"dmz-switch",target:"int-firewall",style:{stroke:"#3b82f6",strokeWidth:2},markerEnd:{type:ne.ArrowClosed,color:"#3b82f6"}},{id:"e-int-fw-core",source:"int-firewall",target:"core-switch",style:{stroke:"#3b82f6"},markerEnd:{type:ne.ArrowClosed,color:"#3b82f6"}},{id:"e-core-lb",source:"core-switch",target:"load-balancer",style:{stroke:"#3b82f6"},markerEnd:{type:ne.ArrowClosed,color:"#3b82f6"}},{id:"e-lb-app1",source:"load-balancer",target:"app-server-1",style:{stroke:"#3b82f6"},markerEnd:{type:ne.ArrowClosed,color:"#3b82f6"},label:"HTTP/8080",data:{protocol:"HTTP",port:8080}},{id:"e-lb-app2",source:"load-balancer",target:"app-server-2",style:{stroke:"#3b82f6"},markerEnd:{type:ne.ArrowClosed,color:"#3b82f6"},label:"HTTP/8080",data:{protocol:"HTTP",port:8080}},{id:"e-core-ap",source:"core-switch",target:"wireless-ap",style:{stroke:"#3b82f6"},markerEnd:{type:ne.ArrowClosed,color:"#3b82f6"}},{id:"e-ap-ws",source:"wireless-ap",target:"workstation-1",style:{stroke:"#3b82f6",strokeDasharray:"5,5"},markerEnd:{type:ne.ArrowClosed,color:"#3b82f6"},label:"WiFi"},{id:"e-ap-laptop",source:"wireless-ap",target:"laptop-1",style:{stroke:"#3b82f6",strokeDasharray:"5,5"},markerEnd:{type:ne.ArrowClosed,color:"#3b82f6"},label:"WiFi"},{id:"e-app1-dbfw",source:"app-server-1",target:"db-firewall",style:{stroke:"#a855f7"},markerEnd:{type:ne.ArrowClosed,color:"#a855f7"},label:"SQL/5432",data:{protocol:"PostgreSQL",port:5432,encrypted:!0,dataClassification:"confidential"}},{id:"e-app2-dbfw",source:"app-server-2",target:"db-firewall",style:{stroke:"#a855f7"},markerEnd:{type:ne.ArrowClosed,color:"#a855f7"},label:"SQL/5432",data:{protocol:"PostgreSQL",port:5432,encrypted:!0,dataClassification:"confidential"}},{id:"e-dbfw-primary",source:"db-firewall",target:"primary-db",style:{stroke:"#a855f7"},markerEnd:{type:ne.ArrowClosed,color:"#a855f7"}},{id:"e-dbfw-replica",source:"db-firewall",target:"replica-db",style:{stroke:"#a855f7"},markerEnd:{type:ne.ArrowClosed,color:"#a855f7"}},{id:"e-primary-replica",source:"primary-db",target:"replica-db",style:{stroke:"#a855f7",strokeDasharray:"3,3"},markerEnd:{type:ne.ArrowClosed,color:"#a855f7"},label:"Replication"},{id:"e-db-san",source:"primary-db",target:"storage-san",style:{stroke:"#a855f7"},markerEnd:{type:ne.ArrowClosed,color:"#a855f7"},label:"iSCSI",data:{protocol:"iSCSI",encrypted:!0,dataClassification:"restricted"}},{id:"e-core-mgmt",source:"core-switch",target:"mgmt-switch",style:{stroke:"#22c55e"},markerEnd:{type:ne.ArrowClosed,color:"#22c55e"}},{id:"e-mgmt-siem",source:"mgmt-switch",target:"siem",style:{stroke:"#22c55e"},markerEnd:{type:ne.ArrowClosed,color:"#22c55e"},label:"Syslog/514",data:{protocol:"Syslog",port:514}},{id:"e-mgmt-monitor",source:"mgmt-switch",target:"monitoring",style:{stroke:"#22c55e"},markerEnd:{type:ne.ArrowClosed,color:"#22c55e"},label:"SNMP/161",data:{protocol:"SNMP",port:161}}];return{nodes:e,edges:t}},hl=({isOpen:e,onClose:t,onAdd:n})=>{const[o,s]=N.useState("server"),[r,i]=N.useState(""),[c,u]=N.useState(""),[g,h]=N.useState(""),[l,d]=N.useState("internal");if(!e)return null;const m=()=>{if(!r){ce.error("Please enter a device name");return}n({label:r,deviceType:o,ipAddress:c||void 0,hostname:g||void 0,securityZone:l,complianceStatus:"not_assessed",position:{x:400,y:400}}),i(""),u(""),h(""),t()};return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-md",children:[a.jsxs("div",{className:"p-6 border-b border-gray-700 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-bold text-white",children:"Add Network Device"}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:a.jsx(rt,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Device Type"}),a.jsx("div",{className:"grid grid-cols-4 gap-2",children:Object.entries(lo).map(([p,w])=>{const y=Zt[p];return a.jsxs("button",{onClick:()=>s(p),className:`p-2 rounded-lg border flex flex-col items-center gap-1 ${o===p?"border-cyan-500 bg-cyan-500/10":"border-gray-600 hover:border-gray-500"}`,children:[a.jsx(y,{className:"w-5 h-5 text-gray-300"}),a.jsx("span",{className:"text-xs text-gray-400 truncate w-full text-center",children:w})]},p)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Device Name"}),a.jsx("input",{type:"text",value:r,onChange:p=>i(p.target.value),placeholder:"e.g., Web Server 1",className:"w-full p-2 bg-gray-900 border border-gray-600 rounded-lg text-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"IP Address"}),a.jsx("input",{type:"text",value:c,onChange:p=>u(p.target.value),placeholder:"e.g., 10.0.0.1",className:"w-full p-2 bg-gray-900 border border-gray-600 rounded-lg text-white font-mono"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Hostname"}),a.jsx("input",{type:"text",value:g,onChange:p=>h(p.target.value),placeholder:"e.g., server-01",className:"w-full p-2 bg-gray-900 border border-gray-600 rounded-lg text-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Security Zone"}),a.jsxs("select",{value:l,onChange:p=>d(p.target.value),className:"w-full p-2 bg-gray-900 border border-gray-600 rounded-lg text-white",children:[a.jsx("option",{value:"external",children:"External (Untrusted)"}),a.jsx("option",{value:"dmz",children:"DMZ (Demilitarized Zone)"}),a.jsx("option",{value:"internal",children:"Internal (Trusted)"}),a.jsx("option",{value:"restricted",children:"Restricted (High Security)"}),a.jsx("option",{value:"management",children:"Management"})]})]})]}),a.jsxs("div",{className:"p-6 border-t border-gray-700 flex justify-end gap-3",children:[a.jsx(ue,{variant:"secondary",onClick:t,children:"Cancel"}),a.jsxs(ue,{onClick:m,children:[a.jsx(Gn,{className:"w-4 h-4 mr-2"}),"Add Device"]})]})]})})},ml=({device:e,onClose:t,onUpdate:n,onDelete:o})=>{if(!e)return null;const s=Zt[e.data.deviceType],r=mt[e.data.securityZone];return a.jsxs("div",{className:"absolute right-4 top-4 w-80 bg-gray-800 rounded-lg border border-gray-700 shadow-xl z-10",children:[a.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`p-2 rounded-lg ${r.bg} ${r.border} border`,children:a.jsx(s,{className:`w-5 h-5 ${r.text}`})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-white",children:e.data.label}),a.jsx("p",{className:"text-xs text-gray-400",children:lo[e.data.deviceType]})]})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:a.jsx(rt,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"p-4 space-y-3 text-sm",children:[e.data.ipAddress&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-400",children:"IP Address"}),a.jsx("span",{className:"text-white font-mono",children:e.data.ipAddress})]}),e.data.hostname&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-400",children:"Hostname"}),a.jsx("span",{className:"text-white",children:e.data.hostname})]}),e.data.os&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-400",children:"OS/Platform"}),a.jsx("span",{className:"text-white",children:e.data.os})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-400",children:"Security Zone"}),a.jsx("span",{className:r.text,children:e.data.securityZone.toUpperCase()})]}),a.jsxs("div",{className:"border-t border-gray-700 pt-3 mt-3",children:[a.jsx("h4",{className:"text-gray-400 mb-2",children:"Compliance Status"}),a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.data.complianceStatus==="compliant"&&a.jsxs(a.Fragment,{children:[a.jsx($t,{className:"w-4 h-4 text-green-400"}),a.jsx("span",{className:"text-green-400",children:"Compliant"})]}),e.data.complianceStatus==="non_compliant"&&a.jsxs(a.Fragment,{children:[a.jsx(Tt,{className:"w-4 h-4 text-red-400"}),a.jsx("span",{className:"text-red-400",children:"Non-Compliant"})]}),e.data.complianceStatus==="partial"&&a.jsxs(a.Fragment,{children:[a.jsx(Ve,{className:"w-4 h-4 text-yellow-400"}),a.jsx("span",{className:"text-yellow-400",children:"Partially Compliant"})]}),e.data.complianceStatus==="not_assessed"&&a.jsxs(a.Fragment,{children:[a.jsx(qn,{className:"w-4 h-4 text-gray-400"}),a.jsx("span",{className:"text-gray-400",children:"Not Assessed"})]})]}),e.data.controlsAssessed&&a.jsxs("div",{className:"text-xs text-gray-400",children:[e.data.controlsPassing||0,"/",e.data.controlsAssessed," controls passing",a.jsx("div",{className:"w-full h-2 bg-gray-700 rounded-full mt-1",children:a.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${(e.data.controlsPassing||0)/e.data.controlsAssessed*100}%`}})})]}),e.data.vulnerabilities&&e.data.vulnerabilities>0&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-red-400 text-xs bg-red-500/10 p-2 rounded",children:[a.jsx(Ve,{className:"w-4 h-4"}),e.data.vulnerabilities," vulnerabilities detected"]})]})]}),a.jsxs("div",{className:"p-4 border-t border-gray-700 flex gap-2",children:[a.jsxs(ue,{variant:"secondary",size:"sm",className:"flex-1",children:[a.jsx(Vr,{className:"w-4 h-4 mr-1"}),"Edit"]}),a.jsx(ue,{variant:"secondary",size:"sm",className:"text-red-400 hover:text-red-300",onClick:()=>o(e.id),children:a.jsx(Fr,{className:"w-4 h-4"})})]})]})},Ml=()=>{const[e,t,n]=Tc([]),[o,s,r]=Lc([]),[i,c]=N.useState(null),[u,g]=N.useState(!1),[h,l]=N.useState(!1),[d,m]=N.useState(!0),[p,w]=N.useState(!0),[y,x]=N.useState(!0),[b,f]=N.useState(null),[v,M]=N.useState([]),[E,k]=N.useState(""),[I,S]=N.useState("api"),[T,C]=N.useState(!1),j=N.useRef(null);N.useEffect(()=>{(async()=>{try{const _=await Re.get("/api/engagements");M(_.data.engagements||_.data||[])}catch(_){console.error("Failed to fetch engagements:",_)}})()},[]),N.useEffect(()=>{(async()=>{x(!0);try{if(I==="sample"){const{nodes:_,edges:W}=On();t(_),s(W),f({name:"Sample Network Topology",description:"Demo topology with sample devices",lastUpdated:new Date().toISOString(),totalDevices:_.length,totalConnections:W.length,dataSource:"sample"})}else{const _=E?`?engagement_id=${E}`:"",X=(await Re.get(`/api/network-topology${_}`)).data;X.nodes&&X.nodes.length>0?(t(X.nodes),s(X.edges||[]),f(X.metadata)):(ce.info("No network topology data found. You can add devices or use sample data."),t([]),s([]),f({name:"New Network Topology",description:"Add devices to build your network map",lastUpdated:new Date().toISOString(),totalDevices:0,totalConnections:0,dataSource:"empty"}))}}catch(_){console.error("Failed to fetch topology:",_),ce.error("Failed to load topology. Using sample data.");const{nodes:W,edges:X}=On();t(W),s(X),S("sample")}finally{x(!1)}})()},[E,I,t,s]);const D=N.useCallback($=>{const _={...$,markerEnd:{type:ne.ArrowClosed,color:"#06b6d4"},style:{stroke:"#06b6d4"}};s(W=>hs(_,W))},[s]),H=N.useCallback(($,_)=>{c(_)},[]),L=N.useCallback(()=>{c(null)},[]),V=$=>{const _={id:`device-${Date.now()}`,type:"networkDevice",position:$.position,data:{label:$.label||"New Device",deviceType:$.deviceType||"server",securityZone:$.securityZone||"internal",ipAddress:$.ipAddress,hostname:$.hostname,complianceStatus:"not_assessed"}};t(W=>[...W,_]),ce.success(`Added ${$.label}`)},R=$=>{t(_=>_.filter(W=>W.id!==$)),s(_=>_.filter(W=>W.source!==$&&W.target!==$)),c(null),ce.success("Device removed")},P=()=>{const $={nodes:e,edges:o},_=new Blob([JSON.stringify($,null,2)],{type:"application/json"}),W=URL.createObjectURL(_),X=document.createElement("a");X.href=W,X.download=`cato-network-map-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(W),ce.success("Network map exported")},A=()=>{ce.info("Image export coming soon")},F=async()=>{C(!0);try{await Re.post("/api/network-topology",{name:(b==null?void 0:b.name)||"Network Topology",description:b==null?void 0:b.description,engagementId:E||null,nodes:e,edges:o}),ce.success("Topology saved successfully")}catch($){console.error("Failed to save topology:",$),ce.error("Failed to save topology")}finally{C(!1)}},O=($,_,W)=>{const X=$.map(z=>({...z,type:z.type||"device",data:{...z.data,deviceType:z.data.deviceType||"server",securityZone:z.data.securityZone||"internal",complianceStatus:"not_assessed"}})),Q=_.map(z=>({...z,data:{}}));t(z=>{const U=new Map(z.filter(Y=>Y.data.ipAddress).map(Y=>[Y.data.ipAddress,Y])),G=[];for(const Y of X){const K=Y.data.ipAddress?U.get(Y.data.ipAddress):void 0;K?K.data={...K.data,...Y.data,label:K.data.label||Y.data.label}:G.push(Y)}return[...z,...G]}),s(z=>{const U=new Set(z.map(Y=>Y.id)),G=Q.filter(Y=>!U.has(Y.id));return[...z,...G]}),f(z=>({...z,lastUpdated:new Date().toISOString(),totalDevices:e.length+W.hostsImported,totalConnections:o.length+Q.length,dataSource:`Imported from ${W.sourceFormat}`}))},B=N.useMemo(()=>{const $=e.filter(G=>G.type==="networkDevice"),_=$.length,W=$.filter(G=>G.data.complianceStatus==="compliant").length,X=$.filter(G=>G.data.complianceStatus==="non_compliant").length,Q=$.filter(G=>G.data.complianceStatus==="partial").length,z=$.filter(G=>G.data.complianceStatus==="not_assessed").length,U=$.reduce((G,Y)=>G+(Y.data.vulnerabilities||0),0);return{total:_,compliant:W,nonCompliant:X,partial:Q,notAssessed:z,totalVulns:U}},[e]);return y?a.jsx(sn,{children:a.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-80px)]",children:a.jsx(Or,{})})}):a.jsxs(sn,{children:[a.jsxs("div",{className:"h-[calc(100vh-80px)] flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[a.jsx(Xn,{className:"w-8 h-8 text-cyan-400"}),"cATO Network Topology Map"]}),a.jsxs("p",{className:"text-gray-400 mt-1",children:[(b==null?void 0:b.name)||"Network Architecture & Data Flow Visualization",(b==null?void 0:b.dataSource)&&b.dataSource!=="sample"&&a.jsxs("span",{className:"text-xs text-green-400 ml-2",children:["(from ",b.dataSource,")"]}),(b==null?void 0:b.dataSource)==="sample"&&a.jsx("span",{className:"text-xs text-yellow-400 ml-2",children:"(sample data)"})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ue,{variant:"secondary",onClick:F,disabled:T,children:[a.jsx(Sr,{className:"w-4 h-4 mr-2"}),T?"Saving...":"Save"]}),a.jsxs(ue,{variant:"secondary",onClick:()=>g(!0),children:[a.jsx(Gn,{className:"w-4 h-4 mr-2"}),"Add Device"]}),a.jsxs(ue,{variant:"secondary",onClick:()=>l(!0),children:[a.jsx(ot,{className:"w-4 h-4 mr-2"}),"Import"]}),a.jsxs("div",{className:"relative group",children:[a.jsxs(ue,{variant:"secondary",children:[a.jsx(Er,{className:"w-4 h-4 mr-2"}),"Export"]}),a.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-gray-800 rounded-lg shadow-lg border border-gray-700 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-20",children:[a.jsxs("button",{onClick:P,className:"w-full px-4 py-2 text-left text-sm text-gray-300 hover:bg-gray-700 flex items-center gap-2 rounded-t-lg",children:[a.jsx(jr,{className:"w-4 h-4"}),"Export as JSON"]}),a.jsxs("button",{onClick:A,className:"w-full px-4 py-2 text-left text-sm text-gray-300 hover:bg-gray-700 flex items-center gap-2 rounded-b-lg",children:[a.jsx(Cr,{className:"w-4 h-4"}),"Export as PNG"]})]})]})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm text-gray-400",children:"Engagement:"}),a.jsxs("select",{value:E,onChange:$=>k($.target.value),className:"px-3 py-1.5 bg-gray-800 border border-gray-600 rounded-lg text-white text-sm min-w-[180px]",disabled:I==="sample",children:[a.jsx("option",{value:"",children:"All Assets"}),v.map($=>a.jsx("option",{value:$.id,children:$.name},$.id))]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm text-gray-400",children:"Data:"}),a.jsxs("div",{className:"flex bg-gray-800 rounded-lg border border-gray-600 overflow-hidden",children:[a.jsx("button",{onClick:()=>S("api"),className:`px-3 py-1.5 text-sm ${I==="api"?"bg-cyan-500 text-white":"text-gray-400 hover:text-white"}`,children:"Real Data"}),a.jsx("button",{onClick:()=>S("sample"),className:`px-3 py-1.5 text-sm ${I==="sample"?"bg-cyan-500 text-white":"text-gray-400 hover:text-white"}`,children:"Sample"})]})]}),I==="sample"&&a.jsx("span",{className:"text-xs text-yellow-400 bg-yellow-500/10 px-2 py-1 rounded",children:"Using sample demo data"})]}),a.jsxs("div",{className:"flex gap-4 mb-4 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-gray-800 rounded-lg",children:[a.jsx("span",{className:"text-gray-400",children:"Devices:"}),a.jsx("span",{className:"text-white font-semibold",children:B.total})]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-500/10 rounded-lg",children:[a.jsx($t,{className:"w-4 h-4 text-green-400"}),a.jsxs("span",{className:"text-green-400",children:[B.compliant," Compliant"]})]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-yellow-500/10 rounded-lg",children:[a.jsx(Ve,{className:"w-4 h-4 text-yellow-400"}),a.jsxs("span",{className:"text-yellow-400",children:[B.partial," Partial"]})]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-red-500/10 rounded-lg",children:[a.jsx(Tt,{className:"w-4 h-4 text-red-400"}),a.jsxs("span",{className:"text-red-400",children:[B.nonCompliant," Non-Compliant"]})]}),B.totalVulns>0&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-red-500/20 rounded-lg",children:[a.jsx(Un,{className:"w-4 h-4 text-red-400"}),a.jsxs("span",{className:"text-red-400",children:[B.totalVulns," Vulnerabilities"]})]}),a.jsx("div",{className:"flex-1"}),a.jsxs("button",{onClick:()=>m(!d),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg ${d?"bg-cyan-500/20 text-cyan-400":"bg-gray-800 text-gray-400"}`,children:[d?a.jsx(kr,{className:"w-4 h-4"}):a.jsx(Mr,{className:"w-4 h-4"}),"Labels"]})]}),a.jsxs("div",{className:"flex gap-4 mb-4 text-xs",children:[a.jsx("span",{className:"text-gray-500",children:"Security Zones:"}),Object.entries(mt).map(([$,_])=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:`w-3 h-3 rounded border ${_.border} ${_.bg}`}),a.jsx("span",{className:_.text,children:$.toUpperCase()})]},$))]}),a.jsxs("div",{ref:j,className:"flex-1 bg-gray-900 rounded-lg border border-gray-700 relative",children:[a.jsxs($c,{nodes:e,edges:o,onNodesChange:n,onEdgesChange:r,onConnect:D,onNodeClick:H,onPaneClick:L,nodeTypes:pl,fitView:!0,snapToGrid:!0,snapGrid:[20,20],defaultEdgeOptions:{type:"smoothstep",markerEnd:{type:ne.ArrowClosed}},children:[a.jsx(Bc,{variant:pe.Dots,gap:20,size:1,color:"#374151"}),a.jsx(Xc,{className:"!bg-gray-800 !border-gray-700 !rounded-lg"}),a.jsx(il,{className:"!bg-gray-800 !border-gray-700 !rounded-lg",nodeColor:$=>{const _=$.data;return _.complianceStatus==="compliant"?"#22c55e":_.complianceStatus==="non_compliant"?"#ef4444":_.complianceStatus==="partial"?"#eab308":"#6b7280"},maskColor:"rgba(0, 0, 0, 0.6)"}),a.jsx(qe,{position:"top-left",className:"!m-2",children:a.jsxs("div",{className:"bg-gray-800/90 rounded-lg p-3 border border-gray-700 text-xs",children:[a.jsx("div",{className:"font-semibold text-gray-300 mb-2",children:"Data Flow"}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-8 h-0.5 bg-red-500"}),a.jsx("span",{className:"text-gray-400",children:"External"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-8 h-0.5 bg-yellow-500"}),a.jsx("span",{className:"text-gray-400",children:"DMZ"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-8 h-0.5 bg-blue-500"}),a.jsx("span",{className:"text-gray-400",children:"Internal"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-8 h-0.5 bg-purple-500"}),a.jsx("span",{className:"text-gray-400",children:"Restricted"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-8 h-0.5 bg-green-500"}),a.jsx("span",{className:"text-gray-400",children:"Management"})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-2 pt-2 border-t border-gray-600",children:[a.jsx("div",{className:"w-8 h-0.5 border-b border-dashed border-gray-400"}),a.jsx("span",{className:"text-gray-400",children:"Wireless"})]})]})]})})]}),a.jsx(ml,{device:i,onClose:()=>c(null),onUpdate:()=>{},onDelete:R})]})]}),a.jsx(hl,{isOpen:u,onClose:()=>g(!1),onAdd:V}),a.jsx(dl,{isOpen:h,onClose:()=>l(!1),onImportComplete:O,engagementId:E||void 0})]})};export{Ml as default};
