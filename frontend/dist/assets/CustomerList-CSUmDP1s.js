import{j as e}from"./vendor-state-DrZ0R9WI.js";import{u as w,r as a,L as N}from"./vendor-react-HUtzaQ-y.js";import{K as f,d as y}from"./index-Dfnp1sHX.js";import"./vendor-ui-DVewFML6.js";import"./vendor-charts-Cc2OJGc4.js";function E(){const l=w(),[x,s]=a.useState([]),[i,o]=a.useState(!0),[c,u]=a.useState(null),[d,g]=a.useState(""),[r,n]=a.useState(!1),[m,b]=a.useState("");a.useEffect(()=>{j()},[d]);const j=async()=>{try{o(!0);const t=await f.customers.getAll(d||void 0);s(t.data)}catch(t){const p=t instanceof Error?t.message:"Failed to load customers";u(p)}finally{o(!1)}},v=t=>{switch(t){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"prospect":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},h=x.filter(t=>t.name.toLowerCase().includes(m.toLowerCase())||t.industry&&t.industry.toLowerCase().includes(m.toLowerCase()));return i?e.jsx(y,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})})}):e.jsx(y,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Customers"}),e.jsx("button",{onClick:()=>n(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700",children:"+ New Customer"})]}),c&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800",children:c})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search customers...",value:m,onChange:t=>b(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"})}),e.jsxs("select",{value:d,onChange:t=>g(t.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"prospect",children:"Prospect"})]})]}),e.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Industry"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Size"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:x.length===0?"No customers yet. Create your first customer!":"No customers match your search."})}):h.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>l(`/crm/customers/${t.id}`),children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 flex-shrink-0 rounded-full bg-indigo-100 flex items-center justify-center",children:e.jsx("span",{className:"text-indigo-600 font-medium",children:t.name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.name}),t.website&&e.jsx("div",{className:"text-sm text-gray-500",children:t.website})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.industry||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.company_size?t.company_size.charAt(0).toUpperCase()+t.company_size.slice(1):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${v(t.status)}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx(N,{to:`/crm/customers/${t.id}`,className:"text-indigo-600 hover:text-indigo-900",onClick:p=>p.stopPropagation(),children:"View"})})]},t.id))})]})}),r&&e.jsx(C,{onClose:()=>n(!1),onCreated:t=>{n(!1),l(`/crm/customers/${t.id}`)}})]})})}function C({onClose:l,onCreated:x}){const[s,i]=a.useState({name:"",industry:"",company_size:void 0,website:"",address:"",notes:"",status:"prospect"}),[o,c]=a.useState(!1),[u,d]=a.useState(null),g=async r=>{if(r.preventDefault(),!s.name.trim()){d("Customer name is required");return}try{c(!0),d(null);const n=await f.customers.create(s);x(n.data)}catch(n){const m=n instanceof Error?n.message:"Failed to create customer";d(m)}finally{c(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75",onClick:l}),e.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-lg w-full p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"New Customer"}),u&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 rounded p-3 text-red-800 text-sm",children:u}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),e.jsx("input",{type:"text",value:s.name,onChange:r=>i({...s,name:r.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Industry"}),e.jsx("input",{type:"text",value:s.industry||"",onChange:r=>i({...s,industry:r.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Company Size"}),e.jsxs("select",{value:s.company_size||"",onChange:r=>i({...s,company_size:r.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select size"}),e.jsx("option",{value:"small",children:"Small"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"enterprise",children:"Enterprise"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Website"}),e.jsx("input",{type:"url",value:s.website||"",onChange:r=>i({...s,website:r.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"https://"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{value:s.status||"prospect",onChange:r=>i({...s,status:r.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"prospect",children:"Prospect"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),e.jsx("textarea",{value:s.notes||"",onChange:r=>i({...s,notes:r.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:o,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700 disabled:opacity-50",children:o?"Creating...":"Create Customer"})]})]})]})]})})}export{E as default};
