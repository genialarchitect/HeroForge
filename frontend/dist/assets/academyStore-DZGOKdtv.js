import{c as l}from"./vendor-state-oFDmcCcB.js";import{a as o,b as i}from"./academyApi-CeTYPipX.js";const g=l((r,n)=>({publicPaths:[],userPaths:[],currentPath:null,currentLesson:null,currentQuiz:null,quizResult:null,quizAttempts:[],certificates:[],overallProgress:null,isLoadingPaths:!1,isLoadingPath:!1,isLoadingLesson:!1,isLoadingQuiz:!1,isSubmittingQuiz:!1,isEnrolling:!1,isUpdatingProgress:!1,error:null,fetchPublicPaths:async()=>{r({isLoadingPaths:!0,error:null});try{const s=await i.listPaths();r({publicPaths:s,isLoadingPaths:!1})}catch(s){r({error:s.message,isLoadingPaths:!1})}},fetchPublicPath:async s=>{r({isLoadingPath:!0,error:null});try{const e=await i.getPath(s),a={...e.path,enrolled:!1,enrollment_status:null,progress:{learning_path_id:e.path.id,completed_modules:0,total_modules:e.modules.length,completed_lessons:0,total_lessons:e.path.lesson_count,progress_percent:0,total_time_spent_seconds:0,last_accessed_at:null},modules:e.modules.map(t=>({...t,lessons:[],progress_percent:0,completed_lessons:0,is_unlocked:!1}))};r({currentPath:a,isLoadingPath:!1})}catch(e){r({error:e.message,isLoadingPath:!1})}},fetchUserPaths:async()=>{r({isLoadingPaths:!0,error:null});try{const s=await o.listPaths();r({userPaths:s,isLoadingPaths:!1})}catch(s){r({error:s.message,isLoadingPaths:!1})}},fetchPath:async s=>{r({isLoadingPath:!0,error:null});try{const e=await o.getPath(s);r({currentPath:e,isLoadingPath:!1})}catch(e){r({error:e.message,isLoadingPath:!1})}},enroll:async s=>{r({isEnrolling:!0,error:null});try{await o.enroll(s);const e=await o.getPath(s);r({currentPath:e,isEnrolling:!1})}catch(e){r({error:e.message,isEnrolling:!1})}},fetchLesson:async s=>{r({isLoadingLesson:!0,error:null});try{const e=await o.getLesson(s);r({currentLesson:e,isLoadingLesson:!1})}catch(e){r({error:e.message,isLoadingLesson:!1})}},updateLessonProgress:async(s,e,a)=>{r({isUpdatingProgress:!0});try{await o.updateProgress(s,{video_timestamp_seconds:e,time_spent_seconds:a});const t=n().currentLesson;t&&t.id===s?r({currentLesson:{...t,video_timestamp_seconds:e,status:t.status==="not_started"?"in_progress":t.status},isUpdatingProgress:!1}):r({isUpdatingProgress:!1})}catch(t){r({error:t.message,isUpdatingProgress:!1})}},completeLesson:async s=>{r({isUpdatingProgress:!0,error:null});try{const e=await o.completeLesson(s),a=n().currentLesson;return a&&a.id===s?r({currentLesson:{...a,status:"completed"},isUpdatingProgress:!1}):r({isUpdatingProgress:!1}),e}catch(e){return r({error:e.message,isUpdatingProgress:!1}),null}},updateNotes:async(s,e)=>{try{await o.updateNotes(s,e);const a=n().currentLesson;a&&a.id===s&&r({currentLesson:{...a,user_note:e}})}catch(a){r({error:a.message})}},fetchQuiz:async s=>{r({isLoadingQuiz:!0,error:null,quizResult:null});try{const e=await o.getQuiz(s);r({currentQuiz:e,isLoadingQuiz:!1})}catch(e){r({error:e.message,isLoadingQuiz:!1})}},submitQuiz:async(s,e,a)=>{r({isSubmittingQuiz:!0,error:null});try{const t=await o.submitQuiz(s,e,a);return r({quizResult:t,isSubmittingQuiz:!1}),t}catch(t){return r({error:t.message,isSubmittingQuiz:!1}),null}},fetchQuizAttempts:async s=>{try{const e=await o.getQuizAttempts(s);r({quizAttempts:e})}catch(e){r({error:e.message})}},fetchCertificates:async()=>{try{const s=await o.listCertificates();r({certificates:s})}catch(s){r({error:s.message})}},fetchOverallProgress:async()=>{try{const s=await o.getMyProgress();r({overallProgress:s})}catch(s){r({error:s.message})}},clearError:()=>r({error:null}),clearCurrentLesson:()=>r({currentLesson:null}),clearQuizResult:()=>r({quizResult:null})}));export{g as u};
