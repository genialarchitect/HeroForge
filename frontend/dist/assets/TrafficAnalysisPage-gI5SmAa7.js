import{b as ie,u as p,d as u,j as e}from"./vendor-state-DdX3IZQk.js";import{r as y}from"./vendor-react-Da1CiaFS.js";import{B as d,N as _,aR as ne,bl as xe,F as D,aq as S,aD as ce,a2 as de,G as oe,a as pe,V as me,S as ye,a6 as he,ae as ge,aQ as F,a4 as ue,aN as je,aH as z,aG as k,P as fe}from"./vendor-ui-CODyzv19.js";import{a5 as n,d as Ne}from"./index-BZ6s10K7.js";import"./vendor-charts-ClOpvfwV.js";const c={getStats:()=>n.get("/traffic-analysis/stats").then(s=>s.data),listCaptures:()=>n.get("/traffic-analysis/captures").then(s=>s.data),getCapture:s=>n.get(`/traffic-analysis/captures/${s}`).then(a=>a.data),uploadCapture:s=>n.post("/traffic-analysis/upload",s,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>a.data),analyzeCapture:(s,a)=>n.post(`/traffic-analysis/captures/${s}/analyze`,a).then(t=>t.data),deleteCapture:s=>n.delete(`/traffic-analysis/captures/${s}`).then(a=>a.data),listSessions:(s,a)=>n.get(`/traffic-analysis/captures/${s}/sessions`,{params:a}).then(t=>t.data),listAlerts:(s,a)=>n.get(`/traffic-analysis/captures/${s}/alerts`,{params:a}).then(t=>t.data),listCarvedFiles:s=>n.get(`/traffic-analysis/captures/${s}/carved-files`).then(a=>a.data),downloadCarvedFile:s=>n.get(`/traffic-analysis/carved-files/${s}/download`,{responseType:"blob"}).then(a=>a.data),listDnsQueries:(s,a)=>n.get(`/traffic-analysis/captures/${s}/dns`,{params:a}).then(t=>t.data),listTlsInfo:s=>n.get(`/traffic-analysis/captures/${s}/tls`).then(a=>a.data),listBeacons:s=>n.get(`/traffic-analysis/captures/${s}/beacons`).then(a=>a.data),listRules:()=>n.get("/traffic-analysis/rules").then(s=>s.data),createRule:s=>n.post("/traffic-analysis/rules",s).then(a=>a.data),updateRule:(s,a)=>n.put(`/traffic-analysis/rules/${s}`,a).then(t=>t.data),deleteRule:s=>n.delete(`/traffic-analysis/rules/${s}`).then(a=>a.data),validateRule:s=>n.post("/traffic-analysis/rules/validate",{content:s}).then(a=>a.data),listFingerprints:s=>n.get("/traffic-analysis/fingerprints",{params:s}).then(a=>a.data),lookupFingerprint:s=>n.get(`/traffic-analysis/fingerprints/${s}`).then(a=>a.data)},C=({status:s})=>{const a={pending:"bg-yellow-500/20 text-yellow-400",analyzing:"bg-blue-500/20 text-blue-400",completed:"bg-green-500/20 text-green-400",failed:"bg-red-500/20 text-red-400"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs ${a[s]||"bg-gray-500/20 text-gray-400"}`,children:s})},q=({severity:s})=>{const a={critical:"bg-red-500/20 text-red-400",high:"bg-orange-500/20 text-orange-400",medium:"bg-yellow-500/20 text-yellow-400",low:"bg-blue-500/20 text-blue-400",info:"bg-gray-500/20 text-gray-400"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs ${a[s.toLowerCase()]||"bg-gray-500/20 text-gray-400"}`,children:s})},j=s=>{if(s===0)return"0 B";const a=1024,t=["B","KB","MB","GB","TB"],r=Math.floor(Math.log(s)/Math.log(a));return parseFloat((s/Math.pow(a,r)).toFixed(2))+" "+t[r]},A=s=>s<60?`${s.toFixed(1)}s`:s<3600?`${Math.floor(s/60)}m ${Math.floor(s%60)}s`:`${Math.floor(s/3600)}h ${Math.floor(s%3600/60)}m`,Te=()=>{const s=ie(),[a,t]=y.useState("captures"),[r,x]=y.useState(null),[h,i]=y.useState(!1),[v,f]=y.useState(!1),[o,L]=y.useState(null),{data:m,isLoading:R}=p({queryKey:["traffic-stats"],queryFn:c.getStats}),{data:T=[],isLoading:$,refetch:P}=p({queryKey:["traffic-captures"],queryFn:c.listCaptures}),{data:M=[],isLoading:K}=p({queryKey:["traffic-rules"],queryFn:c.listRules,enabled:a==="rules"}),{data:B=[],isLoading:Q}=p({queryKey:["traffic-fingerprints"],queryFn:()=>c.listFingerprints(),enabled:a==="fingerprints"}),{data:I=[],isLoading:U}=p({queryKey:["traffic-sessions",r==null?void 0:r.id],queryFn:()=>c.listSessions(r.id),enabled:!!r&&a==="sessions"}),{data:E=[],isLoading:G}=p({queryKey:["traffic-alerts",r==null?void 0:r.id],queryFn:()=>c.listAlerts(r.id),enabled:!!r&&a==="alerts"}),{data:H=[],isLoading:V}=p({queryKey:["traffic-carved",r==null?void 0:r.id],queryFn:()=>c.listCarvedFiles(r.id),enabled:!!r&&a==="carved"}),{data:J=[],isLoading:Y}=p({queryKey:["traffic-dns",r==null?void 0:r.id],queryFn:()=>c.listDnsQueries(r.id),enabled:!!r&&a==="dns"}),{data:X=[],isLoading:O}=p({queryKey:["traffic-tls",r==null?void 0:r.id],queryFn:()=>c.listTlsInfo(r.id),enabled:!!r&&a==="tls"}),{data:W=[],isLoading:Z}=p({queryKey:["traffic-beacons",r==null?void 0:r.id],queryFn:()=>c.listBeacons(r.id),enabled:!!r&&a==="beacons"}),N=u({mutationFn:c.uploadCapture,onSuccess:()=>{d.success("PCAP uploaded successfully"),s.invalidateQueries({queryKey:["traffic-captures"]}),s.invalidateQueries({queryKey:["traffic-stats"]}),i(!1)},onError:l=>d.error(`Upload failed: ${l.message}`)}),ee=u({mutationFn:l=>c.analyzeCapture(l),onSuccess:()=>{d.success("Analysis started"),s.invalidateQueries({queryKey:["traffic-captures"]})},onError:l=>d.error(`Analysis failed: ${l.message}`)}),te=u({mutationFn:c.deleteCapture,onSuccess:()=>{d.success("Capture deleted"),s.invalidateQueries({queryKey:["traffic-captures"]}),s.invalidateQueries({queryKey:["traffic-stats"]}),r&&x(null)},onError:l=>d.error(`Delete failed: ${l.message}`)}),b=u({mutationFn:c.createRule,onSuccess:()=>{d.success("Rule created"),s.invalidateQueries({queryKey:["traffic-rules"]}),f(!1)},onError:l=>d.error(`Failed to create rule: ${l.message}`)}),se=u({mutationFn:c.deleteRule,onSuccess:()=>{d.success("Rule deleted"),s.invalidateQueries({queryKey:["traffic-rules"]})},onError:l=>d.error(`Failed to delete rule: ${l.message}`)}),ae=y.useCallback(l=>{l.preventDefault();const w=l.currentTarget,g=new FormData(w);N.mutate(g)},[N]),re=y.useCallback(l=>{l.preventDefault();const w=l.currentTarget,g=new FormData(w);b.mutate({name:g.get("name"),content:g.get("content"),severity:g.get("severity")})},[b]),le=[{id:"captures",label:"Captures",icon:e.jsx(D,{size:16})},{id:"sessions",label:"Sessions",icon:e.jsx(_,{size:16}),requiresCapture:!0},{id:"alerts",label:"IDS Alerts",icon:e.jsx(ce,{size:16}),requiresCapture:!0},{id:"carved",label:"Carved Files",icon:e.jsx(de,{size:16}),requiresCapture:!0},{id:"dns",label:"DNS",icon:e.jsx(oe,{size:16}),requiresCapture:!0},{id:"tls",label:"TLS/SSL",icon:e.jsx(pe,{size:16}),requiresCapture:!0},{id:"beacons",label:"Beacons",icon:e.jsx(me,{size:16}),requiresCapture:!0},{id:"rules",label:"IDS Rules",icon:e.jsx(ye,{size:16})},{id:"fingerprints",label:"Fingerprints",icon:e.jsx(he,{size:16})}];return e.jsx(Ne,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(_,{className:"text-cyan-400"}),"Traffic Analysis"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Analyze network captures, detect threats, and extract artifacts"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>P(),className:"px-3 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 flex items-center gap-2",children:[e.jsx(ne,{size:16}),"Refresh"]}),e.jsxs("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2",children:[e.jsx(xe,{size:16}),"Upload PCAP"]})]})]}),!R&&m&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Captures"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:m.total_captures})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Sessions"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:m.total_sessions.toLocaleString()})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Packets"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:m.total_packets.toLocaleString()})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Total Data"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:j(m.total_bytes)})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"IDS Alerts"}),e.jsx("div",{className:"text-2xl font-bold text-red-400",children:m.total_alerts})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Carved Files"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:m.total_carved_files})]})]}),r&&e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 border border-cyan-500/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(D,{className:"text-cyan-400",size:24}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:r.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[j(r.file_size)," • ",r.packet_count.toLocaleString()," packets • ",A(r.duration_seconds)]})]}),e.jsx(C,{status:r.status})]}),e.jsx("button",{onClick:()=>x(null),className:"text-gray-400 hover:text-white",children:e.jsx(S,{size:20})})]})}),e.jsx("div",{className:"flex gap-2 border-b border-gray-700 pb-2 overflow-x-auto",children:le.map(l=>e.jsxs("button",{onClick:()=>{if(l.requiresCapture&&!r){d.info("Please select a capture first");return}t(l.id)},className:`px-4 py-2 rounded-lg flex items-center gap-2 whitespace-nowrap ${a===l.id?"bg-cyan-600 text-white":l.requiresCapture&&!r?"bg-gray-800 text-gray-500 cursor-not-allowed":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:[l.icon,l.label]},l.id))}),e.jsxs("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:[a==="captures"&&e.jsx(be,{captures:T,loading:$,selectedCapture:r,onSelect:x,onAnalyze:l=>ee.mutate(l),onDelete:l=>te.mutate(l)}),a==="sessions"&&r&&e.jsx(ve,{sessions:I,loading:U}),a==="alerts"&&r&&e.jsx(we,{alerts:E,loading:G}),a==="carved"&&r&&e.jsx(Se,{files:H,loading:V}),a==="dns"&&r&&e.jsx(_e,{queries:J,loading:Y}),a==="tls"&&r&&e.jsx(Ce,{tlsInfo:X,loading:O}),a==="beacons"&&r&&e.jsx(Le,{beacons:W,loading:Z}),a==="rules"&&e.jsx(De,{rules:M,loading:K,onAdd:()=>f(!0),onDelete:l=>se.mutate(l)}),a==="fingerprints"&&e.jsx(Fe,{fingerprints:B,loading:Q})]}),h&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Upload PCAP"}),e.jsx("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-white",children:e.jsx(S,{size:20})})]}),e.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"PCAP File"}),e.jsx("input",{type:"file",name:"file",accept:".pcap,.pcapng,.cap",required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Description (optional)"}),e.jsx("textarea",{name:"description",rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"Describe this capture..."})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:N.isPending,className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 disabled:opacity-50",children:N.isPending?"Uploading...":"Upload"})]})]})]})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:o?"Edit IDS Rule":"Add IDS Rule"}),e.jsx("button",{onClick:()=>{f(!1),L(null)},className:"text-gray-400 hover:text-white",children:e.jsx(S,{size:20})})]}),e.jsxs("form",{onSubmit:re,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Rule Name"}),e.jsx("input",{type:"text",name:"name",required:!0,defaultValue:o==null?void 0:o.name,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"My Custom Rule"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Severity"}),e.jsxs("select",{name:"severity",defaultValue:(o==null?void 0:o.severity)||"medium",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"info",children:"Info"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Rule Content (Suricata/Snort format)"}),e.jsx("textarea",{name:"content",required:!0,rows:6,defaultValue:o==null?void 0:o.content,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white font-mono text-sm",placeholder:'alert tcp any any -> any 80 (msg:"HTTP Request"; content:"GET"; sid:1000001; rev:1;)'})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{f(!1),L(null)},className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:b.isPending,className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 disabled:opacity-50",children:b.isPending?"Saving...":"Save Rule"})]})]})]})})]})})},be=({captures:s,loading:a,selectedCapture:t,onSelect:r,onAnalyze:x,onDelete:h})=>a?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading captures..."}):s.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-400",children:[e.jsx(_,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No captures yet. Upload a PCAP file to get started."})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Size"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Packets"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Duration"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Sessions"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Alerts"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Uploaded"}),e.jsx("th",{className:"px-4 py-3 text-right text-gray-400 text-sm",children:"Actions"})]})}),e.jsx("tbody",{children:s.map(i=>e.jsxs("tr",{className:`border-t border-gray-700 hover:bg-gray-700/50 cursor-pointer ${(t==null?void 0:t.id)===i.id?"bg-cyan-500/10":""}`,onClick:()=>r(i),children:[e.jsx("td",{className:"px-4 py-3 text-white",children:i.name}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:j(i.file_size)}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:i.packet_count.toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:A(i.duration_seconds)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(C,{status:i.status})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:i.sessions_count}),e.jsx("td",{className:"px-4 py-3",children:i.alerts_count>0?e.jsx("span",{className:"text-red-400",children:i.alerts_count}):e.jsx("span",{className:"text-gray-500",children:"0"})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(i.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",onClick:v=>v.stopPropagation(),children:[i.status==="pending"&&e.jsx("button",{onClick:()=>x(i.id),className:"p-1 text-cyan-400 hover:text-cyan-300",title:"Analyze",children:e.jsx(ge,{size:16})}),e.jsx("button",{onClick:()=>h(i.id),className:"p-1 text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(F,{size:16})})]})})]},i.id))})]}),ve=({sessions:s,loading:a})=>a?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading sessions..."}):s.length===0?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"No sessions found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Source"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Destination"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Protocol"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Packets"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Bytes"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"State"})]})}),e.jsx("tbody",{children:s.map(t=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.session_type}),e.jsxs("td",{className:"px-4 py-3 text-white font-mono text-sm",children:[t.src_ip,":",t.src_port]}),e.jsxs("td",{className:"px-4 py-3 text-white font-mono text-sm",children:[t.dst_ip,":",t.dst_port]}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.application_protocol||t.protocol}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.packets}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:j(t.bytes_to_server+t.bytes_to_client)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(C,{status:t.state})})]},t.id))})]})}),we=({alerts:s,loading:a})=>a?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading alerts..."}):s.length===0?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"No IDS alerts found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Rule"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Message"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Source"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Destination"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Time"})]})}),e.jsx("tbody",{children:s.map(t=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(q,{severity:t.severity})}),e.jsx("td",{className:"px-4 py-3 text-gray-300 font-mono text-sm",children:t.rule_id}),e.jsx("td",{className:"px-4 py-3 text-white",children:t.message}),e.jsxs("td",{className:"px-4 py-3 text-white font-mono text-sm",children:[t.src_ip,":",t.src_port]}),e.jsxs("td",{className:"px-4 py-3 text-white font-mono text-sm",children:[t.dst_ip,":",t.dst_port]}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(t.timestamp).toLocaleString()})]},t.id))})]})}),Se=({files:s,loading:a})=>a?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading carved files..."}):s.length===0?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"No carved files found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Filename"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Size"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"SHA256"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Source"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Malicious"}),e.jsx("th",{className:"px-4 py-3 text-right text-gray-400 text-sm",children:"Actions"})]})}),e.jsx("tbody",{children:s.map(t=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 text-white",children:t.file_name||"Unknown"}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.mime_type}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:j(t.file_size)}),e.jsxs("td",{className:"px-4 py-3 text-gray-400 font-mono text-xs",children:[t.file_hash.slice(0,16),"..."]}),e.jsxs("td",{className:"px-4 py-3 text-white font-mono text-sm",children:[t.src_ip," → ",t.dst_ip]}),e.jsx("td",{className:"px-4 py-3",children:t.is_malicious?e.jsxs("span",{className:"text-red-400 flex items-center gap-1",children:[e.jsx(ue,{size:14})," Yes"]}):e.jsx("span",{className:"text-gray-500",children:"No"})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{className:"p-1 text-cyan-400 hover:text-cyan-300",title:"Download",children:e.jsx(je,{size:16})})})]},t.id))})]})}),_e=({queries:s,loading:a})=>a?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading DNS queries..."}):s.length===0?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"No DNS queries found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Query"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Response"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Answers"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"DGA Score"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Suspicious"})]})}),e.jsx("tbody",{children:s.map(t=>{var r;return e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 text-white font-mono text-sm",children:t.query_name}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.query_type}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.response_code||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:((r=t.answers)==null?void 0:r.slice(0,2).join(", "))||"-"}),e.jsx("td",{className:"px-4 py-3",children:t.dga_score!==void 0&&t.dga_score!==null?e.jsxs("span",{className:t.dga_score>.7?"text-red-400":t.dga_score>.4?"text-yellow-400":"text-gray-400",children:[(t.dga_score*100).toFixed(0),"%"]}):"-"}),e.jsx("td",{className:"px-4 py-3",children:t.is_suspicious?e.jsx("span",{className:"text-red-400",children:"Yes"}):e.jsx("span",{className:"text-gray-500",children:"No"})})]},t.id)})})]})}),Ce=({tlsInfo:s,loading:a})=>a?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading TLS info..."}):s.length===0?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"No TLS connections found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Server Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Version"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Cipher"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"JA3"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"JA3S"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Certificate"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Issues"})]})}),e.jsx("tbody",{children:s.map(t=>{var r,x,h;return e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 text-white",children:t.server_name||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.tls_version||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-300 text-sm",children:t.cipher_suite||"-"}),e.jsxs("td",{className:"px-4 py-3 text-gray-400 font-mono text-xs",children:[((r=t.ja3_fingerprint)==null?void 0:r.slice(0,12))||"-","..."]}),e.jsxs("td",{className:"px-4 py-3 text-gray-400 font-mono text-xs",children:[((x=t.ja3s_fingerprint)==null?void 0:x.slice(0,12))||"-","..."]}),e.jsx("td",{className:"px-4 py-3 text-gray-300 text-sm",children:((h=t.certificate_subject)==null?void 0:h.slice(0,30))||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[t.is_self_signed&&e.jsx("span",{className:"text-yellow-400 text-xs",children:"Self-signed"}),t.is_expired&&e.jsx("span",{className:"text-red-400 text-xs",children:"Expired"}),!t.is_self_signed&&!t.is_expired&&e.jsx("span",{className:"text-gray-500",children:"-"})]})})]},t.id)})})]})}),Le=({beacons:s,loading:a})=>a?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading beacons..."}):s.length===0?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"No beacons detected"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Source"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Destination"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Interval"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Jitter"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Connections"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Confidence"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Confirmed"})]})}),e.jsx("tbody",{children:s.map(t=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 text-white font-mono text-sm",children:t.src_ip}),e.jsxs("td",{className:"px-4 py-3 text-white font-mono text-sm",children:[t.dst_ip,":",t.dst_port]}),e.jsxs("td",{className:"px-4 py-3 text-gray-300",children:[t.interval_seconds,"s"]}),e.jsxs("td",{className:"px-4 py-3 text-gray-300",children:[t.jitter_percent.toFixed(1),"%"]}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.connection_count}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:t.confidence>.8?"text-red-400":t.confidence>.5?"text-yellow-400":"text-gray-400",children:[(t.confidence*100).toFixed(0),"%"]})}),e.jsx("td",{className:"px-4 py-3",children:t.is_confirmed?e.jsx(z,{size:16,className:"text-red-400"}):e.jsx(k,{size:16,className:"text-gray-500"})})]},t.id))})]})}),De=({rules:s,loading:a,onAdd:t,onDelete:r})=>a?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading rules..."}):e.jsxs("div",{children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-white font-medium",children:"Custom IDS Rules"}),e.jsxs("button",{onClick:t,className:"px-3 py-1.5 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2 text-sm",children:[e.jsx(fe,{size:14}),"Add Rule"]})]}),s.length===0?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"No custom rules defined. Add rules to detect specific traffic patterns."}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Content"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Enabled"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Created"}),e.jsx("th",{className:"px-4 py-3 text-right text-gray-400 text-sm",children:"Actions"})]})}),e.jsx("tbody",{children:s.map(x=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 text-white",children:x.name}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(q,{severity:x.severity})}),e.jsxs("td",{className:"px-4 py-3 text-gray-400 font-mono text-xs truncate max-w-xs",children:[x.content.slice(0,50),"..."]}),e.jsx("td",{className:"px-4 py-3",children:x.enabled?e.jsx(z,{size:16,className:"text-green-400"}):e.jsx(k,{size:16,className:"text-gray-500"})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(x.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{onClick:()=>r(x.id),className:"p-1 text-red-400 hover:text-red-300",title:"Delete",children:e.jsx(F,{size:16})})})]},x.id))})]})]}),Fe=({fingerprints:s,loading:a})=>a?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading fingerprints..."}):s.length===0?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"No fingerprints found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Fingerprint"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Known Client"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Hits"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"First Seen"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Last Seen"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Malicious"})]})}),e.jsx("tbody",{children:s.map(t=>e.jsxs("tr",{className:"border-t border-gray-700 hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 text-white font-mono text-xs",children:t.fingerprint}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.fingerprint_type}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.known_client||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.hits}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(t.first_seen).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(t.last_seen).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:t.is_malicious?e.jsx("span",{className:"text-red-400",children:"Yes"}):e.jsx("span",{className:"text-gray-500",children:"No"})})]},t.id))})]})});export{Te as default};
