import{j as e}from"./vendor-state-DdX3IZQk.js";import{r as t}from"./vendor-react-Da1CiaFS.js";import{d as _e,a5 as i}from"./index-lpqdgxD1.js";import{A as De,aR as Ae,Q as J,G as S,aD as V,Z as X,S as Y,ag as ee,n as se,aH as Se,P as ke,aQ as ze,m as Fe,N as Ce}from"./vendor-ui-wM19Qo8C.js";import"./vendor-charts-CCbxmwBt.js";const N={critical:"text-red-400 bg-red-900/30 border-red-600",high:"text-orange-400 bg-orange-900/30 border-orange-600",medium:"text-yellow-400 bg-yellow-900/30 border-yellow-600",low:"text-blue-400 bg-blue-900/30 border-blue-600",info:"text-gray-400 bg-gray-900/30 border-gray-600"},b={new:"text-blue-400 bg-blue-900/30",investigating:"text-yellow-400 bg-yellow-900/30",confirmed:"text-orange-400 bg-orange-900/30",resolved:"text-green-400 bg-green-900/30",false_positive:"text-gray-400 bg-gray-900/30",whitelisted:"text-gray-400 bg-gray-900/30"},Re={dga:"DGA Domain",tunneling:"DNS Tunneling",fast_flux:"Fast-Flux",exfiltration:"Data Exfiltration",high_entropy:"High Entropy",suspicious_tld:"Suspicious TLD",phishing:"Phishing"},c=l=>new Date(l).toLocaleString(),x=({icon:l,label:d,value:u,color:p="text-cyan-400",onClick:o})=>e.jsx("div",{className:`bg-gray-800 rounded-lg p-4 border border-gray-700 ${o?"cursor-pointer hover:border-cyan-600":""}`,onClick:o,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:p,children:l}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400",children:d}),e.jsx("div",{className:"text-2xl font-bold text-white",children:u})]})]})}),Le=()=>{var Q,H,Z,I,K,M;const[l,d]=t.useState("dashboard"),[u,p]=t.useState(!0),[o,k]=t.useState(null),[f,te]=t.useState(null),[v,ae]=t.useState(null),[n,le]=t.useState(null),[m,z]=t.useState(""),[F,re]=t.useState(""),[r,ie]=t.useState(null),[C,ne]=t.useState([]),[h,y]=t.useState(!1),[R,de]=t.useState([]),[E,ce]=t.useState([]),[T,xe]=t.useState([]),[G,oe]=t.useState([]),[P,me]=t.useState([]),[$,he]=t.useState([]),[w,ge]=t.useState(""),[_,pe]=t.useState(!1),[j,L]=t.useState(""),[W,B]=t.useState(""),q=async()=>{p(!0);try{const[s,a]=await Promise.all([i.get("/api/dns-analytics/stats"),i.get("/api/dns-analytics/dashboard")]);te(s.data.dns_stats),ae(s.data.nod_stats),le(a.data.db_stats),k(null)}catch(s){console.error("Failed to fetch dashboard:",s),k("Failed to load dashboard data")}finally{p(!1)}},O=async()=>{try{const s=await i.get("/api/dns-analytics/passive-dns",{params:{domain:w||void 0,limit:100}});de(s.data.records)}catch(s){console.error("Failed to fetch passive DNS:",s)}},ye=async()=>{try{const s=await i.get("/api/dns-analytics/anomalies",{params:{limit:100}});ce(s.data.anomalies)}catch(s){console.error("Failed to fetch anomalies:",s)}},je=async()=>{try{const s=await i.get("/api/dns-analytics/nods",{params:{limit:100}});xe(s.data.nods)}catch(s){console.error("Failed to fetch NODs:",s)}},U=async()=>{try{const s=await i.get("/api/dns-analytics/alerts",{params:{acknowledged:_?!1:void 0,limit:100}});oe(s.data.alerts)}catch(s){console.error("Failed to fetch alerts:",s)}},D=async()=>{try{const s=await i.get("/api/dns-analytics/whitelist");me(s.data.whitelist)}catch(s){console.error("Failed to fetch whitelist:",s)}},Ne=async()=>{try{const s=await i.get("/api/dns-analytics/dga-families");he(s.data.families)}catch(s){console.error("Failed to fetch DGA families:",s)}},A=async()=>{if(m.trim()){y(!0);try{const s=await i.post("/api/dns-analytics/analyze",{domain:m.trim()});ie(s.data)}catch(s){console.error("Failed to analyze domain:",s)}finally{y(!1)}}},be=async()=>{const s=F.split(`
`).map(a=>a.trim()).filter(a=>a);if(s.length!==0){y(!0);try{const a=await i.post("/api/dns-analytics/analyze/batch",{domains:s});ne(a.data.results)}catch(a){console.error("Failed to batch analyze:",a)}finally{y(!1)}}},ue=async s=>{try{await i.post(`/api/dns-analytics/alerts/${s}/acknowledge`),U()}catch(a){console.error("Failed to acknowledge alert:",a)}},fe=async()=>{if(j.trim())try{await i.post("/api/dns-analytics/whitelist",{domain:j.trim(),reason:W||void 0}),L(""),B(""),D()}catch(s){console.error("Failed to add to whitelist:",s)}},ve=async s=>{try{await i.delete(`/api/dns-analytics/whitelist/${s}`),D()}catch(a){console.error("Failed to remove from whitelist:",a)}};t.useEffect(()=>{q()},[]),t.useEffect(()=>{l==="passive"&&O(),l==="anomalies"&&ye(),l==="nods"&&je(),l==="alerts"&&U(),l==="whitelist"&&D(),l==="families"&&Ne()},[l,w,_]);const we=[{id:"dashboard",label:"Dashboard",icon:e.jsx(Fe,{size:16})},{id:"analyze",label:"Analyze",icon:e.jsx(ee,{size:16})},{id:"passive",label:"Passive DNS",icon:e.jsx(J,{size:16})},{id:"anomalies",label:"Anomalies",icon:e.jsx(V,{size:16})},{id:"nods",label:"NODs",icon:e.jsx(S,{size:16})},{id:"alerts",label:"Alerts",icon:e.jsx(X,{size:16})},{id:"whitelist",label:"Whitelist",icon:e.jsx(Y,{size:16})},{id:"families",label:"DGA Families",icon:e.jsx(Ce,{size:16})}];return e.jsx(_e,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(De,{className:"text-cyan-400"}),"DNS Analytics"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"DNS security analytics, DGA detection, and threat intelligence"})]}),e.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:[e.jsx(Ae,{size:16}),"Refresh"]})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:we.map(s=>e.jsxs("button",{onClick:()=>d(s.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${l===s.id?"bg-cyan-600 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:[s.icon,s.label]},s.id))}),o&&e.jsx("div",{className:"bg-red-900/30 border border-red-600 rounded-lg p-4 text-red-400",children:o}),l==="dashboard"&&e.jsx("div",{className:"space-y-6",children:u?e.jsx("div",{className:"text-center text-gray-400 py-8",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsx(x,{icon:e.jsx(J,{size:24}),label:"Passive DNS Records",value:(n==null?void 0:n.passive_dns_records)||0,color:"text-blue-400"}),e.jsx(x,{icon:e.jsx(S,{size:24}),label:"Unique Domains",value:(f==null?void 0:f.unique_domains)||0,color:"text-cyan-400"}),e.jsx(x,{icon:e.jsx(V,{size:24}),label:"Anomalies",value:(n==null?void 0:n.anomalies)||0,color:"text-orange-400",onClick:()=>d("anomalies")}),e.jsx(x,{icon:e.jsx(S,{size:24}),label:"NODs",value:(n==null?void 0:n.newly_observed_domains)||0,color:"text-purple-400",onClick:()=>d("nods")}),e.jsx(x,{icon:e.jsx(X,{size:24}),label:"Unacked Alerts",value:(n==null?void 0:n.unacknowledged_alerts)||0,color:"text-red-400",onClick:()=>d("alerts")}),e.jsx(x,{icon:e.jsx(Y,{size:24}),label:"High Risk NODs",value:(v==null?void 0:v.high_risk_nods)||0,color:"text-red-400"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(ee,{className:"text-cyan-400"}),"Quick Domain Analysis"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{type:"text",value:m,onChange:s=>z(s.target.value),placeholder:"Enter domain to analyze (e.g., suspicious-domain.com)",className:"flex-1 bg-gray-700 text-white rounded-lg px-4 py-2 focus:ring-2 focus:ring-cyan-500 outline-none",onKeyPress:s=>s.key==="Enter"&&A()}),e.jsxs("button",{onClick:A,disabled:h||!m.trim(),className:"px-6 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx(se,{size:16}),"Analyze"]})]}),r&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-900 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-mono text-cyan-400",children:r.domain}),r.is_dga?e.jsxs("span",{className:"px-2 py-1 bg-red-900/30 text-red-400 rounded text-sm",children:["DGA Detected (",((r.dga_probability||0)*100).toFixed(1),"%)"]}):e.jsx("span",{className:"px-2 py-1 bg-green-900/30 text-green-400 rounded text-sm",children:"Clean"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Entropy:"})," ",e.jsx("span",{className:"text-white",children:((Q=r.entropy)==null?void 0:Q.toFixed(2))||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"DGA Family:"})," ",e.jsx("span",{className:"text-white",children:((H=r.dga_analysis)==null?void 0:H.detected_family)||"None"})]})]}),r.threat_indicators.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:r.threat_indicators.map((s,a)=>e.jsx("span",{className:"px-2 py-1 bg-orange-900/30 text-orange-400 rounded text-xs",children:s},a))})]})]})]})}),l==="analyze"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Single Domain Analysis"}),e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsx("input",{type:"text",value:m,onChange:s=>z(s.target.value),placeholder:"Enter domain...",className:"flex-1 bg-gray-700 text-white rounded-lg px-4 py-2 focus:ring-2 focus:ring-cyan-500 outline-none"}),e.jsx("button",{onClick:A,disabled:h,className:"px-6 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 disabled:opacity-50",children:h?"Analyzing...":"Analyze"})]}),r&&e.jsxs("div",{className:"p-4 bg-gray-900 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"font-mono text-xl text-cyan-400",children:r.domain}),r.is_dga?e.jsx("span",{className:"px-3 py-1 bg-red-900/50 text-red-400 rounded-lg font-semibold",children:"DGA DETECTED"}):e.jsx("span",{className:"px-3 py-1 bg-green-900/50 text-green-400 rounded-lg font-semibold",children:"CLEAN"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded p-3",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"DGA Probability"}),e.jsxs("div",{className:"text-white text-lg font-bold",children:[((r.dga_probability||0)*100).toFixed(1),"%"]})]}),e.jsxs("div",{className:"bg-gray-800 rounded p-3",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Entropy"}),e.jsx("div",{className:"text-white text-lg font-bold",children:((Z=r.entropy)==null?void 0:Z.toFixed(3))||"N/A"})]}),e.jsxs("div",{className:"bg-gray-800 rounded p-3",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Consonant Ratio"}),e.jsx("div",{className:"text-white text-lg font-bold",children:(((I=r.dga_analysis)==null?void 0:I.consonant_ratio)||0).toFixed(2)})]}),e.jsxs("div",{className:"bg-gray-800 rounded p-3",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Digit Ratio"}),e.jsx("div",{className:"text-white text-lg font-bold",children:(((K=r.dga_analysis)==null?void 0:K.digit_ratio)||0).toFixed(2)})]})]}),((M=r.dga_analysis)==null?void 0:M.detected_family)&&e.jsx("div",{className:"mt-4 p-3 bg-red-900/20 rounded-lg border border-red-700",children:e.jsxs("span",{className:"text-red-400",children:["Detected DGA Family: ",e.jsx("strong",{children:r.dga_analysis.detected_family})]})}),r.threat_indicators.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-2",children:"Threat Indicators"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.threat_indicators.map((s,a)=>e.jsx("span",{className:"px-3 py-1 bg-orange-900/30 text-orange-400 rounded",children:s},a))})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Batch Domain Analysis"}),e.jsx("textarea",{value:F,onChange:s=>re(s.target.value),placeholder:"Enter domains (one per line)...",className:"w-full h-32 bg-gray-700 text-white rounded-lg px-4 py-2 focus:ring-2 focus:ring-cyan-500 outline-none font-mono"}),e.jsx("button",{onClick:be,disabled:h,className:"mt-4 px-6 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 disabled:opacity-50",children:h?"Analyzing...":"Analyze All"}),C.length>0&&e.jsx("div",{className:"mt-4 space-y-2",children:C.map((s,a)=>{var g;return e.jsx("div",{className:`p-3 rounded-lg border ${s.is_dga?"bg-red-900/20 border-red-700":"bg-gray-900 border-gray-700"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-mono text-cyan-400",children:s.domain}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-gray-400 text-sm",children:["Entropy: ",(g=s.entropy)==null?void 0:g.toFixed(2)]}),s.is_dga?e.jsxs("span",{className:"text-red-400 text-sm",children:["DGA (",((s.dga_probability||0)*100).toFixed(0),"%)"]}):e.jsx("span",{className:"text-green-400 text-sm",children:"Clean"})]})]})},a)})})]})]}),l==="passive"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx("input",{type:"text",value:w,onChange:s=>ge(s.target.value),placeholder:"Filter by domain...",className:"flex-1 bg-gray-700 text-white rounded-lg px-4 py-2 focus:ring-2 focus:ring-cyan-500 outline-none"}),e.jsx("button",{onClick:O,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-500",children:e.jsx(se,{size:16})})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Domain"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Response"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Queries"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Last Seen"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Status"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700",children:[R.map(s=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 font-mono text-cyan-400",children:s.query_name}),e.jsx("td",{className:"px-4 py-3 text-white",children:s.query_type}),e.jsx("td",{className:"px-4 py-3 text-gray-300 font-mono text-sm truncate max-w-xs",children:s.response_data}),e.jsx("td",{className:"px-4 py-3 text-white",children:s.query_count}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:c(s.last_seen)}),e.jsx("td",{className:"px-4 py-3",children:s.is_suspicious?e.jsx("span",{className:"px-2 py-1 bg-red-900/30 text-red-400 rounded text-xs",children:"Suspicious"}):e.jsx("span",{className:"px-2 py-1 bg-green-900/30 text-green-400 rounded text-xs",children:"Normal"})})]},s.id)),R.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:"No passive DNS records found"})})]})]})})]}),l==="anomalies"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Domain"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"First Seen"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Description"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700",children:[E.map(s=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 font-mono text-cyan-400",children:s.domain}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 bg-purple-900/30 text-purple-400 rounded text-xs",children:Re[s.anomaly_type]||s.anomaly_type})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs border ${N[s.severity]||N.info}`,children:s.severity.toUpperCase()})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${b[s.status]||b.new}`,children:s.status})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:c(s.first_seen)}),e.jsx("td",{className:"px-4 py-3 text-gray-300 text-sm truncate max-w-md",children:s.description})]},s.id)),E.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:"No anomalies detected"})})]})]})})}),l==="nods"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Domain"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"TLD"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Risk Score"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Threat Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"First Seen"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Queries"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700",children:[T.map(s=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 font-mono text-cyan-400",children:s.domain}),e.jsxs("td",{className:"px-4 py-3 text-gray-300",children:[".",s.tld]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-12 h-2 rounded-full ${s.risk_score>=70?"bg-red-500":s.risk_score>=40?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.max(s.risk_score,10)}%`}}),e.jsx("span",{className:"text-white",children:s.risk_score})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${b[s.status]||b.new}`,children:s.status})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.threat_type||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:c(s.first_seen)}),e.jsx("td",{className:"px-4 py-3 text-white",children:s.query_count})]},s.id)),T.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No newly observed domains found"})})]})]})})}),l==="alerts"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("label",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx("input",{type:"checkbox",checked:_,onChange:s=>pe(s.target.checked),className:"rounded bg-gray-700 border-gray-600 text-cyan-500"}),"Show only unacknowledged"]})}),e.jsxs("div",{className:"space-y-4",children:[G.map(s=>e.jsxs("div",{className:`bg-gray-800 rounded-lg p-4 border ${s.acknowledged?"border-gray-700":"border-red-600"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs border ${N[s.severity]||N.info}`,children:s.severity.toUpperCase()}),e.jsx("span",{className:"font-mono text-cyan-400",children:s.domain})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-gray-400 text-sm",children:["Risk Score: ",e.jsx("strong",{className:"text-white",children:s.risk_score})]}),!s.acknowledged&&e.jsxs("button",{onClick:()=>ue(s.id),className:"flex items-center gap-1 px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 text-sm",children:[e.jsx(Se,{size:14}),"Acknowledge"]})]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:[s.threat_type&&e.jsxs("span",{className:"mr-4",children:["Threat: ",s.threat_type]}),e.jsxs("span",{children:["First seen: ",c(s.first_seen)]}),s.source_ip&&e.jsxs("span",{className:"ml-4",children:["Source: ",s.source_ip]})]}),s.acknowledged&&e.jsxs("div",{className:"mt-2 text-xs text-green-400",children:["Acknowledged by ",s.acknowledged_by," at ",c(s.acknowledged_at||"")]})]},s.id)),G.length===0&&e.jsx("div",{className:"text-center text-gray-500 py-8",children:"No alerts found"})]})]}),l==="whitelist"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"Add Domain to Whitelist"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{type:"text",value:j,onChange:s=>L(s.target.value),placeholder:"Domain (e.g., example.com)",className:"flex-1 bg-gray-700 text-white rounded-lg px-4 py-2 focus:ring-2 focus:ring-cyan-500 outline-none"}),e.jsx("input",{type:"text",value:W,onChange:s=>B(s.target.value),placeholder:"Reason (optional)",className:"flex-1 bg-gray-700 text-white rounded-lg px-4 py-2 focus:ring-2 focus:ring-cyan-500 outline-none"}),e.jsxs("button",{onClick:fe,disabled:!j.trim(),className:"px-6 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 disabled:opacity-50 flex items-center gap-2",children:[e.jsx(ke,{size:16}),"Add"]})]})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Domain"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Reason"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Scope"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Added"}),e.jsx("th",{className:"px-4 py-3 text-left text-gray-400 text-sm",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700",children:[P.map(s=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 font-mono text-cyan-400",children:s.domain}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.domain_type}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:s.reason||"-"}),e.jsx("td",{className:"px-4 py-3",children:s.is_global?e.jsx("span",{className:"px-2 py-1 bg-purple-900/30 text-purple-400 rounded text-xs",children:"Global"}):e.jsx("span",{className:"px-2 py-1 bg-gray-900/30 text-gray-400 rounded text-xs",children:"Personal"})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:c(s.created_at)}),e.jsx("td",{className:"px-4 py-3",children:!s.is_global&&e.jsx("button",{onClick:()=>ve(s.id),className:"text-red-400 hover:text-red-300",children:e.jsx(ze,{size:16})})})]},s.id)),P.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:"No whitelist entries"})})]})]})})]}),l==="families"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[$.map(s=>{var a,g;return e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-white font-semibold",children:s.family_name}),s.is_builtin?e.jsx("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-400 rounded text-xs",children:"Built-in"}):e.jsx("span",{className:"px-2 py-1 bg-green-900/30 text-green-400 rounded text-xs",children:"Custom"})]}),s.description&&e.jsx("p",{className:"text-gray-400 text-sm mb-3",children:s.description}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Length Range:"}),e.jsxs("span",{className:"text-white",children:[s.length_min||"?"," - ",s.length_max||"?"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Entropy Range:"}),e.jsxs("span",{className:"text-white",children:[((a=s.entropy_min)==null?void 0:a.toFixed(2))||"?"," - ",((g=s.entropy_max)==null?void 0:g.toFixed(2))||"?"]})]}),s.tld_patterns&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"TLDs:"}),e.jsx("span",{className:"text-white",children:s.tld_patterns})]})]}),s.example_domains&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-700",children:[e.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"Examples:"}),e.jsx("div",{className:"font-mono text-xs text-cyan-400",children:s.example_domains})]})]},s.id)}),$.length===0&&e.jsx("div",{className:"col-span-full text-center text-gray-500 py-8",children:"No DGA families configured"})]})})]})})};export{Le as default};
