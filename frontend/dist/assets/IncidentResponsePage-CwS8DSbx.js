import{b as R,u as N,d as $,j as e}from"./vendor-state-DdX3IZQk.js";import{r as u,R as z}from"./vendor-react-Da1CiaFS.js";import{au as S,P as T,aI as k,Z as O,ak as j,ay as Q,aa as q,a7 as A,B as v,ah as H,aw as L}from"./vendor-ui-ClyGCaTH.js";import{d as Z,a5 as d}from"./index-DdN2WEEf.js";import"./vendor-charts-IB765B33.js";const p={getDashboard:()=>d.get("/incidents/dashboard").then(s=>s.data),listIncidents:s=>d.get("/incidents",{params:s}).then(t=>t.data),createIncident:s=>d.post("/incidents",s).then(t=>t.data),getIncident:s=>d.get(`/incidents/${s}`).then(t=>t.data),updateIncident:(s,t)=>d.put(`/incidents/${s}`,t).then(i=>i.data),transitionIncident:(s,t,i)=>d.post(`/incidents/${s}/transition`,{status:t,notes:i}).then(n=>n.data),assignIncident:(s,t)=>d.post(`/incidents/${s}/assign`,{user_id:t}).then(i=>i.data),getTimeline:s=>d.get(`/incidents/${s}/timeline`).then(t=>t.data),addTimelineEvent:(s,t)=>d.post(`/incidents/${s}/timeline`,t).then(i=>i.data),listEvidence:s=>d.get(`/incidents/${s}/evidence`).then(t=>t.data),addEvidence:(s,t)=>d.post(`/incidents/${s}/evidence`,t).then(i=>i.data),listPlaybooks:()=>d.get("/incidents/playbooks").then(s=>s.data),createPlaybook:s=>d.post("/incidents/playbooks",s).then(t=>t.data),activatePlaybook:(s,t)=>d.post(`/incidents/${s}/playbooks/${t}/activate`).then(i=>i.data),listActions:s=>d.get(`/incidents/${s}/actions`).then(t=>t.data),createAction:(s,t)=>d.post(`/incidents/${s}/actions`,t).then(i=>i.data),approveAction:(s,t)=>d.post(`/incidents/${s}/actions/${t}/approve`).then(i=>i.data),completeAction:(s,t,i)=>d.post(`/incidents/${s}/actions/${t}/complete`,{result:i}).then(n=>n.data)},M={p1:{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500"},p2:{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500"},p3:{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500"},p4:{bg:"bg-blue-500/20",text:"text-blue-400",border:"border-blue-500"}},E={detected:{bg:"bg-red-500/20",text:"text-red-400"},triaged:{bg:"bg-orange-500/20",text:"text-orange-400"},contained:{bg:"bg-yellow-500/20",text:"text-yellow-400"},eradicated:{bg:"bg-cyan-500/20",text:"text-cyan-400"},recovered:{bg:"bg-green-500/20",text:"text-green-400"},closed:{bg:"bg-gray-500/20",text:"text-gray-400"}},B={pending:{bg:"bg-gray-500/20",text:"text-gray-400"},pending_approval:{bg:"bg-orange-500/20",text:"text-orange-400"},approved:{bg:"bg-cyan-500/20",text:"text-cyan-400"},in_progress:{bg:"bg-yellow-500/20",text:"text-yellow-400"},completed:{bg:"bg-green-500/20",text:"text-green-400"},failed:{bg:"bg-red-500/20",text:"text-red-400"}};function D({severity:s}){const t=M[s.toLowerCase()]||M.p4;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${t.bg} ${t.text} border ${t.border}`,children:s.toUpperCase()})}function P({status:s}){const t=E[s.toLowerCase()]||E.detected;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.bg} ${t.text}`,children:s.charAt(0).toUpperCase()+s.slice(1)})}function G({status:s}){const t=B[s.toLowerCase()]||B.pending;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.bg} ${t.text}`,children:s.replace(/_/g," ").replace(/\b\w/g,i=>i.toUpperCase())})}const K=({isOpen:s,onClose:t,title:i,children:n,size:c="md"})=>{if(!s)return null;const x={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:t}),e.jsxs("div",{className:`relative bg-gray-800 border border-gray-700 rounded-lg shadow-xl w-full ${x[c]} max-h-[90vh] overflow-y-auto mx-4`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 sticky top-0 bg-gray-800 z-10",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:i}),e.jsx("button",{onClick:t,className:"p-1 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-white",children:e.jsx(H,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4",children:n})]})]})},V=({onSubmit:s,onCancel:t,isLoading:i})=>{const[n,c]=u.useState({title:"",description:"",severity:"p3",classification:"",affected_systems:""}),x=l=>{l.preventDefault(),s({...n,affected_systems:n.affected_systems?n.affected_systems.split(",").map(m=>m.trim()):[]})};return e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Title *"}),e.jsx("input",{type:"text",required:!0,value:n.title,onChange:l=>c({...n,title:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Brief incident title..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:n.description,onChange:l=>c({...n,description:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",rows:3,placeholder:"Detailed incident description..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Severity *"}),e.jsxs("select",{value:n.severity,onChange:l=>c({...n,severity:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"p1",children:"P1 - Critical (Business Impact)"}),e.jsx("option",{value:"p2",children:"P2 - High (Major Disruption)"}),e.jsx("option",{value:"p3",children:"P3 - Medium (Limited Impact)"}),e.jsx("option",{value:"p4",children:"P4 - Low (Minimal Impact)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Classification"}),e.jsxs("select",{value:n.classification,onChange:l=>c({...n,classification:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"",children:"Select classification..."}),e.jsx("option",{value:"malware",children:"Malware"}),e.jsx("option",{value:"phishing",children:"Phishing"}),e.jsx("option",{value:"ransomware",children:"Ransomware"}),e.jsx("option",{value:"data_breach",children:"Data Breach"}),e.jsx("option",{value:"unauthorized_access",children:"Unauthorized Access"}),e.jsx("option",{value:"dos",children:"Denial of Service"}),e.jsx("option",{value:"insider_threat",children:"Insider Threat"}),e.jsx("option",{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Affected Systems"}),e.jsx("input",{type:"text",value:n.affected_systems,onChange:l=>c({...n,affected_systems:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"server1.example.com, db-prod-01 (comma-separated)"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:t,disabled:i,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors disabled:opacity-50",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors disabled:opacity-50 flex items-center gap-2",children:[i&&e.jsx(k,{className:"w-4 h-4 animate-spin"}),"Declare Incident"]})]})]})},X=({incident:s,onClose:t})=>{const i=R(),[n,c]=u.useState("details"),[x,l]=u.useState(""),{data:m}=N({queryKey:["incident-timeline",s.id],queryFn:()=>p.getTimeline(s.id)}),{data:b}=N({queryKey:["incident-evidence",s.id],queryFn:()=>p.listEvidence(s.id)}),{data:h}=N({queryKey:["incident-actions",s.id],queryFn:()=>p.listActions(s.id)}),w=$({mutationFn:({status:a,notes:g})=>p.transitionIncident(s.id,a,g),onSuccess:()=>{i.invalidateQueries({queryKey:["incidents"]}),i.invalidateQueries({queryKey:["incident-timeline",s.id]}),v.success("Incident status updated")},onError:()=>v.error("Failed to update incident status")}),o=$({mutationFn:a=>p.addTimelineEvent(s.id,a),onSuccess:()=>{i.invalidateQueries({queryKey:["incident-timeline",s.id]}),l(""),v.success("Timeline event added")},onError:()=>v.error("Failed to add event")}),y=(a=>({detected:"triaged",triaged:"contained",contained:"eradicated",eradicated:"recovered",recovered:"closed"})[a]||null)(s.status);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-gray-500 font-mono text-sm",children:s.incident_number}),e.jsx(D,{severity:s.severity}),e.jsx(P,{status:s.status})]}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:s.title})]}),y&&s.status!=="closed"&&e.jsxs("button",{onClick:()=>w.mutate({status:y}),disabled:w.isPending,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4"}),"Move to ",y.charAt(0).toUpperCase()+y.slice(1)]})]}),e.jsx("div",{className:"flex items-center gap-1 p-4 bg-gray-900 rounded-lg",children:["detected","triaged","contained","eradicated","recovered","closed"].map((a,g,C)=>{const _=s.status===a,I=C.indexOf(s.status)>g;return e.jsxs(z.Fragment,{children:[e.jsx("div",{className:`flex-1 h-2 rounded-full ${_?"bg-cyan-500":I?"bg-green-500":"bg-gray-700"}`}),g<C.length-1&&e.jsx(L,{className:"w-4 h-4 text-gray-600"})]},a)})}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:["details","timeline","evidence","actions"].map(a=>e.jsxs("button",{onClick:()=>c(a),className:`px-3 py-2 border-b-2 transition-colors text-sm ${n===a?"border-cyan-500 text-cyan-500":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[a.charAt(0).toUpperCase()+a.slice(1),a==="timeline"&&m&&e.jsxs("span",{className:"ml-1 text-gray-500",children:["(",m.length,")"]}),a==="evidence"&&b&&e.jsxs("span",{className:"ml-1 text-gray-500",children:["(",b.length,")"]}),a==="actions"&&h&&e.jsxs("span",{className:"ml-1 text-gray-500",children:["(",h.length,")"]})]},a))})}),e.jsxs("div",{className:"min-h-[300px]",children:[n==="details"&&e.jsxs("div",{className:"space-y-4",children:[s.description&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Description"}),e.jsx("p",{className:"text-gray-300 mt-1",children:s.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Classification"}),e.jsx("p",{className:"text-white mt-1",children:s.classification||"Not classified"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Source"}),e.jsx("p",{className:"text-white mt-1",children:s.source||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Detected At"}),e.jsx("p",{className:"text-white mt-1",children:new Date(s.detected_at).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Assigned To"}),e.jsx("p",{className:"text-white mt-1",children:s.assigned_to||"Unassigned"})]})]}),s.affected_systems.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Affected Systems"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s.affected_systems.map((a,g)=>e.jsx("span",{className:"px-2 py-0.5 bg-red-500/20 text-red-400 rounded text-xs",children:a},g))})]})]}),n==="timeline"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:x,onChange:a=>l(a.target.value),className:"flex-1 px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",placeholder:"Add timeline event..."}),e.jsx("button",{onClick:()=>{x.trim()&&o.mutate({event_type:"note",title:x,occurred_at:new Date().toISOString()})},disabled:!x.trim()||o.isPending,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg disabled:opacity-50",children:"Add"})]}),e.jsx("div",{className:"space-y-2",children:m&&m.length>0?m.map(a=>e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-cyan-500 rounded-full mt-2"}),e.jsx("div",{className:"flex-1 w-px bg-gray-700"})]}),e.jsxs("div",{className:"pb-4 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-1",children:[e.jsx(j,{className:"w-3 h-3"}),new Date(a.occurred_at).toLocaleString(),e.jsx("span",{className:"px-1.5 py-0.5 bg-gray-700 rounded",children:a.event_type})]}),e.jsx("p",{className:"text-white font-medium",children:a.title}),a.description&&e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:a.description})]})]},a.id)):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(j,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No timeline events yet"})]})})]}),n==="evidence"&&e.jsx("div",{className:"space-y-2",children:b&&b.length>0?b.map(a=>e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:a.name}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:a.evidence_type}),a.description&&e.jsx("p",{className:"text-gray-500 text-sm",children:a.description})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(a.collected_at).toLocaleString()})]}),a.chain_of_custody.length>0&&e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-700",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Chain of Custody: ",a.chain_of_custody.length," records"]})})]},a.id)):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(A,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No evidence collected"})]})}),n==="actions"&&e.jsx("div",{className:"space-y-2",children:h&&h.length>0?h.map(a=>e.jsx("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-white font-medium",children:a.title}),e.jsx(G,{status:a.status})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:a.action_type}),a.description&&e.jsx("p",{className:"text-gray-500 text-sm",children:a.description})]}),a.requires_approval&&!a.approved_at&&e.jsx("span",{className:"px-2 py-0.5 bg-orange-500/20 text-orange-400 rounded text-xs",children:"Needs Approval"})]})},a.id)):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(O,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No response actions"})]})})]})]})};function te(){const s=R(),[t,i]=u.useState("dashboard"),[n,c]=u.useState(!1),[x,l]=u.useState(null),[m,b]=u.useState(""),[h,w]=u.useState(""),{data:o,isLoading:F}=N({queryKey:["incident-dashboard"],queryFn:()=>p.getDashboard(),enabled:t==="dashboard"}),{data:y,isLoading:a}=N({queryKey:["incidents",m,h],queryFn:()=>{const r={};return m&&(r.status=m),h&&(r.severity=h),p.listIncidents(r)},enabled:t==="incidents"}),{data:g,isLoading:C}=N({queryKey:["ir-playbooks"],queryFn:()=>p.listPlaybooks(),enabled:t==="playbooks"}),_=$({mutationFn:p.createIncident,onSuccess:()=>{s.invalidateQueries({queryKey:["incidents"]}),s.invalidateQueries({queryKey:["incident-dashboard"]}),c(!1),v.success("Incident declared")},onError:()=>v.error("Failed to create incident")}),I=[{id:"dashboard",label:"Dashboard",icon:e.jsx(q,{className:"w-4 h-4"})},{id:"incidents",label:"Incidents",icon:e.jsx(S,{className:"w-4 h-4"})},{id:"timeline",label:"Timeline",icon:e.jsx(j,{className:"w-4 h-4"})},{id:"playbooks",label:"Playbooks",icon:e.jsx(A,{className:"w-4 h-4"})}];return e.jsx(Z,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(S,{className:"w-8 h-8 text-red-500"}),"Incident Response"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage security incidents from detection to resolution"})]}),e.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[e.jsx(T,{className:"w-4 h-4"}),"Declare Incident"]})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:I.map(r=>e.jsxs("button",{onClick:()=>i(r.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${t===r.id?"border-cyan-500 text-cyan-500":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[r.icon,r.label]},r.id))})}),e.jsxs("div",{children:[t==="dashboard"&&e.jsx("div",{className:"space-y-6",children:F?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(k,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-red-500/20 rounded-lg",children:e.jsx(S,{className:"w-6 h-6 text-red-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:o.open_incidents}),e.jsx("p",{className:"text-xs text-gray-400",children:"Open Incidents"})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-orange-500/20 rounded-lg",children:e.jsx(O,{className:"w-6 h-6 text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:o.p1_active+o.p2_active}),e.jsx("p",{className:"text-xs text-gray-400",children:"P1/P2 Active"})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-cyan-500/20 rounded-lg",children:e.jsx(j,{className:"w-6 h-6 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:o.mttr_hours<1?`${Math.round(o.mttr_hours*60)}m`:`${o.mttr_hours.toFixed(1)}h`}),e.jsx("p",{className:"text-xs text-gray-400",children:"Avg MTTR"})]})]})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-green-500/20 rounded-lg",children:e.jsx(Q,{className:"w-6 h-6 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:o.total_incidents}),e.jsx("p",{className:"text-xs text-gray-400",children:"Total Incidents"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"By Status"}),e.jsx("div",{className:"space-y-3",children:Object.entries(o.by_status||{}).map(([r,f])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(P,{status:r})}),e.jsx("span",{className:"text-white font-medium",children:f})]},r))})]}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"By Severity"}),e.jsx("div",{className:"space-y-3",children:Object.entries(o.by_severity||{}).map(([r,f])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(D,{severity:r})}),e.jsx("span",{className:"text-white font-medium",children:f})]},r))})]})]})]}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(q,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Dashboard Data"}),e.jsx("p",{className:"text-gray-400",children:"Start tracking incidents to see metrics"})]})}),t==="incidents"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:m,onChange:r=>b(r.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"detected",children:"Detected"}),e.jsx("option",{value:"triaged",children:"Triaged"}),e.jsx("option",{value:"contained",children:"Contained"}),e.jsx("option",{value:"eradicated",children:"Eradicated"}),e.jsx("option",{value:"recovered",children:"Recovered"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsxs("select",{value:h,onChange:r=>w(r.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Severities"}),e.jsx("option",{value:"p1",children:"P1 - Critical"}),e.jsx("option",{value:"p2",children:"P2 - High"}),e.jsx("option",{value:"p3",children:"P3 - Medium"}),e.jsx("option",{value:"p4",children:"P4 - Low"})]})]}),a?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(k,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):y&&y.length>0?e.jsx("div",{className:"space-y-3",children:y.map(r=>e.jsx("div",{onClick:()=>l(r),className:"bg-gray-800 border border-gray-700 rounded-lg p-4 hover:border-gray-600 cursor-pointer transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-gray-500 font-mono text-sm",children:r.incident_number}),e.jsx(D,{severity:r.severity}),e.jsx(P,{status:r.status})]}),e.jsx("h3",{className:"text-lg font-medium text-white",children:r.title}),r.description&&e.jsx("p",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:r.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"w-3 h-3"}),new Date(r.detected_at).toLocaleString()]}),r.classification&&e.jsx("span",{children:r.classification.replace(/_/g," ")})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:r.affected_systems.length>0&&e.jsxs("span",{className:"text-xs text-gray-500",children:[r.affected_systems.length," systems"]})})]})},r.id))}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(S,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Incidents"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"No security incidents matching your filters"}),e.jsxs("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[e.jsx(T,{className:"w-4 h-4 inline mr-2"}),"Declare Incident"]})]})]}),t==="playbooks"&&e.jsx("div",{className:"space-y-4",children:C?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(k,{className:"w-8 h-8 text-cyan-500 animate-spin"})}):g&&g.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:g.map(r=>e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:r.name}),r.description&&e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:r.description})]}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${r.is_active?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:r.is_active?"Active":"Inactive"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:r.incident_types.map((f,U)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs",children:f},U))}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[e.jsxs("span",{children:[r.steps.length," steps"]}),e.jsxs("span",{children:["v",r.version]})]})]},r.id))}):e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(A,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Playbooks"}),e.jsx("p",{className:"text-gray-400",children:"Create incident response playbooks to standardize your processes"})]})}),t==="timeline"&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-12 text-center",children:[e.jsx(j,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"Global Timeline"}),e.jsx("p",{className:"text-gray-400",children:"Select an incident to view its timeline"})]})]}),e.jsx(K,{isOpen:n,onClose:()=>c(!1),title:"Declare Security Incident",children:e.jsx(V,{onSubmit:r=>_.mutate(r),onCancel:()=>c(!1),isLoading:_.isPending})}),e.jsx(K,{isOpen:!!x,onClose:()=>l(null),title:"Incident Details",size:"lg",children:x&&e.jsx(X,{incident:x,onClose:()=>l(null)})})]})})}export{te as default};
