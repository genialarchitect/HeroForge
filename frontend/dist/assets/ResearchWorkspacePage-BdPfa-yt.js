import{b as ve,u as A,d as O,j as e}from"./vendor-state-DdX3IZQk.js";import{r as l}from"./vendor-react-Da1CiaFS.js";import{B as o,P as G,n as fe,aA as we,aR as k,D as Y,S as ke,F as I,y as C,z as _,aF as Ce,bM as _e,aN as Z,aQ as H,at as P,b0 as Se,aI as b,bk as Le,bu as Re,cd as J}from"./vendor-ui-CODyzv19.js";import{ai as m,d as Ee}from"./index-BZ6s10K7.js";import"./vendor-charts-ClOpvfwV.js";const E={active:"bg-green-500/10 text-green-500 border-green-500/20",in_progress:"bg-blue-500/10 text-blue-500 border-blue-500/20",archived:"bg-gray-500/10 text-gray-400 border-gray-500/20",completed:"bg-purple-500/10 text-purple-500 border-purple-500/20"},X={analysis:"bg-blue-500/10 text-blue-500",poc_notes:"bg-green-500/10 text-green-500",mitigation:"bg-yellow-500/10 text-yellow-500",reference:"bg-purple-500/10 text-purple-500",general:"bg-gray-500/10 text-gray-400"},We={created:e.jsx(Y,{className:"h-4 w-4 text-green-500"}),note_added:e.jsx(I,{className:"h-4 w-4 text-blue-500"}),exploit_linked:e.jsx(C,{className:"h-4 w-4 text-red-500"}),poc_linked:e.jsx(_,{className:"h-4 w-4 text-cyan-500"}),status_changed:e.jsx(k,{className:"h-4 w-4 text-yellow-500"}),exported:e.jsx(Z,{className:"h-4 w-4 text-purple-500"})},Ie=()=>{var $,U;const v=ve(),[ee,S]=l.useState("list"),[d,L]=l.useState(null),[y,M]=l.useState("overview"),[f,se]=l.useState(""),[R,te]=l.useState("all"),[ae,W]=l.useState(!1),[re,q]=l.useState(!1),[le,Q]=l.useState(null),{data:D,isLoading:ie,refetch:ce}=A({queryKey:["research-workspaces"],queryFn:()=>m.listWorkspaces()}),{data:T,isLoading:ne}=A({queryKey:["research-workspace",d],queryFn:()=>d?m.getWorkspace(d):null,enabled:!!d}),{data:F,isLoading:oe}=A({queryKey:["workspace-timeline",d],queryFn:()=>d?m.getWorkspaceTimeline(d):null,enabled:!!d&&y==="timeline"}),de=(($=D==null?void 0:D.data)==null?void 0:$.workspaces)||[],a=T==null?void 0:T.data,V=((U=F==null?void 0:F.data)==null?void 0:U.events)||[],K=de.filter(s=>{var c;const r=f===""||s.cve_id.toLowerCase().includes(f.toLowerCase())||s.title.toLowerCase().includes(f.toLowerCase())||((c=s.description)==null?void 0:c.toLowerCase().includes(f.toLowerCase())),i=R==="all"||s.status===R;return r&&i}),xe=O({mutationFn:s=>m.deleteWorkspace(s),onSuccess:()=>{o.success("Workspace deleted"),v.invalidateQueries({queryKey:["research-workspaces"]}),d&&(L(null),S("list"))},onError:()=>o.error("Failed to delete workspace")}),me=O({mutationFn:({id:s,data:r})=>m.updateWorkspace(s,r),onSuccess:()=>{o.success("Workspace updated"),v.invalidateQueries({queryKey:["research-workspace",d]}),v.invalidateQueries({queryKey:["research-workspaces"]})},onError:()=>o.error("Failed to update workspace")}),he=async s=>{try{const r=await m.exportWorkspace(s),i=new Blob([r.data],{type:"text/markdown"}),c=window.URL.createObjectURL(i),n=document.createElement("a");n.href=c,n.download=`workspace-${(a==null?void 0:a.cve_id)||s}.md`,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(c),o.success("Workspace exported")}catch{o.error("Failed to export workspace")}},pe=s=>{L(s),S("detail"),M("overview")},ge=({onClose:s})=>{const[r,i]=l.useState(""),[c,n]=l.useState(""),[j,p]=l.useState(""),[N,g]=l.useState(!1),w=async t=>{var h;if(t.preventDefault(),!r.trim()){o.error("CVE ID is required");return}g(!0);try{const u=await m.createWorkspace({cve_id:r.trim().toUpperCase(),title:c.trim()||void 0,description:j.trim()||void 0});o.success("Workspace created"),v.invalidateQueries({queryKey:["research-workspaces"]});const x=(h=u.data)==null?void 0:h.id;x&&(L(x),S("detail")),s()}catch{o.error("Failed to create workspace")}finally{g(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-lg mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Create Research Workspace"}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"CVE ID *"}),e.jsx("input",{type:"text",value:r,onChange:t=>i(t.target.value),placeholder:"CVE-2024-12345",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white placeholder-gray-400",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:c,onChange:t=>n(t.target.value),placeholder:"Research title (optional)",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white placeholder-gray-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:j,onChange:t=>p(t.target.value),placeholder:"Brief description of research objectives...",rows:3,className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white placeholder-gray-400"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:N,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors disabled:opacity-50",children:N?"Creating...":"Create Workspace"})]})]})]})})},ue=({note:s,onClose:r})=>{const[i,c]=l.useState((s==null?void 0:s.title)||""),[n,j]=l.useState((s==null?void 0:s.content)||""),[p,N]=l.useState((s==null?void 0:s.note_type)||"general"),[g,w]=l.useState(((s==null?void 0:s.references)||[]).join(`
`)),[t,h]=l.useState(!1),u=async x=>{var z;if(x.preventDefault(),!i.trim()||!n.trim()){o.error("Title and content are required");return}h(!0);try{if(s)await m.updateNote(s.id,{title:i.trim(),content:n.trim(),note_type:p}),o.success("Note updated");else if(d){const Ne=g.split(`
`).filter(be=>be.trim()),B=(z=(await m.createNote({title:i.trim(),content:n.trim(),note_type:p,references:Ne})).data)==null?void 0:z.id;B&&await m.addItemToWorkspace(d,{item_type:"note",item_id:B}),o.success("Note added")}v.invalidateQueries({queryKey:["research-workspace",d]}),r()}catch{o.error(s?"Failed to update note":"Failed to add note")}finally{h(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:s?"Edit Note":"Add Research Note"}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:i,onChange:x=>c(x.target.value),placeholder:"Note title",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white placeholder-gray-400",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Type"}),e.jsxs("select",{value:p,onChange:x=>N(x.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white",children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"analysis",children:"Analysis"}),e.jsx("option",{value:"poc_notes",children:"PoC Notes"}),e.jsx("option",{value:"mitigation",children:"Mitigation"}),e.jsx("option",{value:"reference",children:"Reference"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Content *"}),e.jsx("textarea",{value:n,onChange:x=>j(x.target.value),placeholder:"Note content (supports Markdown)",rows:10,className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white placeholder-gray-400 font-mono text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"References (one per line)"}),e.jsx("textarea",{value:g,onChange:x=>w(x.target.value),placeholder:`https://example.com/reference
https://cve.mitre.org/...`,rows:3,className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white placeholder-gray-400 font-mono text-sm"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:t,className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors disabled:opacity-50",children:t?"Saving...":s?"Update Note":"Add Note"})]})]})]})})},ye=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Research Workspaces"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Organize and track your CVE research with notes, exploits, and PoCs"})]}),e.jsxs("button",{onClick:()=>W(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg transition-colors",children:[e.jsx(G,{className:"h-4 w-4"}),"New Workspace"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:f,onChange:s=>se(s.target.value),placeholder:"Search by CVE, title, or description...",className:"w-full bg-gray-800 border border-gray-700 rounded-lg pl-10 pr-4 py-2 text-white placeholder-gray-400 focus:border-cyan-500 focus:outline-none"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4 text-gray-400"}),e.jsxs("select",{value:R,onChange:s=>te(s.target.value),className:"bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white focus:border-cyan-500 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("button",{onClick:()=>ce(),className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:[e.jsx(k,{className:"h-4 w-4"}),"Refresh"]})]}),ie?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(k,{className:"h-8 w-8 text-cyan-500 animate-spin"})}):K.length===0?e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-12 text-center",children:[e.jsx(Y,{className:"h-12 w-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:f||R!=="all"?"No workspaces match your filters":"No research workspaces yet"}),e.jsx("button",{onClick:()=>W(!0),className:"mt-4 text-cyan-400 hover:text-cyan-300",children:"Create your first workspace"})]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:K.map(s=>{var r,i,c;return e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-4 hover:border-gray-600 transition-colors cursor-pointer group",onClick:()=>pe(s.id),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-5 w-5 text-cyan-500"}),e.jsx("span",{className:"text-cyan-400 font-mono text-sm",children:s.cve_id})]}),e.jsx("span",{className:`px-2 py-0.5 text-xs rounded border ${E[s.status]||E.active}`,children:s.status})]}),e.jsx("h3",{className:"text-white font-medium mb-2 group-hover:text-cyan-400 transition-colors",children:s.title||s.cve_id}),s.description&&e.jsx("p",{className:"text-gray-400 text-sm mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"h-3 w-3"}),((r=s.notes)==null?void 0:r.length)||0," notes"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(C,{className:"h-3 w-3"}),((i=s.linked_exploits)==null?void 0:i.length)||0," exploits"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"h-3 w-3"}),((c=s.linked_pocs)==null?void 0:c.length)||0," PoCs"]})]}),e.jsx(Ce,{className:"h-4 w-4 text-gray-600 group-hover:text-cyan-500 transition-colors"})]})]},s.id)})})]}),je=()=>{var s,r,i,c,n,j,p,N,g,w;return ne||!a?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(k,{className:"h-8 w-8 text-cyan-500 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>{S("list"),L(null)},className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(_e,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-cyan-400 font-mono",children:a.cve_id}),e.jsx("span",{className:`px-2 py-0.5 text-xs rounded border ${E[a.status]||E.active}`,children:a.status})]}),e.jsx("h1",{className:"text-xl font-bold text-white mt-1",children:a.title||a.cve_id})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{value:a.status,onChange:t=>me.mutate({id:a.id,data:{status:t.target.value}}),className:"bg-gray-700 border border-gray-600 rounded px-3 py-1.5 text-sm text-white",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"archived",children:"Archived"})]}),e.jsxs("button",{onClick:()=>he(a.id),className:"flex items-center gap-2 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors text-sm",children:[e.jsx(Z,{className:"h-4 w-4"}),"Export"]}),e.jsxs("button",{onClick:()=>{confirm("Delete this workspace? This cannot be undone.")&&xe.mutate(a.id)},className:"flex items-center gap-2 px-3 py-1.5 bg-red-600/10 hover:bg-red-600/20 text-red-400 rounded transition-colors text-sm",children:[e.jsx(H,{className:"h-4 w-4"}),"Delete"]})]})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:["overview","notes","exploits","pocs","timeline"].map(t=>e.jsx("button",{onClick:()=>M(t),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${y===t?"text-cyan-400 border-cyan-400":"text-gray-400 border-transparent hover:text-gray-300"}`,children:t.charAt(0).toUpperCase()+t.slice(1).replace("_"," ")},t))})}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[y==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Description"}),e.jsx("p",{className:"text-white",children:a.description||"No description provided."})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm mb-1",children:[e.jsx(I,{className:"h-4 w-4"}),"Notes"]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:((s=a.notes)==null?void 0:s.length)||0})]}),e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm mb-1",children:[e.jsx(C,{className:"h-4 w-4"}),"Linked Exploits"]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:((r=a.linked_exploits)==null?void 0:r.length)||0})]}),e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm mb-1",children:[e.jsx(_,{className:"h-4 w-4"}),"Linked PoCs"]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:((i=a.linked_pocs)==null?void 0:i.length)||0})]}),e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm mb-1",children:[e.jsx(P,{className:"h-4 w-4"}),"Timeline Events"]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:((c=a.timeline_events)==null?void 0:c.length)||0})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"}),"Created: ",new Date(a.created_at).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4"}),"Updated: ",new Date(a.updated_at).toLocaleDateString()]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"External Resources"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("a",{href:`https://nvd.nist.gov/vuln/detail/${a.cve_id}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded text-sm transition-colors",children:[e.jsx(b,{className:"h-3 w-3"}),"NVD"]}),e.jsxs("a",{href:`https://cve.mitre.org/cgi-bin/cvename.cgi?name=${a.cve_id}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded text-sm transition-colors",children:[e.jsx(b,{className:"h-3 w-3"}),"MITRE"]}),e.jsxs("a",{href:`https://www.exploit-db.com/search?cve=${a.cve_id.replace("CVE-","")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded text-sm transition-colors",children:[e.jsx(b,{className:"h-3 w-3"}),"Exploit-DB"]}),e.jsxs("a",{href:`https://github.com/search?q=${a.cve_id}&type=repositories`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded text-sm transition-colors",children:[e.jsx(b,{className:"h-3 w-3"}),"GitHub"]})]})]})]}),y==="notes"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Research Notes"}),e.jsxs("button",{onClick:()=>q(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors text-sm",children:[e.jsx(G,{className:"h-4 w-4"}),"Add Note"]})]}),(((n=a.notes)==null?void 0:n.length)||0)===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(Le,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No notes yet. Add your first research note."})]}):e.jsx("div",{className:"space-y-4",children:(j=a.notes)==null?void 0:j.map(t=>{var h;return e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-white",children:t.title}),e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${X[t.note_type]||X.general}`,children:t.note_type})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{Q(t),q(!0)},className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(Re,{className:"h-4 w-4"})}),e.jsx("button",{onClick:async()=>{if(confirm("Delete this note?"))try{await m.deleteNote(t.id),o.success("Note deleted"),v.invalidateQueries({queryKey:["research-workspace",d]})}catch{o.error("Failed to delete note")}},className:"text-gray-400 hover:text-red-400 transition-colors",children:e.jsx(H,{className:"h-4 w-4"})})]})]}),e.jsx("p",{className:"text-gray-300 text-sm whitespace-pre-wrap",children:t.content}),((h=t.references)==null?void 0:h.length)>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-600",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"References:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.references.map((u,x)=>e.jsxs("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-cyan-400 hover:text-cyan-300",children:[e.jsx(b,{className:"h-3 w-3 inline mr-1"}),u.length>50?u.substring(0,50)+"...":u]},x))})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-500",children:new Date(t.created_at).toLocaleString()})]},t.id)})})]}),y==="exploits"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Linked Exploits"}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors text-sm",children:[e.jsx(J,{className:"h-4 w-4"}),"Link Exploit"]})]}),(((p=a.linked_exploits)==null?void 0:p.length)||0)===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(C,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No exploits linked. Link exploits from the Exploit Database."})]}):e.jsx("div",{className:"space-y-2",children:(N=a.linked_exploits)==null?void 0:N.map(t=>e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4 text-red-400"}),e.jsx("span",{className:"text-white font-mono text-sm",children:t})]}),e.jsx("button",{className:"text-gray-400 hover:text-cyan-400 transition-colors",children:e.jsx(b,{className:"h-4 w-4"})})]},t))})]}),y==="pocs"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Linked PoCs"}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded transition-colors text-sm",children:[e.jsx(J,{className:"h-4 w-4"}),"Link PoC"]})]}),(((g=a.linked_pocs)==null?void 0:g.length)||0)===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(_,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No PoCs linked. Link PoCs from your repository."})]}):e.jsx("div",{className:"space-y-2",children:(w=a.linked_pocs)==null?void 0:w.map(t=>e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-cyan-400"}),e.jsx("span",{className:"text-white font-mono text-sm",children:t})]}),e.jsx("button",{className:"text-gray-400 hover:text-cyan-400 transition-colors",children:e.jsx(b,{className:"h-4 w-4"})})]},t))})]}),y==="timeline"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Research Timeline"}),oe?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(k,{className:"h-6 w-6 text-cyan-500 animate-spin"})}):V.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(P,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No timeline events yet."})]}):e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-4 top-0 bottom-0 w-px bg-gray-700"}),e.jsx("div",{className:"space-y-4",children:V.map((t,h)=>e.jsxs("div",{className:"flex items-start gap-4 relative",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center z-10",children:We[t.event_type]||e.jsx(P,{className:"h-4 w-4 text-gray-400"})}),e.jsxs("div",{className:"flex-1 bg-gray-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-white capitalize",children:t.event_type.replace("_"," ")}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(t.created_at).toLocaleString()})]}),t.description&&e.jsx("p",{className:"text-sm text-gray-400",children:t.description})]})]},h))})]})]})]})]})};return e.jsxs(Ee,{children:[e.jsx("div",{className:"p-6",children:ee==="list"?ye():je()}),ae&&e.jsx(ge,{onClose:()=>W(!1)}),re&&e.jsx(ue,{note:le,onClose:()=>{q(!1),Q(null)}})]})};export{Ie as default};
