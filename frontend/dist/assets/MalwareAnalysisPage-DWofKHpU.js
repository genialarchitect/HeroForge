import{b as V,u as j,d as T,j as e}from"./vendor-state-DdX3IZQk.js";import{r as d}from"./vendor-react-Da1CiaFS.js";import{B as w,w as $,be as F,H as I,au as J,S as q,N as P,m as W,aI as ee,L as C,Z as R,aH as se,K as te,bc as ae,M as re,G as M,ah as Q,a2 as E,ax as le,as as U,a7 as ne,x as ie,y as ce}from"./vendor-ui-ClyGCaTH.js";import{ak as x,d as xe}from"./index-DQCmZyk2.js";import"./vendor-charts-IB765B33.js";const _=({title:s,value:r,icon:m,color:h})=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:s}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:r})]}),e.jsx("div",{className:`p-3 rounded-lg ${h}`,children:m})]})}),B=s=>s?s>=80?"bg-red-500/20 text-red-400":s>=60?"bg-orange-500/20 text-orange-400":s>=40?"bg-yellow-500/20 text-yellow-400":s>=20?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400",Y=s=>{switch(s.toLowerCase()){case"pe":return e.jsx(ce,{className:"w-5 h-5"});case"elf":return e.jsx(E,{className:"w-5 h-5"});case"script":return e.jsx(ie,{className:"w-5 h-5"});case"pdf":return e.jsx(ne,{className:"w-5 h-5"});case"apk":return e.jsx(q,{className:"w-5 h-5"});default:return e.jsx($,{className:"w-5 h-5"})}},H=s=>{switch(s.toLowerCase()){case"ip":return e.jsx(P,{className:"w-4 h-4"});case"domain":return e.jsx(M,{className:"w-4 h-4"});case"url":return e.jsx(M,{className:"w-4 h-4"});case"email":return e.jsx(re,{className:"w-4 h-4"});case"hash":return e.jsx(ae,{className:"w-4 h-4"});case"bitcoin":return e.jsx(te,{className:"w-4 h-4"});default:return e.jsx(I,{className:"w-4 h-4"})}},L=s=>s<1024?`${s} B`:s<1024*1024?`${(s/1024).toFixed(1)} KB`:`${(s/(1024*1024)).toFixed(2)} MB`,D=s=>{const r=new Date(s);return r.toLocaleDateString()+" "+r.toLocaleTimeString()},de=({sample:s,onSelect:r,onAnalyze:m,onDelete:h})=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50 cursor-pointer transition-colors",onClick:r,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-cyan-500",children:Y(s.file_type)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium truncate max-w-xs",children:s.original_filename}),e.jsxs("p",{className:"text-gray-500 text-xs font-mono",children:[s.sha256.substring(0,16),"..."]})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-gray-700 text-gray-300",children:s.file_type.toUpperCase()})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:L(s.file_size)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${B(s.threat_score)}`,children:s.threat_score??"-"})}),e.jsx("td",{className:"px-4 py-3",children:s.classification?e.jsx("span",{className:"text-sm text-gray-300",children:s.classification}):e.jsx("span",{className:"text-sm text-gray-500",children:"-"})}),e.jsxs("td",{className:"px-4 py-3",children:[s.is_malicious===!0&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-red-500/20 text-red-400",children:"Malicious"}),s.is_malicious===!1&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-green-500/20 text-green-400",children:"Clean"}),s.is_malicious===void 0&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-gray-500/20 text-gray-400",children:"Unknown"})]}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(s.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",onClick:n=>n.stopPropagation(),children:[e.jsx("button",{onClick:m,className:"p-1.5 text-cyan-400 hover:bg-cyan-500/20 rounded transition-colors",title:"Analyze",children:e.jsx(R,{className:"w-4 h-4"})}),e.jsx("button",{onClick:h,className:"p-1.5 text-red-400 hover:bg-red-500/20 rounded transition-colors",title:"Delete",children:e.jsx(se,{className:"w-4 h-4"})})]})})]}),oe=({isOpen:s,onClose:r,onUpload:m,isUploading:h})=>{const[n,o]=d.useState(null),[y,g]=d.useState(""),[N,u]=d.useState(""),[v,a]=d.useState(!1),i=d.useCallback(l=>{l.preventDefault(),l.stopPropagation(),l.type==="dragenter"||l.type==="dragover"?a(!0):l.type==="dragleave"&&a(!1)},[]),p=d.useCallback(l=>{l.preventDefault(),l.stopPropagation(),a(!1),l.dataTransfer.files&&l.dataTransfer.files[0]&&o(l.dataTransfer.files[0])},[]),f=()=>{if(n){const l=y.split(",").map(b=>b.trim()).filter(b=>b);m(n,l,N)}};return s?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center",children:[e.jsx(F,{className:"w-5 h-5 mr-2 text-cyan-500"}),"Upload Sample"]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white",children:e.jsx(Q,{className:"w-5 h-5"})})]}),e.jsx("div",{className:`border-2 border-dashed rounded-lg p-8 text-center mb-4 transition-colors ${v?"border-cyan-500 bg-cyan-500/10":"border-gray-600 hover:border-gray-500"}`,onDragEnter:i,onDragLeave:i,onDragOver:i,onDrop:p,children:n?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(E,{className:"w-8 h-8 text-cyan-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:n.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:L(n.size)})]}),e.jsx("button",{onClick:()=>o(null),className:"text-gray-400 hover:text-white",children:e.jsx(le,{className:"w-5 h-5"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-12 h-12 text-gray-500 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-300",children:"Drag and drop a file here, or"}),e.jsxs("label",{className:"mt-2 inline-block",children:[e.jsx("input",{type:"file",className:"hidden",onChange:l=>l.target.files&&o(l.target.files[0])}),e.jsx("span",{className:"px-4 py-2 bg-cyan-600 text-white rounded cursor-pointer hover:bg-cyan-500 transition-colors",children:"Browse Files"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:y,onChange:l=>g(l.target.value),placeholder:"e.g., ransomware, suspicious, campaign-123",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Notes"}),e.jsx("textarea",{value:N,onChange:l=>u(l.target.value),placeholder:"Optional notes about this sample...",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white h-20"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-300 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{onClick:f,disabled:!n||h,className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:h?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Upload & Analyze"]})})]})]})}):null},me=({sample:s,isOpen:r,onClose:m,onAnalyze:h})=>{const[n,o]=d.useState("overview"),{data:y}=j({queryKey:["sample-strings",s==null?void 0:s.id],queryFn:()=>s!=null&&s.id?x.getSampleStrings(s.id).then(a=>a.data):Promise.resolve([]),enabled:r&&!!(s!=null&&s.id)&&n==="strings"}),{data:g}=j({queryKey:["sample-imports",s==null?void 0:s.id],queryFn:()=>s!=null&&s.id?x.getSampleImports(s.id).then(a=>a.data):Promise.resolve([]),enabled:r&&!!(s!=null&&s.id)&&n==="imports"}),{data:N}=j({queryKey:["sample-iocs",s==null?void 0:s.id],queryFn:()=>s!=null&&s.id?x.getSampleIocs(s.id).then(a=>a.data):Promise.resolve([]),enabled:r&&!!(s!=null&&s.id)&&n==="iocs"}),{data:u}=j({queryKey:["sample-yara",s==null?void 0:s.id],queryFn:()=>s!=null&&s.id?x.getYaraMatches(s.id).then(a=>a.data):Promise.resolve([]),enabled:r&&!!(s!=null&&s.id)&&n==="yara"});if(!r||!s)return null;const v=a=>{navigator.clipboard.writeText(a),w.success("Copied to clipboard")};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-cyan-500",children:Y(s.file_type)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:s.original_filename}),e.jsxs("p",{className:"text-gray-400 text-sm font-mono",children:[s.sha256.substring(0,32),"..."]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`px-3 py-1 rounded font-bold ${B(s.threat_score)}`,children:["Threat Score: ",s.threat_score??"N/A"]}),e.jsx("button",{onClick:m,className:"text-gray-400 hover:text-white",children:e.jsx(Q,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"flex border-b border-gray-700",children:["overview","strings","imports","iocs","yara"].map(a=>e.jsx("button",{onClick:()=>o(a),className:`px-4 py-2 text-sm font-medium transition-colors ${n===a?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:a.charAt(0).toUpperCase()+a.slice(1)},a))}),e.jsxs("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:[n==="overview"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"File Info"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"File Type:"}),e.jsx("span",{className:"text-white",children:s.file_type.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"File Size:"}),e.jsx("span",{className:"text-white",children:L(s.file_size)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Entropy:"}),e.jsx("span",{className:`text-white ${s.entropy>7.5?"text-red-400":""}`,children:s.entropy.toFixed(4)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Source:"}),e.jsx("span",{className:"text-white",children:s.source})]})]}),e.jsx("h3",{className:"text-lg font-semibold text-white mt-4",children:"Hashes"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 p-2 rounded",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"MD5:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-white font-mono text-sm",children:s.md5}),e.jsx("button",{onClick:()=>v(s.md5),className:"text-gray-400 hover:text-white",children:e.jsx(U,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 p-2 rounded",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"SHA256:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-white font-mono text-sm truncate max-w-xs",children:s.sha256}),e.jsx("button",{onClick:()=>v(s.sha256),className:"text-gray-400 hover:text-white",children:e.jsx(U,{className:"w-4 h-4"})})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Classification"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Classification:"}),e.jsx("span",{className:"text-white",children:s.classification||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Family:"}),e.jsx("span",{className:"text-white",children:s.family||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),s.is_malicious===!0&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-red-500/20 text-red-400",children:"Malicious"}),s.is_malicious===!1&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-green-500/20 text-green-400",children:"Clean"}),s.is_malicious===void 0&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-gray-500/20 text-gray-400",children:"Unknown"})]})]}),e.jsx("h3",{className:"text-lg font-semibold text-white mt-4",children:"Timeline"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"First Seen:"}),e.jsx("span",{className:"text-white",children:D(s.first_seen)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Last Analyzed:"}),e.jsx("span",{className:"text-white",children:s.last_analyzed?D(s.last_analyzed):"Never"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Analysis Count:"}),e.jsx("span",{className:"text-white",children:s.analysis_count})]})]}),s.tags&&s.tags.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mt-4",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map((a,i)=>e.jsx("span",{className:"px-2 py-1 bg-gray-700 rounded text-sm text-gray-300",children:a},i))})]})]})]}),n==="strings"&&e.jsx("div",{className:"space-y-2",children:y&&y.length>0?e.jsx("div",{className:"space-y-1 font-mono text-sm",children:y.slice(0,100).map((a,i)=>e.jsxs("div",{className:"flex items-start space-x-2 p-2 bg-gray-900 rounded",children:[e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-400",children:a.category}),e.jsx("span",{className:"text-white break-all",children:a.value})]},i))}):e.jsx("p",{className:"text-gray-400",children:"No interesting strings found."})}),n==="imports"&&e.jsx("div",{className:"space-y-4",children:g&&g.length>0?g.map((a,i)=>e.jsxs("div",{className:"bg-gray-900 rounded p-3",children:[e.jsx("h4",{className:"text-cyan-400 font-medium mb-2",children:a.library}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.functions.map((p,f)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-300 font-mono",children:p},f))})]},i)):e.jsx("p",{className:"text-gray-400",children:"No imports found."})}),n==="iocs"&&e.jsx("div",{className:"space-y-2",children:N&&N.length>0?N.map((a,i)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 rounded p-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-cyan-500",children:H(a.ioc_type)}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-mono",children:a.value}),e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-400",children:a.ioc_type})]})]}),e.jsxs("span",{className:"text-gray-400 text-sm",children:[(a.confidence*100).toFixed(0),"% confidence"]})]},i)):e.jsx("p",{className:"text-gray-400",children:"No IOCs extracted."})}),n==="yara"&&e.jsx("div",{className:"space-y-2",children:u&&u.length>0?u.map((a,i)=>{var p;return e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 rounded p-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(q,{className:"w-5 h-5 text-orange-400"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-medium",children:a.rule_name}),e.jsx("div",{className:"flex gap-1 mt-1",children:(p=a.tags)==null?void 0:p.map((f,l)=>e.jsx("span",{className:"px-2 py-0.5 bg-orange-500/20 rounded text-xs text-orange-400",children:f},l))})]})]}),e.jsx("span",{className:"text-gray-400 text-sm",children:D(a.matched_at)})]},i)}):e.jsx("p",{className:"text-gray-400",children:"No YARA matches."})})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 border-t border-gray-700",children:[e.jsxs("button",{onClick:h,className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors flex items-center",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Re-analyze"]}),e.jsx("button",{onClick:m,className:"px-4 py-2 text-gray-300 hover:text-white transition-colors",children:"Close"})]})]})})},je=()=>{const s=V(),[r,m]=d.useState("samples"),[h,n]=d.useState(!1),[o,y]=d.useState(null),[g,N]=d.useState(""),[u,v]=d.useState(""),{data:a,isLoading:i}=j({queryKey:["malware-stats"],queryFn:()=>x.getStats().then(t=>t.data)}),{data:p,isLoading:f,refetch:l}=j({queryKey:["malware-samples",g,u],queryFn:()=>x.listSamples({search:g||void 0,file_type:u||void 0,limit:100}).then(t=>t.data)}),{data:b,isLoading:O}=j({queryKey:["yara-rules"],queryFn:()=>x.listYaraRules({include_builtin:!0}).then(t=>t.data),enabled:r==="yara"}),{data:A,isLoading:G}=j({queryKey:["malware-iocs"],queryFn:()=>x.listIocs({limit:100}).then(t=>t.data),enabled:r==="iocs"}),{data:k,isLoading:X}=j({queryKey:["malware-queue"],queryFn:()=>x.listQueue().then(t=>t.data),enabled:r==="queue"}),z=T({mutationFn:t=>{const c=new FormData;return c.append("file",t.file),c.append("tags",t.tags.join(",")),c.append("notes",t.notes),x.uploadSample(c)},onSuccess:()=>{w.success("Sample uploaded and queued for analysis"),n(!1),s.invalidateQueries({queryKey:["malware-samples"]}),s.invalidateQueries({queryKey:["malware-stats"]}),s.invalidateQueries({queryKey:["malware-queue"]})},onError:t=>{var c,S;w.error(((S=(c=t.response)==null?void 0:c.data)==null?void 0:S.error)||"Failed to upload sample")}}),K=T({mutationFn:t=>x.analyzeSample(t),onSuccess:t=>{w.success(`Analysis complete. Threat score: ${t.data.threat_score}`),s.invalidateQueries({queryKey:["malware-samples"]}),s.invalidateQueries({queryKey:["malware-stats"]}),o&&y(null)},onError:()=>{w.error("Failed to analyze sample")}}),Z=T({mutationFn:t=>x.deleteSample(t),onSuccess:()=>{w.success("Sample deleted"),s.invalidateQueries({queryKey:["malware-samples"]}),s.invalidateQueries({queryKey:["malware-stats"]})},onError:()=>{w.error("Failed to delete sample")}});return e.jsxs(xe,{children:[e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center",children:[e.jsx($,{className:"w-7 h-7 mr-2 text-red-500"}),"Malware Analysis"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Upload and analyze malware samples with static analysis and YARA matching"})]}),e.jsxs("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition-colors flex items-center",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Upload Sample"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(_,{title:"Total Samples",value:(a==null?void 0:a.total_samples)??0,icon:e.jsx(I,{className:"w-6 h-6 text-white"}),color:"bg-cyan-500/20"}),e.jsx(_,{title:"Malicious",value:(a==null?void 0:a.samples_malicious)??0,icon:e.jsx(J,{className:"w-6 h-6 text-white"}),color:"bg-red-500/20"}),e.jsx(_,{title:"YARA Rules",value:(a==null?void 0:a.total_yara_rules)??0,icon:e.jsx(q,{className:"w-6 h-6 text-white"}),color:"bg-orange-500/20"}),e.jsx(_,{title:"IOCs Extracted",value:(a==null?void 0:a.total_iocs)??0,icon:e.jsx(P,{className:"w-6 h-6 text-white"}),color:"bg-purple-500/20"})]}),e.jsx("div",{className:"flex border-b border-gray-700",children:["samples","yara","iocs","queue"].map(t=>e.jsxs("button",{onClick:()=>m(t),className:`px-6 py-3 text-sm font-medium transition-colors ${r===t?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:[t==="samples"&&"Samples",t==="yara"&&"YARA Rules",t==="iocs"&&"IOCs",t==="queue"&&"Analysis Queue"]},t))}),r==="samples"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by filename, hash, or notes...",value:g,onChange:t=>N(t.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded pl-10 pr-4 py-2 text-white"})]}),e.jsxs("select",{value:u,onChange:t=>v(t.target.value),className:"bg-gray-800 border border-gray-700 rounded px-4 py-2 text-white",children:[e.jsx("option",{value:"",children:"All File Types"}),e.jsx("option",{value:"pe",children:"PE"}),e.jsx("option",{value:"elf",children:"ELF"}),e.jsx("option",{value:"script",children:"Script"}),e.jsx("option",{value:"pdf",children:"PDF"}),e.jsx("option",{value:"apk",children:"APK"})]}),e.jsx("button",{onClick:()=>l(),className:"px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600 transition-colors",children:e.jsx(ee,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Sample"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Size"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Threat"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Classification"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{children:f?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(C,{className:"w-6 h-6 animate-spin mx-auto"})})}):p&&p.length>0?p.map(t=>e.jsx(de,{sample:t,onSelect:()=>y(t),onAnalyze:()=>K.mutate(t.id),onDelete:()=>{confirm("Are you sure you want to delete this sample?")&&Z.mutate(t.id)}},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-400",children:"No samples found. Upload a sample to get started."})})})]})})]}),r==="yara"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Rule Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Matches"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Status"})]})}),e.jsx("tbody",{children:O?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(C,{className:"w-6 h-6 animate-spin mx-auto"})})}):b&&b.length>0?b.map(t=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"w-4 h-4 text-orange-400"}),e.jsx("span",{className:"text-white font-medium",children:t.name})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.category}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.severity==="critical"?"bg-red-500/20 text-red-400":t.severity==="high"?"bg-orange-500/20 text-orange-400":t.severity==="medium"?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400"}`,children:t.severity})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.is_builtin?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400"}`,children:t.is_builtin?"Built-in":"Custom"})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.match_count}),e.jsx("td",{className:"px-4 py-3",children:t.is_enabled?e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-green-500/20 text-green-400",children:"Enabled"}):e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-gray-500/20 text-gray-400",children:"Disabled"})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:"No YARA rules found."})})})]})})}),r==="iocs"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"IOC Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Value"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Sample"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Confidence"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Date"})]})}),e.jsx("tbody",{children:G?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(C,{className:"w-6 h-6 animate-spin mx-auto"})})}):A&&A.length>0?A.map(t=>{var c;return e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[H(t.ioc_type),e.jsx("span",{className:"text-gray-300",children:t.ioc_type})]})}),e.jsx("td",{className:"px-4 py-3 text-white font-mono text-sm",children:t.value}),e.jsx("td",{className:"px-4 py-3 text-gray-300 text-sm",children:t.sample_filename||((c=t.sample_sha256)==null?void 0:c.substring(0,16))+"..."}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`px-2 py-1 rounded text-xs ${t.confidence>=.8?"bg-green-500/20 text-green-400":t.confidence>=.5?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400"}`,children:[(t.confidence*100).toFixed(0),"%"]})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(t.created_at).toLocaleDateString()})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-400",children:"No IOCs extracted yet."})})})]})})}),r==="queue"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Sample"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Analysis Types"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Priority"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Attempts"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Created"})]})}),e.jsx("tbody",{children:X?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:e.jsx(C,{className:"w-6 h-6 animate-spin mx-auto"})})}):k&&k.length>0?k.map(t=>e.jsxs("tr",{className:"border-b border-gray-700 hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.sample_filename}),e.jsxs("p",{className:"text-gray-500 text-xs font-mono",children:[t.sample_sha256.substring(0,16),"..."]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:t.analysis_types.split(",").map((c,S)=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-xs text-gray-300",children:c.trim()},S))})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.priority}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.status==="pending"?"bg-yellow-500/20 text-yellow-400":t.status==="running"?"bg-blue-500/20 text-blue-400":t.status==="completed"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:t.status})}),e.jsx("td",{className:"px-4 py-3 text-gray-300",children:t.attempts}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(t.created_at).toLocaleDateString()})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:"No items in queue."})})})]})})})]}),e.jsx(oe,{isOpen:h,onClose:()=>n(!1),onUpload:(t,c,S)=>z.mutate({file:t,tags:c,notes:S}),isUploading:z.isPending}),e.jsx(me,{sample:o,isOpen:!!o,onClose:()=>y(null),onAnalyze:()=>{o&&K.mutate(o.id)}})]})};export{je as default};
