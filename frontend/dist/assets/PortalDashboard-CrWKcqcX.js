import{j as e}from"./vendor-state-DdX3IZQk.js";import{r,L as i}from"./vendor-react-Da1CiaFS.js";import{P as l}from"./PortalLayout-DwxdFUqG.js";import{ao as h}from"./index-p17BBcCI.js";import"./vendor-ui-BsZcNZEA.js";import"./vendor-charts-Xc8Z_JpT.js";const u=({className:t})=>e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.25 12.75V12A2.25 2.25 0 014.5 9.75h15A2.25 2.25 0 0121.75 12v.75m-8.69-6.44l-2.12-2.12a1.5 1.5 0 00-1.061-.44H4.5A2.25 2.25 0 002.25 6v12a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9a2.25 2.25 0 00-2.25-2.25h-5.379a1.5 1.5 0 01-1.06-.44z"})}),g=({className:t})=>e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v3.75m0-10.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.249-8.25-3.286zm0 13.036h.008v.008H12v-.008z"})}),v=({className:t})=>e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})}),p=({className:t})=>e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),j=({className:t})=>e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),b=({className:t})=>e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5"})});function L(){const[t,o]=r.useState(null),[d,c]=r.useState(!0),[n,x]=r.useState(null);if(r.useEffect(()=>{(async()=>{try{const a=await h.getDashboard();o(a.data)}catch(a){console.error("Failed to fetch dashboard:",a),x("Failed to load dashboard data")}finally{c(!1)}})()},[]),d)return e.jsx(l,{children:e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-blue-600 border-t-transparent"})})});if(n||!t)return e.jsx(l,{children:e.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-red-700",children:n||"Failed to load dashboard"})});const m=[{name:"Active Engagements",value:t.active_engagements,total:t.total_engagements,icon:u,color:"text-blue-600 bg-blue-100",href:"/portal/engagements"},{name:"Open Vulnerabilities",value:t.open_vulnerabilities,subtext:`${t.critical_vulnerabilities} critical, ${t.high_vulnerabilities} high`,icon:g,color:t.critical_vulnerabilities>0?"text-red-600 bg-red-100":"text-yellow-600 bg-yellow-100",href:"/portal/vulnerabilities"},{name:"Available Reports",value:t.available_reports,icon:v,color:"text-green-600 bg-green-100",href:"/portal/reports"}];return e.jsx(l,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Welcome back, ",t.customer_name]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Here's an overview of your security posture"})]}),t.critical_vulnerabilities>0&&e.jsx("div",{className:"rounded-lg bg-red-50 border border-red-200 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{className:"h-6 w-6 text-red-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Critical Vulnerabilities Detected"}),e.jsxs("p",{className:"text-sm text-red-700 mt-1",children:["You have ",t.critical_vulnerabilities," critical vulnerabilit",t.critical_vulnerabilities===1?"y":"ies"," that require immediate attention."]})]}),e.jsx(i,{to:"/portal/vulnerabilities?severity=critical",className:"ml-auto rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700",children:"View Details"})]})}),e.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3",children:m.map(s=>e.jsx(i,{to:s.href,className:"relative overflow-hidden rounded-lg bg-white px-6 py-5 shadow hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex h-12 w-12 items-center justify-center rounded-lg ${s.color}`,children:e.jsx(s.icon,{className:"h-6 w-6"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:s.name}),e.jsxs("div",{className:"flex items-baseline",children:[e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.value}),s.total!==void 0&&e.jsxs("p",{className:"ml-2 text-sm text-gray-500",children:["of ",s.total]})]}),s.subtext&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s.subtext})]})]})},s.name))}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"rounded-lg bg-white shadow",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Recent Scans"})}),e.jsx("div",{className:"divide-y divide-gray-200",children:t.recent_scans.length===0?e.jsx("div",{className:"px-6 py-8 text-center text-sm text-gray-500",children:"No recent scans"}):t.recent_scans.map(s=>e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsxs("div",{className:"flex items-center mt-1 text-xs text-gray-500",children:[e.jsx(j,{className:"mr-1 h-3 w-3"}),new Date(s.created_at).toLocaleDateString()]})]}),e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="running"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:s.status})]})},s.id))})]}),e.jsxs("div",{className:"rounded-lg bg-white shadow",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Upcoming Milestones"})}),e.jsx("div",{className:"divide-y divide-gray-200",children:t.upcoming_milestones.length===0?e.jsx("div",{className:"px-6 py-8 text-center text-sm text-gray-500",children:"No upcoming milestones"}):t.upcoming_milestones.map(s=>e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s.engagement_name})]}),e.jsxs("div",{className:"text-right",children:[s.due_date&&e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(b,{className:"mr-1 h-3 w-3"}),new Date(s.due_date).toLocaleDateString()]}),e.jsx("span",{className:`mt-1 inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="in_progress"?"bg-blue-100 text-blue-800":s.status==="overdue"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:s.status})]})]})},s.id))}),t.upcoming_milestones.length>0&&e.jsx("div",{className:"border-t border-gray-200 px-6 py-3",children:e.jsx(i,{to:"/portal/engagements",className:"text-sm font-medium text-blue-600 hover:text-blue-500",children:"View all engagements"})})]})]})]})})}export{L as PortalDashboard,L as default};
