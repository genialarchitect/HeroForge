import{j as e,b as E,u as v,d as j}from"./vendor-state-DdX3IZQk.js";import{r as u}from"./vendor-react-Da1CiaFS.js";import{Q as W,n as k,cf as U,z as _,D as T,as as S,bg as V,B as g,aR as b,aH as D,at as z,E as H,aI as A,aB as R,S as G,aD as J,O as K,P as F,x as X,aQ as Q,aN as Y,aq as Z}from"./vendor-ui-wM19Qo8C.js";import{d as ee,a5 as n}from"./index-Bt29V2Q6.js";import"./vendor-charts-CCbxmwBt.js";const h={searchExploits:s=>n.get("/exploit-research/exploits",{params:s}).then(t=>t.data),getExploit:s=>n.get(`/exploit-research/exploits/${s}`).then(t=>t.data),getExploitsForCve:s=>n.get(`/exploit-research/exploits/cve/${s}`).then(t=>t.data),getCveMapping:s=>n.get(`/exploit-research/cve-mapping/${s}`).then(t=>t.data),getBatchCveMappings:s=>n.post("/exploit-research/cve-mapping/batch",{cve_ids:s}).then(t=>t.data),getSyncStatus:()=>n.get("/exploit-research/sync-status").then(s=>s.data),triggerSync:s=>n.post(`/exploit-research/sync/${s}`).then(t=>t.data),listPocs:s=>n.get("/exploit-research/pocs",{params:s}).then(t=>t.data),createPoc:s=>n.post("/exploit-research/pocs",s).then(t=>t.data),getPoc:s=>n.get(`/exploit-research/pocs/${s}`).then(t=>t.data),updatePoc:(s,t)=>n.put(`/exploit-research/pocs/${s}`,t).then(r=>r.data),deletePoc:s=>n.delete(`/exploit-research/pocs/${s}`),getPocCode:s=>n.get(`/exploit-research/pocs/${s}/code`).then(t=>t.data),addPocTestResult:(s,t)=>n.post(`/exploit-research/pocs/${s}/test`,t).then(r=>r.data),listNotes:s=>n.get("/exploit-research/notes",{params:s}).then(t=>t.data),createNote:s=>n.post("/exploit-research/notes",s).then(t=>t.data),getNote:s=>n.get(`/exploit-research/notes/${s}`).then(t=>t.data),updateNote:(s,t)=>n.put(`/exploit-research/notes/${s}`,t).then(r=>r.data),deleteNote:s=>n.delete(`/exploit-research/notes/${s}`),listWorkspaces:s=>n.get("/exploit-research/workspaces",{params:s}).then(t=>t.data),createWorkspace:s=>n.post("/exploit-research/workspaces",s).then(t=>t.data),getWorkspace:s=>n.get(`/exploit-research/workspaces/${s}`).then(t=>t.data),updateWorkspace:(s,t)=>n.put(`/exploit-research/workspaces/${s}`,t).then(r=>r.data),deleteWorkspace:s=>n.delete(`/exploit-research/workspaces/${s}`),exportWorkspace:s=>n.get(`/exploit-research/workspaces/${s}/export`).then(t=>t.data),addExploitToWorkspace:(s,t)=>n.post(`/exploit-research/workspaces/${s}/exploits/${t}`),listFavorites:()=>n.get("/exploit-research/favorites").then(s=>s.data),addFavorite:s=>n.post("/exploit-research/favorites",{exploit_id:s}),removeFavorite:s=>n.delete(`/exploit-research/favorites/${s}`),getSearchHistory:()=>n.get("/exploit-research/history").then(s=>s.data)},se={exploit_db:{bg:"bg-red-500/20",text:"text-red-400"},metasploit:{bg:"bg-blue-500/20",text:"text-blue-400"},packetstorm:{bg:"bg-purple-500/20",text:"text-purple-400"}},q={draft:{bg:"bg-gray-500/20",text:"text-gray-400"},testing:{bg:"bg-yellow-500/20",text:"text-yellow-400"},verified:{bg:"bg-green-500/20",text:"text-green-400"},broken:{bg:"bg-red-500/20",text:"text-red-400"},active:{bg:"bg-green-500/20",text:"text-green-400"},completed:{bg:"bg-cyan-500/20",text:"text-cyan-400"},archived:{bg:"bg-gray-500/20",text:"text-gray-400"}},M={high:{bg:"bg-green-500/20",text:"text-green-400"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400"},low:{bg:"bg-orange-500/20",text:"text-orange-400"},untested:{bg:"bg-gray-500/20",text:"text-gray-400"}};function C({source:s}){const t=se[s.toLowerCase()]||{bg:"bg-gray-500/20",text:"text-gray-400"},r=s==="exploit_db"?"Exploit-DB":s==="metasploit"?"Metasploit":s==="packetstorm"?"PacketStorm":s;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.bg} ${t.text}`,children:r})}function B({status:s}){const t=q[s.toLowerCase()]||q.draft;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.bg} ${t.text}`,children:s.charAt(0).toUpperCase()+s.slice(1)})}function O({reliability:s}){const t=M[s.toLowerCase()]||M.untested;return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.bg} ${t.text}`,children:s.charAt(0).toUpperCase()+s.slice(1)})}const P=({isOpen:s,onClose:t,title:r,children:a,size:c="md"})=>{if(!s)return null;const m={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:t}),e.jsxs("div",{className:`relative bg-gray-800 border border-gray-700 rounded-lg shadow-xl w-full ${m[c]} max-h-[90vh] overflow-y-auto mx-4`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 sticky top-0 bg-gray-800 z-10",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:r}),e.jsx("button",{onClick:t,className:"p-1 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-white",children:e.jsx(Z,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4",children:a})]})]})},te=()=>{const[s,t]=u.useState(""),[r,a]=u.useState({source:"",platform:"",exploit_type:"",verified_only:!1,has_code:!1}),[c,m]=u.useState(1),[l,o]=u.useState(null),d=E(),{data:p,isLoading:N,refetch:f}=v({queryKey:["exploits",s,r,c],queryFn:()=>h.searchExploits({query:s||void 0,source:r.source||void 0,platform:r.platform||void 0,exploit_type:r.exploit_type||void 0,verified_only:r.verified_only||void 0,has_code:r.has_code||void 0,page:c,per_page:20}),enabled:!0}),{data:x}=v({queryKey:["exploit-sync-status"],queryFn:h.getSyncStatus}),y=j({mutationFn:i=>h.triggerSync(i),onSuccess:(i,w)=>{g.success(`Sync started for ${w}`),d.invalidateQueries({queryKey:["exploit-sync-status"]})},onError:()=>g.error("Failed to start sync")}),L=j({mutationFn:i=>h.addFavorite(i),onSuccess:()=>{g.success("Added to favorites"),d.invalidateQueries({queryKey:["exploit-favorites"]})},onError:()=>g.error("Failed to add favorite")}),I=i=>{i.preventDefault(),m(1),f()},$=i=>{navigator.clipboard.writeText(i),g.success("Copied to clipboard")};return e.jsxs("div",{className:"space-y-6",children:[x&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h3",{className:"text-sm font-medium text-gray-300",children:"Database Sync Status"})}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:x.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(C,{source:i.source}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[i.items_synced," items"]}),i.last_sync&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Last: ",new Date(i.last_sync).toLocaleString()]})]}),e.jsx("button",{onClick:()=>y.mutate(i.source),disabled:y.isPending,className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-cyan-400",title:"Sync now",children:e.jsx(b,{className:`w-4 h-4 ${y.isPending?"animate-spin":""}`})})]},i.source))})]}),e.jsxs("form",{onSubmit:I,className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:s,onChange:i=>t(i.target.value),placeholder:"Search exploits by title, CVE, description...",className:"w-full pl-10 pr-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4"}),"Search"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("select",{value:r.source,onChange:i=>a({...r,source:i.target.value}),className:"px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Sources"}),e.jsx("option",{value:"exploit_db",children:"Exploit-DB"}),e.jsx("option",{value:"metasploit",children:"Metasploit"}),e.jsx("option",{value:"packetstorm",children:"PacketStorm"})]}),e.jsxs("select",{value:r.platform,onChange:i=>a({...r,platform:i.target.value}),className:"px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Platforms"}),e.jsx("option",{value:"linux",children:"Linux"}),e.jsx("option",{value:"windows",children:"Windows"}),e.jsx("option",{value:"macos",children:"macOS"}),e.jsx("option",{value:"multi",children:"Multi-Platform"}),e.jsx("option",{value:"web",children:"Web Application"}),e.jsx("option",{value:"android",children:"Android"}),e.jsx("option",{value:"ios",children:"iOS"})]}),e.jsxs("select",{value:r.exploit_type,onChange:i=>a({...r,exploit_type:i.target.value}),className:"px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"remote",children:"Remote"}),e.jsx("option",{value:"local",children:"Local"}),e.jsx("option",{value:"webapps",children:"Web Apps"}),e.jsx("option",{value:"dos",children:"DoS"}),e.jsx("option",{value:"shellcode",children:"Shellcode"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:r.verified_only,onChange:i=>a({...r,verified_only:i.target.checked}),className:"rounded border-gray-700 bg-gray-900 text-cyan-600"}),"Verified Only"]}),e.jsxs("label",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:r.has_code,onChange:i=>a({...r,has_code:i.target.checked}),className:"rounded border-gray-700 bg-gray-900 text-cyan-600"}),"Has Code"]})]})]}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:N?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(b,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-gray-400",children:"Searching exploits..."})]}):(p==null?void 0:p.exploits.length)===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(W,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No exploits found"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:e.jsxs("p",{className:"text-sm text-gray-400",children:["Found ",(p==null?void 0:p.total)||0," exploits"]})}),e.jsx("div",{className:"divide-y divide-gray-700",children:p==null?void 0:p.exploits.map(i=>e.jsx("div",{className:"p-4 hover:bg-gray-700/30",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-white font-medium truncate",children:i.title}),i.verified&&e.jsx(D,{className:"w-4 h-4 text-green-400 flex-shrink-0"})]}),e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2 mb-2",children:i.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(C,{source:i.source}),e.jsx("span",{className:"text-xs text-gray-500",children:i.platform}),e.jsx("span",{className:"text-xs text-gray-500",children:i.exploit_type}),i.cve_ids.length>0&&e.jsxs("div",{className:"flex gap-1",children:[i.cve_ids.slice(0,3).map(w=>e.jsx("span",{className:"px-2 py-0.5 bg-cyan-500/20 text-cyan-400 rounded text-xs cursor-pointer hover:bg-cyan-500/30",onClick:()=>$(w),children:w},w)),i.cve_ids.length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",i.cve_ids.length-3]})]}),i.publish_date&&e.jsxs("span",{className:"text-xs text-gray-500",children:[e.jsx(z,{className:"w-3 h-3 inline mr-1"}),new Date(i.publish_date).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[e.jsx("button",{onClick:()=>o(i),className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-white",title:"View details",children:e.jsx(H,{className:"w-4 h-4"})}),i.code_url&&e.jsx("a",{href:i.code_url,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-cyan-400",title:"View code",children:e.jsx(A,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>L.mutate(i.id),className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-yellow-400",title:"Add to favorites",children:e.jsx(S,{className:"w-4 h-4"})})]})]})},i.id))}),p&&p.total>20&&e.jsxs("div",{className:"p-4 border-t border-gray-700 flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>m(i=>Math.max(1,i-1)),disabled:c===1,className:"px-3 py-1 rounded-lg bg-gray-700 text-white disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"text-gray-400",children:["Page ",c," of ",Math.ceil(p.total/20)]}),e.jsx("button",{onClick:()=>m(i=>i+1),disabled:c*20>=p.total,className:"px-3 py-1 rounded-lg bg-gray-700 text-white disabled:opacity-50",children:"Next"})]})]})}),e.jsx(P,{isOpen:!!l,onClose:()=>o(null),title:(l==null?void 0:l.title)||"Exploit Details",size:"lg",children:l&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(C,{source:l.source}),l.verified&&e.jsxs("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 rounded text-xs font-medium flex items-center gap-1",children:[e.jsx(D,{className:"w-3 h-3"})," Verified"]}),l.reliability&&e.jsx(O,{reliability:l.reliability})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Platform"}),e.jsx("p",{className:"text-white",children:l.platform})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Type"}),e.jsx("p",{className:"text-white",children:l.exploit_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Author"}),e.jsx("p",{className:"text-white",children:l.author||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Published"}),e.jsx("p",{className:"text-white",children:l.publish_date?new Date(l.publish_date).toLocaleDateString():"Unknown"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Description"}),e.jsx("p",{className:"text-white whitespace-pre-wrap",children:l.description})]}),l.cve_ids.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400",children:"CVE IDs"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:l.cve_ids.map(i=>e.jsxs("span",{className:"px-2 py-1 bg-cyan-500/20 text-cyan-400 rounded cursor-pointer hover:bg-cyan-500/30 flex items-center gap-1",onClick:()=>$(i),children:[i,e.jsx(R,{className:"w-3 h-3"})]},i))})]}),l.tags.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:l.tags.map(i=>e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs",children:i},i))})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-700",children:[l.code_url&&e.jsxs("a",{href:l.code_url,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),"View Code"]}),e.jsxs("button",{onClick:()=>L.mutate(l.id),className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4"}),"Add to Favorites"]})]})]})})]})},ae=()=>{const[s,t]=u.useState(""),[r,a]=u.useState(null),[c,m]=u.useState(!1),l=async o=>{if(o.preventDefault(),!!s.trim()){m(!0);try{const d=await h.getCveMapping(s.trim().toUpperCase());a(d)}catch{g.error("Failed to lookup CVE mapping")}m(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"CVE to Exploit Mapping"}),e.jsxs("form",{onSubmit:l,className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:s,onChange:o=>t(o.target.value),placeholder:"Enter CVE ID (e.g., CVE-2021-44228)",className:"w-full pl-10 pr-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2 disabled:opacity-50",children:[c?e.jsx(b,{className:"w-4 h-4 animate-spin"}):e.jsx(k,{className:"w-4 h-4"}),"Lookup"]})]})]}),r&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:r.cve_id}),r.cve_description&&e.jsx("p",{className:"text-gray-400 mt-1",children:r.cve_description})]}),e.jsxs("div",{className:"flex gap-2",children:[r.has_public_exploit&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 text-red-400 rounded text-xs font-medium flex items-center gap-1",children:[e.jsx(J,{className:"w-3 h-3"}),"Public Exploit"]}),r.has_metasploit_module&&e.jsxs("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs font-medium flex items-center gap-1",children:[e.jsx(K,{className:"w-3 h-3"}),"Metasploit"]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-sm text-gray-400",children:[r.total_exploits," exploit(s) found | Last updated:"," ",new Date(r.last_updated).toLocaleString()]})}),e.jsx("div",{className:"divide-y divide-gray-700",children:r.exploits.map(o=>e.jsxs("div",{className:"py-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:o.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(C,{source:o.source}),e.jsx("span",{className:"text-xs text-gray-500",children:o.platform}),o.verified&&e.jsx(D,{className:"w-3 h-3 text-green-400"})]})]}),o.code_url&&e.jsx("a",{href:o.code_url,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-cyan-400",children:e.jsx(A,{className:"w-4 h-4"})})]},o.id))})]})]})},re=()=>{const[s,t]=u.useState(!1),[r,a]=u.useState(null),[c,m]=u.useState(null),l=E(),{data:o,isLoading:d}=v({queryKey:["pocs"],queryFn:()=>h.listPocs()}),p=j({mutationFn:h.createPoc,onSuccess:()=>{g.success("PoC created"),t(!1),l.invalidateQueries({queryKey:["pocs"]})},onError:()=>g.error("Failed to create PoC")}),N=j({mutationFn:h.deletePoc,onSuccess:()=>{g.success("PoC deleted"),l.invalidateQueries({queryKey:["pocs"]})},onError:()=>g.error("Failed to delete PoC")}),f=async x=>{try{const y=await h.getPocCode(x.id);m(y),a(x)}catch{g.error("Failed to load PoC code")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Proof of Concept Repository"}),e.jsxs("button",{onClick:()=>t(!0),className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4"}),"New PoC"]})]}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:d?e.jsx("div",{className:"p-8 text-center",children:e.jsx(b,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto"})}):(o==null?void 0:o.length)===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(_,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No PoCs yet. Create your first one!"})]}):e.jsx("div",{className:"divide-y divide-gray-700",children:o==null?void 0:o.map(x=>e.jsx("div",{className:"p-4 hover:bg-gray-700/30",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"text-white font-medium",children:x.name}),e.jsx(B,{status:x.status}),e.jsx(O,{reliability:x.reliability})]}),x.description&&e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:x.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[e.jsx(K,{className:"w-3 h-3 inline mr-1"}),x.language]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[e.jsx(X,{className:"w-3 h-3 inline mr-1"}),x.platform]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["v",x.version]}),x.cve_ids.map(y=>e.jsx("span",{className:"px-2 py-0.5 bg-cyan-500/20 text-cyan-400 rounded text-xs",children:y},y))]})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[e.jsx("button",{onClick:()=>f(x),className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-cyan-400",title:"View code",children:e.jsx(_,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>N.mutate(x.id),className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-red-400",title:"Delete",children:e.jsx(Q,{className:"w-4 h-4"})})]})]})},x.id))})}),e.jsx(P,{isOpen:s,onClose:()=>t(!1),title:"Create New PoC",size:"lg",children:e.jsx(le,{onSubmit:x=>p.mutate(x),onCancel:()=>t(!1),isLoading:p.isPending})}),e.jsx(P,{isOpen:!!r&&!!c,onClose:()=>{a(null),m(null)},title:(r==null?void 0:r.name)||"PoC Code",size:"xl",children:c&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-400",children:["Language: ",c.language]}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(c.code),g.success("Code copied to clipboard")},className:"px-3 py-1 bg-gray-700 text-white rounded hover:bg-gray-600 flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4"}),"Copy"]})]}),e.jsx("pre",{className:"bg-gray-900 border border-gray-700 rounded-lg p-4 overflow-x-auto text-sm text-gray-300",children:e.jsx("code",{children:c.code})})]})})]})},le=({onSubmit:s,onCancel:t,isLoading:r})=>{const[a,c]=u.useState({name:"",description:"",cve_ids:"",platform:"linux",language:"python",code:"",tags:""}),m=l=>{l.preventDefault(),s({name:a.name,description:a.description||void 0,cve_ids:a.cve_ids?a.cve_ids.split(",").map(o=>o.trim()):[],platform:a.platform,language:a.language,code:a.code,tags:a.tags?a.tags.split(",").map(o=>o.trim()):[]})};return e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{type:"text",value:a.name,onChange:l=>c({...a,name:l.target.value}),required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"CVE-2021-44228 Log4j RCE PoC"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:a.description,onChange:l=>c({...a,description:l.target.value}),rows:2,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Describe the exploit and usage..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"CVE IDs"}),e.jsx("input",{type:"text",value:a.cve_ids,onChange:l=>c({...a,cve_ids:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"CVE-2021-44228, CVE-2021-45046"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Tags"}),e.jsx("input",{type:"text",value:a.tags,onChange:l=>c({...a,tags:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"rce, log4j, java"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Platform"}),e.jsxs("select",{value:a.platform,onChange:l=>c({...a,platform:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"linux",children:"Linux"}),e.jsx("option",{value:"windows",children:"Windows"}),e.jsx("option",{value:"macos",children:"macOS"}),e.jsx("option",{value:"multi",children:"Multi-Platform"}),e.jsx("option",{value:"web",children:"Web Application"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Language"}),e.jsxs("select",{value:a.language,onChange:l=>c({...a,language:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"python",children:"Python"}),e.jsx("option",{value:"ruby",children:"Ruby"}),e.jsx("option",{value:"c",children:"C"}),e.jsx("option",{value:"cpp",children:"C++"}),e.jsx("option",{value:"go",children:"Go"}),e.jsx("option",{value:"rust",children:"Rust"}),e.jsx("option",{value:"javascript",children:"JavaScript"}),e.jsx("option",{value:"bash",children:"Bash"}),e.jsx("option",{value:"powershell",children:"PowerShell"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Code *"}),e.jsx("textarea",{value:a.code,onChange:l=>c({...a,code:l.target.value}),required:!0,rows:10,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white font-mono text-sm focus:ring-2 focus:ring-cyan-500",placeholder:"#!/usr/bin/env python3..."})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:r,className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2 disabled:opacity-50",children:[r?e.jsx(b,{className:"w-4 h-4 animate-spin"}):e.jsx(F,{className:"w-4 h-4"}),"Create PoC"]})]})]})},ie=()=>{const[s,t]=u.useState(!1),r=E(),{data:a,isLoading:c}=v({queryKey:["research-workspaces"],queryFn:()=>h.listWorkspaces()}),m=j({mutationFn:h.createWorkspace,onSuccess:()=>{g.success("Workspace created"),t(!1),r.invalidateQueries({queryKey:["research-workspaces"]})},onError:()=>g.error("Failed to create workspace")}),l=j({mutationFn:h.deleteWorkspace,onSuccess:()=>{g.success("Workspace deleted"),r.invalidateQueries({queryKey:["research-workspaces"]})},onError:()=>g.error("Failed to delete workspace")}),o=async(d,p)=>{try{const N=await h.exportWorkspace(d),f=new Blob([N.markdown],{type:"text/markdown"}),x=URL.createObjectURL(f),y=document.createElement("a");y.href=x,y.download=`${p.replace(/\s+/g,"_")}_research.md`,y.click(),URL.revokeObjectURL(x),g.success("Workspace exported")}catch{g.error("Failed to export workspace")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Research Workspaces"}),e.jsxs("button",{onClick:()=>t(!0),className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4"}),"New Workspace"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c?e.jsx("div",{className:"col-span-full p-8 text-center",children:e.jsx(b,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto"})}):(a==null?void 0:a.length)===0?e.jsxs("div",{className:"col-span-full p-8 text-center bg-gray-800 border border-gray-700 rounded-lg",children:[e.jsx(T,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No workspaces yet. Create one to start researching!"})]}):a==null?void 0:a.map(d=>e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4 hover:border-gray-600",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h4",{className:"text-white font-medium",children:d.name}),e.jsx(B,{status:d.status})]}),d.cve_id&&e.jsx("span",{className:"inline-block px-2 py-0.5 bg-cyan-500/20 text-cyan-400 rounded text-xs mb-2",children:d.cve_id}),d.description&&e.jsx("p",{className:"text-sm text-gray-400 mb-3 line-clamp-2",children:d.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:[d.exploit_ids.length," exploits"]}),e.jsxs("span",{children:[d.note_ids.length," notes"]})]}),e.jsxs("div",{className:"flex items-center gap-1 mt-3 pt-3 border-t border-gray-700",children:[e.jsx("button",{onClick:()=>o(d.id,d.name),className:"flex-1 p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-cyan-400 flex items-center justify-center gap-1",title:"Export",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>l.mutate(d.id),className:"flex-1 p-2 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-red-400 flex items-center justify-center gap-1",title:"Delete",children:e.jsx(Q,{className:"w-4 h-4"})})]})]},d.id))}),e.jsx(P,{isOpen:s,onClose:()=>t(!1),title:"Create Research Workspace",children:e.jsx(ce,{onSubmit:d=>m.mutate(d),onCancel:()=>t(!1),isLoading:m.isPending})})]})},ce=({onSubmit:s,onCancel:t,isLoading:r})=>{const[a,c]=u.useState({name:"",description:"",cve_id:"",visibility:"private",tags:""}),m=l=>{l.preventDefault(),s({name:a.name,description:a.description||void 0,cve_id:a.cve_id||void 0,visibility:a.visibility,tags:a.tags?a.tags.split(",").map(o=>o.trim()):[]})};return e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{type:"text",value:a.name,onChange:l=>c({...a,name:l.target.value}),required:!0,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"Log4j Research"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:a.description,onChange:l=>c({...a,description:l.target.value}),rows:2,className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"CVE ID (optional)"}),e.jsx("input",{type:"text",value:a.cve_id,onChange:l=>c({...a,cve_id:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"CVE-2021-44228"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Visibility"}),e.jsxs("select",{value:a.visibility,onChange:l=>c({...a,visibility:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"private",children:"Private"}),e.jsx("option",{value:"team",children:"Team"}),e.jsx("option",{value:"public",children:"Public"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Tags"}),e.jsx("input",{type:"text",value:a.tags,onChange:l=>c({...a,tags:l.target.value}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:ring-2 focus:ring-cyan-500",placeholder:"log4j, rce, java"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:r,className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 flex items-center gap-2 disabled:opacity-50",children:[r?e.jsx(b,{className:"w-4 h-4 animate-spin"}):e.jsx(F,{className:"w-4 h-4"}),"Create"]})]})]})},ne=()=>{const s=E(),{data:t,isLoading:r}=v({queryKey:["exploit-favorites"],queryFn:h.listFavorites}),a=j({mutationFn:h.removeFavorite,onSuccess:()=>{g.success("Removed from favorites"),s.invalidateQueries({queryKey:["exploit-favorites"]})},onError:()=>g.error("Failed to remove favorite")});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Favorite Exploits"}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:r?e.jsx("div",{className:"p-8 text-center",children:e.jsx(b,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto"})}):(t==null?void 0:t.length)===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(S,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No favorites yet. Star exploits to save them here!"})]}):e.jsx("div",{className:"divide-y divide-gray-700",children:t==null?void 0:t.map(c=>e.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-gray-700/30",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:c.exploit_title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(C,{source:c.exploit_source}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Added ",new Date(c.added_at).toLocaleDateString()]})]})]}),e.jsx("button",{onClick:()=>a.mutate(c.exploit_id),className:"p-2 rounded-lg hover:bg-gray-700 text-yellow-400 hover:text-gray-400",title:"Remove from favorites",children:e.jsx(S,{className:"w-4 h-4 fill-current"})})]},c.id))})})]})},oe=()=>{const{data:s,isLoading:t}=v({queryKey:["exploit-search-history"],queryFn:h.getSearchHistory});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Search History"}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg",children:t?e.jsx("div",{className:"p-8 text-center",children:e.jsx(b,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto"})}):(s==null?void 0:s.length)===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(V,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No search history yet."})]}):e.jsx("div",{className:"divide-y divide-gray-700",children:s==null?void 0:s.map(r=>e.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-gray-700/30",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:r.query}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[r.results_count," results"]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(r.searched_at).toLocaleString()})]})]}),e.jsx(k,{className:"w-4 h-4 text-gray-500"})]},r.id))})})]})},he=()=>{const[s,t]=u.useState("search"),r=[{id:"search",label:"Search",icon:k},{id:"cve-mapping",label:"CVE Mapping",icon:U},{id:"pocs",label:"PoC Repository",icon:_},{id:"workspaces",label:"Workspaces",icon:T},{id:"favorites",label:"Favorites",icon:S},{id:"history",label:"History",icon:V}];return e.jsx(ee,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(W,{className:"w-6 h-6 text-cyan-400"}),"Exploit Database"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Search exploits, manage PoCs, and organize your vulnerability research"})]})}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-1",children:r.map(a=>e.jsxs("button",{onClick:()=>t(a.id),className:`px-4 py-3 text-sm font-medium flex items-center gap-2 border-b-2 transition-colors ${s===a.id?"text-cyan-400 border-cyan-400":"text-gray-400 border-transparent hover:text-white hover:border-gray-600"}`,children:[e.jsx(a.icon,{className:"w-4 h-4"}),a.label]},a.id))})}),e.jsxs("div",{className:"mt-6",children:[s==="search"&&e.jsx(te,{}),s==="cve-mapping"&&e.jsx(ae,{}),s==="pocs"&&e.jsx(re,{}),s==="workspaces"&&e.jsx(ie,{}),s==="favorites"&&e.jsx(ne,{}),s==="history"&&e.jsx(oe,{})]})]})})};export{he as default};
