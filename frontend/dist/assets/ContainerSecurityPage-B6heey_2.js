import{j as e,b as oe,u as L,d as U}from"./vendor-state-BjT_zREg.js";import{r as x}from"./vendor-react-5KxtEOLM.js";import{ah as M,n as T,a2 as D,aY as H,O as _,x as xe,bg as X,B as f,a9 as I,p as me,g as E,i as re,ab as ge,bM as pe,l as le,_ as B,S as he,h as W,$ as ye,b1 as ue,d as be,I as je,af as Ne,a as ve,m as Y,aw as fe}from"./vendor-ui-C4nf_tR6.js";import{L as we}from"./Layout-DQwy8A8G.js";import{I as P,B as F,$ as C}from"./index-RI0GBk2h.js";import{B as j}from"./Badge-Bi3Nk-Vg.js";import{C as Se}from"./Checkbox-DniaXErv.js";import{u as _e,E as ke}from"./useRequireEngagement-BnpzaIEh.js";import"./vendor-markdown-BGP8SuZQ.js";import"./vendor-utils-DfRopTPV.js";const Ce=[{id:"image",name:"Container Image Scan",description:"Scan Docker/OCI images for vulnerabilities and misconfigurations",requires_registry:!0,requires_k8s:!1},{id:"dockerfile",name:"Dockerfile Analysis",description:"Analyze Dockerfiles for security best practices and potential issues",requires_registry:!1,requires_k8s:!1},{id:"runtime",name:"Container Runtime Scan",description:"Scan running containers for runtime security issues",requires_registry:!1,requires_k8s:!1},{id:"k8s_manifest",name:"K8s Manifest Analysis",description:"Analyze Kubernetes manifests for security configurations",requires_registry:!1,requires_k8s:!0},{id:"k8s_cluster",name:"K8s Cluster Assessment",description:"Comprehensive Kubernetes cluster security assessment",requires_registry:!1,requires_k8s:!0},{id:"comprehensive",name:"Comprehensive Scan",description:"Full container and Kubernetes security assessment",requires_registry:!0,requires_k8s:!0}],Fe={image:e.jsx(M,{className:"w-5 h-5"}),dockerfile:e.jsx(X,{className:"w-5 h-5"}),runtime:e.jsx(xe,{className:"w-5 h-5"}),k8s_manifest:e.jsx(T,{className:"w-5 h-5"}),k8s_cluster:e.jsx(T,{className:"w-5 h-5"}),comprehensive:e.jsx(_,{className:"w-5 h-5"})};function Re({onSubmit:n,isLoading:g,scanTypes:l=Ce,disabled:h}){const[r,w]=x.useState(""),[u,R]=x.useState("image"),[m,$]=x.useState(""),[b,k]=x.useState(""),[S,o]=x.useState(""),[a,s]=x.useState(""),[i,p]=x.useState(""),[y,A]=x.useState(""),[q,O]=x.useState(!1),d=l.find(c=>c.id===u),z=c=>{c.preventDefault();const K={name:r||`Container Scan - ${new Date().toLocaleString()}`,scan_type:u,target:m,demo_mode:q};d!=null&&d.requires_registry&&b&&(K.registry_url=b,S&&(K.registry_username=S),a&&(K.registry_password=a)),d!=null&&d.requires_k8s&&(i&&(K.k8s_context=i),y&&(K.k8s_namespace=y)),n(K)},V=()=>{switch(u){case"image":return"e.g., nginx:latest, myregistry.com/myapp:v1.0";case"dockerfile":return"Path to Dockerfile or directory containing Dockerfile";case"runtime":return"Container ID or name";case"k8s_manifest":return"Path to Kubernetes manifest(s) or directory";case"k8s_cluster":return"Kubernetes cluster context name";case"comprehensive":return"Image name or K8s namespace";default:return"Enter target"}};return e.jsxs("form",{onSubmit:z,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-300 mb-2",children:"Scan Name"}),e.jsx(P,{id:"name",value:r,onChange:c=>w(c.target.value),placeholder:"Optional: Give your scan a name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Scan Type"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:l.map(c=>e.jsxs("button",{type:"button",onClick:()=>R(c.id),className:`p-4 rounded-lg border-2 text-left transition-all ${u===c.id?"border-cyan-500 bg-cyan-500/10":"border-gray-700 bg-gray-800/50 hover:border-gray-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:u===c.id?"text-cyan-400":"text-gray-400",children:Fe[c.id]}),e.jsx("span",{className:`font-medium ${u===c.id?"text-cyan-400":"text-gray-200"}`,children:c.name})]}),e.jsx("p",{className:"text-sm text-gray-400",children:c.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[c.requires_registry&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded",children:"Registry"}),c.requires_k8s&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-purple-500/20 text-purple-400 rounded",children:"K8s"})]})]},c.id))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"target",className:"block text-sm font-medium text-gray-300 mb-2",children:"Target"}),e.jsx(P,{id:"target",value:m,onChange:c=>$(c.target.value),placeholder:V(),required:!0})]}),(d==null?void 0:d.requires_registry)&&e.jsxs("div",{className:"space-y-4 p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-300 flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"Container Registry Settings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"registryUrl",className:"block text-xs text-gray-400 mb-1",children:"Registry URL (optional)"}),e.jsx(P,{id:"registryUrl",value:b,onChange:c=>k(c.target.value),placeholder:"e.g., registry.example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"registryUsername",className:"block text-xs text-gray-400 mb-1",children:"Username"}),e.jsx(P,{id:"registryUsername",value:S,onChange:c=>o(c.target.value),placeholder:"Optional"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"registryPassword",className:"block text-xs text-gray-400 mb-1",children:"Password/Token"}),e.jsx(P,{id:"registryPassword",type:"password",value:a,onChange:c=>s(c.target.value),placeholder:"Optional"})]})]})]}),(d==null?void 0:d.requires_k8s)&&e.jsxs("div",{className:"space-y-4 p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-300 flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"Kubernetes Settings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"k8sContext",className:"block text-xs text-gray-400 mb-1",children:"K8s Context (optional)"}),e.jsx(P,{id:"k8sContext",value:i,onChange:c=>p(c.target.value),placeholder:"e.g., minikube, production-cluster"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"k8sNamespace",className:"block text-xs text-gray-400 mb-1",children:"Namespace (optional)"}),e.jsx(P,{id:"k8sNamespace",value:y,onChange:c=>A(c.target.value),placeholder:"e.g., default, production"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-yellow-500/10 rounded-lg border border-yellow-500/30",children:[e.jsx(Se,{id:"demoMode",checked:q,onChange:c=>O(c)}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"demoMode",className:"text-sm font-medium text-yellow-400 cursor-pointer",children:"Demo Mode"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Run with simulated data for testing. No actual container scanning will be performed."})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-500/10 rounded-lg border border-blue-500/30",children:[e.jsx(D,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-gray-300",children:[e.jsx("p",{className:"font-medium text-blue-400 mb-1",children:"Scanning Requirements"}),e.jsxs("ul",{className:"list-disc list-inside text-gray-400 space-y-1",children:[e.jsx("li",{children:"Image scans require Trivy or Grype to be installed"}),e.jsx("li",{children:"Runtime scans require Docker daemon access"}),e.jsx("li",{children:"K8s scans require kubectl configured with cluster access"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(F,{type:"submit",disabled:g||!m||h,children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),g?"Starting Scan...":"Start Scan"]})})]})}const v={critical:{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500"},high:{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500"},low:{bg:"bg-blue-500/20",text:"text-blue-400",border:"border-blue-500"},info:{bg:"bg-gray-500/20",text:"text-gray-400",border:"border-gray-500"}},ne={pending:{bg:"bg-yellow-500/20",text:"text-yellow-400"},running:{bg:"bg-blue-500/20",text:"text-blue-400"},completed:{bg:"bg-green-500/20",text:"text-green-400"},failed:{bg:"bg-red-500/20",text:"text-red-400"}},ie={open:{bg:"bg-red-500/20",text:"text-red-400"},resolved:{bg:"bg-green-500/20",text:"text-green-400"},accepted:{bg:"bg-blue-500/20",text:"text-blue-400"},false_positive:{bg:"bg-gray-500/20",text:"text-gray-400"}};function $e({scanId:n,onDelete:g}){var K,J,Z,ee,se;const[l,h]=x.useState(null),[r,w]=x.useState(new Set),[u,R]=x.useState(new Set),[m,$]=x.useState("all"),[b,k]=x.useState("all"),S=oe(),{data:o,isLoading:a,refetch:s}=L({queryKey:["containerScan",n],queryFn:()=>C.getScan(n).then(t=>t.data),refetchInterval:t=>{var te,ae;const N=(ae=(te=t.state.data)==null?void 0:te.scan)==null?void 0:ae.status;return N==="running"||N==="pending"?3e3:!1}}),{data:i=[],isLoading:p}=L({queryKey:["containerFindings",n,m,b],queryFn:()=>C.getFindings(n,{severity:m!=="all"?m:void 0,status:b!=="all"?b:void 0}).then(t=>t.data),enabled:((K=o==null?void 0:o.scan)==null?void 0:K.status)==="completed"}),{data:y=[]}=L({queryKey:["containerImages",n],queryFn:()=>C.getImages(n).then(t=>t.data),enabled:((J=o==null?void 0:o.scan)==null?void 0:J.status)==="completed"}),{data:A=[]}=L({queryKey:["containerResources",n],queryFn:()=>C.getResources(n).then(t=>t.data),enabled:((Z=o==null?void 0:o.scan)==null?void 0:Z.status)==="completed"}),q=U({mutationFn:({findingId:t,status:N})=>C.updateFindingStatus(t,{status:N}),onSuccess:()=>{S.invalidateQueries({queryKey:["containerFindings",n]}),S.invalidateQueries({queryKey:["containerScan",n]}),f.success("Finding status updated")},onError:()=>{f.error("Failed to update finding status")}}),O=U({mutationFn:()=>C.deleteScan(n),onSuccess:()=>{f.success("Scan deleted"),g==null||g()},onError:()=>{f.error("Failed to delete scan")}}),d=o==null?void 0:o.scan,z=o==null?void 0:o.summary;if(a)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(I,{className:"w-8 h-8 text-cyan-400 animate-spin"})});if(!d)return e.jsx("div",{className:"text-center p-12 text-gray-400",children:"Scan not found"});const V=t=>{const N=new Set(r);N.has(t)?N.delete(t):N.add(t),w(N)},c=t=>{const N=new Set(u);N.has(t)?N.delete(t):N.add(t),R(N)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:d.name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(M,{className:"w-4 h-4"}),d.scan_type.replace("_"," ")]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(me,{className:"w-4 h-4"}),new Date(d.created_at).toLocaleString()]})]}),e.jsx("p",{className:"text-gray-300 mt-2",children:d.target})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(j,{className:`${(ee=ne[d.status])==null?void 0:ee.bg} ${(se=ne[d.status])==null?void 0:se.text}`,children:[d.status==="running"&&e.jsx(I,{className:"w-3 h-3 mr-1 animate-spin"}),d.status==="completed"&&e.jsx(E,{className:"w-3 h-3 mr-1"}),d.status==="failed"&&e.jsx(re,{className:"w-3 h-3 mr-1"}),d.status]}),e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>s(),children:e.jsx(I,{className:"w-4 h-4"})}),e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>O.mutate(),children:e.jsx(ge,{className:"w-4 h-4 text-red-400"})})]})]}),d.error_message&&e.jsx("div",{className:"mt-4 p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400",children:d.error_message})]}),z&&d.status==="completed"&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:z.total_findings}),e.jsx("div",{className:"text-sm text-gray-400",children:"Total Findings"})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${v.critical.border} ${v.critical.bg}`,children:[e.jsx("div",{className:`text-2xl font-bold ${v.critical.text}`,children:z.critical_count}),e.jsx("div",{className:"text-sm text-gray-400",children:"Critical"})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${v.high.border} ${v.high.bg}`,children:[e.jsx("div",{className:`text-2xl font-bold ${v.high.text}`,children:z.high_count}),e.jsx("div",{className:"text-sm text-gray-400",children:"High"})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${v.medium.border} ${v.medium.bg}`,children:[e.jsx("div",{className:`text-2xl font-bold ${v.medium.text}`,children:z.medium_count}),e.jsx("div",{className:"text-sm text-gray-400",children:"Medium"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:z.images_scanned}),e.jsx("div",{className:"text-sm text-gray-400",children:"Images"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:z.resources_scanned}),e.jsx("div",{className:"text-sm text-gray-400",children:"K8s Resources"})]})]}),(d.status==="running"||d.status==="pending")&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 border border-gray-700 text-center",children:[e.jsx(I,{className:"w-12 h-12 text-cyan-400 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300",children:"Scan in progress..."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"This page will automatically refresh when the scan completes."})]}),y.length>0&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5 text-cyan-400"}),"Scanned Images (",y.length,")"]})}),e.jsx("div",{className:"divide-y divide-gray-700",children:y.map(t=>e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{onClick:()=>V(t.id),className:"w-full flex items-center justify-between text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[r.has(t.id)?e.jsx(le,{className:"w-4 h-4 text-gray-400"}):e.jsx(B,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"font-mono text-cyan-400",children:[t.image_name,":",t.image_tag]})]}),t.registry&&e.jsx("span",{className:"text-sm text-gray-400",children:t.registry})]}),r.has(t.id)&&e.jsxs("div",{className:"mt-3 ml-7 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.os&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"OS:"})," ",e.jsx("span",{className:"text-gray-200",children:t.os})]}),t.architecture&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Arch:"})," ",e.jsx("span",{className:"text-gray-200",children:t.architecture})]}),t.layer_count&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Layers:"})," ",e.jsx("span",{className:"text-gray-200",children:t.layer_count})]}),t.size_bytes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Size:"})," ",e.jsxs("span",{className:"text-gray-200",children:[(t.size_bytes/1024/1024).toFixed(1)," MB"]})]})]})]},t.id))})]}),A.length>0&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-purple-400"}),"Kubernetes Resources (",A.length,")"]})}),e.jsx("div",{className:"divide-y divide-gray-700",children:A.map(t=>e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{onClick:()=>c(t.id),className:"w-full flex items-center justify-between text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[u.has(t.id)?e.jsx(le,{className:"w-4 h-4 text-gray-400"}):e.jsx(B,{className:"w-4 h-4 text-gray-400"}),e.jsx(j,{className:"bg-purple-500/20 text-purple-400",children:t.resource_type}),e.jsx("span",{className:"text-gray-200",children:t.name})]}),t.namespace&&e.jsxs("span",{className:"text-sm text-gray-400",children:["ns: ",t.namespace]})]}),u.has(t.id)&&e.jsxs("div",{className:"mt-3 ml-7 text-sm text-gray-400",children:[t.api_version&&e.jsxs("div",{children:["API Version: ",t.api_version]}),t.spec_summary&&e.jsx("div",{className:"mt-1",children:t.spec_summary})]})]},t.id))})]}),d.status==="completed"&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-cyan-400"}),"Security Findings (",i.length,")"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:m,onChange:t=>$(t.target.value),className:"bg-gray-700 border border-gray-600 rounded px-3 py-1 text-sm text-gray-200",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"info",children:"Info"})]}),e.jsxs("select",{value:b,onChange:t=>k(t.target.value),className:"bg-gray-700 border border-gray-600 rounded px-3 py-1 text-sm text-gray-200",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"accepted",children:"Accepted"}),e.jsx("option",{value:"false_positive",children:"False Positive"})]})]})]})}),p?e.jsx("div",{className:"p-8 text-center",children:e.jsx(I,{className:"w-6 h-6 text-gray-400 animate-spin mx-auto"})}):i.length===0?e.jsx("div",{className:"p-8 text-center text-gray-400",children:m!=="all"||b!=="all"?"No findings match the current filters":"No security findings detected"}):e.jsx("div",{className:"divide-y divide-gray-700",children:i.map(t=>e.jsx("div",{className:`p-4 cursor-pointer hover:bg-gray-700/50 transition-colors ${(l==null?void 0:l.id)===t.id?"bg-gray-700/50":""}`,onClick:()=>h(t),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:`mt-0.5 ${v[t.severity].text}`,children:[t.severity==="critical"&&e.jsx(W,{className:"w-5 h-5"}),t.severity==="high"&&e.jsx(_,{className:"w-5 h-5"}),t.severity==="medium"&&e.jsx(_,{className:"w-5 h-5"}),t.severity==="low"&&e.jsx(D,{className:"w-5 h-5"}),t.severity==="info"&&e.jsx(D,{className:"w-5 h-5"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-200",children:t.title}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[e.jsx(j,{className:`${v[t.severity].bg} ${v[t.severity].text}`,children:t.severity}),e.jsx(j,{className:"bg-gray-700 text-gray-300",children:t.finding_type.replace("_"," ")}),t.cve_id&&e.jsx(j,{className:"bg-purple-500/20 text-purple-400",children:t.cve_id}),t.cvss_score&&e.jsxs(j,{className:"bg-gray-700 text-gray-300",children:["CVSS: ",t.cvss_score.toFixed(1)]}),t.package_name&&e.jsxs(j,{className:"bg-blue-500/20 text-blue-400",children:[t.package_name,t.installed_version&&` @ ${t.installed_version}`]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(j,{className:`${ie[t.status].bg} ${ie[t.status].text}`,children:t.status.replace("_"," ")})})]})},t.id))})]}),l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto border border-gray-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:l.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(j,{className:`${v[l.severity].bg} ${v[l.severity].text}`,children:l.severity}),l.cve_id&&e.jsxs("a",{href:`https://nvd.nist.gov/vuln/detail/${l.cve_id}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-cyan-400 hover:text-cyan-300",children:[l.cve_id,e.jsx(ye,{className:"w-3 h-3"})]})]})]}),e.jsx("button",{onClick:()=>h(null),className:"text-gray-400 hover:text-gray-200",children:e.jsx(re,{className:"w-6 h-6"})})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Description"}),e.jsx("p",{className:"text-gray-200",children:l.description})]}),l.package_name&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Affected Package"}),e.jsxs("p",{className:"text-gray-200",children:[l.package_name,l.installed_version&&` (${l.installed_version})`]})]}),l.fixed_version&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Fixed In"}),e.jsx("p",{className:"text-green-400",children:l.fixed_version})]}),l.file_path&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Location"}),e.jsxs("p",{className:"font-mono text-gray-200",children:[l.file_path,l.line_number&&`:${l.line_number}`]})]}),l.remediation&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-1",children:"Remediation"}),e.jsx("p",{className:"text-gray-200",children:l.remediation})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"Update Status"}),e.jsx("div",{className:"flex items-center gap-2",children:["open","resolved","accepted","false_positive"].map(t=>e.jsx(F,{variant:l.status===t?"primary":"ghost",size:"sm",onClick:()=>{q.mutate({findingId:l.id,status:t}),h({...l,status:t})},children:t.replace("_"," ")},t))})]})]})]})})]})}const G={critical:{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500"},high:{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500"},low:{bg:"bg-blue-500/20",text:"text-blue-400",border:"border-blue-500"},info:{bg:"bg-gray-500/20",text:"text-gray-400",border:"border-gray-500"}},qe=`FROM ubuntu:latest

ENV DATABASE_PASSWORD=secretpassword123
ENV API_KEY=sk-1234567890abcdef

RUN apt-get update && apt-get install -y curl
RUN chmod 777 /app
RUN curl https://example.com/script.sh | bash

USER root

EXPOSE 22 3306

CMD ["./app"]
`;function Ae(){const[n,g]=x.useState(""),[l,h]=x.useState("Dockerfile"),[r,w]=x.useState(null),[u,R]=x.useState(null),m=U({mutationFn:()=>C.analyzeDockerfile({content:n,filename:l}).then(s=>s.data),onSuccess:s=>{w(s),s.issues.length===0?f.success("No security issues found!"):f.info(`Found ${s.issues.length} security issue(s)`)},onError:()=>{f.error("Failed to analyze Dockerfile")}}),$=s=>{var p;const i=(p=s.target.files)==null?void 0:p[0];if(i){h(i.name);const y=new FileReader;y.onload=A=>{var q;g((q=A.target)==null?void 0:q.result)},y.readAsText(i)}},b=()=>{g(qe),h("Dockerfile.example"),w(null)},k=(s,i)=>{navigator.clipboard.writeText(s),R(i),setTimeout(()=>R(null),2e3)},S=s=>{switch(s){case"critical":return e.jsx(W,{className:"w-5 h-5"});case"high":return e.jsx(_,{className:"w-5 h-5"});case"medium":return e.jsx(_,{className:"w-5 h-5"});case"low":return e.jsx(D,{className:"w-5 h-5"});case"info":return e.jsx(D,{className:"w-5 h-5"})}},o=s=>s>=80?"text-green-400":s>=60?"text-yellow-400":s>=40?"text-orange-400":"text-red-400",a=s=>s>=90?"A":s>=80?"B":s>=70?"C":s>=60?"D":"F";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5 text-cyan-400"}),"Dockerfile Analyzer"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{variant:"ghost",size:"sm",onClick:b,children:"Load Example"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"Dockerfile,.dockerfile",onChange:$,className:"hidden"}),e.jsxs("span",{className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-gray-700 hover:bg-gray-600 rounded-lg text-gray-200 transition-colors",children:[e.jsx(ue,{className:"w-4 h-4"}),"Upload"]})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Paste your Dockerfile content below:"}),e.jsx("textarea",{value:n,onChange:s=>g(s.target.value),placeholder:`FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

COPY . .

USER node
EXPOSE 3000
CMD ["node", "server.js"]`,className:"w-full h-64 bg-gray-900 border border-gray-700 rounded-lg p-4 font-mono text-sm text-gray-200 placeholder-gray-600 focus:outline-none focus:border-cyan-500 resize-none"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-400",children:l&&`File: ${l}`}),e.jsxs(F,{onClick:()=>m.mutate(),disabled:!n.trim()||m.isPending,children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),m.isPending?"Analyzing...":"Analyze Dockerfile"]})]})]}),r&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Security Score"}),e.jsxs("div",{className:`text-3xl font-bold ${o(r.security_score)}`,children:[r.security_score,"/100"]})]}),e.jsx("div",{className:`text-4xl font-bold ${o(r.security_score)}`,children:a(r.security_score)})]})}),e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Best Practices"}),e.jsxs("div",{className:`text-3xl font-bold ${o(r.best_practices_score)}`,children:[r.best_practices_score,"/100"]})]}),e.jsx("div",{className:`text-4xl font-bold ${o(r.best_practices_score)}`,children:a(r.best_practices_score)})]})}),e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Base Image"}),e.jsx("div",{className:"text-lg font-medium text-gray-200",children:r.base_image||"Unknown"}),r.base_image_tag&&e.jsxs("div",{className:"text-sm text-gray-400",children:["Tag: ",r.base_image_tag]})]}),r.base_image_tag==="latest"?e.jsx(_,{className:"w-8 h-8 text-yellow-400"}):e.jsx(E,{className:"w-8 h-8 text-green-400"})]})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:r.issues.length===0?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-5 h-5 text-green-400"}),"No Security Issues Found"]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-5 h-5 text-yellow-400"}),"Security Issues (",r.issues.length,")"]})})}),r.issues.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(E,{className:"w-12 h-12 text-green-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300",children:"Your Dockerfile follows security best practices!"})]}):e.jsx("div",{className:"divide-y divide-gray-700",children:r.issues.map((s,i)=>e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:G[s.severity].text,children:S(s.severity)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium text-gray-200",children:s.title}),e.jsx(j,{className:`${G[s.severity].bg} ${G[s.severity].text}`,children:s.severity}),s.line_number&&e.jsxs(j,{className:"bg-gray-700 text-gray-300",children:["Line ",s.line_number]})]}),e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:s.description}),s.instruction&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-xs text-gray-500 uppercase",children:"Problematic Code:"}),e.jsxs("div",{className:"mt-1 bg-red-500/10 border border-red-500/30 rounded p-2 font-mono text-sm text-red-300 flex items-center justify-between",children:[e.jsx("code",{className:"truncate",children:s.instruction}),e.jsx("button",{onClick:()=>k(s.instruction||"",i),className:"ml-2 text-gray-400 hover:text-gray-200",children:u===i?e.jsx(be,{className:"w-4 h-4 text-green-400"}):e.jsx(je,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded p-3",children:[e.jsx("span",{className:"text-xs text-green-500 uppercase block mb-1",children:"Remediation:"}),e.jsx("p",{className:"text-sm text-green-300",children:s.remediation})]}),s.references&&s.references.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-xs text-gray-500 uppercase",children:"References:"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:s.references.map((p,y)=>e.jsx("a",{href:p,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-cyan-400 hover:text-cyan-300",children:p},y))})]})]})]})},i))})]})]})]})}const Q={critical:{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500"},high:{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500"},low:{bg:"bg-blue-500/20",text:"text-blue-400",border:"border-blue-500"},info:{bg:"bg-gray-500/20",text:"text-gray-400",border:"border-gray-500"}},ze={pod_security:e.jsx(he,{className:"w-4 h-4"}),rbac:e.jsx(ve,{className:"w-4 h-4"}),network_policy:e.jsx(Ne,{className:"w-4 h-4"}),resource_limits:e.jsx(xe,{className:"w-4 h-4"}),misconfiguration:e.jsx(_,{className:"w-4 h-4"})},Ke=`apiVersion: apps/v1
kind: Deployment
metadata:
  name: vulnerable-app
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      app: vulnerable-app
  template:
    metadata:
      labels:
        app: vulnerable-app
    spec:
      containers:
      - name: app
        image: myapp:latest
        securityContext:
          privileged: true
          runAsRoot: true
        ports:
        - containerPort: 8080
---
apiVersion: v1
kind: Service
metadata:
  name: vulnerable-app-svc
spec:
  type: LoadBalancer
  selector:
    app: vulnerable-app
  ports:
  - port: 80
    targetPort: 8080
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: app-admin
subjects:
- kind: ServiceAccount
  name: default
  namespace: default
roleRef:
  kind: ClusterRole
  name: cluster-admin
  apiGroup: rbac.authorization.k8s.io
`;function Pe(){const[n,g]=x.useState(""),[l,h]=x.useState("manifest.yaml"),[r,w]=x.useState(null),[u,R]=x.useState(!0),m=U({mutationFn:()=>C.analyzeManifest({content:n,filename:l}).then(s=>s.data),onSuccess:s=>{w(s),s.issues.length===0?f.success("No security issues found!"):f.info(`Found ${s.issues.length} security issue(s)`)},onError:()=>{f.error("Failed to analyze manifest")}}),$=s=>{var p;const i=(p=s.target.files)==null?void 0:p[0];if(i){h(i.name);const y=new FileReader;y.onload=A=>{var q;g((q=A.target)==null?void 0:q.result)},y.readAsText(i)}},b=()=>{g(Ke),h("vulnerable-deployment.yaml"),w(null)},k=s=>{switch(s){case"critical":return e.jsx(W,{className:"w-5 h-5"});case"high":return e.jsx(_,{className:"w-5 h-5"});case"medium":return e.jsx(_,{className:"w-5 h-5"});case"low":return e.jsx(D,{className:"w-5 h-5"});case"info":return e.jsx(D,{className:"w-5 h-5"})}},S=s=>s>=80?"text-green-400":s>=60?"text-yellow-400":s>=40?"text-orange-400":"text-red-400",o=s=>s>=90?"A":s>=80?"B":s>=70?"C":s>=60?"D":"F",a=(r==null?void 0:r.issues.reduce((s,i)=>{const p=i.finding_type;return s[p]||(s[p]=[]),s[p].push(i),s},{}))||{};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-purple-400"}),"Kubernetes Manifest Analyzer"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{variant:"ghost",size:"sm",onClick:b,children:"Load Example"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:".yaml,.yml,.json",onChange:$,className:"hidden"}),e.jsxs("span",{className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-gray-700 hover:bg-gray-600 rounded-lg text-gray-200 transition-colors",children:[e.jsx(ue,{className:"w-4 h-4"}),"Upload"]})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Paste your Kubernetes manifest (YAML or JSON):"}),e.jsx("textarea",{value:n,onChange:s=>g(s.target.value),placeholder:`apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-app
spec:
  replicas: 3
  ...`,className:"w-full h-64 bg-gray-900 border border-gray-700 rounded-lg p-4 font-mono text-sm text-gray-200 placeholder-gray-600 focus:outline-none focus:border-purple-500 resize-none"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-400",children:l&&`File: ${l}`}),e.jsxs(F,{onClick:()=>m.mutate(),disabled:!n.trim()||m.isPending,className:"bg-purple-600 hover:bg-purple-700",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),m.isPending?"Analyzing...":"Analyze Manifest"]})]})]}),r&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Security Score"}),e.jsxs("div",{className:`text-3xl font-bold ${S(r.security_score)}`,children:[r.security_score,"/100"]})]}),e.jsx("div",{className:`text-4xl font-bold ${S(r.security_score)}`,children:o(r.security_score)})]})}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Resources Analyzed"}),e.jsx("div",{className:"text-3xl font-bold text-white",children:r.resources_analyzed})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Issues Found"}),e.jsx("div",{className:`text-3xl font-bold ${r.issues.length>0?"text-yellow-400":"text-green-400"}`,children:r.issues.length})]})]}),Object.keys(r.by_resource_type).length>0&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Resource Types Analyzed"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(r.by_resource_type).map(([s,i])=>e.jsxs(j,{className:"bg-purple-500/20 text-purple-400 px-3 py-1",children:[s,": ",i]},s))})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:r.issues.length===0?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-5 h-5 text-green-400"}),"No Security Issues Found"]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-5 h-5 text-yellow-400"}),"Security Issues (",r.issues.length,")"]})}),r.issues.length>0&&e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>R(!u),children:u?"Show All":"Group by Type"})]}),r.issues.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(E,{className:"w-12 h-12 text-green-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300",children:"Your Kubernetes manifests follow security best practices!"})]}):u?e.jsx("div",{className:"divide-y divide-gray-700",children:Object.entries(a).map(([s,i])=>e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"text-purple-400",children:ze[s]||e.jsx(_,{className:"w-4 h-4"})}),e.jsxs("h4",{className:"font-medium text-gray-200 capitalize",children:[s.replace("_"," ")," Issues (",i.length,")"]})]}),e.jsx("div",{className:"space-y-3 ml-6",children:i.map((p,y)=>e.jsx(ce,{issue:p,getSeverityIcon:k},y))})]},s))}):e.jsx("div",{className:"divide-y divide-gray-700",children:r.issues.map((s,i)=>e.jsx("div",{className:"p-4",children:e.jsx(ce,{issue:s,getSeverityIcon:k})},i))})]})]})]})}function ce({issue:n,getSeverityIcon:g}){return e.jsx("div",{className:"bg-gray-900/50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:Q[n.severity].text,children:g(n.severity)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("h4",{className:"font-medium text-gray-200",children:n.title}),e.jsx(j,{className:`${Q[n.severity].bg} ${Q[n.severity].text}`,children:n.severity})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-sm",children:[e.jsx(j,{className:"bg-gray-700 text-gray-300",children:n.resource_type}),e.jsx("span",{className:"text-gray-400",children:n.resource_name})]}),e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:n.description}),e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded p-3",children:[e.jsx("span",{className:"text-xs text-green-500 uppercase block mb-1",children:"Remediation:"}),e.jsx("p",{className:"text-sm text-green-300",children:n.remediation})]}),n.references&&n.references.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"text-xs text-gray-500 uppercase",children:"References:"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:n.references.map((l,h)=>e.jsx("a",{href:l,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-cyan-400 hover:text-cyan-300",children:l},h))})]})]})]})})}const de={pending:{bg:"bg-yellow-500/20",text:"text-yellow-400"},running:{bg:"bg-blue-500/20",text:"text-blue-400"},completed:{bg:"bg-green-500/20",text:"text-green-400"},failed:{bg:"bg-red-500/20",text:"text-red-400"}};function Ye(){const[n,g]=x.useState("scans"),[l,h]=x.useState(null),r=oe(),{hasEngagement:w}=_e(),{data:u,isLoading:R}=L({queryKey:["containerScans"],queryFn:()=>C.listScans().then(a=>a.data)}),{data:m}=L({queryKey:["containerScanTypes"],queryFn:()=>C.getScanTypes().then(a=>a.data)}),$=U({mutationFn:a=>C.createScan(a).then(s=>s.data),onSuccess:a=>{r.invalidateQueries({queryKey:["containerScans"]}),f.success("Scan started successfully"),h(a.id),g("scans")},onError:()=>{f.error("Failed to start scan")}}),b=U({mutationFn:a=>C.deleteScan(a),onSuccess:()=>{r.invalidateQueries({queryKey:["containerScans"]}),f.success("Scan deleted"),l&&h(null)},onError:()=>{f.error("Failed to delete scan")}}),k=(u==null?void 0:u.scans)||[],S=[{id:"scans",label:"Scan History",icon:e.jsx(fe,{className:"w-4 h-4"})},{id:"new-scan",label:"New Scan",icon:e.jsx(Y,{className:"w-4 h-4"})},{id:"dockerfile",label:"Dockerfile Analyzer",icon:e.jsx(X,{className:"w-4 h-4"})},{id:"k8s-manifest",label:"K8s Manifest Analyzer",icon:e.jsx(T,{className:"w-4 h-4"})}],o=a=>{const s=m==null?void 0:m.find(i=>i.id===a);return(s==null?void 0:s.name)||a.replace("_"," ")};return e.jsx(we,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(M,{className:"w-8 h-8 text-cyan-400"}),"Container Security"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Scan Docker images, analyze Dockerfiles, and audit Kubernetes configurations"})]})}),e.jsx(ke,{toolName:"Container Security",className:"mb-6"}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:S.map(a=>e.jsxs("button",{onClick:()=>{g(a.id),a.id!=="scans"&&h(null)},className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${n===a.id?"border-cyan-500 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[a.icon,a.label]},a.id))})}),e.jsxs("div",{children:[n==="scans"&&!l&&e.jsx("div",{className:"space-y-4",children:R?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(I,{className:"w-8 h-8 text-cyan-400 animate-spin"})}):k.length===0?e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-12 text-center",children:[e.jsx(M,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No Container Scans Yet"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Start by creating a new container security scan or analyzing a Dockerfile"}),e.jsxs(F,{onClick:()=>g("new-scan"),disabled:!w,children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Create New Scan"]})]}):e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white",children:["Container Scans (",k.length,")"]}),e.jsxs(F,{size:"sm",onClick:()=>g("new-scan"),disabled:!w,children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"New Scan"]})]}),e.jsx("div",{className:"divide-y divide-gray-700",children:k.map(a=>{var s,i;return e.jsx("div",{className:"p-4 hover:bg-gray-700/50 transition-colors cursor-pointer",onClick:()=>h(a.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-200",children:a.name}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-sm text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(M,{className:"w-4 h-4"}),o(a.scan_type)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(me,{className:"w-4 h-4"}),new Date(a.created_at).toLocaleDateString()]}),e.jsx("span",{className:"text-gray-500 truncate max-w-xs",children:a.target})]})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[a.status==="completed"&&e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[a.critical_count>0&&e.jsxs("span",{className:"text-red-400",children:[a.critical_count," Critical"]}),a.high_count>0&&e.jsxs("span",{className:"text-orange-400",children:[a.high_count," High"]}),e.jsxs("span",{className:"text-gray-400",children:[a.finding_count," Total"]})]}),e.jsxs(j,{className:`${(s=de[a.status])==null?void 0:s.bg} ${(i=de[a.status])==null?void 0:i.text}`,children:[a.status==="running"&&e.jsx(I,{className:"w-3 h-3 mr-1 animate-spin"}),a.status==="completed"&&e.jsx(E,{className:"w-3 h-3 mr-1"}),a.status==="failed"&&e.jsx(_,{className:"w-3 h-3 mr-1"}),a.status]}),e.jsx("button",{onClick:p=>{p.stopPropagation(),b.mutate(a.id)},className:"text-gray-400 hover:text-red-400 transition-colors",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx(B,{className:"w-5 h-5 text-gray-400"})]})]})},a.id)})})]})}),n==="scans"&&l&&e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>h(null),className:"flex items-center gap-2 text-gray-400 hover:text-gray-200 mb-4",children:[e.jsx(B,{className:"w-4 h-4 rotate-180"}),"Back to Scan List"]}),e.jsx($e,{scanId:l,onDelete:()=>{h(null),r.invalidateQueries({queryKey:["containerScans"]})}})]}),n==="new-scan"&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-6",children:"Create New Container Scan"}),e.jsx(Re,{onSubmit:a=>$.mutate(a),isLoading:$.isPending,scanTypes:m,disabled:!w})]}),n==="dockerfile"&&e.jsx(Ae,{}),n==="k8s-manifest"&&e.jsx(Pe,{})]})]})})}export{Ye as default};
